<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://dayun.shystartree.online">
  <title>fortify扫描结果速查(PHP) | qingyu&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="fortify扫描结果速查(PHP)，篇幅十分大，推荐使用ctrl+F查找~~~">
<meta property="og:type" content="article">
<meta property="og:title" content="fortify扫描结果速查(PHP)">
<meta property="og:url" content="http://dayun.shystartree.online/2020/05/20/fortify%E6%89%AB%E6%8F%8F%E7%BB%93%E6%9E%9C%E9%80%9F%E6%9F%A5(PHP)/index.html">
<meta property="og:site_name" content="qingyu&#39;s blog">
<meta property="og:description" content="fortify扫描结果速查(PHP)，篇幅十分大，推荐使用ctrl+F查找~~~">
<meta property="og:locale">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201226182427732.jpg">
<meta property="article:published_time" content="2020-05-20T17:00:10.000Z">
<meta property="article:modified_time" content="2020-12-28T09:15:13.000Z">
<meta property="article:author" content="QingYu">
<meta property="article:tag" content="安全">
<meta property="article:tag" content="速查">
<meta property="article:tag" content="fortify">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/20201226182427732.jpg">
  
    <link rel="alternative" href="/atom.xml" title="qingyu&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" type="text/css" href="/./main.0cf68a.css">
  <style type="text/css">
  
    #container.show {
      background: linear-gradient(200deg,#a0cfe4,#e8c37e);
    }
  </style>
  

  

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container" q-class="show:isCtnShow">
    <canvas id="anm-canvas" class="anm-canvas"></canvas>
    <div class="left-col" q-class="show:isShow">
      
<div class="overlay" style="background: #B0E0E6"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="/img/avatar.jpg" class="js-avatar">
		</a>
		<hgroup>
		  <h1 class="header-author"><a href="/"></a></h1>
		</hgroup>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">博客主页</a></li>
	        
				<li><a href="/tags/%E5%AE%89%E5%85%A8/">信息安全</a></li>
	        
				<li><a href="/tags/%E9%80%9F%E6%9F%A5/">安全速查</a></li>
	        
				<li><a href="/tags/%E9%9A%8F%E8%AE%B0/">灵感随记</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
    		
    			
    			<a q-on="click: openSlider(e, 'innerArchive')" href="javascript:void(0)">文章搜搜</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'friends')" href="javascript:void(0)">友情链接</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'aboutme')" href="javascript:void(0)">About me</a>
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/shystartree/" title="github"><i class="icon-github"></i></a>
		        
					<a class="weibo" target="_blank" href="https://weibo.com/qingyu520" title="weibo"><i class="icon-weibo"></i></a>
		        
					<a class="rss" target="_blank" href="http://blog.shystartree.online/atom.xml" title="rss"><i class="icon-rss"></i></a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col" q-class="show:isShow,hide:isShow|isFalse">
      
<nav id="mobile-nav">
  	<div class="overlay js-overlay" style="background: #B0E0E6"></div>
	<div class="btnctn js-mobile-btnctn">
  		<div class="slider-trigger list" q-on="click: openSlider(e)"><i class="icon icon-sort"></i></div>
	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="/img/avatar.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author js-header-author"></h1>
			</hgroup>
			
			
			
				
			
				
			
				
			
				
			
			
			
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/shystartree/" title="github"><i class="icon-github"></i></a>
			        
						<a class="weibo" target="_blank" href="https://weibo.com/qingyu520" title="weibo"><i class="icon-weibo"></i></a>
			        
						<a class="rss" target="_blank" href="http://blog.shystartree.online/atom.xml" title="rss"><i class="icon-rss"></i></a>
			        
				</div>
			</nav>

			<nav class="header-menu js-header-menu">
				<ul style="width: 70%">
				
				
					<li style="width: 25%"><a href="/">博客主页</a></li>
		        
					<li style="width: 25%"><a href="/tags/%E5%AE%89%E5%85%A8/">信息安全</a></li>
		        
					<li style="width: 25%"><a href="/tags/%E9%80%9F%E6%9F%A5/">安全速查</a></li>
		        
					<li style="width: 25%"><a href="/tags/%E9%9A%8F%E8%AE%B0/">灵感随记</a></li>
		        
				</ul>
			</nav>
		</header>				
	</div>
	<div class="mobile-mask" style="display:none" q-show="isShow"></div>
</nav>

      <div id="wrapper" class="body-wrap">
        <div class="menu-l">
          <div class="canvas-wrap">
            <canvas data-colors="#eaeaea" data-sectionHeight="100" data-contentId="js-content" id="myCanvas1" class="anm-canvas"></canvas>
          </div>
          <div id="js-content" class="content-ll">
            
<article id="post-fortify扫描结果速查(PHP)" class="article article-type-post " itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      fortify扫描结果速查(PHP)
    </h1>
  



        
        
        <!-- 不蒜子统计 -->
        <span id="busuanzi_container_page_pv" style='display:none' class="archive-article-date">
              <i class="icon-smile icon"></i> 阅读数：<span id="busuanzi_value_page_pv"></span>次
        </span>

<a href="/2020/05/20/fortify%E6%89%AB%E6%8F%8F%E7%BB%93%E6%9E%9C%E9%80%9F%E6%9F%A5(PHP)/" class="archive-article-date">
  	<time datetime="2020-05-20T17:00:10.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2020-05-20</time>
</a>
        
      </header>
    
    <!-- 目录内容 -->

    <p class="show-toc-btn" id="show-toc-btn" onclick="showToc();" style="display:none">
          <span class="btn-bg"></span>
          <span class="btn-text">文章导航</span>
          </p>
  <div id="toc-article" class="toc-article">
      <span id="toc-close" class="toc-close" title="隐藏导航" onclick="showBtn();">×</span>
    <strong class="toc-title">文章目录</strong>
           <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#PHP"><span class="toc-number">1.</span> <span class="toc-text">PHP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#API%E8%AF%AF%E7%94%A8"><span class="toc-number">1.1.</span> <span class="toc-text">API误用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Dangerous-Function"><span class="toc-number">1.1.1.</span> <span class="toc-text">Dangerous Function</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS"><span class="toc-number">1.1.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES"><span class="toc-number">1.1.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Often-Misused-File-Upload"><span class="toc-number">1.1.2.</span> <span class="toc-text">Often Misused: File Upload</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-1"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-1"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-1"><span class="toc-number">1.1.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-1"><span class="toc-number">1.1.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%81%E8%A3%85"><span class="toc-number">1.2.</span> <span class="toc-text">封装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Overly-Permissive-CORS-Policy"><span class="toc-number">1.2.1.</span> <span class="toc-text">HTML5: Overly Permissive CORS Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-2"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-2"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-2"><span class="toc-number">1.2.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-2"><span class="toc-number">1.2.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak"><span class="toc-number">1.2.2.</span> <span class="toc-text">System Information Leak</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-3"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-3"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-3"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-3"><span class="toc-number">1.2.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-External"><span class="toc-number">1.2.3.</span> <span class="toc-text">System Information Leak: External</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-4"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-4"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-4"><span class="toc-number">1.2.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-4"><span class="toc-number">1.2.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Internal"><span class="toc-number">1.2.4.</span> <span class="toc-text">System Information Leak: Internal</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-5"><span class="toc-number">1.2.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-5"><span class="toc-number">1.2.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-5"><span class="toc-number">1.2.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-5"><span class="toc-number">1.2.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-number">1.3.</span> <span class="toc-text">环境配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CakePHP-Misconfiguration-Debug-Information"><span class="toc-number">1.3.1.</span> <span class="toc-text">CakePHP Misconfiguration: Debug Information</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-6"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-6"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-6"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-6"><span class="toc-number">1.3.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CakePHP-Misconfiguration-Excessive-Session-Timeout"><span class="toc-number">1.3.2.</span> <span class="toc-text">CakePHP Misconfiguration: Excessive Session Timeout</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-7"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-7"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-7"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-7"><span class="toc-number">1.3.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-Missing-open-basedir-Entry"><span class="toc-number">1.3.3.</span> <span class="toc-text">PHP Misconfiguration: Missing open_basedir Entry</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-8"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-8"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-8"><span class="toc-number">1.3.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-8"><span class="toc-number">1.3.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-Missing-safe-mode-exec-dir-Entry"><span class="toc-number">1.3.4.</span> <span class="toc-text">PHP Misconfiguration: Missing safe_mode_exec_dir Entry</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-9"><span class="toc-number">1.3.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-9"><span class="toc-number">1.3.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-9"><span class="toc-number">1.3.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-9"><span class="toc-number">1.3.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-Poor-open-basedir-Configuration"><span class="toc-number">1.3.5.</span> <span class="toc-text">PHP Misconfiguration: Poor open_basedir Configuration</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-10"><span class="toc-number">1.3.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-10"><span class="toc-number">1.3.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-10"><span class="toc-number">1.3.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-10"><span class="toc-number">1.3.5.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-allow-url-fopen-Enabled"><span class="toc-number">1.3.6.</span> <span class="toc-text">PHP Misconfiguration: allow_url_fopen Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-11"><span class="toc-number">1.3.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-11"><span class="toc-number">1.3.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-11"><span class="toc-number">1.3.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-11"><span class="toc-number">1.3.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-allow-url-include-Enabled"><span class="toc-number">1.3.7.</span> <span class="toc-text">PHP Misconfiguration: allow_url_include Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-12"><span class="toc-number">1.3.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-12"><span class="toc-number">1.3.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-12"><span class="toc-number">1.3.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-12"><span class="toc-number">1.3.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-cgi-force-redirect-Disabled"><span class="toc-number">1.3.8.</span> <span class="toc-text">PHP Misconfiguration: cgi.force_redirect Disabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-13"><span class="toc-number">1.3.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-13"><span class="toc-number">1.3.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-13"><span class="toc-number">1.3.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-13"><span class="toc-number">1.3.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-enable-dl-Enabled"><span class="toc-number">1.3.9.</span> <span class="toc-text">PHP Misconfiguration: enable_dl Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-14"><span class="toc-number">1.3.9.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-14"><span class="toc-number">1.3.9.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-14"><span class="toc-number">1.3.9.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-14"><span class="toc-number">1.3.9.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-file-uploads-Enabled"><span class="toc-number">1.3.10.</span> <span class="toc-text">PHP Misconfiguration: file_uploads Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-15"><span class="toc-number">1.3.10.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-15"><span class="toc-number">1.3.10.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-15"><span class="toc-number">1.3.10.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-15"><span class="toc-number">1.3.10.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-magic-quotes-gpc-Enabled"><span class="toc-number">1.3.11.</span> <span class="toc-text">PHP Misconfiguration: magic_quotes_gpc Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-16"><span class="toc-number">1.3.11.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-16"><span class="toc-number">1.3.11.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-16"><span class="toc-number">1.3.11.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-16"><span class="toc-number">1.3.11.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-magic-quotes-runtime-Enabled"><span class="toc-number">1.3.12.</span> <span class="toc-text">PHP Misconfiguration: magic_quotes_runtime Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-17"><span class="toc-number">1.3.12.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-17"><span class="toc-number">1.3.12.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-17"><span class="toc-number">1.3.12.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-17"><span class="toc-number">1.3.12.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-magic-quotes-sybase-Enabled"><span class="toc-number">1.3.13.</span> <span class="toc-text">PHP Misconfiguration: magic_quotes_sybase Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-18"><span class="toc-number">1.3.13.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-18"><span class="toc-number">1.3.13.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-18"><span class="toc-number">1.3.13.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-18"><span class="toc-number">1.3.13.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-register-globals-Enabled"><span class="toc-number">1.3.14.</span> <span class="toc-text">PHP Misconfiguration: register_globals Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-19"><span class="toc-number">1.3.14.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-19"><span class="toc-number">1.3.14.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-19"><span class="toc-number">1.3.14.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-19"><span class="toc-number">1.3.14.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-safe-mode-Disabled"><span class="toc-number">1.3.15.</span> <span class="toc-text">PHP Misconfiguration: safe_mode Disabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-20"><span class="toc-number">1.3.15.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-20"><span class="toc-number">1.3.15.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-20"><span class="toc-number">1.3.15.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-20"><span class="toc-number">1.3.15.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-session-use-trans-sid-Enabled"><span class="toc-number">1.3.16.</span> <span class="toc-text">PHP Misconfiguration: session_use_trans_sid Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-21"><span class="toc-number">1.3.16.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-21"><span class="toc-number">1.3.16.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-21"><span class="toc-number">1.3.16.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-21"><span class="toc-number">1.3.16.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Race-Condition-PHP-Design-Flaw"><span class="toc-number">1.3.17.</span> <span class="toc-text">Race Condition: PHP Design Flaw</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-22"><span class="toc-number">1.3.17.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-22"><span class="toc-number">1.3.17.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-22"><span class="toc-number">1.3.17.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-22"><span class="toc-number">1.3.17.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-PHP-Errors"><span class="toc-number">1.3.18.</span> <span class="toc-text">System Information Leak: PHP Errors</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-23"><span class="toc-number">1.3.18.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-23"><span class="toc-number">1.3.18.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-23"><span class="toc-number">1.3.18.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-23"><span class="toc-number">1.3.18.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-PHP-Version"><span class="toc-number">1.3.19.</span> <span class="toc-text">System Information Leak: PHP Version</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-24"><span class="toc-number">1.3.19.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-24"><span class="toc-number">1.3.19.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-24"><span class="toc-number">1.3.19.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-24"><span class="toc-number">1.3.19.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-number">1.4.</span> <span class="toc-text">异常处理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Error-Handling-Empty-Catch-Block"><span class="toc-number">1.4.1.</span> <span class="toc-text">Poor Error Handling: Empty Catch Block</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-25"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-25"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-25"><span class="toc-number">1.4.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-25"><span class="toc-number">1.4.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Error-Handling-Return-Inside-Finally"><span class="toc-number">1.4.2.</span> <span class="toc-text">Poor Error Handling: Return Inside Finally</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-26"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-26"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-26"><span class="toc-number">1.4.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-26"><span class="toc-number">1.4.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%E9%AA%8C%E8%AF%81%E4%B8%8E%E5%B1%95%E7%A4%BA%E9%97%AE%E9%A2%98"><span class="toc-number">1.5.</span> <span class="toc-text">输入验证与展示问题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Command-Injection"><span class="toc-number">1.5.1.</span> <span class="toc-text">Command Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-27"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-27"><span class="toc-number">1.5.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-27"><span class="toc-number">1.5.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-27"><span class="toc-number">1.5.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-Persistent"><span class="toc-number">1.5.2.</span> <span class="toc-text">Cross-Site Scripting: Persistent</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-28"><span class="toc-number">1.5.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-28"><span class="toc-number">1.5.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-28"><span class="toc-number">1.5.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-28"><span class="toc-number">1.5.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-Poor-Validation"><span class="toc-number">1.5.3.</span> <span class="toc-text">Cross-Site Scripting: Poor Validation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-29"><span class="toc-number">1.5.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-29"><span class="toc-number">1.5.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-29"><span class="toc-number">1.5.3.3.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-Reflected"><span class="toc-number">1.5.4.</span> <span class="toc-text">Cross-Site Scripting: Reflected</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-30"><span class="toc-number">1.5.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-30"><span class="toc-number">1.5.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-29"><span class="toc-number">1.5.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-30"><span class="toc-number">1.5.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dangerous-File-Inclusion"><span class="toc-number">1.5.5.</span> <span class="toc-text">Dangerous File Inclusion</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-31"><span class="toc-number">1.5.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-31"><span class="toc-number">1.5.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-30"><span class="toc-number">1.5.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-31"><span class="toc-number">1.5.5.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dangerous-File-Injection"><span class="toc-number">1.5.6.</span> <span class="toc-text">Dangerous File Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-32"><span class="toc-number">1.5.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-32"><span class="toc-number">1.5.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-31"><span class="toc-number">1.5.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-32"><span class="toc-number">1.5.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Denial-of-Service"><span class="toc-number">1.5.7.</span> <span class="toc-text">Denial of Service</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-33"><span class="toc-number">1.5.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-33"><span class="toc-number">1.5.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-32"><span class="toc-number">1.5.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-33"><span class="toc-number">1.5.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Denial-of-Service-Regular-Expression"><span class="toc-number">1.5.8.</span> <span class="toc-text">Denial of Service: Regular Expression</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-34"><span class="toc-number">1.5.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-34"><span class="toc-number">1.5.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-33"><span class="toc-number">1.5.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-34"><span class="toc-number">1.5.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-Code-Injection"><span class="toc-number">1.5.9.</span> <span class="toc-text">Dynamic Code Evaluation: Code Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-35"><span class="toc-number">1.5.9.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-35"><span class="toc-number">1.5.9.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-34"><span class="toc-number">1.5.9.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-35"><span class="toc-number">1.5.9.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTP-Parameter-Pollution"><span class="toc-number">1.5.10.</span> <span class="toc-text">HTTP Parameter Pollution</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-36"><span class="toc-number">1.5.10.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-36"><span class="toc-number">1.5.10.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-35"><span class="toc-number">1.5.10.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-36"><span class="toc-number">1.5.10.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Header-Manipulation"><span class="toc-number">1.5.11.</span> <span class="toc-text">Header Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-37"><span class="toc-number">1.5.11.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-37"><span class="toc-number">1.5.11.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-36"><span class="toc-number">1.5.11.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-37"><span class="toc-number">1.5.11.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Header-Manipulation-Cookies"><span class="toc-number">1.5.12.</span> <span class="toc-text">Header Manipulation: Cookies</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-38"><span class="toc-number">1.5.12.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-38"><span class="toc-number">1.5.12.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-37"><span class="toc-number">1.5.12.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-38"><span class="toc-number">1.5.12.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Header-Manipulation-SMTP"><span class="toc-number">1.5.13.</span> <span class="toc-text">Header Manipulation: SMTP</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-39"><span class="toc-number">1.5.13.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-39"><span class="toc-number">1.5.13.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-38"><span class="toc-number">1.5.13.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-39"><span class="toc-number">1.5.13.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JSON-Injection"><span class="toc-number">1.5.14.</span> <span class="toc-text">JSON Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-40"><span class="toc-number">1.5.14.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-40"><span class="toc-number">1.5.14.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-39"><span class="toc-number">1.5.14.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-40"><span class="toc-number">1.5.14.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LDAP-Injection"><span class="toc-number">1.5.15.</span> <span class="toc-text">LDAP Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-41"><span class="toc-number">1.5.15.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-41"><span class="toc-number">1.5.15.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-40"><span class="toc-number">1.5.15.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-41"><span class="toc-number">1.5.15.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LDAP-Manipulation"><span class="toc-number">1.5.16.</span> <span class="toc-text">LDAP Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-42"><span class="toc-number">1.5.16.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-42"><span class="toc-number">1.5.16.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-41"><span class="toc-number">1.5.16.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-42"><span class="toc-number">1.5.16.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Log-Forging"><span class="toc-number">1.5.17.</span> <span class="toc-text">Log Forging</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-43"><span class="toc-number">1.5.17.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-43"><span class="toc-number">1.5.17.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-42"><span class="toc-number">1.5.17.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-43"><span class="toc-number">1.5.17.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Object-Injection"><span class="toc-number">1.5.18.</span> <span class="toc-text">Object Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-44"><span class="toc-number">1.5.18.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-44"><span class="toc-number">1.5.18.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-43"><span class="toc-number">1.5.18.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-44"><span class="toc-number">1.5.18.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Open-Redirect"><span class="toc-number">1.5.19.</span> <span class="toc-text">Open Redirect</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-45"><span class="toc-number">1.5.19.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-45"><span class="toc-number">1.5.19.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-44"><span class="toc-number">1.5.19.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-45"><span class="toc-number">1.5.19.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Path-Manipulation"><span class="toc-number">1.5.20.</span> <span class="toc-text">Path Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-46"><span class="toc-number">1.5.20.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-46"><span class="toc-number">1.5.20.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-45"><span class="toc-number">1.5.20.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-46"><span class="toc-number">1.5.20.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Possible-Variable-Overwrite-Functional-Scope"><span class="toc-number">1.5.21.</span> <span class="toc-text">Possible Variable Overwrite: Functional Scope</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-47"><span class="toc-number">1.5.21.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-47"><span class="toc-number">1.5.21.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-46"><span class="toc-number">1.5.21.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-47"><span class="toc-number">1.5.21.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Possible-Variable-Overwrite-Global-Scope"><span class="toc-number">1.5.22.</span> <span class="toc-text">Possible Variable Overwrite: Global Scope</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-48"><span class="toc-number">1.5.22.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-48"><span class="toc-number">1.5.22.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-47"><span class="toc-number">1.5.22.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-48"><span class="toc-number">1.5.22.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Process-Control"><span class="toc-number">1.5.23.</span> <span class="toc-text">Process Control</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-49"><span class="toc-number">1.5.23.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-49"><span class="toc-number">1.5.23.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-48"><span class="toc-number">1.5.23.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-49"><span class="toc-number">1.5.23.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Resource-Injection"><span class="toc-number">1.5.24.</span> <span class="toc-text">Resource Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-50"><span class="toc-number">1.5.24.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-50"><span class="toc-number">1.5.24.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-49"><span class="toc-number">1.5.24.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-50"><span class="toc-number">1.5.24.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL-Injection"><span class="toc-number">1.5.25.</span> <span class="toc-text">SQL Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-51"><span class="toc-number">1.5.25.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-51"><span class="toc-number">1.5.25.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-50"><span class="toc-number">1.5.25.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-51"><span class="toc-number">1.5.25.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL-Injection-Poor-Validation"><span class="toc-number">1.5.26.</span> <span class="toc-text">SQL Injection: Poor Validation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-52"><span class="toc-number">1.5.26.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-52"><span class="toc-number">1.5.26.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-51"><span class="toc-number">1.5.26.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-52"><span class="toc-number">1.5.26.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Server-Side-Request-Forgery"><span class="toc-number">1.5.27.</span> <span class="toc-text">Server-Side Request Forgery</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-53"><span class="toc-number">1.5.27.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-53"><span class="toc-number">1.5.27.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-52"><span class="toc-number">1.5.27.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-53"><span class="toc-number">1.5.27.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Setting-Manipulation"><span class="toc-number">1.5.28.</span> <span class="toc-text">Setting Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-54"><span class="toc-number">1.5.28.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-54"><span class="toc-number">1.5.28.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-53"><span class="toc-number">1.5.28.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-54"><span class="toc-number">1.5.28.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Reflection"><span class="toc-number">1.5.29.</span> <span class="toc-text">Unsafe Reflection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-55"><span class="toc-number">1.5.29.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-55"><span class="toc-number">1.5.29.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-54"><span class="toc-number">1.5.29.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-55"><span class="toc-number">1.5.29.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XML-Injection"><span class="toc-number">1.5.30.</span> <span class="toc-text">XML Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-56"><span class="toc-number">1.5.30.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-56"><span class="toc-number">1.5.30.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-55"><span class="toc-number">1.5.30.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-56"><span class="toc-number">1.5.30.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XPath-Injection"><span class="toc-number">1.5.31.</span> <span class="toc-text">XPath Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-57"><span class="toc-number">1.5.31.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-57"><span class="toc-number">1.5.31.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-56"><span class="toc-number">1.5.31.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-57"><span class="toc-number">1.5.31.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XQuery-Injection"><span class="toc-number">1.5.32.</span> <span class="toc-text">XQuery Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-58"><span class="toc-number">1.5.32.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-58"><span class="toc-number">1.5.32.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-57"><span class="toc-number">1.5.32.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-58"><span class="toc-number">1.5.32.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XSLT-Injection"><span class="toc-number">1.5.33.</span> <span class="toc-text">XSLT Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-59"><span class="toc-number">1.5.33.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-59"><span class="toc-number">1.5.33.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-58"><span class="toc-number">1.5.33.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-59"><span class="toc-number">1.5.33.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E7%89%B9%E6%80%A7"><span class="toc-number">1.6.</span> <span class="toc-text">安全特性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Access-Control-Database"><span class="toc-number">1.6.1.</span> <span class="toc-text">Access Control: Database</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-60"><span class="toc-number">1.6.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-60"><span class="toc-number">1.6.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-59"><span class="toc-number">1.6.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-60"><span class="toc-number">1.6.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-Cookie-not-Sent-Over-SSL"><span class="toc-number">1.6.2.</span> <span class="toc-text">Cookie Security: Cookie not Sent Over SSL</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-61"><span class="toc-number">1.6.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-61"><span class="toc-number">1.6.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-60"><span class="toc-number">1.6.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-61"><span class="toc-number">1.6.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-HTTPOnly-not-Set"><span class="toc-number">1.6.3.</span> <span class="toc-text">Cookie Security: HTTPOnly not Set</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-62"><span class="toc-number">1.6.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-62"><span class="toc-number">1.6.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-61"><span class="toc-number">1.6.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-62"><span class="toc-number">1.6.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-HTTPOnly-not-Set-on-Session-Cookie"><span class="toc-number">1.6.4.</span> <span class="toc-text">Cookie Security: HTTPOnly not Set on Session Cookie</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-63"><span class="toc-number">1.6.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-63"><span class="toc-number">1.6.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-62"><span class="toc-number">1.6.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-63"><span class="toc-number">1.6.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-Overly-Broad-Domain"><span class="toc-number">1.6.5.</span> <span class="toc-text">Cookie Security: Overly Broad Domain</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-64"><span class="toc-number">1.6.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-64"><span class="toc-number">1.6.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-63"><span class="toc-number">1.6.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-64"><span class="toc-number">1.6.5.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-Overly-Broad-Path"><span class="toc-number">1.6.6.</span> <span class="toc-text">Cookie Security: Overly Broad Path</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-65"><span class="toc-number">1.6.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-65"><span class="toc-number">1.6.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-64"><span class="toc-number">1.6.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-65"><span class="toc-number">1.6.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-Overly-Broad-Session-Cookie-Domain"><span class="toc-number">1.6.7.</span> <span class="toc-text">Cookie Security: Overly Broad Session Cookie Domain</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-66"><span class="toc-number">1.6.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-66"><span class="toc-number">1.6.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-65"><span class="toc-number">1.6.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-66"><span class="toc-number">1.6.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-Overly-Broad-Session-Cookie-Path"><span class="toc-number">1.6.8.</span> <span class="toc-text">Cookie Security: Overly Broad Session Cookie Path</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-67"><span class="toc-number">1.6.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-67"><span class="toc-number">1.6.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-66"><span class="toc-number">1.6.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-67"><span class="toc-number">1.6.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-Persistent-Cookie"><span class="toc-number">1.6.9.</span> <span class="toc-text">Cookie Security: Persistent Cookie</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-68"><span class="toc-number">1.6.9.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-68"><span class="toc-number">1.6.9.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-67"><span class="toc-number">1.6.9.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-68"><span class="toc-number">1.6.9.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-Persistent-Session-Cookie"><span class="toc-number">1.6.10.</span> <span class="toc-text">Cookie Security: Persistent Session Cookie</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-69"><span class="toc-number">1.6.10.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-69"><span class="toc-number">1.6.10.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-68"><span class="toc-number">1.6.10.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-69"><span class="toc-number">1.6.10.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-Session-Cookie-not-Sent-Over-SSL"><span class="toc-number">1.6.11.</span> <span class="toc-text">Cookie Security: Session Cookie not Sent Over SSL</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-70"><span class="toc-number">1.6.11.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-70"><span class="toc-number">1.6.11.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-69"><span class="toc-number">1.6.11.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-70"><span class="toc-number">1.6.11.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-Session-Cookies-Disabled"><span class="toc-number">1.6.12.</span> <span class="toc-text">Cookie Security: Session Cookies Disabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-71"><span class="toc-number">1.6.12.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-71"><span class="toc-number">1.6.12.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-70"><span class="toc-number">1.6.12.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-71"><span class="toc-number">1.6.12.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#File-Permission-Manipulation"><span class="toc-number">1.6.13.</span> <span class="toc-text">File Permission Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-72"><span class="toc-number">1.6.13.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-72"><span class="toc-number">1.6.13.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-71"><span class="toc-number">1.6.13.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-72"><span class="toc-number">1.6.13.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Randomness"><span class="toc-number">1.6.14.</span> <span class="toc-text">Insecure Randomness</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-73"><span class="toc-number">1.6.14.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-73"><span class="toc-number">1.6.14.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-72"><span class="toc-number">1.6.14.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-73"><span class="toc-number">1.6.14.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Transport"><span class="toc-number">1.6.15.</span> <span class="toc-text">Insecure Transport</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-74"><span class="toc-number">1.6.15.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-74"><span class="toc-number">1.6.15.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-73"><span class="toc-number">1.6.15.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-74"><span class="toc-number">1.6.15.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Key-Management-Empty-Encryption-Key"><span class="toc-number">1.6.16.</span> <span class="toc-text">Key Management: Empty Encryption Key</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-75"><span class="toc-number">1.6.16.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-75"><span class="toc-number">1.6.16.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-74"><span class="toc-number">1.6.16.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-75"><span class="toc-number">1.6.16.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Key-Management-Hardcoded-Encryption-Key"><span class="toc-number">1.6.17.</span> <span class="toc-text">Key Management: Hardcoded Encryption Key</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-76"><span class="toc-number">1.6.17.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-76"><span class="toc-number">1.6.17.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-75"><span class="toc-number">1.6.17.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-76"><span class="toc-number">1.6.17.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Key-Management-Hardcoded-PBE-Password"><span class="toc-number">1.6.18.</span> <span class="toc-text">Key Management: Hardcoded PBE Password</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-77"><span class="toc-number">1.6.18.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-77"><span class="toc-number">1.6.18.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-76"><span class="toc-number">1.6.18.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-77"><span class="toc-number">1.6.18.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Key-Management-Null-Encryption-Key"><span class="toc-number">1.6.19.</span> <span class="toc-text">Key Management: Null Encryption Key</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-78"><span class="toc-number">1.6.19.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-78"><span class="toc-number">1.6.19.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-77"><span class="toc-number">1.6.19.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-78"><span class="toc-number">1.6.19.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management"><span class="toc-number">1.6.20.</span> <span class="toc-text">Password Management</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-79"><span class="toc-number">1.6.20.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-79"><span class="toc-number">1.6.20.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-78"><span class="toc-number">1.6.20.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-79"><span class="toc-number">1.6.20.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management-Empty-Password"><span class="toc-number">1.6.21.</span> <span class="toc-text">Password Management: Empty Password</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-80"><span class="toc-number">1.6.21.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-80"><span class="toc-number">1.6.21.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-79"><span class="toc-number">1.6.21.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-80"><span class="toc-number">1.6.21.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management-Hardcoded-Password"><span class="toc-number">1.6.22.</span> <span class="toc-text">Password Management: Hardcoded Password</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-81"><span class="toc-number">1.6.22.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-81"><span class="toc-number">1.6.22.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-80"><span class="toc-number">1.6.22.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-81"><span class="toc-number">1.6.22.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management-Null-Password"><span class="toc-number">1.6.23.</span> <span class="toc-text">Password Management: Null Password</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-82"><span class="toc-number">1.6.23.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-82"><span class="toc-number">1.6.23.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-81"><span class="toc-number">1.6.23.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-82"><span class="toc-number">1.6.23.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management-Password-in-Comment"><span class="toc-number">1.6.24.</span> <span class="toc-text">Password Management: Password in Comment</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-83"><span class="toc-number">1.6.24.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-83"><span class="toc-number">1.6.24.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-82"><span class="toc-number">1.6.24.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-83"><span class="toc-number">1.6.24.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management-Weak-Cryptography"><span class="toc-number">1.6.25.</span> <span class="toc-text">Password Management: Weak Cryptography</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-84"><span class="toc-number">1.6.25.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-84"><span class="toc-number">1.6.25.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-83"><span class="toc-number">1.6.25.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-84"><span class="toc-number">1.6.25.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Privacy-Violation"><span class="toc-number">1.6.26.</span> <span class="toc-text">Privacy Violation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-85"><span class="toc-number">1.6.26.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-85"><span class="toc-number">1.6.26.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-84"><span class="toc-number">1.6.26.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-85"><span class="toc-number">1.6.26.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Privacy-Violation-HTTP-GET"><span class="toc-number">1.6.27.</span> <span class="toc-text">Privacy Violation: HTTP GET</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-86"><span class="toc-number">1.6.27.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-86"><span class="toc-number">1.6.27.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-85"><span class="toc-number">1.6.27.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-86"><span class="toc-number">1.6.27.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Cryptographic-Hash"><span class="toc-number">1.6.28.</span> <span class="toc-text">Weak Cryptographic Hash</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-87"><span class="toc-number">1.6.28.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-87"><span class="toc-number">1.6.28.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-86"><span class="toc-number">1.6.28.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-87"><span class="toc-number">1.6.28.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Cryptographic-Hash-Empty-PBE-Salt"><span class="toc-number">1.6.29.</span> <span class="toc-text">Weak Cryptographic Hash: Empty PBE Salt</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-88"><span class="toc-number">1.6.29.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-88"><span class="toc-number">1.6.29.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-87"><span class="toc-number">1.6.29.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-88"><span class="toc-number">1.6.29.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Cryptographic-Hash-Hardcoded-PBE-Salt"><span class="toc-number">1.6.30.</span> <span class="toc-text">Weak Cryptographic Hash: Hardcoded PBE Salt</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-89"><span class="toc-number">1.6.30.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-89"><span class="toc-number">1.6.30.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-88"><span class="toc-number">1.6.30.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-89"><span class="toc-number">1.6.30.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Cryptographic-Hash-Hardcoded-Salt"><span class="toc-number">1.6.31.</span> <span class="toc-text">Weak Cryptographic Hash: Hardcoded Salt</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-90"><span class="toc-number">1.6.31.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-90"><span class="toc-number">1.6.31.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-89"><span class="toc-number">1.6.31.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-90"><span class="toc-number">1.6.31.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Cryptographic-Hash-Insecure-PBE-Iteration-Count"><span class="toc-number">1.6.32.</span> <span class="toc-text">Weak Cryptographic Hash: Insecure PBE Iteration Count</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-91"><span class="toc-number">1.6.32.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-91"><span class="toc-number">1.6.32.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-90"><span class="toc-number">1.6.32.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-91"><span class="toc-number">1.6.32.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Cryptographic-Hash-Predictable-Salt"><span class="toc-number">1.6.33.</span> <span class="toc-text">Weak Cryptographic Hash: Predictable Salt</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-92"><span class="toc-number">1.6.33.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-92"><span class="toc-number">1.6.33.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-91"><span class="toc-number">1.6.33.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-92"><span class="toc-number">1.6.33.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Cryptographic-Hash-User-Controlled-PBE-Salt"><span class="toc-number">1.6.34.</span> <span class="toc-text">Weak Cryptographic Hash: User-Controlled PBE Salt</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-93"><span class="toc-number">1.6.34.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-93"><span class="toc-number">1.6.34.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-92"><span class="toc-number">1.6.34.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-93"><span class="toc-number">1.6.34.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Encryption"><span class="toc-number">1.6.35.</span> <span class="toc-text">Weak Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-94"><span class="toc-number">1.6.35.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-94"><span class="toc-number">1.6.35.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-93"><span class="toc-number">1.6.35.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-94"><span class="toc-number">1.6.35.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Encryption-Inadequate-RSA-Padding"><span class="toc-number">1.6.36.</span> <span class="toc-text">Weak Encryption: Inadequate RSA Padding</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-95"><span class="toc-number">1.6.36.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-95"><span class="toc-number">1.6.36.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-94"><span class="toc-number">1.6.36.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-95"><span class="toc-number">1.6.36.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Encryption-Insufficient-Key-Size"><span class="toc-number">1.6.37.</span> <span class="toc-text">Weak Encryption: Insufficient Key Size</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-96"><span class="toc-number">1.6.37.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-96"><span class="toc-number">1.6.37.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-95"><span class="toc-number">1.6.37.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-96"><span class="toc-number">1.6.37.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Encryption-User-Controlled-Key-Size"><span class="toc-number">1.6.38.</span> <span class="toc-text">Weak Encryption: User-Controlled Key Size</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-97"><span class="toc-number">1.6.38.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-97"><span class="toc-number">1.6.38.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-96"><span class="toc-number">1.6.38.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-97"><span class="toc-number">1.6.38.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li></ol></li></ol>
         </div>
   <script type="text/javascript">
  function showToc(){
    var toc_article = document.getElementById("toc-article");
    var show_toc_btn = document.getElementById("show-toc-btn");
    toc_article.setAttribute("style","display:block");
    show_toc_btn.setAttribute("style","display:none");
    };
  function showBtn(){
    var toc_article = document.getElementById("toc-article");
    var show_toc_btn = document.getElementById("show-toc-btn");
    toc_article.setAttribute("style","display:none");
    show_toc_btn.setAttribute("style","display:block");
    };
   </script>
      
<!-- 目录内容结束 -->

    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="https://img-blog.csdnimg.cn/20201226182427732.jpg" alt="P1"></p>
<p>fortify扫描结果速查(PHP)，篇幅十分大，推荐使用ctrl+F查找~~~<br><span id="more"></span></p>
<h2 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h2><h3 id="API误用"><a href="#API误用" class="headerlink" title="API误用"></a>API误用</h3><h4 id="Dangerous-Function"><a href="#Dangerous-Function" class="headerlink" title="Dangerous Function"></a>Dangerous Function</h4><h5 id="ABSTRACT"><a href="#ABSTRACT" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>永不应该使用那些无法安全使用的函数。</p>
<h5 id="EXPLANATION"><a href="#EXPLANATION" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>某些函数不论如何使用都有危险性。这一类函数通常是在没有考虑安全问题的情况下就执行了。 </p>
<h5 id="RECOMMENDATIONS"><a href="#RECOMMENDATIONS" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>永不应该使用那些无法安全使用的函数。如果这些函数中的任何一个出现在新的或是继承代码中，则必须删除该函数并用相应的安全函数进行取代。</p>
<h5 id="REFERENCES"><a href="#REFERENCES" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 242 </p>
<p>[2] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[3] Standards Mapping - MISRA C++ 2008 Rule 27-0-1 </p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6 </p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6 </p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6 </p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.6 </p>
<p>[9] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[10] Standards Mapping - SANS Top 25 2011 Risky Resource Management - CWE ID 676 </p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP2060.4 CAT II, APP3590.2 CAT I </p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP2060.4 CAT II, APP3590.2 CAT II </p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP2060.4 CAT II, APP3590.2 CAT II </p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP2060.4 CAT II, APP3590.2 CAT II </p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP2060.4 CAT II, APP3590.2 CAT II </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP2060.4 CAT II, APP3590.2 CAT II </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP2060.4 CAT II, APP3590.2 CAT II </p>
<h4 id="Often-Misused-File-Upload"><a href="#Often-Misused-File-Upload" class="headerlink" title="Often Misused: File Upload"></a>Often Misused: File Upload</h4><h5 id="ABSTRACT-1"><a href="#ABSTRACT-1" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>允许用户上传文件可能会让攻击者注入危险内容或恶意代码，并在服务器上运行。</p>
<h5 id="EXPLANATION-1"><a href="#EXPLANATION-1" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>无论编写程序所用的语言是什么，最具破坏性的攻击通常都会涉及执行远程代码，攻击者借此可在程序上下文中成功执行恶意代码。如果允许攻击者向某个可通过 Web 访问的目录上传文件，并能够将这些文件传递给 PHP 解释器，他们就能促使这些文件中包含的恶意代码在服务器上执行。</p>
<p>示例 1：以下代码会处理上传的文件，并将它们移到 Web 根目录下的一个目录中。攻击者可以将恶意的 PHP 源文件上传到该程序中，并随后从服务器中请求这些文件，这会促使 PHP 解析器执行这些文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$udir = &#x27;upload/&#x27;; // Relative path under Web root</span><br><span class="line"></span><br><span class="line">$ufile = $udir . basename($_FILES[&#x27;userfile&#x27;][&#x27;name&#x27;]);</span><br><span class="line"></span><br><span class="line">if (move_uploaded_file($_FILES[&#x27;userfile&#x27;][&#x27;tmp_name&#x27;], $ufile)) &#123;</span><br><span class="line"></span><br><span class="line">    echo &quot;Valid upload received\n&quot;;</span><br><span class="line"></span><br><span class="line">&#125; else &#123;</span><br><span class="line"></span><br><span class="line">    echo &quot;Invalid upload rejected\n&quot;;</span><br><span class="line"></span><br><span class="line">&#125; ?&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>即使程序将上传的文件存储在一个无法通过 Web 访问的目录中，攻击者仍然有可能通过向服务器环境引入恶意内容来发动其他攻击。如果程序容易出现 path manipulation、command injection 或 remote include 漏洞，那么攻击者就可能上传带恶意内容的文件，并利用另一种漏洞促使程序读取或执行该文件。</p>
<h5 id="RECOMMENDATIONS-1"><a href="#RECOMMENDATIONS-1" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>除非程序特别要求用户上传文件，否则请通过在 php.ini 文件中包含以下条目来禁用 file_uploads 选项：</p>
<p><code>file_uploads = &#39;off&#39;</code></p>
<p>也可以通过在 Apache httpd.conf 文件中包含以下条目来禁用 file_uploads 选项：</p>
<p><code>php_flag  file_uploads  off</code></p>
<p>如果程序必须允许文件上传，则应当只接受程序需要的特定类型的内容，从而阻止攻击者提供恶意内容。依赖于上传内容的攻击通常要求攻击者能够提供他们自行选择的内容。限制此内容可以在最大程度上限制可能被攻击的范围。</p>
<p>例 2：下面的代码演示了一种严重受限的文件上传机制，这种机制将上传的内容存储在一个无法通过 Web 访问的目录中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$udir = &#x27;/var/spool/uploads/&#x27;; # Outside of Web root</span><br><span class="line"></span><br><span class="line">$ufile = $udir . basename($_FILES[&#x27;userfile&#x27;][&#x27;name&#x27;]);</span><br><span class="line"></span><br><span class="line">if (move_uploaded_file($_FILES[&#x27;userfile&#x27;][&#x27;tmp_name&#x27;], $ufile)) &#123;</span><br><span class="line"></span><br><span class="line">    echo &quot;Valid upload received\n&quot;;</span><br><span class="line"></span><br><span class="line">&#125; else &#123;</span><br><span class="line"></span><br><span class="line">    echo &quot;Invalid upload rejected\n&quot;;</span><br><span class="line"></span><br><span class="line">&#125; ?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>尽管这种机制可阻止攻击者直接请求上传的文件，但它对针对程序中存在的其他漏洞发起的攻击没有任何作用，这些漏洞也能让攻击者利用上传的内容。阻止这种攻击的最好方法是，使攻击者难以破译上传的文件的名称和位置。这种解决方法通常是因程序而异的，并且在以下几个方面各不相同：将上传的文件存储在一个目录中（目录名称是在程序初始化时通过强随机值生成的）、为每个上传的文件分配一个随机名称，以及利用数据库中的条目跟踪这些文件 [3]。</p>
<h5 id="REFERENCES-1"><a href="#REFERENCES-1" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] M. Achour et al. PHP Manual </p>
<p>[2] PHP Security Consortium PhpSecInfo Test Information </p>
<p>[3] Alla Bezroutchko Secure file upload in PHP web applications </p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 434 </p>
<p>[5] Standards Mapping - Common Weakness Enumeration Top 25 2019 [16] CWE ID 434 </p>
<p>[6] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001167 </p>
<p>[7] Standards Mapping - FIPS200 SI </p>
<p>[8] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[9] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-18 Mobile Code (P2) </p>
<p>[10] Standards Mapping - OWASP Application Security Verification Standard 4.0 12.2.1 File Integrity Requirements, 12.5.2 File Download Requirements, 13.1.5 Generic Web Service Security Verification Requirements </p>
<p>[11] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[12] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[13] Standards Mapping - OWASP Top 10 2007 A3 Malicious File Execution </p>
<p>[14] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[15] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[16] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.3 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[24] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[25] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 434 </p>
<p>[26] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 434 </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-003300 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-003300 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-003300 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-003300 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-003300 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-003300 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-003300 CAT II </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-003300 CAT II </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-003300 CAT II </p>
<p>[43] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-003300 CAT II </p>
<p>[44] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h3 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h3><h4 id="HTML5-Overly-Permissive-CORS-Policy"><a href="#HTML5-Overly-Permissive-CORS-Policy" class="headerlink" title="HTML5: Overly Permissive CORS Policy"></a>HTML5: Overly Permissive CORS Policy</h4><h5 id="ABSTRACT-2"><a href="#ABSTRACT-2" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序会定义过于宽松的跨源资源共享 (CORS) 策略。</p>
<h5 id="EXPLANATION-2"><a href="#EXPLANATION-2" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在 HTML5 以前的版本中，Web 浏览器会强制实施同源策略，以确保在使用 JavaScript 访问 Web 页面内容时，JavaScript 和 Web 页面必须来自同一个域。如果不实施同源策略，恶意网站可能就会使用客户端凭据运行从其他网站加载敏感信息的 JavaScript，并对这些信息进行提炼，然后将其返回给攻击者。如果定义了名为 Access-Control-Allow-Origin 的新 HTTP 标头，HTML5 就支持使用 JavaScript 跨域访问数据。通过此标头，Web 服务器可定义允许使用跨源请求访问服务器域的其他域。但是，定义标头时应小心谨慎，如果 CORS 策略过于宽松，恶意应用程序就能趁机采用不当方式与受害者应用程序进行通信，从而导致发生欺骗、数据被盗、转发及其他攻击。</p>
<p>示例 1：以下示例会使用通配符以编程方式指定允许与应用程序进行通信的域。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">  header(&#x27;Access-Control-Allow-Origin: *&#x27;);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>将 * 作为 Access-Control-Allow-Origin 头文件的值表明，该应用程序的数据可供在任何域上运行的 JavaScript 访问。</p>
<h5 id="RECOMMENDATIONS-2"><a href="#RECOMMENDATIONS-2" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请不要使用 * 作为 Access-Control-Allow-Origin 头文件的值。而应该提供可信赖的域的显式列表。</p>
<p>示例 2：下面的 Access-Control-Allow-Origin 标头指定了一个明确可信赖的域。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">  header(&#x27;Access-Control-Allow-Origin: www.trusted.com&#x27;);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-2"><a href="#REFERENCES-2" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] W3C Cross-Origin Resource Sharing </p>
<p>[2] Enable Cross-Origin Resource Sharing </p>
<p>[3] Michael Schmidt HTML5 Web Security </p>
<p>[4] Philippe De Ryck, Lieven Desmet, Pieter Philippaerts, and Frank Piessens A Security Analysis of Next Generation Web Standards </p>
<p>[5] Standards Mapping - Common Weakness Enumeration CWE ID 942 </p>
<p>[6] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001368, CCI-001414 </p>
<p>[7] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[9] Standards Mapping - OWASP Application Security Verification Standard 4.0 14.4.6 HTTP Security Headers Requirements, 14.5.3 Validate HTTP Request Header Requirements </p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication </p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[12] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="System-Information-Leak"><a href="#System-Information-Leak" class="headerlink" title="System Information Leak"></a>System Information Leak</h4><h5 id="ABSTRACT-3"><a href="#ABSTRACT-3" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>揭示系统数据或调试信息有助于攻击者了解系统并制定攻击计划。</p>
<h5 id="EXPLANATION-3"><a href="#EXPLANATION-3" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当系统数据或调试信息通过输出流或者日志功能流出程序时，就会发生信息泄漏。</p>
<p>示例 1：以下代码会将一个异常写入标准错误流：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    echo &quot;Server error! Printing the backtrace&quot;;</span><br><span class="line"></span><br><span class="line">    debug_print_backtrace();</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>依据这一系统配置，该信息可转储到控制台，写入日志文件，或者显示给远程用户。例如，凭借脚本机制，可以轻松将输出信息从“标准错误”或“标准输出”重定向至文件或其他程序。或者，运行程序的系统可能具有将日志发送至远程设备的远程日志记录系统，例如“syslog”服务器。在开发过程中，您无法知道此信息最终可能显示的位置。</p>
<p>在某些情况下，该错误消息会告诉攻击者该系统易遭受的确切攻击类型。例如，数据库错误消息可以揭示应用程序容易受到 SQL Injection 攻击。其他错误消息可以揭示有关该系统的更多间接线索。在Example 1中，泄露的信息可能会暗示有关操作系统类型、系统上安装了哪些应用程序以及管理员在配置程序时采取了哪些保护措施的信息。</p>
<h5 id="RECOMMENDATIONS-3"><a href="#RECOMMENDATIONS-3" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>编写错误消息时，始终要牢记安全性。在编码的过程中，尽量避免使用繁复的消息，提倡使用简短的错误消息。限制生成与存储繁复的输出数据可帮助管理员和程序员诊断问题。调试踪迹有时可能出现在不明显的位置（例如，嵌入在错误页 HTML 的注释中）。</p>
<p>即便是并未揭示栈踪迹或数据库转储的简短错误消息，也有可能帮助攻击者发起攻击。例如，”Access Denied”（拒绝访问）消息可以揭示系统中存在一个文件或用户。</p>
<h5 id="REFERENCES-3"><a href="#REFERENCES-3" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 497 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001312, CCI-001314, CCI-002420 </p>
<p>[4] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.3.4 Output Encoding and Injection Prevention Requirements, 5.3.5 Output Encoding and Injection Prevention Requirements, 8.3.2 Sensitive Private Data, 8.3.4 Sensitive Private Data, 8.3.4 Sensitive Private Data, 14.3.1 Unintended Security Disclosure Requirements, 14.3.2 Unintended Security Disclosure Requirements, 14.3.3 Unintended Security Disclosure Requirements, 14.2.2 Dependency </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6 </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5 </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.5 </p>
<p>[15] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.6 - Sensitive Data Retention </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[33] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[34] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="System-Information-Leak-External"><a href="#System-Information-Leak-External" class="headerlink" title="System Information Leak: External"></a>System Information Leak: External</h4><h5 id="ABSTRACT-4"><a href="#ABSTRACT-4" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>揭示系统数据或调试信息有助于攻击者了解系统并制定攻击计划。</p>
<h5 id="EXPLANATION-4"><a href="#EXPLANATION-4" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当系统数据或调试信息通过套接字或网络连接使程序流向远程机器时，就会发生外部信息泄露。</p>
<p>示例 1：以下代码会将一个异常写入 HTTP 响应：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    echo &quot;Server error! Printing the backtrace&quot;;</span><br><span class="line"></span><br><span class="line">    debug_print_backtrace();</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>依据这一系统配置，该信息可转储到控制台，写入日志文件，或者显示给远程用户。例如，凭借脚本机制，可以轻松将输出信息从“标准错误”或“标准输出”重定向至文件或其他程序。或者，运行程序的系统可能具有将日志发送至远程设备的远程日志记录系统，例如“syslog”服务器。在开发过程中，您无法知道此信息最终可能显示的位置。</p>
<p>在某些情况下，该错误消息会告诉攻击者该系统易遭受的确切攻击类型。例如，数据库错误消息可以揭示应用程序容易受到 SQL Injection 攻击。其他错误消息可以揭示有关该系统的更多间接线索。在Example 1中，泄露的信息可能会暗示有关操作系统类型、系统上安装了哪些应用程序以及管理员在配置程序时采取了哪些保护措施的信息。</p>
<h5 id="RECOMMENDATIONS-4"><a href="#RECOMMENDATIONS-4" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>编写错误消息时，始终要牢记安全性。在编码的过程中，尽量避免使用繁复的消息，提倡使用简短的错误消息。限制生成与存储繁复的输出数据可帮助管理员和程序员诊断问题。调试踪迹有时可能出现在不明显的位置（例如，嵌入在错误页 HTML 的注释中）。</p>
<p>即便是并未揭示栈踪迹或数据库转储的简短错误消息，也有可能帮助攻击者发起攻击。例如，”Access Denied”（拒绝访问）消息可以揭示系统中存在一个文件或用户。</p>
<h5 id="REFERENCES-4"><a href="#REFERENCES-4" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 215, CWE ID 489, CWE ID 497 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001312, CCI-001314, CCI-002420 </p>
<p>[4] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 8.3.4 Sensitive Private Data, 14.3.2 Unintended Security Disclosure Requirements, 14.3.3 Unintended Security Disclosure Requirements, 14.2.2 Dependency </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6 </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5 </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.5 </p>
<p>[15] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.6 - Sensitive Data Retention </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[33] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[34] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="System-Information-Leak-Internal"><a href="#System-Information-Leak-Internal" class="headerlink" title="System Information Leak: Internal"></a>System Information Leak: Internal</h4><h5 id="ABSTRACT-5"><a href="#ABSTRACT-5" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>揭示系统数据或调试信息有助于攻击者了解系统并制定攻击计划。</p>
<h5 id="EXPLANATION-5"><a href="#EXPLANATION-5" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>通过打印或日志记录功能将系统数据或调试信息发送到本地文件、控制台或屏幕时，就会发生内部信息泄露。</p>
<p>示例 1：以下代码会将一个异常写入标准错误流：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    echo &quot;Server error! Printing the backtrace&quot;;</span><br><span class="line"></span><br><span class="line">    debug_print_backtrace();</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>根据这一系统配置，该信息可能会转储到控制台、写入日志文件或公开给用户。在某些情况下，该错误消息会告诉攻击者该系统易遭受的确切攻击类型。例如，数据库错误消息可以揭示应用程序容易受到 SQL Injection 攻击。其他错误消息可以揭示有关该系统的更多间接线索。在Example 1 中，泄露的信息可能会暗示有关操作系统类型、系统上安装了哪些应用程序以及管理员在配置程序时采取了哪些保护措施的信息。</p>
<h5 id="RECOMMENDATIONS-5"><a href="#RECOMMENDATIONS-5" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>编写错误消息时，始终要牢记安全性。在编码的过程中，尽量避免使用繁复的消息，提倡使用简短的错误消息。限制生成与存储繁复的输出数据可帮助管理员和程序员诊断问题。调试踪迹有时可能出现在不明显的位置（例如，嵌入在错误页 HTML 的注释中）。</p>
<p>即便是并未揭示栈踪迹或数据库转储的简短错误消息，也有可能帮助攻击者发起攻击。例如，”Access Denied”（拒绝访问）消息可以揭示系统中存在一个文件或用户。</p>
<h5 id="REFERENCES-5"><a href="#REFERENCES-5" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 497 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001312, CCI-002420 </p>
<p>[4] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 8.3.2 Sensitive Private Data, 8.3.4 Sensitive Private Data, 8.3.4 Sensitive Private Data, 14.3.3 Unintended Security Disclosure Requirements </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6 </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5 </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.5 </p>
<p>[15] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.6 - Sensitive Data Retention </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II </p>
<p>[33] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[34] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h3 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h3><h4 id="CakePHP-Misconfiguration-Debug-Information"><a href="#CakePHP-Misconfiguration-Debug-Information" class="headerlink" title="CakePHP Misconfiguration: Debug Information"></a>CakePHP Misconfiguration: Debug Information</h4><h5 id="ABSTRACT-6"><a href="#ABSTRACT-6" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>当 CakePHP 调试级别在 1 级或以上时，可导致敏感数据写入日志文件。</p>
<h5 id="EXPLANATION-6"><a href="#EXPLANATION-6" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>CakePHP 可配置为公开调试信息，如错误、警告、SQL 指令和堆栈跟踪信息。在生产环境中，不应使用 Debug Information。 </p>
<p>例 1：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Configure::write(&#x27;debug&#x27;, 3);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Configure::write() 方法的第二个参数表示调试级别。数值越大，记录的日志信息越冗长。</p>
<h5 id="RECOMMENDATIONS-6"><a href="#RECOMMENDATIONS-6" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在生产代码中，仅可使用值 0。</p>
<p>例 2：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Configure::write(&#x27;debug&#x27;, 0);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-6"><a href="#REFERENCES-6" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] cakephp.org The Configuration Class </p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 215 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001312, CCI-001314, CCI-002420, CCI-003272 </p>
<p>[5] Standards Mapping - FIPS200 CM </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-11 Error Handling (P2) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 8.3.4 Sensitive Private Data, 14.3.2 Unintended Security Disclosure Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.5 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.6 - Sensitive Data Retention </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[40] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[41] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="CakePHP-Misconfiguration-Excessive-Session-Timeout"><a href="#CakePHP-Misconfiguration-Excessive-Session-Timeout" class="headerlink" title="CakePHP Misconfiguration: Excessive Session Timeout"></a>CakePHP Misconfiguration: Excessive Session Timeout</h4><h5 id="ABSTRACT-7"><a href="#ABSTRACT-7" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果会话超时时间过长，攻击者就会有更多时间危害用户帐户。</p>
<h5 id="EXPLANATION-7"><a href="#EXPLANATION-7" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>会话持续时间越长，攻击者危害用户帐户的机会就越大。当会话处于活动状态时，攻击者可能会强力攻击用户的密码、破解用户的无线加密密钥或者通过打开的浏览器强占会话。如果创建大量的会话，较长的会话超时时间还会阻止系统释放内存，并最终导致 denial of service。</p>
<p>例 1： 以下示例显示了配置有 low 会话安全级别的 CakePHP。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Configure::write(&#x27;Security.level&#x27;, &#x27;low&#x27;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Security.level 和 Session.timeout 设置共同定义会话的有效长度。实际会话超时时间等于 Session.timeout 乘以以下倍数之一：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x27;high&#x27; = x 10</span><br><span class="line"></span><br><span class="line">&#x27;medium&#x27; = x 100</span><br><span class="line"></span><br><span class="line">&#x27;low&#x27; = x 300</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-7"><a href="#RECOMMENDATIONS-7" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将会话超时间隔设置为 30 分钟或更少，既能使用户在一段时间内与应用程序互动，又提供了一个限制窗口攻击的合理范围。</p>
<p>例 2：以下示例将会话超时间隔设置为 20 分钟。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Configure::write(&#x27;Session.timeout&#x27;, &#x27;120&#x27;);</span><br><span class="line"></span><br><span class="line">Configure::write(&#x27;Security.level&#x27;, &#x27;high&#x27;);</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-7"><a href="#REFERENCES-7" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] cakephp.org The Configuration Class </p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 613 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000879, CCI-002361 </p>
<p>[4] Standards Mapping - FIPS200 IA </p>
<p>[5] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-12 Session Termination (P2) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.8.1 Single or Multi Factor One Time Verifier Requirements, 2.8.6 Single or Multi Factor One Time Verifier Requirements, 3.3.1 Session Logout and Timeout Requirements, 3.3.2 Session Logout and Timeout Requirements, 3.3.4 Session Logout and Timeout Requirements, 3.6.1 Re-authentication from a Federation or Assertion, 3.6.2 Re-authentication from a Federation or Assertion </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M9 Improper Session Handling </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A3 Broken Authentication and Session Management </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A7 Broken Authentication and Session Management </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A3 Broken Authentication and Session Management </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A2 Broken Authentication and Session Management </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A2 Broken Authentication </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.3, Requirement 8.5.15 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.7, Requirement 8.5.15 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8, Requirement 8.5.15 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.10, Requirement 8.1.8 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.10, Requirement 8.1.8 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.10, Requirement 8.1.8 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.10, Requirement 8.1.8 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection, Control Objective 5.3 - Authentication and Access Control </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3415 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3415 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3415 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3415 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3415 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3415 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3415 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000070 CAT II, APSC-DV-000080 CAT II, APSC-DV-001980 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000070 CAT II, APSC-DV-000080 CAT II, APSC-DV-001980 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000070 CAT II, APSC-DV-000080 CAT II, APSC-DV-001980 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000070 CAT II, APSC-DV-000080 CAT II, APSC-DV-001980 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000070 CAT II, APSC-DV-000080 CAT II, APSC-DV-001980 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000070 CAT II, APSC-DV-000080 CAT II, APSC-DV-001980 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000070 CAT II, APSC-DV-000080 CAT II, APSC-DV-001980 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000070 CAT II, APSC-DV-000080 CAT II, APSC-DV-001980 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000070 CAT II, APSC-DV-000080 CAT II, APSC-DV-001980 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000070 CAT II, APSC-DV-000080 CAT II, APSC-DV-001980 CAT II </p>
<p>[39] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Session Expiration </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Session Expiration (WASC-47) </p>
<h4 id="PHP-Misconfiguration-Missing-open-basedir-Entry"><a href="#PHP-Misconfiguration-Missing-open-basedir-Entry" class="headerlink" title="PHP Misconfiguration: Missing open_basedir Entry"></a>PHP Misconfiguration: Missing open_basedir Entry</h4><h5 id="ABSTRACT-8"><a href="#ABSTRACT-8" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果授予 PHP 程序对整个 file system 的访问权限，会使得攻击者能够读、写或者创建他们本不应具有访问权限的文件。</p>
<h5 id="EXPLANATION-8"><a href="#EXPLANATION-8" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果存在 open_basedir 配置选项，该选项会试图阻止 PHP 程序对 php.ini 文件中所指定的目录结构以外的文件执行操作。如果没有用 open_basedir 选项指定任何目录，则在 PHP 下运行的程序将被授予对本地 file system 上任意文件的完全访问权限，这会使得攻击者能够读、写或者创建他们本不应具有访问权限的文件。 </p>
<p>如果不通过 open_basedir 指定限制性的目录集，则攻击者更容易发现其他漏洞。</p>
<p>尽管 open_basedir 选项从总体上有利于保证系统的安全性，但它的实施效果却受到 race condition 的不利影响，这种状况可能会允许攻击者在某些情况下绕过该选项所定义的限制条件 [2]。在 PHP 执行访问权限检查与打开文件的两个时刻之间，存在一种 TOCTOU（检查时间，使用时间）race condition。与其他语言中 file system 的 race condition 一样，这种紊乱状况会导致攻击者能够将指向一个通过 access control 检查的文件的 symlink 替换为另一个本不能通过测试的文件，从而获得对受保护文件的访问权限。</p>
<p>这种攻击针对的漏洞大小取决于执行访问检查与打开文件这两个时刻之间的时间间隙。即使连续执行调用，现今的操作系统也无法确保在进程让出 CPU 之前将执行的代码数量。攻击者掌握了多种扩大该时间间隙的技术，以便更加容易地发起攻击，但即使是一段很短的间隙，该攻击企图也可以不断地重复，直到成功为止。</p>
<h5 id="RECOMMENDATIONS-8"><a href="#RECOMMENDATIONS-8" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>确定您的程序需要访问的最小目录集，并使用 open_basedir 选项来限制程序只能访问这些目录 [3]。 </p>
<p>为了防止在实施 open_basedir 的过程中针对 race condition 发起的攻击，请通过在 php.ini 文件中包含以下条目来禁用 PHP symlink() 函数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">disable_functions = symlink</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>与其依赖内置的 PHP 机制，不如考虑在操作系统中创建一个底层 chroot 监牢，限制 PHP 或 Web 服务器进程可访问的 file system 区域 [5]。</p>
<h5 id="REFERENCES-8"><a href="#REFERENCES-8" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] M. Achour et al. PHP Manual </p>
<p>[2] Stefan Esser PHP open_basedir Race Condition Vulnerability </p>
<p>[3] open_basedir Confusion </p>
<p>[4] Artur Maj Securing PHP </p>
<p>[5] Emmanuel Dreyfus Securing Systems with Chroot </p>
<p>[6] Standards Mapping - Common Weakness Enumeration CWE ID 284 </p>
<p>[7] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000213, CCI-002165 </p>
<p>[8] Standards Mapping - FIPS200 AC </p>
<p>[9] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[10] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1) </p>
<p>[11] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.4.2 Access Control Architectural Requirements, 1.4.4 Access Control Architectural Requirements </p>
<p>[12] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication </p>
<p>[13] Standards Mapping - OWASP Top 10 2004 A2 Broken Access Control </p>
<p>[14] Standards Mapping - OWASP Top 10 2007 A10 Failure to Restrict URL Access </p>
<p>[15] Standards Mapping - OWASP Top 10 2010 A8 Failure to Restrict URL Access </p>
<p>[16] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[17] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.2, Requirement 7.2 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.10, Requirement 7.2 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8, Requirement 7.2 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8, Requirement 7.2 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8, Requirement 7.2 </p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8, Requirement 7.2 </p>
<p>[24] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8, Requirement 7.2 </p>
<p>[25] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3480.1 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3480.1 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3480.1 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3480.1 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3480.1 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3480.1 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3480.1 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[43] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="PHP-Misconfiguration-Missing-safe-mode-exec-dir-Entry"><a href="#PHP-Misconfiguration-Missing-safe-mode-exec-dir-Entry" class="headerlink" title="PHP Misconfiguration: Missing safe_mode_exec_dir Entry"></a>PHP Misconfiguration: Missing safe_mode_exec_dir Entry</h4><h5 id="ABSTRACT-9"><a href="#ABSTRACT-9" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果将 PHP 配置为调用任意程序，会导致攻击者能执行恶意命令。</p>
<h5 id="EXPLANATION-9"><a href="#EXPLANATION-9" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果启用 safe_mode，safe_mode_exec_dir 选项会限制 PHP 仅从指定的目录执行命令。尽管禁用 safe_mode_exec_dir 条目这一做法本身并不是一种安全漏洞，但这一画蛇添足的行为可能会被攻击者利用，并结合其他漏洞制造更大的危机。</p>
<h5 id="RECOMMENDATIONS-9"><a href="#RECOMMENDATIONS-9" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>启用 safe_mode，为 safe_mode_exec_dir 指定尽可能严格的值，从而允许程序执行任何所需的本机程序，但同时又阻止攻击者执行敏感或危险程序。以下条目来自 php.ini 文件，用于限制 PHP 仅执行 /usr/bin/php 目录下的程序：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">safe_mode = &#x27;on&#x27;</span><br><span class="line"></span><br><span class="line">safe_mode_exec_dir = &#x27;/usr/bin/php&#x27;</span><br><span class="line"></span><br><span class="line">也可以通过在 Apache httpd.conf 文件中包含以下条目来设置这些选项：</span><br><span class="line"></span><br><span class="line">php_flag  safe_mode  on</span><br><span class="line"></span><br><span class="line">php_flag  safe_mode_exec_dir  /usr/bin/php</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-9"><a href="#REFERENCES-9" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] M. Achour et al. PHP Manual </p>
<p>[2] Artur Maj Securing PHP </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 553 </p>
<p>[4] Standards Mapping - FIPS200 CM </p>
<p>[5] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 12.5.1 File Download Requirements </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[11] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.6 </p>
<p>[17] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[18] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="PHP-Misconfiguration-Poor-open-basedir-Configuration"><a href="#PHP-Misconfiguration-Poor-open-basedir-Configuration" class="headerlink" title="PHP Misconfiguration: Poor open_basedir Configuration"></a>PHP Misconfiguration: Poor open_basedir Configuration</h4><h5 id="ABSTRACT-10"><a href="#ABSTRACT-10" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>open_basedir 配置可指定可以更改的工作目录。</p>
<h5 id="EXPLANATION-10"><a href="#EXPLANATION-10" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如存在，open_basedir 配置选项将试图阻止 PHP 程序在 php.ini 中指定的目录树外的文件上运行。如果使用 . 指定工作目录，则攻击者可能会使用 chdir() 更改此目录。</p>
<p>尽管 open_basedir 选项从总体上有利于保证系统的安全性，但它的实施效果却受到 race condition 的不利影响，这种状况可能会允许攻击者在某些情况下绕过该选项所定义的限制条件 [2]。在 PHP 执行访问权限检查与打开文件的两个时刻之间，存在一种 TOCTOU（检查时间，使用时间）race condition。与其他语言中 file system 的 race condition 一样，这种紊乱状况会导致攻击者能够将指向一个通过 access control 检查的文件的 symlink 替换为另一个本不能通过测试的文件，从而获得对受保护文件的访问权限。</p>
<p>这种攻击针对的漏洞大小取决于执行访问检查与打开文件这两个时刻之间的时间间隙。即使连续执行调用，现今的操作系统也无法确保在进程让出 CPU 之前将执行的代码数量。攻击者掌握了多种扩大该时间间隙的技术，以便更加容易地发起攻击，但即使是一段很短的间隙，该攻击企图也可以不断地重复，直到成功为止。</p>
<h5 id="RECOMMENDATIONS-10"><a href="#RECOMMENDATIONS-10" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>确定您的程序需要访问的最小目录集，并使用 open_basedir 选项来限制程序只能访问这些目录，而无需指定当前的工作目录。</p>
<p>为了防止在实施 open_basedir 的过程中针对 race condition 发起的攻击，请通过在 php.ini 文件中包含以下条目来禁用 PHP symlink() 函数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">disable_functions = symlink</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>与其依赖内置的 PHP 机制，不如考虑在操作系统中创建一个底层 chroot 监牢，限制 PHP 或 Web 服务器进程可访问的文件系统区域 [4]。</p>
<h5 id="REFERENCES-10"><a href="#REFERENCES-10" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] M. Achour et al. PHP Manual </p>
<p>[2] Stefan Esser PHP open_basedir Race Condition Vulnerability </p>
<p>[3] Artur Maj Securing PHP </p>
<p>[4] Emmanuel Dreyfus Securing Systems with Chroot </p>
<p>[5] Standards Mapping - Common Weakness Enumeration CWE ID 284 </p>
<p>[6] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000213, CCI-002165 </p>
<p>[7] Standards Mapping - FIPS200 AC </p>
<p>[8] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[9] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1) </p>
<p>[10] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.4.2 Access Control Architectural Requirements, 1.4.4 Access Control Architectural Requirements </p>
<p>[11] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication </p>
<p>[12] Standards Mapping - OWASP Top 10 2004 A2 Broken Access Control </p>
<p>[13] Standards Mapping - OWASP Top 10 2007 A10 Failure to Restrict URL Access </p>
<p>[14] Standards Mapping - OWASP Top 10 2010 A8 Failure to Restrict URL Access </p>
<p>[15] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[16] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.2, Requirement 7.2 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.10, Requirement 7.2 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8, Requirement 7.2 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8, Requirement 7.2 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8, Requirement 7.2 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8, Requirement 7.2 </p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8, Requirement 7.2 </p>
<p>[24] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3480.1 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3480.1 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3480.1 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3480.1 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3480.1 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3480.1 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3480.1 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[42] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="PHP-Misconfiguration-allow-url-fopen-Enabled"><a href="#PHP-Misconfiguration-allow-url-fopen-Enabled" class="headerlink" title="PHP Misconfiguration: allow_url_fopen Enabled"></a>PHP Misconfiguration: allow_url_fopen Enabled</h4><h5 id="ABSTRACT-11"><a href="#ABSTRACT-11" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>对远程文件进行操作可能会让攻击者将恶意内容注入到程序中。</p>
<h5 id="EXPLANATION-11"><a href="#EXPLANATION-11" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果启用 allow_url_fopen 选项，就可以通过 HTTP 或 FTP URL 在远程文件上执行接受文件名的 PHP 函数。该选项是在 PHP 4.0.4 中引入的，并且默认情况下是启用的，由于它可能会导致攻击者将恶意内容引入程序中，因此具有危险性。最理想的情况是，攻击者篡改了远程文件来引入到恶意内容，因此对远程文件进行操作导致应用程序容易受到攻击。最糟糕的情况是，攻击者控制了运行应用程序的 URL，这样一来，攻击者就可以将一个 URL 提供给远程服务器，从而可以将任意恶意内容注入到应用程序中。 </p>
<p>例 1：以下代码可打开一个文件并读取其内容，文件名由一个请求参数控制。由于 $file 的值由一个请求参数控制，因此攻击者有可能违背程序员的假设，将一个 URL 提供给远程文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$file = fopen ($_GET[&quot;file&quot;], &quot;r&quot;);</span><br><span class="line"></span><br><span class="line">if (!$file) &#123;</span><br><span class="line"></span><br><span class="line">    // handle errors</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">while (!feof ($file)) &#123;</span><br><span class="line"></span><br><span class="line">    $line = fgets ($file, 1024);</span><br><span class="line"></span><br><span class="line">    // operate on file content</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fclose($file);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-11"><a href="#RECOMMENDATIONS-11" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>不要允许任意 file system 函数访问远程文件。而应使用来自 libcurl 的 cURL 函数在必要时显式授予对远程文件的访问权限。 </p>
<p>例 2：以下条目来自 php.ini 文件，用于禁用 allow_url_fopen 选项：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">allow_url_fopen = &#x27;off&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>也可以通过在 Apache httpd.conf 文件中包含以下条目来禁用 allow_url_fopen 选项：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php_flag  allow_url_fopen  off</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-11"><a href="#REFERENCES-11" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] M. Achour et al. PHP Manual </p>
<p>[2] PHP Security Consortium PhpSecInfo Test Information </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 94 </p>
<p>[4] Standards Mapping - Common Weakness Enumeration Top 25 2019 [18] CWE ID 094 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001167 </p>
<p>[6] Standards Mapping - FIPS200 CM </p>
<p>[7] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-18 Mobile Code (P2) </p>
<p>[9] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.2.5 Sanitization and Sandboxing Requirements, 5.2.8 Sanitization and Sandboxing Requirements, 5.3.6 Output Encoding and Injection Prevention Requirements </p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[20] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[21] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 094 </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3600 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3600 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3600 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3600 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3600 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3600 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3600 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-003300 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-003300 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-003300 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-003300 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-003300 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-003300 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-003300 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-003300 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-003300 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-003300 CAT II </p>
<p>[39] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="PHP-Misconfiguration-allow-url-include-Enabled"><a href="#PHP-Misconfiguration-allow-url-include-Enabled" class="headerlink" title="PHP Misconfiguration: allow_url_include Enabled"></a>PHP Misconfiguration: allow_url_include Enabled</h4><h5 id="ABSTRACT-12"><a href="#ABSTRACT-12" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>包含那些引用远程文件的指令可能会造成攻击者将恶意内容注入程序中。</p>
<h5 id="EXPLANATION-12"><a href="#EXPLANATION-12" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果启用 allow_url_include 选项，会导致用于指定在当前页面包含某个文件的 PHP 函数，如 include() 和 require()，接受指向远程文件的 HTTP 或 FTP URL。该选项是在 PHP 5.2.0 中引入的，并且默认情况下被禁用，由于它可能会导致攻击者将恶意内容引入程序中，因此具有危险性。最理想的情况是，攻击者篡改了远程文件来引入恶意内容，因此包含远程文件导致应用程序容易受到攻击。最糟糕的情况是，攻击者控制了应用程序用来指定要包含的远程文件的 URL，这样一来，攻击者就可以将一个 URL 提供给远程服务器，从而可以将任意恶意内容注入应用程序中。</p>
<h5 id="RECOMMENDATIONS-12"><a href="#RECOMMENDATIONS-12" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果启用 allow_url_include 选项，会导致用于指定在当前页面包含某个文件的 PHP 函数，如 include() 和 require()，接受指向远程文件的 HTTP 或 FTP URL。该选项是在 PHP 5.2.0 中引入的，并且默认情况下被禁用，由于它可能会导致攻击者将恶意内容引入程序中，因此具有危险性。最理想的情况是，攻击者篡改了远程文件来引入恶意内容，因此包含远程文件导致应用程序容易受到攻击。最糟糕的情况是，攻击者控制了应用程序用来指定要包含的远程文件的 URL，这样一来，攻击者就可以将一个 URL 提供给远程服务器，从而可以将任意恶意内容注入应用程序中。</p>
<p>建议：</p>
<p>不允许使用远程包含指令。以下条目来自 php.ini 文件，用于禁用 allow_url_include 选项：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">allow_url_include = &#x27;off&#x27;</span><br></pre></td></tr></table></figure>
<p>也可以通过在 Apache httpd.conf 文件中包含以下条目来禁用 allow_url_include 选项：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php_flag  allow_url_include  off</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-12"><a href="#REFERENCES-12" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] M. Achour et al. PHP Manual </p>
<p>[2] PHP Security Consortium PhpSecInfo Test Information </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 94 </p>
<p>[4] Standards Mapping - Common Weakness Enumeration Top 25 2019 [18] CWE ID 094 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001167 </p>
<p>[6] Standards Mapping - FIPS200 CM </p>
<p>[7] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-18 Mobile Code (P2) </p>
<p>[9] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.2.5 Sanitization and Sandboxing Requirements, 5.2.8 Sanitization and Sandboxing Requirements, 5.3.6 Output Encoding and Injection Prevention Requirements </p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[12] Standards Mapping - OWASP Top 10 2007 A3 Malicious File Execution </p>
<p>[13] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[14] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[15] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.3 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[23] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 094 </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3600 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3600 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3600 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3600 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3600 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3600 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3600 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-003300 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-003300 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-003300 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-003300 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-003300 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-003300 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-003300 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-003300 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-003300 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-003300 CAT II </p>
<p>[41] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="PHP-Misconfiguration-cgi-force-redirect-Disabled"><a href="#PHP-Misconfiguration-cgi-force-redirect-Disabled" class="headerlink" title="PHP Misconfiguration: cgi.force_redirect Disabled"></a>PHP Misconfiguration: cgi.force_redirect Disabled</h4><h5 id="ABSTRACT-13"><a href="#ABSTRACT-13" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果允许用户通过 Web 直接调用 PHP 解释器，可能会让攻击者绕过权限检查而访问服务器上的受保护文件。</p>
<h5 id="EXPLANATION-13"><a href="#EXPLANATION-13" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果 PHP 解释器作为 CGI 二进制码来安装，则对 PHP 资源的请求通常会被 Web 服务器重定向到该解释器。在这种情况下，当用户请求 <a target="_blank" rel="noopener" href="http://www.example.com/content/page.php">http://www.example.com/content/page.php</a> 时，服务器首先会对 /content 目录执行必要的 access control 检查，然后将访问控制重定向到 PHP 解释器，同时发出对 <a target="_blank" rel="noopener" href="http://www.example.com/cgi-bin/php/content/page.php">http://www.example.com/cgi-bin/php/content/page.php</a> 的请求。</p>
<p>如果禁用 cgi.force_redirect 选项（该选项默认情况下是启用的），对 /cgi-bin/php 目录具有访问权限的攻击者就可以利用 PHP 解释器权限访问任意 Web 文档，从而绕过服务器将执行的任何 access control 检查。</p>
<h5 id="RECOMMENDATIONS-13"><a href="#RECOMMENDATIONS-13" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果您将 PHP 作为 CGI 二进制码运行，并且您的服务器支持该操作，请启用 cgi.force_redirect 选项。PHP 支持一种适用于多种服务器的直接模块接口，这些服务器包括 Apache、Microsoft IIS、Netscape 和 iPlanet。如果服务器要求您禁用 cgi.force_redirect 选项，以便将 PHP 作为 CGI 二进制码来运行，请慎重考虑将 PHP 作为 CGI 二进制码运行所获得的功能是否值得您冒此安全风险。</p>
<p>以下条目来自 php.ini 文件，用于启用 cgi.force_redirect 选项：</p>
<p><code>cgi.force_redirect = &#39;on&#39;</code></p>
<p>也可以通过在 Apache httpd.conf 文件中包含以下条目来启用cgi.force_redirect选项：</p>
<p><code>php_flag  cgi.force_redirect  on</code></p>
<h5 id="REFERENCES-13"><a href="#REFERENCES-13" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] M. Achour et al. PHP Manual </p>
<p>[2] PHP Security Consortium PhpSecInfo Test Information </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 305 </p>
<p>[4] Standards Mapping - Common Weakness Enumeration Top 25 2019 [13] CWE ID 287 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000213, CCI-002165 </p>
<p>[6] Standards Mapping - FIPS200 AC </p>
<p>[7] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1) </p>
<p>[9] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.7.1 Out of Band Verifier Requirements, 2.7.2 Out of Band Verifier Requirements, 2.7.3 Out of Band Verifier Requirements, 2.8.4 Single or Multi Factor One Time Verifier Requirements, 2.8.5 Single or Multi Factor One Time Verifier Requirements, 3.7.1 Defenses Against Session Management Exploits, 9.2.3 Server Communications Security Requirements </p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication </p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A2 Broken Access Control </p>
<p>[12] Standards Mapping - OWASP Top 10 2007 A10 Failure to Restrict URL Access </p>
<p>[13] Standards Mapping - OWASP Top 10 2010 A8 Failure to Restrict URL Access </p>
<p>[14] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[15] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.2, Requirement 7.2 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.10, Requirement 7.2 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8, Requirement 7.2 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8, Requirement 7.2 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8, Requirement 7.2 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8, Requirement 7.2 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8, Requirement 7.2 </p>
<p>[23] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3480.1 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3480.1 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3480.1 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3480.1 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3480.1 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3480.1 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3480.1 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[41] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="PHP-Misconfiguration-enable-dl-Enabled"><a href="#PHP-Misconfiguration-enable-dl-Enabled" class="headerlink" title="PHP Misconfiguration: enable_dl Enabled"></a>PHP Misconfiguration: enable_dl Enabled</h4><h5 id="ABSTRACT-14"><a href="#ABSTRACT-14" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>采用 dl 的动态加载可用于避开 open_basedir 限制。</p>
<h5 id="EXPLANATION-14"><a href="#EXPLANATION-14" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>enable_dl 配置允许动态加载库。这些可能会导致攻击者可以避开通过 open_basedir 配置设置的限制，并可能会允许访问系统中的任何文件。</p>
<p>启用 enable_dl 可能使攻击者更容易利用其他漏洞。</p>
<h5 id="RECOMMENDATIONS-14"><a href="#RECOMMENDATIONS-14" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>禁用 enable_dl 或启用 safe_mode 设置。启用 safe_mode 可以阻止函数 dl() 的运行，但应禁用 enable_dl 以防止未来可能会发生的任何配置更改。</p>
<p>与其依赖内置的 PHP 机制，不如考虑在操作系统中创建一个底层 chroot 监牢，限制 PHP 或 Web 服务器进程可访问的文件系统区域 [2]。</p>
<h5 id="REFERENCES-14"><a href="#REFERENCES-14" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] M. Achour et al. PHP Manual </p>
<p>[2] Emmanuel Dreyfus Securing Systems with Chroot </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 284 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000213, CCI-002165 </p>
<p>[5] Standards Mapping - FIPS200 AC </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.4.2 Access Control Architectural Requirements, 1.4.4 Access Control Architectural Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A2 Broken Access Control </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A10 Failure to Restrict URL Access </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A8 Failure to Restrict URL Access </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.2, Requirement 7.2 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.10, Requirement 7.2 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8, Requirement 7.2 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8, Requirement 7.2 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8, Requirement 7.2 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8, Requirement 7.2 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8, Requirement 7.2 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3480.1 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3480.1 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3480.1 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3480.1 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3480.1 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3480.1 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3480.1 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="PHP-Misconfiguration-file-uploads-Enabled"><a href="#PHP-Misconfiguration-file-uploads-Enabled" class="headerlink" title="PHP Misconfiguration: file_uploads Enabled"></a>PHP Misconfiguration: file_uploads Enabled</h4><h5 id="ABSTRACT-15"><a href="#ABSTRACT-15" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>允许用户上传文件可能会让攻击者注入危险内容或者执行恶意代码</p>
<h5 id="EXPLANATION-15"><a href="#EXPLANATION-15" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果启用 file_uploads 选项，可能会让 PHP 用户将任意文件上传到服务器中。允许用户上传文件这一功能本身并不代表一种安全漏洞。但是，这一功能可能会引起一系列的攻击，因为它让恶意用户能够随意向服务器环境中引入数据。 </p>
<p>无论编写程序所用的语言是什么，最具破坏性的攻击通常都会涉及执行远程代码，攻击者借此可在程序上下文中成功执行恶意代码。如果允许攻击者向某个可通过 Web 访问的目录上传文件，并能够将这些文件传递给 PHP 解释器，他们就能促使这些文件中包含的恶意代码在服务器上执行。 </p>
<p>示例 1：以下代码会处理上传的文件，并将它们移到 Web 根目录下的一个目录中。攻击者可以将恶意的 PHP 源文件上传到该程序中，并随后从服务器中请求这些文件，这会促使 PHP 解析器执行这些文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$udir = &#x27;upload/&#x27;; // Relative path under Web root</span><br><span class="line"></span><br><span class="line">$ufile = $udir . basename($_FILES[&#x27;userfile&#x27;][&#x27;name&#x27;]);</span><br><span class="line"></span><br><span class="line">if (move_uploaded_file($_FILES[&#x27;userfile&#x27;][&#x27;tmp_name&#x27;], $ufile)) &#123;</span><br><span class="line"></span><br><span class="line">    echo &quot;Valid upload received\n&quot;;</span><br><span class="line"></span><br><span class="line">&#125; else &#123;</span><br><span class="line"></span><br><span class="line">    echo &quot;Invalid upload rejected\n&quot;;</span><br><span class="line"></span><br><span class="line">&#125; ?&gt;</span><br></pre></td></tr></table></figure>
<p>即使程序将上传的文件存储在一个无法通过 Web 访问的目录中，攻击者仍然有可能通过向服务器环境引入恶意内容来发动其他攻击。如果程序容易出现 path manipulation、command injection 或 remote include 漏洞，那么攻击者就可能上传带恶意内容的文件，并利用另一种漏洞促使程序读取或执行该文件。</p>
<h5 id="RECOMMENDATIONS-15"><a href="#RECOMMENDATIONS-15" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>除非程序特别要求用户上传文件，否则请通过在 php.ini 文件中包含以下条目来禁用 file_uploads 选项：</p>
<p><code>file_uploads = &#39;off&#39;</code></p>
<p>也可以通过在 Apache httpd.conf 文件中包含以下条目来禁用 file_uploads 选项：</p>
<p><code>php_flag  file_uploads  off</code></p>
<p>如果程序必须允许文件上传，则应当只接受程序需要的特定类型的内容，从而阻止攻击者提供恶意内容。大多数依赖于上传的内容所发起的攻击都需要攻击者能够提供他们所选的内容，限制这种内容可以大大减小构成攻击的可能性。</p>
<p>例 2：下面的代码演示了一种严重受限的文件上传机制，这种机制将上传的内容存储在一个无法通过 Web 访问的目录中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">`</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$udir = &#x27;/var/spool/uploads/&#x27;; # Outside of Web root</span><br><span class="line"></span><br><span class="line">$ufile = $udir . basename($_FILES[&#x27;userfile&#x27;][&#x27;name&#x27;]);</span><br><span class="line"></span><br><span class="line">if (move_uploaded_file($_FILES[&#x27;userfile&#x27;][&#x27;tmp_name&#x27;], $ufile)) &#123;</span><br><span class="line"></span><br><span class="line">    echo &quot;Valid upload received\n&quot;;</span><br><span class="line"></span><br><span class="line">&#125; else &#123;</span><br><span class="line"></span><br><span class="line">    echo &quot;Invalid upload rejected\n&quot;;</span><br><span class="line"></span><br><span class="line">&#125; ?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>尽管这种机制可阻止攻击者直接请求上传的文件，但它对针对程序中存在的其他漏洞发起的攻击没有任何作用，这些漏洞也能让攻击者利用上传的内容。阻止这种攻击的最好方法是，使攻击者难以破译上传的文件的名称和位置。这种解决方法通常是因程序而异的，并且在以下几个方面各不相同：将上传的文件存储在一个目录中（目录名称是在程序初始化时通过强随机值生成的）、为每个上传的文件分配一个随机名称，以及利用数据库中的条目跟踪这些文件 [3]。</p>
<h5 id="REFERENCES-15"><a href="#REFERENCES-15" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] M. Achour et al. PHP Manual </p>
<p>[2] PHP Security Consortium PhpSecInfo Test Information </p>
<p>[3] Alla Bezroutchko Secure file upload in PHP web applications </p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 434 </p>
<p>[5] Standards Mapping - Common Weakness Enumeration Top 25 2019 [16] CWE ID 434 </p>
<p>[6] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001167 </p>
<p>[7] Standards Mapping - FIPS200 CM </p>
<p>[8] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[9] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-18 Mobile Code (P2) </p>
<p>[10] Standards Mapping - OWASP Application Security Verification Standard 4.0 12.2.1 File Integrity Requirements, 12.5.2 File Download Requirements, 13.1.5 Generic Web Service Security Verification Requirements </p>
<p>[11] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[12] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[13] Standards Mapping - OWASP Top 10 2007 A3 Malicious File Execution </p>
<p>[14] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[15] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[16] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.3 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[23] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-003300 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-003300 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-003300 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-003300 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-003300 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-003300 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-003300 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-003300 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-003300 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-003300 CAT II </p>
<p>[34] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="PHP-Misconfiguration-magic-quotes-gpc-Enabled"><a href="#PHP-Misconfiguration-magic-quotes-gpc-Enabled" class="headerlink" title="PHP Misconfiguration: magic_quotes_gpc Enabled"></a>PHP Misconfiguration: magic_quotes_gpc Enabled</h4><h5 id="ABSTRACT-16"><a href="#ABSTRACT-16" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>避免自动输入这一方法收效甚微，对许多攻击类型起不到任何防范作用。</p>
<h5 id="EXPLANATION-16"><a href="#EXPLANATION-16" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果启用 magic_quotes_gpc 和 magic_quotes_runtime 配置选项，它们会导致 PHP 自动转义输入中所有的 ‘（单引号）、”（双引号）、\（斜杠）及 NUL 字符，输入内容可通过 Web（GET、POST、以及 Cookie 或 GPC）和其他输入源（数据库、file system 等或运行时环境）分别读取。这种在服务器级别执行输入验证的做法非常软弱无力，难以防范 SQL injection 类型的攻击（尽管它就是被设计成针对这种漏洞提供保护的），对于那些针对 Web 应用程序发起的其他攻击更没有任何防范作用。正是由于认识到它们的不足之处，从 PHP 6 开始已经弃用并删除了这两个选项。</p>
<h5 id="RECOMMENDATIONS-16"><a href="#RECOMMENDATIONS-16" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>不要使用或依赖于 magic_quotes_gpc 和 magic_quotes_runtime 配置选项。在早于 6.0 的 PHP 版本中，通过在 php.ini 文件中包含以下条目来显式禁用这两个配置选项：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">magic_quotes_gpc = &#x27;off&#x27;</span><br><span class="line"></span><br><span class="line">magic_quotes_runtime = &#x27;off&#x27;</span><br></pre></td></tr></table></figure>
<p>也可以通过在 Apache httpd.conf 文件中包含以下条目来禁用magic_quotes_gpc和magic_quotes_runtime选项：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">php_flag  magic_quotes_gpc  off</span><br><span class="line"></span><br><span class="line">php_flag  magic_quotes_runtime  off</span><br></pre></td></tr></table></figure>
<p>不要奢望能够自动避开故障，而应基于目前可用的最强的验证机制，针对上下文执行适当的输入验证。最强的输入验证形式采用一种迂回战术：创建一个合法值列表，用户可以指定其中的值，并且只能从该列表中选择值。通过这种方法，用户就不能直接由自己来指定资源的名称了。</p>
<p>在某些情况下，这种方法是不切实际的，因为合法输入值集过大，或者很难跟踪。因此，程序员通常在这种情况下采用黑名单的办法。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。但是，任何这样一份黑名单都不可能是完整的，而且将随着时间的推移而过时。更好的方法是创建一份白名单，允许其中的字符出现在资源名称中，且只接受完全由这些被认可的字符组成的输入。</p>
<h5 id="REFERENCES-16"><a href="#REFERENCES-16" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] M. Achour et al. PHP Manual </p>
<p>[2] PHP Security Consortium PhpSecInfo Test Information </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 20 </p>
<p>[4] Standards Mapping - Common Weakness Enumeration Top 25 2019 [3] CWE ID 020 </p>
<p>[5] Standards Mapping - FIPS200 CM </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.1.3 Input Validation Requirements, 5.1.4 Input Validation Requirements </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[12] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.6 </p>
<p>[18] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[19] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 020 </p>
<p>[20] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="PHP-Misconfiguration-magic-quotes-runtime-Enabled"><a href="#PHP-Misconfiguration-magic-quotes-runtime-Enabled" class="headerlink" title="PHP Misconfiguration: magic_quotes_runtime Enabled"></a>PHP Misconfiguration: magic_quotes_runtime Enabled</h4><h5 id="ABSTRACT-17"><a href="#ABSTRACT-17" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>避免自动输入这一方法收效甚微，对许多攻击类型起不到任何防范作用。</p>
<h5 id="EXPLANATION-17"><a href="#EXPLANATION-17" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果启用 magic_quotes_gpc 和 magic_quotes_runtime 配置选项，它们会导致 PHP 自动转义输入中所有的 ‘（单引号）、”（双引号）、\（斜杠）及 NUL 字符，输入内容可通过 Web（GET、POST、以及 Cookie 或 GPC）和其他输入源（数据库、file system 等或运行时环境）分别读取。这种在服务器级别执行输入验证的做法非常软弱无力，难以防范 SQL injection 类型的攻击（尽管它就是被设计成针对这种漏洞提供保护的），对于那些针对 Web 应用程序发起的其他攻击更没有任何防范作用。正是由于认识到它们的不足之处，从 PHP 6 开始已经弃用并删除了这两个选项。</p>
<h5 id="RECOMMENDATIONS-17"><a href="#RECOMMENDATIONS-17" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>不要使用或依赖于 magic_quotes_gpc 和 magic_quotes_runtime 配置选项。在早于 6.0 的 PHP 版本中，通过在 php.ini 文件中包含以下条目来显式禁用这两个配置选项：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">magic_quotes_gpc = &#x27;off&#x27;</span><br><span class="line"></span><br><span class="line">magic_quotes_runtime = &#x27;off&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>也可以通过在 Apache httpd.conf 文件中包含以下条目来禁用 magic_quotes_gpc 和 magic_quotes_runtime 选项：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">php_flag  magic_quotes_gpc  off</span><br><span class="line"></span><br><span class="line">php_flag  magic_quotes_runtime  off</span><br></pre></td></tr></table></figure>
<p>不要奢望能够自动避开故障，而应基于目前可用的最强的验证机制，针对上下文执行适当的输入验证。最强的输入验证形式采用一种迂回战术：创建一个合法值列表，用户可以指定其中的值，并且只能从该列表中选择值。通过这种方法，用户就不能直接由自己来指定资源的名称了。 </p>
<p>在某些情况下，这种方法是不切实际的，因为合法输入值集过大，或者很难跟踪。因此，程序员通常在这种情况下采用黑名单的办法。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。但是，任何这样一份黑名单都不可能是完整的，而且将随着时间的推移而过时。更好的方法是创建一份白名单，允许其中的字符出现在资源名称中，且只接受完全由这些被认可的字符组成的输入。</p>
<h5 id="REFERENCES-17"><a href="#REFERENCES-17" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] M. Achour et al. PHP Manual </p>
<p>[2] PHP Security Consortium PhpSecInfo Test Information </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 20 </p>
<p>[4] Standards Mapping - Common Weakness Enumeration Top 25 2019 [3] CWE ID 020 </p>
<p>[5] Standards Mapping - FIPS200 CM </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.1.3 Input Validation Requirements, 5.1.4 Input Validation Requirements </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[12] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.6 </p>
<p>[18] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[19] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 020 </p>
<p>[20] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="PHP-Misconfiguration-magic-quotes-sybase-Enabled"><a href="#PHP-Misconfiguration-magic-quotes-sybase-Enabled" class="headerlink" title="PHP Misconfiguration: magic_quotes_sybase Enabled"></a>PHP Misconfiguration: magic_quotes_sybase Enabled</h4><h5 id="ABSTRACT-18"><a href="#ABSTRACT-18" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>避免自动输入这一方法收效甚微，对许多攻击类型起不到任何防范作用。</p>
<h5 id="EXPLANATION-18"><a href="#EXPLANATION-18" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果启用，且 magic_quotes_gpc 或 magic_quotes_runtime 同时启用，则 magic_quotes_sybase 配置选项会用单引号而不是反斜杠对单引号进行转义。它还会完全覆盖 magic_quotes_gpc。在这种情况下，即使启用 magic_quotes_gpc ，无论双引号、反斜杠还是 NUL 均不会进行转义。 </p>
<p>如果启用 magic_quotes_gpc 和 magic_quotes_runtime 配置选项，它们会导致 PHP 自动转义输入中所有的 ‘（单引号）、”（双引号）、\（斜杠）及 NUL 字符，输入内容可通过 Web（GET、POST、以及 Cookie 或 GPC）和其他输入源（数据库、文件系统等或运行时环境）分别读取。这种在服务器级别执行输入验证的做法非常软弱无力，难以防范 SQL injection 类型的攻击（尽管它就是被设计成针对这种漏洞提供保护的），对于那些针对 Web 应用程序发起的其他攻击更没有任何防范作用。正是由于认识到它们的不足之处，此功能已从 PHP 5.3.0 开始弃用并从 PHP 5.4.0 开始删除。magic_quotes_gpc 和 magic_quotes_runtime 已从 PHP 6 中弃用并删除。</p>
<h5 id="RECOMMENDATIONS-18"><a href="#RECOMMENDATIONS-18" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>不要使用或依赖于 magic_quotes_sybase 配置选项。在早于 5.3.0 的 PHP 版本中，通过在 php.ini 文件中包含以下条目来显式禁用这两个配置选项：</p>
<p><code>magic_quotes_sybase = &#39;off&#39;</code></p>
<p>也可以通过在 Apache httpd.conf 文件中包含以下条目来禁用 magic_quotes_sybase 选项：</p>
<p><code>php_flag  magic_quotes_sybase  off</code></p>
<p>不要奢望能够自动避开故障，而应基于目前可用的最强的验证机制，针对上下文执行适当的输入验证。最强的输入验证形式采用一种迂回战术：创建一个合法值列表，用户可以指定其中的值，并且只能从该列表中选择值。通过这种方法，用户就不能直接由自己来指定资源的名称了。 </p>
<p>在某些情况下，这种方法是不切实际的，因为合法输入值集过大，或者很难跟踪。因此，程序员通常在这种情况下采用黑名单的办法。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。但是，任何这样一份黑名单都不可能是完整的，而且将随着时间的推移而过时。更好的方法是创建一份白名单，允许其中的字符出现在资源名称中，且只接受完全由这些被认可的字符组成的输入。</p>
<h5 id="REFERENCES-18"><a href="#REFERENCES-18" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] M. Achour et al. PHP Manual </p>
<p>[2] PHP Security Consortium PhpSecInfo Test Information </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 20 </p>
<p>[4] Standards Mapping - Common Weakness Enumeration Top 25 2019 [3] CWE ID 020 </p>
<p>[5] Standards Mapping - FIPS200 CM </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.1.3 Input Validation Requirements, 5.1.4 Input Validation Requirements </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[12] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.6 </p>
<p>[18] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[19] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 020 </p>
<p>[20] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="PHP-Misconfiguration-register-globals-Enabled"><a href="#PHP-Misconfiguration-register-globals-Enabled" class="headerlink" title="PHP Misconfiguration: register_globals Enabled"></a>PHP Misconfiguration: register_globals Enabled</h4><h5 id="ABSTRACT-19"><a href="#ABSTRACT-19" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果将 PHP 配置为对所有的 Environment、GET、POST、Cookie 及 Server 变量进行全局注册，会导致意外行为，使系统容易受到攻击者的攻击。</p>
<h5 id="EXPLANATION-19"><a href="#EXPLANATION-19" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果启用 register_globals 选项，会导致 PHP 对 EGPCS（Environment、GET、POST、Cookie 及 Server）变量进行全局注册，这样一来，任何用户在任何 PHP 程序中都将能访问这些变量。如果程序员在编写程序时启用此选项，或多或少都会导致程序察觉不到它们所依赖于的数值来源，这会导致运行正常的环境发生意外行为，使系统容易受到恶意环境中的攻击者发起的攻击。由于认识到 register_globals 所隐含的安全隐患，在 PHP 4.2.0 中默认禁用了该选项，而在 PHP 6 中弃用并删除了该选项。</p>
<p>示例 1：以下代码容易受到 cross-site scripting 攻击。程序员假定 <code>$username</code>的值来源于由服务器控制的会话，但是攻击者可能会为 <code>$username</code> 提供一个恶意值来代替请求参数。如果启用 register_globals 选项，此代码会在它所生成的 HTML 内容中包含由攻击者提交的恶意值。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if (isset($username)) &#123;</span><br><span class="line"></span><br><span class="line">    echo &quot;Hello &lt;b&gt;$username&lt;/b&gt;&quot;;</span><br><span class="line"></span><br><span class="line">&#125; else &#123;</span><br><span class="line"></span><br><span class="line">    echo &quot;Hello &lt;b&gt;Guest&lt;/b&gt;&lt;br /&gt;&quot;;</span><br><span class="line"></span><br><span class="line">    echo &quot;Would you like to login?&quot;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-19"><a href="#RECOMMENDATIONS-19" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>不要使用或依赖于 register_globals 选项。在早于 6.0 的 PHP 版本中，通过在 php.ini 中包含以下条目显式禁用了 register_globals 选项：</p>
<p><code>register_globals = &#39;off&#39;</code></p>
<p>也可以通过在 Apache httpd.conf 文件中包含以下条目来禁用 register_globals 选项：</p>
<p><code>php_flag  register_globals  off</code></p>
<h5 id="REFERENCES-19"><a href="#REFERENCES-19" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] M. Achour et al. PHP Manual </p>
<p>[2] Artur Maj Securing PHP </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 473 </p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[6] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[7] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[8] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.10 </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.10 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.10 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.10 </p>
<p>[14] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[15] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="PHP-Misconfiguration-safe-mode-Disabled"><a href="#PHP-Misconfiguration-safe-mode-Disabled" class="headerlink" title="PHP Misconfiguration: safe_mode Disabled"></a>PHP Misconfiguration: safe_mode Disabled</h4><h5 id="ABSTRACT-20"><a href="#ABSTRACT-20" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果允许 PHP 脚本访问服务器上的任意文件，会使得攻击者能够操纵敏感文件或者执行恶意命令。</p>
<h5 id="EXPLANATION-20"><a href="#EXPLANATION-20" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>safe_mode 选项是 PHP 中最重要的 security features 之一。如果禁用 safe_mode 选项，PHP 会以调用它的用户所具有的权限对文件进行操作，而该用户通常是一个特权用户。尽管将 PHP 配置为禁用 safe_mode，这一做法本身不会引发安全漏洞，但这一画蛇添足的行为可能会被攻击者利用，并结合其他漏洞制造更大的危机。</p>
<h5 id="RECOMMENDATIONS-20"><a href="#RECOMMENDATIONS-20" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>启用 safe_mode 选项，以防止攻击者获取对敏感文件的访问权限；可通过在 php.ini 中包含以下条目来启用该选项：</p>
<p><code>safe_mode = &#39;on&#39;</code></p>
<p>也可以通过在 Apache httpd.conf 文件中包含以下条目来启用该选项：</p>
<p><code>php_flag  safe_mode  on</code></p>
<h5 id="REFERENCES-20"><a href="#REFERENCES-20" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] M. Achour et al. PHP Manual </p>
<p>[2] Artur Maj Securing PHP </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 552 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000381, CCI-002233, CCI-002235 </p>
<p>[5] Standards Mapping - FIPS200 CM </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-6 Least Privilege (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.12.1 Secure File Upload Architectural Requirements, 12.5.1 File Download Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000500 CAT II, APSC-DV-000510 CAT I, APSC-DV-001500 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000500 CAT II, APSC-DV-000510 CAT I, APSC-DV-001500 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000500 CAT II, APSC-DV-000510 CAT I, APSC-DV-001500 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000500 CAT II, APSC-DV-000510 CAT I, APSC-DV-001500 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000500 CAT II, APSC-DV-000510 CAT I, APSC-DV-001500 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000500 CAT II, APSC-DV-000510 CAT I, APSC-DV-001500 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000500 CAT II, APSC-DV-000510 CAT I, APSC-DV-001500 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000500 CAT II, APSC-DV-000510 CAT I, APSC-DV-001500 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000500 CAT II, APSC-DV-000510 CAT I, APSC-DV-001500 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000500 CAT II, APSC-DV-000510 CAT I, APSC-DV-001500 CAT II </p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="PHP-Misconfiguration-session-use-trans-sid-Enabled"><a href="#PHP-Misconfiguration-session-use-trans-sid-Enabled" class="headerlink" title="PHP Misconfiguration: session_use_trans_sid Enabled"></a>PHP Misconfiguration: session_use_trans_sid Enabled</h4><h5 id="ABSTRACT-21"><a href="#ABSTRACT-21" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果将 PHP 配置为通过 URL 传递会话 ID，将容易受到 session fixation 和 session hijacking 攻击。</p>
<h5 id="EXPLANATION-21"><a href="#EXPLANATION-21" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果启用 session.use_trans_sid，会导致 PHP 通过 URL 传递会话 ID，这样一来，攻击者就更容易劫持当前会话，或者哄骗用户使用已被攻击者控制的现有会话。 </p>
<p>通过 URL 传递的参数比 POST 参数和 cookie 值的可见性更好，这是因为它们通常出现在浏览器历史记录、书签、日志文件及其他高度明显的位置。如果攻击者了解到系统上某一当前会话的机密会话标识符，他们就有可能将会话标识符返回给程序，以便劫持用户会话。</p>
<p>除了 session hijacking 外，通过 URL 暴露会话 ID 还会引发 session fixation 攻击。在通常情况下，攻击者会利用 Session Fixation 漏洞在 Web 应用程序中创建一个新会话，并且记录与之关联的会话标识符。然后，攻击者会设法使受害者在服务器中的验证失败，从而通过当前会话来访问用户帐号。通过 URL 传递会话标识符使得攻击者有可能攻击一大批受害者，这种攻击的方式是将包含受到危害的会话标识符的 URL 通过电子邮件发送给受害者，或另外一种大规模通信机制来实现。</p>
<h5 id="RECOMMENDATIONS-21"><a href="#RECOMMENDATIONS-21" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>禁用 session.use_trans_sid 选项，以防止攻击者获取对会话标识符的访问权限和发动 session fixation 攻击；可通过在 php.ini 中包含以下条目来禁用该选项：</p>
<p><code>session.use_trans_sid = &#39;off&#39;</code></p>
<p>也可以通过在 Apache httpd.conf 文件中包含以下条目来禁用该选项：</p>
<p><code>php_flag  session.use_trans_sid  off</code></p>
<h5 id="REFERENCES-21"><a href="#REFERENCES-21" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] M. Achour et al. PHP Manual </p>
<p>[2] PHP Security Consortium PhpSecInfo Test Information </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 384 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001664, CCI-001941, CCI-001942 </p>
<p>[5] Standards Mapping - FIPS200 IA </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-23 Session Authenticity (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 3.2.1 Session Binding Requirements, 3.2.3 Session Binding Requirements, 3.3.1 Session Logout and Timeout Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M9 Improper Session Handling </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A3 Broken Authentication and Session Management </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A7 Broken Authentication and Session Management </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A3 Broken Authentication and Session Management </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A2 Broken Authentication and Session Management </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A2 Broken Authentication </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.3 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.7 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.10 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.10 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.10 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.10 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3090 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3405 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3405 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3405 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3405 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3405 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3405 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002270 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002270 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002270 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002270 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002270 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002270 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002270 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002270 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002270 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002270 CAT II </p>
<p>[40] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[41] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Race-Condition-PHP-Design-Flaw"><a href="#Race-Condition-PHP-Design-Flaw" class="headerlink" title="Race Condition: PHP Design Flaw"></a>Race Condition: PHP Design Flaw</h4><h5 id="ABSTRACT-22"><a href="#ABSTRACT-22" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>PHP 配置选项 open_basedir 存在一个设计缺陷，使该选项容易发生文件访问 race condition，从而可能使攻击者绕过 file system 上的 access control 检查。</p>
<h5 id="EXPLANATION-22"><a href="#EXPLANATION-22" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果启用 open_basedir 配置选项，该选项会试图阻止 PHP 程序对 php.ini 文件中所指定的目录结构以外的文件进行操作。尽管 open_basedir 选项从总体上有利于保证安全性，但它的实施效果却受到 race condition 的不利影响，这种状况可能会允许攻击者在某些情况下绕过该选项所定义的限制条件 [2]。在 PHP 执行访问权限检查与打开文件的两个时刻之间，存在一种 TOCTOU（检查时间，使用时间）race condition。与其他语言中 file system 的 race condition 一样，这一漏洞会导致攻击者能够将指向一个通过 access control 检查的文件的 symlink 替换为另一个本不能通过测试的文件，从而获得对受保护文件的访问权限。</p>
<p>这种攻击针对的漏洞大小取决于执行访问检查与打开文件这两个时刻之间的时间间隙。即使连续执行调用，现今的操作系统也无法确保在进程让出 CPU 之前将执行的代码数量。攻击者掌握了多种扩大该时间间隙的技术，以便更加容易地发起攻击，但即使是一段很短的间隙，该攻击企图也可以不断地重复，直到成功为止。</p>
<h5 id="RECOMMENDATIONS-22"><a href="#RECOMMENDATIONS-22" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>确定您的程序需要访问的最小目录集，并使用 open_basedir 选项来限制程序只能访问这些目录 [3]。 </p>
<p>为了防止在实施 open_basedir 的过程中针对 race condition 发起的攻击，请通过在 php.ini 文件中包含以下条目来禁用 PHP symlink() 函数：</p>
<p><code>disable_functions = symlink</code></p>
<p>不要奢望 PHP 机制中具备该功能，而应考虑在操作系统中创建一个底层 chroot 监牢，以限制 PHP 或 Web 服务器进程可访问的 file system 区域 [5]。</p>
<h5 id="REFERENCES-22"><a href="#REFERENCES-22" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] M. Achour et al. PHP Manual </p>
<p>[2] Stefan Esser PHP open_basedir Race Condition Vulnerability </p>
<p>[3] open_basedir Confusion </p>
<p>[4] Artur Maj Securing PHP </p>
<p>[5] Emmanuel Dreyfus Securing Systems with Chroot </p>
<p>[6] Standards Mapping - Common Weakness Enumeration CWE ID 362, CWE ID 367 </p>
<p>[7] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-003178 </p>
<p>[8] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[9] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.11.2 Business Logic Architectural Requirements, 1.11.3 Business Logic Architectural Requirements, 11.1.6 Business Logic Security Requirements </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[11] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[12] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 362 </p>
<p>[13] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 362 </p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3630.1 CAT II </p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3630.1 CAT II </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3630.1 CAT II </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3630.1 CAT II </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3630.1 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3630.1 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3630.1 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001995 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001995 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001995 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001995 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001995 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001995 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001995 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001995 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001995 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001995 CAT II </p>
<h4 id="System-Information-Leak-PHP-Errors"><a href="#System-Information-Leak-PHP-Errors" class="headerlink" title="System Information Leak: PHP Errors"></a>System Information Leak: PHP Errors</h4><h5 id="ABSTRACT-23"><a href="#ABSTRACT-23" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>泄漏数据或调试信息将会帮助攻击者了解系统和制定攻击计划。</p>
<h5 id="EXPLANATION-23"><a href="#EXPLANATION-23" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果启用 display_errors 选项，Web 中会显示发生的错误，这些错误会向攻击者明示系统的薄弱之处。例如，一个数据库错误消息可以揭示应用程序容易受到 SQL Injection 攻击。其他的错误消息可以揭示有关该系统的更多间接线索。</p>
<h5 id="RECOMMENDATIONS-23"><a href="#RECOMMENDATIONS-23" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在 PHP 5.2.4 版及更高版本中，将 display_errors 选项设置为 stderr，以便将错误输出到 stderr 而非 stdout 中。</p>
<p>以下条目来自 php.ini 文件，用于设置 disable_errors 选项以便将错误输出到 stderr 中：</p>
<p><code>disable_errors = &#39;stderr&#39;</code></p>
<p>在早期的 PHP 版本中，可完全禁用 display_errors 选项。 </p>
<p>以下条目来自 php.ini 文件，用于禁用 disable_errors 选项：</p>
<p><code>disable_errors = &#39;off&#39;</code></p>
<p>如果禁用 display_errors 选项，可使用 log_errors 和 error_log 配置选项将错误重定向到系统日志文件中，这控制着 PHP 如何在日志中记录不显示到系统输出流中的错误。 </p>
<p>以下条目来自 php.ini 文件，这些条目会使 PHP 将错误记录到由 error_file 选项指定的日志文件中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">log_errors = &#x27;on&#x27;</span><br><span class="line"></span><br><span class="line">error_file = &#x27;/hwxx/daxx/uwnetid/phperrors.log&#x27;</span><br></pre></td></tr></table></figure>
<p>也可以通过在 Apache httpd.conf 文件中包含以下条目来设置 disable_errors、log_errors 和 error_file 选项：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">php_flag  disable_errors  off</span><br><span class="line"></span><br><span class="line">php_flag  log_errors      on</span><br><span class="line"></span><br><span class="line">php_flag  error_file      /hwxx/daxx/uwnetid/phperrors.log</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-23"><a href="#REFERENCES-23" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] M. Achour et al. PHP Manual </p>
<p>[2] PHP Security Consortium PhpSecInfo Test Information </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 209, CWE ID 215 </p>
<p>[4] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001312, CCI-001314, CCI-002420, CCI-003272 </p>
<p>[6] Standards Mapping - FIPS200 CM </p>
<p>[7] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1), SI-11 Error Handling (P2) </p>
<p>[9] Standards Mapping - OWASP Application Security Verification Standard 4.0 8.3.4 Sensitive Private Data, 14.3.1 Unintended Security Disclosure Requirements, 14.3.2 Unintended Security Disclosure Requirements, 14.3.3 Unintended Security Disclosure Requirements </p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[12] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[13] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[14] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[15] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.5 </p>
<p>[23] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.6 - Sensitive Data Retention </p>
<p>[24] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 209 </p>
<p>[25] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 209 </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3120 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3120 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3120 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3120 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3120 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3120 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3120 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[43] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[44] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="System-Information-Leak-PHP-Version"><a href="#System-Information-Leak-PHP-Version" class="headerlink" title="System Information Leak: PHP Version"></a>System Information Leak: PHP Version</h4><h5 id="ABSTRACT-24"><a href="#ABSTRACT-24" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>泄漏详细系统信息将会帮助攻击者了解系统和制定攻击计划。</p>
<h5 id="EXPLANATION-24"><a href="#EXPLANATION-24" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果启用 expose_php 选项，那么由 PHP 解释器生成的每个响应都会包含主机系统上所安装的 PHP 版本。了解到远程服务器上运行的 PHP 版本后，攻击者就能针对系统枚举已知的盗取手段，从而大大增加成功发动攻击的机会。</p>
<h5 id="RECOMMENDATIONS-24"><a href="#RECOMMENDATIONS-24" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果利用 php.ini 文件中的以下条目禁用 expose_php 选项，可阻止攻击者了解关于系统的详细信息：</p>
<p><code>expose_php = &#39;off&#39;</code></p>
<p>也可以通过在 Apache httpd.conf 文件中包含以下条目来禁用 expose_php 选项：</p>
<p><code>php_flag  expose_php  off</code></p>
<h5 id="REFERENCES-24"><a href="#REFERENCES-24" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] M. Achour et al. PHP Manual </p>
<p>[2] PHP Security Consortium PhpSecInfo Test Information </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 497 </p>
<p>[4] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001312, CCI-001314, CCI-002420 </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 8.3.4 Sensitive Private Data, 14.3.3 Unintended Security Disclosure Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5 </p>
<p>[18] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.6 - Sensitive Data Retention </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[36] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[37] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h3 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h3><h4 id="Poor-Error-Handling-Empty-Catch-Block"><a href="#Poor-Error-Handling-Empty-Catch-Block" class="headerlink" title="Poor Error Handling: Empty Catch Block"></a>Poor Error Handling: Empty Catch Block</h4><h5 id="ABSTRACT-25"><a href="#ABSTRACT-25" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>忽略异常会导致程序无法发现意外状况和情况。</p>
<h5 id="EXPLANATION-25"><a href="#EXPLANATION-25" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>几乎每一个对软件系统的严重攻击都是从违反程序员的假设开始的。攻击后，程序员的假设看起来既脆弱又拙劣，但攻击前，许多程序员会在午休时间为自己的种种假设做很好的辩护。</p>
<p>在代码中，很容易发现两个令人怀疑的假设：“一是这个方法调用不可能出错；二是即使出错了，也不会对系统造成什么重要影响。”因此当程序员忽略异常时，这其实就表明了他们是基于上述假设进行的操作。</p>
<p>示例 1：下面摘录的代码会忽略一个由 doExchange() 抛出的罕见异常。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line"></span><br><span class="line">  doExchange();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">catch (exception $e) &#123;</span><br><span class="line"></span><br><span class="line">  // this can never happen</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>如果抛出 RareException 异常，程序会继续执行，就像什么都没有发生一样。程序不会记录任何有关这一特殊情况的依据，因而事后再查找这一异常就可能很困难。</p>
<h5 id="RECOMMENDATIONS-25"><a href="#RECOMMENDATIONS-25" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>至少，应该记录抛出异常的事实，以便于稍后查询及预知对程序运行所造成的影响。然而最好是中止当前操作。</p>
<p>示例 2：Example 1 中的代码可通过以下方式重写：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line"></span><br><span class="line">  doExchange();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">catch (exception $e) &#123;</span><br><span class="line"></span><br><span class="line">  error_log(&quot;A RareException has occurred!&quot;, 3, &quot;/var/log/app.log&quot;)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-25"><a href="#REFERENCES-25" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 1069 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001312, CCI-001314, CCI-003272 </p>
<p>[3] Standards Mapping - FIPS200 AU </p>
<p>[4] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-11 Error Handling (P2) </p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A7 Improper Error Handling </p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.7 </p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.2, Requirement 6.5.6 </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5 </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.5 </p>
<p>[15] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.6 - Sensitive Data Retention </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3120 CAT II </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3120 CAT II </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3120 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3120 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3120 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3120 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3120 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<h4 id="Poor-Error-Handling-Return-Inside-Finally"><a href="#Poor-Error-Handling-Return-Inside-Finally" class="headerlink" title="Poor Error Handling: Return Inside Finally"></a>Poor Error Handling: Return Inside Finally</h4><h5 id="ABSTRACT-26"><a href="#ABSTRACT-26" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>从 finally 块中返回会导致异常的丢失。</p>
<h5 id="EXPLANATION-26"><a href="#EXPLANATION-26" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>finally 块中的返回指令会导致从 try 块中抛出的异常丢失。</p>
<p>示例 1：在下列代码中，第二次调用 doMagic 方法，同时将参数 True 传递给该方法会导致抛出 exception 异常，该异常将不会传递给调用者。finally 块中的返回指令会导致异常的丢弃。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;Watch as this magical code makes an exception &quot; . </span><br><span class="line"></span><br><span class="line">        &quot;disappear before your very eyes!&quot; . PHP_EOL;</span><br><span class="line"></span><br><span class="line">echo &quot;First, the kind of exception handling &quot; .</span><br><span class="line"></span><br><span class="line">        &quot;you&#x27;re used to:&quot; . PHP_EOL;</span><br><span class="line"></span><br><span class="line">try &#123;</span><br><span class="line"></span><br><span class="line">    doMagic(False);</span><br><span class="line"></span><br><span class="line">&#125; catch (exception $e) &#123;</span><br><span class="line"></span><br><span class="line">    // An exception will be caught here</span><br><span class="line"></span><br><span class="line">    echo $e-&gt;getMessage();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">echo &quot;Now, the magic:&quot; . PHP_EOL;</span><br><span class="line"></span><br><span class="line">try &#123;</span><br><span class="line"></span><br><span class="line">    doMagic(True);</span><br><span class="line"></span><br><span class="line">&#125; catch (exception $e) &#123;</span><br><span class="line"></span><br><span class="line">    // No exception caught here, the finally block ate it</span><br><span class="line"></span><br><span class="line">    echo $e-&gt;getMessage();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">echo &quot;Tada!&quot; . PHP_EOL;</span><br><span class="line"></span><br><span class="line">function doMagic($returnFromFinally) &#123;</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line"></span><br><span class="line">        throw new Exception(&quot;Magic Exception&quot; . PHP_EOL);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    finally &#123;</span><br><span class="line"></span><br><span class="line">        if ($returnFromFinally) &#123;</span><br><span class="line"></span><br><span class="line">            return;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-26"><a href="#RECOMMENDATIONS-26" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将返回指令移到 finally 块之外。如果必须要 finally 块返回一个值，可以简单地将该返回值赋给一个本地变量，然后在 finally 块执行完毕后返回该变量。</p>
<h5 id="REFERENCES-26"><a href="#REFERENCES-26" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] ERR04-J. Do not complete abruptly from a finally block CERT</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 584 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001312, CCI-001314, CCI-003272 </p>
<p>[4] Standards Mapping - FIPS200 AU </p>
<p>[5] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-11 Error Handling (P2) </p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A7 Improper Error Handling </p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.7 </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.2, Requirement 6.5.6 </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.5 </p>
<p>[16] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.6 - Sensitive Data Retention </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3120 CAT II </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3120 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3120 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3120 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3120 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3120 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3120 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<h3 id="输入验证与展示问题"><a href="#输入验证与展示问题" class="headerlink" title="输入验证与展示问题"></a>输入验证与展示问题</h3><h4 id="Command-Injection"><a href="#Command-Injection" class="headerlink" title="Command Injection"></a>Command Injection</h4><h5 id="ABSTRACT-27"><a href="#ABSTRACT-27" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>执行不可信赖资源中的命令，或在不可信赖的环境中执行命令，都会导致程序以攻击者的名义执行恶意命令。</p>
<h5 id="EXPLANATION-27"><a href="#EXPLANATION-27" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Command Injection 漏洞主要表现为以下两种形式：</p>
<p>－ 攻击者能够篡改程序执行的命令：攻击者直接控制了所执行的命令。</p>
<p>－ 攻击者能够篡改命令的执行环境：攻击者间接地控制了所执行的命令。</p>
<p>在这种情况下，我们着重关注第一种情况，即攻击者有可能控制所执行命令。这种类型的 Command Injection 漏洞会在以下情况下出现：</p>
<ol>
<li><p>数据从不可信赖的数据源进入应用程序。</p>
</li>
<li><p>数据被用作代表应用程序所执行命令的字符串，或字符串的一部分。 </p>
</li>
<li><p>通过命令的执行，应用程序会授予攻击者一种原本不该拥有的特权或能力。 </p>
</li>
</ol>
<p>例 1：下面这段来自系统实用程序的代码根据系统属性 APPHOME 来决定其安装目录，然后根据指定目录的相对路径执行一个初始化脚本。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$home = $_ENV[&#x27;APPHOME&#x27;];</span><br><span class="line"></span><br><span class="line">$cmd = $home . $INITCMD;</span><br><span class="line"></span><br><span class="line">system(cmd);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>Example 1 中的代码可以使攻击者通过修改系统属性 APPHOME 以指向包含恶意版本 INITCMD 的其他路径来提高自己在应用程序中的权限，继而随心所欲地执行命令。由于程序不会验证从环境中读取的值，因此如果攻击者能够控制系统属性 APPHOME 的值，他们就能欺骗应用程序去运行恶意代码，从而取得系统控制权。</p>
<p>例 2：下面的代码来自一个管理 Web 应用程序，旨在使用户能够使用一个围绕 rman 实用程序的批处理文件封装器来启动 Oracle 数据库备份，然后运行一个 cleanup.bat 脚本来删除一些临时文件。脚本 rmanDB.bat 接受单个命令行参数，该参数指定了要执行的备份类型。由于访问数据库受限，所以应用程序执行备份需要具有较高权限的用户。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$btype = $_GET[&#x27;backuptype&#x27;];</span><br><span class="line"></span><br><span class="line">$cmd = &quot;cmd.exe /K \&quot;c:\\util\\rmanDB.bat &quot; . $btype . &quot;&amp;&amp;c:\\util\\cleanup.bat\&quot;&quot;;</span><br><span class="line"></span><br><span class="line">system(cmd);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这里的问题是：程序没有对读取自用户的 backuptype参数进行任何验证。通常情况下 Runtime.exec() 函数不会执行多条命令，但在这种情况下，程序会首先运行 cmd.exe shell，从而可以通过调用一次 Runtime.exec() 来执行多条命令。在调用该 shell 之后，它即会允许执行用两个与号分隔的多条命令。如果攻击者传递了一个形式为 “&amp;&amp; del c:\dbms\<em>.</em>“ 的字符串，那么应用程序将随程序指定的其他命令一起执行此命令。由于该应用程序的特性，运行该应用程序需要具备与数据库进行交互所需的权限，这就意味着攻击者注入的任何命令都将通过这些权限得以运行。</p>
<p>示例 3：下面的代码来自一个 Web 应用程序，用户可通过该应用程序提供的界面在系统上更新他们的密码。在某些网络环境中更新密码时，其中的一个步骤就是在 /var/yp 目录中运行 make 命令。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$result = shell_exec(&quot;make&quot;);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这里的问题在于程序没有在它的构造中指定一个绝对路径，并且没能在执行 Runtime.exec() 调用前清除它的环境变量。如果攻击者能够修改 <code>$PATH</code>变量，把它指向名为 make 恶意二进制代码，程序就会在其指定的环境下执行，然后加载该恶意二进制代码，而非原本期望的代码。由于应用程序自身的特性，运行该应用程序需要具备执行系统操作所需的权限，这意味着攻击者会利用这些权限执行自己的 make，从而可能导致攻击者完全控制系统。</p>
<h5 id="RECOMMENDATIONS-27"><a href="#RECOMMENDATIONS-27" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>应当禁止用户直接控制由程序执行的命令。在用户的输入会影响命令执行的情况下，应将用户输入限制为从预定的安全命令集合中进行选择。如果输入中出现了恶意的内容，传递到命令执行函数的值将默认从安全命令集合中选择，或者程序将拒绝执行任何命令。 </p>
<p>在需要将用户的输入用作程序命令中的参数时，由于合法的参数集合实在很大，或是难以跟踪，使得这个方法通常都不切实际。开发者通常的做法是使用黑名单。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。但是，任何一个定义不安全内容的列表都很可能是不完整的，并且会严重地依赖于执行命令的环境。更好的方法是创建一份白名单，允许其中的字符出现在输入中，并且只接受完全由这些经认可的字符组成的输入。</p>
<p>攻击者可以通过修改程序运行命令的环境来间接控制这些命令的执行。我们不应当完全信赖环境，还需采取预防措施，防止攻击者利用某些控制环境的手段进行攻击。无论何时，只要有可能，都应由应用程序来控制命令，并使用绝对路径执行命令。如果编译时尚不了解路径（如在跨平台应用程序中），应该在执行过程中利用可信赖的值构建一个绝对路径。应对照一系列定义有效值的常量，仔细地检查从配置文件或者环境中读取的命令值和路径。</p>
<p>有时还可以执行其他检验，以检查这些来源是否已被恶意篡改。例如，如果一个配置文件为可写，程序可能会拒绝运行。如果能够预先得知有关要执行的二进制代码的信息，程序就会进行检测，以检验这个二进制代码的合法性。如果一个二进制代码始终属于某个特定的用户，或者被指定了一组特定的访问权限，这些属性就会在执行二进制代码前通过程序进行检验。</p>
<p>尽管可能无法完全阻止强大的攻击者为了控制程序执行的命令而对系统进行的攻击，但只要程序执行外部命令，就务必使用最小授权原则：不给予超过执行该命令所必需的权限。</p>
<h5 id="REFERENCES-27"><a href="#REFERENCES-27" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 77, CWE ID 78 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [11] CWE ID 078 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001310, CCI-002754 </p>
<p>[4] Standards Mapping - FIPS200 SI </p>
<p>[5] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[6] Standards Mapping - MISRA C 2012 Rule 1.3 </p>
<p>[7] Standards Mapping - MISRA C++ 2008 Rule 0-3-1 </p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[9] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.2.2 Sanitization and Sandboxing Requirements, 5.2.3 Sanitization and Sandboxing Requirements, 5.2.5 Sanitization and Sandboxing Requirements, 5.2.8 Sanitization and Sandboxing Requirements, 5.3.6 Output Encoding and Injection Prevention Requirements, 5.3.8 Output Encoding and Injection Prevention Requirements, 10.3.2 Deployed Application Integrity Controls, 12.3.2 File Execution Requirements, 12.3.5 File Execution Requirements </p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[12] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[13] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[14] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[15] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[23] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[24] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 078 </p>
<p>[25] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 078 </p>
<p>[26] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 078 </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I </p>
<p>[43] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I </p>
<p>[44] Standards Mapping - Web Application Security Consortium 24 + 2 OS Commanding </p>
<p>[45] Standards Mapping - Web Application Security Consortium Version 2.00 OS Commanding (WASC-31) </p>
<h4 id="Cross-Site-Scripting-Persistent"><a href="#Cross-Site-Scripting-Persistent" class="headerlink" title="Cross-Site Scripting: Persistent"></a>Cross-Site Scripting: Persistent</h4><h5 id="ABSTRACT-28"><a href="#ABSTRACT-28" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>向一个 Web 浏览器发送未经验证的数据会导致该浏览器执行恶意代码。</p>
<h5 id="EXPLANATION-28"><a href="#EXPLANATION-28" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Cross-Site Scripting (XSS) 漏洞在以下情况下发生：</p>
<ol>
<li><p>数据通过一个不可信赖的数据源进入 Web 应用程序。对于 Persistent（也称为 Stored）XSS，不可信赖的数据源通常为数据库或其他后端数据存储，而对于 Reflected XSS，该数据源通常为 Web 请求。</p>
</li>
<li><p>未经验证但包含在动态内容中的数据将传送给 Web 用户。</p>
</li>
</ol>
<p>传送到 Web 浏览器的恶意内容通常采用 JavaScript 代码片段的形式，但也可能会包含一些 HTML、Flash 或者其他任意一种可以被浏览器执行的代码。基于 XSS 的攻击手段花样百出，几乎是无穷无尽的，但通常它们都会包含传输给攻击者的私人数据（如 Cookie 或者其他会话信息）。在攻击者的控制下，指引受害者进入恶意的网络内容；或者利用易受攻击的站点，对用户的机器进行其他恶意操作。</p>
<p>例 1：下面的 PHP 代码片段可根据一个给定的雇员 ID 查询数据库，并显式出相应的雇员姓名。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php...</span><br><span class="line"></span><br><span class="line"> $con = mysql_connect($server,$user,$password);</span><br><span class="line"></span><br><span class="line"> ...</span><br><span class="line"></span><br><span class="line"> $result = mysql_query(&quot;select * from emp where id=&quot;+eid);</span><br><span class="line"></span><br><span class="line"> $row = mysql_fetch_array($result)</span><br><span class="line"></span><br><span class="line"> echo &#x27;Employee name: &#x27;, mysql_result($row,0,&#x27;name&#x27;);</span><br><span class="line"></span><br><span class="line"> ...</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>如果对 name 的值处理得当，该代码就能正常地执行各种功能；如若处理不当，就会对代码的盗取行为无能为力。这段代码暴露出的危险较小，因为 name 的值是从数据库中读取的，而且显然这些内容是由应用程序管理的。然而，如果 name 的值是由用户提供的数据产生，数据库就会成为恶意内容沟通的通道。如果不对数据库中存储的所有数据进行恰当的输入验证，那么攻击者就可以在用户的 Web 浏览器中执行恶意命令。这种类型的 Persistent XSS（也称为 Stored XSS）盗取极其阴险狡猾，因为数据存储导致的间接性使得辨别威胁的难度增大，而且还提高了一个攻击影响多个用户的可能性。XSS 盗取会从访问提供留言簿 (guestbook) 的网站开始。攻击者会在这些留言簿的条目中嵌入 JavaScript，接下来所有访问该留言簿的用户都会执行这些恶意代码。</p>
<p>例 2：下面的 PHP 代码片段可从一个 HTTP 请求中读取雇员 ID eid，并将其显示给用户。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">	$eid = $_GET[&#x27;eid&#x27;];</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">	echo &quot;Employee ID: $eid&quot;;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>如Example 1 中所示，如果 eid 只包含标准的字母数字文本，此代码将会正确运行。如果 eid 中的某个值包含元字符或源代码，则 Web 浏览器就会在显示 HTTP 响应时执行该代码。</p>
<p>起初，这个例子似乎是不会轻易遭受攻击的。毕竟，有谁会输入导致恶意代码在自己电脑上运行的 URL 呢？真正的危险在于攻击者会创建恶意的 URL，然后采用电子邮件或社交工程的欺骗手段诱使受害者访问此 URL 的链接。当受害者单击这个链接时，他们不知不觉地通过易受攻击的网络应用程序，将恶意内容带到了自己的电脑中。这种对易受攻击的 Web 应用程序进行盗取的机制通常被称为反射式 XSS。</p>
<p>正如例子中所显示的，XSS 漏洞是由于 HTTP 响应中包含了未经验证的数据代码而引起的。受害者遭受 XSS 攻击的途径有三种：</p>
<ul>
<li><p>如Example 1 中所示，应用程序将危险数据存储在数据库或其他可信赖的数据存储中。这些危险数据随后会被读回到应用程序中，并包含在动态内容中。在以下情况下会发生 Persistent XSS 漏洞利用：攻击者将危险内容注入到数据存储中，而这些危险内容随后会被读取并包含在动态内容中。从攻击者的角度看，注入恶意内容的最佳位置莫过于显示给许多用户或显示给特定相关用户的区域。这些相关用户通常在应用程序中具备较高的特权，或者可以与敏感数据交互，这些数据对攻击者来说具有利用价值。如果某一个用户执行了恶意内容，攻击者就有可能以该用户的名义执行某些需要特权的操作，或者获得该用户个人敏感数据的访问权。</p>
</li>
<li><p>如Example 2 中所示，系统从 HTTP 请求中直接读取数据，并在 HTTP 响应中返回数据。当攻击者诱使用户为易受攻击的 Web 应用程序提供危险内容，而这些危险内容随后会反馈给用户并在 Web 浏览器中执行时，就会发生 Reflected XSS 漏洞利用。发送恶意内容最常用的方法是，将恶意内容作为一个参数包含在公开发布或通过电子邮件直接发送给受害者的 URL 中。以这种手段构造的 URL 已成为多种网络钓鱼阴谋的核心，攻击者会借此诱骗受害者访问指向易受攻击站点的 URL。当该站点将攻击者的内容反馈给受害者后，便会执行这些内容，接下来会将用户计算机中的各种私密信息（比如可能包含会话信息的 Cookie）传输给攻击者，或者执行其他恶意活动。</p>
</li>
<li><p>应用程序之外的数据源将危险数据储存在一个数据库或其他数据存储器中，随后这些危险数据被当作可信赖的数据回写到应用程序中，并储存在动态内容中。</p>
</li>
</ul>
<h5 id="RECOMMENDATIONS-28"><a href="#RECOMMENDATIONS-28" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>针对 XSS 的解决方法是，确保在适当位置进行验证，并检验其属性是否正确。</p>
<p>由于 XSS 漏洞在应用程序的输出中包含恶意数据时出现，因此，合乎逻辑的方法是在数据流出应用程序的前一刻对其进行验证。然而，由于 Web 应用程序常常会包含复杂而难以理解的代码，用以生成动态内容，因此，这一方法容易产生遗漏错误（遗漏验证）。降低这一风险的有效途径是对 XSS 也执行输入验证。</p>
<p>由于 Web 应用程序必须验证输入信息以避免其他漏洞（如 SQL Injection），因此，一种相对简单的解决方法是，加强一个应用程序现有的输入验证机制，将 XSS 检测包括其中。尽管有一定的价值，但 XSS 输入验证并不能取代严格的输出验证。应用程序可能通过共享的数据存储器或其他可信赖的数据源接受输入，而该数据存储器所接受的输入源可能并未执行适当的输入验证。因此，应用程序不能间接地依赖于该数据或其他任意数据的安全性。这就意味着，避免 XSS 漏洞的最佳方法是验证所有进入应用程序以及由应用程序传送至用户端的数据。</p>
<p>针对 XSS 漏洞进行验证最安全的方式是，创建一份安全字符白名单，允许其中的字符出现在 HTTP 内容中，并且只接受完全由这些经认可的字符组成的输入。例如，有效的用户名可能仅包含字母数字字符，电话号码可能仅包含 0-9 的数字。然而，这种解决方法在 Web 应用程序中通常是行不通的，因为许多字符对浏览器来说都具有特殊的含义，编码时这些字符必须被视为合法输入，例如，一个 Web 设计电子公告栏就必须接受其用户提供的 HTML 片段。</p>
<p>更灵活的方法是列入黑名单，但其安全性较差，这种方法在使用输入之前就有选择地拒绝或转义了潜在的危险字符。为了创建这样一个列表，首先需要了解对于 Web 浏览器具有特殊含义的字符集。虽然 HTML 标准定义了哪些字符具有特殊含义，但是许多 Web 浏览器会设法更正 HTML 中的常见错误，并可能在特定的上下文中认为其他字符具有特殊含义，这就是我们不鼓励使用黑名单作为阻止 XSS 的方法的原因。卡耐基梅隆大学 (Carnegie Mellon University) 软件工程学院 (Software Engineering Institute) 下属的 CERT(R) (CERT(R) Coordination Center) 合作中心提供了有关各种上下文中认定的特殊字符的具体信息 [1]：</p>
<p>在有关块级别元素的内容中（位于一段文本的中间）：</p>
<p>－ “&lt;” 是一个特殊字符，因为它可以引入一个标签。</p>
<p>－ “&amp;” 是一个特殊字符，因为它可以引入一个字符实体。</p>
<p>－ “&gt;” 是一个特殊字符，之所以某些浏览器将其认定为特殊字符，是基于一种假设，即该页的作者本想在前面添加一个 “&lt;”，却错误地将其遗漏了。</p>
<p>下面的这些原则适用于属性值：</p>
<p>－ 对于外加双引号的属性值，双引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于外加单引号的属性值，单引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于不带任何引号的属性值，空格字符（如空格符和制表符）是特殊字符。</p>
<p>－ “&amp;” 与某些特定变量一起使用时是特殊字符，因为它引入了一个字符实体。 </p>
<p>例如，在 URL 中，搜索引擎可能会在结果页面内提供一个链接，用户可以点击该链接来重新运行搜索。可以将这一方法运用于编写 URL 中的搜索查询语句，这将引入更多特殊字符：</p>
<p>－ 空格符、制表符和换行符是特殊字符，因为它们标记了 URL 的结束。</p>
<p>－ “&amp;” 是特殊字符，因为它可引入一个字符实体或分隔 CGI 参数。</p>
<p>－ 非 ASCII 字符（即 ISO-8859-1 编码表中所有大于 127 的字符）不允许出现在 URL 中，因此这些字符在此环境下被视为特殊字符。</p>
<p>－ 在服务器端对在 HTTP 转义序列中编码的参数进行解码时，必须过滤掉输入中的 “%” 符号。例如，当输入中出现 “%68%65%6C%6C%6F” 时，只有从输入的内容中过滤掉 “%”，上述字符串才能在网页上显示为 “hello”。</p>
<p>在 <code>&lt;SCRIPT&gt; &lt;/SCRIPT&gt;</code> 的正文内：</p>
<p>－ 如果可以将文本直接插入到已有的脚本标签中，应该过滤掉分号、省略号、中括号和换行符。</p>
<p>服务器端脚本：</p>
<p>－ 如果服务器端脚本会将输入中的感叹号 (!) 转换成输出中的双引号 (“)，则可能需要对此进行更多过滤。 </p>
<p>其他可能出现的情况：</p>
<p>－ 如果攻击者以 UTF-7 格式提交了请求，则特殊字符<code>“&lt;”</code>可能会显示为<code>“+ADw-”</code>，并可能会绕过过滤。如果输出包含在没有确切指定编码格式的网页中，某些浏览器就会设法根据内容自动识别编码（此处采用 UTF-7 格式）。</p>
<p>在应用程序中确定针对 XSS 攻击执行验证的正确要点，以及验证过程中要考虑的特殊字符之后，下一个难点就是确定验证过程中处理各种特殊字符的方式。如果应用程序认定某些特殊字符为无效输入，那么您可以拒绝任何带有这些无效特殊字符的输入。第二种选择就是采用过滤手段来删除这些特殊字符。然而，过滤的负面作用在于，过滤内容的显示将发生改变。在需要完整显示输入内容的情况下，过滤的这种负面作用可能是无法接受的。</p>
<p>如果必须接受带有特殊字符的输入，并将其准确地显示出来，验证机制一定要对所有特殊字符进行编码，以便删除其具有的含义。官方的 HTML 规范 [2] 提供了特殊字符对应的 ISO 8859-1 编码值的完整列表。</p>
<p>许多应用程序服务器都试图避免应用程序出现 Cross-Site Scripting 漏洞，具体做法是为负责设置特定 HTTP 响应内容的函数提供各种实现方式，以检验是否存在进行 Cross-Site Scripting 攻击必需的字符。不要依赖运行应用程序的服务器，以此确保该应用程序的安全。开发了某个应用程序后，并不能保证在其生命周期中它会在哪些应用程序服务器中运行。由于标准和已知盗取方式的演变，我们不能保证应用程序服务器也会保持同步。</p>
<h5 id="REFERENCES-28"><a href="#REFERENCES-28" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Understanding Malicious Content Mitigation for Web Developers CERT</p>
<p>[2] HTML 4.01 Specification W3</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 79, CWE ID 80 </p>
<p>[4] Standards Mapping - Common Weakness Enumeration Top 25 2019 [2] CWE ID 079 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001310, CCI-002754 </p>
<p>[6] Standards Mapping - FIPS200 SI </p>
<p>[7] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[9] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.3.3 Output Encoding and Injection Prevention Requirements, 5.3.6 Output Encoding and Injection Prevention Requirements </p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A4 Cross Site Scripting </p>
<p>[12] Standards Mapping - OWASP Top 10 2007 A1 Cross Site Scripting (XSS) </p>
<p>[13] Standards Mapping - OWASP Top 10 2010 A2 Cross-Site Scripting (XSS) </p>
<p>[14] Standards Mapping - OWASP Top 10 2013 A3 Cross-Site Scripting (XSS) </p>
<p>[15] Standards Mapping - OWASP Top 10 2017 A7 Cross-Site Scripting (XSS) </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.7 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.7 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.7 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.7 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.7 </p>
<p>[23] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[24] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 079 </p>
<p>[25] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 079 </p>
<p>[26] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 079 </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3580 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3580 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3580 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3580 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3580 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3580 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3580 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[43] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[44] Standards Mapping - Web Application Security Consortium 24 + 2 Cross-Site Scripting </p>
<p>[45] Standards Mapping - Web Application Security Consortium Version 2.00 Cross-Site Scripting (WASC-08) </p>
<h4 id="Cross-Site-Scripting-Poor-Validation"><a href="#Cross-Site-Scripting-Poor-Validation" class="headerlink" title="Cross-Site Scripting: Poor Validation"></a>Cross-Site Scripting: Poor Validation</h4><h5 id="ABSTRACT-29"><a href="#ABSTRACT-29" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>依靠 HTML、XML 和其他类型的编码来验证用户输入可能会导致浏览器执行恶意代码。</p>
<h5 id="EXPLANATION-29"><a href="#EXPLANATION-29" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用特定的编码函数（例如 htmlspecialchars() 或 htmlentities()）能避免一部分 cross-site scripting 攻击，但不能完全避免。根据数据出现的上下文，除 HTML 编码的基本字符 <code>&lt;、&gt;、&amp; 和 &quot;</code>以及 XML 编码的字符<code>&lt;、&gt;、&amp;、&quot; 和 &#39;</code>之外（仅当已设置 ENT_QUOTES 时），其他字符可能具有元意。依靠此类编码函数等同于用一个安全性较差的黑名单来防止 cross-site scripting 攻击，并且可能允许攻击者注入恶意代码，并在浏览器中加以执行。由于不可能始终准确地确定静态显示数据的上下文，所以即便进行了编码，Fortify 安全编码规则包仍会报告跨站脚本攻击结果，并将其显示为 Cross-Site Scripting: Poor Validation 问题。</p>
<p>Cross-Site Scripting (XSS) 漏洞在以下情况下发生：</p>
<ol>
<li><p>数据通过一个不可信赖的数据源进入 Web 应用程序。对于 Reflected XSS，不可信赖的数据源大多数情况下为 Web 请求；而对于 Persistent（也称为 Stored）XSS，该数据源通常为数据库查询的结果。</p>
</li>
<li><p>未经验证但包含在动态内容中的数据将传送给 Web 用户。</p>
</li>
</ol>
<p>传送到 Web 浏览器的恶意内容通常采用 JavaScript 代码片段的形式，但也可能会包含一些 HTML、Flash 或者其他任意一种可以被浏览器执行的代码。基于 XSS 的攻击手段花样百出，几乎是无穷无尽的，但通常它们都会包含传输给攻击者的私人数据（如 Cookie 或者其他会话信息）。在攻击者的控制下，指引受害者进入恶意的网络内容；或者利用易受攻击的站点，对用户的机器进行其他恶意操作。</p>
<p>示例 1：下面的代码片段会从 HTTP 请求中读取 text 参数，使用 HTML 加以编码，并将该参数显示在脚本标签之间的警报框中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">    $var=$_GET[&#x27;text&#x27;];</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    $var2=htmlspecialchars($var);</span><br><span class="line"></span><br><span class="line">    echo &quot;&lt;script&gt;alert(&#x27;$var2&#x27;)&lt;/script&gt;&quot;;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>如果 text 只包含标准的字母或数字文本，这个例子中的代码就能正确运行。如果 text 具有单引号、圆括号和分号，则会结束 alert 文本框，之后将执行代码。</p>
<p>起初，这个例子似乎是不会轻易遭受攻击的。毕竟，有谁会输入导致恶意代码在自己电脑上运行的 URL 呢？真正的危险在于攻击者会创建恶意的 URL，然后采用电子邮件或社交工程的欺骗手段诱使受害者访问此 URL 的链接。当受害者单击这个链接时，他们不知不觉地通过易受攻击的网络应用程序，将恶意内容带到了自己的电脑中。这种对易受攻击的 Web 应用程序进行盗取的机制通常被称为反射式 XSS。</p>
<p>正如例子中所显示的，XSS 漏洞是由于 HTTP 响应中包含了未经验证的数据代码而引起的。受害者遭受 XSS 攻击的途径有三种：</p>
<p>— 如Example 1 中所示，系统从 HTTP 请求中直接读取数据，并在 HTTP 响应中返回数据。当攻击者诱使用户为易受攻击的 Web 应用程序提供危险内容，而这些危险内容随后会反馈给用户并在 Web 浏览器中执行时，就会发生 Reflected XSS 漏洞利用。发送恶意内容最常用的方法是，将恶意内容作为一个参数包含在公开发布或通过电子邮件直接发送给受害者的 URL 中。以这种手段构造的 URL 已成为多种网络钓鱼阴谋的核心，攻击者会借此诱骗受害者访问指向易受攻击站点的 URL。当该站点将攻击者的内容反馈给受害者后，便会执行这些内容，接下来会将用户计算机中的各种私密信息（比如可能包含会话信息的 Cookie）传输给攻击者，或者执行其他恶意活动。</p>
<p>— 应用程序将危险数据存储在数据库或其他可信赖的数据存储器中。这些危险数据随后会被回写到应用程序中，并包含在动态内容中。Persistent XSS 盗取发生在如下情况：攻击者将危险内容注入到数据存储器中，且该存储器之后会被读取并包含在动态内容中。从攻击者的角度看，注入恶意内容的最佳位置莫过于一个面向许多用户，尤其是相关用户显示的区域。相关用户通常在应用程序中具备较高的特权，或相互之间交换敏感数据，这些数据对攻击者来说有利用价值。如果某一个用户执行了恶意内容，攻击者就有可能以该用户的名义执行某些需要特权的操作，或者获得该用户个人所有的敏感数据的访问权限。</p>
<p>— 应用程序之外的数据源将危险数据储存在一个数据库或其他数据存储器中，随后这些危险数据被当作可信赖的数据回写到应用程序中，并储存在动态内容中。</p>
<p>RECOMMENDATIONS</p>
<p>针对 XSS 的解决方法是，确保在适当位置进行验证，并检验其属性是否正确。</p>
<p>由于 XSS 漏洞在应用程序的输出中包含恶意数据时出现，因此，合乎逻辑的方法是在数据流出应用程序的前一刻对其进行验证。然而，由于 Web 应用程序常常会包含复杂而难以理解的代码，用以生成动态内容，因此，这一方法容易产生遗漏错误（遗漏验证）。降低这一风险的有效途径是对 XSS 也执行输入验证。</p>
<p>由于 Web 应用程序必须验证输入信息以避免其他漏洞（如 SQL Injection），因此，一种相对简单的解决方法是，加强一个应用程序现有的输入验证机制，将 XSS 检测包括其中。尽管有一定的价值，但 XSS 输入验证并不能取代严格的输出验证。应用程序可能通过共享的数据存储器或其他可信赖的数据源接受输入，而该数据存储器所接受的输入源可能并未执行适当的输入验证。因此，应用程序不能间接地依赖于该数据或其他任意数据的安全性。这就意味着，避免 XSS 漏洞的最佳方法是验证所有进入应用程序以及由应用程序传送至用户端的数据。</p>
<p>针对 XSS 漏洞进行验证最安全的方式是，创建一份安全字符白名单，允许其中的字符出现在 HTTP 内容中，并且只接受完全由这些经认可的字符组成的输入。例如，有效的用户名可能仅包含字母数字字符，电话号码可能仅包含 0-9 的数字。然而，这种解决方法在 Web 应用程序中通常是行不通的，因为许多字符对浏览器来说都具有特殊的含义，编码时这些字符必须被视为合法输入，例如，一个 Web 设计电子公告栏就必须接受其用户提供的 HTML 片段。</p>
<p>更灵活的方法是列入黑名单，但其安全性较差，这种方法在使用输入之前就有选择地拒绝或转义了潜在的危险字符。为了创建这样一个列表，首先需要了解对于 Web 浏览器具有特殊含义的字符集。虽然 HTML 标准定义了哪些字符具有特殊含义，但是许多 Web 浏览器会设法更正 HTML 中的常见错误，并可能在特定的上下文中认为其他字符具有特殊含义，这就是我们不鼓励使用黑名单作为阻止 XSS 的方法的原因。卡耐基梅隆大学 (Carnegie Mellon University) 软件工程学院 (Software Engineering Institute) 下属的 CERT(R) (CERT(R) Coordination Center) 合作中心提供了有关各种上下文中认定的特殊字符的具体信息 [1]：</p>
<p>在有关块级别元素的内容中（位于一段文本的中间）：</p>
<p>－ “&lt;” 是一个特殊字符，因为它可以引入一个标签。</p>
<p>－ “&amp;” 是一个特殊字符，因为它可以引入一个字符实体。</p>
<p>－ “&gt;” 是一个特殊字符，之所以某些浏览器将其认定为特殊字符，是基于一种假设，即该页的作者本想在前面添加一个 “&lt;”，却错误地将其遗漏了。</p>
<p>下面的这些原则适用于属性值：</p>
<p>－ 对于外加双引号的属性值，双引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于外加单引号的属性值，单引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于不带任何引号的属性值，空格字符（如空格符和制表符）是特殊字符。</p>
<p>— “&amp;” 与某些特定变量一起使用时是特殊字符，因为它引入了一个字符实体。 </p>
<p>例如，在 URL 中，搜索引擎可能会在结果页面内提供一个链接，用户可以点击该链接来重新运行搜索。可以将这一方法运用于编写 URL 中的搜索查询语句，这将引入更多特殊字符：</p>
<p>－ 空格符、制表符和换行符是特殊字符，因为它们标记了 URL 的结束。</p>
<p>— “&amp;” 是特殊字符，因为它可引入一个字符实体或分隔 CGI 参数。</p>
<p>— 非 ASCII 字符（即 ISO-8859-1 编码表中所有大于 127 的字符）不允许出现在 URL 中，因此这些字符在此环境下被视为特殊字符。</p>
<p>－ 在服务器端对在 HTTP 转义序列中编码的参数进行解码时，必须过滤掉输入中的 “%” 符号。例如，当输入中出现 “%68%65%6C%6C%6F” 时，只有从输入的内容中过滤掉 “%”，上述字符串才能在网页上显示为 “hello”。</p>
<p>在 <code>&lt;SCRIPT&gt; &lt;/SCRIPT&gt;</code> 的正文内：</p>
<p>— 如果可以将文本直接插入到已有的脚本标签中，应该过滤掉分号、省略号、中括号和换行符。</p>
<p>服务器端脚本：</p>
<p>－ 如果服务器端脚本会将输入中的感叹号 (!) 转换成输出中的双引号 (“)，则可能需要对此进行更多过滤。 </p>
<p>其他可能出现的情况：</p>
<p>－ 如果攻击者以 UTF-7 格式提交了请求，则特殊字符<code>“&lt;”</code>可能会显示为<code>“+ADw-”</code>，并可能会绕过过滤。如果输出包含在没有确切指定编码格式的网页中，某些浏览器就会设法根据内容自动识别编码（此处采用 UTF-7 格式）。</p>
<p>在应用程序中确定针对 XSS 攻击执行验证的正确要点，以及验证过程中要考虑的特殊字符之后，下一个难点就是确定验证过程中处理各种特殊字符的方式。如果应用程序认定某些特殊字符为无效输入，那么您可以拒绝任何带有这些无效特殊字符的输入。第二种选择就是采用过滤手段来删除这些特殊字符。然而，过滤的负面作用在于，过滤内容的显示将发生改变。在需要完整显示输入内容的情况下，过滤的这种负面作用可能是无法接受的。</p>
<p>如果必须接受带有特殊字符的输入，并将其准确地显示出来，验证机制一定要对所有特殊字符进行编码，以便删除其具有的含义。官方的 HTML 规范 [2] 提供了特殊字符对应的 ISO 8859-1 编码值的完整列表。</p>
<p>许多应用程序服务器都试图避免应用程序出现 Cross-Site Scripting 漏洞，具体做法是为负责设置特定 HTTP 响应内容的函数提供各种实现方式，以检验是否存在进行 Cross-Site Scripting 攻击必需的字符。不要依赖运行应用程序的服务器，以此确保该应用程序的安全。开发了某个应用程序后，并不能保证在其生命周期中它会在哪些应用程序服务器中运行。由于标准和已知盗取方式的演变，我们不能保证应用程序服务器也会保持同步。</p>
<h5 id="REFERENCES-29"><a href="#REFERENCES-29" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Understanding Malicious Content Mitigation for Web Developers CERT</p>
<p>[2] HTML 4.01 Specification W3</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 82, CWE ID 83, CWE ID 87, CWE ID 692 </p>
<p>[4] Standards Mapping - Common Weakness Enumeration Top 25 2019 [2] CWE ID 079 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001310, CCI-002754 </p>
<p>[6] Standards Mapping - FIPS200 SI </p>
<p>[7] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[9] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.3.3 Output Encoding and Injection Prevention Requirements, 5.3.6 Output Encoding and Injection Prevention Requirements </p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A4 Cross Site Scripting </p>
<p>[12] Standards Mapping - OWASP Top 10 2007 A1 Cross Site Scripting (XSS) </p>
<p>[13] Standards Mapping - OWASP Top 10 2010 A2 Cross-Site Scripting (XSS) </p>
<p>[14] Standards Mapping - OWASP Top 10 2013 A3 Cross-Site Scripting (XSS) </p>
<p>[15] Standards Mapping - OWASP Top 10 2017 A7 Cross-Site Scripting (XSS) </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.7 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.7 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.7 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.7 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.7 </p>
<p>[23] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[24] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116 </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3580 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3580 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3580 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3580 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3580 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3580 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3580 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Web Application Security Consortium 24 + 2 Cross-Site Scripting </p>
<p>[43] Standards Mapping - Web Application Security Consortium Version 2.00 Cross-Site Scripting (WASC-08) </p>
<h4 id="Cross-Site-Scripting-Reflected"><a href="#Cross-Site-Scripting-Reflected" class="headerlink" title="Cross-Site Scripting: Reflected"></a>Cross-Site Scripting: Reflected</h4><h5 id="ABSTRACT-30"><a href="#ABSTRACT-30" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>向一个 Web 浏览器发送未经验证的数据会导致该浏览器执行恶意代码。</p>
<h5 id="EXPLANATION-30"><a href="#EXPLANATION-30" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Cross-Site Scripting (XSS) 漏洞在以下情况下发生：</p>
<ol>
<li><p>数据通过一个不可信赖的数据源进入 Web 应用程序。对于 Reflected XSS，不可信赖的数据源通常为 Web 请求，而对于 Persisted（也称为 Stored）XSS，该数据源通常为数据库或其他后端数据存储。</p>
</li>
<li><p>未经验证但包含在动态内容中的数据将传送给 Web 用户。</p>
</li>
</ol>
<p>传送到 Web 浏览器的恶意内容通常采用 JavaScript 代码片段的形式，但也可能会包含一些 HTML、Flash 或者其他任意一种可以被浏览器执行的代码。基于 XSS 的攻击手段花样百出，几乎是无穷无尽的，但通常它们都会包含传输给攻击者的私人数据（如 Cookie 或者其他会话信息）。在攻击者的控制下，指引受害者进入恶意的网络内容；或者利用易受攻击的站点，对用户的机器进行其他恶意操作。</p>
<p>例 1：下面的 PHP 代码片段可从一个 HTTP 请求中读取雇员 ID eid，并将其显示给用户。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">	$eid = $_GET[&#x27;eid&#x27;];</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">	echo &quot;Employee ID: $eid&quot;;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>如果eid只包含标准的字母或数字文本，这个例子中的代码就能正确运行。如果eid中的某个值包含元字符或源代码，则 Web 浏览器就会在显示 HTTP 响应时执行该代码。</p>
<p>起初，这个例子似乎是不会轻易遭受攻击的。毕竟，有谁会输入导致恶意代码在自己电脑上运行的 URL 呢？真正的危险在于攻击者会创建恶意的 URL，然后采用电子邮件或社交工程的欺骗手段诱使受害者访问此 URL 的链接。当受害者单击这个链接时，他们不知不觉地通过易受攻击的网络应用程序，将恶意内容带到了自己的电脑中。这种对易受攻击的 Web 应用程序进行盗取的机制通常被称为反射式 XSS。</p>
<p>例 2：下面的 PHP 代码片段可根据一个给定的雇员 ID 查询数据库，并显式出相应的雇员姓名。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php...</span><br><span class="line"></span><br><span class="line"> $con = mysql_connect($server,$user,$password);</span><br><span class="line"></span><br><span class="line"> ...</span><br><span class="line"></span><br><span class="line"> $result = mysql_query(&quot;select * from emp where id=&quot;+eid);</span><br><span class="line"></span><br><span class="line"> $row = mysql_fetch_array($result)</span><br><span class="line"></span><br><span class="line"> echo &#x27;Employee name: &#x27;, mysql_result($row,0,&#x27;name&#x27;);</span><br><span class="line"></span><br><span class="line"> ...</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>如同Example 1，如果对name的值处理得当，该代码就能正常地执行各种功能；如若处理不当，就会对代码的漏洞利用行为无能为力。同样，这段代码看起来似乎危险较小，因为name的值是从数据库中读取的，而且这些内容明显是由应用程序管理的。然而，如果name的值来自用户提供的数据，数据库就会成为恶意内容传播的通道。如果不对数据库中存储的所有数据进行恰当的输入验证，那么攻击者就可以在用户的 Web 浏览器中执行恶意命令。这种类型的漏洞利用称为 Persistent XSS（或 Stored XSS），它极其隐蔽，因为数据存储导致的间接行为会增大辨别威胁的难度，并使多个用户受此攻击影响的可能性提高。XSS 漏洞利用首先会在网站上为访问者提供一个“留言簿”。攻击者会在这些留言簿的条目中嵌入 JavaScript，接下来所有访问该留言簿页面的访问者都会执行这些恶意代码。</p>
<p>正如例子中所显示的，XSS 漏洞是由于 HTTP 响应中包含了未经验证的数据代码而引起的。受害者遭受 XSS 攻击的途径有三种：</p>
<ul>
<li><p>如Example 1中所示，系统从 HTTP 请求中直接读取数据，并在 HTTP 响应中返回数据。当攻击者诱使用户为易受攻击的 Web 应用程序提供危险内容，而这些危险内容随后会反馈给用户并在 Web 浏览器中执行时，就会发生 Reflected XSS 漏洞利用。发送恶意内容最常用的方法是，将恶意内容作为一个参数包含在公开发布或通过电子邮件直接发送给受害者的 URL 中。以这种手段构造的 URL 已成为多种网络钓鱼阴谋的核心，攻击者会借此诱骗受害者访问指向易受攻击站点的 URL。当该站点将攻击者的内容反馈给受害者后，便会执行这些内容，接下来会将用户计算机中的各种私密信息（比如可能包含会话信息的 Cookie）传输给攻击者，或者执行其他恶意活动。</p>
</li>
<li><p>如Example 2中所示，应用程序将危险数据存储在数据库或其他可信赖的数据存储中。这些危险数据随后会被读回到应用程序中，并包含在动态内容中。在以下情况下会发生 Persistent XSS 漏洞利用：攻击者将危险内容注入到数据存储中，而这些危险内容随后会被读取并包含在动态内容中。从攻击者的角度看，注入恶意内容的最佳位置莫过于显示给许多用户或显示给特定相关用户的区域。这些相关用户通常在应用程序中具备较高的特权，或者可以与敏感数据交互，这些数据对攻击者来说具有利用价值。如果某一个用户执行了恶意内容，攻击者就有可能以该用户的名义执行某些需要特权的操作，或者获得该用户个人敏感数据的访问权。</p>
</li>
<li>应用程序之外的数据源将危险数据储存在一个数据库或其他数据存储器中，随后这些危险数据被当作可信赖的数据回写到应用程序中，并储存在动态内容中。</li>
</ul>
<h5 id="RECOMMENDATIONS-29"><a href="#RECOMMENDATIONS-29" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>针对 XSS 的解决方法是，确保在适当位置进行验证，并检验其属性是否正确。</p>
<p>由于 XSS 漏洞在应用程序的输出中包含恶意数据时出现，因此，合乎逻辑的方法是在数据流出应用程序的前一刻对其进行验证。然而，由于 Web 应用程序常常会包含复杂而难以理解的代码，用以生成动态内容，因此，这一方法容易产生遗漏错误（遗漏验证）。降低这一风险的有效途径是对 XSS 也执行输入验证。</p>
<p>由于 Web 应用程序必须验证输入信息以避免其他漏洞（如 SQL Injection），因此，一种相对简单的解决方法是，加强一个应用程序现有的输入验证机制，将 XSS 检测包括其中。尽管有一定的价值，但 XSS 输入验证并不能取代严格的输出验证。应用程序可能通过共享的数据存储器或其他可信赖的数据源接受输入，而该数据存储器所接受的输入源可能并未执行适当的输入验证。因此，应用程序不能间接地依赖于该数据或其他任意数据的安全性。这就意味着，避免 XSS 漏洞的最佳方法是验证所有进入应用程序以及由应用程序传送至用户端的数据。</p>
<p>针对 XSS 漏洞进行验证最安全的方式是，创建一份安全字符白名单，允许其中的字符出现在 HTTP 内容中，并且只接受完全由这些经认可的字符组成的输入。例如，有效的用户名可能仅包含字母数字字符，电话号码可能仅包含 0-9 的数字。然而，这种解决方法在 Web 应用程序中通常是行不通的，因为许多字符对浏览器来说都具有特殊的含义，编码时这些字符必须被视为合法输入，例如，一个 Web 设计电子公告栏就必须接受其用户提供的 HTML 片段。</p>
<p>更灵活的方法是列入黑名单，但其安全性较差，这种方法在使用输入之前就有选择地拒绝或转义了潜在的危险字符。为了创建这样一个列表，首先需要了解对于 Web 浏览器具有特殊含义的字符集。虽然 HTML 标准定义了哪些字符具有特殊含义，但是许多 Web 浏览器会设法更正 HTML 中的常见错误，并可能在特定的上下文中认为其他字符具有特殊含义，这就是我们不鼓励使用黑名单作为阻止 XSS 的方法的原因。卡耐基梅隆大学 (Carnegie Mellon University) 软件工程学院 (Software Engineering Institute) 下属的 CERT(R) (CERT(R) Coordination Center) 合作中心提供了有关各种上下文中认定的特殊字符的具体信息 [1]：</p>
<p>在有关块级别元素的内容中（位于一段文本的中间）：</p>
<p>－ “&lt;” 是一个特殊字符，因为它可以引入一个标签。</p>
<p>－ “&amp;” 是一个特殊字符，因为它可以引入一个字符实体。</p>
<p>－ “&gt;” 是一个特殊字符，之所以某些浏览器将其认定为特殊字符，是基于一种假设，即该页的作者本想在前面添加一个 “&lt;”，却错误地将其遗漏了。</p>
<p>下面的这些原则适用于属性值：</p>
<p>－ 对于外加双引号的属性值，双引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于外加单引号的属性值，单引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于不带任何引号的属性值，空格字符（如空格符和制表符）是特殊字符。</p>
<p>－ “&amp;” 与某些特定变量一起使用时是特殊字符，因为它引入了一个字符实体。 </p>
<p>例如，在 URL 中，搜索引擎可能会在结果页面内提供一个链接，用户可以点击该链接来重新运行搜索。可以将这一方法运用于编写 URL 中的搜索查询语句，这将引入更多特殊字符：</p>
<p>－ 空格符、制表符和换行符是特殊字符，因为它们标记了 URL 的结束。</p>
<p>－ “&amp;” 是特殊字符，因为它可引入一个字符实体或分隔 CGI 参数。</p>
<p>－ 非 ASCII 字符（即 ISO-8859-1 编码表中所有大于 127 的字符）不允许出现在 URL 中，因此这些字符在此环境下被视为特殊字符。</p>
<p>－ 在服务器端对在 HTTP 转义序列中编码的参数进行解码时，必须过滤掉输入中的 “%” 符号。例如，当输入中出现 “%68%65%6C%6C%6F” 时，只有从输入的内容中过滤掉 “%”，上述字符串才能在网页上显示为 “hello”。</p>
<p>在 <code>&lt;SCRIPT&gt; &lt;/SCRIPT&gt;</code>的正文内：</p>
<p>－ 如果可以将文本直接插入到已有的脚本标签中，应该过滤掉分号、省略号、中括号和换行符。</p>
<p>服务器端脚本：</p>
<p>－ 如果服务器端脚本会将输入中的感叹号 (!) 转换成输出中的双引号 (“)，则可能需要对此进行更多过滤。 </p>
<p>其他可能出现的情况：</p>
<p>－ 如果攻击者以 UTF-7 格式提交了请求，则特殊字符<code>“&lt;”</code>可能会显示为<code>“+ADw-”</code>，并可能会绕过过滤。如果输出包含在没有确切指定编码格式的网页中，某些浏览器就会设法根据内容自动识别编码（此处采用 UTF-7 格式）。</p>
<p>在应用程序中确定针对 XSS 攻击执行验证的正确要点，以及验证过程中要考虑的特殊字符之后，下一个难点就是确定验证过程中处理各种特殊字符的方式。如果应用程序认定某些特殊字符为无效输入，那么您可以拒绝任何带有这些无效特殊字符的输入。第二种选择就是采用过滤手段来删除这些特殊字符。然而，过滤的负面作用在于，过滤内容的显示将发生改变。在需要完整显示输入内容的情况下，过滤的这种负面作用可能是无法接受的。</p>
<p>如果必须接受带有特殊字符的输入，并将其准确地显示出来，验证机制一定要对所有特殊字符进行编码，以便删除其具有的含义。官方的 HTML 规范 [2] 提供了特殊字符对应的 ISO 8859-1 编码值的完整列表。</p>
<p>许多应用程序服务器都试图避免应用程序出现 Cross-Site Scripting 漏洞，具体做法是为负责设置特定 HTTP 响应内容的函数提供各种实现方式，以检验是否存在进行 Cross-Site Scripting 攻击必需的字符。不要依赖运行应用程序的服务器，以此确保该应用程序的安全。开发了某个应用程序后，并不能保证在其生命周期中它会在哪些应用程序服务器中运行。由于标准和已知盗取方式的演变，我们不能保证应用程序服务器也会保持同步。</p>
<h5 id="REFERENCES-30"><a href="#REFERENCES-30" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Understanding Malicious Content Mitigation for Web Developers CERT</p>
<p>[2] HTML 4.01 Specification W3</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 79, CWE ID 80 </p>
<p>[4] Standards Mapping - Common Weakness Enumeration Top 25 2019 [2] CWE ID 079 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001310, CCI-002754 </p>
<p>[6] Standards Mapping - FIPS200 SI </p>
<p>[7] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[9] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.3.3 Output Encoding and Injection Prevention Requirements, 5.3.6 Output Encoding and Injection Prevention Requirements </p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A4 Cross Site Scripting </p>
<p>[12] Standards Mapping - OWASP Top 10 2007 A1 Cross Site Scripting (XSS) </p>
<p>[13] Standards Mapping - OWASP Top 10 2010 A2 Cross-Site Scripting (XSS) </p>
<p>[14] Standards Mapping - OWASP Top 10 2013 A3 Cross-Site Scripting (XSS) </p>
<p>[15] Standards Mapping - OWASP Top 10 2017 A7 Cross-Site Scripting (XSS) </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.7 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.7 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.7 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.7 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.7 </p>
<p>[23] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[24] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 079 </p>
<p>[25] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 079 </p>
<p>[26] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 079 </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3580 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3580 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3580 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3580 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3580 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3580 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3580 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[43] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[44] Standards Mapping - Web Application Security Consortium 24 + 2 Cross-Site Scripting </p>
<p>[45] Standards Mapping - Web Application Security Consortium Version 2.00 Cross-Site Scripting (WASC-08) </p>
<h4 id="Dangerous-File-Inclusion"><a href="#Dangerous-File-Inclusion" class="headerlink" title="Dangerous File Inclusion"></a>Dangerous File Inclusion</h4><h5 id="ABSTRACT-31"><a href="#ABSTRACT-31" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果允许未验证的用户输入控制动态包含在 PHP 中的文件，会导致恶意代码的执行。</p>
<h5 id="EXPLANATION-31"><a href="#EXPLANATION-31" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>许多现代网络编写语言都能够在一个封装的文件内包含附加的源文件，从而使代码可以重用和模块化。这种能力经常用于赋予应用程序标准外观（应用模板），因而，人们可以共享各种功能而不需要借助编译的代码，或将代码分解成较小的更好管理的文件。各个包含文件都会作为主文件的一部分进行解析，并采用相同的方式来执行。当未验证的用户输入控制了所包含文件的路径时，就会发生 File inclusion 漏洞。 </p>
<p>File inclusion 漏洞是各种 PHP 应用程序中最多见且最为严重的漏洞。在低于 PHP 4.2.0 的版本中，PHP 的安装包附带了默认启用的 register_globals，从而使攻击者很容易重写内部服务器的各种变量。尽管禁用 register_globals 可以从一定程度上减少程序发生 file inclusion 漏洞的风险，但是这些问题仍然存在于各种现代的 PHP 应用程序中。 </p>
<p>例 1：以下代码包含了一个文件，该文件位于模板中定义 $server_root 的应用程序下。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;?php include($server_root . &#x27;/myapp_header.php&#x27;); ?$gt;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>如果将register_globals设置为on，攻击者可以通过提供$server_root请求参数覆盖$server_root值，从而部分控制动态 include 指令。</p>
<p>例 2：以下代码采用了用户指定的模板名称，并将该名称包含在要呈现的 PHP 页面中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;?php include($_GET[&#x27;headername&#x27;]); ?$gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>在Example 2中，攻击者可通过为headername提供恶意值来完全控制动态 include 语句，从而会使程序包含来自外部站点的文件。</p>
<p>如果攻击者给动态 include 指令指定有效文件，该文件的内容将被传送到 PHP 解释器。对于一个纯文本文件来说，如/etc/shadow，该文件可能会作为 HTML 输出的一部分来呈现。更为糟糕的是，如果攻击者可以指定一条路径来指向被自己控制的远程站点，那么动态 include 指令就会执行由攻击者提供的任意恶意代码。</p>
<h5 id="RECOMMENDATIONS-30"><a href="#RECOMMENDATIONS-30" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>通过将以下行包含在 php.ini 文件中来禁用 register_globals 选项：</p>
<p><code>register_globals = &#39;off&#39;</code></p>
<p>不要允许未验证的用户输入控制动态包含指令中使用的路径。而应当采取一种间接手段：创建一份合法包含文件列表，仅允许用户从该列表中进行选择。利用这种方法，用户就不能直接从文件系统中指定一个文件。</p>
<p>例 2 可以进一步改进，将用户输入映射至用来选择所需模板的按键，如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">	$templates = array(&#x27;main.php&#x27; =&gt; 1, &#x27;blue.php&#x27; =&gt; 2, &#x27;red.php&#x27; =&gt; 3);</span><br><span class="line"></span><br><span class="line">?$gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;?php include($templates[$_GET[&#x27;headername&#x27;]]); ?$gt;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-31"><a href="#REFERENCES-31" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Using Register Globals PHP Guide</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 94, CWE ID 98, CWE ID 494 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [18] CWE ID 094 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001167 </p>
<p>[5] Standards Mapping - FIPS200 SI </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-18 Mobile Code (P2) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.14.2 Configuration Architectural Requirements, 5.2.5 Sanitization and Sandboxing Requirements, 5.2.8 Sanitization and Sandboxing Requirements, 5.3.6 Output Encoding and Injection Prevention Requirements, 5.2.8 Sanitization and Sandboxing Requirements, 5.3.6 Output Encoding and Injection Prevention Requirements, 5.3.9 Output Encoding and Injection Prevention Requirements, 10.3.2 Deployed Application Integrity Controls, 12.3.2 File Execution Requirements, 12.3.3 File Execution Requirements, 12.3.6 File Execution Requirements, 14.2.3 Dependency, 14.2.4 Dependency </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A3 Malicious File Execution </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.3 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection, Control Objective 5.4 - Authentication and Access Control </p>
<p>[23] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 094 </p>
<p>[24] Standards Mapping - SANS Top 25 2010 Risky Resource Management - CWE ID 098 </p>
<p>[25] Standards Mapping - SANS Top 25 2011 Risky Resource Management - CWE ID 829 </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3600 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3600 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3600 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3600 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3600 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3600 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3600 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-003300 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-003300 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-003300 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-003300 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-003300 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-003300 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-003300 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-003300 CAT II </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-003300 CAT II </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-003300 CAT II </p>
<p>[43] Standards Mapping - Web Application Security Consortium Version 2.00 Remote File Inclusion (RFI) (WASC-05) </p>
<h4 id="Dangerous-File-Injection"><a href="#Dangerous-File-Injection" class="headerlink" title="Dangerous File Injection"></a>Dangerous File Injection</h4><h5 id="ABSTRACT-32"><a href="#ABSTRACT-32" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>攻击者将能够在系统中创建包含任意内容的文件。</p>
<h5 id="EXPLANATION-32"><a href="#EXPLANATION-32" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>攻击者将能够在服务器的文件系统中创建包含任意内容的文件。然后，攻击者会使用创建的文件执行其他攻击，具体取决于控制注入文件的内容的能力。</p>
<p>如果攻击者能够控制文件的内容，且文件由 Web 服务器提供服务，则他将能够注入恶意网壳，使其可以在服务器上远程执行任意命令。</p>
<p>如果攻击者能够创建包含 file system 中其他文件的内容的文件，他将能够读取可以使用易受攻击应用程序的权限访问的 file system 中的任意文件。</p>
<h5 id="RECOMMENDATIONS-31"><a href="#RECOMMENDATIONS-31" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>不要允许用户直接控制程序执行的命令或程序创建的文件的特征，例如文件扩展名和存储目录。在用户的输入会影响命令执行或文件创建的情况下，应将用户输入限制为从预定的安全选项集合中进行选择。如果输入中出现了恶意的内容，那么程序应当默认传递该集合中的一个安全选项，或者拒绝对不可信赖的数据执行任何进一步操作。</p>
<h5 id="REFERENCES-32"><a href="#REFERENCES-32" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Exploit PHP’s mail() to get remote code execution </p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 94, CWE ID 98, CWE ID 494 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [18] CWE ID 094 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001167, CCI-002754 </p>
<p>[5] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1), SC-18 Mobile Code (P2) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.14.2 Configuration Architectural Requirements, 5.2.5 Sanitization and Sandboxing Requirements, 5.2.8 Sanitization and Sandboxing Requirements, 5.3.6 Output Encoding and Injection Prevention Requirements, 5.3.9 Output Encoding and Injection Prevention Requirements, 10.3.2 Deployed Application Integrity Controls, 12.3.3 File Execution Requirements, 12.3.6 File Execution Requirements, 14.2.3 Dependency, 14.2.4 Dependency </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[12] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection, Control Objective 5.4 - Authentication and Access Control </p>
<p>[21] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 073 </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I, APSC-DV-003300 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I, APSC-DV-003300 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I, APSC-DV-003300 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I, APSC-DV-003300 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I, APSC-DV-003300 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I, APSC-DV-003300 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I, APSC-DV-003300 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I, APSC-DV-003300 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I, APSC-DV-003300 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I, APSC-DV-003300 CAT II </p>
<p>[39] Standards Mapping - Web Application Security Consortium 24 + 2 Path Traversal </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="Denial-of-Service"><a href="#Denial-of-Service" class="headerlink" title="Denial of Service"></a>Denial of Service</h4><h5 id="ABSTRACT-33"><a href="#ABSTRACT-33" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>攻击者可以造成程序崩溃或使合法用户无法进行使用。</p>
<h5 id="EXPLANATION-33"><a href="#EXPLANATION-33" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>攻击者可能通过对应用程序发送大量请求，而使它拒绝对合法用户的服务，但是这种攻击形式经常会在网络层就被排除掉了。更加严重的是那些只需要使用少量请求就可以使得攻击者让应用程序过载的 bug。这种 bug 允许攻击者去指定请求使用系统资源的数量，或者是持续使用这些系统资源的时间。</p>
<h5 id="RECOMMENDATIONS-32"><a href="#RECOMMENDATIONS-32" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>校验用户输入以确保它不会引起不适当的资源利用。</p>
<h5 id="REFERENCES-33"><a href="#REFERENCES-33" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 730 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001094 </p>
<p>[3] Standards Mapping - MISRA C++ 2008 Rule 0-3-1 </p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1) </p>
<p>[5] Standards Mapping - OWASP Application Security Verification Standard 4.0 12.1.1 File Upload Requirements </p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service </p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9 </p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II </p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II </p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II </p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II </p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II </p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II </p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II </p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002400 CAT II </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002400 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002400 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002400 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002400 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002400 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002400 CAT II </p>
<p>[25] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service </p>
<p>[26] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10) </p>
<h4 id="Denial-of-Service-Regular-Expression"><a href="#Denial-of-Service-Regular-Expression" class="headerlink" title="Denial of Service: Regular Expression"></a>Denial of Service: Regular Expression</h4><h5 id="ABSTRACT-34"><a href="#ABSTRACT-34" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>不受信数据被传递至应用程序并作为正则表达式使用。这会导致线程过度使用 CPU 资源。</p>
<h5 id="EXPLANATION-34"><a href="#EXPLANATION-34" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>实施正则表达式评估程序及相关方法时存在漏洞，在评估包含自重复分组表达式的正则表达式时，该漏洞会导致线程挂起。此外，还可以利用任何包含相互重叠的替代子表达式的正则表达式。此缺陷可被攻击者用于执行拒绝服务 (DoS) 攻击。</p>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(e+)+</span><br><span class="line"></span><br><span class="line">([a-zA-Z]+)*</span><br><span class="line"></span><br><span class="line">(e|ee)+</span><br></pre></td></tr></table></figure>
<p>已知的正则表达式实现方式均无法避免这种漏洞。所有平台和语言都容易受到这种攻击。</p>
<h5 id="RECOMMENDATIONS-33"><a href="#RECOMMENDATIONS-33" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请不要将不可信赖数据作为正则表达式使用。</p>
<h5 id="REFERENCES-34"><a href="#REFERENCES-34" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Bryan Sullivan Regular Expression Denial of Service Attacks and Defenses </p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 185, CWE ID 730 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001094 </p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1) </p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service </p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9 </p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6 </p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6 </p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6 </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.6 </p>
<p>[11] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II </p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II </p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II </p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002400 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002400 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002400 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002400 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002400 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002400 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002400 CAT II </p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service </p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10) </p>
<h4 id="Dynamic-Code-Evaluation-Code-Injection"><a href="#Dynamic-Code-Evaluation-Code-Injection" class="headerlink" title="Dynamic Code Evaluation: Code Injection"></a>Dynamic Code Evaluation: Code Injection</h4><h5 id="ABSTRACT-35"><a href="#ABSTRACT-35" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在运行时中解析用户控制的指令，会让攻击者有机会执行恶意代码。</p>
<h5 id="EXPLANATION-35"><a href="#EXPLANATION-35" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>许多现代编程语言都允许动态解析源代码指令。这使得程序员可以执行基于用户输入的动态指令。当程序员错误地认为由用户直接提供的指令仅会执行一些无害的操作时（如对当前的用户对象进行简单的计算或修改用户的状态），就会出现 code injection 漏洞：然而，若不经过适当的验证，用户指定的操作可能并不是程序员最初所期望的。</p>
<p>示例：在这个经典的 code injection 实例中，应用程序可以实施一个基本的计算器，该计算器允许用户指定执行命令。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">	$userOps = $_GET[&#x27;operation&#x27;];</span><br><span class="line"></span><br><span class="line">	$result = eval($userOps);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>如果 operation 参数的值为良性值，程序就可以正常运行。例如，当该值为“8 + 7 * 2”时，result 变量被赋予的值将为 22。然而，如果攻击者指定的语言操作是有效的，又是恶意的，那么，将在对主进程具有完全权限的情况下执行这些操作。如果底层语言提供了访问系统资源的途径或允许执行系统命令，这种攻击甚至会更加危险。例如，如果攻击者计划将<code>“exec(&#39;shutdown -h now&#39;)”</code>指定为 operation 的值，主机系统就会执行关机命令。</p>
<h5 id="RECOMMENDATIONS-34"><a href="#RECOMMENDATIONS-34" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在任何时候，都应尽可能地避免动态的代码解析。如果程序的功能要求对代码进行动态的解析，您可以通过以下方式将此种攻击的可能性降低到最小：尽可能的限制程序中动态执行的代码数量，将此类代码应用到特定的应用程序和上下文中的基本编程语言的子集。 </p>
<p>如果需要执行动态代码，应用程序绝不应当直接执行和解析未验证的用户输入。而应采用间接方法：创建一份合法操作和数据对象列表，用户可以指定其中的内容，并且只能从中进行选择。利用这种方法，就绝不会直接执行由用户提供的输入。</p>
<h5 id="REFERENCES-35"><a href="#REFERENCES-35" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 95, CWE ID 494 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [18] CWE ID 094 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001764, CCI-001774, CCI-002754 </p>
<p>[4] Standards Mapping - FIPS200 SI </p>
<p>[5] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.14.2 Configuration Architectural Requirements, 5.2.4 Sanitization and Sandboxing Requirements,5.2.5 Sanitization and Sandboxing Requirements, 5.2.8 Sanitization and Sandboxing Requirements, 5.3.6 Output Encoding and Injection Prevention Requirements, 5.5.4 Deserialization Prevention Requirements, 10.3.2 Deployed Application Integrity Controls, 12.3.3 File Execution Requirements, 14.2.3 Dependency </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[22] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116, Risky Resource Management - CWE ID 094 </p>
<p>[23] Standards Mapping - SANS Top 25 2010 Risky Resource Management - CWE ID 494 </p>
<p>[24] Standards Mapping - SANS Top 25 2011 Risky Resource Management - CWE ID 494 </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="HTTP-Parameter-Pollution"><a href="#HTTP-Parameter-Pollution" class="headerlink" title="HTTP Parameter Pollution"></a>HTTP Parameter Pollution</h4><h5 id="ABSTRACT-36"><a href="#ABSTRACT-36" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果在 URL 中加入未验证的输入，可能会让攻击者重写请求参数的值。攻击者可能会重写现有的参数值、注入新的参数或利用直接得到的变量。</p>
<h5 id="EXPLANATION-36"><a href="#EXPLANATION-36" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>HTTP Parameter Pollution (HPP) 攻击包含将编码的查询字符串分隔符注入其他现有的参数中。如果 Web 应用程序没有正确地检查用户输入，恶意用户可能会破坏应用程序的逻辑，进行客户端侧或服务器侧攻击。如果再向 Web 应用程序提交参数，并且如果这些参数与现有参数的名称相同，则 Web 应用程序可能会有下列一种反应：</p>
<p>它可能只从第一个参数中提取数据</p>
<p>它可能从最后一个参数中提取数据</p>
<p>它可能从所有参数中提取数据并把它们连接起来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Technology/HTTP back-end		Overall Parsing Result  Example</span><br><span class="line"></span><br><span class="line">ASP.NET/IIS		All occurrences of the specific parameter  par1=val1,val2</span><br><span class="line"></span><br><span class="line">ASP/IIS		All occurrences of the specific parameter    par1=val1,val2</span><br><span class="line"></span><br><span class="line">PHP/Apache		Last occurrence     par1=val2</span><br><span class="line"></span><br><span class="line">JSP,Servlet/Apache Tomcat		First occurrence   par1=val1</span><br><span class="line"></span><br><span class="line">JSP,Servlet/Oracle</span><br><span class="line"></span><br><span class="line">Application Server 10g			First occurrence    par1=val1</span><br><span class="line"></span><br><span class="line">IBM HTTP Server					First occurrence    par1=val1</span><br><span class="line"></span><br><span class="line">mod_perl/Apache					Becomes an array   ARRAY(0x8b9059c)</span><br></pre></td></tr></table></figure>
<p>例 1：根据应用程序服务器和应用程序自身的逻辑，下列请求可能造成与身份验证系统的混淆，使攻击者能模拟别的用户。</p>
<p><a target="_blank" rel="noopener" href="http://www.server.com/login.php?name=alice&amp;name=hacker">http://www.server.com/login.php?name=alice&amp;name=hacker</a></p>
<p>例 2：下列代码使用来自于 HTTP 请求的输入来呈现两个超链接。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    $id = $_GET[&quot;id&quot;];</span><br><span class="line"></span><br><span class="line">    header(&quot;Location: http://www.host.com/election.php?poll_id=&quot; . $id);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
<p>URL： <a target="_blank" rel="noopener" href="http://www.host.com/election.php?poll_id=4567">http://www.host.com/election.php?poll_id=4567</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">链接 1： &lt;a href=&quot;vote.php?poll_id=4567&amp;candidate=white&quot;&gt;White 先生的投票&lt;a&gt;</span><br><span class="line"></span><br><span class="line">链接 2： &lt;a href=&quot;vote.php?poll_id=4567&amp;candidate=green&quot;&gt;Green 女士的投票&lt;a&gt;</span><br></pre></td></tr></table></figure>
<p>程序员没有考虑到攻击者可能提供 poll_id（例如“4567&amp;candidate=green”）的可能性，届时得到的页面中将包含以下注入链接，因此，Green 女士将始终投票选择捡出第一个参数的应用程序服务器。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=&quot;vote.php?poll_id=4567&amp;candidate=green&amp;candidate=white&quot;&gt;White 先生的投票&lt;a&gt;</span><br><span class="line"></span><br><span class="line">&lt;a href=&quot;vote.php?poll_id=4567&amp;candidate=green&amp;candidate=green&quot;&gt;Green 女士的投票&lt;a&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-35"><a href="#RECOMMENDATIONS-35" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在编译 URL 时，未经验证的用户输入应过滤掉多余的参数（删除 “&amp;” 字符）。</p>
<h5 id="REFERENCES-36"><a href="#REFERENCES-36" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] HTTP Parameter Pollution Luca Carettoni, Independent Researcher &amp; Stefano Di Paola, MindedSecurity</p>
<p>[2] HTTP Parameter Pollution Vulnerabilities in Web Applications Marco `embyte’ Balduzzi</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 235 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[5] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.1.1 Input Validation Requirements, 8.1.3 General Data Protection </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.6 </p>
<p>[18] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[29] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="Header-Manipulation"><a href="#Header-Manipulation" class="headerlink" title="Header Manipulation"></a>Header Manipulation</h4><h5 id="ABSTRACT-37"><a href="#ABSTRACT-37" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>HTTP 响应头文件中包含未验证的数据会引发 cache-poisoning、cross-site scripting、cross-user defacement、page hijacking、cookie manipulation 或 open redirect。</p>
<h5 id="EXPLANATION-37"><a href="#EXPLANATION-37" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>以下情况中会出现 Header Manipulation 漏洞：</p>
<ol>
<li><p>数据通过一个不可信赖的数据源进入 Web 应用程序，最常见的是 HTTP 请求。</p>
</li>
<li><p>数据包含在一个 HTTP 响应头文件里，未经验证就发送给了 Web 用户。</p>
</li>
</ol>
<p>如同许多软件安全漏洞一样，Header Manipulation 只是通向终端的一个途径，它本身并不是终端。从本质上看，这些漏洞是显而易见的：一个攻击者将恶意数据传送到易受攻击的应用程序，且该应用程序将数据包含在 HTTP 响应头文件中。</p>
<p>其中最常见的一种 Header Manipulation 攻击是 HTTP Response Splitting。为了成功地实施 HTTP Response Splitting 盗取，应用程序必须允许将那些包含 CR（回车，由 %0d 或 \r 指定）和 LF（换行，由 %0a 或 \n 指定）的字符输入到头文件中。攻击者利用这些字符不仅可以控制应用程序要发送的响应剩余头文件和正文，还可以创建完全受其控制的其他响应。</p>
<p>如今的许多现代应用程序服务器可以防止 HTTP 头文件感染恶意字符。例如，当新行传递到 header() 函数时，最新版本的 PHP 将生成一个警告并停止创建头文件。如果您的 PHP 版本能够阻止设置带有换行符的头文件，则其具备对 HTTP Response Splitting 的防御能力。然而，单纯地过滤换行符可能无法保证应用程序不受 Cookie Manipulation 或 Open Redirects 的攻击，因此必须在设置带有用户输入的 HTTP 头文件时采取措施。</p>
<p>示例： 下段代码会从 HTTP 请求读取位置，并在 HTTP 响应的位置字段的头文件中对其进行设置。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">    $location = $_GET[&#x27;some_location&#x27;];</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    header(&quot;location: $location&quot;);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>假设在请求中提交了一个由标准字母数字字符组成的字符串，如“index.html”，则包含该 Cookie 的 HTTP 响应可能表现为以下形式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">location: index.html</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>然而，因为该位置的值由未经验证的用户输入组成，所以仅当提交给 some_location 的值不包含任何 CR 和 LF 字符时，响应才会保留这种形式。如果攻击者提交的是一个恶意字符串，比如“index.html\r\nHTTP/1.1 200 OK\r\n…”，那么 HTTP 响应就会被分割成以下形式的两个响应：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">location: index.html</span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>显然，第二个响应已完全由攻击者控制，攻击者可以用任何所需标头和正文内容构建该响应。攻击者可以构建任意 HTTP 响应，从而发起多种形式的攻击，包括：cross-user defacement、web and browser cache poisoning、cross-site scripting 和 page hijacking。</p>
<p>Cross-User Defacement：攻击者可以向一个易受攻击的服务器发出一个请求，导致服务器创建两个响应，其中第二个响应可能会被曲解为对其他请求的响应，而这一请求很可能是与服务器共享相同 TCP 连接的另一用户发出的。这种攻击可以通过以下方式实现：攻击者诱骗用户，让他们自己提交恶意请求；或在远程情况下，攻击者与用户共享同一个连接到服务器（如共享代理服务器）的 TCP 连接。最理想的情况是，攻击者通过这种方式使用户相信自己的应用程序已经遭受了黑客攻击，进而对应用程序的安全性失去信心。最糟糕的情况是，攻击者可能提供经特殊技术处理的内容，这些内容旨在模仿应用程序的执行方式，但会重定向用户的私人信息（如帐号和密码），将这些信息发送给攻击者。</p>
<p>Cache Poisoning： 如果多用户 Web 缓存或者单用户浏览器缓存将恶意构建的响应缓存起来，该响应的破坏力会更大。如果响应缓存在共享的 Web 缓存（如在代理服务器中常见的缓存）中，那么使用该缓存的所有用户都会不断收到恶意内容，直到清除该缓存项为止。同样，如果响应缓存在单个用户的浏览器中，那么在清除该缓存项以前，该用户会不断收到恶意内容。然而，影响仅局限于本地浏览器的用户。 </p>
<p>Cross-Site Scripting：一旦攻击者控制了应用程序传送的响应，就可以选择多种恶意内容来传播给用户。Cross-Site Scripting 是最常见的攻击形式，这种攻击在响应中包含了恶意的 JavaScript 或其他代码，并在用户的浏览器中执行。基于 XSS 的攻击手段花样百出，几乎是无穷无尽的，但通常它们都会包含传输给攻击者的私人数据（如 Cookie 或者其他会话信息）。在攻击者的控制下，指引受害者进入恶意的网络内容；或者利用易受攻击的站点，对用户的机器进行其他恶意操作。对于易受攻击的应用程序用户，最常见且最危险的攻击就是使用 JavaScript 将会话和 authentication 信息返回给攻击者，而后攻击者就可以完全控制受害者的帐号了。 </p>
<p>Page Hijacking：除了利用一个易受攻击的应用程序向用户传输恶意内容，还可以利用相同的根漏洞，将服务器生成的供用户使用的敏感内容重定向，转而供攻击者使用。攻击者通过提交一个会导致两个响应的请求，即服务器做出的预期响应和攻击者创建的响应，致使某个中间节点（如共享的代理服务器）误导服务器所生成的响应，将本来应传送给用户的响应错误地传给攻击者。因为攻击者创建的请求产生了两个响应，第一个被解析为针对攻击者请求做出的响应，第二个则被忽略。当用户通过同一 TCP 连接发出合法请求时，攻击者的请求已经在此处等候，并被解析为针对受害者这一请求的响应。这时，攻击者将第二个请求发送给服务器，代理服务器利用针对受害者（用户）的、由该服务器产生的这一请求对服务器做出响应，因此，针对受害者的这一响应中会包含所有头文件或正文中的敏感信息。</p>
<p>Cookie Manipulation：当与类似跨站请求伪造的攻击相结合时，攻击者就可以篡改、添加、甚至覆盖合法用户的 cookie。</p>
<p>Open Redirect：如果允许未验证的输入来控制重定向机制所使用的 URL，可能会有利于攻击者发动钓鱼攻击。</p>
<h5 id="RECOMMENDATIONS-36"><a href="#RECOMMENDATIONS-36" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>针对 Header Manipulation 的解决方法是，确保在适当位置进行输入验证并检验其属性是否正确。</p>
<p>由于 Header Manipulation 漏洞出现在应用程序的输出中包含恶意数据时，因此，合乎逻辑的做法是在应用程序输出数据前一刻对其进行验证。然而，由于 Web 应用程序常常会包含复杂而难以理解的代码，用以生成动态响应，因此，这一方法容易产生遗漏错误（遗漏验证）。降低这一风险的有效途径是对 Header Manipulation 也执行输入验证。</p>
<p>由于 Web 应用程序必须验证输入信息以避免出现其他漏洞（如 SQL Injection），因此，一种相对简单的解决方法是增强应用程序现有的输入验证机制，增加针对 Header Manipulation 的检查。尽管具有一定的价值，但 Header Manipulation 输入验证并不能取代严格的输出验证。应用程序可能通过共享的数据存储器或其他可信赖的数据源接受输入，而该数据存储器所接受的输入源可能并未执行适当的输入验证。因此，应用程序不能间接地依赖于该数据或其他任意数据的安全性。这就意味着，避免 Header Manipulation 漏洞的最佳方法是验证所有应用程序输入数据或向用户输出的数据。</p>
<p>针对 Header Manipulation 漏洞进行验证最安全的方式是创建一份安全字符白名单，其中的字符允许出现在 HTTP 响应头文件中，并且只接受完全由这些受认可的字符组成的输入。例如，有效的用户名可能仅包含字母数字字符，帐号可能仅包含 0-9 的数字。</p>
<p>更灵活的方法是列入黑名单，但其安全性较差，这种方法在使用输入之前就有选择地拒绝或转义了潜在的危险字符。为了创建这样的列表，首先需要了解在 HTTP 响应头文件中具有特殊含义的一组字符。尽管 CR 和 LF 字符是 HTTP Response Splitting 攻击的核心，但其他字符，如“:”（冒号）和 ‘=’（等号），在响应标头中同样具有特殊的含义。</p>
<p>在应用程序中确定针对 Header Manipulation 攻击执行验证的正确要点，以及验证过程中要考虑的特殊字符之后，下一个难点就是确定验证过程中处理各种特殊字符的方式。应用程序应拒绝任何要添加到 HTTP 响应头文件中的包含特殊字符的输入，这些特殊字符（特别是 CR 和 LF）是无效字符。</p>
<p>许多应用程序服务器都试图避免应用程序出现 HTTP Response Splitting 漏洞，其做法是为负责设置 HTTP 头文件和 cookie 的函数提供各种执行方式，以检验是否存在进行 HTTP Response Splitting 攻击必需的字符。不要依赖运行应用程序的服务器，以此确保该应用程序的安全。开发了某个应用程序后，并不能保证在其生命周期中它会在哪些应用程序服务器中运行。由于标准和已知盗取方式的演变，我们不能保证应用程序服务器也会保持同步。</p>
<h5 id="REFERENCES-37"><a href="#REFERENCES-37" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] A. Klein Divide and Conquer: HTTP Response Splitting, Web Cache Poisoning Attacks, and Related Topics </p>
<p>[2] D. Crab HTTP Response Splitting </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 113 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[5] Standards Mapping - FIPS200 SI </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Web Application Security Consortium 24 + 2 HTTP Response Splitting </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 HTTP Response Splitting (WASC-25) </p>
<h4 id="Header-Manipulation-Cookies"><a href="#Header-Manipulation-Cookies" class="headerlink" title="Header Manipulation: Cookies"></a>Header Manipulation: Cookies</h4><h5 id="ABSTRACT-38"><a href="#ABSTRACT-38" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在 Cookies 中包含未验证的数据会引发 HTTP 响应头文件操作攻击，并可能导致 cache-poisoning、cross-site scripting、cross-user defacement、page hijacking、cookie manipulation 或 open redirect。</p>
<h5 id="EXPLANATION-38"><a href="#EXPLANATION-38" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>以下情况中会出现 Cookie Manipulation 漏洞：</p>
<ol>
<li><p>数据通过一个不可信赖的数据源进入 Web 应用程序，最常见的是 HTTP 请求。</p>
</li>
<li><p>数据包含在一个 HTTP Cookie 中，该 Cookie 未经验证就发送给了 Web 用户。</p>
</li>
</ol>
<p>如同许多软件安全漏洞一样，Cookie Manipulation 只是通向终端的一个途径，它本身并不是终端。从本质上看，这些漏洞是显而易见的：攻击者可将恶意数据传送到易受攻击的应用程序，且该应用程序将这些数据包含在 HTTP Cookie 中。</p>
<p>Cookie Manipulation：当与类似跨站请求伪造的攻击相结合时，攻击者就可以篡改、添加、甚至覆盖合法用户的 cookie。</p>
<p>作为 HTTP 响应头文件，Cookie Manipulation 攻击也可导致其他类型的攻击，例如：</p>
<p>HTTP Response Splitting：</p>
<p>其中最常见的一种 Header Manipulation 攻击是 HTTP Response Splitting。为了成功地实施 HTTP Response Splitting 盗取，应用程序必须允许将那些包含 CR（回车，由 %0d 或 \r 指定）和 LF（换行，由 %0a 或 \n 指定）的字符输入到头文件中。攻击者利用这些字符不仅可以控制应用程序要发送的响应剩余头文件和正文，还可以创建完全受其控制的其他响应。</p>
<p>如今的许多现代应用程序服务器可以防止 HTTP 头文件感染恶意字符。例如，如果尝试使用被禁用的字符设置头文件，最新版本的 Apache Tomcat 会抛出 IllegalArgumentException。如果您的应用程序服务器能够防止设置带有换行符的头文件，则其具备对 HTTP Response Splitting 的防御能力。然而，单纯地过滤换行符可能无法保证应用程序不受 Cookie Manipulation 或 Open Redirects 的攻击，因此必须在设置带有用户输入的 HTTP 头文件时采取措施。</p>
<p>示例：下列代码片段会从 HTTP 请求中读取网络日志项的作者名字 author，并将其置于一个 HTTP 响应的 cookie 头文件中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">    $author = $_GET[&#x27;AUTHOR_PARAM&#x27;];</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    header(&quot;author: $author&quot;);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>假设在请求中提交了一个字符串，该字符串由标准的字母数字字符组成，如“Jane Smith”，那么包含该 Cookie 的 HTTP 响应可能表现为以下形式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Set-Cookie: author=Jane Smith</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>然而，因为 cookie 值来源于未经校验的用户输入，所以仅当提交给AUTHOR_PARAM的值不包含任何 CR 和 LF 字符时，响应才会保留这种形式。如果攻击者提交的是一个恶意字符串，比如 “Wiley Hacker\r\nHTTP/1.1 200 OK\r\n……”，那么 HTTP 响应就会被分割成以下形式的两个响应：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Set-Cookie: author=Wiley Hacker</span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>显然，第二个响应已完全由攻击者控制，攻击者可以用任何所需标头和正文内容构建该响应。攻击者可以构建任意 HTTP 响应，从而发起多种形式的攻击，包括：cross-user defacement、web and browser cache poisoning、cross-site scripting 和 page hijacking。</p>
<p>Cross-User Defacement：攻击者可以向一个易受攻击的服务器发出一个请求，导致服务器创建两个响应，其中第二个响应可能会被曲解为对其他请求的响应，而这一请求很可能是与服务器共享相同 TCP 连接的另一用户发出的。这种攻击可以通过以下方式实现：攻击者诱骗用户，让他们自己提交恶意请求；或在远程情况下，攻击者与用户共享同一个连接到服务器（如共享代理服务器）的 TCP 连接。最理想的情况是，攻击者通过这种方式使用户相信自己的应用程序已经遭受了黑客攻击，进而对应用程序的安全性失去信心。最糟糕的情况是，攻击者可能提供经特殊技术处理的内容，这些内容旨在模仿应用程序的执行方式，但会重定向用户的私人信息（如帐号和密码），将这些信息发送给攻击者。</p>
<p>Cache Poisoning：如果多用户 Web 缓存或者单用户浏览器缓存将恶意构建的响应缓存起来，该响应的破坏力会更大。如果响应缓存在共享的 Web 缓存（如在代理服务器中常见的缓存）中，那么使用该缓存的所有用户都会不断收到恶意内容，直到清除该缓存项为止。同样，如果响应缓存在单个用户的浏览器中，那么在清除该缓存项以前，该用户会不断收到恶意内容。然而，影响仅局限于本地浏览器的用户。</p>
<p>Cross-Site Scripting：一旦攻击者控制了应用程序传送的响应，就可以选择多种恶意内容来传播给用户。Cross-Site Scripting 是最常见的攻击形式，这种攻击在响应中包含了恶意的 JavaScript 或其他代码，并在用户的浏览器中执行。基于 XSS 的攻击手段花样百出，几乎是无穷无尽的，但通常它们都会包含传输给攻击者的私人数据（如 Cookie 或者其他会话信息）。在攻击者的控制下，指引受害者进入恶意的网络内容；或者利用易受攻击的站点，对用户的机器进行其他恶意操作。对于易受攻击的应用程序用户，最常见且最危险的攻击就是使用 JavaScript 将会话和 authentication 信息返回给攻击者，而后攻击者就可以完全控制受害者的帐号了。</p>
<p>Page Hijacking：除了利用一个易受攻击的应用程序向用户传输恶意内容，还可以利用相同的根漏洞，将服务器生成的供用户使用的敏感内容重定向，转而供攻击者使用。攻击者通过提交一个会导致两个响应的请求，即服务器做出的预期响应和攻击者创建的响应，致使某个中间节点（如共享的代理服务器）误导服务器所生成的响应，将本来应传送给用户的响应错误地传给攻击者。因为攻击者创建的请求产生了两个响应，第一个被解析为针对攻击者请求做出的响应，第二个则被忽略。当用户通过同一 TCP 连接发出合法请求时，攻击者的请求已经在此处等候，并被解析为针对受害者这一请求的响应。这时，攻击者将第二个请求发送给服务器，代理服务器利用针对受害者（用户）的、由该服务器产生的这一请求对服务器做出响应，因此，针对受害者的这一响应中会包含所有头文件或正文中的敏感信息。</p>
<p>Open Redirect：如果允许未验证的输入来控制重定向机制所使用的 URL，可能会有利于攻击者发动钓鱼攻击。</p>
<h5 id="RECOMMENDATIONS-37"><a href="#RECOMMENDATIONS-37" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>针对 Cookie Manipulation 的解决方法是，确保在适当位置进行输入验证并检验其属性是否正确。</p>
<p>由于 Header Manipulation 漏洞（类似于 Cookie Manipulation）出现在应用程序的输出中包含恶意数据时，因此，合乎逻辑的做法是在应用程序输出数据前一刻对其进行验证。然而，由于 Web 应用程序常常会包含复杂而难以理解的代码，用以生成动态响应，因此，这一方法容易产生遗漏错误（遗漏验证）。降低这一风险的有效途径是对 Header Manipulation 也执行输入验证。</p>
<p>由于 Web 应用程序必须验证输入信息以避免出现其他漏洞（如 SQL Injection），因此，一种相对简单的解决方法是增强应用程序现有的输入验证机制，增加针对 Header Manipulation 的检查。尽管具有一定的价值，但 Header Manipulation 输入验证并不能取代严格的输出验证。应用程序可能通过共享的数据存储器或其他可信赖的数据源接受输入，而该数据存储器所接受的输入源可能并未执行适当的输入验证。因此，应用程序不能间接地依赖于该数据或其他任意数据的安全性。这就意味着，避免 Header Manipulation 漏洞的最佳方法是验证所有应用程序输入数据或向用户输出的数据。</p>
<p>针对 Header Manipulation 漏洞进行验证最安全的方式是创建一份安全字符白名单，其中的字符允许出现在 HTTP 响应头文件中，并且只接受完全由这些受认可的字符组成的输入。例如，有效的用户名可能仅包含字母数字字符，帐号可能仅包含 0-9 的数字。</p>
<p>更灵活的方法是列入黑名单，但其安全性较差，这种方法在使用输入之前就有选择地拒绝或转义了潜在的危险字符。为了创建这样的列表，首先需要了解在 HTTP 响应头文件中具有特殊含义的一组字符。尽管 CR 和 LF 字符是 HTTP Response Splitting 攻击的核心，但其他字符，如“:”（冒号）和 ‘=’（等号），在响应标头中同样具有特殊的含义。</p>
<p>在应用程序中确定针对 Header Manipulation 攻击执行验证的正确要点，以及验证过程中要考虑的特殊字符之后，下一个难点就是确定验证过程中处理各种特殊字符的方式。应用程序应拒绝任何要添加到 HTTP 响应头文件中的包含特殊字符的输入，这些特殊字符（特别是 CR 和 LF）是无效字符。</p>
<p>许多应用程序服务器都试图避免应用程序出现 HTTP Response Splitting 漏洞，其做法是为负责设置 HTTP 头文件和 cookie 的函数提供各种执行方式，以检验是否存在进行 HTTP Response Splitting 攻击必需的字符。不要依赖运行应用程序的服务器，以此确保该应用程序的安全。开发了某个应用程序后，并不能保证在其生命周期中它会在哪些应用程序服务器中运行。由于标准和已知盗取方式的演变，我们不能保证应用程序服务器也会保持同步。</p>
<h5 id="REFERENCES-38"><a href="#REFERENCES-38" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] A. Klein Divide and Conquer: HTTP Response Splitting, Web Cache Poisoning Attacks, and Related Topics </p>
<p>[2] D. Crab HTTP Response Splitting </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 113 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[5] Standards Mapping - FIPS200 SI </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Web Application Security Consortium 24 + 2 HTTP Response Splitting </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 HTTP Response Splitting (WASC-25) </p>
<h4 id="Header-Manipulation-SMTP"><a href="#Header-Manipulation-SMTP" class="headerlink" title="Header Manipulation: SMTP"></a>Header Manipulation: SMTP</h4><h5 id="ABSTRACT-39"><a href="#ABSTRACT-39" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在 SMTP 头中包括未经验证的数据使得攻击者可以添加任意标题（如 CC 或 BCC），从而利用这些标题向其本身泄露邮件内容或将邮件服务器用作垃圾邮件自动程序。</p>
<h5 id="EXPLANATION-39"><a href="#EXPLANATION-39" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在以下情况下会发生 SMTP Header Manipulation 漏洞：</p>
<ol>
<li><p>数据通过一个不可信赖的数据源进入应用程序，最常见的是 Web 应用程序中的 HTTP 请求。</p>
</li>
<li><p>数据包含在一个 SMTP 头中，该 SMTP 头未经验证就发送给了邮件服务器。</p>
</li>
</ol>
<p>如同许多软件安全漏洞一样，SMTP Header Manipulation 只是通向终端的一个途径，它本身并不是终端。从本质上看，这些漏洞是显而易见的：攻击者可将恶意数据传送到易受攻击的应用程序，且该应用程序将这些数据包含在 SMTP 头中。</p>
<p>一种最常见的 SMTP Header Manipulation 攻击用于分发垃圾邮件。如果应用程序包含一个允许设置电子邮件主题和正文的易受攻击的“联系我们”表单，攻击者将能够设置任意内容，并注入包含匿名（因为电子邮件是从受害者服务器发送的）指向垃圾邮件的电子邮件地址列表的 CC 标题。</p>
<p>示例：以下代码段读取“联系我们”表单的主题和正文：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$subject = $_GET[&#x27;subject&#x27;];</span><br><span class="line"></span><br><span class="line">$body =  $_GET[&#x27;body&#x27;];</span><br><span class="line"></span><br><span class="line">mail(&quot;support@acme.com&quot;, &quot;[Contact us query] &quot; . $subject, $body);</span><br></pre></td></tr></table></figure>
<p>假设在请求中提交了一个由标准字母和数字字符组成的字符串，如“Page not working”，那么 SMTP 头可能表现为以下形式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">subject: [Contact us query] Page not working</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>然而，因为该头的值是利用未经验证的用户输入构造的，所以仅当提交给 subject 的值不包含任何 CR 和 LF 字符时，响应才会保留这种形式。如果攻击者提交恶意字符串，例如“Congratulations!!You won the lottery!!!\r\ncc:victim1@mail.com,victim2@mail.com …”，则 SMTP 头将表现为以下形式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">subject: [Contact us query] Congratulations!! You won the lottery</span><br><span class="line"></span><br><span class="line">cc: victim1@mail.com,victim2@mail.com</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这将有效地允许攻击者制造垃圾邮件，或者发送匿名电子邮件等攻击。</p>
<h5 id="RECOMMENDATIONS-38"><a href="#RECOMMENDATIONS-38" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>针对 SMTP Header Manipulation 的解决方法是，确保在适当位置进行输入验证并检验其属性是否正确。</p>
<p>由于 SMTP Header Manipulation 漏洞出现在应用程序的输出中包含恶意数据时，因此，一个合乎逻辑的做法是在头上下文中使用数据前一刻对其进行验证，并确保没有非法 CRLF 字符可以破坏头结构。</p>
<h5 id="REFERENCES-39"><a href="#REFERENCES-39" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] OWASP Testing for IMAP/SMTP Injection (OTG-INPVAL-011) </p>
<p>[2] Vicente Aguilera Díaz MX Injection: Capturing and Exploiting Hidden Mail Servers </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 93 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[5] Standards Mapping - FIPS200 SI </p>
<p>[6] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Web Application Security Consortium Version 2.00 Abuse of Functionality (WASC-42) </p>
<h4 id="JSON-Injection"><a href="#JSON-Injection" class="headerlink" title="JSON Injection"></a>JSON Injection</h4><h5 id="ABSTRACT-40"><a href="#ABSTRACT-40" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该方法会将未经验证的输入写入 JSON。攻击者可以利用此调用将任意元素或属性注入 JSON 实体。</p>
<h5 id="EXPLANATION-40"><a href="#EXPLANATION-40" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>JSON injection 会在以下情况中出现：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>将数据写入到 JSON 流。 </p>
</li>
</ol>
<p>应用程序通常使用 JSON 来存储数据或发送消息。用于存储数据时，JSON 通常会像缓存数据那样处理，而且可能会包含敏感信息。用于发送消息时，JSON 通常与 RESTful 服务一起使用，并且可以用于传输敏感信息，例如身份验证凭据。</p>
<p>如果应用程序利用未经验证的输入构造 JSON，则可以更改 JSON 文档和消息的语义。在相对理想的情况下，攻击者可能会插入无关的元素，导致应用程序在解析 JSON 文档或请求时抛出异常。在更为严重的情况下，例如涉及 JSON Injection，攻击者可能会插入无关的元素，从而允许对 JSON 文档或请求中对业务非常关键的值执行可预见操作。还有一些情况，JSON Injection 可以导致 Cross-Site Scripting 或 Dynamic Code Evaluation。</p>
<p>例 1：以下 PHP 代码将非特权用户（这些用户具有“默认”角色，与之相反，特权用户具有“管理员”角色）的用户帐户身份验证信息从用户控制的 URL 参数 username 和 password 序列化为位于 ~/user_info.json 的 JSON 文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$username = $_GET[&#x27;username&#x27;];</span><br><span class="line"></span><br><span class="line">$password = $_GET[&#x27;password&#x27;];</span><br><span class="line"></span><br><span class="line">$user_info_json_string = &#x27;&#123;&quot;role&quot;:&quot;default&quot;,&quot;username&quot;:&quot;&#x27; . $username . &#x27;&quot;,&quot;password&quot;:&quot;&#x27; . $password . &#x27;&quot;&#125;&#x27;;</span><br><span class="line"></span><br><span class="line">$user_info_json_file = fopen(&#x27;~/user_info.json&#x27;, &#x27;w&#x27;);</span><br><span class="line"></span><br><span class="line">fwrite($user_info_json_file, $user_info_json_string);</span><br><span class="line"></span><br><span class="line">fclose($user_info_json_file);</span><br></pre></td></tr></table></figure>
<p>但是，由于 JSON 序列化使用字符串串联来执行，将不会对 username 和 password 中的不可信赖数据进行验证以转义与 JSON 相关的特殊字符。这样，用户就可以任意插入 JSON 密钥，可能会更改已序列化的 JSON 的结构。在本例中，如果非特权用户 mallory（密码为 Evil123!）将 %22,%22role%22:%22 附加到其用户名中，并将该值传递到 username URL 参数，则最终保存到 ~/user_info.json 的 JSON 将为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">  &quot;role&quot;:&quot;default&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;username&quot;:&quot;mallory&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;role&quot;:&quot;admin&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;password&quot;:&quot;Evil123!&quot;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果之后使用 PHP 的本地 json_decode() 函数对已序列化的 JSON 文件进行反序列化，如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$user_info_json_string = file_get_contents(&#x27;user_info.json&#x27;, &#x27;r&#x27;);</span><br><span class="line"></span><br><span class="line">$user_info_json_data = json_decode($user_info_json_string);</span><br></pre></td></tr></table></figure>
<p>$user_info_json_data 中 username、password 和 role 的最终值将分别为 mallory、Evil123! 和 admin。在没有进一步验证反序列化 JSON 中的值是否有效的情况下，应用程序会错误地为用户分配 mallory“管理员”特权。</p>
<h5 id="RECOMMENDATIONS-39"><a href="#RECOMMENDATIONS-39" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在将用户提供的数据写入 JSON 时，请遵循以下准则：</p>
<ol>
<li><p>不要使用从用户输入派生的名称创建 JSON 属性。</p>
</li>
<li><p>确保使用安全的序列化函数（能够以单引号或双引号分隔不可信赖的数据，并且避免任何特殊字符）执行对 JSON 的所有序列化操作。 </p>
</li>
</ol>
<p>示例 2：以下 PHP 代码实现的功能与Example 1 相同，但会使用 json_encode() 而不是字符串连接来对数据进行序列化，从而确保正确地分隔和转义任何不可信数据：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$username = $_GET[&#x27;username&#x27;];</span><br><span class="line"></span><br><span class="line">$password = $_GET[&#x27;password&#x27;];</span><br><span class="line"></span><br><span class="line">$user_info_array = array(&#x27;role&#x27; =&gt; &#x27;default&#x27;, &#x27;username&#x27; =&gt; $username, &#x27;password&#x27; =&gt; $password);</span><br><span class="line"></span><br><span class="line">$user_info_json_string = json_encode($user_info_array);</span><br><span class="line"></span><br><span class="line">$user_info_json_file = fopen(&#x27;~/user_info.json&#x27;, &#x27;w&#x27;);</span><br><span class="line"></span><br><span class="line">fwrite($user_info_json_file, $user_info_json_string);</span><br><span class="line"></span><br><span class="line">fclose($user_info_json_file);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-40"><a href="#REFERENCES-40" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 91 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[3] Standards Mapping - FIPS200 SI </p>
<p>[4] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[11] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="LDAP-Injection"><a href="#LDAP-Injection" class="headerlink" title="LDAP Injection"></a>LDAP Injection</h4><h5 id="ABSTRACT-41"><a href="#ABSTRACT-41" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>通过用户输入构造的动态 LDAP 筛选器允许攻击者修改指令的含义。</p>
<h5 id="EXPLANATION-41"><a href="#EXPLANATION-41" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>LDAP injection 错误在以下情况下出现：</p>
<p>1.数据从一个不可信赖的数据源进入程序。</p>
<p>2.该数据用于动态构造 LDAP 筛选器。</p>
<p>示例 1：以下代码动态构造一个 LDAP 查询，并对其加以执行，该查询可以检索所有报告给指定经理的雇员记录。该经理的名字是从 HTTP 请求中读取的，因此不可信任。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$managerName = $_POST[&quot;managerName&quot;]];</span><br><span class="line"></span><br><span class="line">//retrieve all of the employees who report to a manager</span><br><span class="line"></span><br><span class="line">$filter = &quot;(manager=&quot; . $managerName . &quot;)&quot;;</span><br><span class="line"></span><br><span class="line">$result = ldap_search($ds, &quot;ou=People,dc=example,dc=com&quot;, $filter);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>在正常情况下，诸如搜索向 John Smith 经理报告的雇员，该代码执行的筛选器如下：</p>
<p><code>(manager=Smith, John)</code></p>
<p>但是，由于筛选器是通过连接一个常数基本查询串和一个用户输入串动态构造而成的，因此，该查询只在managerName不包含任何 LDAP 元字符时才能正常运行。如果攻击者为managerName输入字符串Hacker, Wiley)(|(objectclass=*)，则该查询会变成：</p>
<p><code>(manager=Hacker, Wiley)(|(objectclass=*))</code></p>
<p>根据执行查询的权限，增加|(objectclass=*)条件会导致筛选器与目录中的所有输入都匹配，而且会使攻击者检索到有关用户输入池的信息。根据执行 LDAP 查询的权限大小，此次攻击的影响范围可能会有所差异，但是如果攻击者可以控制查询的命令结构，那么这样的攻击至少会影响执行 LDAP 查询的用户可以访问的所有记录。</p>
<h5 id="RECOMMENDATIONS-40"><a href="#RECOMMENDATIONS-40" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>LDAP injection 漏洞的根本原因是攻击者提供了可以改变 LDAP 查询含义的 LDAP 元字符。构造 LDAP 筛选器后，程序员会清楚哪些字符应作为命令解析，而哪些字符应作为数据解析。</p>
<p>为了防止攻击者侵犯程序员的各种预设情况，可以使用白名单的方法，确保 LDAP 查询中由用户控制的数值完全来自于预定的字符集合，不包含任何上下文中所已使用的 LDAP 元字符。如果由用户控制的数值范围要求它必须包含 LDAP 元字符，则使用相应的编码机制删除这些元字符在 LDAP 查询中的意义。</p>
<p>示例 2：上述例子可以进行重写，以便使用 ldap_escape 构造一个保护指令命令结构的滤字符串。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$manager = $_POST[&#x27;manager&#x27;];</span><br><span class="line"></span><br><span class="line">$filter = ldap_escape( &quot;(manager=&quot; . $manager .  &quot;)&quot;, null, LDAP_ESCAPE_FILTER);</span><br><span class="line"></span><br><span class="line">if ( ldap_search($ds, &quot;ou=People,dc=example,dc=com&quot;, $filter) ) &#123;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-41"><a href="#REFERENCES-41" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 90 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[3] Standards Mapping - FIPS200 SI </p>
<p>[4] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[5] Standards Mapping - MISRA C 2012 Rule 1.3 </p>
<p>[6] Standards Mapping - MISRA C++ 2008 Rule 0-3-1 </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.3.7 Output Encoding and Injection Prevention Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[23] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116 </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Web Application Security Consortium 24 + 2 LDAP Injection </p>
<p>[42] Standards Mapping - Web Application Security Consortium Version 2.00 LDAP Injection (WASC-29) </p>
<h4 id="LDAP-Manipulation"><a href="#LDAP-Manipulation" class="headerlink" title="LDAP Manipulation"></a>LDAP Manipulation</h4><h5 id="ABSTRACT-42"><a href="#ABSTRACT-42" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>执行一个 LDAP 指令，该指令包含了由用户控制的数值字符串，且使用滤字符串以外的字符，这可能会使攻击者改变指令的含义或执行非法 LDAP 命令。</p>
<h5 id="EXPLANATION-42"><a href="#EXPLANATION-42" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>LDAP manipulation 错误在以下情况中出现：</p>
<p>1.数据从一个不可信赖的数据源进入程序。</p>
<p>2.数据在一个动态 LDAP 指令的滤字符串之外使用。</p>
<p>示例 1：以下代码从用户处读取 dn 字符串，然后使用该字符串来执行 LDAP 查询。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$dn = $_POST[&#x27;dn&#x27;];</span><br><span class="line"></span><br><span class="line">if (ldap_bind($ds)) &#123;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">try &#123;</span><br><span class="line"></span><br><span class="line">  $rs = ldap_search($ds, $dn, &quot;ou=People,dc=example,dc=com&quot;, $attr);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>由于基dn来源于用户输入，且在匿名绑定的情况下执行查询，因此攻击者可能会通过指定一个意外的 DN 字符串来篡改查询结果。问题在于开发人员没能充分利用适当的访问控制机制来限制随后的查询，使其只能读取那些允许当前用户读取的雇员记录。</p>
<h5 id="RECOMMENDATIONS-41"><a href="#RECOMMENDATIONS-41" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>应用程序应该执行精确验证和通过绑定到具体的用户目录的方式来加强 access control 约束，而不是仅仅依赖于表示层来限制用户提交的值。在任何情况下，只要没有适当的权限，都不应该允许用户检索或修改目录中的相关记录。访问目录的每个查询应该执行该策略，这就意味着只有完全受限的查询在匿名绑定的情况下执行，从而有效避免了在 LDAP 系统上建立 access control 机制。</p>
<p>示例 2：以下代码实现的功能与Example 1 相同，但会验证从用户处读取的值，以确保它对应于有效的 dn，并且该代码会使用 LDAP 身份验证来确保该查询只影响允许当前用户访问的记录。check_dn 函数将在预定义的有效基 check_dn 值列表中查找 dn 字符串。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">if ( ldap_bind( $ld, $username, $password ) ) &#123;</span><br><span class="line"></span><br><span class="line">  $dn = $_POST[&#x27;dn&#x27;];</span><br><span class="line"></span><br><span class="line">  if (check_dn($dn)) &#123;</span><br><span class="line"></span><br><span class="line">    $rc = ldap_search( $ds, $dn, $filter )</span><br><span class="line"></span><br><span class="line">      ...</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-42"><a href="#REFERENCES-42" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 90 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[3] Standards Mapping - FIPS200 SI </p>
<p>[4] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[5] Standards Mapping - MISRA C 2012 Rule 1.3 </p>
<p>[6] Standards Mapping - MISRA C++ 2008 Rule 0-3-1 </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.3.7 Output Encoding and Injection Prevention Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[18] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116 </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Web Application Security Consortium Version 2.00 Abuse of Functionality (WASC-42) </p>
<h4 id="Log-Forging"><a href="#Log-Forging" class="headerlink" title="Log Forging"></a>Log Forging</h4><h5 id="ABSTRACT-43"><a href="#ABSTRACT-43" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>将未经验证的用户输入写入日志文件可致使攻击者伪造日志条目或将恶意信息内容注入日志。</p>
<h5 id="EXPLANATION-43"><a href="#EXPLANATION-43" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在以下情况下会发生 Log Forging 的漏洞：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入应用程序。 </p>
</li>
<li><p>数据写入到应用程序或系统日志文件中。 </p>
</li>
</ol>
<p>为了便于以后的审阅、统计数据收集或调试，应用程序通常使用日志文件来储存事件或事务的历史记录。根据应用程序自身的特性，审阅日志文件可在必要时手动执行，也可以自动执行，即利用工具自动挑选日志中的重要事件或带有某种倾向性的信息。</p>
<p>如果攻击者可以向随后会被逐字记录到日志文件的应用程序提供数据，则可能会妨碍或误导日志文件的解读。最理想的情况是，攻击者可能通过向应用程序提供包括适当字符的输入，在日志文件中插入错误的条目。如果日志文件是自动处理的，那么攻击者就可以通过破坏文件格式或注入意外的字符，从而使文件无法使用。更阴险的攻击可能会导致日志文件中的统计信息发生偏差。通过伪造或其他方式，受到破坏的日志文件可用于掩护攻击者的跟踪轨迹，甚至还可以牵连第三方来执行恶意行为 [1]。最糟糕的情况是，攻击者可能向日志文件注入代码或者其他命令，利用日志处理实用程序中的漏洞 [2]。</p>
<p>示例： 下列 Web 应用程序代码会尝试从一个请求对象中读取整数值。如果数值未被解析为整数，输入就会被记录到日志中，附带一条提示相关情况的错误消息。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">    $name   =$_GET[&#x27;name&#x27;];</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    $logout =$_GET[&#x27;logout&#x27;];</span><br><span class="line"></span><br><span class="line">    if(is_numeric($logout))</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    else</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        trigger_error(&quot;Attempt to log out: name: $name logout: $val&quot;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>如果用户为 logout 提交字符串“twenty-one”，而且他可以创建一个名为“admin”的用户，则日志中会记录以下条目：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PHP Notice: Attempt to log out: name: admin logout: twenty-one</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>但是，如果攻击者可以创建用户名 “admin+logout:+1+++++++++++++++++++++++”，则日志中将记录以下条目：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PHP Notice: Attempt to log out: name: admin logout: 1                       logout: twenty-one</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-42"><a href="#RECOMMENDATIONS-42" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用间接方法防止 Log Forging 攻击：创建一组与不同事件一一对应的合法日志条目，这些条目必须记录在日志中，并且仅记录该组条目。要捕获动态内容（如用户注销系统），请务必使用由服务器控制的数值，而非由用户提供的数据。这就确保了日志条目中绝不会直接使用由用户提供的输入。 </p>
<p>在某些情况下，这个方法有些不切实际，因为这样一组合法的日志条目实在太大或是太复杂了。这种情况下，开发者往往又会退而采用黑名单方法。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。然而，不安全字符列表很快就会不完善或过时。更好的方法是创建一份白名单，允许其中的字符出现在日志条目中，并且只接受完全由这些经认可的字符组成的输入。在大多数 Log Forging 攻击中，最关键的字符是“\n”（换行符），该字符决不能出现在日志条目白名单中。在使用默认的 trigger-error 函数时，在日志文件中将不会显示换行符，但是使用 set_error_handler 函数可能会覆盖默认的行为。覆盖默认的函数时，务必谨记此建议。</p>
<h5 id="REFERENCES-43"><a href="#REFERENCES-43" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] A. Muffet The night the log was forged. </p>
<p>[2] G. Hoglund, G. McGraw Exploiting Software Addison-Wesley</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 117 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[5] Standards Mapping - FIPS200 AU, SI </p>
<p>[6] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[7] Standards Mapping - MISRA C 2012 Rule 1.3 </p>
<p>[8] Standards Mapping - MISRA C++ 2008 Rule 0-3-1 </p>
<p>[9] Standards Mapping - NIST Special Publication 800-53 Revision 4 AU-9 Protection of Audit Information (P1) </p>
<p>[10] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.2.1 Sanitization and Sandboxing Requirements, 5.3.1 Output Encoding and Injection Prevention Requirements, 7.3.1 Log Protection Requirements, 7.3.2 Log Protection Requirements </p>
<p>[11] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs </p>
<p>[12] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[13] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[14] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[15] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[16] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1, Requirement 10.5.2 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2, Requirement 10.5.2 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1, Requirement 10.5.2 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1, Requirement 10.5.2 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1, Requirement 10.5.2 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1, Requirement 10.5.2 </p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1, Requirement 10.5.2 </p>
<p>[24] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection, Control Objective 8.4 - Activity Tracking </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="Object-Injection"><a href="#Object-Injection" class="headerlink" title="Object Injection"></a>Object Injection</h4><h5 id="ABSTRACT-44"><a href="#ABSTRACT-44" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>反序列化不可信赖的数据会允许注入任意 PHP 对象，导致程序代表攻击者执行恶意命令。</p>
<h5 id="EXPLANATION-44"><a href="#EXPLANATION-44" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果不可信赖的数据未经过正确清除即被传递给 unserialize() 函数，则会出现 Object injection 漏洞。攻击者可以将经特殊技术处理的序列化字符串传递到易受攻击的 unserialize() 调用，导致任意 PHP 对象注入应用程序范围。这种漏洞的严重性取决于应用程序范围中可用的类。攻击者会对实施 PHP 幻数方法（如 <strong>wakeup 或 </strong>destruct）的类感兴趣，因为他们可以执行这些方法中的代码。</p>
<p>例 1：以下代码显示了实施 __destruct() 幻数方法并执行定义为类属性的系统命令的 PHP 类。还有使用用户提供的数据对 unserialize() 进行的不安全调用。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">class SomeAvailableClass &#123;</span><br><span class="line"></span><br><span class="line">    public $command=null;</span><br><span class="line"></span><br><span class="line">    public function __destruct() &#123;</span><br><span class="line"></span><br><span class="line">            system($this-&gt;command);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">$user = unserialize($_GET[&#x27;user&#x27;]);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>在Example 1中，应用程序可能预期获得一个序列化的User对象，但攻击者实际上可能提供SomeAvailableClass的序列化版本，并为其command属性提供一个预定义值：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET REQUEST:  http://server/page.php?user=O:18:&quot;SomeAvailableClass&quot;:1:&#123;s:7:&quot;command&quot;;s:8:&quot;uname -a&quot;;&#125;</span><br></pre></td></tr></table></figure>
<p>一旦没有对$user对象的其他引用，析构函数方法将被调用并执行攻击者提供的命令。</p>
<p>攻击者可以使用称为“面向属性编程”的技术链接在调用易受攻击的unserialize()时声明的不同类，该技术由 Stefan Esser 在 BlackHat 2010 会议上提出。利用该技术，攻击者可以重复使用现有代码以生成其自己的负载。</p>
<h5 id="RECOMMENDATIONS-43"><a href="#RECOMMENDATIONS-43" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>应当禁止用户直接控制程序未序列化的命令。如果必须序列化用户输入，请使用其他序列化标准，如 JSON。</p>
<p>不要因为不存在实施危险幻数方法的类，就毫无顾忌地使用 unserialize()，尤其是在可以使用插件扩展的模块化应用程序中，因为新类可能会加载到不同的环境中，致使攻击者能够重复使用现有代码生成恶意负载。</p>
<h5 id="REFERENCES-44"><a href="#REFERENCES-44" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Johannes Dahse, Nikolai Krein, and Thorsten Holz Code Reuse Attacks in PHP: Automated POP Chain Generation </p>
<p>[2] Stefan Esser Utilizing Code Reuse/ROP in PHP Application Exploits </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 502 </p>
<p>[4] Standards Mapping - Common Weakness Enumeration Top 25 2019 [23] CWE ID 502 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.5.2 Input and Output Architectural Requirements, 5.5.1 Deserialization Prevention Requirements, 5.5.3 Deserialization Prevention Requirements </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A8 Insecure Deserialization </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="Open-Redirect"><a href="#Open-Redirect" class="headerlink" title="Open Redirect"></a>Open Redirect</h4><h5 id="ABSTRACT-45"><a href="#ABSTRACT-45" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果允许未验证的输入控制重定向机制所使用的 URL，可能会有利于攻击者发动钓鱼攻击。</p>
<h5 id="EXPLANATION-45"><a href="#EXPLANATION-45" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>通过重定向，Web 应用程序能够引导用户访问同一应用程序内的不同网页或访问外部站点。应用程序利用重定向来帮助进行站点导航，有时还跟踪用户退出站点的方式。当 Web 应用程序将客户端重定向到攻击者可以控制的任意 URL 时，就会发生 Open redirect 漏洞： </p>
<p>攻击者可以利用 Open redirect 漏洞诱骗用户访问某个可信赖站点的 URL，并将他们重定向到恶意站点。攻击者通过对 URL 进行编码，使最终用户很难注意到重定向的恶意目标，即使将这一目标作为 URL 参数传递给可信赖的站点时也会发生这种情况。因此，Open redirect 常被作为钓鱼手段的一种而滥用，攻击者通过这种方式来获取最终用户的敏感数据。</p>
<p>例 1：以下 PHP 代码会在用户单击链接时，指示用户浏览器打开从 dest 请求参数中解析的 URL。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    $strDest = $_GET[&quot;dest&quot;];</span><br><span class="line"></span><br><span class="line">    header(&quot;Location: &quot; . $strDest);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>如果受害者收到一封电子邮件，指示其打开“<a target="_blank" rel="noopener" href="http://trusted.example.com/ecommerce/redirect.php?dest=www.wilyhacker.com”链接，该用户就有可能会单击该链接，因为他会以为该链接会转到可信赖的站点。然而，当受害者单击该链接时，Example">http://trusted.example.com/ecommerce/redirect.php?dest=www.wilyhacker.com”链接，该用户就有可能会单击该链接，因为他会以为该链接会转到可信赖的站点。然而，当受害者单击该链接时，Example</a> 1 中的代码就会将浏览器重定向到“<a target="_blank" rel="noopener" href="http://www.wilyhacker.com”。">http://www.wilyhacker.com”。</a></p>
<p>很多用户都被告知，要始终监视通过电子邮件收到的 URL，以确保链接指向一个他们所熟知的可信赖站点。尽管如此，如果攻击者对目标 URL 进行 16 进制编码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;http://trusted.example.com/ecommerce/redirect.php?dest=%77%69%6C%79%68%61%63%6B%65%72%2E%63%6F%6D&quot;</span><br></pre></td></tr></table></figure>
<p>那么，即使再聪明的最终用户也可能会被欺骗，打开该链接。</p>
<h5 id="RECOMMENDATIONS-44"><a href="#RECOMMENDATIONS-44" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>不应当允许未验证的用户输入控制重定向机制中的目标 URL。而应采用间接方法：创建一份合法 URL 列表，用户可以指定其中的内容并且只能从中进行选择。利用这种方法，就绝不会直接使用用户提供的输入来指定要重定向到的 URL。</p>
<p>例 2：以下代码引用了一个通过有效 URL 传播的数组。用户单击的链接将通过与所需 URL 对应的数组索引来传递。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">        $strDest = intval($_GET[&quot;dest&quot;]);</span><br><span class="line"></span><br><span class="line">        if(($strDest &gt;= 0) &amp;&amp; ($strDest &lt;= count ($strURLArray) - 1 ))</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            $strFinalURL = $strURLArray[strDest];</span><br><span class="line"></span><br><span class="line">            header(&quot;Location: &quot; . $strFinalURL);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
<p>但在某些情况下，这种方法并不可行，因为这样一份合法 URL 列表过于庞大、难以跟踪。这种情况下，有一种类似的方法也能限制用于重定向用户的域，这种方法至少可以防止攻击者向用户发送恶意的外部站点。</p>
<h5 id="REFERENCES-45"><a href="#REFERENCES-45" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 601 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[3] Standards Mapping - FIPS200 SI </p>
<p>[4] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.1.5 Input Validation Requirements </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A10 Unvalidated Redirects and Forwards </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A10 Unvalidated Redirects and Forwards </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[19] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 601 </p>
<p>[20] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 601 </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3600 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3600 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3600 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3600 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3600 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3600 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3600 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Web Application Security Consortium 24 + 2 Content Spoofing </p>
<p>[39] Standards Mapping - Web Application Security Consortium Version 2.00 URL Redirector Abuse (WASC-38) </p>
<h4 id="Path-Manipulation"><a href="#Path-Manipulation" class="headerlink" title="Path Manipulation"></a>Path Manipulation</h4><h5 id="ABSTRACT-46"><a href="#ABSTRACT-46" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>允许用户输入控制文件系统操作所用的路径会导致攻击者能够访问或修改其他受保护的系统资源。</p>
<h5 id="EXPLANATION-46"><a href="#EXPLANATION-46" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当满足以下两个条件时，就会产生 path manipulation 错误：</p>
<ol>
<li><p>攻击者能够指定某一文件系统操作中所使用的路径。</p>
</li>
<li><p>攻击者可以通过指定特定资源来获取某种权限，而这种权限在一般情况下是不可能获得的。</p>
</li>
</ol>
<p>例如，在某一程序中，攻击者可以获得特定的权限，以重写指定的文件或是在其控制的配置环境下运行程序。</p>
<p>示例 1：以下代码使用来自于 HTTP 请求的输入来创建一个文件名。程序员没有考虑到攻击者可能使用像“../../tomcat/conf/server.xml”一样的文件名，从而导致应用程序删除它自己的配置文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$rName = $_GET[&#x27;reportName&#x27;];</span><br><span class="line"></span><br><span class="line">$rFile = fopen(&quot;/usr/local/apfr/reports/&quot; . rName,&quot;a+&quot;);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">unlink($rFile);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>示例 2：以下代码使用来自于配置文件的输入来决定打开哪个文件，并返回给用户。如果程序以足够的权限运行，且恶意用户能够篡改配置文件，那么他们可以通过程序读取系统中以扩展名 .txt 结尾的任何文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$filename = $CONFIG_TXT[&#x27;sub&#x27;] . &quot;.txt&quot;;</span><br><span class="line"></span><br><span class="line">$handle = fopen($filename,&quot;r&quot;);</span><br><span class="line"></span><br><span class="line">$amt = fread($handle, filesize($filename));</span><br><span class="line"></span><br><span class="line">echo $amt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-45"><a href="#RECOMMENDATIONS-45" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>防止 Path Manipulation 的最佳方法是采用一些间接手段：创建一个必须由用户选择的合法值的列表。通过这种方法，就不能直接使用用户提供的输入来指定资源名称。</p>
<p>但在某些情况下，这种方法并不可行，因为这样一份合法资源名的列表过于庞大，维护难度过大。因此，在这种情况下，程序员通常会采用黑名单的办法。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。但是，任何这样一份黑名单都不可能是完整的，而且将随着时间的推移而过时。更好的方法是创建一份白名单，允许其中的字符出现在资源名称中，且只接受完全由这些被认可的字符组成的输入。</p>
<h5 id="REFERENCES-46"><a href="#REFERENCES-46" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] G. Hoglund, G. McGraw Exploiting Software Addison-Wesley</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 22, CWE ID 73 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [10] CWE ID 022 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[5] Standards Mapping - FIPS200 SI </p>
<p>[6] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[7] Standards Mapping - MISRA C 2012 Rule 1.3 </p>
<p>[8] Standards Mapping - MISRA C++ 2008 Rule 0-3-1 </p>
<p>[9] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[10] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.2.2 Sanitization and Sandboxing Requirements, 12.3.1 File Execution Requirements, 12.3.2 File Execution Requirements </p>
<p>[11] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs </p>
<p>[12] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[13] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference </p>
<p>[14] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References </p>
<p>[15] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References </p>
<p>[16] Standards Mapping - OWASP Top 10 2017 A5 Broken Access Control </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.4 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[24] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[25] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 426 </p>
<p>[26] Standards Mapping - SANS Top 25 2010 Risky Resource Management - CWE ID 022 </p>
<p>[27] Standards Mapping - SANS Top 25 2011 Risky Resource Management - CWE ID 022 </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3600 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3600 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3600 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3600 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3600 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3600 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3600 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[43] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[44] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[45] Standards Mapping - Web Application Security Consortium 24 + 2 Path Traversal </p>
<p>[46] Standards Mapping - Web Application Security Consortium Version 2.00 Path Traversal (WASC-33) </p>
<h4 id="Possible-Variable-Overwrite-Functional-Scope"><a href="#Possible-Variable-Overwrite-Functional-Scope" class="headerlink" title="Possible Variable Overwrite: Functional Scope"></a>Possible Variable Overwrite: Functional Scope</h4><h5 id="ABSTRACT-47"><a href="#ABSTRACT-47" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>此程序会调用可覆盖当前作用域中变量的函数，这可能会为攻击者打开方便之门。</p>
<h5 id="EXPLANATION-47"><a href="#EXPLANATION-47" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>对于可覆盖当前作用域中已初始化的变量的函数，攻击者能够通过它影响依赖被覆盖变量的代码的执行情况。 </p>
<p>可覆盖当前作用域中的变量。 </p>
<p>示例 1：如果攻击者为下面这段 PHP 代码中的 str 提供恶意值，则对 parse_str() 的调用可能会覆盖当前作用域中的所有任意变量，包括 first。在这种情况下，如果包含 JavaScript 的恶意值覆盖 first，则该程序会很容易受到 cross-site scripting 攻击。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">    $first=&quot;User&quot;;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    $str =  $_SERVER[&#x27;QUERY_STRING&#x27;];</span><br><span class="line"></span><br><span class="line">    parse_str($str);</span><br><span class="line"></span><br><span class="line">    echo $first;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-46"><a href="#RECOMMENDATIONS-46" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用此方法时必须附加额外的参数，防止它覆盖变量。 </p>
<ul>
<li><p>调用 parse_str(string $encoded_string [, array &amp;$result ])（具有第二个参数），这样可以捕获操作结果以及防止函数覆盖当前作用域中的变量。 </p>
</li>
<li><p>调用 extract(array $var_array [, int $extract_type [, string $prefix ]] )（其中第二个参数设为 EXTR_SKIP），这样可以防止函数覆盖当前作用域中的变量。 </p>
</li>
</ul>
<p>示例 2：以下代码会在 parse_str() 中使用另一个参数来缓解Example 1 中的漏洞。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">    $first=&quot;User&quot;;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    $str =  $_SERVER[&#x27;QUERY_STRING&#x27;];</span><br><span class="line"></span><br><span class="line">    parse_str($str, $output);</span><br><span class="line"></span><br><span class="line">    echo $first;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-47"><a href="#REFERENCES-47" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 473 </p>
<p>[2] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[3] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6 </p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6 </p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6 </p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.6 </p>
<p>[7] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<h4 id="Possible-Variable-Overwrite-Global-Scope"><a href="#Possible-Variable-Overwrite-Global-Scope" class="headerlink" title="Possible Variable Overwrite: Global Scope"></a>Possible Variable Overwrite: Global Scope</h4><h5 id="ABSTRACT-48"><a href="#ABSTRACT-48" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>此程序会调用可覆盖全局变量的函数，这可能会为攻击者打开方便之门。</p>
<h5 id="EXPLANATION-48"><a href="#EXPLANATION-48" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>对于可覆盖已初始化的全局变量的函数，攻击者能够通过它影响依赖被覆盖变量的代码的执行情况。 </p>
<p>可覆盖全局变量。 </p>
<p>示例 1：如果攻击者为下面这段 PHP 代码中的 str 提供恶意值，则对 mb_parse_str() 的调用可能会覆盖所有任意变量，包括 first。在这种情况下，如果包含 JavaScript 的恶意值覆盖 first，则该程序会很容易受到 cross-site scripting 攻击。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">    $first=&quot;User&quot;;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    $str =  $_SERVER[&#x27;QUERY_STRING&#x27;];</span><br><span class="line"></span><br><span class="line">    mb_parse_str($str);</span><br><span class="line"></span><br><span class="line">    echo $first;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-47"><a href="#RECOMMENDATIONS-47" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>对于能够覆盖全局变量的函数，可通过下列方式避免它们覆盖全局变量： </p>
<ul>
<li><p>调用 <code>mb_parse_str(string $encoded_string [, array &amp;$result ])</code>（具有第二个参数），这样可以捕获操作结果以及防止函数覆盖全局变量。 </p>
</li>
<li><p>调用<code>extract(array $var_array [, int $extract_type [, string $prefix]])</code>（其中第二个参数设为 EXTR_SKIP），这样可以防止函数覆盖已定义的全局变量。 </p>
</li>
</ul>
<p>示例 2：以下代码会在 mb_parse_str() 中使用另一个参数来缓解Example 1 中的漏洞。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">    $first=&quot;User&quot;;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    $str =  $_SERVER[&#x27;QUERY_STRING&#x27;];</span><br><span class="line"></span><br><span class="line">    mb_parse_str($str, $output);</span><br><span class="line"></span><br><span class="line">    echo $first;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-48"><a href="#REFERENCES-48" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 473 </p>
<p>[2] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[3] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6 </p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6 </p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6 </p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.6 </p>
<p>[7] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<h4 id="Process-Control"><a href="#Process-Control" class="headerlink" title="Process Control"></a>Process Control</h4><h5 id="ABSTRACT-49"><a href="#ABSTRACT-49" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>从一个不可信赖的数据源或是不可信赖的环境中加载库，会导致应用程序以攻击者的名义执行恶意代码。</p>
<h5 id="EXPLANATION-49"><a href="#EXPLANATION-49" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Process control 漏洞主要表现为以下两种形式：</p>
<p>— 攻击者可以篡改程序加载的库的名称：攻击者直接地控制库所使用的名称。</p>
<p>— 攻击者可以篡改库加载的环境：攻击者间接控制库名称的含义。</p>
<p>在这种情况下，我们着重关注第一种情况，即攻击者有可能控制加载的库的名称。这种类型的 Process Control 漏洞会在以下情况下出现：</p>
<ol>
<li><p>数据从不可信赖的数据源进入应用程序。</p>
</li>
<li><p>数据作为代表应用程序所加载的库的一个或部分字符串使用。</p>
</li>
<li><p>通过在库中执行代码，应用程序授予攻击者在一般情况下无法获得的权限或能力。</p>
</li>
</ol>
<p>例 1：以下代码来自于一个具有特别权限的系统实用程序，使用系统属性 APPHOME 来确定系统的安装目录，然后用基于指定目录的相对路径加载本地库。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$home = getenv(&quot;APPHOME&quot;);</span><br><span class="line"></span><br><span class="line">$lib = $home + $LIBNAME;</span><br><span class="line"></span><br><span class="line">dl($lib);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这段代码允许攻击者加载库，并通过修改系统属性 APPHOME，指向一个包含恶意版本 LIBNAME 的不同路径，从而使用较高的应用程序权限去执行任意代码。由于程序不会验证从环境中读取的值，所以如果攻击者能够控制系统属性 APPHOME 的值，他们就能欺骗应用程序去运行恶意代码从而取得系统控制权。</p>
<p>例 2：下列代码使用 dl() 来从名为 sockets.dll 的库加载代码，此库可从多个位置加载，具体取决于您的安装和配置。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">dl(&quot;sockets&quot;);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这里的问题是，对于要加载的库来说，dl() 只会接受库的名称，而不接受库的路径。</p>
<p>在搜索顺序方面，如果攻击者将一份恶意的 sockets.dll 放在高于应用程序需要加载的文件的位置，那么应用程序就会加载该恶意代码，而不会选择加载最初需要的文件。由于应用程序的这一特性，它会以较高的权限运行，这就意味着攻击者的 sockets.dll 内容将以较高的权限运行，从而可能导致攻击者完全控制整个系统。</p>
<h5 id="RECOMMENDATIONS-48"><a href="#RECOMMENDATIONS-48" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>不要允许用户控制由程序加载的库。若加载库的选择一定要涉及用户输入的话，通常情况下，应用程序会期望这个特定的输入是一个很小的数值集合。而不是依赖输入的安全性以及不包含任何恶意信息。因此，应用程序所使用的输入应该仅从一个预先决定的、安全的库的集合中进行选择。如果输入看上去是恶意的，则应该将即将加载的库限制在这一集合的安全数值范围之内，或由程序拒绝继续执行该操作。</p>
<p>攻击者可以通过篡改环境间接地控制程序加载的库。我们不应当完全信赖环境，还需采取预防措施，防止攻击者利用某些控制环境的手段进行攻击。应尽可能避免对库进行动态加载。如果无法避免动态加载，应对照一系列定义有效参数的不变量对从环境中读取的库名称和路径进行仔细的检查。</p>
<p>有时还可以执行其他校验，以检查环境是否已被恶意篡改。例如，如果一个配置文件为可写，程序可能会拒绝运行。如果事先已知有关要加载的库的信息，程序就会执行检测，以校验文件的有效性。如果一个库应始终归属于某一特定用户，或者被分配了一组特定的权限，则可以在加载库之前，对这些属性进行校验。</p>
<p>最终，程序也许无法完全防范神通广大的攻击者控制其所加载的库。因此，对输入值和环境可能执行的任何操作，都应努力鉴别并加以防范。这样做是为了尽可能地防范各种攻击。</p>
<h5 id="REFERENCES-49"><a href="#REFERENCES-49" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] M. Achour et al. PHP Manual </p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 114, CWE ID 494 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [3] CWE ID 020 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001764, CCI-001774, CCI-002754 </p>
<p>[5] Standards Mapping - FIPS200 SI </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - MISRA C 2012 Rule 1.3 </p>
<p>[8] Standards Mapping - MISRA C++ 2008 Rule 0-3-1 </p>
<p>[9] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[10] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.14.2 Configuration Architectural Requirements, 5.1.3 Input Validation Requirements, 5.1.4 Input Validation Requirements, 10.2.3 Malicious Code Search, 10.3.2 Deployed Application Integrity Controls, 12.3.3 File Execution Requirements, 14.2.3 Dependency </p>
<p>[11] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[12] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[13] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference </p>
<p>[14] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References </p>
<p>[15] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References </p>
<p>[16] Standards Mapping - OWASP Top 10 2017 A5 Broken Access Control </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.4 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[24] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20),Improper Filesystem Permissions (WASC-17) </p>
<h4 id="Resource-Injection"><a href="#Resource-Injection" class="headerlink" title="Resource Injection"></a>Resource Injection</h4><h5 id="ABSTRACT-50"><a href="#ABSTRACT-50" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>使用用户输入控制资源标识符，借此攻击者可以访问或修改其他受保护的系统资源。</p>
<h5 id="EXPLANATION-50"><a href="#EXPLANATION-50" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当满足以下两个条件时，就会发生 resource injection：</p>
<ol>
<li>攻击者可以指定已使用的标识符来访问系统资源。</li>
</ol>
<p>例如，攻击者可能可以指定用来连接到网络资源的端口号。</p>
<ol>
<li>攻击者可以通过指定特定资源来获取某种权限，而这种权限在一般情况下是不可能获得的。</li>
</ol>
<p>例如，程序可能会允许攻击者把敏感信息传输到第三方服务器。</p>
<p>注意：如果资源注入涉及存储在文件系统中的资源，则可以将其报告为名为路径篡改的不同类别。有关这一漏洞的详细信息，请参见 path manipulation 的描述。</p>
<p>示例：下列代码使用从 HTTP 请求中读取的主机名来连接至数据库，该数据库可确定票价。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">    $host=$_GET[&#x27;host&#x27;];</span><br><span class="line"></span><br><span class="line">    $dbconn = pg_connect(&quot;host=$host port=1234 dbname=ticketdb&quot;);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">    $result = pg_prepare($dbconn, &quot;my_query&quot;, &#x27;SELECT * FROM pricelist WHERE name = $1&#x27;);</span><br><span class="line"></span><br><span class="line">    $result = pg_execute($dbconn, &quot;my_query&quot;, array(&quot;ticket&quot;));</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>这种受用户输入影响的资源表明其中的内容可能存在危险。例如，包含如句点、斜杠和反斜杠等特殊字符的数据在与 file system 相作用的方法中使用时，具有很大风险。类似的，对于创建远程结点的函数来说，包含 URL 和 URI 的数据也具有很大风险。</p>
<h5 id="RECOMMENDATIONS-49"><a href="#RECOMMENDATIONS-49" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>阻止 resource injection 的最佳做法是采用一些间接手段。例如创建一份合法资源名的列表，并且规定用户只能选择其中的文件名。通过这种方法，用户就不能直接由自己来指定资源的名称了。 </p>
<p>但在某些情况下，这种方法并不可行，因为这样一份合法资源名的列表过于庞大，维护难度过大。因此，在这种情况下，程序员通常会采用黑名单的办法。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。但是，任何这样一份黑名单都不可能是完整的，而且将随着时间的推移而过时。更好的方法是创建一份白名单，允许其中的字符出现在资源名称中，且只接受完全由这些被认可的字符组成的输入。</p>
<h5 id="REFERENCES-50"><a href="#REFERENCES-50" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] G. Hoglund, G. McGraw Exploiting Software Addison-Wesley</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 99 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[4] Standards Mapping - FIPS200 SI </p>
<p>[5] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[6] Standards Mapping - MISRA C 2012 Rule 1.3 </p>
<p>[7] Standards Mapping - MISRA C++ 2008 Rule 0-3-1 </p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A5 Broken Access Control </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection, Control Objective 5.4 - Authentication and Access Control </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3600 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3600 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3600 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3600 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3600 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3600 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3600 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="SQL-Injection"><a href="#SQL-Injection" class="headerlink" title="SQL Injection"></a>SQL Injection</h4><h5 id="ABSTRACT-51"><a href="#ABSTRACT-51" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>通过不可信赖的数据源输入构建动态 SQL 语句，攻击者就能够修改语句的含义或者执行任意 SQL 命令。</p>
<h5 id="EXPLANATION-51"><a href="#EXPLANATION-51" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>SQL injection 错误在以下情况下发生：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>数据用于动态地构造一个 SQL 查询。</p>
</li>
</ol>
<p>例 1：以下代码动态地构造并执行了一个 SQL 查询，该查询可以搜索与指定名称相匹配的项。该查询仅会显示条目所有者与被授予权限的当前用户一致的条目。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$userName = $_SESSION[&#x27;userName&#x27;];</span><br><span class="line"></span><br><span class="line">$itemName = $_POST[&#x27;itemName&#x27;];</span><br><span class="line"></span><br><span class="line">$query = &quot;SELECT * FROM items WHERE owner = &#x27;$userName&#x27; AND itemname = &#x27;$itemName&#x27;;&quot;;</span><br><span class="line"></span><br><span class="line">$result = mysql_query($query);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>查询计划执行以下代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &lt;userName&gt;</span><br><span class="line"></span><br><span class="line">AND itemname = &lt;itemName&gt;;</span><br></pre></td></tr></table></figure>
<p>但是，由于这个查询是动态构造的，由一个不变的查询字符串和一个用户输入字符串连接而成，因此只有在itemName不包含单引号字符时，才会正确执行这一查询。如果一个用户名为wiley的攻击者为itemName输入字符串“name’ OR ‘a’=’a”，那么查询就会变成：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &#x27;wiley&#x27;</span><br><span class="line"></span><br><span class="line">AND itemname = &#x27;name&#x27; OR &#x27;a&#x27;=&#x27;a&#x27;;</span><br></pre></td></tr></table></figure>
<p>附加条件OR ‘a’=’a’会使 where 从句永远评估为 true，因此该查询在逻辑上将等同于一个更为简化的查询：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>通常，查询必须仅返回已通过身份验证的用户所拥有的条目，而通过以这种方式简化查询，攻击者就可以规避这一要求。现在，查询会返回存储在items表中的所有条目，而不论其指定所有者是谁。</p>
<p>示例 2：此示例说明了将不同的恶意值传递给Example 1.中构造和执行的查询所带来的影响。如果一个用户名为wiley的攻击者为itemName输入字符串“name’; DELETE FROM items; –”，则该查询就会变为以下两个查询：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &#x27;wiley&#x27;</span><br><span class="line"></span><br><span class="line">AND itemname = &#x27;name&#x27;;</span><br><span class="line"></span><br><span class="line">DELETE FROM items;</span><br><span class="line"></span><br><span class="line">--&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>众多数据库服务器，其中包括 Microsoft(R) SQL Server 2000，都可以一次性执行多条用分号分隔的 SQL 指令。对于那些不允许运行用分号分隔的批量指令的数据库服务器，比如 Oracle 和其他数据库服务器，攻击者输入的这个字符串只会导致错误；但是在那些支持这种操作的数据库服务器上，攻击者可能会通过执行多条指令而在数据库上执行任意命令。</p>
<p>注意末尾的一对连字符 (–)；这在大多数数据库服务器上都表示该语句剩余部分将视为注释，不会加以执行 [4]。在这种情况下，可通过注释字符删除修改后的查询遗留的末尾单引号。而在不允许通过这种方式使用注释的数据库上，攻击者通常仍可使用类似于Example 1.中所用的技巧进行攻击。如果攻击者输入字符串“name’); DELETE FROM items; SELECT * FROM items WHERE ‘a’=’a”，将创建以下三个有效语句：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &#x27;wiley&#x27;</span><br><span class="line"></span><br><span class="line">AND itemname = &#x27;name&#x27;;</span><br><span class="line"></span><br><span class="line">DELETE FROM items;</span><br><span class="line"></span><br><span class="line">SELECT * FROM items WHERE &#x27;a&#x27;=&#x27;a&#x27;;</span><br></pre></td></tr></table></figure>
<p>避免 SQL injection 攻击的传统方法之一是，把它作为一个输入合法性检查的问题来处理，只接受列在白名单中的字符，或者识别并避免那些列在黑名单中的恶意数据。白名单方法是一种非常有效方法，它可以强制执行严格的输入检查规则，但是参数化的 SQL 指令所需维护更少，而且能提供更好的安全保障。而对于通常采用的列黑名单方式，由于总是存在一些小漏洞，所以并不能有效地防止 SQL injection 威胁。例如，攻击者可以：</p>
<ul>
<li><p>把没有被黑名单引用的值作为目标</p>
</li>
<li><p>寻找方法以绕过某些需要转义的元字符</p>
</li>
<li><p>使用存储过程隐藏注入的元字符</p>
</li>
</ul>
<p>手动去除 SQL 查询中的元字符有一定的帮助，但是并不能完全保护您的应用程序免受 SQL injection 攻击。</p>
<p>防范 SQL injection 攻击的另外一种常用方式是使用存储过程。虽然存储过程可以阻止某些类型的 SQL injection 攻击，但是对于绝大多数攻击仍无能为力。存储过程有助于避免 SQL injection 的常用方式是限制可作为参数传入的指令类型。但是，有许多方法都可以绕过这一限制，许多危险的表达式仍可以传入存储过程。所以再次强调，存储过程在某些情况下可以避免这种攻击，但是并不能完全保护您的应用系统抵御 SQL injection 的攻击。</p>
<h5 id="RECOMMENDATIONS-50"><a href="#RECOMMENDATIONS-50" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>造成 SQL injection 攻击的根本原因在于攻击者可以改变 SQL 查询的上下文，使程序员原本要作为数据解析的数值，被篡改为命令了。当构造一个 SQL 查询时，程序员应当清楚，哪些输入的数据将会成为命令的一部分，而哪些仅仅是作为数据。参数化 SQL 指令可以防止直接窜改上下文，避免几乎所有的 SQL injection 攻击。参数化 SQL 指令是用常规的 SQL 字符串构造的，但是当需要加入用户输入的数据时，它们就需要使用捆绑参数，这些捆绑参数是一些占位符，用来存放随后插入的数据。换言之，捆绑参数可以使程序员清楚地分辨数据库中的数据，即其中有哪些输入可以看作命令的一部分，哪些输入可以看作数据。这样，当程序准备执行某个指令时，它可以详细地告知数据库，每一个捆绑参数所使用的运行时的值，而不会被解析成对该命令的修改。</p>
<p>当连接到 MySQL 时，可以将前面的例子改写为使用参数化 SQL 指令（而不是联结用户输入的字符串），如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$mysqli = new mysqli($host,$dbuser, $dbpass, $db);</span><br><span class="line"></span><br><span class="line">$userName = $_SESSION[&#x27;userName&#x27;];</span><br><span class="line"></span><br><span class="line">$itemName = $_POST[&#x27;itemName&#x27;];</span><br><span class="line"></span><br><span class="line">$query = &quot;SELECT * FROM items WHERE owner = ? AND itemname = ?&quot;;</span><br><span class="line"></span><br><span class="line">$stmt = $mysqli-&gt;prepare($query);</span><br><span class="line"></span><br><span class="line">$stmt-&gt;bind_param(&#x27;ss&#x27;,$username,$itemName);</span><br><span class="line"></span><br><span class="line">$stmt-&gt;execute();</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>MySQL Improved 扩展 (mysqli) 适用于 MySQL 中的 PHP5 用户。依赖于不同数据库的代码应该检查相似的扩展名。</p>
<p>更加复杂的情况常常出现在报表生成代码中，因为这时需要通过用户输入来改变 SQL 指令的命令结构，比如在WHERE条件子句中加入动态的约束条件。不要因为这一需求，就无条件地接受连续的用户输入，从而创建查询语句字符串。当必须要根据用户输入来改变命令结构时，可以使用间接的方法来防止 SQL injection 攻击：创建一个合法的字符串集合，使其对应于可能要加入到 SQL 指令中的不同元素。在构造一个 SQL 指令时，可使用来自用户的输入，以便从应用程序控制的值集合中进行选择。</p>
<h5 id="REFERENCES-51"><a href="#REFERENCES-51" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] S. J. Friedl SQL Injection Attacks by Example </p>
<p>[2] P. Litwin Stop SQL Injection Attacks Before They Stop You MSDN Magazine</p>
<p>[3] P. Finnigan SQL Injection and Oracle, Part One Security Focus</p>
<p>[4] M. Howard, D. LeBlanc Writing Secure Code, Second Edition Microsoft Press</p>
<p>[5] Standards Mapping - Common Weakness Enumeration CWE ID 89 </p>
<p>[6] Standards Mapping - Common Weakness Enumeration Top 25 2019 [6] CWE ID 089 </p>
<p>[7] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001310, CCI-002754 </p>
<p>[8] Standards Mapping - FIPS200 SI </p>
<p>[9] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[10] Standards Mapping - MISRA C 2012 Rule 1.3 </p>
<p>[11] Standards Mapping - MISRA C++ 2008 Rule 0-3-1 </p>
<p>[12] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[13] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.3.4 Output Encoding and Injection Prevention Requirements, 5.3.5 Output Encoding and Injection Prevention Requirements </p>
<p>[14] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[15] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[16] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[17] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[18] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[19] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[24] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[25] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[26] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[27] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[28] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 089 </p>
<p>[29] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 089 </p>
<p>[30] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 089 </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[43] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[44] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[45] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[46] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[47] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[48] Standards Mapping - Web Application Security Consortium 24 + 2 SQL Injection </p>
<p>[49] Standards Mapping - Web Application Security Consortium Version 2.00 SQL Injection (WASC-19) </p>
<h4 id="SQL-Injection-Poor-Validation"><a href="#SQL-Injection-Poor-Validation" class="headerlink" title="SQL Injection: Poor Validation"></a>SQL Injection: Poor Validation</h4><h5 id="ABSTRACT-52"><a href="#ABSTRACT-52" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果依靠 HTML、XML 及其他类型的编码来验证不受信任的输入，攻击者也许就能够修改语句的含义或者执行任意 SQL 命令。</p>
<h5 id="EXPLANATION-52"><a href="#EXPLANATION-52" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用 mysql_real_escape_string() 等编码函数可避免一部分 SQL Injection 漏洞，但不能完全避免。 依靠此类编码函数等同于用一个安全性较差的黑名单来防止 SQL Injection 攻击，并且可能允许攻击者修改语句的含义或者执行任意 SQL 命令。 由于在动态解释代码的给定部分中不可能总是静态确定输入显示的位置，因此 Fortify 安全编码规则包可能会将经过验证的动态 SQL 数据显示为“SQL Injection: Poor Validation”问题，即使验证可能足以防止在该上下文中出现 SQL Injection 攻击时也是如此。</p>
<p>SQL Injection 错误在以下情况下发生：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>数据用于动态地构造 SQL 查询。</p>
</li>
</ol>
<p>示例 1： 以下示例演示数据库配置如何影响 mysqli_real_escape_string() 的行为。 将 SQL 模式设置为“NO_BACKSLASH_ESCAPES” 时，反斜杠字符会被视为正常字符，而不是转移字符[5]。 由于 mysqli_real_escape_string() 将此情况考虑在内，因此鉴于数据库配置，当 “ 不再转义为 \” 时，以下查询易受到 SQL Injection 的攻击。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysqli_query($mysqli, &#x27;SET SQL_MODE=&quot;NO_BACKSLASH_ESCAPES&quot;&#x27;);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">$userName = mysqli_real_escape_string($mysqli, $_POST[&#x27;userName&#x27;]);</span><br><span class="line"></span><br><span class="line">$pass = mysqli_real_escape_string($mysqli, $_POST[&#x27;pass&#x27;]);</span><br><span class="line"></span><br><span class="line">$query = &#x27;SELECT * FROM users WHERE userName=&quot;&#x27; . $userName . &#x27;&quot;AND pass=&quot;&#x27; . $pass. &#x27;&quot;;&#x27;;</span><br><span class="line"></span><br><span class="line">$result = mysqli_query($mysqli, $query);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>如果攻击者将 password 字段留空并为 userName 输入 “ OR 1=1;– ，则不对引号进行转义，最后的查询如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users</span><br><span class="line"></span><br><span class="line">WHERE userName = &quot;&quot;</span><br><span class="line"></span><br><span class="line">OR 1=1;</span><br><span class="line"></span><br><span class="line">-- &quot;AND pass=&quot;&quot;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>由于 OR 1=1 会导致 where 子句的值始终为 true 且双连字符会导致剩余语句被视为注释，因此该查询在逻辑上就等同于一个更为简单的查询：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>避免 SQL Injection 攻击的传统方法之一是，把它们作为输入验证问题来处理，并仅接受安全值白名单中的字符，或者识别并避免那些列在黑名单中的潜在恶意值。 列入白名单是一种非常有效的方法，它可以强制执行严格的输入验证规则，但是参数化的 SQL 语句所需的维护工作更少，而且能提供更好的安全保障。 而对于通常采用的列黑名单方式，由于总是存在一些小漏洞，所以并不能有效地防止 SQL Injection 攻击。 例如，攻击者可以：</p>
<ul>
<li><p>将没有被黑名单引用的字段作为目标</p>
</li>
<li><p>寻找方法以绕过某些需要转义的元字符</p>
</li>
<li><p>使用存储过程隐藏注入的元字符</p>
</li>
</ul>
<p>手动转义 SQL 查询输入中的字符有一定的帮助，但是并不能完全保护您的应用程序免受 SQL Injection 攻击。</p>
<p>防范 SQL Injection 攻击的另外一种常用解决方法是使用存储过程。 虽然存储过程可以阻止某些类型的 SQL Injection 攻击，但是对于绝大多数攻击仍无能为力。 存储过程有助于避免 SQL Injection 攻击的常用方式是限制可传入存储过程参数的语句类型。 但是，有许多方法都可以绕过这一限制，许多危险的语句仍可以传入存储过程。 所以再次强调，存储过程在某些情况下可以避免一些漏洞，但是并不能完全保护您的应用程序免受 SQL Injection 攻击。</p>
<h5 id="RECOMMENDATIONS-51"><a href="#RECOMMENDATIONS-51" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>造成 SQL Injection 漏洞的根本原因在于攻击者可以改变 SQL 查询的上下文，使程序员原本要作为数据解释的数值却被解释为命令了。 构造 SQL 查询后，程序员知道哪些字符应作为命令解释，哪些字符应作为数据解释。 参数化 SQL 语句可以防止直接窜改上下文，避免几乎所有的 SQL Injection 攻击。 参数化 SQL 语句是用常规的 SQL 字符串构造的，但是当需要添加用户提供的数据时，它们就需要使用捆绑参数，这些捆绑参数是一些占位符，用来存放随后插入的数据。 换言之，捆绑参数可以使程序员明确告知数据库哪些字符应被视为命令，哪些字符应被视为数据。 这样，当程序准备执行某个语句时，它可以明确告知数据库，每个捆绑参数所使用的运行时值，而不会存在数据被篡改为命令的风险。</p>
<p>示例 2： 连接到 MySQL 后，应始终使用参数化的 SQL 语句，而非用户提供的动态连接输入，如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$mysqli = new mysqli($host,$dbuser, $dbpass, $db);</span><br><span class="line"></span><br><span class="line">$userName = $_SESSION[&#x27;userName&#x27;];</span><br><span class="line"></span><br><span class="line">$itemName = $_POST[&#x27;itemName&#x27;];</span><br><span class="line"></span><br><span class="line">$query = &quot;SELECT * FROM items WHERE owner = ? AND itemname = ?&quot;;</span><br><span class="line"></span><br><span class="line">$stmt = $mysqli-&gt;prepare($query);</span><br><span class="line"></span><br><span class="line">$stmt-&gt;bind_param(&#x27;ss&#x27;,$username,$itemName);</span><br><span class="line"></span><br><span class="line">$stmt-&gt;execute();</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>MySQL Improved 扩展 (mysqli) 适用于 MySQL 中的 PHP5 用户。 依赖于不同数据库的代码应该检查相似的扩展名。</p>
<p>更加复杂的情况常常出现在报表生成代码中，因为这时需要通过用户输入来改变 SQL 语句的结构，比如在 WHERE 子句中添加动态约束条件。 不要因为这一需求，就无条件地接受连续的用户输入，从而创建查询字符串。 当必须要根据用户输入来改变命令结构时，可以使用间接的方法来防止 SQL Injection 攻击：创建一个合法的字符串集合，使其对应于可能要加入到 SQL 语句中的不同元素。 在构造语句时，可使用来自用户的输入，以便从应用程序控制的值集合中进行选择。</p>
<h5 id="REFERENCES-52"><a href="#REFERENCES-52" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] S. J. Friedl SQL Injection Attacks by Example </p>
<p>[2] P. Litwin Stop SQL Injection Attacks Before They Stop You MSDN Magazine</p>
<p>[3] P. Finnigan SQL Injection and Oracle, Part One Security Focus</p>
<p>[4] M. Howard, D. LeBlanc Writing Secure Code, Second Edition Microsoft Press</p>
<p>[5] 5.1.8 Server SQL Modes MySQL</p>
<p>[6] Standards Mapping - Common Weakness Enumeration CWE ID 89 </p>
<p>[7] Standards Mapping - Common Weakness Enumeration Top 25 2019 [6] CWE ID 089 </p>
<p>[8] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001310, CCI-002754 </p>
<p>[9] Standards Mapping - FIPS200 SI </p>
<p>[10] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[11] Standards Mapping - MISRA C 2012 Rule 1.3 </p>
<p>[12] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[13] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.3.4 Output Encoding and Injection Prevention Requirements, 5.3.5 Output Encoding and Injection Prevention Requirements </p>
<p>[14] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[15] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[16] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[17] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[18] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[19] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[24] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[25] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[26] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[27] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[28] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 089 </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[43] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[44] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[45] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[46] Standards Mapping - Web Application Security Consortium 24 + 2 SQL Injection </p>
<p>[47] Standards Mapping - Web Application Security Consortium Version 2.00 SQL Injection (WASC-19) </p>
<h4 id="Server-Side-Request-Forgery"><a href="#Server-Side-Request-Forgery" class="headerlink" title="Server-Side Request Forgery"></a>Server-Side Request Forgery</h4><h5 id="ABSTRACT-53"><a href="#ABSTRACT-53" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序将使用用户控制的数据启动与第三方系统的连接，以创建资源 URI。</p>
<h5 id="EXPLANATION-53"><a href="#EXPLANATION-53" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当攻击者可以影响应用程序服务器建立的网络连接时，将会发生 Server-Side Request Forgery。网络连接源自于应用程序服务器内部 IP 地址，因此攻击者将可以使用此连接来避开网络控制，并扫描或攻击没有以其他方式暴露的内部资源。</p>
<p>示例：在下列示例中，攻击者将能够控制服务器连接至的 URL。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$url = $_GET[&#x27;url&#x27;];</span><br><span class="line"></span><br><span class="line">$c = curl_init();</span><br><span class="line"></span><br><span class="line">curl_setopt($c, CURLOPT_POST, 0);</span><br><span class="line"></span><br><span class="line">curl_setopt($c,CURLOPT_URL,$url);</span><br><span class="line"></span><br><span class="line">$response=curl_exec($c);</span><br><span class="line"></span><br><span class="line">curl_close($c);</span><br></pre></td></tr></table></figure>
<p>攻击者能否劫持网络连接取决于他可以控制的 URI 的特定部分以及用于建立连接的库。例如，控制 URI 方案将使攻击者可以使用不同于 http 或 https 的协议，类似于下面这样：</p>
<ul>
<li><p>up://</p>
</li>
<li><p>ldap://</p>
</li>
<li><p>jar://</p>
</li>
<li><p>gopher://</p>
</li>
<li><p>mailto://</p>
</li>
<li><p>ssh2://</p>
</li>
<li><p>telnet://</p>
</li>
<li><p>expect://</p>
</li>
</ul>
<p>攻击者将可以利用劫持的此网络连接执行下列攻击：</p>
<ul>
<li><p>对内联网资源进行端口扫描。</p>
</li>
<li><p>避开防火墙。</p>
</li>
<li><p>攻击运行于应用程序服务器或内联网上易受攻击的程序。</p>
</li>
<li><p>使用 Injection 攻击或 CSRF 攻击内部/外部 Web 应用程序。</p>
</li>
<li><p>使用 file:// 方案访问本地文件。</p>
</li>
<li><p>在 Windows 系统上，file:// 方案和 UNC 路径可以允许攻击者扫描和访问内部共享。</p>
</li>
<li><p>执行 DNS 缓存中毒攻击。</p>
</li>
</ul>
<h5 id="RECOMMENDATIONS-52"><a href="#RECOMMENDATIONS-52" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请勿基于用户控制的数据建立网络连接，并要确保请求发送给预期的目的地。如果需要提供用户数据来构建目的地 URI，请采用间接方法：例如创建一份合法资源名的列表，并且规定用户只能选择其中的文件名。通过这种方法，用户就不能直接由自己来指定资源的名称了。</p>
<p>但在某些情况下，这种方法并不可行，因为这样一份合法资源名的列表过于庞大，维护难度过大。因此，在这种情况下，程序员通常会采用黑名单的办法。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。但是，任何这样一份黑名单都不可能是完整的，而且将随着时间的推移而过时。更好的方法是创建一份白名单，允许其中的字符出现在资源名称中，且只接受完全由这些被认可的字符组成的输入。</p>
<p>此外，如果需要，还要确保用户输入仅用于在目标系统上指定资源，但 URI 方案、主机和端口由应用程序控制。这样就可以大大减小攻击者能够造成的损害。</p>
<h5 id="REFERENCES-53"><a href="#REFERENCES-53" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Alexander Polyakov SSRF vs. Business critical applications BlackHat 2012</p>
<p>[2] SSRF bible. Cheatsheet ONSec Labs</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 918 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[5] Standards Mapping - FIPS200 SI </p>
<p>[6] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.2.6 Sanitization and Sandboxing Requirements, 12.6.1 SSRF Protection Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A5 Broken Access Control </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3600 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3600 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3600 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3600 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3600 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3600 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3600 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 Abuse of Functionality (WASC-42) </p>
<h4 id="Setting-Manipulation"><a href="#Setting-Manipulation" class="headerlink" title="Setting Manipulation"></a>Setting Manipulation</h4><h5 id="ABSTRACT-54"><a href="#ABSTRACT-54" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>允许对系统设置进行外部控制可以导致服务中断或意外的应用程序行为。</p>
<h5 id="EXPLANATION-54"><a href="#EXPLANATION-54" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当攻击者能够通过控制某些值来监控系统的行为、管理特定的资源、或在某个方面影响应用程序的功能时，即表示发生了 Setting Manipulation 漏洞。</p>
<p>由于 Setting Manipulation 漏洞影响到许多功能，因此，对它的任何说明都必然是不完整的。与其在 Setting Manipulation 这一类中寻找各个功能之间的紧密关系，不如往后退一步，考虑有哪些系统数值类型不能由攻击者来控制。</p>
<p>示例 1：以下 PHP 代码片段从 HTTP 请求中读取参数，并将该参数设置为数据库连接的当前目录。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    $table_name=$_GET[&#x27;catalog&#x27;];</span><br><span class="line"></span><br><span class="line">    $retrieved_array = pg_copy_to($db_connection, $table_name);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>在该示例中，攻击者通过提交一个不存在的目录名，或者连接到数据库中未授权的部分，从而可以引出一个错误。</p>
<p>总之，应禁止使用用户提供的数据或通过其他途径获取不可信任的数据，以防止攻击者控制某些敏感的数值。虽然攻击者控制这些数值的影响不会总能立刻显现，但是不要低估了攻击者的攻击力。</p>
<h5 id="RECOMMENDATIONS-53"><a href="#RECOMMENDATIONS-53" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>禁止由不可信赖的数据来控制敏感数值。在发生此种错误的诸多情况中，应用程序预期通过某种特定的输入，仅得到某一区间内的数值。如果可能的话，应用程序应仅通过输入从预定的安全数值集合中选择数据，而不是依靠输入得到期望的数值，从而确保应用程序行为得当。针对恶意输入，传递给敏感函数的数值应当是该集合中的某些安全选项的默认设置。即使无法事先了解安全数值集合，通常也可以检验输入是否在某个安全的数值区间内。若上述两种验证机制均不可行，则必须重新设计应用程序，以避免应用程序接受由用户提供的潜在危险数值。</p>
<h5 id="REFERENCES-54"><a href="#REFERENCES-54" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 15 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[3] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[4] Standards Mapping - MISRA C 2012 Rule 1.3 </p>
<p>[5] Standards Mapping - MISRA C++ 2008 Rule 0-3-1 </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.5.4 Input and Output Architectural Requirements, 5.2.1 Sanitization and Sandboxing Requirements, 5.3.1 Output Encoding and Injection Prevention Requirements, 13.1.1 Generic Web Service Security Verification Requirements, 14.4.2 HTTP Security Headers Requirements, 14.4.4 HTTP Security Headers Requirements </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="Unsafe-Reflection"><a href="#Unsafe-Reflection" class="headerlink" title="Unsafe Reflection"></a>Unsafe Reflection</h4><h5 id="ABSTRACT-55"><a href="#ABSTRACT-55" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>攻击者会创建一个意想不到且贯穿于整个应用程序的控制流路径，从而逃避潜在的安全检查。</p>
<h5 id="EXPLANATION-55"><a href="#EXPLANATION-55" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>若攻击者可以为应用程序提供确定实例化哪个类或调用哪个方法的参数值，那么就有可能创建一个贯穿于整个应用程序的控制流路径，而该路径并非是应用程序开发者最初设计的。这种攻击途径可能使攻击者避开 authentication 或 access control 检测，或使应用程序以一种意想不到的方式运行。即使狡猾的攻击者只能控制传送给指定函数或构造函数的参数，也有可能会成功地发起攻击。 </p>
<p>如果攻击者能够将文件上传到应用程序的类路径或者添加应用程序类路径的新入口，那么对应用程序来说，情况会非常糟糕。无论处于上面哪种情况，攻击者都能通过反射将新的行为引入应用程序，而这一行为往往可能是恶意的。</p>
<p>示例：应用程序使用反射 API 的一个共同理由是实现自己的命令发送器。以下例子显示了一个没有使用反射的命令发送器：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$ctl = $_GET[&quot;ctl&quot;];</span><br><span class="line"></span><br><span class="line">$ao = null;</span><br><span class="line"></span><br><span class="line">if (ctl-&gt;equals(&quot;Add&quot;)) &#123;</span><br><span class="line"></span><br><span class="line">  $ao = new AddCommand();</span><br><span class="line"></span><br><span class="line">&#125; else if ($ctl.equals(&quot;Modify&quot;)) &#123;</span><br><span class="line"></span><br><span class="line">  $ao = new ModifyCommand();</span><br><span class="line"></span><br><span class="line">&#125; else &#123;</span><br><span class="line"></span><br><span class="line">  throw new UnknownActionError();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$ao-&gt;doAction(request);</span><br></pre></td></tr></table></figure>
<p>程序员可能会修改这段代码，以便按照如下情况使用反射：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ctl = $_GET[&quot;ctl&quot;];</span><br><span class="line"></span><br><span class="line">$args = $_GET[&quot;args&quot;];</span><br><span class="line"></span><br><span class="line">$cmdClass = new ReflectionClass(ctl . &quot;Command&quot;);</span><br><span class="line"></span><br><span class="line">$ao = $cmdClass-&gt;newInstance($args);</span><br><span class="line"></span><br><span class="line">$ao-&gt;doAction(request);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>乍一看，这种修改似乎具有许多优点。代码的行数比原先少了，if/else 代码段也完全删除了，而且还可以在不改变命令发送器的情况下增加新的命令类型。</p>
<p>然而，这种修改允许攻击者将任意实现了 Worker 接口的对象实例化。如果命令发送器仍对 access control 负责，那么只要程序员创建实现 Worker 接口的新类，就务必要修改发送器的 access control 代码。如果未修改 access control 代码，那么一些 Worker 类就没有任何 access control 权限。</p>
<p>解决这种 access control 问题的一种方法是让 Worker 对象负责执行 access control 检查。下面是一段重新修改的代码示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ctl = $_GET[&quot;ctl&quot;];</span><br><span class="line"></span><br><span class="line">   $args = $_GET[&quot;args&quot;];</span><br><span class="line"></span><br><span class="line">   $cmdClass = new ReflectionClass(ctl . &quot;Command&quot;);</span><br><span class="line"></span><br><span class="line">   $ao = $cmdClass-&gt;newInstance($args);</span><br><span class="line"></span><br><span class="line">$ao-&gt;checkAccessControl(request);</span><br><span class="line"></span><br><span class="line">ao-&gt;doAction(request);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>虽然有所改进，但它鼓励了采用分散化的手段进行 access control，这使程序员在 access control 上更加容易犯错误。</p>
<p>这段代码还突出反映了通过反射构建命令发送器所引发的安全问题。攻击者能为任意种类的对象调用默认构造函数。实际上，攻击者甚至不会局限于使用实现了 Worker 接口的对象；系统中所有对象的默认构造函数都可以调用。如果对象没有实现 Worker 接口，则会在分配到 $ao 前抛出 ClassCastException。但如果构造函数执行了一些有利于攻击者的操作，则说明已经造成损害。对于简单的应用程序来说，这种情况的影响并不大，但是对于日趋复杂的大型应用程序来说，攻击者利用构造函数发动攻击并非没有可能。</p>
<h5 id="RECOMMENDATIONS-54"><a href="#RECOMMENDATIONS-54" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>防止 unsafe reflection 的最佳方法是采用一些间接手段：创建一个规定用户使用的合法名称列表，并仅允许用户从中进行选择。通过这个方法，就不会直接采用用户提供的输入指定传输到反射 API 的名称。</p>
<p>反射也可以用来创建自定义的数据驱动体系结构，这样，配置文件就可以决定应用程序所使用的对象类型和组合。这种编程风格会带来以下安全问题：</p>
<p>— 控制程序的配置文件是程序源代码的重要组成部分，必须进行保护及相应的检查。</p>
<p>— 因为应用程序的配置文件是唯一的，所以必须执行独特的操作来评估设计的安全性。</p>
<p>— 因为当前应用程序的语意由一个自定义格式的配置文件支配，为了得出最理想的静态分析结果，就需要自定义一些规则。</p>
<p>鉴于以上原因，除非开发组可以在安全评估方面投入大量的精力，否则避免使用这种风格的设计。</p>
<h5 id="REFERENCES-55"><a href="#REFERENCES-55" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 470, CWE ID 494 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001764, CCI-001774, CCI-002754 </p>
<p>[3] Standards Mapping - FIPS200 SI </p>
<p>[4] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[5] Standards Mapping - MISRA C 2012 Rule 1.3 </p>
<p>[6] Standards Mapping - MISRA C++ 2008 Rule 0-3-1 </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.14.2 Configuration Architectural Requirements, 10.3.2 Deployed Application Integrity Controls, 12.3.3 File Execution Requirements, 14.2.3 Dependency </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A5 Broken Access Control </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="XML-Injection"><a href="#XML-Injection" class="headerlink" title="XML Injection"></a>XML Injection</h4><h5 id="ABSTRACT-56"><a href="#ABSTRACT-56" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果在 XML 文档中写入未验证的数据，可能会使攻击者修改 XML 的结构和内容。</p>
<h5 id="EXPLANATION-56"><a href="#EXPLANATION-56" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>XML injection 会在以下情况中出现：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>数据写入到 XML 文档中。</p>
</li>
</ol>
<p>应用程序通常使用 XML 来存储数据或发送消息。当 XML 用于存储数据时，XML 文档通常会像数据库一样进行处理，而且可能会包含敏感信息。XML 消息通常在 web 服务中使用，也可用于传输敏感信息。XML 消息甚至还可用于发送身份验证凭据。</p>
<p>如果攻击者能够写入原始 XML，则可以更改 XML 文档和消息的语义。危害最轻的情况下，攻击者可能会插入无关的标签，导致 XML 解析器抛出异常。XML injection 更为严重的情况下，攻击者可以添加 XML 元素，更改身份验证凭据或修改 XML 电子商务数据库中的价格。还有一些情况，XML injection 可以导致 cross-site scripting 或 dynamic code evaluation。</p>
<p>示例 1：</p>
<p>假设攻击者能够控制下列 XML 中的 shoes。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;order&gt;</span><br><span class="line"></span><br><span class="line">   &lt;price&gt;100.00&lt;/price&gt;</span><br><span class="line"></span><br><span class="line">   &lt;item&gt;shoes&lt;/item&gt;</span><br><span class="line"></span><br><span class="line">&lt;/order&gt;</span><br></pre></td></tr></table></figure>
<p>现在假设，在后端 Web 服务请求中包含该 XML，用于订购一双鞋。假设攻击者可以修改请求，并将shoes替换成<code>shoes&lt;/item&gt;&lt;price&gt;1.00&lt;/price&gt;&lt;item&gt;shoes</code>。新的 XML 如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;order&gt;</span><br><span class="line"></span><br><span class="line">    &lt;price&gt;100.00&lt;/price&gt;</span><br><span class="line"></span><br><span class="line">    &lt;item&gt;shoes&lt;/item&gt;&lt;price&gt;1.00&lt;/price&gt;&lt;item&gt;shoes&lt;/item&gt;</span><br><span class="line"></span><br><span class="line">&lt;/order&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>当使用 XML 解析器时，第二个<code>&lt;price&gt;</code>标签中的值将会覆盖第一个<code>&lt;price&gt;</code>标签中的值。这样，攻击者就可以只花 1 美元购买一双价值 100 美元的鞋。</p>
<p>如果攻击者控制了已解析 XML 文档的前部或全部内容，则可能会发生这种攻击的一种更严重的形式，称为 XML External Entity (XXE) Injection。</p>
<p>示例 2：下面是一些易受 XXE 攻击的代码：</p>
<p>假定攻击者能控制以下代码的输入 XML：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$goodXML = $_GET[&quot;key&quot;];</span><br><span class="line"></span><br><span class="line">$doc = simplexml_load_string($goodXml);</span><br><span class="line"></span><br><span class="line">echo $doc-&gt;testing;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>现在假设攻击者将以下 XML 传递到Example 2中的代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><br><span class="line"></span><br><span class="line"> &lt;!DOCTYPE foo [</span><br><span class="line"></span><br><span class="line">   &lt;!ELEMENT foo ANY &gt;</span><br><span class="line"></span><br><span class="line">   &lt;!ENTITY xxe SYSTEM &quot;file:///c:/boot.ini&quot; &gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;</span><br></pre></td></tr></table></figure>
<p>在处理此 XML 时，将使用系统boot.ini文件的内容填充 <foo> 元素的内容。攻击者可能会利用返回到客户端的 XML 元素来窃取数据或获取有关网络资源是否存在的信息。</p>
<h5 id="RECOMMENDATIONS-55"><a href="#RECOMMENDATIONS-55" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将用户提供的数据写入 XML 时，应该遵守以下准则：</p>
<ol>
<li><p>不要使用从用户输入派生的名称创建标签或属性。</p>
</li>
<li><p>写入到 XML 之前，先对用户输入进行 XML 实体编码。</p>
</li>
<li><p>将用户输入包含在 CDATA 标签中。</p>
</li>
</ol>
<p>为了缓解 XML External Entity (XXE) Injection，可以使用以下选项：</p>
<p>将用户提供的数据写入 XML 时，应该遵守以下准则：</p>
<ol>
<li>通过所用的 XML 解析器禁用实体扩展。</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">libxml_disable_entity_loader(true);</span><br><span class="line"></span><br><span class="line">or</span><br><span class="line"></span><br><span class="line">$dom-&gt;resolveExternals=false;</span><br></pre></td></tr></table></figure>
<ol>
<li><p>写入到 XML 之前，先对用户输入进行 XML 实体编码。</p>
</li>
<li><p>如果需要实体扩展，则应：</p>
</li>
</ol>
<p>a. 对输入进行验证，以确保扩展实体没有问题并允许使用。</p>
<p>b. 限制该解析器在加载 XML 时可以执行的功能：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$doc = XMLReader::xml($badXml,&#x27;UTF-8&#x27;,LIBXML_NONET);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-56"><a href="#REFERENCES-56" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 91 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001310, CCI-002754 </p>
<p>[3] Standards Mapping - FIPS200 SI </p>
<p>[4] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[5] Standards Mapping - MISRA C 2012 Rule 1.3 </p>
<p>[6] Standards Mapping - MISRA C++ 2008 Rule 0-3-1 </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.3.10 Output Encoding and Injection Prevention Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3810 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3810 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3810 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3810 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3810 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3810 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 XML Injection (WASC-23) </p>
<h4 id="XPath-Injection"><a href="#XPath-Injection" class="headerlink" title="XPath Injection"></a>XPath Injection</h4><h5 id="ABSTRACT-57"><a href="#ABSTRACT-57" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>利用用户输入构建动态的 XPath 查询使攻击者可借机修改语句的含义。</p>
<h5 id="EXPLANATION-57"><a href="#EXPLANATION-57" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>XPath injection 会在以下情况中出现：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>数据用于动态构造一个 XPath 查询。</p>
</li>
</ol>
<p>示例 1：下列代码可动态地构造并执行一个 XPath 查询，为指定的帐户 ID 检索电子邮件地址。由于该帐户 ID 是从 HTTP 请求中读取的，因此不受信任。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">load(&#x27;articles.xml&#x27;);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">$xpath = new DOMXPath($doc);</span><br><span class="line"></span><br><span class="line">$emailAddrs = $xpath-&gt;query(&amp;quot;/accounts/account[acctID=&#x27;&amp;quot; . $_GET[&amp;quot;test1&amp;quot;] . &amp;quot;&#x27;]/email/text()&amp;quot;);</span><br><span class="line"></span><br><span class="line">//$arts = $xpath-&gt;evaluate(&amp;quot;/accounts/account[acctID=&#x27;&amp;quot; . $_GET[&amp;quot;test1&amp;quot;] . &amp;quot;&#x27;]/email/text()&amp;quot;)</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">foreach ($emailAddrs as $email)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    echo $email-&gt;nodeValue.&quot;&quot;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">	?&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>在正常情况下（例如搜索属于帐号 1 的电子邮件地址），此代码执行的查询将如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/accounts/account[acctID=&#x27;1&#x27;]/email/text()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>但是，由于这个查询是动态构造的，由一个不变的查询字符串和一个用户输入字符串连接而成，因此只有在 acctID 不包含单引号字符时，才会正确执行这一查询。如果攻击者为 acctID 输入字符串 1’ or ‘1’ = ‘1，则该查询会变成：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/accounts/account[acctID=&#x27;1&#x27; or &#x27;1&#x27; = &#x27;1&#x27;]/email/text()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>附加条件 1’ or ‘1’ = ‘1 会使 where 从句永远评估为 true，因此该查询在逻辑上将等同于一个更为简化的查询：</p>
<p><code>//email/text()</code></p>
<p>通常，查询必须仅返回已通过身份验证的用户所拥有的条目，而通过以这种方式简化查询，攻击者就可以规避这一要求。现在，查询会返回存储在文档中的所有电子邮件地址，而不论其指定所有者是谁。</p>
<h5 id="RECOMMENDATIONS-56"><a href="#RECOMMENDATIONS-56" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>造成 XPath injection 漏洞的根本原因在于攻击者能够改变 XPath 查询的上下文，导致程序员期望解释为数据的某个数值最终被解释为命令。构建 XPath 查询后，程序员知道哪些数值应解释为命令的一部分，哪些数值应解释为数据。</p>
<p>为了防止攻击者侵犯程序员的各种预设情况，可以使用白名单的方法，确保 XPath 查询中由用户控制的数值完全来自于预定的字符集合，不包含任何上下文中所已使用的 XPath 元字符。如果由用户控制的数值要求它包含 XPath 元字符，则使用相应的编码机制删除这些元字符在 XPath 查询中的意义。</p>
<p>例 2</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">load(&#x27;articles.xml&#x27;);</span><br><span class="line"></span><br><span class="line">$accId = intval($_GET[&amp;quot;accountId&amp;quot;]);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">$xpath = new DOMXPath($doc);</span><br><span class="line"></span><br><span class="line">$emailAddrs = $xpath-&gt;query(&amp;quot;/accounts/account[acctID=&#x27;&amp;quot; . $accId . &amp;quot;&#x27;]/email/text()&amp;quot;);</span><br><span class="line"></span><br><span class="line">//$arts = $xpath-&gt;evaluate(&amp;quot;/accounts/account[acctID=&#x27;&amp;quot; . $accId . &amp;quot;&#x27;]/email/text()&amp;quot;)</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">foreach ($emailAddrs as $email)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    echo $email-&gt;nodeValue.&quot;&quot;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>intval() PHP 函数有一点需要特别注意。当送入 intval() 函数的值不能被转换成数字时（即“abc”），intval() 函数将返回零。所以当 intval() 函数返回零时，应使应用程序采取正确的动作。</p>
<h5 id="REFERENCES-57"><a href="#REFERENCES-57" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 643 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001310, CCI-002754 </p>
<p>[3] Standards Mapping - FIPS200 SI </p>
<p>[4] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[5] Standards Mapping - MISRA C 2012 Rule 1.3 </p>
<p>[6] Standards Mapping - MISRA C++ 2008 Rule 0-3-1 </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.3.1 Output Encoding and Injection Prevention Requirements, 5.3.10 Output Encoding and Injection Prevention Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Web Application Security Consortium 24 + 2 XPath Injection </p>
<p>[41] Standards Mapping - Web Application Security Consortium Version 2.00 XPath Injection (WASC-39) </p>
<h4 id="XQuery-Injection"><a href="#XQuery-Injection" class="headerlink" title="XQuery Injection"></a>XQuery Injection</h4><h5 id="ABSTRACT-58"><a href="#ABSTRACT-58" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>通过利用用户输入构建动态 XQuery 表达式，攻击者就能够修改指令的含义。</p>
<h5 id="EXPLANATION-58"><a href="#EXPLANATION-58" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>XQuery injection 会在以下情况中出现：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>数据用于动态构造一个 XQuery 表达式。</p>
</li>
</ol>
<p>示例 1：下列代码可动态构造和执行 XQuery 表达式，以根据给定用户名和密码的组合检索用户帐户。由于用户名和密码是从 HTTP 请求中读取的，因此不可信。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">require_once &#x27;zorba_api.php&#x27;;</span><br><span class="line"></span><br><span class="line">$memstor = InMemoryStore::getInstance();</span><br><span class="line"></span><br><span class="line">$z = Zorba::getInstance($memstor);</span><br><span class="line"></span><br><span class="line">try &#123;</span><br><span class="line"></span><br><span class="line">  // get data manager</span><br><span class="line"></span><br><span class="line">  $dataman = $z-&gt;getXmlDataManager();</span><br><span class="line"></span><br><span class="line">  // load external XML document</span><br><span class="line"></span><br><span class="line">  $dataman-&gt;loadDocument(&#x27;users.xml&#x27;, file_get_contents(&#x27;users.xml&#x27;));</span><br><span class="line"></span><br><span class="line">  // create and compile query</span><br><span class="line"></span><br><span class="line">  $express =</span><br><span class="line"></span><br><span class="line">&quot;for \$user in doc(users.xml)//user[username=&#x27;&quot; . $_GET[&quot;username&quot;] . &quot;&#x27;and pass=&#x27;&quot; . $_GET[&quot;password&quot;] . &quot;&#x27;] return \$user&quot;</span><br><span class="line"></span><br><span class="line">  $query = $zorba-&gt;compileQuery($express);</span><br><span class="line"></span><br><span class="line">  // execute query</span><br><span class="line"></span><br><span class="line">  $result = $query-&gt;execute();</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>在正常情况下，诸如搜索采用相应用户名和密码的用户帐户，该代码执行的表达式如下：</p>
<p><code>for \$user in doc(users.xml)//user[username=&#39;test_user&#39; and pass=&#39;pass123&#39;] return \$user</code></p>
<p>但是，由于这个表达式是动态构造的，由一个常数基查询字符串和一个用户输入字符串连接而成，因此只有在 username 或 password 不包含单引号字符时，才会正确执行这一查询。如果攻击者为 username输入字符串 admin’ or 1=1 or ‘’=’，则该查询会变成：</p>
<p><code>for \$user in doc(users.xml)//user[username=&#39;admin&#39; or 1=1 or &#39;&#39;=&#39;&#39; and password=&#39;x&#39; or &#39;&#39;=&#39;&#39;] return \$user</code></p>
<p>添加条件 admin’ or 1=1 or ‘’=’ 会使 XQuery 表达式永远评估为 true。因此，该查询在逻辑上等同于更简单的查询：</p>
<p><code>//user[username=&#39;admin&#39;]</code></p>
<p>如此简化的查询会使攻击者绕过查询与密码匹配的要求；现在查询会返回文档中存储的管理用户，无论输入什么样的密码。</p>
<h5 id="RECOMMENDATIONS-57"><a href="#RECOMMENDATIONS-57" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>造成 XQuery injection 漏洞的根本原因在于攻击者能够改变 XQuery 表达式查询的上下文，导致程序员期望解释为数据的某个数值最终被解释为命令。构建 XQuery 表达式后，程序员知道哪些数值应解释为命令的一部分，哪些数值应解释为数据。</p>
<p>为了防止攻击者侵犯程序员的各种预设情况，可以使用白名单的方法，确保 XQuery 表达式中由用户控制的数值完全来自于预定的字符集合，不包含任何上下文中所已使用的 XQuery 元字符。如果由用户控制的数值要求它包含 XQuery 元字符，则使用相应的编码机制删除这些元字符在 XQuery 表达式中的意义。</p>
<h5 id="REFERENCES-58"><a href="#REFERENCES-58" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 652 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[3] Standards Mapping - FIPS200 SI </p>
<p>[4] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[11] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Web Application Security Consortium Version 2.00 XQuery Injection (WASC-46) </p>
<h4 id="XSLT-Injection"><a href="#XSLT-Injection" class="headerlink" title="XSLT Injection"></a>XSLT Injection</h4><h5 id="ABSTRACT-59"><a href="#ABSTRACT-59" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果处理未经验证的 XSL 样式表，则可能会使攻击者能够更改生成的 XML 的结构和内容、在文件系统中加入任意文件或执行任意代码。</p>
<h5 id="EXPLANATION-59"><a href="#EXPLANATION-59" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>XSLT injection 会在以下情况中出现：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>数据写入到 XSL 样式表中。</p>
</li>
</ol>
<p>通常，应用程序利用 XSL 样式表来转换 XML 文档的格式。XSL 样式表中包括特殊函数，虽然此类函数能改善转换进程，但如果使用不当也会带来更多漏洞。</p>
<p>如果攻击者能够在样式表中写入 XSL 元素，则可以更改 XSL 样式表和处理的语义。攻击者可能会更改样式表的输出以启用 XSS (Cross-Site Scripting) 攻击、公开本地文件系统资源的内容或执行任意代码。如果攻击者完全控制了提交给应用程序的样式表，则他们可能还会执行 XXE (XML External Entity) Injection 攻击。</p>
<p>示例 1：下面是一些易受 XSLT 注入攻击的代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$xml = new DOMDocument;</span><br><span class="line"></span><br><span class="line">$xml-&gt;load(&#x27;local.xml&#x27;);</span><br><span class="line"></span><br><span class="line">$xsl = new DOMDocument;</span><br><span class="line"></span><br><span class="line">$xsl-&gt;load($_GET[&#x27;key&#x27;]);</span><br><span class="line"></span><br><span class="line">$processor = new XSLTProcessor;</span><br><span class="line"></span><br><span class="line">$processor-&gt;registerPHPFunctions();</span><br><span class="line"></span><br><span class="line">$processor-&gt;importStyleSheet($xsl);</span><br><span class="line"></span><br><span class="line">echo $processor-&gt;transformToXML($xml);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>当攻击者将标识的 XSL 传递到 XSTL 处理器时，Example 1 中的代码会导致三种不同的漏洞利用：</p>
<ol>
<li>XSS：</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:php=&quot;http://php.net/xsl&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;xsl:template match=&quot;/&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;alert(xss)&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;/xsl:template&gt;</span><br><span class="line"></span><br><span class="line">&lt;/xsl:stylesheet&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>在处理 XSL 样式表时，<code>&lt;script&gt;</code>会进入受害者的浏览器，从而能够实施 cross-site scripting 攻击。</p>
<ol>
<li>读取服务器文件系统中的任意文件：</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:php=&quot;http://php.net/xsl&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;xsl:template match=&quot;/&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;xsl:copy-of select=&quot;document(&#x27;/etc/passwd&#x27;)&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;/xsl:template&gt;</span><br><span class="line"></span><br><span class="line">&lt;/xsl:stylesheet&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>上述 XSL 样式表将返回 /etc/passwd 文件的内容。</p>
<ol>
<li>执行任意 PHP 代码：</li>
</ol>
<p>XSLT 处理器通过启用“registerPHPFunctions”，能将本机 PHP 语言方法暴露为 XSLT 函数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:php=&quot;http://php.net/xsl&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;xsl:template match=&quot;/&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;xsl:value-of select=&quot;php:function(&#x27;passthru&#x27;,&#x27;ls -la&#x27;)&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;/xsl:template&gt;</span><br><span class="line"></span><br><span class="line">&lt;/xsl:stylesheet&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>上述样式表将在服务器上输出“ls”命令的结果。</p>
<h5 id="RECOMMENDATIONS-58"><a href="#RECOMMENDATIONS-58" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在将用户提供的数据写入 XSL 样式表时，请遵循以下准则：</p>
<ol>
<li><p>根据已知的正常值验证输入和白名单。</p>
</li>
<li><p>写入到 XML 之前，先对用户输入进行 XML 实体编码。</p>
</li>
</ol>
<h5 id="REFERENCES-59"><a href="#REFERENCES-59" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 494 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[3] Standards Mapping - FIPS200 SI </p>
<p>[4] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.14.2 Configuration Architectural Requirements, 10.3.2 Deployed Application Integrity Controls, 12.3.3 File Execution Requirements, 14.2.3 Dependency </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[12] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h3 id="安全特性"><a href="#安全特性" class="headerlink" title="安全特性"></a>安全特性</h3><h4 id="Access-Control-Database"><a href="#Access-Control-Database" class="headerlink" title="Access Control: Database"></a>Access Control: Database</h4><h5 id="ABSTRACT-60"><a href="#ABSTRACT-60" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果没有适当的 access control，就会执行一个包含用户控制主键的 SQL 指令，从而允许攻击者访问未经授权的记录。</p>
<h5 id="EXPLANATION-60"><a href="#EXPLANATION-60" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Database access control 错误在以下情况下发生：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>这个数据用来指定 SQL 查询中主键的值。</p>
</li>
</ol>
<p>例 1：以下代码用到一个参数化指令，这个指令转义了元字符，以防止 SQL injection 漏洞，并构建和执行一个 SQL 查询。该 SQL 查询指令可以搜索与指定标识符 [1] 相匹配的清单。您可以从与当前被授权用户有关的所有清单中选择这些标识符。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">       ...</span><br><span class="line"></span><br><span class="line">$id = $_POST[&#x27;id&#x27;];</span><br><span class="line"></span><br><span class="line">$query = &quot;SELECT * FROM invoices WHERE id = ?&quot;;</span><br><span class="line"></span><br><span class="line">$stmt = $mysqli-&gt;prepare($query);</span><br><span class="line"></span><br><span class="line">$stmt-&gt;bind_param(&#x27;ss&#x27;,$id);</span><br><span class="line"></span><br><span class="line">$stmt-&gt;execute();</span><br><span class="line"></span><br><span class="line">       ...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>问题在于开发者没有考虑到所有可能出现的id值。虽然界面生成了属于当前用户的清单标识符列表，但是攻击者可以绕过这个界面，从而获取所需的任何清单。由于此示例中的代码没有执行检查以确保用户具有访问所请求清单的权限，因此它会显示任何清单，即使此清单不属于当前用户。</p>
<p>许多现代 Web 框架都会提供对用户输入执行验证的机制（包括 Struts 和 Struts 2）。为了突出显示未经验证的输入源，该规则包会对 Fortify Static Code Analyzer（Fortify 静态代码分析器）报告的问题动态重新调整优先级，即在采用框架验证机制时降低这些问题被利用的几率并提供指向相应证据的指针。我们将这种功能称之为上下文敏感排序。为了进一步帮助 Fortify 用户执行审计过程，Fortify 软件安全研究团队开发了 Data Validation（数据验证）项目模板，该模板根据应用于输入源的验证机制按文件夹对问题进行了分组。</p>
<h5 id="RECOMMENDATIONS-59"><a href="#RECOMMENDATIONS-59" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>与其靠表示层来限制用户输入的值，还不如在应用程序和数据库层上进行 access control。任何情况下都不允许用户在没有取得相应权限的情况下获取或修改数据库中的记录。每个涉及数据库的查询都必须遵守这个原则，这可以通过把当前被授权的用户名作为查询语句的一部分来实现。 </p>
<p>示例 2：以下代码实现的功能与Example 1 相同，但是附加了一个限制，以验证清单是否属于当前经过身份验证的用户。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">       ...</span><br><span class="line"></span><br><span class="line">$mysqli = new mysqli($host,$dbuser, $dbpass, $db);</span><br><span class="line"></span><br><span class="line">$userName = getAuthenticated($_SESSION[&#x27;userName&#x27;]);</span><br><span class="line"></span><br><span class="line">$id = $_POST[&#x27;id&#x27;];</span><br><span class="line"></span><br><span class="line">$query = &quot;SELECT * FROM invoices WHERE id = ? AND user = ?&quot;;</span><br><span class="line"></span><br><span class="line">$stmt = $mysqli-&gt;prepare($query);</span><br><span class="line"></span><br><span class="line">$stmt-&gt;bind_param(&#x27;ss&#x27;,$id,$userName);</span><br><span class="line"></span><br><span class="line">$stmt-&gt;execute();</span><br><span class="line"></span><br><span class="line">       ...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-60"><a href="#REFERENCES-60" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] S. J. Friedl SQL Injection Attacks by Example </p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 566 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000213, CCI-001084, CCI-002165 </p>
<p>[4] Standards Mapping - FIPS200 AC </p>
<p>[5] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 4.1.2 General Access Control Design, 4.1.3 General Access Control Design, 4.1.5 General Access Control Design, 4.2.1 Operation Level Access Control, 13.4.2 GraphQL and other Web Service Data Layer Security Requirements </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A2 Broken Access Control </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A5 Broken Access Control </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.2 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.4 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[22] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 863 </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3480.1 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3480.1 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3480.1 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3480.1 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3480.1 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3480.1 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3480.1 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[40] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authorization </p>
<p>[41] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authorization (WASC-02) </p>
<h4 id="Cookie-Security-Cookie-not-Sent-Over-SSL"><a href="#Cookie-Security-Cookie-not-Sent-Over-SSL" class="headerlink" title="Cookie Security: Cookie not Sent Over SSL"></a>Cookie Security: Cookie not Sent Over SSL</h4><h5 id="ABSTRACT-61"><a href="#ABSTRACT-61" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序创建了 cookie，但未将 secure 标记设置为 true。</p>
<h5 id="EXPLANATION-61"><a href="#EXPLANATION-61" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>现今的 Web 浏览器支持每个 cookie 的 secure 标记。如果设置了该标记，那么浏览器只会通过 HTTPS 发送 cookie。通过未加密的通道发送 cookie 将使其受到网络截取攻击，因此安全标记有助于保护 cookie 值的保密性。如果 cookie 包含私人数据或带有会话标识符，那么该标记尤其重要。</p>
<p>示例 1：以下代码会在未设置 secure 标记的情况下将 cookie 添加到响应中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">setcookie(&quot;emailCookie&quot;, $email, 0, &quot;/&quot;, &quot;www.example.com&quot;);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>如果应用程序同时使用 HTTPS 和 HTTP，但没有设置 secure 标记，那么在 HTTPS 请求过程中发送的 cookie 也会在随后的 HTTP 请求过程中被发送。攻击者随后可截取未加密的网络信息流（通过无线网络时十分容易），从而危及 cookie 安全。</p>
<h5 id="RECOMMENDATIONS-60"><a href="#RECOMMENDATIONS-60" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>对所有新 cookie 设置 secure 标记，指示浏览器不要以明文形式发送这些 cookie。通过将 true 作为第六个参数传递给 setcookie()，便可完成此配置。</p>
<p>示例 2：以下代码会通过将 secure 标记设置为 true 来更正Example 1 中的错误。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setcookie(&quot;emailCookie&quot;, $email, 0, &quot;/&quot;, &quot;www.example.com&quot;, TRUE);</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-61"><a href="#REFERENCES-61" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] setcookie() documentation The PHP Group</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 614 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001184, CCI-002418, CCI-002420, CCI-002421, CCI-002422 </p>
<p>[4] Standards Mapping - FIPS200 CM, SC </p>
<p>[5] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.6.3 Look-up Secret Verifier Requirements, 3.2.3 Session Binding Requirements, 3.4.1 Cookie-based Session Management, 6.2.1 Algorithms, 8.1.6 General Data Protection </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M4 Unintended Data Leakage </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.3 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.7, Requirement 6.5.9 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4, Requirement 6.5.10 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4, Requirement 6.5.10 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4, Requirement 6.5.10 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 4.1, Requirement 6.5.4, Requirement 6.5.10 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 6.2 - Sensitive Data Protection, Control Objective 7 - Use of Cryptography </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260.1 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002220 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002220 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002220 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002220 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002220 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002220 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002220 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002220 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002220 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002220 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[39] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04) </p>
<h4 id="Cookie-Security-HTTPOnly-not-Set"><a href="#Cookie-Security-HTTPOnly-not-Set" class="headerlink" title="Cookie Security: HTTPOnly not Set"></a>Cookie Security: HTTPOnly not Set</h4><h5 id="ABSTRACT-62"><a href="#ABSTRACT-62" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序创建了 cookie，但未能将 HttpOnly 标记设置为 true。</p>
<h5 id="EXPLANATION-62"><a href="#EXPLANATION-62" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>所有主要浏览器均支持 HttpOnly Cookie 属性，可阻止客户端脚本访问 Cookie。Cross-Site Scripting 攻击通常会访问 Cookie，以试图窃取会话标识符或身份验证令牌。如果未启用 HttpOnly，攻击者就能更容易地访问用户 Cookie。</p>
<p>示例 1：以下代码会在未设置 HttpOnly 属性的情况下创建一个 Cookie。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setcookie(&quot;emailCookie&quot;, $email, 0, &quot;/&quot;, &quot;www.example.com&quot;, TRUE);  //Missing 7th parameter to set HttpOnly</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-61"><a href="#RECOMMENDATIONS-61" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在创建 Cookie 时启用 HttpOnly 属性。将 setcookie() 调用中的 HttpOnly 参数设置为 true，便可完成此配置。</p>
<p>示例 2：以下代码创建的 Cookie 与Example 1 中的代码创建的相同，但这次会将 HttpOnly 参数设置为 true。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setcookie(&quot;emailCookie&quot;, $email, 0, &quot;/&quot;, &quot;www.example.com&quot;, TRUE, TRUE);</span><br></pre></td></tr></table></figure>
<p>已开发出了多种绕过将 HttpOnly设置为 true 的机制，因此它并非完全有效。</p>
<h5 id="REFERENCES-62"><a href="#REFERENCES-62" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Amit Klein Round-up: Ways to bypass HttpOnly (and HTTP Basic auth) </p>
<p>[2] setcookie() documentation The PHP Group</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 1004 </p>
<p>[4] Standards Mapping - Common Weakness Enumeration Top 25 2019 [15] CWE ID 732 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001184, CCI-002418, CCI-002420, CCI-002421, CCI-002422 </p>
<p>[6] Standards Mapping - FIPS200 CM </p>
<p>[7] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1), SC-23 Session Authenticity (P1) </p>
<p>[9] Standards Mapping - OWASP Application Security Verification Standard 4.0 3.2.3 Session Binding Requirements, 3.4.2 Cookie-based Session Management, 4.1.3 General Access Control Design, 4.2.1 Operation Level Access Control, 4.3.3 Other Access Control Considerations, 13.1.4 Generic Web Service Security Verification Requirements </p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M4 Unintended Data Leakage </p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.3 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.7 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.10 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.10 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.10 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.10 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[32] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication </p>
<p>[33] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authentication (WASC-01) </p>
<h4 id="Cookie-Security-HTTPOnly-not-Set-on-Session-Cookie"><a href="#Cookie-Security-HTTPOnly-not-Set-on-Session-Cookie" class="headerlink" title="Cookie Security: HTTPOnly not Set on Session Cookie"></a>Cookie Security: HTTPOnly not Set on Session Cookie</h4><h5 id="ABSTRACT-63"><a href="#ABSTRACT-63" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序无法在会话 cookie 中设置 HttpOnly 标记。</p>
<h5 id="EXPLANATION-63"><a href="#EXPLANATION-63" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>所有主要浏览器均支持 HttpOnly Cookie 属性，可阻止客户端脚本访问 Cookie。Cross-Site Scripting 攻击通常会访问 Cookie，以试图窃取会话标识符或身份验证令牌。如果未启用 HttpOnly，攻击者就能更容易地访问用户 Cookie。</p>
<p>示例 1：以下代码将对会话 Cookie 禁用 HttpOnly 标记。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">session.cookie_httponly=0</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-62"><a href="#RECOMMENDATIONS-62" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在创建会话 cookie 时启用 HttpOnly 属性。在 PHP 配置文件中将 session.cookie_httponly 属性设置为 1 或 on，便可完成此配置。</p>
<p>示例 2：以下代码将对会话 Cookie 启用 HttpOnly 标记。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">session.cookie_httponly=1</span><br></pre></td></tr></table></figure>
<p>已开发出了多种绕过将HttpOnly设置为 true 的机制，因此它并非完全有效。</p>
<h5 id="REFERENCES-63"><a href="#REFERENCES-63" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Amit Klein Round-up: Ways to bypass HttpOnly (and HTTP Basic auth) </p>
<p>[2] Runtime Configuration The PHP Group</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 1004 </p>
<p>[4] Standards Mapping - Common Weakness Enumeration Top 25 2019 [15] CWE ID 732 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001184, CCI-002418, CCI-002420, CCI-002421, CCI-002422 </p>
<p>[6] Standards Mapping - FIPS200 CM </p>
<p>[7] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1), SC-23 Session Authenticity (P1) </p>
<p>[9] Standards Mapping - OWASP Application Security Verification Standard 4.0 3.2.3 Session Binding Requirements, 3.4.2 Cookie-based Session Management, 4.1.3 General Access Control Design, 4.2.1 Operation Level Access Control, 4.3.3 Other Access Control Considerations, 13.1.4 Generic Web Service Security Verification Requirements </p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M4 Unintended Data Leakage </p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.3 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.7 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.10 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.10 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.10 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.10 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[32] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication </p>
<p>[33] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authentication (WASC-01) </p>
<h4 id="Cookie-Security-Overly-Broad-Domain"><a href="#Cookie-Security-Overly-Broad-Domain" class="headerlink" title="Cookie Security: Overly Broad Domain"></a>Cookie Security: Overly Broad Domain</h4><h5 id="ABSTRACT-64"><a href="#ABSTRACT-64" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>域范围过大的 Cookie 为攻击者利用其他应用程序攻击某个应用程序创造了条件。</p>
<h5 id="EXPLANATION-64"><a href="#EXPLANATION-64" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>开发人员通常将 Cookie 设置为在类似“.example.com”的基本域中处于活动状态。这会使 Cookie 暴露在基本域和任何子域中的所有 Web 应用程序下。由于 Cookie 通常包含敏感信息（如会话标识符），因此在应用程序之间共享 Cookie 可能会导致其中一个应用程序的漏洞危及其他应用程序安全。</p>
<p>例 1：</p>
<p>假设您有一个安全应用程序并将其部署在 <a target="_blank" rel="noopener" href="http://secure.example.com/">http://secure.example.com/</a> 上，当用户登录时，该应用程序将使用域“.example.com”设置会话 cookie。</p>
<p>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">setcookie(&quot;mySessionId&quot;, getSessionID(), 0, &quot;/&quot;, &quot;.example.com&quot;, true, true);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>假设您在 <a target="_blank" rel="noopener" href="http://insecure.example.com/">http://insecure.example.com/</a> 上有另一个不太安全的应用程序，它包含 cross-site scripting 漏洞。任何浏览到 <a target="_blank" rel="noopener" href="http://insecure.example.com">http://insecure.example.com</a> 的 <a target="_blank" rel="noopener" href="http://secure.example.com">http://secure.example.com</a> 认证用户面临着暴露来自 <a target="_blank" rel="noopener" href="http://secure.example.com">http://secure.example.com</a> 的会话 cookie 的风险。</p>
<p>除了读取 cookie 外，攻击者还可能使用 insecure.example.com 进行 cookie poisoning 攻击，创建自己范围过大的 cookie，并覆盖来自 secure.example.com 的 cookie。</p>
<h5 id="RECOMMENDATIONS-63"><a href="#RECOMMENDATIONS-63" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>确保将 cookie 域设置为具有尽可能高的限制性。</p>
<p>例 2：以下代码显示如何针对“说明”部分中的示例将 cookie 域设置为 “secure.example.com”。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setcookie(&quot;mySessionId&quot;, getSessionID(), 0, &quot;/&quot;, &quot;secure.example.com&quot;, true, true);</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-64"><a href="#REFERENCES-64" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] setcookie() documentation The PHP Group</p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001368, CCI-001414 </p>
<p>[3] Standards Mapping - FIPS200 CM </p>
<p>[4] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M4 Unintended Data Leakage </p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[11] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.3 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.7 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.10 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.10 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.10 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.10 </p>
<p>[18] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Cookie-Security-Overly-Broad-Path"><a href="#Cookie-Security-Overly-Broad-Path" class="headerlink" title="Cookie Security: Overly Broad Path"></a>Cookie Security: Overly Broad Path</h4><h5 id="ABSTRACT-65"><a href="#ABSTRACT-65" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>可通过相同域中的其他应用程序访问路径范围过大的 cookie。</p>
<h5 id="EXPLANATION-65"><a href="#EXPLANATION-65" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>开发人员通常将 Cookie 设置为可从根上下文路径“/”进行访问。这会使 Cookie 暴露在该域的所有 Web 应用程序下。由于 Cookie 通常包含敏感信息（如会话标识符），因此在应用程序之间共享 Cookie 可能会导致其中一个应用程序的漏洞危及其他应用程序安全。</p>
<p>例 1：</p>
<p>假设您有一个论坛应用程序并将其部署在 <a target="_blank" rel="noopener" href="http://communitypages.example.com/MyForum">http://communitypages.example.com/MyForum</a> 上，当用户登录该论坛时，该应用程序将使用路径“/”设置会话 ID cookie。</p>
<p>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setcookie(&quot;mySessionId&quot;, getSessionID(), 0, &quot;/&quot;, &quot;communitypages.example.com&quot;, true, true);</span><br></pre></td></tr></table></figure>
<p>假设攻击者在<a target="_blank" rel="noopener" href="http://communitypages.example.com/EvilSite上创建了另一个应用程序，并在论坛上发布了该站点的链接。当论坛用户点击该链接时，浏览器会将/MyForum设置的">http://communitypages.example.com/EvilSite上创建了另一个应用程序，并在论坛上发布了该站点的链接。当论坛用户点击该链接时，浏览器会将/MyForum设置的</a> Cookie 发送到在/EvilSite上运行的应用程序。通过这种方式窃取会话 ID 后，攻击者就能够危及浏览到/EvilSite的任何论坛用户的帐户安全。</p>
<p>除了读取 cookie 外，攻击者还可能使用/EvilSite进行 cookie poisoning 攻击，创建自己范围过大的 cookie，并覆盖来自/MyForum的 cookie。</p>
<h5 id="RECOMMENDATIONS-64"><a href="#RECOMMENDATIONS-64" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>确保将 cookie 路径设置为具有尽可能高的限制性。</p>
<p>例 2：以下代码显示如何针对“说明”部分中的示例将 cookie 路径设置为 “/MyForum”。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setcookie(&quot;mySessionId&quot;, getSessionID(), 0, &quot;/MyForum&quot;, &quot;communitypages.example.com&quot;, true, true);</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-65"><a href="#REFERENCES-65" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] setcookie() documentation The PHP Group</p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001368, CCI-001414 </p>
<p>[3] Standards Mapping - FIPS200 CM </p>
<p>[4] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 3.4.5 Cookie-based Session Management </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M4 Unintended Data Leakage </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.3 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.7 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.10 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.10 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.10 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.10 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[30] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[31] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Cookie-Security-Overly-Broad-Session-Cookie-Domain"><a href="#Cookie-Security-Overly-Broad-Session-Cookie-Domain" class="headerlink" title="Cookie Security: Overly Broad Session Cookie Domain"></a>Cookie Security: Overly Broad Session Cookie Domain</h4><h5 id="ABSTRACT-66"><a href="#ABSTRACT-66" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>通过共享相同的基本域的应用程序可访问域范围过大的会话 cookie。</p>
<h5 id="EXPLANATION-66"><a href="#EXPLANATION-66" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>开发人员通常将会话 Cookie 设置为类似“.example.com”的基本域。然而，这会使会话 Cookie 暴露在基本域名和任何子域中的所有 Web 应用程序下。泄露会话 Cookie 可导致危及帐户安全。</p>
<p>示例：</p>
<p>假设您有一个安全应用程序并将其部署在 <a target="_blank" rel="noopener" href="http://secure.example.com/">http://secure.example.com/</a> 上，当用户登录时，该应用程序将使用域 “.example.com” 设置会话 cookie。</p>
<p>应用程序的配置文件中的条目如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">session.cookie_domain=.example.com</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>假设您在 <a target="_blank" rel="noopener" href="http://insecure.example.com/">http://insecure.example.com/</a> 上有另一个不太安全的应用程序，它包含 cross-site scripting 漏洞。任何浏览到 <a target="_blank" rel="noopener" href="http://insecure.example.com">http://insecure.example.com</a> 的 <a target="_blank" rel="noopener" href="http://secure.example.com">http://secure.example.com</a> 认证用户面临着暴露来自 <a target="_blank" rel="noopener" href="http://secure.example.com">http://secure.example.com</a> 的会话 cookie 的风险。</p>
<h5 id="RECOMMENDATIONS-65"><a href="#RECOMMENDATIONS-65" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>确保将 cookie 域设置为具有尽可能高的限制性。</p>
<p>php.ini 中的以下配置选项显示如何针对“说明”部分中的示例将会话 cookie 域设置为 “secure.example.com”。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">session.cookie_domain=secure.example.com</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-66"><a href="#REFERENCES-66" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Runtime Configuration The PHP Group</p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001368, CCI-001414 </p>
<p>[3] Standards Mapping - FIPS200 CM </p>
<p>[4] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M4 Unintended Data Leakage </p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[11] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.3 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.7 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.10 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.10 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.10 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.10 </p>
<p>[18] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Cookie-Security-Overly-Broad-Session-Cookie-Path"><a href="#Cookie-Security-Overly-Broad-Session-Cookie-Path" class="headerlink" title="Cookie Security: Overly Broad Session Cookie Path"></a>Cookie Security: Overly Broad Session Cookie Path</h4><h5 id="ABSTRACT-67"><a href="#ABSTRACT-67" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>可能通过共享相同域的应用程序危及路径范围过大的 cookie 的安全。</p>
<h5 id="EXPLANATION-67"><a href="#EXPLANATION-67" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>开发人员通常将会话 Cookie 设置为根上下文路径（“/”）。这会使 Cookie 暴露在域名相同的所有 Web 应用程序下。泄露会话 Cookie 可能导致危及帐户安全，因为攻击者可能利用域中任何应用程序的漏洞来窃取会话 Cookie。</p>
<p>示例：</p>
<p>假设您有一个论坛应用程序并将其部署在 <a target="_blank" rel="noopener" href="http://communitypages.example.com/MyForum">http://communitypages.example.com/MyForum</a> 上，当用户登录该论坛时，该应用程序将使用路径 “/“ 设置会话 cookie。</p>
<p>应用程序的配置文件中的条目如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">session.cookie_path = /</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>假设攻击者在 <a target="_blank" rel="noopener" href="http://communitypages.example.com/EvilSite上创建了另一个应用程序，并在论坛上发布了该站点的链接。当论坛用户点击该链接时，他的浏览器会将">http://communitypages.example.com/EvilSite上创建了另一个应用程序，并在论坛上发布了该站点的链接。当论坛用户点击该链接时，他的浏览器会将</a> /MyForum 设置的会话 Cookie 发送到在 /EvilSite 上运行的应用程序。通过这种方式窃取会话 Cookie 后，攻击者就能够危及浏览到 /EvilSite 的任何论坛用户的帐户安全。</p>
<h5 id="RECOMMENDATIONS-66"><a href="#RECOMMENDATIONS-66" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将会话 cookie 路径设置为具有尽可能高的限制性。</p>
<p>php.ini 中的以下配置选项显示如何针对“说明”部分中的示例将会话 cookie 路径设置为 “/MyForum”。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">session.cookie_path = /MyForum</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-67"><a href="#REFERENCES-67" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Runtime Configuration The PHP Group</p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001368, CCI-001414 </p>
<p>[3] Standards Mapping - FIPS200 CM </p>
<p>[4] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M4 Unintended Data Leakage </p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[11] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.3 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.7 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.10 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.10 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.10 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.10 </p>
<p>[18] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Cookie-Security-Persistent-Cookie"><a href="#Cookie-Security-Persistent-Cookie" class="headerlink" title="Cookie Security: Persistent Cookie"></a>Cookie Security: Persistent Cookie</h4><h5 id="ABSTRACT-68"><a href="#ABSTRACT-68" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>将敏感数据存储在永久性的 cookie 中可能导致违反保密性或危及帐户安全。</p>
<h5 id="EXPLANATION-68"><a href="#EXPLANATION-68" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>大多数 Web 编程环境默认设置为创建非永久性的 cookie。这些 cookie 仅驻留在浏览器内存中（不写入磁盘），并在浏览器关闭时丢失。程序员可以指定在浏览器会话中保留这些 cookie，直到将来某个日期为止。这样的 cookie 将被写入磁盘，在浏览器会话结束以及计算机重启后仍然存在。</p>
<p>如果私人信息存储在永久性 cookie 中，那么攻击者就有足够的时间窃取这些数据 — 尤其是因为通常将永久性 cookie 设置为在不久的将来到期。永久性 cookie 通常用于在用户与某个站点交互时对其进行标识。根据此跟踪数据的用途，有可能利用永久性 cookie 违反用户隐私。</p>
<p>示例：以下代码将 cookie 设置为在 10 年后过期。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">setcookie(&quot;emailCookie&quot;, $email, time()+60*60*24*365*10);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-67"><a href="#RECOMMENDATIONS-67" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>不要将敏感数据存储在永久性 cookie 中。应确保在合理的时间内清除与在服务器端存储的永久性 cookie 关联的所有数据。</p>
<h5 id="REFERENCES-68"><a href="#REFERENCES-68" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] setcookie() documentation The PHP Group</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 539 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001185, CCI-001941, CCI-001942, CCI-002361 </p>
<p>[5] Standards Mapping - FIPS200 MP </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-23 Session Authenticity (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 3.2.3 Session Binding Requirements, 8.3.4 Sensitive Private Data </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M9 Improper Session Handling </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.3, Requirement 6.5.8 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.7, Requirement 6.5.8 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.3 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.3, Requirement 6.5.10 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.3, Requirement 6.5.10 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.3, Requirement 6.5.10 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.3, Requirement 6.5.10 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000060 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002240 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000060 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002240 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000060 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002240 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000060 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002240 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000060 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002240 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000060 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002240 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000060 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002240 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000060 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002240 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000060 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002240 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000060 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002240 CAT I </p>
<p>[40] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[41] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Cookie-Security-Persistent-Session-Cookie"><a href="#Cookie-Security-Persistent-Session-Cookie" class="headerlink" title="Cookie Security: Persistent Session Cookie"></a>Cookie Security: Persistent Session Cookie</h4><h5 id="ABSTRACT-69"><a href="#ABSTRACT-69" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>永久性会话 cookie 可导致危及帐户安全。</p>
<h5 id="EXPLANATION-69"><a href="#EXPLANATION-69" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>永久性会话 cookie 在用户关闭了浏览器后仍然保持有效，并通常用作“记住我的信息”功能的一部分。因此，即使在用户关闭了浏览器后，永久性会话 cookie 也会使他们保持应用程序认证状态 — 假设他们没有明确注销。这就意味着如果第二个用户打开浏览器，他将以上个用户的身份自动登录。除非在受控环境中部署了应用程序，而在该环境中，不允许用户从共享计算机登录，否则即使用户关闭了浏览器，攻击者也可能危及用户帐户的安全。</p>
<p>示例：以下配置将会话 cookie 设置为在 2 小时后过期。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">session.cookie_lifetime = 7200;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-68"><a href="#RECOMMENDATIONS-68" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>不要使用永久性会话 cookie。在 PHP 配置文件中将 session.cookie_lifetime 设置为 0，便可完成此配置。</p>
<h5 id="REFERENCES-69"><a href="#REFERENCES-69" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Runtime Configuration The PHP Group</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 539 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001185, CCI-001941, CCI-001942, CCI-002361 </p>
<p>[5] Standards Mapping - FIPS200 MP </p>
<p>[6] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-23 Session Authenticity (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 3.2.3 Session Binding Requirements, 8.3.4 Sensitive Private Data </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M9 Improper Session Handling </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.3, Requirement 6.5.8 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.7, Requirement 6.5.8 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.3 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.3, Requirement 6.5.10 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.3, Requirement 6.5.10 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.3, Requirement 6.5.10 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.3, Requirement 6.5.10 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000060 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002240 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000060 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002240 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000060 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002240 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000060 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002240 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000060 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002240 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000060 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002240 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000060 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002240 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000060 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002240 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000060 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002240 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000060 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002240 CAT I </p>
<p>[40] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication </p>
<p>[41] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authentication (WASC-01) </p>
<h4 id="Cookie-Security-Session-Cookie-not-Sent-Over-SSL"><a href="#Cookie-Security-Session-Cookie-not-Sent-Over-SSL" class="headerlink" title="Cookie Security: Session Cookie not Sent Over SSL"></a>Cookie Security: Session Cookie not Sent Over SSL</h4><h5 id="ABSTRACT-70"><a href="#ABSTRACT-70" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序将 session.cookie_secure 属性设置为 0&gt; 或 off。</p>
<h5 id="EXPLANATION-70"><a href="#EXPLANATION-70" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>现今的 Web 浏览器支持每个 cookie 的 secure 标记。如果设置了该标记，那么浏览器只会通过 HTTPS 发送 cookie。通过未加密的通道发送 cookie 将使其受到网络截取攻击，因此安全标记有助于保护 cookie 值的保密性。如果 cookie 包含私人数据或带有会话标识符，那么该标记尤其重要。</p>
<p>示例：以下配置条目关闭了会话 cookie 的 secure 位。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">session.cookie_secure=0</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>如果应用程序同时使用 HTTPS 和 HTTP，但没有设置 secure 标记，那么在 HTTPS 请求过程中发送的 cookie 也会在随后的 HTTP 请求过程中被发送。攻击者随后可截取未加密的网络信息流（通过无线网络时十分容易），从而危及 cookie 安全。</p>
<h5 id="RECOMMENDATIONS-69"><a href="#RECOMMENDATIONS-69" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>对所有 cookie 设置 secure 标记，指示浏览器不要通过 HTTPS 发送这些 cookie。在 PHP 配置文件中将 session.cookie_secure 属性设置为 1 或 on，便可完成此配置。</p>
<p>示例 2：以下代码会通过将 session.cookie_secure 属性设置为 1 来更正Example 1 中的错误。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">session.cookie_secure=1</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-70"><a href="#REFERENCES-70" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] setcookie() documentation The PHP Group</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 614 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001184, CCI-002418, CCI-002420, CCI-002421, CCI-002422 </p>
<p>[4] Standards Mapping - FIPS200 CM, SC </p>
<p>[5] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.6.3 Look-up Secret Verifier Requirements, 3.2.3 Session Binding Requirements, 3.4.1 Cookie-based Session Management, 6.2.1 Algorithms, 8.1.6 General Data Protection </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M4 Unintended Data Leakage </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.3 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.7, Requirement 6.5.9 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4, Requirement 6.5.10 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4, Requirement 6.5.10 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4, Requirement 6.5.10 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 4.1, Requirement 6.5.4, Requirement 6.5.10 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 6.2 - Sensitive Data Protection, Control Objective 7 - Use of Cryptography </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002230 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002230 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002230 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002230 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002230 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002230 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002230 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002230 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002230 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002230 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[39] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication, Insufficient Session Expiration </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authentication (WASC-01), Insufficient Transport Layer Protection (WASC-04) </p>
<h4 id="Cookie-Security-Session-Cookies-Disabled"><a href="#Cookie-Security-Session-Cookies-Disabled" class="headerlink" title="Cookie Security: Session Cookies Disabled"></a>Cookie Security: Session Cookies Disabled</h4><h5 id="ABSTRACT-71"><a href="#ABSTRACT-71" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序不使用 cookie 传输会话标识符，这可能导致易受 session fixation 和 session hijacking 攻击。</p>
<h5 id="EXPLANATION-71"><a href="#EXPLANATION-71" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>大多数 Web 应用程序使用会话标识符来唯一标识用户，该标识符通常存储在 cookie 中，并在服务器和 Web 浏览器之间进行透明传输。 </p>
<p>没有在 cookie 中存储会话标识符的应用程序有时将这些标识符作为 HTTP 请求参数或 URL 的一部分进行传输。接受 URL 中指定的会话标识符使得攻击者很容易进行 session fixation 攻击。 </p>
<p>将会话标识符放在 URL 中还会增加针对应用程序进行 session hijacking 攻击的成功几率。当攻击者控制了受害者的活动会话或会话标识符时，就会发生 session hijacking。对于 Web 服务器、应用程序服务器和 Web 代理而言，通常的做法是存储请求的 URL。如果会话标识符包括在 URL 中，那么也会记录它们。增加能够查看和存储会话标识符的位置就会增加被攻击者攻击的机会。</p>
<h5 id="RECOMMENDATIONS-70"><a href="#RECOMMENDATIONS-70" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将会话标识符存储在 cookie 中。在 PHP 配置文件中将 session.use_cookies 或 session.use_only_cookies 属性设置为 1 或 on，便可完成此配置。</p>
<h5 id="REFERENCES-71"><a href="#REFERENCES-71" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Runtime Configuration The PHP Group</p>
<p>[2] Session Fixation Micro Focus Fortify</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 384 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001664, CCI-001941, CCI-001942 </p>
<p>[5] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-23 Session Authenticity (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 3.2.1 Session Binding Requirements, 3.2.3 Session Binding Requirements, 3.3.1 Session Logout and Timeout Requirements </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M9 Improper Session Handling </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A3 Broken Authentication and Session Management </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A7 Broken Authentication and Session Management </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A3 Broken Authentication and Session Management </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.3 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.7 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.10 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.10 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.10 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.10 </p>
<p>[20] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3090 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3405 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3405 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3405 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3405 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3405 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3405 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002270 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002270 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002270 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002270 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002270 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002270 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002270 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002270 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002270 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002270 CAT II </p>
<p>[38] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[39] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="File-Permission-Manipulation"><a href="#File-Permission-Manipulation" class="headerlink" title="File Permission Manipulation"></a>File Permission Manipulation</h4><h5 id="ABSTRACT-72"><a href="#ABSTRACT-72" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>允许用户输入直接更改文件权限会导致攻击者能够访问其他受保护的系统资源。</p>
<h5 id="EXPLANATION-72"><a href="#EXPLANATION-72" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当满足以下任一条件时，就会产生 file permission manipulation 错误：</p>
<ol>
<li><p>攻击者能够指定在 file system 中修改权限的操作所使用的路径。</p>
</li>
<li><p>攻击者能够指定 file system 上的操作所分配的权限。</p>
</li>
</ol>
<p>示例：以下代码旨在为用户设置适当的文件权限以通过 FTP 上载网页。它使用来自 HTTP 请求的输入将文件标记为外部用户可查看的文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">	$rName = $_GET[&#x27;publicReport&#x27;];</span><br><span class="line"></span><br><span class="line">	chmod(&quot;/home/&quot;. authenticateUser . &quot;/public_html/&quot; . rName,&quot;0755&quot;);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>但是，如果攻击者为 publicReport 提供恶意值（例如，../../localuser/public_html/.htpasswd），那么应用程序将允许攻击者读取指定文件。</p>
<p>示例 2：以下代码使用来自配置文件的输入来设置默认权限掩码。如果攻击者可以篡改配置文件，则他们可以使用该程序获得该程序所处理文件的访问权限。如果程序还容易受路径篡改攻击，那么攻击者可能会利用这一漏洞访问系统中的任意文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$mask = $CONFIG_TXT[&#x27;perms&#x27;];</span><br><span class="line"></span><br><span class="line">chmod($filename,$mask);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-71"><a href="#RECOMMENDATIONS-71" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>避免出现 file permission manipulation 的最佳方法是采用间接级：创建一份用户可以指定的合法资源名和文件权限的列表，并且规定用户只能从该列表中进行选择。通过这种方法，用户就不能直接由自己来指定资源的名称了。 </p>
<p>但在某些情况下，这种方法并不可行，因为这样一份合法资源名的列表过于庞大、难以跟踪。因此，程序员通常在这种情况下采用黑名单的办法。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。但是，任何这样一份黑名单都不可能是完整的，而且将随着时间的推移而过时。更好的方法是创建一份白名单，其中包括允许出现在资源名称和有效权限中的字符，且只接受由这些认可的字符所组成的输入。</p>
<h5 id="REFERENCES-72"><a href="#REFERENCES-72" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] G. Hoglund, G. McGraw Exploiting Software Addison-Wesley</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 264, CWE ID 732 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [15] CWE ID 732 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000213, CCI-002165 </p>
<p>[5] Standards Mapping - FIPS200 AC </p>
<p>[6] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 4.1.3 General Access Control Design, 4.1.5 General Access Control Design, 4.2.1 Operation Level Access Control, 4.3.3 Other Access Control Considerations, 7.3.3 Log Protection Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A2 Broken Access Control </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.2 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[18] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[19] Standards Mapping - SANS Top 25 2009 Porous Defenses - CWE ID 732 </p>
<p>[20] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 732 </p>
<p>[21] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 732 </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II </p>
<p>[32] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="Insecure-Randomness"><a href="#Insecure-Randomness" class="headerlink" title="Insecure Randomness"></a>Insecure Randomness</h4><h5 id="ABSTRACT-73"><a href="#ABSTRACT-73" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>标准的伪随机数值生成器不能抵挡各种加密攻击。</p>
<h5 id="EXPLANATION-73"><a href="#EXPLANATION-73" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在对安全性要求较高的环境中，使用能够生成可预测值的函数作为随机数据源，会产生 Insecure Randomness 错误。</p>
<p>电脑是一种具有确定性的机器，因此不可能产生真正的随机性。伪随机数生成器 (PRNG) 近似于随机算法，始于一个能计算后续数值的种子。</p>
<p>PRNG 包括两种类型：统计学的 PRNG 和密码学的 PRNG。统计学的 PRNG 提供很多有用的统计属性，但其输出结果很容易预测，因此容易复制数值流。在安全性所依赖的生成值不可预测的情况下，这种类型并不适用。密码学的 PRNG 生成的输出结果较难预测，可解决这一问题。为保证值的加密安全性，必须使攻击者根本无法、或几乎不可能鉴别生成的随机值和真正的随机值。通常情况下，如果并未声明 PRNG 算法带有加密保护，那么它很可能就是统计学的 PRNG，因此不应在对安全性要求较高的环境中使用，否则会导致严重的漏洞（如易于猜测的密码、可预测的加密密钥、Session Hijacking 和 DNS Spoofing）。</p>
<p>示例： 下面的代码可利用统计学的 PRNG 为购买产品后仍在有效期内的收据创建一个 URL。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function genReceiptURL($baseURL) &#123;</span><br><span class="line"></span><br><span class="line">  $randNum = rand();</span><br><span class="line"></span><br><span class="line">  $receiptURL = $baseURL . $randNum . &quot;.html&quot;;</span><br><span class="line"></span><br><span class="line">  return $receiptURL;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这段代码使用 rand() 函数为它生成的收据页面生成“唯一”的标识符。由于 rand() 是统计学的 PRNG，攻击者很容易猜到其生成的字符串。尽管收据系统的底层设计并不完善，但若使用不会生成可预测收据标识符的随机数生成器（如密码学的 PRNG），就会更安全些。</p>
<h5 id="RECOMMENDATIONS-72"><a href="#RECOMMENDATIONS-72" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>当不可预测性至关重要时，如大多数对安全性要求较高的环境都采用随机性，这时可以使用密码学的 PRNG。不管选择了哪一种 PRNG，都要始终使用带有充足熵的数值作为该算法的种子。（切勿使用诸如当前时间之类的数值，因为它们只提供很小的熵。）</p>
<h5 id="REFERENCES-73"><a href="#REFERENCES-73" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] J. Viega, G. McGraw Building Secure Software Addison-Wesley</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 338 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002450 </p>
<p>[4] Standards Mapping - FIPS200 MP </p>
<p>[5] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-13 Cryptographic Protection (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.3.1 Authenticator Lifecycle Requirements, 2.6.2 Look-up Secret Verifier Requirements, 3.2.2 Session Binding Requirements, 3.2.4 Session Binding Requirements, 6.3.1 Random Values, 6.3.2 Random Values, 6.3.3 Random Values </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M6 Broken Cryptography </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.3 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.3 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.3 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.3 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.3 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.3 - Use of Cryptography </p>
<p>[20] Standards Mapping - SANS Top 25 2009 Porous Defenses - CWE ID 330 </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3150.2 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3150.2 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3150.2 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3150.2 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3150.2 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3150.2 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3150.2 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002010 CAT II, APSC-DV-002050 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002010 CAT II, APSC-DV-002050 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002010 CAT II, APSC-DV-002050 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002010 CAT II, APSC-DV-002050 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002010 CAT II, APSC-DV-002050 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002010 CAT II, APSC-DV-002050 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002010 CAT II, APSC-DV-002050 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002010 CAT II, APSC-DV-002050 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002010 CAT II, APSC-DV-002050 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002010 CAT II, APSC-DV-002050 CAT II </p>
<h4 id="Insecure-Transport"><a href="#Insecure-Transport" class="headerlink" title="Insecure Transport"></a>Insecure Transport</h4><h5 id="ABSTRACT-74"><a href="#ABSTRACT-74" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>调用使用 HTTP（而非 HTTPS）协议将数据发送到服务器。</p>
<h5 id="EXPLANATION-74"><a href="#EXPLANATION-74" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>所有数据均通过 HTTP 以明文形式发送，容易受到攻击。</p>
<p>例 1：以下示例通过 HTTP 协议（而不是 HTTPS 协议）发送数据。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$client = new Zend_Http_Client(&#x27;http://www.example.com/fetchdata.php&#x27;);</span><br><span class="line"></span><br><span class="line">$client-&gt;request(Zend_Http_Client::POST);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-73"><a href="#RECOMMENDATIONS-73" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用 HTTPS 将数据发送至服务器。</p>
<p>例 2：以下示例通过 HTTPS 协议（而不是 HTTP 协议）发送数据。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$client = new Zend_Http_Client(&#x27;https://www.example.com/fetchdata.php&#x27;);</span><br><span class="line"></span><br><span class="line">$client-&gt;request(Zend_Http_Client::POST);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-74"><a href="#REFERENCES-74" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Top 10 2007-Insecure Communications OWASP</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 319 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000068, CCI-001453, CCI-002418, CCI-002420, CCI-002421, CCI-002422, CCI-002890, CCI-003123 </p>
<p>[4] Standards Mapping - FIPS200 SC </p>
<p>[5] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.9.1 Communications Architectural Requirements, 1.14.1 Configuration Architectural Requirements, 2.2.5 General Authenticator Requirements, 2.6.3 Look-up Secret Verifier Requirements, 2.8.3 Single or Multi Factor One Time Verifier Requirements, 2.7.1 Out of Band Verifier Requirements, 2.7.2 Out of Band Verifier Requirements, 2.7.3 Out of Band Verifier Requirements, 2.8.4 Single or Multi Factor One Time Verifier Requirements, 2.8.5 Single or Multi Factor One Time Verifier Requirements, 2.9.3 Cryptographic Software and Devices Verifier Requirements, 3.7.1 Defenses Against Session Management Exploits, 6.2.1 Algorithms, 6.2.2 Algorithms, 6.2.3 Algorithms, 6.2.4 Algorithms, 6.2.5 Algorithms, 6.2.6 Algorithms, 6.2.7 Algorithms, 8.1.6 General Data Protection, 8.3.1 Sensitive Private Data, 8.3.4 Sensitive Private Data, 8.3.7 Sensitive Private Data, 9.1.1 Communications Security Requirements, 9.1.2 Communications Security Requirements, 9.1.3 Communications Security Requirements, 9.2.1 Server Communications Security Requirements, 9.2.2 Server Communications Security Requirements, 9.2.3 Server Communications Security Requirements, 14.1.3 Build, 14.4.5 HTTP Security Headers Requirements </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 4.1, Requirement 6.5.4 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 6.2 - Sensitive Data Protection, Control Objective 7 - Use of Cryptography </p>
<p>[22] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 319 </p>
<p>[23] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311 </p>
<p>[24] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311 </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260.1 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[42] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[43] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04) </p>
<h4 id="Key-Management-Empty-Encryption-Key"><a href="#Key-Management-Empty-Encryption-Key" class="headerlink" title="Key Management: Empty Encryption Key"></a>Key Management: Empty Encryption Key</h4><h5 id="ABSTRACT-75"><a href="#ABSTRACT-75" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>空加密密钥可能会削弱安全性，一旦出现安全问题将无法轻易修正。</p>
<h5 id="EXPLANATION-75"><a href="#EXPLANATION-75" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用空加密密钥绝非好方法。这不仅是因为使用空加密密钥会大幅减弱由良好的加密算法提供的保护，而且还会使解决这一问题变得极其困难。在问题代码投入使用之后，除非对软件进行修补，否则将无法更改空加密密钥。如果受空加密密钥保护的帐户遭受入侵，系统所有者将必须在安全性和可用性之间做出选择。</p>
<p>示例：以下代码会将加密密钥变量初始化为空字符串。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$encryption_key = &#x27;&#x27;;</span><br><span class="line"></span><br><span class="line">$filter = new Zend_Filter_Encrypt($encryption_key);</span><br><span class="line"></span><br><span class="line">$filter-&gt;setVector(&#x27;myIV&#x27;);</span><br><span class="line"></span><br><span class="line">$encrypted = $filter-&gt;filter(&#x27;text_to_be_encrypted&#x27;);</span><br><span class="line"></span><br><span class="line">print $encrypted;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>不仅任何可以访问此代码的人可以确定它使用的是空加密密钥，而且任何掌握最基本破解技术的人都更有可能成功解密所有加密数据。一旦程序发布，要更改空加密密钥，就必须进行软件修补。雇员可以利用手中掌握的信息访问权限入侵系统。即使攻击者只能访问应用程序的可执行文件，他们也可以提取使用了空加密密钥的证据。</p>
<h5 id="RECOMMENDATIONS-74"><a href="#RECOMMENDATIONS-74" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>加密密钥绝不能为空。通常情况下，应对加密密钥加以模糊化，并在外部资源文件中进行管理。如果在系统中采用明文的形式存储加密密钥（空或非空），任何有足够权限的人即可读取加密密钥，还可能误用这些加密密钥。</p>
<p>从 Microsoft(R) Windows(R) 2000 开始，Microsoft(R) 提供 Windows Data Protection Application Programming Interface (DPAPI)，这是一个操作系统层级的服务，用以保护敏感的应用程序数据，如密码或者私人密钥 [1]。</p>
<h5 id="REFERENCES-75"><a href="#REFERENCES-75" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Windows Data Protection Microsoft</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 321 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [13] CWE ID 287, [19] CWE ID 798 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002450 </p>
<p>[5] Standards Mapping - FIPS200 IA </p>
<p>[6] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-12 Cryptographic Key Establishment and Management (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.6.3 Look-up Secret Verifier Requirements, 2.7.1 Out of Band Verifier Requirements, 2.7.2 Out of Band Verifier Requirements, 2.7.3 Out of Band Verifier Requirements, 2.8.4 Single or Multi Factor One Time Verifier Requirements, 2.8.5 Single or Multi Factor One Time Verifier Requirements, 2.9.1 Cryptographic Software and Devices Verifier Requirements, 2.10.2 Service Authentication Requirements, 2.10.4 Service Authentication Requirements, 3.5.2 Token-based Session Management, 3.7.1 Defenses Against Session Management Exploits, 6.2.1 Algorithms, 6.4.1 Secret Management, 6.4.2 Secret Management, 9.2.3 Server Communications Security Requirements, 10.2.3 Malicious Code Search </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M6 Broken Cryptography </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8, Requirement 8.4 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.4 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.2 - Use of Cryptography </p>
<p>[23] Standards Mapping - SANS Top 25 2009 Porous Defenses - CWE ID 259 </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002010 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002010 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002010 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002010 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002010 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002010 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002010 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002010 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002010 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002010 CAT II </p>
<p>[41] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Key-Management-Hardcoded-Encryption-Key"><a href="#Key-Management-Hardcoded-Encryption-Key" class="headerlink" title="Key Management: Hardcoded Encryption Key"></a>Key Management: Hardcoded Encryption Key</h4><h5 id="ABSTRACT-76"><a href="#ABSTRACT-76" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Hardcoded 加密密钥可能会削弱系统安全性，一旦出现安全问题将无法轻易修正。</p>
<h5 id="EXPLANATION-76"><a href="#EXPLANATION-76" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用硬编码方式处理加密密钥绝非好方法。这不仅是因为所有项目开发人员都可以使用通过硬编码方式处理的加密密钥，而且还会使解决这一问题变得极其困难。在代码投入使用之后，必须对软件进行修补才能更改加密密钥。如果受加密密钥保护的帐户遭受入侵，系统所有者将必须在安全性和可用性之间做出选择。</p>
<p>示例：下列代码使用 hardcoded 加密密钥来加密信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$encryption_key = &#x27;hardcoded_encryption_key&#x27;;</span><br><span class="line"></span><br><span class="line">//$filter = new Zend_Filter_Encrypt(&#x27;hardcoded_encryption_key&#x27;);</span><br><span class="line"></span><br><span class="line">$filter = new Zend_Filter_Encrypt($encryption_key);</span><br><span class="line"></span><br><span class="line">$filter-&gt;setVector(&#x27;myIV&#x27;);</span><br><span class="line"></span><br><span class="line">$encrypted = $filter-&gt;filter(&#x27;text_to_be_encrypted&#x27;);</span><br><span class="line"></span><br><span class="line">print $encrypted;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>此代码将成功运行，但任何有权访问此代码的人都可以获得加密密钥。一旦程序发布，除非修补该程序，否则可能无法更改硬编码的加密密钥（“hardcoded_encryption_key”）。心怀不轨的雇员可以利用其对此信息的访问权限来破坏系统加密的数据。</p>
<h5 id="RECOMMENDATIONS-75"><a href="#RECOMMENDATIONS-75" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>绝不能对加密密钥进行硬编码。通常情况下，应对加密密钥加以模糊化，并在外部资源文件中进行管理。如果在系统中采用明文的形式存储加密密钥，任何有足够权限的人即可读取加密密钥，还可能误用这些密码。</p>
<h5 id="REFERENCES-76"><a href="#REFERENCES-76" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 321 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [13] CWE ID 287, [19] CWE ID 798 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002450 </p>
<p>[4] Standards Mapping - FIPS200 IA </p>
<p>[5] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-12 Cryptographic Key Establishment and Management (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.6.3 Look-up Secret Verifier Requirements, 2.7.1 Out of Band Verifier Requirements, 2.7.2 Out of Band Verifier Requirements, 2.7.3 Out of Band Verifier Requirements, 2.8.4 Single or Multi Factor One Time Verifier Requirements, 2.8.5 Single or Multi Factor One Time Verifier Requirements, 2.9.1 Cryptographic Software and Devices Verifier Requirements, 2.10.2 Service Authentication Requirements, 2.10.4 Service Authentication Requirements, 3.5.2 Token-based Session Management, 3.7.1 Defenses Against Session Management Exploits, 6.2.1 Algorithms, 6.4.1 Secret Management, 6.4.2 Secret Management, 9.2.3 Server Communications Security Requirements, 10.2.3 Malicious Code Search </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M6 Broken Cryptography </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.2 - Use of Cryptography </p>
<p>[22] Standards Mapping - SANS Top 25 2009 Porous Defenses - CWE ID 259 </p>
<p>[23] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 798 </p>
<p>[24] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 798 </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002010 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002010 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002010 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002010 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002010 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002010 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002010 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002010 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002010 CAT II </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002010 CAT II </p>
<p>[42] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Key-Management-Hardcoded-PBE-Password"><a href="#Key-Management-Hardcoded-PBE-Password" class="headerlink" title="Key Management: Hardcoded PBE Password"></a>Key Management: Hardcoded PBE Password</h4><h5 id="ABSTRACT-77"><a href="#ABSTRACT-77" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果基于密码的密钥派生函数的密码参数收到一个 hardcoded 值，并使用该函数生成密钥，可能会削弱系统安全性，一旦出现安全问题将无法轻易修正。</p>
<h5 id="EXPLANATION-77"><a href="#EXPLANATION-77" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>将一个硬编码值作为密码参数传递到加密的且基于密码的密钥派生函数，这绝非好方法。在这种情况下，生成的派生密钥将基本上基于提供的 salt（使其强度显著减弱），且解决这一问题极其困难。在问题代码投入使用之后，除非对软件进行修补，否则将无法更改硬编码密码。如果受基于硬编码密码的派生密钥保护的帐户遭受入侵，系统所有者将不得不在安全性和可用性之间做出选择。</p>
<p>示例 1：下列代码会将一个硬编码值作为密码参数传递到基于加密密码的密钥派生函数中：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$hash = hash_pbkdf2(&#x27;sha256&#x27;, &#x27;password&#x27;, $salt, 100000);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>不仅有权访问该代码的任何人都可以确定它基于硬编码密码参数生成一个或多个加密密钥，而且掌握基本破解技术的任何人都更有可能成功访问受问题密钥保护的任何资源。此外，如果攻击者还有权访问用于基于硬编码密码生成任何密钥的 salt 值，则破解这些密钥就会变得微不足道。一旦程序发布，除非修补该程序，否则可能无法更改硬编码密码。雇员可以利用手中掌握的信息访问权限入侵系统。即使攻击者只能访问应用程序的可执行文件，他们也可以提取使用硬编码密码的证据。</p>
<h5 id="RECOMMENDATIONS-76"><a href="#RECOMMENDATIONS-76" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>绝对不应将基于密码的密钥派生函数用来生成基于 hardcoded password 的加密密钥。这样做会导致在密码（即使密码强度高）被发现后显著降低生成的派生密钥的强度，因此应该加以避免。</p>
<h5 id="REFERENCES-77"><a href="#REFERENCES-77" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 321 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [13] CWE ID 287, [19] CWE ID 798 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002450 </p>
<p>[4] Standards Mapping - FIPS200 IA </p>
<p>[5] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-12 Cryptographic Key Establishment and Management (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.6.3 Look-up Secret Verifier Requirements, 2.7.1 Out of Band Verifier Requirements, 2.7.2 Out of Band Verifier Requirements, 2.7.3 Out of Band Verifier Requirements, 2.8.4 Single or Multi Factor One Time Verifier Requirements, 2.8.5 Single or Multi Factor One Time Verifier Requirements, 2.9.1 Cryptographic Software and Devices Verifier Requirements, 2.10.2 Service Authentication Requirements, 2.10.4 Service Authentication Requirements, 3.5.2 Token-based Session Management, 3.7.1 Defenses Against Session Management Exploits, 6.2.1 Algorithms, 6.4.1 Secret Management, 6.4.2 Secret Management, 9.2.3 Server Communications Security Requirements, 10.2.3 Malicious Code Search </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M6 Broken Cryptography </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.2 - Use of Cryptography </p>
<p>[22] Standards Mapping - SANS Top 25 2009 Porous Defenses - CWE ID 259 </p>
<p>[23] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 798 </p>
<p>[24] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 798 </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002010 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002010 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002010 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002010 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002010 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002010 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002010 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002010 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002010 CAT II </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002010 CAT II </p>
<p>[42] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Key-Management-Null-Encryption-Key"><a href="#Key-Management-Null-Encryption-Key" class="headerlink" title="Key Management: Null Encryption Key"></a>Key Management: Null Encryption Key</h4><h5 id="ABSTRACT-78"><a href="#ABSTRACT-78" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>null 加密密钥可能会削弱安全性，一旦出现安全问题将无法轻易修正。</p>
<h5 id="EXPLANATION-78"><a href="#EXPLANATION-78" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>最好不要为加密密钥变量指定 null，因为它可以使攻击者公开敏感和加密信息。使用 null 加密密钥不仅会大幅减弱由优质加密算法提供的保护强度，还会使解决这一问题变得极其困难。一旦问题代码投入使用，要更改 null 加密密钥，就必须进行软件修补。如果受 null 加密密钥保护的帐户遭受入侵，系统所有者就必须在安全性和可用性之间做出选择。</p>
<p>示例：以下代码会将加密密钥变量初始化为 null。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$encryption_key = NULL;</span><br><span class="line"></span><br><span class="line">$filter = new Zend_Filter_Encrypt($encryption_key);</span><br><span class="line"></span><br><span class="line">$filter-&gt;setVector(&#x27;myIV&#x27;);</span><br><span class="line"></span><br><span class="line">$encrypted = $filter-&gt;filter(&#x27;text_to_be_encrypted&#x27;);</span><br><span class="line"></span><br><span class="line">print $encrypted;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>任何可访问该代码的人都能够确定它使用的是 null 加密密钥，并且任何掌握基本破解技术的人都更有可能成功解密任何加密数据。一旦程序发布，要更改 null 加密密钥，就必须进行软件修补。雇员可以利用手中掌握的信息访问权限入侵系统。即使攻击者只能访问应用程序的可执行文件，他们也可以提取使用了 null 加密密钥的证据。</p>
<h5 id="RECOMMENDATIONS-77"><a href="#RECOMMENDATIONS-77" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>加密密钥绝不能为 null，而通常应对其加以模糊化，并在外部源中进行管理。在系统中的任何位置采用明文的形式存储加密密钥（null 或非 null），会造成任何有足够权限的人均可读取和无意中误用此加密密钥。</p>
<p>从 Microsoft(R) Windows(R) 2000 开始，Microsoft(R) 提供 Windows Data Protection Application Programming Interface (DPAPI)，这是一个操作系统层级的服务，用以保护敏感的应用程序数据，如密码和加密密钥 [1]。</p>
<h5 id="REFERENCES-78"><a href="#REFERENCES-78" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Windows Data Protection Microsoft</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 321 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [13] CWE ID 287, [19] CWE ID 798 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002450 </p>
<p>[5] Standards Mapping - FIPS200 IA </p>
<p>[6] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-12 Cryptographic Key Establishment and Management (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.6.3 Look-up Secret Verifier Requirements, 2.7.1 Out of Band Verifier Requirements, 2.7.2 Out of Band Verifier Requirements, 2.7.3 Out of Band Verifier Requirements, 2.8.4 Single or Multi Factor One Time Verifier Requirements, 2.8.5 Single or Multi Factor One Time Verifier Requirements, 2.9.1 Cryptographic Software and Devices Verifier Requirements, 2.10.2 Service Authentication Requirements, 2.10.4 Service Authentication Requirements, 3.5.2 Token-based Session Management, 3.7.1 Defenses Against Session Management Exploits, 6.2.1 Algorithms, 6.4.1 Secret Management, 6.4.2 Secret Management, 9.2.3 Server Communications Security Requirements, 10.2.3 Malicious Code Search </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M6 Broken Cryptography </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8, Requirement 8.4 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.4 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.2 - Use of Cryptography </p>
<p>[23] Standards Mapping - SANS Top 25 2009 Porous Defenses - CWE ID 259 </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002010 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002010 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002010 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002010 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002010 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002010 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002010 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002010 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002010 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002010 CAT II </p>
<p>[41] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Password-Management"><a href="#Password-Management" class="headerlink" title="Password Management"></a>Password Management</h4><h5 id="ABSTRACT-79"><a href="#ABSTRACT-79" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>采用明文的形式存储密码会危及系统安全。</p>
<h5 id="EXPLANATION-79"><a href="#EXPLANATION-79" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当密码以明文形式存储在应用程序的属性文件或其他配置文件中时，会发生 password management 漏洞。 </p>
<p>示例：以下代码可以从属性文件中读取密码，并使用该密码连接到数据库。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$props = file(&#x27;config.properties&#x27;, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);</span><br><span class="line"></span><br><span class="line">$password = $props[0];</span><br><span class="line"></span><br><span class="line">$link = mysql_connect($url, $usr, $password);</span><br><span class="line"></span><br><span class="line">if (!$link) &#123;</span><br><span class="line"></span><br><span class="line">    die(&#x27;Could not connect: &#x27; . mysql_error());</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>该代码可以正常运行，但是任何对 config.properties 具有访问权限的人都能读取 password的值。任何心怀不轨的雇员可以利用手中掌握的信息访问权限入侵系统。</p>
<h5 id="RECOMMENDATIONS-78"><a href="#RECOMMENDATIONS-78" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>绝不能采用明文的形式存储密码。应由管理员在系统启动时输入密码。如果这种方法不切实际，一个安全性较差、但通常都比较恰当的解决办法是将密码模糊化，并把这些去模糊化的资源分散到系统各处，因此，要破译密码，攻击者就必须取得并正确合并多个系统资源。</p>
<p>有些第三方产品宣称可以采用更加安全的方式管理密码。例如，WebSphere Application Server 4.x 用简单的异或加密算法加密数值，但是请不要对诸如此类的加密方式给予完全的信任。WebSphere 以及其他一些应用服务器通常都只提供过期的且相对较弱的加密机制，这对于安全性敏感的环境来说是远远不够的。安全的做法来是采用由用户创建的所有者机制，而这似乎也是目前唯一可行的方法。</p>
<h5 id="REFERENCES-79"><a href="#REFERENCES-79" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 256 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [13] CWE ID 287 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000196, CCI-001199 </p>
<p>[4] Standards Mapping - FIPS200 IA </p>
<p>[5] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.1.1 Password Security Requirements, 2.1.2 Password Security Requirements, 2.1.3 Password Security Requirements, 2.1.4 Password Security Requirements, 2.1.7 Password Security Requirements, 2.1.8 Password Security Requirements, 2.1.9 Password Security Requirements, 2.7.5 Out of Band Verifier Requirements, 2.10.3 Service Authentication Requirements, 2.10.4 Service Authentication Requirements, 2.1.1 Password Security Requirements, 2.1.2 Password Security Requirements, 2.1.3 Password Security Requirements, 2.1.4 Password Security Requirements, 2.1.7 Password Security Requirements, 2.1.8 Password Security Requirements, 2.1.9 Password Security Requirements, 2.3.1 Authenticator Lifecycle Requirements, 2.6.2 Look-up Secret Verifier Requirements, 2.6.3 Look-up Secret Verifier Requirements, 2.7.1 Out of Band Verifier Requirements, 2.7.2 Out of Band Verifier Requirements, 2.7.3 Out of Band Verifier Requirements, 2.8.3 Single or Multi Factor One Time Verifier Requirements, 2.8.4 Single or Multi Factor One Time Verifier Requirements, 2.8.5 Single or Multi Factor One Time Verifier Requirements, 2.10.1 Service Authentication Requirements, 2.10.2 Service Authentication Requirements, 2.10.3 Service Authentication Requirements, 2.10.4 Service Authentication Requirements, 3.5.2 Token-based Session Management, 3.5.2 Token-based Session Management, 3.7.1 Defenses Against Session Management Exploits, 6.4.1 Secret Management, 6.2.1 Algorithms, 6.2.3 Algorithms, 6.2.4 Algorithms, 6.2.5 Algorithms, 6.2.6 Algorithms, 6.4.1 Secret Management, 8.2.2 Client-side Data Protection, 8.3.4 Sensitive Private Data, 9.1.2 Communications Security Requirements, 9.1.3 Communications Security Requirements, 9.2.3 Server Communications Security Requirements, 10.2.1 Malicious Code Search, 10.2.3 Malicious Code Search, 14.1.3 Build </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.3 - Authentication and Access Control, Control Objective 7 - Use of Cryptography </p>
<p>[22] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311 </p>
<p>[23] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311 </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<h4 id="Password-Management-Empty-Password"><a href="#Password-Management-Empty-Password" class="headerlink" title="Password Management: Empty Password"></a>Password Management: Empty Password</h4><h5 id="ABSTRACT-80"><a href="#ABSTRACT-80" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Empty password 可能会危及系统安全，并且无法轻易修正出现的安全问题。</p>
<h5 id="EXPLANATION-80"><a href="#EXPLANATION-80" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>为密码变量指定空字符串绝非一个好方法。如果使用 empty password 成功通过其他系统的验证，那么相应帐户的安全性很可能会被减弱，原因是其接受了 empty password。如果在为变量指定一个合法的值之前，empty password 仅仅是一个占位符，那么它将给任何不熟悉代码的人造成困惑，而且还可能导致出现意外控制流路径方面的问题。</p>
<p>示例：以下代码尝试使用空密码连接到数据库。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    $connection = mysql_connect($host, &#x27;scott&#x27;, &#x27;&#x27;);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>如果此示例中的代码成功执行，则表明数据库用户帐户“scott”配置有一个空密码，攻击者可以轻松地猜测到该密码。一旦程序发布，要更新此帐户以使用非空密码，就需要对代码进行更改。</p>
<h5 id="RECOMMENDATIONS-79"><a href="#RECOMMENDATIONS-79" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>始终从加密的外部资源读取存储的密码值，并为密码变量指定有意义的值。确保从不使用空密码或 null 密码来保护敏感资源。</p>
<p>从 Microsoft(R) Windows(R) 2000 开始，Microsoft(R) 提供 Windows Data Protection Application Programming Interface (DPAPI)，这是一个操作系统层级的服务，用以保护敏感的应用程序数据，如密码或者私人密钥 [1]。</p>
<h5 id="REFERENCES-80"><a href="#REFERENCES-80" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Windows Data Protection Microsoft</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 259 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [13] CWE ID 287, [19] CWE ID 798 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000196, CCI-001199, CCI-003109 </p>
<p>[5] Standards Mapping - FIPS200 IA </p>
<p>[6] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.1.1 Password Security Requirements, 2.1.2 Password Security Requirements, 2.1.3 Password Security Requirements, 2.1.4 Password Security Requirements, 2.1.7 Password Security Requirements, 2.1.8 Password Security Requirements, 2.1.9 Password Security Requirements, 2.3.1 Authenticator Lifecycle Requirements, 2.6.2 Look-up Secret Verifier Requirements, 2.7.1 Out of Band Verifier Requirements, 2.7.2 Out of Band Verifier Requirements, 2.7.3 Out of Band Verifier Requirements, 2.8.4 Single or Multi Factor One Time Verifier Requirements, 2.8.5 Single or Multi Factor One Time Verifier Requirements, 2.10.1 Service Authentication Requirements, 2.10.2 Service Authentication Requirements, 2.10.4 Service Authentication Requirements, 3.5.2 Token-based Session Management, 3.7.1 Defenses Against Session Management Exploits, 6.4.1 Secret Management, 9.2.3 Server Communications Security Requirements, 10.2.3 Malicious Code Search </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8, Requirement 8.4 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.4 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.3 - Authentication and Access Control, Control Objective 6.3 - Sensitive Data Protection, Control Objective 7 - Use of Cryptography </p>
<p>[23] Standards Mapping - SANS Top 25 2009 Porous Defenses - CWE ID 259 </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[41] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication </p>
<p>[42] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authentication (WASC-01) </p>
<h4 id="Password-Management-Hardcoded-Password"><a href="#Password-Management-Hardcoded-Password" class="headerlink" title="Password Management: Hardcoded Password"></a>Password Management: Hardcoded Password</h4><h5 id="ABSTRACT-81"><a href="#ABSTRACT-81" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Hardcoded password 可能会削弱系统安全性，并且无法轻易修正出现的安全问题。</p>
<h5 id="EXPLANATION-81"><a href="#EXPLANATION-81" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用硬编码方式处理密码绝非好方法。这不仅是因为所有项目开发人员都可以使用通过硬编码方式处理的密码，而且还会使解决这一问题变得极其困难。在代码投入使用之后，除非对软件进行修补，否则将无法更改密码。如果受密码保护的帐户遭受入侵，系统所有者将必须在安全性和可用性之间做出选择。</p>
<p>示例：以下代码用 hardcoded password 来连接数据库：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$link = mysql_connect($url, &#x27;scott&#x27;, &#x27;tiger&#x27;);</span><br><span class="line"></span><br><span class="line">if (!$link) &#123;</span><br><span class="line"></span><br><span class="line">    die(&#x27;Could not connect: &#x27; . mysql_error());</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>该代码可以正常运行，但是有权访问该代码的任何人都能得到这个密码。一旦程序发布，除非修补该程序，否则可能无法更改数据库用户“scott”和密码“tiger”。雇员可以利用手中掌握的信息访问权限入侵系统。</p>
<h5 id="RECOMMENDATIONS-80"><a href="#RECOMMENDATIONS-80" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>绝不能对密码进行硬编码。通常情况下，应对密码加以模糊化，并在外部资源文件中进行管理。在系统中采用明文的形式存储密码，会造成任何有充分权限的人读取和无意中误用密码。</p>
<p>有些第三方产品宣称可以采用更加安全的方式管理密码。较为安全的解决方法来是采用由用户创建的所有者机制，而这似乎也是如今唯一可行的方法。</p>
<h5 id="REFERENCES-81"><a href="#REFERENCES-81" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 259, CWE ID 798 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [13] CWE ID 287, [19] CWE ID 798 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000196, CCI-001199, CCI-002367, CCI-003109 </p>
<p>[4] Standards Mapping - FIPS200 IA </p>
<p>[5] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.3.1 Authenticator Lifecycle Requirements, 2.6.2 Look-up Secret Verifier Requirements, 2.7.1 Out of Band Verifier Requirements, 2.7.2 Out of Band Verifier Requirements, 2.7.3 Out of Band Verifier Requirements, 2.8.4 Single or Multi Factor One Time Verifier Requirements, 2.8.5 Single or Multi Factor One Time Verifier Requirements, 2.10.1 Service Authentication Requirements, 2.10.2 Service Authentication Requirements, 2.10.4 Service Authentication Requirements, 3.5.2 Token-based Session Management, 3.5.2 Token-based Session Management, 3.7.1 Defenses Against Session Management Exploits, 6.4.1 Secret Management, 6.4.1 Secret Management, 9.2.3 Server Communications Security Requirements, 10.2.3 Malicious Code Search </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.3 - Authentication and Access Control, Control Objective 6.3 - Sensitive Data Protection, Control Objective 7 - Use of Cryptography </p>
<p>[22] Standards Mapping - SANS Top 25 2009 Porous Defenses - CWE ID 259 </p>
<p>[23] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 798 </p>
<p>[24] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 798 </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[42] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication </p>
<p>[43] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authentication (WASC-01) </p>
<h4 id="Password-Management-Null-Password"><a href="#Password-Management-Null-Password" class="headerlink" title="Password Management: Null Password"></a>Password Management: Null Password</h4><h5 id="ABSTRACT-82"><a href="#ABSTRACT-82" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Null password 会损害安全性。</p>
<h5 id="EXPLANATION-82"><a href="#EXPLANATION-82" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>最好不要为密码变量指定 null，因为这可能会使攻击者绕过密码验证，或是表明资源受空密码保护。</p>
<p>示例：以下代码可将密码变量初始化为 null，同时尝试在存储的值中读取密码，并将其与用户提供的值进行比较。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    $storedPassword = NULL;</span><br><span class="line"></span><br><span class="line">    if (($temp = getPassword()) != NULL) &#123;</span><br><span class="line"></span><br><span class="line">      $storedPassword = $temp;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if(strcmp($storedPassword,$userPassword) == 0) &#123;</span><br><span class="line"></span><br><span class="line">        // Access protected resources</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>如果readPassword()因数据库错误或其他问题而未能检索到存储的密码，则攻击者只需为userPassword提供一个null值，就能轻松绕过密码检查。</p>
<h5 id="RECOMMENDATIONS-81"><a href="#RECOMMENDATIONS-81" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>始终从加密的外部资源读取存储的密码值，并为密码变量指定有意义的值。确保从不使用空密码或 null 密码来保护敏感资源。</p>
<p>从 Microsoft(R) Windows(R) 2000 开始，Microsoft(R) 提供 Windows Data Protection Application Programming Interface (DPAPI)，这是一个操作系统层级的服务，用以保护敏感的应用程序数据，如密码或者私人密钥 [1]。</p>
<h5 id="REFERENCES-82"><a href="#REFERENCES-82" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Windows Data Protection Microsoft</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 259 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [13] CWE ID 287, [19] CWE ID 798 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000196, CCI-001199, CCI-003109 </p>
<p>[5] Standards Mapping - FIPS200 IA </p>
<p>[6] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.3.1 Authenticator Lifecycle Requirements, 2.6.2 Look-up Secret Verifier Requirements, 2.7.1 Out of Band Verifier Requirements, 2.7.2 Out of Band Verifier Requirements, 2.7.3 Out of Band Verifier Requirements, 2.8.4 Single or Multi Factor One Time Verifier Requirements, 2.8.5 Single or Multi Factor One Time Verifier Requirements, 2.10.1 Service Authentication Requirements, 2.10.2 Service Authentication Requirements, 2.10.4 Service Authentication Requirements, 3.5.2 Token-based Session Management, 3.7.1 Defenses Against Session Management Exploits, 6.4.1 Secret Management, 9.2.3 Server Communications Security Requirements, 10.2.3 Malicious Code Search </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8, Requirement 8.4 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.4 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 2.2 - Secure Defaults, Control Objective 5.3 - Authentication and Access Control, Control Objective 6.3 - Sensitive Data Protection, Control Objective 7 - Use of Cryptography </p>
<p>[23] Standards Mapping - SANS Top 25 2009 Porous Defenses - CWE ID 259 </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[41] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication </p>
<p>[42] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authentication (WASC-01) </p>
<h4 id="Password-Management-Password-in-Comment"><a href="#Password-Management-Password-in-Comment" class="headerlink" title="Password Management: Password in Comment"></a>Password Management: Password in Comment</h4><h5 id="ABSTRACT-83"><a href="#ABSTRACT-83" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>以明文形式在系统或系统代码中存储密码或密码详细信息可能会以无法轻松修复的方式危及系统安全。</p>
<h5 id="EXPLANATION-83"><a href="#EXPLANATION-83" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用硬编码方式处理密码绝非好方法。在注释中存储密码详细信息等同于对密码进行硬编码。这不仅会使所有项目开发人员都可以查看密码，而且还会使解决这一问题变得极其困难。在代码投入使用之后，密码便会外泄，除非对软件进行修补，否则将无法保护或更改密码。如果受密码保护的帐户遭受入侵，系统所有者将必须在安全性和可用性之间做出选择。</p>
<p>示例：以下注释指定连接到数据库的默认密码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">// Default username for database connection is &quot;scott&quot;</span><br><span class="line"></span><br><span class="line">// Default password for database connection is &quot;tiger&quot;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>该代码可以正常运行，但是有权访问该代码的任何人都能得到这个密码。一旦程序发布，除非修补该程序，否则可能无法更改数据库用户“scott”和密码“tiger”。雇员可以利用手中掌握的信息访问权限入侵系统。</p>
<h5 id="RECOMMENDATIONS-82"><a href="#RECOMMENDATIONS-82" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>绝不能对密码进行硬编码。通常情况下，应对密码加以模糊化，并在外部资源文件中进行管理。在系统中采用明文的形式存储密码，会造成任何有充分权限的人读取和无意中误用密码。</p>
<h5 id="REFERENCES-83"><a href="#REFERENCES-83" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 615 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000196, CCI-001199, CCI-002367 </p>
<p>[3] Standards Mapping - FIPS200 IA </p>
<p>[4] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[11] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8, Requirement 8.4 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 6.1 - Sensitive Data Protection, Control Objective 7 - Use of Cryptography </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I </p>
<p>[37] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[38] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Password-Management-Weak-Cryptography"><a href="#Password-Management-Weak-Cryptography" class="headerlink" title="Password Management: Weak Cryptography"></a>Password Management: Weak Cryptography</h4><h5 id="ABSTRACT-84"><a href="#ABSTRACT-84" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>采用普通的编码方式给密码加密并不能有效地保护密码。</p>
<h5 id="EXPLANATION-84"><a href="#EXPLANATION-84" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当密码以明文形式存储在应用程序的属性文件或其他配置文件中时，会发生 password management 漏洞。程序员试图通过编码函数来遮蔽密码，以修补 password management 漏洞，例如使用 64 位基址编码方式，但都不能起到充分保护密码的作用。</p>
<p>示例：以下代码可以从属性文件中读取密码，并使用该密码连接到数据库。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$props = file(&#x27;config.properties&#x27;, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);</span><br><span class="line"></span><br><span class="line">$password = base64_decode($props[0]);</span><br><span class="line"></span><br><span class="line">$link = mysql_connect($url, $usr, $password);</span><br><span class="line"></span><br><span class="line">if (!$link) &#123;</span><br><span class="line"></span><br><span class="line">    die(&#x27;Could not connect: &#x27; . mysql_error());</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>该代码可以正常运行，但是任何对 config.properties具有访问权限的人都能读取 password 的值，并且很容易确定这个值是否经过 64 位基址编码。任何心怀不轨的雇员可以利用手中掌握的信息访问权限入侵系统。</p>
<h5 id="RECOMMENDATIONS-83"><a href="#RECOMMENDATIONS-83" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>绝不能采用明文的形式存储密码。应由管理员在系统启动时输入密码。如果这种方法不切实际，一个安全性较差、但通常都比较恰当的解决办法是将密码模糊化，并把这些去模糊化的资源分散到系统各处，因此，要破译密码，攻击者就必须取得并正确合并多个系统资源。</p>
<p>有些第三方产品宣称可以采用更加安全的方式管理密码。较为安全的解决方法来是采用由用户创建的所有者机制，而这似乎也是如今唯一可行的方法。</p>
<h5 id="REFERENCES-84"><a href="#REFERENCES-84" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 261 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [13] CWE ID 287 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000196, CCI-001199 </p>
<p>[4] Standards Mapping - FIPS200 IA </p>
<p>[5] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.6.3 Look-up Secret Verifier Requirements, 2.7.1 Out of Band Verifier Requirements, 2.7.2 Out of Band Verifier Requirements, 2.7.3 Out of Band Verifier Requirements, 2.8.3 Single or Multi Factor One Time Verifier Requirements, 2.8.4 Single or Multi Factor One Time Verifier Requirements, 2.8.5 Single or Multi Factor One Time Verifier Requirements, 2.10.1 Service Authentication Requirements, 2.10.2 Service Authentication Requirements, 3.7.1 Defenses Against Session Management Exploits, 6.2.1 Algorithms, 6.2.3 Algorithms, 6.2.4 Algorithms, 6.2.5 Algorithms, 6.2.6 Algorithms, 9.1.2 Communications Security Requirements, 9.1.3 Communications Security Requirements, 9.2.3 Server Communications Security Requirements </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M6 Broken Cryptography </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7 - Use of Cryptography </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3150.1 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3150.1 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3150.1 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3150.1 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3150.1 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3150.1 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3150.1 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[39] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Privacy-Violation"><a href="#Privacy-Violation" class="headerlink" title="Privacy Violation"></a>Privacy Violation</h4><h5 id="ABSTRACT-85"><a href="#ABSTRACT-85" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>对机密信息（如客户密码或社会保障号码）处理不当会危及用户的个人隐私，这是一种非法行为。</p>
<h5 id="EXPLANATION-85"><a href="#EXPLANATION-85" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Privacy Violation 会在以下情况下发生：</p>
<ol>
<li><p>用户私人信息进入了程序。</p>
</li>
<li><p>数据被写到了一个外部介质，例如控制台、file system 或网络。</p>
</li>
</ol>
<p>示例 1：以下代码包含了一个日志记录语句，该语句通过在日志文件中存储记录信息跟踪添加到数据库中的各条记录信息。在存储的其他数值中，有一个是 getPassword() 函数的返回值，该函数会返回与该帐户关联且由用户提供的明文密码。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">  $pass = getPassword();</span><br><span class="line"></span><br><span class="line">  trigger_error($id . &quot;:&quot; . $pass . &quot;:&quot; . $type . &quot;:&quot; . $tstamp);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>Example 1 中的代码会将明文密码记录到应用程序的事件日志中。虽然许多开发人员认为事件日志是存储数据的安全位置，但这不是绝对的，特别是涉及到隐私问题时。</p>
<p>可以通过多种方式将私人数据输入到程序中：</p>
<p>— 以密码或个人信息的形式直接从用户处获取</p>
<p>— 由应用程序访问数据库或者其他数据存储形式</p>
<p>— 间接地从合作者或者第三方处获取</p>
<p>有时，某些数据并没有贴上私人数据标签，但在特定的上下文中也有可能成为私人信息。比如，通常认为学生的学号不是私人信息，因为学号中并没有明确而公开的信息用以定位特定学生的个人信息。但是，如果学校用学生的社会保障号码生成学号，那么这时学号应被视为私人信息。</p>
<p>安全和隐私似乎一直是一对矛盾。从安全的角度看，您应该记录所有重要的操作，以便日后可以鉴定那些非法的操作。然而，当其中牵涉到私人数据时，这种做法就存在一定风险了。</p>
<p>虽然私人数据处理不当的方式多种多样，但常见风险来自于盲目信任。程序员通常会信任运行程序的操作环境，因此认为将私人信息存放在文件系统、注册表或者其他本地控制的资源中是值得信任的。尽管已经限制了某些资源的访问权限，但仍无法保证所有访问这些资源的个体都是值得信任的。例如，2004 年，一个不道德的 AOL 员工将大约 9200 万个私有客户电子邮件地址卖给了一个通过垃圾邮件进行营销的境外赌博网站 [1]。</p>
<p>鉴于此类备受瞩目的信息盗取事件，私人信息的收集与管理正日益规范化。要求各个组织应根据其经营地点、所从事的业务类型及其处理的私人数据性质，遵守下列一个或若干个联邦和州的规定：</p>
<ul>
<li><p>Safe Harbor Privacy Framework [3]</p>
</li>
<li><p>Gramm-Leach Bliley Act (GLBA) [4]</p>
</li>
<li><p>Health Insurance Portability and Accountability Act (HIPAA) [5]</p>
</li>
<li><p>California SB-1386 [6]</p>
</li>
</ul>
<p>尽管制定了这些规范，Privacy Violation 漏洞仍时有发生。</p>
<h5 id="RECOMMENDATIONS-84"><a href="#RECOMMENDATIONS-84" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>当安全和隐私的需要发生矛盾时，通常应优先考虑隐私的需要。为满足这一要求，同时又保证信息安全的需要，应在退出程序前清除所有私人信息。</p>
<p>为加强隐私信息的管理，应不断改进保护内部隐私的原则，并严格地加以执行。这一原则应具体说明应用程序应该如何处理各种私人数据。在贵组织受到联邦或者州法律的制约时，应确保您的隐私保护原则尽量与这些法律法规保持一致。即使没有针对贵组织的相应法规，您也应当保护好客户的私人信息，以免失去客户的信任。</p>
<p>保护私人数据的最好做法就是最大程度地减少私人数据的暴露。不应允许应用程序、流程处理以及员工访问任何私人数据，除非是出于职责以内的工作需要。正如最小授权原则一样，不应该授予访问者超出其需求的权限，对私人数据的访问权限应严格限制在尽可能小的范围内。</p>
<h5 id="REFERENCES-85"><a href="#REFERENCES-85" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] J. Oates AOL man pleads guilty to selling 92m email addies The Register</p>
<p>[2] Privacy Initiatives U.S. Federal Trade Commission</p>
<p>[3] Safe Harbor Privacy Framework U.S. Department of Commerce</p>
<p>[4] Financial Privacy: The Gramm-Leach Bliley Act (GLBA) Federal Trade Commission</p>
<p>[5] Health Insurance Portability and Accountability Act (HIPAA) U.S. Department of Human Services</p>
<p>[6] California SB-1386 Government of the State of California</p>
<p>[7] M. Howard, D. LeBlanc Writing Secure Code, Second Edition Microsoft Press</p>
<p>[8] Standards Mapping - Common Weakness Enumeration CWE ID 359 </p>
<p>[9] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[10] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000169, CCI-000196, CCI-000197, CCI-001199, CCI-001312, CCI-001314 </p>
<p>[11] Standards Mapping - General Data Protection Regulation Privacy Violation </p>
<p>[12] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[13] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.2.1 General Authenticator Requirements, 2.6.3 Look-up Secret Verifier Requirements, 2.7.1 Out of Band Verifier Requirements, 2.7.2 Out of Band Verifier Requirements, 2.7.3 Out of Band Verifier Requirements, 2.8.4 Single or Multi Factor One Time Verifier Requirements, 2.8.5 Single or Multi Factor One Time Verifier Requirements, 2.10.2 Service Authentication Requirements, 2.10.3 Service Authentication Requirements, 3.7.1 Defenses Against Session Management Exploits, 6.2.1 Algorithms, 8.2.1 Client-side Data Protection, 8.2.2 Client-side Data Protection, 8.3.6 Sensitive Private Data, 8.1.1 General Data Protection, 8.1.2 General Data Protection, 8.3.4 Sensitive Private Data, 9.2.3 Server Communications Security Requirements, 10.2.1 Malicious Code Search, 14.3.3 Unintended Security Disclosure Requirements </p>
<p>[14] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[15] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[16] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[17] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 8.4 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.6, Requirement 8.4 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.4 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 8.2.1 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 8.2.1 </p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 8.2.1 </p>
<p>[24] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 8.2.1 </p>
<p>[25] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.3 - Sensitive Data Retention, Control Objective 6.1 - Sensitive Data Protection, Control Objective 7 - Use of Cryptography, Control Objective A.2.3 - Cardholder Data Protection </p>
<p>[26] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311 </p>
<p>[27] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311 </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3310 CAT I, APP3340 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000650 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I, APSC-DV-002330 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000650 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I, APSC-DV-002330 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000650 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I, APSC-DV-002330 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000650 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I, APSC-DV-002330 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000650 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I, APSC-DV-002330 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000650 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I, APSC-DV-002330 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000650 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I, APSC-DV-002330 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000650 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I, APSC-DV-002330 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[43] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000650 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I, APSC-DV-002330 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[44] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000650 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I, APSC-DV-002330 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[45] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[46] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Privacy-Violation-HTTP-GET"><a href="#Privacy-Violation-HTTP-GET" class="headerlink" title="Privacy Violation: HTTP GET"></a>Privacy Violation: HTTP GET</h4><h5 id="ABSTRACT-86"><a href="#ABSTRACT-86" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>标识调用使用 HTTP GET（而非 POST）方法将数据发送到服务器。</p>
<h5 id="EXPLANATION-86"><a href="#EXPLANATION-86" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用 GET 方法的 HTTP 请求允许将 URL 和请求参数缓存到浏览器的 URL 缓存、中间代理和服务器日志中。这可能将敏感信息泄露给不具备相应数据权限的人。</p>
<p>示例 1：以下代码使用 GET HTTP 方法而非 POST 来发送 HTTP 请求。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$client = new Zend_Http_Client(&#x27;https://www.example.com/fetchdata.php&#x27;);</span><br><span class="line"></span><br><span class="line">$client-&gt;request(Zend_Http_Client::GET);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-85"><a href="#RECOMMENDATIONS-85" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>结合使用 HTTP POST 方法和 HTTPS 将数据发送至服务器。这会限制请求中泄露给该 URL 的数据。应在 POST 正文中发送请求参数。敏感数据不应置于 URL 请求参数中，因为它们仍会在 HTTP POST 请求中泄露。</p>
<p>示例 2：以下代码按照建议使用 POST HTTP 方法来发出 HTTP 请求。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$client = new Zend_Http_Client(&#x27;https://www.example.com/fetchdata.php&#x27;);</span><br><span class="line"></span><br><span class="line">$client-&gt;request(Zend_Http_Client::POST);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-86"><a href="#REFERENCES-86" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] HTTPS Data Exposure - GET vs POST Michael Coates</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 359 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000196, CCI-000197, CCI-002361 </p>
<p>[5] Standards Mapping - General Data Protection Regulation Privacy Violation </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 8.2.2 Client-side Data Protection, 8.3.4 Sensitive Private Data, 10.2.1 Malicious Code Search </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[11] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 8.4 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.6, Requirement 8.4 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.3 - Sensitive Data Retention, Control Objective 6.1 - Sensitive Data Protection, Control Objective 7 - Use of Cryptography </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3310 CAT I, APP3340 CAT I </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000060 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000060 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000060 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000060 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000060 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000060 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000060 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000060 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000060 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000060 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I </p>
<p>[37] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[38] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Weak-Cryptographic-Hash"><a href="#Weak-Cryptographic-Hash" class="headerlink" title="Weak Cryptographic Hash"></a>Weak Cryptographic Hash</h4><h5 id="ABSTRACT-87"><a href="#ABSTRACT-87" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>弱加密散列值无法保证数据完整性，且不能在安全性关键的上下文中使用。</p>
<h5 id="EXPLANATION-87"><a href="#EXPLANATION-87" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>MD2、MD4、MD5、RIPEMD-160 和 SHA-1 是常用的加密散列算法，通常用于验证消息和其他数据的完整性。然而，由于最近的密码分析研究揭示了这些算法中存在的根本缺陷，因此它们不应该再用于安全性关键的上下文中。</p>
<p>由于有效破解 MD 和 RIPEMD 散列的技术已得到广泛使用，因此不应该依赖这些算法来保证安全性。对于 SHA-1，目前的破坏技术仍需要极高的计算能力，因此比较难以实现。然而，攻击者已发现了该算法的致命弱点，破坏它的技术可能会导致更快地发起攻击。</p>
<h5 id="RECOMMENDATIONS-86"><a href="#RECOMMENDATIONS-86" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>停止使用 MD2、MD4、MD5、RIPEMD-160 和 SHA-1 对安全性关键的上下文中的数据进行验证。目前，SHA-224、SHA-256、SHA-384、SHA-512 和 SHA-3 都是不错的备选方案。但是，由于安全散列算法 (Secure Hash Algorithm) 的这些变体并没有像 SHA-1 那样得到仔细研究，因此请留意可能影响这些算法安全性的未来研究结果。</p>
<h5 id="REFERENCES-87"><a href="#REFERENCES-87" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Xiaoyun Wang MD5 and MD4 Collision Generators </p>
<p>[2] Xiaoyun Wang, Yiqun Lisa Yin, and Hongbo Yu Finding Collisions in the Full SHA-1 </p>
<p>[3] Xiaoyun Wang and Hongbo Yu How to Break MD5 and Other Hash Functions </p>
<p>[4] SDL Development Practices Microsoft</p>
<p>[5] Standards Mapping - Common Weakness Enumeration CWE ID 328 </p>
<p>[6] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002450 </p>
<p>[7] Standards Mapping - FIPS200 MP </p>
<p>[8] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[9] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-13 Cryptographic Protection (P1) </p>
<p>[10] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.4.1 Credential Storage Requirements, 2.4.2 Credential Storage Requirements, 2.4.5 Credential Storage Requirements, 2.6.3 Look-up Secret Verifier Requirements, 2.8.3 Single or Multi Factor One Time Verifier Requirements, 2.9.3 Cryptographic Software and Devices Verifier Requirements, 6.2.1 Algorithms, 6.2.2 Algorithms, 6.2.3 Algorithms, 6.2.4 Algorithms, 6.2.5 Algorithms, 6.2.6 Algorithms, 6.2.7 Algorithms, 8.3.7 Sensitive Private Data, 9.1.2 Communications Security Requirements, 9.1.3 Communications Security Requirements </p>
<p>[11] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M6 Broken Cryptography </p>
<p>[12] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[13] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[14] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[15] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[16] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.3 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.3 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.3, Requirement 4.1 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.3, Requirement 4.1 </p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.3, Requirement 4.1 </p>
<p>[24] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.1 - Use of Cryptography, Control Objective 7.4 - Use of Cryptography </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3150.1 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3150.1 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3150.1 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3150.1 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3150.1 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3150.1 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3150.1 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<h4 id="Weak-Cryptographic-Hash-Empty-PBE-Salt"><a href="#Weak-Cryptographic-Hash-Empty-PBE-Salt" class="headerlink" title="Weak Cryptographic Hash: Empty PBE Salt"></a>Weak Cryptographic Hash: Empty PBE Salt</h4><h5 id="ABSTRACT-88"><a href="#ABSTRACT-88" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>空 salt 可能会削弱系统安全性，一旦出现安全问题将无法轻易修正。</p>
<h5 id="EXPLANATION-88"><a href="#EXPLANATION-88" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用空 salt 绝非好方法。这不仅是因为使用空 salt 让确定散列值变得十分容易，而且还会使解决这一问题变得极其困难。在代码投入使用之后，将无法轻易更改该 salt。如果攻击者知道散列值使用了空 salt，他们就可以计算出该应用程序的“彩虹表”，并更轻松地确定散列值。</p>
<p>示例 1：下列代码使用了空 salt：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$hash = hash_pbkdf2(&#x27;sha256&#x27;, $password, &#x27;&#x27;, 100000);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>此代码将成功运行，但任何有权访问此代码的人都可以访问（空）salt。一旦程序发布，可能无法更改空 salt。雇员可以利用手中掌握的信息访问权限入侵系统。</p>
<h5 id="RECOMMENDATIONS-87"><a href="#RECOMMENDATIONS-87" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>salt 始终不能为空。一般来说，应对密码加以模糊化，并在外部资源中进行管理。在系统中采用明文的形式存储 salt（空或非空），会造成任何有充分权限的人读取和无意中误用 salt。</p>
<p>示例 2：下列代码使用由系统管理员配置的 salt 变量：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$dk = hsdh_pbkdf2(&#x27;sha256&#x27;, $password, $salt, 100000);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-88"><a href="#REFERENCES-88" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 759 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002450 </p>
<p>[3] Standards Mapping - FIPS200 MP </p>
<p>[4] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-13 Cryptographic Protection (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.4.1 Credential Storage Requirements, 2.4.2 Credential Storage Requirements, 2.4.5 Credential Storage Requirements, 2.6.3 Look-up Secret Verifier Requirements, 2.9.3 Cryptographic Software and Devices Verifier Requirements, 6.2.1 Algorithms, 6.2.2 Algorithms, 8.3.7 Sensitive Private Data, 9.1.2 Communications Security Requirements, 9.1.3 Communications Security Requirements </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M6 Broken Cryptography </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.3 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.3 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.3 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.3 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.3 </p>
<p>[20] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.1 - Use of Cryptography, Control Objective 7.4 - Use of Cryptography </p>
<p>[21] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 759 </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3150.1 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3150.1 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3150.1 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3150.1 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3150.1 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3150.1 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3150.1 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<h4 id="Weak-Cryptographic-Hash-Hardcoded-PBE-Salt"><a href="#Weak-Cryptographic-Hash-Hardcoded-PBE-Salt" class="headerlink" title="Weak Cryptographic Hash: Hardcoded PBE Salt"></a>Weak Cryptographic Hash: Hardcoded PBE Salt</h4><h5 id="ABSTRACT-89"><a href="#ABSTRACT-89" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Hardcoded salt 可能会削弱系统安全性，一旦出现安全问题将无法轻易修正。</p>
<h5 id="EXPLANATION-89"><a href="#EXPLANATION-89" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用硬编码方式处理 salt 绝非好方法。这不仅是因为所有项目开发人员都可以使用通过硬编码方式处理的 salt，而且还会使解决这一问题变得极其困难。在代码投入使用之后，无法轻易更改该 salt。如果攻击者知道该 salt 的值，他们就可以计算出该应用程序的“彩虹表”，并更轻松地确定散列值。</p>
<p>示例 1：下列代码使用了 hardcoded salt：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$hash = hash_pbkdf2(&#x27;sha256&#x27;, $password, &#x27;2!@$(5#@532@%#$253l5#@$&#x27;, 100000)</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>此代码将成功运行，但有权访问此代码的任何人都可以访问 salt。一旦程序发布，可能无法更改名为<code>“2!@$(5#@532@%#$253l5#@$”</code>的 salt。雇员可以利用手中掌握的信息访问权限入侵系统。</p>
<h5 id="RECOMMENDATIONS-88"><a href="#RECOMMENDATIONS-88" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>绝不能对 salt 进行硬编码。通常情况下，应对 salt 加以模糊化，并在外部资源中进行管理。在系统中采用明文的形式存储 salt，会造成任何有充分权限的人读取和无意中误用 salt。</p>
<p>示例 2：下列代码使用由系统管理员配置的 salt 变量：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$hash = hash_pbkdf2(&#x27;sha256&#x27;, $password, $salt, 100000);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-89"><a href="#REFERENCES-89" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 760 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002450 </p>
<p>[3] Standards Mapping - FIPS200 MP </p>
<p>[4] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-13 Cryptographic Protection (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.4.1 Credential Storage Requirements, 2.4.2 Credential Storage Requirements, 2.4.5 Credential Storage Requirements, 2.6.3 Look-up Secret Verifier Requirements, 2.9.3 Cryptographic Software and Devices Verifier Requirements, 6.2.1 Algorithms, 6.2.2 Algorithms, 8.3.7 Sensitive Private Data, 9.1.2 Communications Security Requirements, 9.1.3 Communications Security Requirements </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M6 Broken Cryptography </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.3 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.3 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.3 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.3 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.3 </p>
<p>[20] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.1 - Use of Cryptography, Control Objective 7.4 - Use of Cryptography </p>
<p>[21] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 759 </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3150.1 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3150.1 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3150.1 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3150.1 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3150.1 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3150.1 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3150.1 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<h4 id="Weak-Cryptographic-Hash-Hardcoded-Salt"><a href="#Weak-Cryptographic-Hash-Hardcoded-Salt" class="headerlink" title="Weak Cryptographic Hash: Hardcoded Salt"></a>Weak Cryptographic Hash: Hardcoded Salt</h4><h5 id="ABSTRACT-90"><a href="#ABSTRACT-90" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Hardcoded salt 可能会削弱系统安全性，一旦出现安全问题将无法轻易修正。</p>
<h5 id="EXPLANATION-90"><a href="#EXPLANATION-90" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用硬编码方式处理 salt 绝非好方法。这不仅是因为所有项目开发人员都可以使用通过硬编码方式处理的 salt，而且还会使解决这一问题变得极其困难。在代码投入使用之后，无法轻易更改该 salt。如果攻击者知道该 salt 的值，他们就可以计算出该应用程序的“彩虹表”，并更轻松地确定散列值。</p>
<p>例 1：下列代码使用了 hardcoded salt：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">crypt($password, &#x27;2!@$(5#@532@%#$253l5#@$&#x27;);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>此代码将成功运行，但有权访问此代码的任何人都可以访问 salt。一旦程序发布，可能无法更改名为<code>“2!@$(5#@532@%#$253l5#@$”</code>的 salt。雇员可以利用手中掌握的信息访问权限入侵系统。</p>
<h5 id="RECOMMENDATIONS-89"><a href="#RECOMMENDATIONS-89" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>绝不能对 salt 进行硬编码。通常情况下，应对 salt 加以模糊化，并在外部资源中进行管理。在系统中采用明文的形式存储 salt，会造成任何有充分权限的人读取和无意中误用 salt。</p>
<p>例 2：下列代码使用由系统管理员配置的 salt 变量：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">crypt($password, $salt);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-90"><a href="#REFERENCES-90" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 760 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002450 </p>
<p>[3] Standards Mapping - FIPS200 MP </p>
<p>[4] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-13 Cryptographic Protection (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.4.1 Credential Storage Requirements, 2.4.2 Credential Storage Requirements, 2.4.5 Credential Storage Requirements, 2.6.3 Look-up Secret Verifier Requirements, 2.9.3 Cryptographic Software and Devices Verifier Requirements, 6.2.1 Algorithms, 6.2.2 Algorithms, 8.3.7 Sensitive Private Data, 9.1.2 Communications Security Requirements, 9.1.3 Communications Security Requirements </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M6 Broken Cryptography </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.3 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.3 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.3 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.3 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.3 </p>
<p>[20] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.1 - Use of Cryptography, Control Objective 7.4 - Use of Cryptography </p>
<p>[21] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 759 </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3150.1 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3150.1 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3150.1 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3150.1 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3150.1 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3150.1 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3150.1 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<h4 id="Weak-Cryptographic-Hash-Insecure-PBE-Iteration-Count"><a href="#Weak-Cryptographic-Hash-Insecure-PBE-Iteration-Count" class="headerlink" title="Weak Cryptographic Hash: Insecure PBE Iteration Count"></a>Weak Cryptographic Hash: Insecure PBE Iteration Count</h4><h5 id="ABSTRACT-91"><a href="#ABSTRACT-91" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>基于密码的密钥派生函数所使用的迭代计数过低。</p>
<h5 id="EXPLANATION-91"><a href="#EXPLANATION-91" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>密钥派生函数用来从基本密钥和其他参数派生出密钥。在基于密码的密钥派生函数中，基本密钥是一个密码，其他参数则是一个 salt 值和一个迭代计数。迭代计数传统上用于提高从一个密码生成密钥的代价。如果迭代次数过低，则攻击可行性将增加，因为攻击者能够计算应用程序的“彩虹表”，能更轻松地颠倒散列密码值。</p>
<p>示例 1：以下代码使用 50 的迭代计数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$hash = hash_pbkdf2(&#x27;sha256&#x27;, $password, $salt, 50);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>对于基于密码的加密，使用低迭代次数的应用程序容易遭受基于字典的简单攻击，其实就是基于密码的加密方案所针对的那种攻击。</p>
<h5 id="RECOMMENDATIONS-90"><a href="#RECOMMENDATIONS-90" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用一个基于密码的密钥派生函数时，迭代计数应至少为 1000，理想情况下为 100,000 或以上。迭代计数为 1000 将大幅增加穷尽式密码搜索的代价，而对派生各个密钥的代价不会产生显著影响。NIST SP 800-132 建议为关键密钥或非常强大的系统使用高达 10,000,000 的迭代计数。</p>
<p>当使用的迭代计数小于 1000 时，Fortify 安全编码规则将报告较严重的问题，当使用的迭代计数为 1000 到 100,000 之间时，将报告较低严重性的问题。如果源代码使用的迭代为 100,000 或以上，将不报告问题。</p>
<p>示例 2：以下代码使用 100,000 的迭代计数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$hash = hash_pbkdf2(&#x27;sha256&#x27;, $password, $salt, 100000);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-91"><a href="#REFERENCES-91" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] B. Kaliski PKCS #5: Password-Based Cryptography Specification Version 2.0. Network Working Group</p>
<p>[2] Martin Abadi and Bogdan Warinschi Password-Based Encryption Analyzed. </p>
<p>[3] Mihir Bellare, Thomas Ristenpart, and Stefano Tessaro Multi-Instance Security and its Application to Password-Based Cryptography. </p>
<p>[4] M. Egele, D. Brumley, Y. Fratantonio, and C. Kruegel An Empirical Study of Cryptographic Misuse in Android Applications. </p>
<p>[5] Meltem SonmezTuran, Elaine Barker, William Burr, and Lily Chen NIST Special Publication 800-132: Recommendation for Password-Based Key Derivation. NIST</p>
<p>[6] Standards Mapping - Common Weakness Enumeration CWE ID 916 </p>
<p>[7] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002450 </p>
<p>[8] Standards Mapping - FIPS200 MP </p>
<p>[9] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[10] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-13 Cryptographic Protection (P1) </p>
<p>[11] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.4.1 Credential Storage Requirements, 2.4.2 Credential Storage Requirements, 2.4.3 Credential Storage Requirements, 2.4.4 Credential Storage Requirements, 2.4.5 Credential Storage Requirements, 2.6.3 Look-up Secret Verifier Requirements, 2.9.3 Cryptographic Software and Devices Verifier Requirements, 6.2.1 Algorithms, 6.2.2 Algorithms, 8.3.7 Sensitive Private Data, 9.1.2 Communications Security Requirements, 9.1.3 Communications Security Requirements </p>
<p>[12] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M6 Broken Cryptography </p>
<p>[13] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[14] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[15] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[16] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[17] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.3 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.3 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.3 </p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.3 </p>
<p>[24] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.3 </p>
<p>[25] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.1 - Use of Cryptography, Control Objective 7.4 - Use of Cryptography </p>
<p>[26] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 759 </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3150.1 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3150.1 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3150.1 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3150.1 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3150.1 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3150.1 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3150.1 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[43] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<h4 id="Weak-Cryptographic-Hash-Predictable-Salt"><a href="#Weak-Cryptographic-Hash-Predictable-Salt" class="headerlink" title="Weak Cryptographic Hash: Predictable Salt"></a>Weak Cryptographic Hash: Predictable Salt</h4><h5 id="ABSTRACT-92"><a href="#ABSTRACT-92" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>salt 值应使用加密伪随机数值生成器来创建。</p>
<h5 id="EXPLANATION-92"><a href="#EXPLANATION-92" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>salt 值应使用加密伪随机数值生成器来创建。如果不使用随机 salt 值，则结果散列或 HMAC 的可预测性会高得多，也更容易受到字典式攻击。</p>
<p>示例 1：以下代码重新使用密码作为 salt：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function register()&#123;</span><br><span class="line"></span><br><span class="line">  $password = $_GET[&#x27;password&#x27;];</span><br><span class="line"></span><br><span class="line">  $username = $_GET[&#x27;username&#x27;];</span><br><span class="line"></span><br><span class="line">  $hash = hash_pbkdf2(&#x27;sha256&#x27;, $password, $password, 100000);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-91"><a href="#RECOMMENDATIONS-91" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将足够长度的 salt 值与适当的随机数据源中的字节结合使用。</p>
<p>示例 2：以下代码使用 random_bytes 创建足够随机的 salt 值：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">function get_random_salt()&#123;</span><br><span class="line"></span><br><span class="line">  return random_bytes(64);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">function register()&#123;</span><br><span class="line"></span><br><span class="line">  $password = $_GET[&#x27;password&#x27;];</span><br><span class="line"></span><br><span class="line">  $username = $_GET[&#x27;username&#x27;];</span><br><span class="line"></span><br><span class="line">  $salt = get_random_salt();</span><br><span class="line"></span><br><span class="line">  $hash = hash_pbkdf2(&#x27;sha256&#x27;, $password, $salt, 100000);</span><br><span class="line"></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-92"><a href="#REFERENCES-92" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 760 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002450 </p>
<p>[3] Standards Mapping - FIPS200 MP </p>
<p>[4] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-13 Cryptographic Protection (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.4.1 Credential Storage Requirements, 2.4.2 Credential Storage Requirements, 2.4.5 Credential Storage Requirements, 2.6.3 Look-up Secret Verifier Requirements, 2.9.3 Cryptographic Software and Devices Verifier Requirements, 6.2.1 Algorithms, 6.2.2 Algorithms, 8.3.7 Sensitive Private Data, 9.1.2 Communications Security Requirements, 9.1.3 Communications Security Requirements </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M6 Broken Cryptography </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.3 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.3 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.3 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.3 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.3 </p>
<p>[20] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.1 - Use of Cryptography, Control Objective 7.4 - Use of Cryptography </p>
<p>[21] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 759 </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3150.1 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3150.1 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3150.1 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3150.1 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3150.1 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3150.1 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3150.1 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<h4 id="Weak-Cryptographic-Hash-User-Controlled-PBE-Salt"><a href="#Weak-Cryptographic-Hash-User-Controlled-PBE-Salt" class="headerlink" title="Weak Cryptographic Hash: User-Controlled PBE Salt"></a>Weak Cryptographic Hash: User-Controlled PBE Salt</h4><h5 id="ABSTRACT-93"><a href="#ABSTRACT-93" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>可能受污染的用户输入不应该作为 salt 参数传递到基于密码的密钥派生函数 (PBKDF)。</p>
<h5 id="EXPLANATION-93"><a href="#EXPLANATION-93" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在以下情况下会发生 Weak Cryptographic Hash: 用户控制 PBE 的 Salt 问题将在以下情况下出现：</p>
<p>1.数据通过一个不可信赖的数据源进入程序。</p>
<p>2.用户控制的数据包括在 salt 中，或完全作为基于密码的密钥派生函数 (PBKDF) 中的 salt 使用。</p>
<p>如同许多软件安全漏洞一样，Weak Cryptographic Hash: 用户控制 PBE 的 Salt 是到达终点的一个途径，其本身并不是终点。从本质上看，这些漏洞是显而易见的：攻击者可将恶意数据传递到应用程序，然后这些数据被用作 PBKDF 中的全部或部分 salt。</p>
<p>使用用户定义的 salt 的问题在于，它可以实现各种不同的攻击：</p>
<p>1.攻击者可以利用这一漏洞，指定一个空 salt 作为自己的密码。由此，可以轻易地使用许多不同的散列快速地对其密码执行派生，以泄露有关您的应用程序中使用的 PBKDF 实现的信息。这样，通过限制所用散列的特定变体，可以更轻松地“破解”其他密码。</p>
<p>2.如果攻击者能够操纵其他用户的 salt，或者诱骗其他用户使用空 salt，这将使他们能够计算应用程序的“彩虹表”，并更轻松地确定派生值。</p>
<p>示例 1：以下代码使用用户控制 salt：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">function register()&#123;</span><br><span class="line"></span><br><span class="line">  $password = $_GET[&#x27;password&#x27;];</span><br><span class="line"></span><br><span class="line">  $username = $_GET[&#x27;username&#x27;];</span><br><span class="line"></span><br><span class="line">  $salt = getenv(&#x27;SALT&#x27;);</span><br><span class="line"></span><br><span class="line">  $hash = hash_pbkdf2(&#x27;sha256&#x27;, $password, $salt, 100000);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Example 1中的代码将成功运行，但任何有权使用此功能的人将能够通过修改环境变量SALT来操纵用于派生密钥或密码的 salt。一旦程序发布，撤消与用户控制的 salt 相关的问题就会非常困难，因为很难知道恶意用户是否确定了密码散列的 salt。</p>
<h5 id="RECOMMENDATIONS-92"><a href="#RECOMMENDATIONS-92" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>salt 绝不能是用户控制的，即使是部分也不可以，也不能是硬编码的。通常情况下，应对 salt 加以模糊化，并在外部数据源中进行管理。在系统中采用明文的形式存储 salt，会造成任何有充分权限的人读取和无意中误用 salt。</p>
<h5 id="REFERENCES-93"><a href="#REFERENCES-93" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 328, CWE ID 760 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002450 </p>
<p>[3] Standards Mapping - FIPS200 MP </p>
<p>[4] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-13 Cryptographic Protection (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.4.1 Credential Storage Requirements, 2.4.2 Credential Storage Requirements, 2.4.5 Credential Storage Requirements, 2.6.3 Look-up Secret Verifier Requirements, 2.8.3 Single or Multi Factor One Time Verifier Requirements, 2.9.3 Cryptographic Software and Devices Verifier Requirements, 6.2.1 Algorithms, 6.2.2 Algorithms, 6.2.3 Algorithms, 6.2.4 Algorithms, 6.2.5 Algorithms, 6.2.6 Algorithms, 6.2.7 Algorithms, 8.3.7 Sensitive Private Data, 9.1.2 Communications Security Requirements, 9.1.3 Communications Security Requirements </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M6 Broken Cryptography </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.3 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.3 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.3 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.3 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.3 </p>
<p>[20] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.1 - Use of Cryptography, Control Objective 7.4 - Use of Cryptography </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3150.1 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3150.1 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3150.1 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3150.1 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3150.1 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3150.1 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3150.1 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<h4 id="Weak-Encryption"><a href="#Weak-Encryption" class="headerlink" title="Weak Encryption"></a>Weak Encryption</h4><h5 id="ABSTRACT-94"><a href="#ABSTRACT-94" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>识别调用会使用无法保证敏感数据的保密性的弱加密算法。</p>
<h5 id="EXPLANATION-94"><a href="#EXPLANATION-94" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>过时的加密算法（如 DES）无法再为敏感数据的使用提供足够的保护。加密算法依赖于密钥大小，这是确保加密强度的主要方法之一。加密强度通常以生成有效密钥所需的时间和计算能力来衡量。计算能力的提高使得在合理的时间内获得较小的加密密钥成为可能。例如，在二十世纪七十年代首次开发出 DES 算法时，要破解在该算法中使用的 56 位密钥将面临巨大的计算障碍，但今天，使用常用设备能在不到一天的时间内破解 DES。</p>
<h5 id="RECOMMENDATIONS-93"><a href="#RECOMMENDATIONS-93" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用密钥较大的强加密算法来保护敏感数据。DES 的一个强大替代方案是 AES（高级加密标准，以前称为 Rijndael）。在选择算法之前，首先要确定您的组织是否已针对特定算法和实施进行了标准化。</p>
<h5 id="REFERENCES-94"><a href="#REFERENCES-94" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Mcrypt ciphers The PHP Group</p>
<p>[2] mcrypt_encrypt The PHP Group</p>
<p>[3] distributed.net DES </p>
<p>[4] FAQ About the Electronic Frontier Foundation’s “DES Cracker” Machine Electronic Frontier Foundation</p>
<p>[5] SDL Development Practices Microsoft</p>
<p>[6] Microsoft Security Fundamentals Microsoft</p>
<p>[7] John Kelsey, Bruce Schneier, and David Wagner Related-key cryptanalysis of 3-WAY, Biham-DES, CAST, DES-X, NewDES, RC2, and TEA </p>
<p>[8] Standards Mapping - Common Weakness Enumeration CWE ID 327 </p>
<p>[9] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002450 </p>
<p>[10] Standards Mapping - FIPS200 MP </p>
<p>[11] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[12] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-13 Cryptographic Protection (P1) </p>
<p>[13] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.6.2 Cryptographic Architectural Requirements, 2.8.2 Single or Multi Factor One Time Verifier Requirements, 2.8.3 Single or Multi Factor One Time Verifier Requirements, 2.9.1 Cryptographic Software and Devices Verifier Requirements, 2.9.3 Cryptographic Software and Devices Verifier Requirements, 2.6.3 Look-up Secret Verifier Requirements, 2.9.3 Cryptographic Software and Devices Verifier Requirements, 6.2.2 Algorithms, 6.2.3 Algorithms, 6.2.4 Algorithms, 6.2.5 Algorithms, 6.2.6 Algorithms, 6.4.2 Secret Management, 6.2.1 Algorithms, 6.2.2 Algorithms, 8.3.7 Sensitive Private Data, 8.3.7 Sensitive Private Data, 9.1.2 Communications Security Requirements, 9.1.3 Communications Security Requirements, 9.1.2 Communications Security Requirements, 9.1.3 Communications Security Requirements </p>
<p>[14] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M6 Broken Cryptography </p>
<p>[15] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[16] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[17] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[18] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[19] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.3 </p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.3 </p>
<p>[24] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.3 </p>
<p>[25] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.3 </p>
<p>[26] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.3 </p>
<p>[27] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.1 - Use of Cryptography </p>
<p>[28] Standards Mapping - SANS Top 25 2009 Porous Defenses - CWE ID 327 </p>
<p>[29] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 327 </p>
<p>[30] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 327 </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3150.1 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3150.1 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3150.1 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3150.1 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3150.1 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3150.1 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3150.1 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[43] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[44] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[45] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[46] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[47] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<h4 id="Weak-Encryption-Inadequate-RSA-Padding"><a href="#Weak-Encryption-Inadequate-RSA-Padding" class="headerlink" title="Weak Encryption: Inadequate RSA Padding"></a>Weak Encryption: Inadequate RSA Padding</h4><h5 id="ABSTRACT-95"><a href="#ABSTRACT-95" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>公钥 RSA 加密在不使用 QAEP 填充模式下执行，因此加密机制比较脆弱。</p>
<h5 id="EXPLANATION-95"><a href="#EXPLANATION-95" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>实际中，使用 RSA 公钥的加密通常与某种填充模式结合使用。该填充模式的目的在于防止一些针对 RSA 的攻击，这些攻击仅在执行不带填充模式的加密时才起作用。</p>
<p>例 1： 以下代码通过未使用填充模式的 RSA 公钥执行加密：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function encrypt($input, $key) &#123;</span><br><span class="line"></span><br><span class="line">  $output=&#x27;&#x27;;</span><br><span class="line"></span><br><span class="line">  openssl_public_encrypt($input, $output, $key, OPENSSL_NO_PADDING);</span><br><span class="line"></span><br><span class="line">  return $output;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-94"><a href="#RECOMMENDATIONS-94" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为安全使用 RSA，在执行加密时必须使用 OAEP（最优非对称加密填充模式）。</p>
<p>例 2： 以下代码通过使用 OAEP 填充模式的 RSA 公钥执行加密：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function encrypt($input, $key)&#123;</span><br><span class="line"></span><br><span class="line">  $output=&#x27;&#x27;;</span><br><span class="line"></span><br><span class="line">  openssl_public_encrypt($input, $output, $key, OPENSSL_PKCS1_OAEP_PADDING);</span><br><span class="line"></span><br><span class="line">  return $output;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-95"><a href="#REFERENCES-95" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Wikipedia </p>
<p>[2] OPENSSL Documentation </p>
<p>[3] PKCS #1 v2.1: RSA Cryptography Standard </p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 780 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002450 </p>
<p>[6] Standards Mapping - FIPS200 MP </p>
<p>[7] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-13 Cryptographic Protection (P1) </p>
<p>[9] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.6.3 Look-up Secret Verifier Requirements, 2.9.3 Cryptographic Software and Devices Verifier Requirements, 6.2.1 Algorithms, 6.2.2 Algorithms, 8.3.7 Sensitive Private Data, 9.1.2 Communications Security Requirements, 9.1.3 Communications Security Requirements </p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M6 Broken Cryptography </p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[13] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[14] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[15] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.3 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.3 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.3 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.3 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.3 </p>
<p>[23] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.1 - Use of Cryptography, Control Objective 7.4 - Use of Cryptography </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3150.1 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3150.1 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3150.1 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3150.1 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3150.1 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3150.1 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3150.1 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<h4 id="Weak-Encryption-Insufficient-Key-Size"><a href="#Weak-Encryption-Insufficient-Key-Size" class="headerlink" title="Weak Encryption: Insufficient Key Size"></a>Weak Encryption: Insufficient Key Size</h4><h5 id="ABSTRACT-96"><a href="#ABSTRACT-96" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>另外，当使用的密钥长度不够时，强大的加密算法便容易受到强力攻击。</p>
<h5 id="EXPLANATION-96"><a href="#EXPLANATION-96" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当前的密码指南建议，RSA 算法使用的密钥长度至少应为 2048 位。但是，计算能力和因子分解技术方面的持续进步 [1] 意味着未来将不可避免地需要提高建议的密钥大小。</p>
<p>示例 1：以下代码可生成 1024 位 RSA 加密密钥。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$keysize = 1024;</span><br><span class="line"></span><br><span class="line">$options = array(&#x27;private_key_bits&#x27; =&gt; $keysize, &#x27;private_key_type&#x27; =&gt; OPENSSL_KEYTYPE_RSA);</span><br><span class="line"></span><br><span class="line">$res = openssl_pkey_new($options);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>对于对称加密，三重 DES 的密钥长度应该至少为 168 比特，AES 应该至少为 128 比特。</p>
<h5 id="RECOMMENDATIONS-95"><a href="#RECOMMENDATIONS-95" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>最低限度下，确保 RSA 密钥长度不少于 2048 位。未来几年需要较强加密的应用程序的密码长度应至少为 4096 位。</p>
<p>如果使用 RSA 算法，请确保特定密钥的长度至少为 2048 位。</p>
<p>示例 2：以下代码可生成 2048 位 RSA 加密密钥。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$keysize = 2048;</span><br><span class="line"></span><br><span class="line">$options = array(&#x27;private_key_bits&#x27; =&gt; $keysize, &#x27;private_key_type&#x27; =&gt; OPENSSL_KEYTYPE_RSA);</span><br><span class="line"></span><br><span class="line">$res = openssl_pkey_new($options);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>同样，如果使用对称加密，请确保特定密钥的长度至少为 128 位（适用于 AES）和 168 位（适用于 Triple DES）。</p>
<h5 id="REFERENCES-96"><a href="#REFERENCES-96" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] J. Cheng 307-digit key crack endangers 1024-bit RSA </p>
<p>[2] Cryptographic Algorithms and Key Sizes for Personal Identity Verification NIST</p>
<p>[3] B. Chess and J. West, Secure Programming with Static Analysis. Boston, MA: Addison-Wesley, 2007. </p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 326 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002450 </p>
<p>[6] Standards Mapping - FIPS200 MP </p>
<p>[7] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-12 Cryptographic Key Establishment and Management (P1) </p>
<p>[9] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.6.3 Look-up Secret Verifier Requirements, 2.8.3 Single or Multi Factor One Time Verifier Requirements, 6.2.1 Algorithms, 6.2.3 Algorithms, 6.2.4 Algorithms, 6.2.5 Algorithms, 6.2.6 Algorithms, 9.1.2 Communications Security Requirements, 9.1.3 Communications Security Requirements </p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M6 Broken Cryptography </p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[13] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[14] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[15] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 3.6.1, Requirement 6.5.8 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 3.6.1, Requirement 6.3.1.3, Requirement 6.5.8 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 3.6.1, Requirement 6.5.3 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 3.6.1, Requirement 6.5.3 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 3.6.1, Requirement 6.5.3 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 3.6.1, Requirement 6.5.3 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 3.6.1, Requirement 6.5.3 </p>
<p>[23] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.2 - Use of Cryptography </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3150.1 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3150.1 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3150.1 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3150.1 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3150.1 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3150.1 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3150.1 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<h4 id="Weak-Encryption-User-Controlled-Key-Size"><a href="#Weak-Encryption-User-Controlled-Key-Size" class="headerlink" title="Weak Encryption: User-Controlled Key Size"></a>Weak Encryption: User-Controlled Key Size</h4><h5 id="ABSTRACT-97"><a href="#ABSTRACT-97" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>不应将受污染的密钥大小值传递给采用密钥大小参数的加密函数。</p>
<h5 id="EXPLANATION-97"><a href="#EXPLANATION-97" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>允许用户控制的值确定密钥大小会让攻击者可以指定一个空密钥，导致攻击者可以相对容易地解密任何使用空密钥进行加密的数据。即使要求使用非零值，攻击者也仍然可以指定尽可能低的值，降低加密的安全性。</p>
<p>弱加密：用户控制密钥大小问题将在以下情况下出现：</p>
<p>1.数据通过一个不可信赖的数据源进入程序</p>
<p>2.用户控制的数据包含在密钥大小参数中，或完全用作加密函数中的密钥大小参数。</p>
<p>如同许多软件安全漏洞一样，弱加密：用户控制密钥大小是到达终点的一个途径，其本身并不是终点。从本质上看，这些漏洞是显而易见的：攻击者将恶意数据传送到应用程序，这些数据随后被用作执行加密的密钥大小值的全部或一部分。</p>
<p>用户控制密钥大小的问题在于，它可以实现几个不同的攻击：</p>
<p>1.攻击者可以利用此漏洞，为涉及他们可以访问的任何数据的加密操作指定零密钥大小。由此，可以轻易地使用多个不同的算法以及空密钥，试图对他们自己的数据进行解密，以泄露有关应用程序中使用的加密实现的信息。通过允许攻击者在破解期间仅专注于特定算法，这使攻击者可以更容易地解密其他用户的加密数据。</p>
<p>2.攻击者可以操纵其他用户的加密密钥大小，或诱骗其他用户使用零（或尽可能低的）加密密钥大小，从而使攻击者可能可以读取其他用户的加密数据（一旦攻击者知晓所使用的加密算法）。</p>
<p>示例 1：以下代码可从密码衍生密钥，但使用用户控制的衍生密钥长度：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$hash = hash_pbkdf2(&#x27;sha256&#x27;, $password, $random_salt, 100000, strlen($password));</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Example 1 中的代码将成功运行，但任何有权使用此功能的人将能够操纵加密算法的密钥大小参数，因为变量 user_input 可由用户控制。一旦程序发布，撤消与用户控制的密钥大小相关的问题就会非常困难，因为很难知道恶意用户是否确定了给定加密操作的密钥大小。</p>
<h5 id="RECOMMENDATIONS-96"><a href="#RECOMMENDATIONS-96" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>加密算法的密钥大小参数绝不能由用户控制，即使部分控制也不行。通常情况下，应该根据使用中的加密算法，将密钥大小参数手动设置为相应的密钥大小。一些 API 甚至提供一套与各种加密算法相对应的密钥大小常量。</p>
<p>示例 2：以下代码可从密码衍生密钥，但使用由系统管理员确定的值：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">$hash = hash_pbkdf2(&#x27;sha256&#x27;, $password, $random_salt, 100000, 256);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>Example 2 中的代码假设，random_salt 是使用加密伪随机数生成器生成的，并且会将派生的密钥长度用于合适长度为 256 的密码（如 AES）。</p>
<h5 id="REFERENCES-97"><a href="#REFERENCES-97" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 326 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002450 </p>
<p>[3] Standards Mapping - FIPS200 MP </p>
<p>[4] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-12 Cryptographic Key Establishment and Management (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.6.3 Look-up Secret Verifier Requirements, 2.8.3 Single or Multi Factor One Time Verifier Requirements, 6.2.1 Algorithms, 6.2.3 Algorithms, 6.2.4 Algorithms, 6.2.5 Algorithms, 6.2.6 Algorithms, 9.1.2 Communications Security Requirements, 9.1.3 Communications Security Requirements </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M6 Broken Cryptography </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 3.6.1, Requirement 6.5.8 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 3.6.1, Requirement 6.3.1.3, Requirement 6.5.8 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 3.6.1, Requirement 6.5.3 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 3.6.1, Requirement 6.5.3 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 3.6.1, Requirement 6.5.3 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 3.6.1, Requirement 6.5.3 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 3.6.1, Requirement 6.5.3 </p>
<p>[20] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.2 - Use of Cryptography </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3150.1 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3150.1 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3150.1 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3150.1 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3150.1 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3150.1 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3150.1 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>

      



      

  <div class="declare">
  <br><br>
  <strong>本文链接：</strong>
  http://dayun.shystartree.online/2020/05/20/fortify%E6%89%AB%E6%8F%8F%E7%BB%93%E6%9E%9C%E9%80%9F%E6%9F%A5(PHP)/
  <br>
  <strong>版权声明：</strong>本博客所有文章除特别声明外，均采用<a rel="license noopener" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享4.0国际许可协议</a><a rel="license noopener" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="知识共享许可协议" style="border-width:0" src="/img/licensee.png"/></a>许可协议。欢迎转载，但转载请注明来自qingyu’s blog，并保持转载后文章内容的完整，本人保留所有版权相关权利。
  
  
  </div>





      
        <div class="page-reward">
          <a href="javascript:;" class="page-reward-btn tooltip-top">
            <div class="tooltip tooltip-east">
            <span class="tooltip-item">
              赏
            </span>
            <span class="tooltip-content">
              <span class="tooltip-text">
                <span class="tooltip-inner">
                  <p class="reward-p"><i class="icon icon-quo-left"></i>觉得写得好可以请我吃杯奶茶支持下哦～～～<i class="icon icon-quo-right"></i></p>
                  <div class="reward-box">
                    
                    <div class="reward-box-item">
                      <img class="reward-img" src="/img/alipay.jpg">
                      <span class="reward-type">支付宝</span>
                    </div>
                    
                    
                    <div class="reward-box-item">
                      <img class="reward-img" src="/img/wxpay.jpg">
                      <span class="reward-type">微信</span>
                    </div>
                    
                  </div>
                </span>
              </span>
            </span>
          </div>
          </a>
        </div>
      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">安全</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">速查</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">fortify</a>
        		</li>
      		
		</ul>
	</div>

      

      

      
        
<div class="share-btn share-icons tooltip-left">
  <div class="tooltip tooltip-east">
    <span class="tooltip-item">
      <a href="javascript:;" class="share-sns share-outer">
        <i class="icon icon-share"></i>
      </a>
    </span>
    <span class="tooltip-content">
      <div class="share-wrap">
        <div class="share-icons">
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="icon icon-weibo"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="icon icon-weixin"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="icon icon-qq"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="icon icon-douban"></i>
          </a>
          <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a>
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="icon icon-facebook"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="icon icon-twitter"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="icon icon-google"></i>
          </a>
        </div>
      </div>
    </span>
  </div>
</div>

<div class="page-modal wx-share js-wx-box">
    <a class="close js-modal-close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//pan.baidu.com/share/qrcode?url=http://dayun.shystartree.online/2020/05/20/fortify%E6%89%AB%E6%8F%8F%E7%BB%93%E6%9E%9C%E9%80%9F%E6%9F%A5(PHP)/" alt="微信分享二维码">
    </div>
</div>

<div class="mask js-mask"></div>
      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

  
<nav id="article-nav">
  
    <a href="/2020/05/21/fortify%E6%89%AB%E6%8F%8F%E7%BB%93%E6%9E%9C%E9%80%9F%E6%9F%A5(Python)/" id="article-nav-newer" class="article-nav-link-wrap">
      <i class="icon-circle-left"></i>
      <div class="article-nav-title">
        
          fortify扫描结果速查(Python)
        
      </div>
    </a>
  
  
    <a href="/2020/04/20/fortify%E6%89%AB%E6%8F%8F%E7%BB%93%E6%9E%9C%E9%80%9F%E6%9F%A5(JavaScript)/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">fortify扫描结果速查(JavaScript)</div>
      <i class="icon-circle-right"></i>
    </a>
  
</nav>


<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
        <div class="toc-container tooltip-left">
            <i class="icon-font icon-category"></i>
            <div class="tooltip tooltip-east">
                <span class="tooltip-item">
                </span>
                <span class="tooltip-content">
                    <div class="toc-article">
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#PHP"><span class="toc-number">1.</span> <span class="toc-text">PHP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#API%E8%AF%AF%E7%94%A8"><span class="toc-number">1.1.</span> <span class="toc-text">API误用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Dangerous-Function"><span class="toc-number">1.1.1.</span> <span class="toc-text">Dangerous Function</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS"><span class="toc-number">1.1.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES"><span class="toc-number">1.1.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Often-Misused-File-Upload"><span class="toc-number">1.1.2.</span> <span class="toc-text">Often Misused: File Upload</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-1"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-1"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-1"><span class="toc-number">1.1.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-1"><span class="toc-number">1.1.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%81%E8%A3%85"><span class="toc-number">1.2.</span> <span class="toc-text">封装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Overly-Permissive-CORS-Policy"><span class="toc-number">1.2.1.</span> <span class="toc-text">HTML5: Overly Permissive CORS Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-2"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-2"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-2"><span class="toc-number">1.2.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-2"><span class="toc-number">1.2.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak"><span class="toc-number">1.2.2.</span> <span class="toc-text">System Information Leak</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-3"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-3"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-3"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-3"><span class="toc-number">1.2.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-External"><span class="toc-number">1.2.3.</span> <span class="toc-text">System Information Leak: External</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-4"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-4"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-4"><span class="toc-number">1.2.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-4"><span class="toc-number">1.2.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Internal"><span class="toc-number">1.2.4.</span> <span class="toc-text">System Information Leak: Internal</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-5"><span class="toc-number">1.2.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-5"><span class="toc-number">1.2.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-5"><span class="toc-number">1.2.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-5"><span class="toc-number">1.2.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-number">1.3.</span> <span class="toc-text">环境配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CakePHP-Misconfiguration-Debug-Information"><span class="toc-number">1.3.1.</span> <span class="toc-text">CakePHP Misconfiguration: Debug Information</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-6"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-6"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-6"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-6"><span class="toc-number">1.3.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CakePHP-Misconfiguration-Excessive-Session-Timeout"><span class="toc-number">1.3.2.</span> <span class="toc-text">CakePHP Misconfiguration: Excessive Session Timeout</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-7"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-7"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-7"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-7"><span class="toc-number">1.3.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-Missing-open-basedir-Entry"><span class="toc-number">1.3.3.</span> <span class="toc-text">PHP Misconfiguration: Missing open_basedir Entry</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-8"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-8"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-8"><span class="toc-number">1.3.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-8"><span class="toc-number">1.3.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-Missing-safe-mode-exec-dir-Entry"><span class="toc-number">1.3.4.</span> <span class="toc-text">PHP Misconfiguration: Missing safe_mode_exec_dir Entry</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-9"><span class="toc-number">1.3.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-9"><span class="toc-number">1.3.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-9"><span class="toc-number">1.3.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-9"><span class="toc-number">1.3.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-Poor-open-basedir-Configuration"><span class="toc-number">1.3.5.</span> <span class="toc-text">PHP Misconfiguration: Poor open_basedir Configuration</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-10"><span class="toc-number">1.3.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-10"><span class="toc-number">1.3.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-10"><span class="toc-number">1.3.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-10"><span class="toc-number">1.3.5.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-allow-url-fopen-Enabled"><span class="toc-number">1.3.6.</span> <span class="toc-text">PHP Misconfiguration: allow_url_fopen Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-11"><span class="toc-number">1.3.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-11"><span class="toc-number">1.3.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-11"><span class="toc-number">1.3.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-11"><span class="toc-number">1.3.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-allow-url-include-Enabled"><span class="toc-number">1.3.7.</span> <span class="toc-text">PHP Misconfiguration: allow_url_include Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-12"><span class="toc-number">1.3.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-12"><span class="toc-number">1.3.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-12"><span class="toc-number">1.3.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-12"><span class="toc-number">1.3.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-cgi-force-redirect-Disabled"><span class="toc-number">1.3.8.</span> <span class="toc-text">PHP Misconfiguration: cgi.force_redirect Disabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-13"><span class="toc-number">1.3.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-13"><span class="toc-number">1.3.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-13"><span class="toc-number">1.3.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-13"><span class="toc-number">1.3.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-enable-dl-Enabled"><span class="toc-number">1.3.9.</span> <span class="toc-text">PHP Misconfiguration: enable_dl Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-14"><span class="toc-number">1.3.9.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-14"><span class="toc-number">1.3.9.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-14"><span class="toc-number">1.3.9.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-14"><span class="toc-number">1.3.9.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-file-uploads-Enabled"><span class="toc-number">1.3.10.</span> <span class="toc-text">PHP Misconfiguration: file_uploads Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-15"><span class="toc-number">1.3.10.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-15"><span class="toc-number">1.3.10.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-15"><span class="toc-number">1.3.10.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-15"><span class="toc-number">1.3.10.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-magic-quotes-gpc-Enabled"><span class="toc-number">1.3.11.</span> <span class="toc-text">PHP Misconfiguration: magic_quotes_gpc Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-16"><span class="toc-number">1.3.11.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-16"><span class="toc-number">1.3.11.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-16"><span class="toc-number">1.3.11.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-16"><span class="toc-number">1.3.11.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-magic-quotes-runtime-Enabled"><span class="toc-number">1.3.12.</span> <span class="toc-text">PHP Misconfiguration: magic_quotes_runtime Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-17"><span class="toc-number">1.3.12.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-17"><span class="toc-number">1.3.12.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-17"><span class="toc-number">1.3.12.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-17"><span class="toc-number">1.3.12.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-magic-quotes-sybase-Enabled"><span class="toc-number">1.3.13.</span> <span class="toc-text">PHP Misconfiguration: magic_quotes_sybase Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-18"><span class="toc-number">1.3.13.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-18"><span class="toc-number">1.3.13.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-18"><span class="toc-number">1.3.13.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-18"><span class="toc-number">1.3.13.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-register-globals-Enabled"><span class="toc-number">1.3.14.</span> <span class="toc-text">PHP Misconfiguration: register_globals Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-19"><span class="toc-number">1.3.14.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-19"><span class="toc-number">1.3.14.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-19"><span class="toc-number">1.3.14.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-19"><span class="toc-number">1.3.14.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-safe-mode-Disabled"><span class="toc-number">1.3.15.</span> <span class="toc-text">PHP Misconfiguration: safe_mode Disabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-20"><span class="toc-number">1.3.15.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-20"><span class="toc-number">1.3.15.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-20"><span class="toc-number">1.3.15.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-20"><span class="toc-number">1.3.15.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Misconfiguration-session-use-trans-sid-Enabled"><span class="toc-number">1.3.16.</span> <span class="toc-text">PHP Misconfiguration: session_use_trans_sid Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-21"><span class="toc-number">1.3.16.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-21"><span class="toc-number">1.3.16.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-21"><span class="toc-number">1.3.16.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-21"><span class="toc-number">1.3.16.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Race-Condition-PHP-Design-Flaw"><span class="toc-number">1.3.17.</span> <span class="toc-text">Race Condition: PHP Design Flaw</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-22"><span class="toc-number">1.3.17.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-22"><span class="toc-number">1.3.17.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-22"><span class="toc-number">1.3.17.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-22"><span class="toc-number">1.3.17.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-PHP-Errors"><span class="toc-number">1.3.18.</span> <span class="toc-text">System Information Leak: PHP Errors</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-23"><span class="toc-number">1.3.18.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-23"><span class="toc-number">1.3.18.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-23"><span class="toc-number">1.3.18.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-23"><span class="toc-number">1.3.18.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-PHP-Version"><span class="toc-number">1.3.19.</span> <span class="toc-text">System Information Leak: PHP Version</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-24"><span class="toc-number">1.3.19.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-24"><span class="toc-number">1.3.19.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-24"><span class="toc-number">1.3.19.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-24"><span class="toc-number">1.3.19.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-number">1.4.</span> <span class="toc-text">异常处理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Error-Handling-Empty-Catch-Block"><span class="toc-number">1.4.1.</span> <span class="toc-text">Poor Error Handling: Empty Catch Block</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-25"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-25"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-25"><span class="toc-number">1.4.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-25"><span class="toc-number">1.4.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Error-Handling-Return-Inside-Finally"><span class="toc-number">1.4.2.</span> <span class="toc-text">Poor Error Handling: Return Inside Finally</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-26"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-26"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-26"><span class="toc-number">1.4.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-26"><span class="toc-number">1.4.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%E9%AA%8C%E8%AF%81%E4%B8%8E%E5%B1%95%E7%A4%BA%E9%97%AE%E9%A2%98"><span class="toc-number">1.5.</span> <span class="toc-text">输入验证与展示问题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Command-Injection"><span class="toc-number">1.5.1.</span> <span class="toc-text">Command Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-27"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-27"><span class="toc-number">1.5.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-27"><span class="toc-number">1.5.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-27"><span class="toc-number">1.5.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-Persistent"><span class="toc-number">1.5.2.</span> <span class="toc-text">Cross-Site Scripting: Persistent</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-28"><span class="toc-number">1.5.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-28"><span class="toc-number">1.5.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-28"><span class="toc-number">1.5.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-28"><span class="toc-number">1.5.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-Poor-Validation"><span class="toc-number">1.5.3.</span> <span class="toc-text">Cross-Site Scripting: Poor Validation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-29"><span class="toc-number">1.5.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-29"><span class="toc-number">1.5.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-29"><span class="toc-number">1.5.3.3.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-Reflected"><span class="toc-number">1.5.4.</span> <span class="toc-text">Cross-Site Scripting: Reflected</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-30"><span class="toc-number">1.5.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-30"><span class="toc-number">1.5.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-29"><span class="toc-number">1.5.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-30"><span class="toc-number">1.5.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dangerous-File-Inclusion"><span class="toc-number">1.5.5.</span> <span class="toc-text">Dangerous File Inclusion</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-31"><span class="toc-number">1.5.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-31"><span class="toc-number">1.5.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-30"><span class="toc-number">1.5.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-31"><span class="toc-number">1.5.5.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dangerous-File-Injection"><span class="toc-number">1.5.6.</span> <span class="toc-text">Dangerous File Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-32"><span class="toc-number">1.5.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-32"><span class="toc-number">1.5.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-31"><span class="toc-number">1.5.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-32"><span class="toc-number">1.5.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Denial-of-Service"><span class="toc-number">1.5.7.</span> <span class="toc-text">Denial of Service</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-33"><span class="toc-number">1.5.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-33"><span class="toc-number">1.5.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-32"><span class="toc-number">1.5.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-33"><span class="toc-number">1.5.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Denial-of-Service-Regular-Expression"><span class="toc-number">1.5.8.</span> <span class="toc-text">Denial of Service: Regular Expression</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-34"><span class="toc-number">1.5.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-34"><span class="toc-number">1.5.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-33"><span class="toc-number">1.5.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-34"><span class="toc-number">1.5.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-Code-Injection"><span class="toc-number">1.5.9.</span> <span class="toc-text">Dynamic Code Evaluation: Code Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-35"><span class="toc-number">1.5.9.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-35"><span class="toc-number">1.5.9.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-34"><span class="toc-number">1.5.9.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-35"><span class="toc-number">1.5.9.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTP-Parameter-Pollution"><span class="toc-number">1.5.10.</span> <span class="toc-text">HTTP Parameter Pollution</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-36"><span class="toc-number">1.5.10.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-36"><span class="toc-number">1.5.10.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-35"><span class="toc-number">1.5.10.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-36"><span class="toc-number">1.5.10.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Header-Manipulation"><span class="toc-number">1.5.11.</span> <span class="toc-text">Header Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-37"><span class="toc-number">1.5.11.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-37"><span class="toc-number">1.5.11.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-36"><span class="toc-number">1.5.11.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-37"><span class="toc-number">1.5.11.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Header-Manipulation-Cookies"><span class="toc-number">1.5.12.</span> <span class="toc-text">Header Manipulation: Cookies</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-38"><span class="toc-number">1.5.12.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-38"><span class="toc-number">1.5.12.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-37"><span class="toc-number">1.5.12.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-38"><span class="toc-number">1.5.12.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Header-Manipulation-SMTP"><span class="toc-number">1.5.13.</span> <span class="toc-text">Header Manipulation: SMTP</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-39"><span class="toc-number">1.5.13.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-39"><span class="toc-number">1.5.13.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-38"><span class="toc-number">1.5.13.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-39"><span class="toc-number">1.5.13.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JSON-Injection"><span class="toc-number">1.5.14.</span> <span class="toc-text">JSON Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-40"><span class="toc-number">1.5.14.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-40"><span class="toc-number">1.5.14.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-39"><span class="toc-number">1.5.14.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-40"><span class="toc-number">1.5.14.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LDAP-Injection"><span class="toc-number">1.5.15.</span> <span class="toc-text">LDAP Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-41"><span class="toc-number">1.5.15.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-41"><span class="toc-number">1.5.15.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-40"><span class="toc-number">1.5.15.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-41"><span class="toc-number">1.5.15.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LDAP-Manipulation"><span class="toc-number">1.5.16.</span> <span class="toc-text">LDAP Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-42"><span class="toc-number">1.5.16.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-42"><span class="toc-number">1.5.16.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-41"><span class="toc-number">1.5.16.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-42"><span class="toc-number">1.5.16.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Log-Forging"><span class="toc-number">1.5.17.</span> <span class="toc-text">Log Forging</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-43"><span class="toc-number">1.5.17.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-43"><span class="toc-number">1.5.17.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-42"><span class="toc-number">1.5.17.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-43"><span class="toc-number">1.5.17.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Object-Injection"><span class="toc-number">1.5.18.</span> <span class="toc-text">Object Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-44"><span class="toc-number">1.5.18.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-44"><span class="toc-number">1.5.18.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-43"><span class="toc-number">1.5.18.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-44"><span class="toc-number">1.5.18.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Open-Redirect"><span class="toc-number">1.5.19.</span> <span class="toc-text">Open Redirect</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-45"><span class="toc-number">1.5.19.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-45"><span class="toc-number">1.5.19.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-44"><span class="toc-number">1.5.19.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-45"><span class="toc-number">1.5.19.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Path-Manipulation"><span class="toc-number">1.5.20.</span> <span class="toc-text">Path Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-46"><span class="toc-number">1.5.20.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-46"><span class="toc-number">1.5.20.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-45"><span class="toc-number">1.5.20.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-46"><span class="toc-number">1.5.20.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Possible-Variable-Overwrite-Functional-Scope"><span class="toc-number">1.5.21.</span> <span class="toc-text">Possible Variable Overwrite: Functional Scope</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-47"><span class="toc-number">1.5.21.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-47"><span class="toc-number">1.5.21.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-46"><span class="toc-number">1.5.21.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-47"><span class="toc-number">1.5.21.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Possible-Variable-Overwrite-Global-Scope"><span class="toc-number">1.5.22.</span> <span class="toc-text">Possible Variable Overwrite: Global Scope</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-48"><span class="toc-number">1.5.22.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-48"><span class="toc-number">1.5.22.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-47"><span class="toc-number">1.5.22.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-48"><span class="toc-number">1.5.22.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Process-Control"><span class="toc-number">1.5.23.</span> <span class="toc-text">Process Control</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-49"><span class="toc-number">1.5.23.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-49"><span class="toc-number">1.5.23.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-48"><span class="toc-number">1.5.23.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-49"><span class="toc-number">1.5.23.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Resource-Injection"><span class="toc-number">1.5.24.</span> <span class="toc-text">Resource Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-50"><span class="toc-number">1.5.24.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-50"><span class="toc-number">1.5.24.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-49"><span class="toc-number">1.5.24.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-50"><span class="toc-number">1.5.24.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL-Injection"><span class="toc-number">1.5.25.</span> <span class="toc-text">SQL Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-51"><span class="toc-number">1.5.25.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-51"><span class="toc-number">1.5.25.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-50"><span class="toc-number">1.5.25.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-51"><span class="toc-number">1.5.25.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL-Injection-Poor-Validation"><span class="toc-number">1.5.26.</span> <span class="toc-text">SQL Injection: Poor Validation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-52"><span class="toc-number">1.5.26.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-52"><span class="toc-number">1.5.26.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-51"><span class="toc-number">1.5.26.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-52"><span class="toc-number">1.5.26.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Server-Side-Request-Forgery"><span class="toc-number">1.5.27.</span> <span class="toc-text">Server-Side Request Forgery</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-53"><span class="toc-number">1.5.27.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-53"><span class="toc-number">1.5.27.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-52"><span class="toc-number">1.5.27.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-53"><span class="toc-number">1.5.27.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Setting-Manipulation"><span class="toc-number">1.5.28.</span> <span class="toc-text">Setting Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-54"><span class="toc-number">1.5.28.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-54"><span class="toc-number">1.5.28.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-53"><span class="toc-number">1.5.28.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-54"><span class="toc-number">1.5.28.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Reflection"><span class="toc-number">1.5.29.</span> <span class="toc-text">Unsafe Reflection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-55"><span class="toc-number">1.5.29.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-55"><span class="toc-number">1.5.29.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-54"><span class="toc-number">1.5.29.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-55"><span class="toc-number">1.5.29.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XML-Injection"><span class="toc-number">1.5.30.</span> <span class="toc-text">XML Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-56"><span class="toc-number">1.5.30.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-56"><span class="toc-number">1.5.30.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-55"><span class="toc-number">1.5.30.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-56"><span class="toc-number">1.5.30.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XPath-Injection"><span class="toc-number">1.5.31.</span> <span class="toc-text">XPath Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-57"><span class="toc-number">1.5.31.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-57"><span class="toc-number">1.5.31.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-56"><span class="toc-number">1.5.31.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-57"><span class="toc-number">1.5.31.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XQuery-Injection"><span class="toc-number">1.5.32.</span> <span class="toc-text">XQuery Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-58"><span class="toc-number">1.5.32.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-58"><span class="toc-number">1.5.32.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-57"><span class="toc-number">1.5.32.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-58"><span class="toc-number">1.5.32.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XSLT-Injection"><span class="toc-number">1.5.33.</span> <span class="toc-text">XSLT Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-59"><span class="toc-number">1.5.33.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-59"><span class="toc-number">1.5.33.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-58"><span class="toc-number">1.5.33.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-59"><span class="toc-number">1.5.33.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E7%89%B9%E6%80%A7"><span class="toc-number">1.6.</span> <span class="toc-text">安全特性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Access-Control-Database"><span class="toc-number">1.6.1.</span> <span class="toc-text">Access Control: Database</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-60"><span class="toc-number">1.6.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-60"><span class="toc-number">1.6.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-59"><span class="toc-number">1.6.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-60"><span class="toc-number">1.6.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-Cookie-not-Sent-Over-SSL"><span class="toc-number">1.6.2.</span> <span class="toc-text">Cookie Security: Cookie not Sent Over SSL</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-61"><span class="toc-number">1.6.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-61"><span class="toc-number">1.6.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-60"><span class="toc-number">1.6.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-61"><span class="toc-number">1.6.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-HTTPOnly-not-Set"><span class="toc-number">1.6.3.</span> <span class="toc-text">Cookie Security: HTTPOnly not Set</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-62"><span class="toc-number">1.6.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-62"><span class="toc-number">1.6.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-61"><span class="toc-number">1.6.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-62"><span class="toc-number">1.6.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-HTTPOnly-not-Set-on-Session-Cookie"><span class="toc-number">1.6.4.</span> <span class="toc-text">Cookie Security: HTTPOnly not Set on Session Cookie</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-63"><span class="toc-number">1.6.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-63"><span class="toc-number">1.6.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-62"><span class="toc-number">1.6.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-63"><span class="toc-number">1.6.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-Overly-Broad-Domain"><span class="toc-number">1.6.5.</span> <span class="toc-text">Cookie Security: Overly Broad Domain</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-64"><span class="toc-number">1.6.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-64"><span class="toc-number">1.6.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-63"><span class="toc-number">1.6.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-64"><span class="toc-number">1.6.5.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-Overly-Broad-Path"><span class="toc-number">1.6.6.</span> <span class="toc-text">Cookie Security: Overly Broad Path</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-65"><span class="toc-number">1.6.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-65"><span class="toc-number">1.6.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-64"><span class="toc-number">1.6.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-65"><span class="toc-number">1.6.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-Overly-Broad-Session-Cookie-Domain"><span class="toc-number">1.6.7.</span> <span class="toc-text">Cookie Security: Overly Broad Session Cookie Domain</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-66"><span class="toc-number">1.6.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-66"><span class="toc-number">1.6.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-65"><span class="toc-number">1.6.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-66"><span class="toc-number">1.6.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-Overly-Broad-Session-Cookie-Path"><span class="toc-number">1.6.8.</span> <span class="toc-text">Cookie Security: Overly Broad Session Cookie Path</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-67"><span class="toc-number">1.6.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-67"><span class="toc-number">1.6.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-66"><span class="toc-number">1.6.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-67"><span class="toc-number">1.6.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-Persistent-Cookie"><span class="toc-number">1.6.9.</span> <span class="toc-text">Cookie Security: Persistent Cookie</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-68"><span class="toc-number">1.6.9.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-68"><span class="toc-number">1.6.9.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-67"><span class="toc-number">1.6.9.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-68"><span class="toc-number">1.6.9.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-Persistent-Session-Cookie"><span class="toc-number">1.6.10.</span> <span class="toc-text">Cookie Security: Persistent Session Cookie</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-69"><span class="toc-number">1.6.10.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-69"><span class="toc-number">1.6.10.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-68"><span class="toc-number">1.6.10.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-69"><span class="toc-number">1.6.10.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-Session-Cookie-not-Sent-Over-SSL"><span class="toc-number">1.6.11.</span> <span class="toc-text">Cookie Security: Session Cookie not Sent Over SSL</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-70"><span class="toc-number">1.6.11.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-70"><span class="toc-number">1.6.11.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-69"><span class="toc-number">1.6.11.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-70"><span class="toc-number">1.6.11.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-Session-Cookies-Disabled"><span class="toc-number">1.6.12.</span> <span class="toc-text">Cookie Security: Session Cookies Disabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-71"><span class="toc-number">1.6.12.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-71"><span class="toc-number">1.6.12.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-70"><span class="toc-number">1.6.12.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-71"><span class="toc-number">1.6.12.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#File-Permission-Manipulation"><span class="toc-number">1.6.13.</span> <span class="toc-text">File Permission Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-72"><span class="toc-number">1.6.13.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-72"><span class="toc-number">1.6.13.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-71"><span class="toc-number">1.6.13.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-72"><span class="toc-number">1.6.13.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Randomness"><span class="toc-number">1.6.14.</span> <span class="toc-text">Insecure Randomness</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-73"><span class="toc-number">1.6.14.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-73"><span class="toc-number">1.6.14.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-72"><span class="toc-number">1.6.14.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-73"><span class="toc-number">1.6.14.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Transport"><span class="toc-number">1.6.15.</span> <span class="toc-text">Insecure Transport</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-74"><span class="toc-number">1.6.15.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-74"><span class="toc-number">1.6.15.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-73"><span class="toc-number">1.6.15.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-74"><span class="toc-number">1.6.15.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Key-Management-Empty-Encryption-Key"><span class="toc-number">1.6.16.</span> <span class="toc-text">Key Management: Empty Encryption Key</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-75"><span class="toc-number">1.6.16.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-75"><span class="toc-number">1.6.16.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-74"><span class="toc-number">1.6.16.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-75"><span class="toc-number">1.6.16.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Key-Management-Hardcoded-Encryption-Key"><span class="toc-number">1.6.17.</span> <span class="toc-text">Key Management: Hardcoded Encryption Key</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-76"><span class="toc-number">1.6.17.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-76"><span class="toc-number">1.6.17.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-75"><span class="toc-number">1.6.17.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-76"><span class="toc-number">1.6.17.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Key-Management-Hardcoded-PBE-Password"><span class="toc-number">1.6.18.</span> <span class="toc-text">Key Management: Hardcoded PBE Password</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-77"><span class="toc-number">1.6.18.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-77"><span class="toc-number">1.6.18.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-76"><span class="toc-number">1.6.18.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-77"><span class="toc-number">1.6.18.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Key-Management-Null-Encryption-Key"><span class="toc-number">1.6.19.</span> <span class="toc-text">Key Management: Null Encryption Key</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-78"><span class="toc-number">1.6.19.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-78"><span class="toc-number">1.6.19.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-77"><span class="toc-number">1.6.19.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-78"><span class="toc-number">1.6.19.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management"><span class="toc-number">1.6.20.</span> <span class="toc-text">Password Management</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-79"><span class="toc-number">1.6.20.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-79"><span class="toc-number">1.6.20.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-78"><span class="toc-number">1.6.20.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-79"><span class="toc-number">1.6.20.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management-Empty-Password"><span class="toc-number">1.6.21.</span> <span class="toc-text">Password Management: Empty Password</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-80"><span class="toc-number">1.6.21.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-80"><span class="toc-number">1.6.21.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-79"><span class="toc-number">1.6.21.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-80"><span class="toc-number">1.6.21.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management-Hardcoded-Password"><span class="toc-number">1.6.22.</span> <span class="toc-text">Password Management: Hardcoded Password</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-81"><span class="toc-number">1.6.22.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-81"><span class="toc-number">1.6.22.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-80"><span class="toc-number">1.6.22.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-81"><span class="toc-number">1.6.22.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management-Null-Password"><span class="toc-number">1.6.23.</span> <span class="toc-text">Password Management: Null Password</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-82"><span class="toc-number">1.6.23.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-82"><span class="toc-number">1.6.23.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-81"><span class="toc-number">1.6.23.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-82"><span class="toc-number">1.6.23.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management-Password-in-Comment"><span class="toc-number">1.6.24.</span> <span class="toc-text">Password Management: Password in Comment</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-83"><span class="toc-number">1.6.24.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-83"><span class="toc-number">1.6.24.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-82"><span class="toc-number">1.6.24.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-83"><span class="toc-number">1.6.24.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management-Weak-Cryptography"><span class="toc-number">1.6.25.</span> <span class="toc-text">Password Management: Weak Cryptography</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-84"><span class="toc-number">1.6.25.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-84"><span class="toc-number">1.6.25.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-83"><span class="toc-number">1.6.25.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-84"><span class="toc-number">1.6.25.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Privacy-Violation"><span class="toc-number">1.6.26.</span> <span class="toc-text">Privacy Violation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-85"><span class="toc-number">1.6.26.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-85"><span class="toc-number">1.6.26.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-84"><span class="toc-number">1.6.26.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-85"><span class="toc-number">1.6.26.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Privacy-Violation-HTTP-GET"><span class="toc-number">1.6.27.</span> <span class="toc-text">Privacy Violation: HTTP GET</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-86"><span class="toc-number">1.6.27.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-86"><span class="toc-number">1.6.27.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-85"><span class="toc-number">1.6.27.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-86"><span class="toc-number">1.6.27.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Cryptographic-Hash"><span class="toc-number">1.6.28.</span> <span class="toc-text">Weak Cryptographic Hash</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-87"><span class="toc-number">1.6.28.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-87"><span class="toc-number">1.6.28.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-86"><span class="toc-number">1.6.28.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-87"><span class="toc-number">1.6.28.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Cryptographic-Hash-Empty-PBE-Salt"><span class="toc-number">1.6.29.</span> <span class="toc-text">Weak Cryptographic Hash: Empty PBE Salt</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-88"><span class="toc-number">1.6.29.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-88"><span class="toc-number">1.6.29.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-87"><span class="toc-number">1.6.29.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-88"><span class="toc-number">1.6.29.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Cryptographic-Hash-Hardcoded-PBE-Salt"><span class="toc-number">1.6.30.</span> <span class="toc-text">Weak Cryptographic Hash: Hardcoded PBE Salt</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-89"><span class="toc-number">1.6.30.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-89"><span class="toc-number">1.6.30.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-88"><span class="toc-number">1.6.30.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-89"><span class="toc-number">1.6.30.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Cryptographic-Hash-Hardcoded-Salt"><span class="toc-number">1.6.31.</span> <span class="toc-text">Weak Cryptographic Hash: Hardcoded Salt</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-90"><span class="toc-number">1.6.31.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-90"><span class="toc-number">1.6.31.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-89"><span class="toc-number">1.6.31.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-90"><span class="toc-number">1.6.31.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Cryptographic-Hash-Insecure-PBE-Iteration-Count"><span class="toc-number">1.6.32.</span> <span class="toc-text">Weak Cryptographic Hash: Insecure PBE Iteration Count</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-91"><span class="toc-number">1.6.32.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-91"><span class="toc-number">1.6.32.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-90"><span class="toc-number">1.6.32.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-91"><span class="toc-number">1.6.32.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Cryptographic-Hash-Predictable-Salt"><span class="toc-number">1.6.33.</span> <span class="toc-text">Weak Cryptographic Hash: Predictable Salt</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-92"><span class="toc-number">1.6.33.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-92"><span class="toc-number">1.6.33.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-91"><span class="toc-number">1.6.33.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-92"><span class="toc-number">1.6.33.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Cryptographic-Hash-User-Controlled-PBE-Salt"><span class="toc-number">1.6.34.</span> <span class="toc-text">Weak Cryptographic Hash: User-Controlled PBE Salt</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-93"><span class="toc-number">1.6.34.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-93"><span class="toc-number">1.6.34.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-92"><span class="toc-number">1.6.34.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-93"><span class="toc-number">1.6.34.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Encryption"><span class="toc-number">1.6.35.</span> <span class="toc-text">Weak Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-94"><span class="toc-number">1.6.35.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-94"><span class="toc-number">1.6.35.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-93"><span class="toc-number">1.6.35.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-94"><span class="toc-number">1.6.35.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Encryption-Inadequate-RSA-Padding"><span class="toc-number">1.6.36.</span> <span class="toc-text">Weak Encryption: Inadequate RSA Padding</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-95"><span class="toc-number">1.6.36.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-95"><span class="toc-number">1.6.36.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-94"><span class="toc-number">1.6.36.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-95"><span class="toc-number">1.6.36.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Encryption-Insufficient-Key-Size"><span class="toc-number">1.6.37.</span> <span class="toc-text">Weak Encryption: Insufficient Key Size</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-96"><span class="toc-number">1.6.37.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-96"><span class="toc-number">1.6.37.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-95"><span class="toc-number">1.6.37.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-96"><span class="toc-number">1.6.37.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Encryption-User-Controlled-Key-Size"><span class="toc-number">1.6.38.</span> <span class="toc-text">Weak Encryption: User-Controlled Key Size</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-97"><span class="toc-number">1.6.38.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-97"><span class="toc-number">1.6.38.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-96"><span class="toc-number">1.6.38.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-97"><span class="toc-number">1.6.38.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li></ol></li></ol>
                    </div>
                </span>
            </div>
        </div>
        
    </div>
</aside>



  
  
  

  

  
    <section id="comments" style="margin:10px;padding:10px;background:#fff;">
      <div id="vcomment" class="comment"></div> 
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="//unpkg.com/valine/dist/Valine.min.js"></script>
<script>
   var notify = 'false' == true ? true : false;
   var verify = 'false' == true ? true : false;
    window.onload = function() {
        new Valine({
            el: '#vcomment',
            notify: notify,
            verify: verify,
            app_id: "cPIja8hEdmK0DO1mNhmKUtdb-gzGzoHsz",
            app_key: "rAG7JWw8FX9LqnHJj0NTvGdW",
            placeholder: "别默默地路过，吐槽下嘛～～～",
            avatar:"hide"
        });
    }
</script>

    </section>
  

  

  



          </div>
        </div>
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2021 QingYu
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
  

        <!-- 不蒜子统计   
        <span id="busuanzi_container_site_pv" style='display:none'>
                本站总访问量<span id="busuanzi_value_site_pv"></span>次
        </span>
        <span class="post-meta-divider">|</span> 
        -->
        <span id="busuanzi_container_site_uv" >
                您是本博客第<span id="busuanzi_value_site_uv"></span>个访客，qingyu欢迎您的到来~
        </span>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


</footer>



<!--页面点击小红心-->
<script type="text/javascript" src="/love.js"></script>
    </div>
    <script>
	var yiliaConfig = {
		mathjax: false,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		toc_hide_index: true,
		root: "/",
		innerArchive: true,
		showTags: false
	}
</script>

<script>!function(t){function n(e){if(r[e])return r[e].exports;var i=r[e]={exports:{},id:e,loaded:!1};return t[e].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}var r={};n.m=t,n.c=r,n.p="./",n(0)}([function(t,n,r){r(195),t.exports=r(191)},function(t,n,r){var e=r(3),i=r(52),o=r(27),u=r(28),c=r(53),f="prototype",a=function(t,n,r){var s,l,h,v,p=t&a.F,d=t&a.G,y=t&a.S,g=t&a.P,b=t&a.B,m=d?e:y?e[n]||(e[n]={}):(e[n]||{})[f],x=d?i:i[n]||(i[n]={}),w=x[f]||(x[f]={});d&&(r=n);for(s in r)l=!p&&m&&void 0!==m[s],h=(l?m:r)[s],v=b&&l?c(h,e):g&&"function"==typeof h?c(Function.call,h):h,m&&u(m,s,h,t&a.U),x[s]!=h&&o(x,s,v),g&&w[s]!=h&&(w[s]=h)};e.core=i,a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,t.exports=a},function(t,n,r){var e=r(6);t.exports=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}},function(t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n,r){var e=r(126)("wks"),i=r(76),o=r(3).Symbol,u="function"==typeof o;(t.exports=function(t){return e[t]||(e[t]=u&&o[t]||(u?o:i)("Symbol."+t))}).store=e},function(t,n){var r={}.hasOwnProperty;t.exports=function(t,n){return r.call(t,n)}},function(t,n,r){var e=r(94),i=r(33);t.exports=function(t){return e(i(t))}},function(t,n,r){t.exports=!r(4)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(2),i=r(167),o=r(50),u=Object.defineProperty;n.f=r(10)?Object.defineProperty:function(t,n,r){if(e(t),n=o(n,!0),e(r),i)try{return u(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){t.exports=!r(18)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(14),i=r(22);t.exports=r(12)?function(t,n,r){return e.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n,r){var e=r(20),i=r(58),o=r(42),u=Object.defineProperty;n.f=r(12)?Object.defineProperty:function(t,n,r){if(e(t),n=o(n,!0),e(r),i)try{return u(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){var e=r(40)("wks"),i=r(23),o=r(5).Symbol,u="function"==typeof o;(t.exports=function(t){return e[t]||(e[t]=u&&o[t]||(u?o:i)("Symbol."+t))}).store=e},function(t,n,r){var e=r(67),i=Math.min;t.exports=function(t){return t>0?i(e(t),9007199254740991):0}},function(t,n,r){var e=r(46);t.exports=function(t){return Object(e(t))}},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,r){var e=r(63),i=r(34);t.exports=Object.keys||function(t){return e(t,i)}},function(t,n,r){var e=r(21);t.exports=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var r=0,e=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+e).toString(36))}},function(t,n){var r={}.hasOwnProperty;t.exports=function(t,n){return r.call(t,n)}},function(t,n){var r=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n,r){var e=r(11),i=r(66);t.exports=r(10)?function(t,n,r){return e.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n,r){var e=r(3),i=r(27),o=r(24),u=r(76)("src"),c="toString",f=Function[c],a=(""+f).split(c);r(52).inspectSource=function(t){return f.call(t)},(t.exports=function(t,n,r,c){var f="function"==typeof r;f&&(o(r,"name")||i(r,"name",n)),t[n]!==r&&(f&&(o(r,u)||i(r,u,t[n]?""+t[n]:a.join(String(n)))),t===e?t[n]=r:c?t[n]?t[n]=r:i(t,n,r):(delete t[n],i(t,n,r)))})(Function.prototype,c,function(){return"function"==typeof this&&this[u]||f.call(this)})},function(t,n,r){var e=r(1),i=r(4),o=r(46),u=function(t,n,r,e){var i=String(o(t)),u="<"+n;return""!==r&&(u+=" "+r+'="'+String(e).replace(/"/g,"&quot;")+'"'),u+">"+i+"</"+n+">"};t.exports=function(t,n){var r={};r[t]=n(u),e(e.P+e.F*i(function(){var n=""[t]('"');return n!==n.toLowerCase()||n.split('"').length>3}),"String",r)}},function(t,n,r){var e=r(115),i=r(46);t.exports=function(t){return e(i(t))}},function(t,n,r){var e=r(116),i=r(66),o=r(30),u=r(50),c=r(24),f=r(167),a=Object.getOwnPropertyDescriptor;n.f=r(10)?a:function(t,n){if(t=o(t),n=u(n,!0),f)try{return a(t,n)}catch(t){}if(c(t,n))return i(!e.f.call(t,n),t[n])}},function(t,n,r){var e=r(24),i=r(17),o=r(145)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),e(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n){t.exports={}},function(t,n){t.exports=!0},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,r){var e=r(14).f,i=r(8),o=r(15)("toStringTag");t.exports=function(t,n,r){t&&!i(t=r?t:t.prototype,o)&&e(t,o,{configurable:!0,value:n})}},function(t,n,r){var e=r(40)("keys"),i=r(23);t.exports=function(t){return e[t]||(e[t]=i(t))}},function(t,n,r){var e=r(5),i="__core-js_shared__",o=e[i]||(e[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?e:r)(t)}},function(t,n,r){var e=r(21);t.exports=function(t,n){if(!e(t))return t;var r,i;if(n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!e(i=r.call(t)))return i;if(!n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,n,r){var e=r(5),i=r(25),o=r(36),u=r(44),c=r(14).f;t.exports=function(t){var n=i.Symbol||(i.Symbol=o?{}:e.Symbol||{});"_"==t.charAt(0)||t in n||c(n,t,{value:u.f(t)})}},function(t,n,r){n.f=r(15)},function(t,n){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n,r){var e=r(4);t.exports=function(t,n){return!!t&&e(function(){n?t.call(null,function(){},1):t.call(null)})}},function(t,n,r){var e=r(53),i=r(115),o=r(17),u=r(16),c=r(203);t.exports=function(t,n){var r=1==t,f=2==t,a=3==t,s=4==t,l=6==t,h=5==t||l,v=n||c;return function(n,c,p){for(var d,y,g=o(n),b=i(g),m=e(c,p,3),x=u(b.length),w=0,S=r?v(n,x):f?v(n,0):void 0;x>w;w++)if((h||w in b)&&(d=b[w],y=m(d,w,g),t))if(r)S[w]=y;else if(y)switch(t){case 3:return!0;case 5:return d;case 6:return w;case 2:S.push(d)}else if(s)return!1;return l?-1:a||s?s:S}}},function(t,n,r){var e=r(1),i=r(52),o=r(4);t.exports=function(t,n){var r=(i.Object||{})[t]||Object[t],u={};u[t]=n(r),e(e.S+e.F*o(function(){r(1)}),"Object",u)}},function(t,n,r){var e=r(6);t.exports=function(t,n){if(!e(t))return t;var r,i;if(n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!e(i=r.call(t)))return i;if(!n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,n,r){var e=r(5),i=r(25),o=r(91),u=r(13),c="prototype",f=function(t,n,r){var a,s,l,h=t&f.F,v=t&f.G,p=t&f.S,d=t&f.P,y=t&f.B,g=t&f.W,b=v?i:i[n]||(i[n]={}),m=b[c],x=v?e:p?e[n]:(e[n]||{})[c];v&&(r=n);for(a in r)(s=!h&&x&&void 0!==x[a])&&a in b||(l=s?x[a]:r[a],b[a]=v&&"function"!=typeof x[a]?r[a]:y&&s?o(l,e):g&&x[a]==l?function(t){var n=function(n,r,e){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,r)}return new t(n,r,e)}return t.apply(this,arguments)};return n[c]=t[c],n}(l):d&&"function"==typeof l?o(Function.call,l):l,d&&((b.virtual||(b.virtual={}))[a]=l,t&f.R&&m&&!m[a]&&u(m,a,l)))};f.F=1,f.G=2,f.S=4,f.P=8,f.B=16,f.W=32,f.U=64,f.R=128,t.exports=f},function(t,n){var r=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},function(t,n,r){var e=r(26);t.exports=function(t,n,r){if(e(t),void 0===n)return t;switch(r){case 1:return function(r){return t.call(n,r)};case 2:return function(r,e){return t.call(n,r,e)};case 3:return function(r,e,i){return t.call(n,r,e,i)}}return function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(183),i=r(1),o=r(126)("metadata"),u=o.store||(o.store=new(r(186))),c=function(t,n,r){var i=u.get(t);if(!i){if(!r)return;u.set(t,i=new e)}var o=i.get(n);if(!o){if(!r)return;i.set(n,o=new e)}return o},f=function(t,n,r){var e=c(n,r,!1);return void 0!==e&&e.has(t)},a=function(t,n,r){var e=c(n,r,!1);return void 0===e?void 0:e.get(t)},s=function(t,n,r,e){c(r,e,!0).set(t,n)},l=function(t,n){var r=c(t,n,!1),e=[];return r&&r.forEach(function(t,n){e.push(n)}),e},h=function(t){return void 0===t||"symbol"==typeof t?t:String(t)},v=function(t){i(i.S,"Reflect",t)};t.exports={store:u,map:c,has:f,get:a,set:s,keys:l,key:h,exp:v}},function(t,n,r){"use strict";if(r(10)){var e=r(69),i=r(3),o=r(4),u=r(1),c=r(127),f=r(152),a=r(53),s=r(68),l=r(66),h=r(27),v=r(73),p=r(67),d=r(16),y=r(75),g=r(50),b=r(24),m=r(180),x=r(114),w=r(6),S=r(17),_=r(137),O=r(70),E=r(32),P=r(71).f,j=r(154),F=r(76),M=r(7),A=r(48),N=r(117),T=r(146),I=r(155),k=r(80),L=r(123),R=r(74),C=r(130),D=r(160),U=r(11),W=r(31),G=U.f,B=W.f,V=i.RangeError,z=i.TypeError,q=i.Uint8Array,K="ArrayBuffer",J="Shared"+K,Y="BYTES_PER_ELEMENT",H="prototype",$=Array[H],X=f.ArrayBuffer,Q=f.DataView,Z=A(0),tt=A(2),nt=A(3),rt=A(4),et=A(5),it=A(6),ot=N(!0),ut=N(!1),ct=I.values,ft=I.keys,at=I.entries,st=$.lastIndexOf,lt=$.reduce,ht=$.reduceRight,vt=$.join,pt=$.sort,dt=$.slice,yt=$.toString,gt=$.toLocaleString,bt=M("iterator"),mt=M("toStringTag"),xt=F("typed_constructor"),wt=F("def_constructor"),St=c.CONSTR,_t=c.TYPED,Ot=c.VIEW,Et="Wrong length!",Pt=A(1,function(t,n){return Tt(T(t,t[wt]),n)}),jt=o(function(){return 1===new q(new Uint16Array([1]).buffer)[0]}),Ft=!!q&&!!q[H].set&&o(function(){new q(1).set({})}),Mt=function(t,n){if(void 0===t)throw z(Et);var r=+t,e=d(t);if(n&&!m(r,e))throw V(Et);return e},At=function(t,n){var r=p(t);if(r<0||r%n)throw V("Wrong offset!");return r},Nt=function(t){if(w(t)&&_t in t)return t;throw z(t+" is not a typed array!")},Tt=function(t,n){if(!(w(t)&&xt in t))throw z("It is not a typed array constructor!");return new t(n)},It=function(t,n){return kt(T(t,t[wt]),n)},kt=function(t,n){for(var r=0,e=n.length,i=Tt(t,e);e>r;)i[r]=n[r++];return i},Lt=function(t,n,r){G(t,n,{get:function(){return this._d[r]}})},Rt=function(t){var n,r,e,i,o,u,c=S(t),f=arguments.length,s=f>1?arguments[1]:void 0,l=void 0!==s,h=j(c);if(void 0!=h&&!_(h)){for(u=h.call(c),e=[],n=0;!(o=u.next()).done;n++)e.push(o.value);c=e}for(l&&f>2&&(s=a(s,arguments[2],2)),n=0,r=d(c.length),i=Tt(this,r);r>n;n++)i[n]=l?s(c[n],n):c[n];return i},Ct=function(){for(var t=0,n=arguments.length,r=Tt(this,n);n>t;)r[t]=arguments[t++];return r},Dt=!!q&&o(function(){gt.call(new q(1))}),Ut=function(){return gt.apply(Dt?dt.call(Nt(this)):Nt(this),arguments)},Wt={copyWithin:function(t,n){return D.call(Nt(this),t,n,arguments.length>2?arguments[2]:void 0)},every:function(t){return rt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return C.apply(Nt(this),arguments)},filter:function(t){return It(this,tt(Nt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return et(Nt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return it(Nt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){Z(Nt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return ut(Nt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return ot(Nt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return vt.apply(Nt(this),arguments)},lastIndexOf:function(t){return st.apply(Nt(this),arguments)},map:function(t){return Pt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return lt.apply(Nt(this),arguments)},reduceRight:function(t){return ht.apply(Nt(this),arguments)},reverse:function(){for(var t,n=this,r=Nt(n).length,e=Math.floor(r/2),i=0;i<e;)t=n[i],n[i++]=n[--r],n[r]=t;return n},some:function(t){return nt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return pt.call(Nt(this),t)},subarray:function(t,n){var r=Nt(this),e=r.length,i=y(t,e);return new(T(r,r[wt]))(r.buffer,r.byteOffset+i*r.BYTES_PER_ELEMENT,d((void 0===n?e:y(n,e))-i))}},Gt=function(t,n){return It(this,dt.call(Nt(this),t,n))},Bt=function(t){Nt(this);var n=At(arguments[1],1),r=this.length,e=S(t),i=d(e.length),o=0;if(i+n>r)throw V(Et);for(;o<i;)this[n+o]=e[o++]},Vt={entries:function(){return at.call(Nt(this))},keys:function(){return ft.call(Nt(this))},values:function(){return ct.call(Nt(this))}},zt=function(t,n){return w(t)&&t[_t]&&"symbol"!=typeof n&&n in t&&String(+n)==String(n)},qt=function(t,n){return zt(t,n=g(n,!0))?l(2,t[n]):B(t,n)},Kt=function(t,n,r){return!(zt(t,n=g(n,!0))&&w(r)&&b(r,"value"))||b(r,"get")||b(r,"set")||r.configurable||b(r,"writable")&&!r.writable||b(r,"enumerable")&&!r.enumerable?G(t,n,r):(t[n]=r.value,t)};St||(W.f=qt,U.f=Kt),u(u.S+u.F*!St,"Object",{getOwnPropertyDescriptor:qt,defineProperty:Kt}),o(function(){yt.call({})})&&(yt=gt=function(){return vt.call(this)});var Jt=v({},Wt);v(Jt,Vt),h(Jt,bt,Vt.values),v(Jt,{slice:Gt,set:Bt,constructor:function(){},toString:yt,toLocaleString:Ut}),Lt(Jt,"buffer","b"),Lt(Jt,"byteOffset","o"),Lt(Jt,"byteLength","l"),Lt(Jt,"length","e"),G(Jt,mt,{get:function(){return this[_t]}}),t.exports=function(t,n,r,f){f=!!f;var a=t+(f?"Clamped":"")+"Array",l="Uint8Array"!=a,v="get"+t,p="set"+t,y=i[a],g=y||{},b=y&&E(y),m=!y||!c.ABV,S={},_=y&&y[H],j=function(t,r){var e=t._d;return e.v[v](r*n+e.o,jt)},F=function(t,r,e){var i=t._d;f&&(e=(e=Math.round(e))<0?0:e>255?255:255&e),i.v[p](r*n+i.o,e,jt)},M=function(t,n){G(t,n,{get:function(){return j(this,n)},set:function(t){return F(this,n,t)},enumerable:!0})};m?(y=r(function(t,r,e,i){s(t,y,a,"_d");var o,u,c,f,l=0,v=0;if(w(r)){if(!(r instanceof X||(f=x(r))==K||f==J))return _t in r?kt(y,r):Rt.call(y,r);o=r,v=At(e,n);var p=r.byteLength;if(void 0===i){if(p%n)throw V(Et);if((u=p-v)<0)throw V(Et)}else if((u=d(i)*n)+v>p)throw V(Et);c=u/n}else c=Mt(r,!0),u=c*n,o=new X(u);for(h(t,"_d",{b:o,o:v,l:u,e:c,v:new Q(o)});l<c;)M(t,l++)}),_=y[H]=O(Jt),h(_,"constructor",y)):L(function(t){new y(null),new y(t)},!0)||(y=r(function(t,r,e,i){s(t,y,a);var o;return w(r)?r instanceof X||(o=x(r))==K||o==J?void 0!==i?new g(r,At(e,n),i):void 0!==e?new g(r,At(e,n)):new g(r):_t in r?kt(y,r):Rt.call(y,r):new g(Mt(r,l))}),Z(b!==Function.prototype?P(g).concat(P(b)):P(g),function(t){t in y||h(y,t,g[t])}),y[H]=_,e||(_.constructor=y));var A=_[bt],N=!!A&&("values"==A.name||void 0==A.name),T=Vt.values;h(y,xt,!0),h(_,_t,a),h(_,Ot,!0),h(_,wt,y),(f?new y(1)[mt]==a:mt in _)||G(_,mt,{get:function(){return a}}),S[a]=y,u(u.G+u.W+u.F*(y!=g),S),u(u.S,a,{BYTES_PER_ELEMENT:n,from:Rt,of:Ct}),Y in _||h(_,Y,n),u(u.P,a,Wt),R(a),u(u.P+u.F*Ft,a,{set:Bt}),u(u.P+u.F*!N,a,Vt),u(u.P+u.F*(_.toString!=yt),a,{toString:yt}),u(u.P+u.F*o(function(){new y(1).slice()}),a,{slice:Gt}),u(u.P+u.F*(o(function(){return[1,2].toLocaleString()!=new y([1,2]).toLocaleString()})||!o(function(){_.toLocaleString.call([1,2])})),a,{toLocaleString:Ut}),k[a]=N?A:T,e||N||h(_,bt,T)}}else t.exports=function(){}},function(t,n){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,n,r){var e=r(21),i=r(5).document,o=e(i)&&e(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,n,r){t.exports=!r(12)&&!r(18)(function(){return 7!=Object.defineProperty(r(57)("div"),"a",{get:function(){return 7}}).a})},function(t,n,r){"use strict";var e=r(36),i=r(51),o=r(64),u=r(13),c=r(8),f=r(35),a=r(96),s=r(38),l=r(103),h=r(15)("iterator"),v=!([].keys&&"next"in[].keys()),p="keys",d="values",y=function(){return this};t.exports=function(t,n,r,g,b,m,x){a(r,n,g);var w,S,_,O=function(t){if(!v&&t in F)return F[t];switch(t){case p:case d:return function(){return new r(this,t)}}return function(){return new r(this,t)}},E=n+" Iterator",P=b==d,j=!1,F=t.prototype,M=F[h]||F["@@iterator"]||b&&F[b],A=M||O(b),N=b?P?O("entries"):A:void 0,T="Array"==n?F.entries||M:M;if(T&&(_=l(T.call(new t)))!==Object.prototype&&(s(_,E,!0),e||c(_,h)||u(_,h,y)),P&&M&&M.name!==d&&(j=!0,A=function(){return M.call(this)}),e&&!x||!v&&!j&&F[h]||u(F,h,A),f[n]=A,f[E]=y,b)if(w={values:P?A:O(d),keys:m?A:O(p),entries:N},x)for(S in w)S in F||o(F,S,w[S]);else i(i.P+i.F*(v||j),n,w);return w}},function(t,n,r){var e=r(20),i=r(100),o=r(34),u=r(39)("IE_PROTO"),c=function(){},f="prototype",a=function(){var t,n=r(57)("iframe"),e=o.length;for(n.style.display="none",r(93).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),a=t.F;e--;)delete a[f][o[e]];return a()};t.exports=Object.create||function(t,n){var r;return null!==t?(c[f]=e(t),r=new c,c[f]=null,r[u]=t):r=a(),void 0===n?r:i(r,n)}},function(t,n,r){var e=r(63),i=r(34).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,i)}},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(8),i=r(9),o=r(90)(!1),u=r(39)("IE_PROTO");t.exports=function(t,n){var r,c=i(t),f=0,a=[];for(r in c)r!=u&&e(c,r)&&a.push(r);for(;n.length>f;)e(c,r=n[f++])&&(~o(a,r)||a.push(r));return a}},function(t,n,r){t.exports=r(13)},function(t,n,r){var e=r(76)("meta"),i=r(6),o=r(24),u=r(11).f,c=0,f=Object.isExtensible||function(){return!0},a=!r(4)(function(){return f(Object.preventExtensions({}))}),s=function(t){u(t,e,{value:{i:"O"+ ++c,w:{}}})},l=function(t,n){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,e)){if(!f(t))return"F";if(!n)return"E";s(t)}return t[e].i},h=function(t,n){if(!o(t,e)){if(!f(t))return!0;if(!n)return!1;s(t)}return t[e].w},v=function(t){return a&&p.NEED&&f(t)&&!o(t,e)&&s(t),t},p=t.exports={KEY:e,NEED:!1,fastKey:l,getWeak:h,onFreeze:v}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?e:r)(t)}},function(t,n){t.exports=function(t,n,r,e){if(!(t instanceof n)||void 0!==e&&e in t)throw TypeError(r+": incorrect invocation!");return t}},function(t,n){t.exports=!1},function(t,n,r){var e=r(2),i=r(173),o=r(133),u=r(145)("IE_PROTO"),c=function(){},f="prototype",a=function(){var t,n=r(132)("iframe"),e=o.length;for(n.style.display="none",r(135).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),a=t.F;e--;)delete a[f][o[e]];return a()};t.exports=Object.create||function(t,n){var r;return null!==t?(c[f]=e(t),r=new c,c[f]=null,r[u]=t):r=a(),void 0===n?r:i(r,n)}},function(t,n,r){var e=r(175),i=r(133).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,i)}},function(t,n,r){var e=r(175),i=r(133);t.exports=Object.keys||function(t){return e(t,i)}},function(t,n,r){var e=r(28);t.exports=function(t,n,r){for(var i in n)e(t,i,n[i],r);return t}},function(t,n,r){"use strict";var e=r(3),i=r(11),o=r(10),u=r(7)("species");t.exports=function(t){var n=e[t];o&&n&&!n[u]&&i.f(n,u,{configurable:!0,get:function(){return this}})}},function(t,n,r){var e=r(67),i=Math.max,o=Math.min;t.exports=function(t,n){return t=e(t),t<0?i(t+n,0):o(t,n)}},function(t,n){var r=0,e=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+e).toString(36))}},function(t,n,r){var e=r(33);t.exports=function(t){return Object(e(t))}},function(t,n,r){var e=r(7)("unscopables"),i=Array.prototype;void 0==i[e]&&r(27)(i,e,{}),t.exports=function(t){i[e][t]=!0}},function(t,n,r){var e=r(53),i=r(169),o=r(137),u=r(2),c=r(16),f=r(154),a={},s={},n=t.exports=function(t,n,r,l,h){var v,p,d,y,g=h?function(){return t}:f(t),b=e(r,l,n?2:1),m=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(o(g)){for(v=c(t.length);v>m;m++)if((y=n?b(u(p=t[m])[0],p[1]):b(t[m]))===a||y===s)return y}else for(d=g.call(t);!(p=d.next()).done;)if((y=i(d,b,p.value,n))===a||y===s)return y};n.BREAK=a,n.RETURN=s},function(t,n){t.exports={}},function(t,n,r){var e=r(11).f,i=r(24),o=r(7)("toStringTag");t.exports=function(t,n,r){t&&!i(t=r?t:t.prototype,o)&&e(t,o,{configurable:!0,value:n})}},function(t,n,r){var e=r(1),i=r(46),o=r(4),u=r(150),c="["+u+"]",f="​",a=RegExp("^"+c+c+"*"),s=RegExp(c+c+"*$"),l=function(t,n,r){var i={},c=o(function(){return!!u[t]()||f[t]()!=f}),a=i[t]=c?n(h):u[t];r&&(i[r]=a),e(e.P+e.F*c,"String",i)},h=l.trim=function(t,n){return t=String(i(t)),1&n&&(t=t.replace(a,"")),2&n&&(t=t.replace(s,"")),t};t.exports=l},function(t,n,r){t.exports={default:r(86),__esModule:!0}},function(t,n,r){t.exports={default:r(87),__esModule:!0}},function(t,n,r){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var i=r(84),o=e(i),u=r(83),c=e(u),f="function"==typeof c.default&&"symbol"==typeof o.default?function(t){return typeof t}:function(t){return t&&"function"==typeof c.default&&t.constructor===c.default&&t!==c.default.prototype?"symbol":typeof t};n.default="function"==typeof c.default&&"symbol"===f(o.default)?function(t){return void 0===t?"undefined":f(t)}:function(t){return t&&"function"==typeof c.default&&t.constructor===c.default&&t!==c.default.prototype?"symbol":void 0===t?"undefined":f(t)}},function(t,n,r){r(110),r(108),r(111),r(112),t.exports=r(25).Symbol},function(t,n,r){r(109),r(113),t.exports=r(44).f("iterator")},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n){t.exports=function(){}},function(t,n,r){var e=r(9),i=r(106),o=r(105);t.exports=function(t){return function(n,r,u){var c,f=e(n),a=i(f.length),s=o(u,a);if(t&&r!=r){for(;a>s;)if((c=f[s++])!=c)return!0}else for(;a>s;s++)if((t||s in f)&&f[s]===r)return t||s||0;return!t&&-1}}},function(t,n,r){var e=r(88);t.exports=function(t,n,r){if(e(t),void 0===n)return t;switch(r){case 1:return function(r){return t.call(n,r)};case 2:return function(r,e){return t.call(n,r,e)};case 3:return function(r,e,i){return t.call(n,r,e,i)}}return function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(19),i=r(62),o=r(37);t.exports=function(t){var n=e(t),r=i.f;if(r)for(var u,c=r(t),f=o.f,a=0;c.length>a;)f.call(t,u=c[a++])&&n.push(u);return n}},function(t,n,r){t.exports=r(5).document&&document.documentElement},function(t,n,r){var e=r(56);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==e(t)?t.split(""):Object(t)}},function(t,n,r){var e=r(56);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){"use strict";var e=r(60),i=r(22),o=r(38),u={};r(13)(u,r(15)("iterator"),function(){return this}),t.exports=function(t,n,r){t.prototype=e(u,{next:i(1,r)}),o(t,n+" Iterator")}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n,r){var e=r(19),i=r(9);t.exports=function(t,n){for(var r,o=i(t),u=e(o),c=u.length,f=0;c>f;)if(o[r=u[f++]]===n)return r}},function(t,n,r){var e=r(23)("meta"),i=r(21),o=r(8),u=r(14).f,c=0,f=Object.isExtensible||function(){return!0},a=!r(18)(function(){return f(Object.preventExtensions({}))}),s=function(t){u(t,e,{value:{i:"O"+ ++c,w:{}}})},l=function(t,n){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,e)){if(!f(t))return"F";if(!n)return"E";s(t)}return t[e].i},h=function(t,n){if(!o(t,e)){if(!f(t))return!0;if(!n)return!1;s(t)}return t[e].w},v=function(t){return a&&p.NEED&&f(t)&&!o(t,e)&&s(t),t},p=t.exports={KEY:e,NEED:!1,fastKey:l,getWeak:h,onFreeze:v}},function(t,n,r){var e=r(14),i=r(20),o=r(19);t.exports=r(12)?Object.defineProperties:function(t,n){i(t);for(var r,u=o(n),c=u.length,f=0;c>f;)e.f(t,r=u[f++],n[r]);return t}},function(t,n,r){var e=r(37),i=r(22),o=r(9),u=r(42),c=r(8),f=r(58),a=Object.getOwnPropertyDescriptor;n.f=r(12)?a:function(t,n){if(t=o(t),n=u(n,!0),f)try{return a(t,n)}catch(t){}if(c(t,n))return i(!e.f.call(t,n),t[n])}},function(t,n,r){var e=r(9),i=r(61).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==o.call(t)?c(t):i(e(t))}},function(t,n,r){var e=r(8),i=r(77),o=r(39)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),e(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n,r){var e=r(41),i=r(33);t.exports=function(t){return function(n,r){var o,u,c=String(i(n)),f=e(r),a=c.length;return f<0||f>=a?t?"":void 0:(o=c.charCodeAt(f),o<55296||o>56319||f+1===a||(u=c.charCodeAt(f+1))<56320||u>57343?t?c.charAt(f):o:t?c.slice(f,f+2):u-56320+(o-55296<<10)+65536)}}},function(t,n,r){var e=r(41),i=Math.max,o=Math.min;t.exports=function(t,n){return t=e(t),t<0?i(t+n,0):o(t,n)}},function(t,n,r){var e=r(41),i=Math.min;t.exports=function(t){return t>0?i(e(t),9007199254740991):0}},function(t,n,r){"use strict";var e=r(89),i=r(97),o=r(35),u=r(9);t.exports=r(59)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==n?i(0,r):"values"==n?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},function(t,n){},function(t,n,r){"use strict";var e=r(104)(!0);r(59)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,r=this._i;return r>=n.length?{value:void 0,done:!0}:(t=e(n,r),this._i+=t.length,{value:t,done:!1})})},function(t,n,r){"use strict";var e=r(5),i=r(8),o=r(12),u=r(51),c=r(64),f=r(99).KEY,a=r(18),s=r(40),l=r(38),h=r(23),v=r(15),p=r(44),d=r(43),y=r(98),g=r(92),b=r(95),m=r(20),x=r(9),w=r(42),S=r(22),_=r(60),O=r(102),E=r(101),P=r(14),j=r(19),F=E.f,M=P.f,A=O.f,N=e.Symbol,T=e.JSON,I=T&&T.stringify,k="prototype",L=v("_hidden"),R=v("toPrimitive"),C={}.propertyIsEnumerable,D=s("symbol-registry"),U=s("symbols"),W=s("op-symbols"),G=Object[k],B="function"==typeof N,V=e.QObject,z=!V||!V[k]||!V[k].findChild,q=o&&a(function(){return 7!=_(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(t,n,r){var e=F(G,n);e&&delete G[n],M(t,n,r),e&&t!==G&&M(G,n,e)}:M,K=function(t){var n=U[t]=_(N[k]);return n._k=t,n},J=B&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},Y=function(t,n,r){return t===G&&Y(W,n,r),m(t),n=w(n,!0),m(r),i(U,n)?(r.enumerable?(i(t,L)&&t[L][n]&&(t[L][n]=!1),r=_(r,{enumerable:S(0,!1)})):(i(t,L)||M(t,L,S(1,{})),t[L][n]=!0),q(t,n,r)):M(t,n,r)},H=function(t,n){m(t);for(var r,e=g(n=x(n)),i=0,o=e.length;o>i;)Y(t,r=e[i++],n[r]);return t},$=function(t,n){return void 0===n?_(t):H(_(t),n)},X=function(t){var n=C.call(this,t=w(t,!0));return!(this===G&&i(U,t)&&!i(W,t))&&(!(n||!i(this,t)||!i(U,t)||i(this,L)&&this[L][t])||n)},Q=function(t,n){if(t=x(t),n=w(n,!0),t!==G||!i(U,n)||i(W,n)){var r=F(t,n);return!r||!i(U,n)||i(t,L)&&t[L][n]||(r.enumerable=!0),r}},Z=function(t){for(var n,r=A(x(t)),e=[],o=0;r.length>o;)i(U,n=r[o++])||n==L||n==f||e.push(n);return e},tt=function(t){for(var n,r=t===G,e=A(r?W:x(t)),o=[],u=0;e.length>u;)!i(U,n=e[u++])||r&&!i(G,n)||o.push(U[n]);return o};B||(N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),n=function(r){this===G&&n.call(W,r),i(this,L)&&i(this[L],t)&&(this[L][t]=!1),q(this,t,S(1,r))};return o&&z&&q(G,t,{configurable:!0,set:n}),K(t)},c(N[k],"toString",function(){return this._k}),E.f=Q,P.f=Y,r(61).f=O.f=Z,r(37).f=X,r(62).f=tt,o&&!r(36)&&c(G,"propertyIsEnumerable",X,!0),p.f=function(t){return K(v(t))}),u(u.G+u.W+u.F*!B,{Symbol:N});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;nt.length>rt;)v(nt[rt++]);for(var nt=j(v.store),rt=0;nt.length>rt;)d(nt[rt++]);u(u.S+u.F*!B,"Symbol",{for:function(t){return i(D,t+="")?D[t]:D[t]=N(t)},keyFor:function(t){if(J(t))return y(D,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),u(u.S+u.F*!B,"Object",{create:$,defineProperty:Y,defineProperties:H,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),T&&u(u.S+u.F*(!B||a(function(){var t=N();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!J(t)){for(var n,r,e=[t],i=1;arguments.length>i;)e.push(arguments[i++]);return n=e[1],"function"==typeof n&&(r=n),!r&&b(n)||(n=function(t,n){if(r&&(n=r.call(this,t,n)),!J(n))return n}),e[1]=n,I.apply(T,e)}}}),N[k][R]||r(13)(N[k],R,N[k].valueOf),l(N,"Symbol"),l(Math,"Math",!0),l(e.JSON,"JSON",!0)},function(t,n,r){r(43)("asyncIterator")},function(t,n,r){r(43)("observable")},function(t,n,r){r(107);for(var e=r(5),i=r(13),o=r(35),u=r(15)("toStringTag"),c=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],f=0;f<5;f++){var a=c[f],s=e[a],l=s&&s.prototype;l&&!l[u]&&i(l,u,a),o[a]=o.Array}},function(t,n,r){var e=r(45),i=r(7)("toStringTag"),o="Arguments"==e(function(){return arguments}()),u=function(t,n){try{return t[n]}catch(t){}};t.exports=function(t){var n,r,c;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=u(n=Object(t),i))?r:o?e(n):"Object"==(c=e(n))&&"function"==typeof n.callee?"Arguments":c}},function(t,n,r){var e=r(45);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==e(t)?t.split(""):Object(t)}},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,r){var e=r(30),i=r(16),o=r(75);t.exports=function(t){return function(n,r,u){var c,f=e(n),a=i(f.length),s=o(u,a);if(t&&r!=r){for(;a>s;)if((c=f[s++])!=c)return!0}else for(;a>s;s++)if((t||s in f)&&f[s]===r)return t||s||0;return!t&&-1}}},function(t,n,r){"use strict";var e=r(3),i=r(1),o=r(28),u=r(73),c=r(65),f=r(79),a=r(68),s=r(6),l=r(4),h=r(123),v=r(81),p=r(136);t.exports=function(t,n,r,d,y,g){var b=e[t],m=b,x=y?"set":"add",w=m&&m.prototype,S={},_=function(t){var n=w[t];o(w,t,"delete"==t?function(t){return!(g&&!s(t))&&n.call(this,0===t?0:t)}:"has"==t?function(t){return!(g&&!s(t))&&n.call(this,0===t?0:t)}:"get"==t?function(t){return g&&!s(t)?void 0:n.call(this,0===t?0:t)}:"add"==t?function(t){return n.call(this,0===t?0:t),this}:function(t,r){return n.call(this,0===t?0:t,r),this})};if("function"==typeof m&&(g||w.forEach&&!l(function(){(new m).entries().next()}))){var O=new m,E=O[x](g?{}:-0,1)!=O,P=l(function(){O.has(1)}),j=h(function(t){new m(t)}),F=!g&&l(function(){for(var t=new m,n=5;n--;)t[x](n,n);return!t.has(-0)});j||(m=n(function(n,r){a(n,m,t);var e=p(new b,n,m);return void 0!=r&&f(r,y,e[x],e),e}),m.prototype=w,w.constructor=m),(P||F)&&(_("delete"),_("has"),y&&_("get")),(F||E)&&_(x),g&&w.clear&&delete w.clear}else m=d.getConstructor(n,t,y,x),u(m.prototype,r),c.NEED=!0;return v(m,t),S[t]=m,i(i.G+i.W+i.F*(m!=b),S),g||d.setStrong(m,t,y),m}},function(t,n,r){"use strict";var e=r(27),i=r(28),o=r(4),u=r(46),c=r(7);t.exports=function(t,n,r){var f=c(t),a=r(u,f,""[t]),s=a[0],l=a[1];o(function(){var n={};return n[f]=function(){return 7},7!=""[t](n)})&&(i(String.prototype,t,s),e(RegExp.prototype,f,2==n?function(t,n){return l.call(t,this,n)}:function(t){return l.call(t,this)}))}
},function(t,n,r){"use strict";var e=r(2);t.exports=function(){var t=e(this),n="";return t.global&&(n+="g"),t.ignoreCase&&(n+="i"),t.multiline&&(n+="m"),t.unicode&&(n+="u"),t.sticky&&(n+="y"),n}},function(t,n){t.exports=function(t,n,r){var e=void 0===r;switch(n.length){case 0:return e?t():t.call(r);case 1:return e?t(n[0]):t.call(r,n[0]);case 2:return e?t(n[0],n[1]):t.call(r,n[0],n[1]);case 3:return e?t(n[0],n[1],n[2]):t.call(r,n[0],n[1],n[2]);case 4:return e?t(n[0],n[1],n[2],n[3]):t.call(r,n[0],n[1],n[2],n[3])}return t.apply(r,n)}},function(t,n,r){var e=r(6),i=r(45),o=r(7)("match");t.exports=function(t){var n;return e(t)&&(void 0!==(n=t[o])?!!n:"RegExp"==i(t))}},function(t,n,r){var e=r(7)("iterator"),i=!1;try{var o=[7][e]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,n){if(!n&&!i)return!1;var r=!1;try{var o=[7],u=o[e]();u.next=function(){return{done:r=!0}},o[e]=function(){return u},t(o)}catch(t){}return r}},function(t,n,r){t.exports=r(69)||!r(4)(function(){var t=Math.random();__defineSetter__.call(null,t,function(){}),delete r(3)[t]})},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(3),i="__core-js_shared__",o=e[i]||(e[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,n,r){for(var e,i=r(3),o=r(27),u=r(76),c=u("typed_array"),f=u("view"),a=!(!i.ArrayBuffer||!i.DataView),s=a,l=0,h="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");l<9;)(e=i[h[l++]])?(o(e.prototype,c,!0),o(e.prototype,f,!0)):s=!1;t.exports={ABV:a,CONSTR:s,TYPED:c,VIEW:f}},function(t,n){"use strict";var r={versions:function(){var t=window.navigator.userAgent;return{trident:t.indexOf("Trident")>-1,presto:t.indexOf("Presto")>-1,webKit:t.indexOf("AppleWebKit")>-1,gecko:t.indexOf("Gecko")>-1&&-1==t.indexOf("KHTML"),mobile:!!t.match(/AppleWebKit.*Mobile.*/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Linux")>-1,iPhone:t.indexOf("iPhone")>-1||t.indexOf("Mac")>-1,iPad:t.indexOf("iPad")>-1,webApp:-1==t.indexOf("Safari"),weixin:-1==t.indexOf("MicroMessenger")}}()};t.exports=r},function(t,n,r){"use strict";var e=r(85),i=function(t){return t&&t.__esModule?t:{default:t}}(e),o=function(){function t(t,n,e){return n||e?String.fromCharCode(n||e):r[t]||t}function n(t){return e[t]}var r={"&quot;":'"',"&lt;":"<","&gt;":">","&amp;":"&","&nbsp;":" "},e={};for(var u in r)e[r[u]]=u;return r["&apos;"]="'",e["'"]="&#39;",{encode:function(t){return t?(""+t).replace(/['<> "&]/g,n).replace(/\r?\n/g,"<br/>").replace(/\s/g,"&nbsp;"):""},decode:function(n){return n?(""+n).replace(/<br\s*\/?>/gi,"\n").replace(/&quot;|&lt;|&gt;|&amp;|&nbsp;|&apos;|&#(\d+);|&#(\d+)/g,t).replace(/\u00a0/g," "):""},encodeBase16:function(t){if(!t)return t;t+="";for(var n=[],r=0,e=t.length;e>r;r++)n.push(t.charCodeAt(r).toString(16).toUpperCase());return n.join("")},encodeBase16forJSON:function(t){if(!t)return t;t=t.replace(/[\u4E00-\u9FBF]/gi,function(t){return escape(t).replace("%u","\\u")});for(var n=[],r=0,e=t.length;e>r;r++)n.push(t.charCodeAt(r).toString(16).toUpperCase());return n.join("")},decodeBase16:function(t){if(!t)return t;t+="";for(var n=[],r=0,e=t.length;e>r;r+=2)n.push(String.fromCharCode("0x"+t.slice(r,r+2)));return n.join("")},encodeObject:function(t){if(t instanceof Array)for(var n=0,r=t.length;r>n;n++)t[n]=o.encodeObject(t[n]);else if("object"==(void 0===t?"undefined":(0,i.default)(t)))for(var e in t)t[e]=o.encodeObject(t[e]);else if("string"==typeof t)return o.encode(t);return t},loadScript:function(t){var n=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(n),n.setAttribute("src",t)},addLoadEvent:function(t){var n=window.onload;"function"!=typeof window.onload?window.onload=t:window.onload=function(){n(),t()}}}}();t.exports=o},function(t,n,r){"use strict";var e=r(17),i=r(75),o=r(16);t.exports=function(t){for(var n=e(this),r=o(n.length),u=arguments.length,c=i(u>1?arguments[1]:void 0,r),f=u>2?arguments[2]:void 0,a=void 0===f?r:i(f,r);a>c;)n[c++]=t;return n}},function(t,n,r){"use strict";var e=r(11),i=r(66);t.exports=function(t,n,r){n in t?e.f(t,n,i(0,r)):t[n]=r}},function(t,n,r){var e=r(6),i=r(3).document,o=e(i)&&e(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n,r){var e=r(7)("match");t.exports=function(t){var n=/./;try{"/./"[t](n)}catch(r){try{return n[e]=!1,!"/./"[t](n)}catch(t){}}return!0}},function(t,n,r){t.exports=r(3).document&&document.documentElement},function(t,n,r){var e=r(6),i=r(144).set;t.exports=function(t,n,r){var o,u=n.constructor;return u!==r&&"function"==typeof u&&(o=u.prototype)!==r.prototype&&e(o)&&i&&i(t,o),t}},function(t,n,r){var e=r(80),i=r(7)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(e.Array===t||o[i]===t)}},function(t,n,r){var e=r(45);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){"use strict";var e=r(70),i=r(66),o=r(81),u={};r(27)(u,r(7)("iterator"),function(){return this}),t.exports=function(t,n,r){t.prototype=e(u,{next:i(1,r)}),o(t,n+" Iterator")}},function(t,n,r){"use strict";var e=r(69),i=r(1),o=r(28),u=r(27),c=r(24),f=r(80),a=r(139),s=r(81),l=r(32),h=r(7)("iterator"),v=!([].keys&&"next"in[].keys()),p="keys",d="values",y=function(){return this};t.exports=function(t,n,r,g,b,m,x){a(r,n,g);var w,S,_,O=function(t){if(!v&&t in F)return F[t];switch(t){case p:case d:return function(){return new r(this,t)}}return function(){return new r(this,t)}},E=n+" Iterator",P=b==d,j=!1,F=t.prototype,M=F[h]||F["@@iterator"]||b&&F[b],A=M||O(b),N=b?P?O("entries"):A:void 0,T="Array"==n?F.entries||M:M;if(T&&(_=l(T.call(new t)))!==Object.prototype&&(s(_,E,!0),e||c(_,h)||u(_,h,y)),P&&M&&M.name!==d&&(j=!0,A=function(){return M.call(this)}),e&&!x||!v&&!j&&F[h]||u(F,h,A),f[n]=A,f[E]=y,b)if(w={values:P?A:O(d),keys:m?A:O(p),entries:N},x)for(S in w)S in F||o(F,S,w[S]);else i(i.P+i.F*(v||j),n,w);return w}},function(t,n){var r=Math.expm1;t.exports=!r||r(10)>22025.465794806718||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:r},function(t,n){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,n,r){var e=r(3),i=r(151).set,o=e.MutationObserver||e.WebKitMutationObserver,u=e.process,c=e.Promise,f="process"==r(45)(u);t.exports=function(){var t,n,r,a=function(){var e,i;for(f&&(e=u.domain)&&e.exit();t;){i=t.fn,t=t.next;try{i()}catch(e){throw t?r():n=void 0,e}}n=void 0,e&&e.enter()};if(f)r=function(){u.nextTick(a)};else if(o){var s=!0,l=document.createTextNode("");new o(a).observe(l,{characterData:!0}),r=function(){l.data=s=!s}}else if(c&&c.resolve){var h=c.resolve();r=function(){h.then(a)}}else r=function(){i.call(e,a)};return function(e){var i={fn:e,next:void 0};n&&(n.next=i),t||(t=i,r()),n=i}}},function(t,n,r){var e=r(6),i=r(2),o=function(t,n){if(i(t),!e(n)&&null!==n)throw TypeError(n+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,n,e){try{e=r(53)(Function.call,r(31).f(Object.prototype,"__proto__").set,2),e(t,[]),n=!(t instanceof Array)}catch(t){n=!0}return function(t,r){return o(t,r),n?t.__proto__=r:e(t,r),t}}({},!1):void 0),check:o}},function(t,n,r){var e=r(126)("keys"),i=r(76);t.exports=function(t){return e[t]||(e[t]=i(t))}},function(t,n,r){var e=r(2),i=r(26),o=r(7)("species");t.exports=function(t,n){var r,u=e(t).constructor;return void 0===u||void 0==(r=e(u)[o])?n:i(r)}},function(t,n,r){var e=r(67),i=r(46);t.exports=function(t){return function(n,r){var o,u,c=String(i(n)),f=e(r),a=c.length;return f<0||f>=a?t?"":void 0:(o=c.charCodeAt(f),o<55296||o>56319||f+1===a||(u=c.charCodeAt(f+1))<56320||u>57343?t?c.charAt(f):o:t?c.slice(f,f+2):u-56320+(o-55296<<10)+65536)}}},function(t,n,r){var e=r(122),i=r(46);t.exports=function(t,n,r){if(e(n))throw TypeError("String#"+r+" doesn't accept regex!");return String(i(t))}},function(t,n,r){"use strict";var e=r(67),i=r(46);t.exports=function(t){var n=String(i(this)),r="",o=e(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(n+=n))1&o&&(r+=n);return r}},function(t,n){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,n,r){var e,i,o,u=r(53),c=r(121),f=r(135),a=r(132),s=r(3),l=s.process,h=s.setImmediate,v=s.clearImmediate,p=s.MessageChannel,d=0,y={},g="onreadystatechange",b=function(){var t=+this;if(y.hasOwnProperty(t)){var n=y[t];delete y[t],n()}},m=function(t){b.call(t.data)};h&&v||(h=function(t){for(var n=[],r=1;arguments.length>r;)n.push(arguments[r++]);return y[++d]=function(){c("function"==typeof t?t:Function(t),n)},e(d),d},v=function(t){delete y[t]},"process"==r(45)(l)?e=function(t){l.nextTick(u(b,t,1))}:p?(i=new p,o=i.port2,i.port1.onmessage=m,e=u(o.postMessage,o,1)):s.addEventListener&&"function"==typeof postMessage&&!s.importScripts?(e=function(t){s.postMessage(t+"","*")},s.addEventListener("message",m,!1)):e=g in a("script")?function(t){f.appendChild(a("script"))[g]=function(){f.removeChild(this),b.call(t)}}:function(t){setTimeout(u(b,t,1),0)}),t.exports={set:h,clear:v}},function(t,n,r){"use strict";var e=r(3),i=r(10),o=r(69),u=r(127),c=r(27),f=r(73),a=r(4),s=r(68),l=r(67),h=r(16),v=r(71).f,p=r(11).f,d=r(130),y=r(81),g="ArrayBuffer",b="DataView",m="prototype",x="Wrong length!",w="Wrong index!",S=e[g],_=e[b],O=e.Math,E=e.RangeError,P=e.Infinity,j=S,F=O.abs,M=O.pow,A=O.floor,N=O.log,T=O.LN2,I="buffer",k="byteLength",L="byteOffset",R=i?"_b":I,C=i?"_l":k,D=i?"_o":L,U=function(t,n,r){var e,i,o,u=Array(r),c=8*r-n-1,f=(1<<c)-1,a=f>>1,s=23===n?M(2,-24)-M(2,-77):0,l=0,h=t<0||0===t&&1/t<0?1:0;for(t=F(t),t!=t||t===P?(i=t!=t?1:0,e=f):(e=A(N(t)/T),t*(o=M(2,-e))<1&&(e--,o*=2),t+=e+a>=1?s/o:s*M(2,1-a),t*o>=2&&(e++,o/=2),e+a>=f?(i=0,e=f):e+a>=1?(i=(t*o-1)*M(2,n),e+=a):(i=t*M(2,a-1)*M(2,n),e=0));n>=8;u[l++]=255&i,i/=256,n-=8);for(e=e<<n|i,c+=n;c>0;u[l++]=255&e,e/=256,c-=8);return u[--l]|=128*h,u},W=function(t,n,r){var e,i=8*r-n-1,o=(1<<i)-1,u=o>>1,c=i-7,f=r-1,a=t[f--],s=127&a;for(a>>=7;c>0;s=256*s+t[f],f--,c-=8);for(e=s&(1<<-c)-1,s>>=-c,c+=n;c>0;e=256*e+t[f],f--,c-=8);if(0===s)s=1-u;else{if(s===o)return e?NaN:a?-P:P;e+=M(2,n),s-=u}return(a?-1:1)*e*M(2,s-n)},G=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},B=function(t){return[255&t]},V=function(t){return[255&t,t>>8&255]},z=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},q=function(t){return U(t,52,8)},K=function(t){return U(t,23,4)},J=function(t,n,r){p(t[m],n,{get:function(){return this[r]}})},Y=function(t,n,r,e){var i=+r,o=l(i);if(i!=o||o<0||o+n>t[C])throw E(w);var u=t[R]._b,c=o+t[D],f=u.slice(c,c+n);return e?f:f.reverse()},H=function(t,n,r,e,i,o){var u=+r,c=l(u);if(u!=c||c<0||c+n>t[C])throw E(w);for(var f=t[R]._b,a=c+t[D],s=e(+i),h=0;h<n;h++)f[a+h]=s[o?h:n-h-1]},$=function(t,n){s(t,S,g);var r=+n,e=h(r);if(r!=e)throw E(x);return e};if(u.ABV){if(!a(function(){new S})||!a(function(){new S(.5)})){S=function(t){return new j($(this,t))};for(var X,Q=S[m]=j[m],Z=v(j),tt=0;Z.length>tt;)(X=Z[tt++])in S||c(S,X,j[X]);o||(Q.constructor=S)}var nt=new _(new S(2)),rt=_[m].setInt8;nt.setInt8(0,2147483648),nt.setInt8(1,2147483649),!nt.getInt8(0)&&nt.getInt8(1)||f(_[m],{setInt8:function(t,n){rt.call(this,t,n<<24>>24)},setUint8:function(t,n){rt.call(this,t,n<<24>>24)}},!0)}else S=function(t){var n=$(this,t);this._b=d.call(Array(n),0),this[C]=n},_=function(t,n,r){s(this,_,b),s(t,S,b);var e=t[C],i=l(n);if(i<0||i>e)throw E("Wrong offset!");if(r=void 0===r?e-i:h(r),i+r>e)throw E(x);this[R]=t,this[D]=i,this[C]=r},i&&(J(S,k,"_l"),J(_,I,"_b"),J(_,k,"_l"),J(_,L,"_o")),f(_[m],{getInt8:function(t){return Y(this,1,t)[0]<<24>>24},getUint8:function(t){return Y(this,1,t)[0]},getInt16:function(t){var n=Y(this,2,t,arguments[1]);return(n[1]<<8|n[0])<<16>>16},getUint16:function(t){var n=Y(this,2,t,arguments[1]);return n[1]<<8|n[0]},getInt32:function(t){return G(Y(this,4,t,arguments[1]))},getUint32:function(t){return G(Y(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return W(Y(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return W(Y(this,8,t,arguments[1]),52,8)},setInt8:function(t,n){H(this,1,t,B,n)},setUint8:function(t,n){H(this,1,t,B,n)},setInt16:function(t,n){H(this,2,t,V,n,arguments[2])},setUint16:function(t,n){H(this,2,t,V,n,arguments[2])},setInt32:function(t,n){H(this,4,t,z,n,arguments[2])},setUint32:function(t,n){H(this,4,t,z,n,arguments[2])},setFloat32:function(t,n){H(this,4,t,K,n,arguments[2])},setFloat64:function(t,n){H(this,8,t,q,n,arguments[2])}});y(S,g),y(_,b),c(_[m],u.VIEW,!0),n[g]=S,n[b]=_},function(t,n,r){var e=r(3),i=r(52),o=r(69),u=r(182),c=r(11).f;t.exports=function(t){var n=i.Symbol||(i.Symbol=o?{}:e.Symbol||{});"_"==t.charAt(0)||t in n||c(n,t,{value:u.f(t)})}},function(t,n,r){var e=r(114),i=r(7)("iterator"),o=r(80);t.exports=r(52).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[e(t)]}},function(t,n,r){"use strict";var e=r(78),i=r(170),o=r(80),u=r(30);t.exports=r(140)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==n?i(0,r):"values"==n?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},function(t,n){function r(t,n){t.classList?t.classList.add(n):t.className+=" "+n}t.exports=r},function(t,n){function r(t,n){if(t.classList)t.classList.remove(n);else{var r=new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi");t.className=t.className.replace(r," ")}}t.exports=r},function(t,n){function r(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function i(t){if(s===setTimeout)return setTimeout(t,0);if((s===r||!s)&&setTimeout)return s=setTimeout,setTimeout(t,0);try{return s(t,0)}catch(n){try{return s.call(null,t,0)}catch(n){return s.call(this,t,0)}}}function o(t){if(l===clearTimeout)return clearTimeout(t);if((l===e||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(n){try{return l.call(null,t)}catch(n){return l.call(this,t)}}}function u(){d&&v&&(d=!1,v.length?p=v.concat(p):y=-1,p.length&&c())}function c(){if(!d){var t=i(u);d=!0;for(var n=p.length;n;){for(v=p,p=[];++y<n;)v&&v[y].run();y=-1,n=p.length}v=null,d=!1,o(t)}}function f(t,n){this.fun=t,this.array=n}function a(){}var s,l,h=t.exports={};!function(){try{s="function"==typeof setTimeout?setTimeout:r}catch(t){s=r}try{l="function"==typeof clearTimeout?clearTimeout:e}catch(t){l=e}}();var v,p=[],d=!1,y=-1;h.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)n[r-1]=arguments[r];p.push(new f(t,n)),1!==p.length||d||i(c)},f.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=a,h.addListener=a,h.once=a,h.off=a,h.removeListener=a,h.removeAllListeners=a,h.emit=a,h.prependListener=a,h.prependOnceListener=a,h.listeners=function(t){return[]},h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(t,n,r){var e=r(45);t.exports=function(t,n){if("number"!=typeof t&&"Number"!=e(t))throw TypeError(n);return+t}},function(t,n,r){"use strict";var e=r(17),i=r(75),o=r(16);t.exports=[].copyWithin||function(t,n){var r=e(this),u=o(r.length),c=i(t,u),f=i(n,u),a=arguments.length>2?arguments[2]:void 0,s=Math.min((void 0===a?u:i(a,u))-f,u-c),l=1;for(f<c&&c<f+s&&(l=-1,f+=s-1,c+=s-1);s-- >0;)f in r?r[c]=r[f]:delete r[c],c+=l,f+=l;return r}},function(t,n,r){var e=r(79);t.exports=function(t,n){var r=[];return e(t,!1,r.push,r,n),r}},function(t,n,r){var e=r(26),i=r(17),o=r(115),u=r(16);t.exports=function(t,n,r,c,f){e(n);var a=i(t),s=o(a),l=u(a.length),h=f?l-1:0,v=f?-1:1;if(r<2)for(;;){if(h in s){c=s[h],h+=v;break}if(h+=v,f?h<0:l<=h)throw TypeError("Reduce of empty array with no initial value")}for(;f?h>=0:l>h;h+=v)h in s&&(c=n(c,s[h],h,a));return c}},function(t,n,r){"use strict";var e=r(26),i=r(6),o=r(121),u=[].slice,c={},f=function(t,n,r){if(!(n in c)){for(var e=[],i=0;i<n;i++)e[i]="a["+i+"]";c[n]=Function("F,a","return new F("+e.join(",")+")")}return c[n](t,r)};t.exports=Function.bind||function(t){var n=e(this),r=u.call(arguments,1),c=function(){var e=r.concat(u.call(arguments));return this instanceof c?f(n,e.length,e):o(n,e,t)};return i(n.prototype)&&(c.prototype=n.prototype),c}},function(t,n,r){"use strict";var e=r(11).f,i=r(70),o=r(73),u=r(53),c=r(68),f=r(46),a=r(79),s=r(140),l=r(170),h=r(74),v=r(10),p=r(65).fastKey,d=v?"_s":"size",y=function(t,n){var r,e=p(n);if("F"!==e)return t._i[e];for(r=t._f;r;r=r.n)if(r.k==n)return r};t.exports={getConstructor:function(t,n,r,s){var l=t(function(t,e){c(t,l,n,"_i"),t._i=i(null),t._f=void 0,t._l=void 0,t[d]=0,void 0!=e&&a(e,r,t[s],t)});return o(l.prototype,{clear:function(){for(var t=this,n=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];t._f=t._l=void 0,t[d]=0},delete:function(t){var n=this,r=y(n,t);if(r){var e=r.n,i=r.p;delete n._i[r.i],r.r=!0,i&&(i.n=e),e&&(e.p=i),n._f==r&&(n._f=e),n._l==r&&(n._l=i),n[d]--}return!!r},forEach:function(t){c(this,l,"forEach");for(var n,r=u(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!y(this,t)}}),v&&e(l.prototype,"size",{get:function(){return f(this[d])}}),l},def:function(t,n,r){var e,i,o=y(t,n);return o?o.v=r:(t._l=o={i:i=p(n,!0),k:n,v:r,p:e=t._l,n:void 0,r:!1},t._f||(t._f=o),e&&(e.n=o),t[d]++,"F"!==i&&(t._i[i]=o)),t},getEntry:y,setStrong:function(t,n,r){s(t,n,function(t,n){this._t=t,this._k=n,this._l=void 0},function(){for(var t=this,n=t._k,r=t._l;r&&r.r;)r=r.p;return t._t&&(t._l=r=r?r.n:t._t._f)?"keys"==n?l(0,r.k):"values"==n?l(0,r.v):l(0,[r.k,r.v]):(t._t=void 0,l(1))},r?"entries":"values",!r,!0),h(n)}}},function(t,n,r){var e=r(114),i=r(161);t.exports=function(t){return function(){if(e(this)!=t)throw TypeError(t+"#toJSON isn't generic");return i(this)}}},function(t,n,r){"use strict";var e=r(73),i=r(65).getWeak,o=r(2),u=r(6),c=r(68),f=r(79),a=r(48),s=r(24),l=a(5),h=a(6),v=0,p=function(t){return t._l||(t._l=new d)},d=function(){this.a=[]},y=function(t,n){return l(t.a,function(t){return t[0]===n})};d.prototype={get:function(t){var n=y(this,t);if(n)return n[1]},has:function(t){return!!y(this,t)},set:function(t,n){var r=y(this,t);r?r[1]=n:this.a.push([t,n])},delete:function(t){var n=h(this.a,function(n){return n[0]===t});return~n&&this.a.splice(n,1),!!~n}},t.exports={getConstructor:function(t,n,r,o){var a=t(function(t,e){c(t,a,n,"_i"),t._i=v++,t._l=void 0,void 0!=e&&f(e,r,t[o],t)});return e(a.prototype,{delete:function(t){if(!u(t))return!1;var n=i(t);return!0===n?p(this).delete(t):n&&s(n,this._i)&&delete n[this._i]},has:function(t){if(!u(t))return!1;var n=i(t);return!0===n?p(this).has(t):n&&s(n,this._i)}}),a},def:function(t,n,r){var e=i(o(n),!0);return!0===e?p(t).set(n,r):e[t._i]=r,t},ufstore:p}},function(t,n,r){t.exports=!r(10)&&!r(4)(function(){return 7!=Object.defineProperty(r(132)("div"),"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(6),i=Math.floor;t.exports=function(t){return!e(t)&&isFinite(t)&&i(t)===t}},function(t,n,r){var e=r(2);t.exports=function(t,n,r,i){try{return i?n(e(r)[0],r[1]):n(r)}catch(n){var o=t.return;throw void 0!==o&&e(o.call(t)),n}}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,n,r){"use strict";var e=r(72),i=r(125),o=r(116),u=r(17),c=r(115),f=Object.assign;t.exports=!f||r(4)(function(){var t={},n={},r=Symbol(),e="abcdefghijklmnopqrst";return t[r]=7,e.split("").forEach(function(t){n[t]=t}),7!=f({},t)[r]||Object.keys(f({},n)).join("")!=e})?function(t,n){for(var r=u(t),f=arguments.length,a=1,s=i.f,l=o.f;f>a;)for(var h,v=c(arguments[a++]),p=s?e(v).concat(s(v)):e(v),d=p.length,y=0;d>y;)l.call(v,h=p[y++])&&(r[h]=v[h]);return r}:f},function(t,n,r){var e=r(11),i=r(2),o=r(72);t.exports=r(10)?Object.defineProperties:function(t,n){i(t);for(var r,u=o(n),c=u.length,f=0;c>f;)e.f(t,r=u[f++],n[r]);return t}},function(t,n,r){var e=r(30),i=r(71).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==o.call(t)?c(t):i(e(t))}},function(t,n,r){var e=r(24),i=r(30),o=r(117)(!1),u=r(145)("IE_PROTO");t.exports=function(t,n){var r,c=i(t),f=0,a=[];for(r in c)r!=u&&e(c,r)&&a.push(r);for(;n.length>f;)e(c,r=n[f++])&&(~o(a,r)||a.push(r));return a}},function(t,n,r){var e=r(72),i=r(30),o=r(116).f;t.exports=function(t){return function(n){for(var r,u=i(n),c=e(u),f=c.length,a=0,s=[];f>a;)o.call(u,r=c[a++])&&s.push(t?[r,u[r]]:u[r]);return s}}},function(t,n,r){var e=r(71),i=r(125),o=r(2),u=r(3).Reflect;t.exports=u&&u.ownKeys||function(t){var n=e.f(o(t)),r=i.f;return r?n.concat(r(t)):n}},function(t,n,r){var e=r(3).parseFloat,i=r(82).trim;t.exports=1/e(r(150)+"-0")!=-1/0?function(t){var n=i(String(t),3),r=e(n);return 0===r&&"-"==n.charAt(0)?-0:r}:e},function(t,n,r){var e=r(3).parseInt,i=r(82).trim,o=r(150),u=/^[\-+]?0[xX]/;t.exports=8!==e(o+"08")||22!==e(o+"0x16")?function(t,n){var r=i(String(t),3);return e(r,n>>>0||(u.test(r)?16:10))}:e},function(t,n){t.exports=Object.is||function(t,n){return t===n?0!==t||1/t==1/n:t!=t&&n!=n}},function(t,n,r){var e=r(16),i=r(149),o=r(46);t.exports=function(t,n,r,u){var c=String(o(t)),f=c.length,a=void 0===r?" ":String(r),s=e(n);if(s<=f||""==a)return c;var l=s-f,h=i.call(a,Math.ceil(l/a.length));return h.length>l&&(h=h.slice(0,l)),u?h+c:c+h}},function(t,n,r){n.f=r(7)},function(t,n,r){"use strict";var e=r(164);t.exports=r(118)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var n=e.getEntry(this,t);return n&&n.v},set:function(t,n){return e.def(this,0===t?0:t,n)}},e,!0)},function(t,n,r){r(10)&&"g"!=/./g.flags&&r(11).f(RegExp.prototype,"flags",{configurable:!0,get:r(120)})},function(t,n,r){"use strict";var e=r(164);t.exports=r(118)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return e.def(this,t=0===t?0:t,t)}},e)},function(t,n,r){"use strict";var e,i=r(48)(0),o=r(28),u=r(65),c=r(172),f=r(166),a=r(6),s=u.getWeak,l=Object.isExtensible,h=f.ufstore,v={},p=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},d={get:function(t){if(a(t)){var n=s(t);return!0===n?h(this).get(t):n?n[this._i]:void 0}},set:function(t,n){return f.def(this,t,n)}},y=t.exports=r(118)("WeakMap",p,d,f,!0,!0);7!=(new y).set((Object.freeze||Object)(v),7).get(v)&&(e=f.getConstructor(p),c(e.prototype,d),u.NEED=!0,i(["delete","has","get","set"],function(t){var n=y.prototype,r=n[t];o(n,t,function(n,i){if(a(n)&&!l(n)){this._f||(this._f=new e);var o=this._f[t](n,i);return"set"==t?this:o}return r.call(this,n,i)})}))},,,,function(t,n){"use strict";function r(){var t=document.querySelector("#page-nav");if(t&&!document.querySelector("#page-nav .extend.prev")&&(t.innerHTML='<a class="extend prev disabled" rel="prev">&laquo; Prev</a>'+t.innerHTML),t&&!document.querySelector("#page-nav .extend.next")&&(t.innerHTML=t.innerHTML+'<a class="extend next disabled" rel="next">Next &raquo;</a>'),yiliaConfig&&yiliaConfig.open_in_new){document.querySelectorAll(".article-entry a:not(.article-more-a)").forEach(function(t){var n=t.getAttribute("target");n&&""!==n||t.setAttribute("target","_blank")})}if(yiliaConfig&&yiliaConfig.toc_hide_index){document.querySelectorAll(".toc-number").forEach(function(t){t.style.display="none"})}var n=document.querySelector("#js-aboutme");n&&0!==n.length&&(n.innerHTML=n.innerText)}t.exports={init:r}},function(t,n,r){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}function i(t,n){var r=/\/|index.html/g;return t.replace(r,"")===n.replace(r,"")}function o(){for(var t=document.querySelectorAll(".js-header-menu li a"),n=window.location.pathname,r=0,e=t.length;r<e;r++){var o=t[r];i(n,o.getAttribute("href"))&&(0,h.default)(o,"active")}}function u(t){for(var n=t.offsetLeft,r=t.offsetParent;null!==r;)n+=r.offsetLeft,r=r.offsetParent;return n}function c(t){for(var n=t.offsetTop,r=t.offsetParent;null!==r;)n+=r.offsetTop,r=r.offsetParent;return n}function f(t,n,r,e,i){var o=u(t),f=c(t)-n;if(f-r<=i){var a=t.$newDom;a||(a=t.cloneNode(!0),(0,d.default)(t,a),t.$newDom=a,a.style.position="fixed",a.style.top=(r||f)+"px",a.style.left=o+"px",a.style.zIndex=e||2,a.style.width="100%",a.style.color="#fff"),a.style.visibility="visible",t.style.visibility="hidden"}else{t.style.visibility="visible";var s=t.$newDom;s&&(s.style.visibility="hidden")}}function a(){var t=document.querySelector(".js-overlay"),n=document.querySelector(".js-header-menu");f(t,document.body.scrollTop,-63,2,0),f(n,document.body.scrollTop,1,3,0)}function s(){document.querySelector("#container").addEventListener("scroll",function(t){a()}),window.addEventListener("scroll",function(t){a()}),a()}var l=r(156),h=e(l),v=r(157),p=(e(v),r(382)),d=e(p),y=r(128),g=e(y),b=r(190),m=e(b),x=r(129);(function(){g.default.versions.mobile&&window.screen.width<800&&(o(),s())})(),(0,x.addLoadEvent)(function(){m.default.init()}),t.exports={}},,,,function(t,n,r){(function(t){"use strict";function n(t,n,r){t[n]||Object[e](t,n,{writable:!0,configurable:!0,value:r})}if(r(381),r(391),r(198),t._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");t._babelPolyfill=!0;var e="defineProperty";n(String.prototype,"padLeft","".padStart),n(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&n(Array,t,Function.call.bind([][t]))})}).call(n,function(){return this}())},,,function(t,n,r){r(210),t.exports=r(52).RegExp.escape},,,,function(t,n,r){var e=r(6),i=r(138),o=r(7)("species");t.exports=function(t){var n;return i(t)&&(n=t.constructor,"function"!=typeof n||n!==Array&&!i(n.prototype)||(n=void 0),e(n)&&null===(n=n[o])&&(n=void 0)),void 0===n?Array:n}},function(t,n,r){var e=r(202);t.exports=function(t,n){return new(e(t))(n)}},function(t,n,r){"use strict";var e=r(2),i=r(50),o="number";t.exports=function(t){if("string"!==t&&t!==o&&"default"!==t)throw TypeError("Incorrect hint");return i(e(this),t!=o)}},function(t,n,r){var e=r(72),i=r(125),o=r(116);t.exports=function(t){var n=e(t),r=i.f;if(r)for(var u,c=r(t),f=o.f,a=0;c.length>a;)f.call(t,u=c[a++])&&n.push(u);return n}},function(t,n,r){var e=r(72),i=r(30);t.exports=function(t,n){for(var r,o=i(t),u=e(o),c=u.length,f=0;c>f;)if(o[r=u[f++]]===n)return r}},function(t,n,r){"use strict";var e=r(208),i=r(121),o=r(26);t.exports=function(){for(var t=o(this),n=arguments.length,r=Array(n),u=0,c=e._,f=!1;n>u;)(r[u]=arguments[u++])===c&&(f=!0);return function(){var e,o=this,u=arguments.length,a=0,s=0;if(!f&&!u)return i(t,r,o);if(e=r.slice(),f)for(;n>a;a++)e[a]===c&&(e[a]=arguments[s++]);for(;u>s;)e.push(arguments[s++]);return i(t,e,o)}}},function(t,n,r){t.exports=r(3)},function(t,n){t.exports=function(t,n){var r=n===Object(n)?function(t){return n[t]}:n;return function(n){return String(n).replace(t,r)}}},function(t,n,r){var e=r(1),i=r(209)(/[\\^$*+?.()|[\]{}]/g,"\\$&");e(e.S,"RegExp",{escape:function(t){return i(t)}})},function(t,n,r){var e=r(1);e(e.P,"Array",{copyWithin:r(160)}),r(78)("copyWithin")},function(t,n,r){"use strict";var e=r(1),i=r(48)(4);e(e.P+e.F*!r(47)([].every,!0),"Array",{every:function(t){return i(this,t,arguments[1])}})},function(t,n,r){var e=r(1);e(e.P,"Array",{fill:r(130)}),r(78)("fill")},function(t,n,r){"use strict";var e=r(1),i=r(48)(2);e(e.P+e.F*!r(47)([].filter,!0),"Array",{filter:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(6),o="findIndex",u=!0;o in[]&&Array(1)[o](function(){u=!1}),e(e.P+e.F*u,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)(o)},function(t,n,r){"use strict";var e=r(1),i=r(48)(5),o="find",u=!0;o in[]&&Array(1)[o](function(){u=!1}),e(e.P+e.F*u,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)(o)},function(t,n,r){"use strict";var e=r(1),i=r(48)(0),o=r(47)([].forEach,!0);e(e.P+e.F*!o,"Array",{forEach:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(53),i=r(1),o=r(17),u=r(169),c=r(137),f=r(16),a=r(131),s=r(154);i(i.S+i.F*!r(123)(function(t){Array.from(t)}),"Array",{from:function(t){var n,r,i,l,h=o(t),v="function"==typeof this?this:Array,p=arguments.length,d=p>1?arguments[1]:void 0,y=void 0!==d,g=0,b=s(h);if(y&&(d=e(d,p>2?arguments[2]:void 0,2)),void 0==b||v==Array&&c(b))for(n=f(h.length),r=new v(n);n>g;g++)a(r,g,y?d(h[g],g):h[g]);else for(l=b.call(h),r=new v;!(i=l.next()).done;g++)a(r,g,y?u(l,d,[i.value,g],!0):i.value);return r.length=g,r}})},function(t,n,r){"use strict";var e=r(1),i=r(117)(!1),o=[].indexOf,u=!!o&&1/[1].indexOf(1,-0)<0;e(e.P+e.F*(u||!r(47)(o)),"Array",{indexOf:function(t){return u?o.apply(this,arguments)||0:i(this,t,arguments[1])}})},function(t,n,r){var e=r(1);e(e.S,"Array",{isArray:r(138)})},function(t,n,r){"use strict";var e=r(1),i=r(30),o=[].join;e(e.P+e.F*(r(115)!=Object||!r(47)(o)),"Array",{join:function(t){return o.call(i(this),void 0===t?",":t)}})},function(t,n,r){"use strict";var e=r(1),i=r(30),o=r(67),u=r(16),c=[].lastIndexOf,f=!!c&&1/[1].lastIndexOf(1,-0)<0;e(e.P+e.F*(f||!r(47)(c)),"Array",{lastIndexOf:function(t){if(f)return c.apply(this,arguments)||0;var n=i(this),r=u(n.length),e=r-1;for(arguments.length>1&&(e=Math.min(e,o(arguments[1]))),e<0&&(e=r+e);e>=0;e--)if(e in n&&n[e]===t)return e||0;return-1}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(1);e(e.P+e.F*!r(47)([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(131);e(e.S+e.F*r(4)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,n=arguments.length,r=new("function"==typeof this?this:Array)(n);n>t;)i(r,t,arguments[t++]);return r.length=n,r}})},function(t,n,r){"use strict";var e=r(1),i=r(162);e(e.P+e.F*!r(47)([].reduceRight,!0),"Array",{reduceRight:function(t){return i(this,t,arguments.length,arguments[1],!0)}})},function(t,n,r){"use strict";var e=r(1),i=r(162);e(e.P+e.F*!r(47)([].reduce,!0),"Array",{reduce:function(t){return i(this,t,arguments.length,arguments[1],!1)}})},function(t,n,r){"use strict";var e=r(1),i=r(135),o=r(45),u=r(75),c=r(16),f=[].slice;e(e.P+e.F*r(4)(function(){i&&f.call(i)}),"Array",{slice:function(t,n){var r=c(this.length),e=o(this);if(n=void 0===n?r:n,"Array"==e)return f.call(this,t,n);for(var i=u(t,r),a=u(n,r),s=c(a-i),l=Array(s),h=0;h<s;h++)l[h]="String"==e?this.charAt(i+h):this[i+h];return l}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(3);e(e.P+e.F*!r(47)([].some,!0),"Array",{some:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(26),o=r(17),u=r(4),c=[].sort,f=[1,2,3];e(e.P+e.F*(u(function(){f.sort(void 0)})||!u(function(){f.sort(null)})||!r(47)(c)),"Array",{sort:function(t){return void 0===t?c.call(o(this)):c.call(o(this),i(t))}})},function(t,n,r){r(74)("Array")},function(t,n,r){var e=r(1);e(e.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,n,r){"use strict";var e=r(1),i=r(4),o=Date.prototype.getTime,u=function(t){return t>9?t:"0"+t};e(e.P+e.F*(i(function(){return"0385-07-25T07:06:39.999Z"!=new Date(-5e13-1).toISOString()})||!i(function(){new Date(NaN).toISOString()})),"Date",{toISOString:function(){
if(!isFinite(o.call(this)))throw RangeError("Invalid time value");var t=this,n=t.getUTCFullYear(),r=t.getUTCMilliseconds(),e=n<0?"-":n>9999?"+":"";return e+("00000"+Math.abs(n)).slice(e?-6:-4)+"-"+u(t.getUTCMonth()+1)+"-"+u(t.getUTCDate())+"T"+u(t.getUTCHours())+":"+u(t.getUTCMinutes())+":"+u(t.getUTCSeconds())+"."+(r>99?r:"0"+u(r))+"Z"}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50);e(e.P+e.F*r(4)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var n=i(this),r=o(n);return"number"!=typeof r||isFinite(r)?n.toISOString():null}})},function(t,n,r){var e=r(7)("toPrimitive"),i=Date.prototype;e in i||r(27)(i,e,r(204))},function(t,n,r){var e=Date.prototype,i="Invalid Date",o="toString",u=e[o],c=e.getTime;new Date(NaN)+""!=i&&r(28)(e,o,function(){var t=c.call(this);return t===t?u.call(this):i})},function(t,n,r){var e=r(1);e(e.P,"Function",{bind:r(163)})},function(t,n,r){"use strict";var e=r(6),i=r(32),o=r(7)("hasInstance"),u=Function.prototype;o in u||r(11).f(u,o,{value:function(t){if("function"!=typeof this||!e(t))return!1;if(!e(this.prototype))return t instanceof this;for(;t=i(t);)if(this.prototype===t)return!0;return!1}})},function(t,n,r){var e=r(11).f,i=r(66),o=r(24),u=Function.prototype,c="name",f=Object.isExtensible||function(){return!0};c in u||r(10)&&e(u,c,{configurable:!0,get:function(){try{var t=this,n=(""+t).match(/^\s*function ([^ (]*)/)[1];return o(t,c)||!f(t)||e(t,c,i(5,n)),n}catch(t){return""}}})},function(t,n,r){var e=r(1),i=r(171),o=Math.sqrt,u=Math.acosh;e(e.S+e.F*!(u&&710==Math.floor(u(Number.MAX_VALUE))&&u(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+o(t-1)*o(t+1))}})},function(t,n,r){function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}var i=r(1),o=Math.asinh;i(i.S+i.F*!(o&&1/o(0)>0),"Math",{asinh:e})},function(t,n,r){var e=r(1),i=Math.atanh;e(e.S+e.F*!(i&&1/i(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,n,r){var e=r(1),i=r(142);e(e.S,"Math",{cbrt:function(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,n,r){var e=r(1),i=Math.exp;e(e.S,"Math",{cosh:function(t){return(i(t=+t)+i(-t))/2}})},function(t,n,r){var e=r(1),i=r(141);e(e.S+e.F*(i!=Math.expm1),"Math",{expm1:i})},function(t,n,r){var e=r(1),i=r(142),o=Math.pow,u=o(2,-52),c=o(2,-23),f=o(2,127)*(2-c),a=o(2,-126),s=function(t){return t+1/u-1/u};e(e.S,"Math",{fround:function(t){var n,r,e=Math.abs(t),o=i(t);return e<a?o*s(e/a/c)*a*c:(n=(1+c/u)*e,r=n-(n-e),r>f||r!=r?o*(1/0):o*r)}})},function(t,n,r){var e=r(1),i=Math.abs;e(e.S,"Math",{hypot:function(t,n){for(var r,e,o=0,u=0,c=arguments.length,f=0;u<c;)r=i(arguments[u++]),f<r?(e=f/r,o=o*e*e+1,f=r):r>0?(e=r/f,o+=e*e):o+=r;return f===1/0?1/0:f*Math.sqrt(o)}})},function(t,n,r){var e=r(1),i=Math.imul;e(e.S+e.F*r(4)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(t,n){var r=65535,e=+t,i=+n,o=r&e,u=r&i;return 0|o*u+((r&e>>>16)*u+o*(r&i>>>16)<<16>>>0)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{log10:function(t){return Math.log(t)/Math.LN10}})},function(t,n,r){var e=r(1);e(e.S,"Math",{log1p:r(171)})},function(t,n,r){var e=r(1);e(e.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,n,r){var e=r(1);e(e.S,"Math",{sign:r(142)})},function(t,n,r){var e=r(1),i=r(141),o=Math.exp;e(e.S+e.F*r(4)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},function(t,n,r){var e=r(1),i=r(141),o=Math.exp;e(e.S,"Math",{tanh:function(t){var n=i(t=+t),r=i(-t);return n==1/0?1:r==1/0?-1:(n-r)/(o(t)+o(-t))}})},function(t,n,r){var e=r(1);e(e.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,n,r){"use strict";var e=r(3),i=r(24),o=r(45),u=r(136),c=r(50),f=r(4),a=r(71).f,s=r(31).f,l=r(11).f,h=r(82).trim,v="Number",p=e[v],d=p,y=p.prototype,g=o(r(70)(y))==v,b="trim"in String.prototype,m=function(t){var n=c(t,!1);if("string"==typeof n&&n.length>2){n=b?n.trim():h(n,3);var r,e,i,o=n.charCodeAt(0);if(43===o||45===o){if(88===(r=n.charCodeAt(2))||120===r)return NaN}else if(48===o){switch(n.charCodeAt(1)){case 66:case 98:e=2,i=49;break;case 79:case 111:e=8,i=55;break;default:return+n}for(var u,f=n.slice(2),a=0,s=f.length;a<s;a++)if((u=f.charCodeAt(a))<48||u>i)return NaN;return parseInt(f,e)}}return+n};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var n=arguments.length<1?0:t,r=this;return r instanceof p&&(g?f(function(){y.valueOf.call(r)}):o(r)!=v)?u(new d(m(n)),r,p):m(n)};for(var x,w=r(10)?a(d):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;w.length>S;S++)i(d,x=w[S])&&!i(p,x)&&l(p,x,s(d,x));p.prototype=y,y.constructor=p,r(28)(e,v,p)}},function(t,n,r){var e=r(1);e(e.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,n,r){var e=r(1),i=r(3).isFinite;e(e.S,"Number",{isFinite:function(t){return"number"==typeof t&&i(t)}})},function(t,n,r){var e=r(1);e(e.S,"Number",{isInteger:r(168)})},function(t,n,r){var e=r(1);e(e.S,"Number",{isNaN:function(t){return t!=t}})},function(t,n,r){var e=r(1),i=r(168),o=Math.abs;e(e.S,"Number",{isSafeInteger:function(t){return i(t)&&o(t)<=9007199254740991}})},function(t,n,r){var e=r(1);e(e.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,n,r){var e=r(1);e(e.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,n,r){var e=r(1),i=r(178);e(e.S+e.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(t,n,r){var e=r(1),i=r(179);e(e.S+e.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(t,n,r){"use strict";var e=r(1),i=r(67),o=r(159),u=r(149),c=1..toFixed,f=Math.floor,a=[0,0,0,0,0,0],s="Number.toFixed: incorrect invocation!",l="0",h=function(t,n){for(var r=-1,e=n;++r<6;)e+=t*a[r],a[r]=e%1e7,e=f(e/1e7)},v=function(t){for(var n=6,r=0;--n>=0;)r+=a[n],a[n]=f(r/t),r=r%t*1e7},p=function(){for(var t=6,n="";--t>=0;)if(""!==n||0===t||0!==a[t]){var r=String(a[t]);n=""===n?r:n+u.call(l,7-r.length)+r}return n},d=function(t,n,r){return 0===n?r:n%2==1?d(t,n-1,r*t):d(t*t,n/2,r)},y=function(t){for(var n=0,r=t;r>=4096;)n+=12,r/=4096;for(;r>=2;)n+=1,r/=2;return n};e(e.P+e.F*(!!c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r(4)(function(){c.call({})})),"Number",{toFixed:function(t){var n,r,e,c,f=o(this,s),a=i(t),g="",b=l;if(a<0||a>20)throw RangeError(s);if(f!=f)return"NaN";if(f<=-1e21||f>=1e21)return String(f);if(f<0&&(g="-",f=-f),f>1e-21)if(n=y(f*d(2,69,1))-69,r=n<0?f*d(2,-n,1):f/d(2,n,1),r*=4503599627370496,(n=52-n)>0){for(h(0,r),e=a;e>=7;)h(1e7,0),e-=7;for(h(d(10,e,1),0),e=n-1;e>=23;)v(1<<23),e-=23;v(1<<e),h(1,1),v(2),b=p()}else h(0,r),h(1<<-n,0),b=p()+u.call(l,a);return a>0?(c=b.length,b=g+(c<=a?"0."+u.call(l,a-c)+b:b.slice(0,c-a)+"."+b.slice(c-a))):b=g+b,b}})},function(t,n,r){"use strict";var e=r(1),i=r(4),o=r(159),u=1..toPrecision;e(e.P+e.F*(i(function(){return"1"!==u.call(1,void 0)})||!i(function(){u.call({})})),"Number",{toPrecision:function(t){var n=o(this,"Number#toPrecision: incorrect invocation!");return void 0===t?u.call(n):u.call(n,t)}})},function(t,n,r){var e=r(1);e(e.S+e.F,"Object",{assign:r(172)})},function(t,n,r){var e=r(1);e(e.S,"Object",{create:r(70)})},function(t,n,r){var e=r(1);e(e.S+e.F*!r(10),"Object",{defineProperties:r(173)})},function(t,n,r){var e=r(1);e(e.S+e.F*!r(10),"Object",{defineProperty:r(11).f})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("freeze",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(30),i=r(31).f;r(49)("getOwnPropertyDescriptor",function(){return function(t,n){return i(e(t),n)}})},function(t,n,r){r(49)("getOwnPropertyNames",function(){return r(174).f})},function(t,n,r){var e=r(17),i=r(32);r(49)("getPrototypeOf",function(){return function(t){return i(e(t))}})},function(t,n,r){var e=r(6);r(49)("isExtensible",function(t){return function(n){return!!e(n)&&(!t||t(n))}})},function(t,n,r){var e=r(6);r(49)("isFrozen",function(t){return function(n){return!e(n)||!!t&&t(n)}})},function(t,n,r){var e=r(6);r(49)("isSealed",function(t){return function(n){return!e(n)||!!t&&t(n)}})},function(t,n,r){var e=r(1);e(e.S,"Object",{is:r(180)})},function(t,n,r){var e=r(17),i=r(72);r(49)("keys",function(){return function(t){return i(e(t))}})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("preventExtensions",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("seal",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(1);e(e.S,"Object",{setPrototypeOf:r(144).set})},function(t,n,r){"use strict";var e=r(114),i={};i[r(7)("toStringTag")]="z",i+""!="[object z]"&&r(28)(Object.prototype,"toString",function(){return"[object "+e(this)+"]"},!0)},function(t,n,r){var e=r(1),i=r(178);e(e.G+e.F*(parseFloat!=i),{parseFloat:i})},function(t,n,r){var e=r(1),i=r(179);e(e.G+e.F*(parseInt!=i),{parseInt:i})},function(t,n,r){"use strict";var e,i,o,u=r(69),c=r(3),f=r(53),a=r(114),s=r(1),l=r(6),h=r(26),v=r(68),p=r(79),d=r(146),y=r(151).set,g=r(143)(),b="Promise",m=c.TypeError,x=c.process,w=c[b],x=c.process,S="process"==a(x),_=function(){},O=!!function(){try{var t=w.resolve(1),n=(t.constructor={})[r(7)("species")]=function(t){t(_,_)};return(S||"function"==typeof PromiseRejectionEvent)&&t.then(_)instanceof n}catch(t){}}(),E=function(t,n){return t===n||t===w&&n===o},P=function(t){var n;return!(!l(t)||"function"!=typeof(n=t.then))&&n},j=function(t){return E(w,t)?new F(t):new i(t)},F=i=function(t){var n,r;this.promise=new t(function(t,e){if(void 0!==n||void 0!==r)throw m("Bad Promise constructor");n=t,r=e}),this.resolve=h(n),this.reject=h(r)},M=function(t){try{t()}catch(t){return{error:t}}},A=function(t,n){if(!t._n){t._n=!0;var r=t._c;g(function(){for(var e=t._v,i=1==t._s,o=0;r.length>o;)!function(n){var r,o,u=i?n.ok:n.fail,c=n.resolve,f=n.reject,a=n.domain;try{u?(i||(2==t._h&&I(t),t._h=1),!0===u?r=e:(a&&a.enter(),r=u(e),a&&a.exit()),r===n.promise?f(m("Promise-chain cycle")):(o=P(r))?o.call(r,c,f):c(r)):f(e)}catch(t){f(t)}}(r[o++]);t._c=[],t._n=!1,n&&!t._h&&N(t)})}},N=function(t){y.call(c,function(){var n,r,e,i=t._v;if(T(t)&&(n=M(function(){S?x.emit("unhandledRejection",i,t):(r=c.onunhandledrejection)?r({promise:t,reason:i}):(e=c.console)&&e.error&&e.error("Unhandled promise rejection",i)}),t._h=S||T(t)?2:1),t._a=void 0,n)throw n.error})},T=function(t){if(1==t._h)return!1;for(var n,r=t._a||t._c,e=0;r.length>e;)if(n=r[e++],n.fail||!T(n.promise))return!1;return!0},I=function(t){y.call(c,function(){var n;S?x.emit("rejectionHandled",t):(n=c.onrejectionhandled)&&n({promise:t,reason:t._v})})},k=function(t){var n=this;n._d||(n._d=!0,n=n._w||n,n._v=t,n._s=2,n._a||(n._a=n._c.slice()),A(n,!0))},L=function(t){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw m("Promise can't be resolved itself");(n=P(t))?g(function(){var e={_w:r,_d:!1};try{n.call(t,f(L,e,1),f(k,e,1))}catch(t){k.call(e,t)}}):(r._v=t,r._s=1,A(r,!1))}catch(t){k.call({_w:r,_d:!1},t)}}};O||(w=function(t){v(this,w,b,"_h"),h(t),e.call(this);try{t(f(L,this,1),f(k,this,1))}catch(t){k.call(this,t)}},e=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},e.prototype=r(73)(w.prototype,{then:function(t,n){var r=j(d(this,w));return r.ok="function"!=typeof t||t,r.fail="function"==typeof n&&n,r.domain=S?x.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&A(this,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),F=function(){var t=new e;this.promise=t,this.resolve=f(L,t,1),this.reject=f(k,t,1)}),s(s.G+s.W+s.F*!O,{Promise:w}),r(81)(w,b),r(74)(b),o=r(52)[b],s(s.S+s.F*!O,b,{reject:function(t){var n=j(this);return(0,n.reject)(t),n.promise}}),s(s.S+s.F*(u||!O),b,{resolve:function(t){if(t instanceof w&&E(t.constructor,this))return t;var n=j(this);return(0,n.resolve)(t),n.promise}}),s(s.S+s.F*!(O&&r(123)(function(t){w.all(t).catch(_)})),b,{all:function(t){var n=this,r=j(n),e=r.resolve,i=r.reject,o=M(function(){var r=[],o=0,u=1;p(t,!1,function(t){var c=o++,f=!1;r.push(void 0),u++,n.resolve(t).then(function(t){f||(f=!0,r[c]=t,--u||e(r))},i)}),--u||e(r)});return o&&i(o.error),r.promise},race:function(t){var n=this,r=j(n),e=r.reject,i=M(function(){p(t,!1,function(t){n.resolve(t).then(r.resolve,e)})});return i&&e(i.error),r.promise}})},function(t,n,r){var e=r(1),i=r(26),o=r(2),u=(r(3).Reflect||{}).apply,c=Function.apply;e(e.S+e.F*!r(4)(function(){u(function(){})}),"Reflect",{apply:function(t,n,r){var e=i(t),f=o(r);return u?u(e,n,f):c.call(e,n,f)}})},function(t,n,r){var e=r(1),i=r(70),o=r(26),u=r(2),c=r(6),f=r(4),a=r(163),s=(r(3).Reflect||{}).construct,l=f(function(){function t(){}return!(s(function(){},[],t)instanceof t)}),h=!f(function(){s(function(){})});e(e.S+e.F*(l||h),"Reflect",{construct:function(t,n){o(t),u(n);var r=arguments.length<3?t:o(arguments[2]);if(h&&!l)return s(t,n,r);if(t==r){switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3])}var e=[null];return e.push.apply(e,n),new(a.apply(t,e))}var f=r.prototype,v=i(c(f)?f:Object.prototype),p=Function.apply.call(t,v,n);return c(p)?p:v}})},function(t,n,r){var e=r(11),i=r(1),o=r(2),u=r(50);i(i.S+i.F*r(4)(function(){Reflect.defineProperty(e.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,n,r){o(t),n=u(n,!0),o(r);try{return e.f(t,n,r),!0}catch(t){return!1}}})},function(t,n,r){var e=r(1),i=r(31).f,o=r(2);e(e.S,"Reflect",{deleteProperty:function(t,n){var r=i(o(t),n);return!(r&&!r.configurable)&&delete t[n]}})},function(t,n,r){"use strict";var e=r(1),i=r(2),o=function(t){this._t=i(t),this._i=0;var n,r=this._k=[];for(n in t)r.push(n)};r(139)(o,"Object",function(){var t,n=this,r=n._k;do{if(n._i>=r.length)return{value:void 0,done:!0}}while(!((t=r[n._i++])in n._t));return{value:t,done:!1}}),e(e.S,"Reflect",{enumerate:function(t){return new o(t)}})},function(t,n,r){var e=r(31),i=r(1),o=r(2);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(t,n){return e.f(o(t),n)}})},function(t,n,r){var e=r(1),i=r(32),o=r(2);e(e.S,"Reflect",{getPrototypeOf:function(t){return i(o(t))}})},function(t,n,r){function e(t,n){var r,c,s=arguments.length<3?t:arguments[2];return a(t)===s?t[n]:(r=i.f(t,n))?u(r,"value")?r.value:void 0!==r.get?r.get.call(s):void 0:f(c=o(t))?e(c,n,s):void 0}var i=r(31),o=r(32),u=r(24),c=r(1),f=r(6),a=r(2);c(c.S,"Reflect",{get:e})},function(t,n,r){var e=r(1);e(e.S,"Reflect",{has:function(t,n){return n in t}})},function(t,n,r){var e=r(1),i=r(2),o=Object.isExtensible;e(e.S,"Reflect",{isExtensible:function(t){return i(t),!o||o(t)}})},function(t,n,r){var e=r(1);e(e.S,"Reflect",{ownKeys:r(177)})},function(t,n,r){var e=r(1),i=r(2),o=Object.preventExtensions;e(e.S,"Reflect",{preventExtensions:function(t){i(t);try{return o&&o(t),!0}catch(t){return!1}}})},function(t,n,r){var e=r(1),i=r(144);i&&e(e.S,"Reflect",{setPrototypeOf:function(t,n){i.check(t,n);try{return i.set(t,n),!0}catch(t){return!1}}})},function(t,n,r){function e(t,n,r){var f,h,v=arguments.length<4?t:arguments[3],p=o.f(s(t),n);if(!p){if(l(h=u(t)))return e(h,n,r,v);p=a(0)}return c(p,"value")?!(!1===p.writable||!l(v)||(f=o.f(v,n)||a(0),f.value=r,i.f(v,n,f),0)):void 0!==p.set&&(p.set.call(v,r),!0)}var i=r(11),o=r(31),u=r(32),c=r(24),f=r(1),a=r(66),s=r(2),l=r(6);f(f.S,"Reflect",{set:e})},function(t,n,r){var e=r(3),i=r(136),o=r(11).f,u=r(71).f,c=r(122),f=r(120),a=e.RegExp,s=a,l=a.prototype,h=/a/g,v=/a/g,p=new a(h)!==h;if(r(10)&&(!p||r(4)(function(){return v[r(7)("match")]=!1,a(h)!=h||a(v)==v||"/a/i"!=a(h,"i")}))){a=function(t,n){var r=this instanceof a,e=c(t),o=void 0===n;return!r&&e&&t.constructor===a&&o?t:i(p?new s(e&&!o?t.source:t,n):s((e=t instanceof a)?t.source:t,e&&o?f.call(t):n),r?this:l,a)};for(var d=u(s),y=0;d.length>y;)!function(t){t in a||o(a,t,{configurable:!0,get:function(){return s[t]},set:function(n){s[t]=n}})}(d[y++]);l.constructor=a,a.prototype=l,r(28)(e,"RegExp",a)}r(74)("RegExp")},function(t,n,r){r(119)("match",1,function(t,n,r){return[function(r){"use strict";var e=t(this),i=void 0==r?void 0:r[n];return void 0!==i?i.call(r,e):new RegExp(r)[n](String(e))},r]})},function(t,n,r){r(119)("replace",2,function(t,n,r){return[function(e,i){"use strict";var o=t(this),u=void 0==e?void 0:e[n];return void 0!==u?u.call(e,o,i):r.call(String(o),e,i)},r]})},function(t,n,r){r(119)("search",1,function(t,n,r){return[function(r){"use strict";var e=t(this),i=void 0==r?void 0:r[n];return void 0!==i?i.call(r,e):new RegExp(r)[n](String(e))},r]})},function(t,n,r){r(119)("split",2,function(t,n,e){"use strict";var i=r(122),o=e,u=[].push,c="split",f="length",a="lastIndex";if("c"=="abbc"[c](/(b)*/)[1]||4!="test"[c](/(?:)/,-1)[f]||2!="ab"[c](/(?:ab)*/)[f]||4!="."[c](/(.?)(.?)/)[f]||"."[c](/()()/)[f]>1||""[c](/.?/)[f]){var s=void 0===/()??/.exec("")[1];e=function(t,n){var r=String(this);if(void 0===t&&0===n)return[];if(!i(t))return o.call(r,t,n);var e,c,l,h,v,p=[],d=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),y=0,g=void 0===n?4294967295:n>>>0,b=new RegExp(t.source,d+"g");for(s||(e=new RegExp("^"+b.source+"$(?!\\s)",d));(c=b.exec(r))&&!((l=c.index+c[0][f])>y&&(p.push(r.slice(y,c.index)),!s&&c[f]>1&&c[0].replace(e,function(){for(v=1;v<arguments[f]-2;v++)void 0===arguments[v]&&(c[v]=void 0)}),c[f]>1&&c.index<r[f]&&u.apply(p,c.slice(1)),h=c[0][f],y=l,p[f]>=g));)b[a]===c.index&&b[a]++;return y===r[f]?!h&&b.test("")||p.push(""):p.push(r.slice(y)),p[f]>g?p.slice(0,g):p}}else"0"[c](void 0,0)[f]&&(e=function(t,n){return void 0===t&&0===n?[]:o.call(this,t,n)});return[function(r,i){var o=t(this),u=void 0==r?void 0:r[n];return void 0!==u?u.call(r,o,i):e.call(String(o),r,i)},e]})},function(t,n,r){"use strict";r(184);var e=r(2),i=r(120),o=r(10),u="toString",c=/./[u],f=function(t){r(28)(RegExp.prototype,u,t,!0)};r(4)(function(){return"/a/b"!=c.call({source:"a",flags:"b"})})?f(function(){var t=e(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)}):c.name!=u&&f(function(){return c.call(this)})},function(t,n,r){"use strict";r(29)("anchor",function(t){return function(n){return t(this,"a","name",n)}})},function(t,n,r){"use strict";r(29)("big",function(t){return function(){return t(this,"big","","")}})},function(t,n,r){"use strict";r(29)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,n,r){"use strict";r(29)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,n,r){"use strict";var e=r(1),i=r(147)(!1);e(e.P,"String",{codePointAt:function(t){return i(this,t)}})},function(t,n,r){"use strict";var e=r(1),i=r(16),o=r(148),u="endsWith",c=""[u];e(e.P+e.F*r(134)(u),"String",{endsWith:function(t){var n=o(this,t,u),r=arguments.length>1?arguments[1]:void 0,e=i(n.length),f=void 0===r?e:Math.min(i(r),e),a=String(t);return c?c.call(n,a,f):n.slice(f-a.length,f)===a}})},function(t,n,r){"use strict";r(29)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,n,r){"use strict";r(29)("fontcolor",function(t){return function(n){return t(this,"font","color",n)}})},function(t,n,r){"use strict";r(29)("fontsize",function(t){return function(n){return t(this,"font","size",n)}})},function(t,n,r){var e=r(1),i=r(75),o=String.fromCharCode,u=String.fromCodePoint;e(e.S+e.F*(!!u&&1!=u.length),"String",{fromCodePoint:function(t){for(var n,r=[],e=arguments.length,u=0;e>u;){if(n=+arguments[u++],i(n,1114111)!==n)throw RangeError(n+" is not a valid code point");r.push(n<65536?o(n):o(55296+((n-=65536)>>10),n%1024+56320))}return r.join("")}})},function(t,n,r){"use strict";var e=r(1),i=r(148),o="includes";e(e.P+e.F*r(134)(o),"String",{includes:function(t){return!!~i(this,t,o).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,n,r){"use strict";r(29)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,n,r){"use strict";var e=r(147)(!0);r(140)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,r=this._i;return r>=n.length?{value:void 0,done:!0}:(t=e(n,r),this._i+=t.length,{value:t,done:!1})})},function(t,n,r){"use strict";r(29)("link",function(t){return function(n){return t(this,"a","href",n)}})},function(t,n,r){var e=r(1),i=r(30),o=r(16);e(e.S,"String",{raw:function(t){for(var n=i(t.raw),r=o(n.length),e=arguments.length,u=[],c=0;r>c;)u.push(String(n[c++])),c<e&&u.push(String(arguments[c]));return u.join("")}})},function(t,n,r){var e=r(1);e(e.P,"String",{repeat:r(149)})},function(t,n,r){"use strict";r(29)("small",function(t){return function(){return t(this,"small","","")}})},function(t,n,r){"use strict";var e=r(1),i=r(16),o=r(148),u="startsWith",c=""[u];e(e.P+e.F*r(134)(u),"String",{startsWith:function(t){var n=o(this,t,u),r=i(Math.min(arguments.length>1?arguments[1]:void 0,n.length)),e=String(t);return c?c.call(n,e,r):n.slice(r,r+e.length)===e}})},function(t,n,r){"use strict";r(29)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,n,r){"use strict";r(29)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,n,r){"use strict";r(29)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,n,r){"use strict";r(82)("trim",function(t){return function(){return t(this,3)}})},function(t,n,r){"use strict";var e=r(3),i=r(24),o=r(10),u=r(1),c=r(28),f=r(65).KEY,a=r(4),s=r(126),l=r(81),h=r(76),v=r(7),p=r(182),d=r(153),y=r(206),g=r(205),b=r(138),m=r(2),x=r(30),w=r(50),S=r(66),_=r(70),O=r(174),E=r(31),P=r(11),j=r(72),F=E.f,M=P.f,A=O.f,N=e.Symbol,T=e.JSON,I=T&&T.stringify,k="prototype",L=v("_hidden"),R=v("toPrimitive"),C={}.propertyIsEnumerable,D=s("symbol-registry"),U=s("symbols"),W=s("op-symbols"),G=Object[k],B="function"==typeof N,V=e.QObject,z=!V||!V[k]||!V[k].findChild,q=o&&a(function(){return 7!=_(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(t,n,r){var e=F(G,n);e&&delete G[n],M(t,n,r),e&&t!==G&&M(G,n,e)}:M,K=function(t){var n=U[t]=_(N[k]);return n._k=t,n},J=B&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},Y=function(t,n,r){return t===G&&Y(W,n,r),m(t),n=w(n,!0),m(r),i(U,n)?(r.enumerable?(i(t,L)&&t[L][n]&&(t[L][n]=!1),r=_(r,{enumerable:S(0,!1)})):(i(t,L)||M(t,L,S(1,{})),t[L][n]=!0),q(t,n,r)):M(t,n,r)},H=function(t,n){m(t);for(var r,e=g(n=x(n)),i=0,o=e.length;o>i;)Y(t,r=e[i++],n[r]);return t},$=function(t,n){return void 0===n?_(t):H(_(t),n)},X=function(t){var n=C.call(this,t=w(t,!0));return!(this===G&&i(U,t)&&!i(W,t))&&(!(n||!i(this,t)||!i(U,t)||i(this,L)&&this[L][t])||n)},Q=function(t,n){if(t=x(t),n=w(n,!0),t!==G||!i(U,n)||i(W,n)){var r=F(t,n);return!r||!i(U,n)||i(t,L)&&t[L][n]||(r.enumerable=!0),r}},Z=function(t){for(var n,r=A(x(t)),e=[],o=0;r.length>o;)i(U,n=r[o++])||n==L||n==f||e.push(n);return e},tt=function(t){for(var n,r=t===G,e=A(r?W:x(t)),o=[],u=0;e.length>u;)!i(U,n=e[u++])||r&&!i(G,n)||o.push(U[n]);return o};B||(N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),n=function(r){this===G&&n.call(W,r),i(this,L)&&i(this[L],t)&&(this[L][t]=!1),q(this,t,S(1,r))};return o&&z&&q(G,t,{configurable:!0,set:n}),K(t)},c(N[k],"toString",function(){return this._k}),E.f=Q,P.f=Y,r(71).f=O.f=Z,r(116).f=X,r(125).f=tt,o&&!r(69)&&c(G,"propertyIsEnumerable",X,!0),p.f=function(t){return K(v(t))}),u(u.G+u.W+u.F*!B,{Symbol:N});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;nt.length>rt;)v(nt[rt++]);for(var nt=j(v.store),rt=0;nt.length>rt;)d(nt[rt++]);u(u.S+u.F*!B,"Symbol",{for:function(t){return i(D,t+="")?D[t]:D[t]=N(t)},keyFor:function(t){if(J(t))return y(D,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),u(u.S+u.F*!B,"Object",{create:$,defineProperty:Y,defineProperties:H,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),T&&u(u.S+u.F*(!B||a(function(){var t=N();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!J(t)){for(var n,r,e=[t],i=1;arguments.length>i;)e.push(arguments[i++]);return n=e[1],"function"==typeof n&&(r=n),!r&&b(n)||(n=function(t,n){if(r&&(n=r.call(this,t,n)),!J(n))return n}),e[1]=n,I.apply(T,e)}}}),N[k][R]||r(27)(N[k],R,N[k].valueOf),l(N,"Symbol"),l(Math,"Math",!0),l(e.JSON,"JSON",!0)},function(t,n,r){"use strict";var e=r(1),i=r(127),o=r(152),u=r(2),c=r(75),f=r(16),a=r(6),s=r(3).ArrayBuffer,l=r(146),h=o.ArrayBuffer,v=o.DataView,p=i.ABV&&s.isView,d=h.prototype.slice,y=i.VIEW,g="ArrayBuffer";e(e.G+e.W+e.F*(s!==h),{ArrayBuffer:h}),e(e.S+e.F*!i.CONSTR,g,{isView:function(t){return p&&p(t)||a(t)&&y in t}}),e(e.P+e.U+e.F*r(4)(function(){return!new h(2).slice(1,void 0).byteLength}),g,{slice:function(t,n){if(void 0!==d&&void 0===n)return d.call(u(this),t);for(var r=u(this).byteLength,e=c(t,r),i=c(void 0===n?r:n,r),o=new(l(this,h))(f(i-e)),a=new v(this),s=new v(o),p=0;e<i;)s.setUint8(p++,a.getUint8(e++));return o}}),r(74)(g)},function(t,n,r){var e=r(1);e(e.G+e.W+e.F*!r(127).ABV,{DataView:r(152).DataView})},function(t,n,r){r(55)("Float32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Float64",8,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int16",2,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int8",1,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint16",2,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint8",1,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint8",1,function(t){return function(n,r,e){return t(this,n,r,e)}},!0)},function(t,n,r){"use strict";var e=r(166);r(118)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return e.def(this,t,!0)}},e,!1,!0)},function(t,n,r){"use strict";var e=r(1),i=r(117)(!0);e(e.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)("includes")},function(t,n,r){var e=r(1),i=r(143)(),o=r(3).process,u="process"==r(45)(o);e(e.G,{asap:function(t){var n=u&&o.domain;i(n?n.bind(t):t)}})},function(t,n,r){var e=r(1),i=r(45);e(e.S,"Error",{isError:function(t){return"Error"===i(t)}})},function(t,n,r){var e=r(1);e(e.P+e.R,"Map",{toJSON:r(165)("Map")})},function(t,n,r){var e=r(1);e(e.S,"Math",{iaddh:function(t,n,r,e){var i=t>>>0,o=n>>>0,u=r>>>0;return o+(e>>>0)+((i&u|(i|u)&~(i+u>>>0))>>>31)|0}})},function(t,n,r){var e=r(1);e(e.S,"Math",{imulh:function(t,n){var r=65535,e=+t,i=+n,o=e&r,u=i&r,c=e>>16,f=i>>16,a=(c*u>>>0)+(o*u>>>16);return c*f+(a>>16)+((o*f>>>0)+(a&r)>>16)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{isubh:function(t,n,r,e){var i=t>>>0,o=n>>>0,u=r>>>0;return o-(e>>>0)-((~i&u|~(i^u)&i-u>>>0)>>>31)|0}})},function(t,n,r){var e=r(1);e(e.S,"Math",{umulh:function(t,n){var r=65535,e=+t,i=+n,o=e&r,u=i&r,c=e>>>16,f=i>>>16,a=(c*u>>>0)+(o*u>>>16);return c*f+(a>>>16)+((o*f>>>0)+(a&r)>>>16)}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(26),u=r(11);r(10)&&e(e.P+r(124),"Object",{__defineGetter__:function(t,n){u.f(i(this),t,{get:o(n),enumerable:!0,configurable:!0})}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(26),u=r(11);r(10)&&e(e.P+r(124),"Object",{__defineSetter__:function(t,n){u.f(i(this),t,{set:o(n),enumerable:!0,configurable:!0})}})},function(t,n,r){var e=r(1),i=r(176)(!0);e(e.S,"Object",{entries:function(t){return i(t)}})},function(t,n,r){var e=r(1),i=r(177),o=r(30),u=r(31),c=r(131);e(e.S,"Object",{getOwnPropertyDescriptors:function(t){for(var n,r=o(t),e=u.f,f=i(r),a={},s=0;f.length>s;)c(a,n=f[s++],e(r,n));return a}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50),u=r(32),c=r(31).f;r(10)&&e(e.P+r(124),"Object",{__lookupGetter__:function(t){var n,r=i(this),e=o(t,!0);do{if(n=c(r,e))return n.get}while(r=u(r))}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50),u=r(32),c=r(31).f;r(10)&&e(e.P+r(124),"Object",{__lookupSetter__:function(t){var n,r=i(this),e=o(t,!0);do{if(n=c(r,e))return n.set}while(r=u(r))}})},function(t,n,r){var e=r(1),i=r(176)(!1);e(e.S,"Object",{values:function(t){return i(t)}})},function(t,n,r){"use strict";var e=r(1),i=r(3),o=r(52),u=r(143)(),c=r(7)("observable"),f=r(26),a=r(2),s=r(68),l=r(73),h=r(27),v=r(79),p=v.RETURN,d=function(t){return null==t?void 0:f(t)},y=function(t){var n=t._c;n&&(t._c=void 0,n())},g=function(t){return void 0===t._o},b=function(t){g(t)||(t._o=void 0,y(t))},m=function(t,n){a(t),this._c=void 0,this._o=t,t=new x(this);try{var r=n(t),e=r;null!=r&&("function"==typeof r.unsubscribe?r=function(){e.unsubscribe()}:f(r),this._c=r)}catch(n){return void t.error(n)}g(this)&&y(this)};m.prototype=l({},{unsubscribe:function(){b(this)}});var x=function(t){this._s=t};x.prototype=l({},{next:function(t){var n=this._s;if(!g(n)){var r=n._o;try{var e=d(r.next);if(e)return e.call(r,t)}catch(t){try{b(n)}finally{throw t}}}},error:function(t){var n=this._s;if(g(n))throw t;var r=n._o;n._o=void 0;try{var e=d(r.error);if(!e)throw t;t=e.call(r,t)}catch(t){try{y(n)}finally{throw t}}return y(n),t},complete:function(t){var n=this._s;if(!g(n)){var r=n._o;n._o=void 0;try{var e=d(r.complete);t=e?e.call(r,t):void 0}catch(t){try{y(n)}finally{throw t}}return y(n),t}}});var w=function(t){s(this,w,"Observable","_f")._f=f(t)};l(w.prototype,{subscribe:function(t){return new m(t,this._f)},forEach:function(t){var n=this;return new(o.Promise||i.Promise)(function(r,e){f(t);var i=n.subscribe({next:function(n){try{return t(n)}catch(t){e(t),i.unsubscribe()}},error:e,complete:r})})}}),l(w,{from:function(t){var n="function"==typeof this?this:w,r=d(a(t)[c]);if(r){var e=a(r.call(t));return e.constructor===n?e:new n(function(t){return e.subscribe(t)})}return new n(function(n){var r=!1;return u(function(){if(!r){try{if(v(t,!1,function(t){if(n.next(t),r)return p})===p)return}catch(t){if(r)throw t;return void n.error(t)}n.complete()}}),function(){r=!0}})},of:function(){for(var t=0,n=arguments.length,r=Array(n);t<n;)r[t]=arguments[t++];return new("function"==typeof this?this:w)(function(t){var n=!1;return u(function(){if(!n){for(var e=0;e<r.length;++e)if(t.next(r[e]),n)return;t.complete()}}),function(){n=!0}})}}),h(w.prototype,c,function(){return this}),e(e.G,{Observable:w}),r(74)("Observable")},function(t,n,r){var e=r(54),i=r(2),o=e.key,u=e.set;e.exp({defineMetadata:function(t,n,r,e){u(t,n,i(r),o(e))}})},function(t,n,r){var e=r(54),i=r(2),o=e.key,u=e.map,c=e.store;e.exp({deleteMetadata:function(t,n){var r=arguments.length<3?void 0:o(arguments[2]),e=u(i(n),r,!1);if(void 0===e||!e.delete(t))return!1;if(e.size)return!0;var f=c.get(n);return f.delete(r),!!f.size||c.delete(n)}})},function(t,n,r){var e=r(185),i=r(161),o=r(54),u=r(2),c=r(32),f=o.keys,a=o.key,s=function(t,n){var r=f(t,n),o=c(t);if(null===o)return r;var u=s(o,n);return u.length?r.length?i(new e(r.concat(u))):u:r};o.exp({getMetadataKeys:function(t){return s(u(t),arguments.length<2?void 0:a(arguments[1]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(32),u=e.has,c=e.get,f=e.key,a=function(t,n,r){if(u(t,n,r))return c(t,n,r);var e=o(n);return null!==e?a(t,e,r):void 0};e.exp({getMetadata:function(t,n){return a(t,i(n),arguments.length<3?void 0:f(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.keys,u=e.key;e.exp({getOwnMetadataKeys:function(t){
return o(i(t),arguments.length<2?void 0:u(arguments[1]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.get,u=e.key;e.exp({getOwnMetadata:function(t,n){return o(t,i(n),arguments.length<3?void 0:u(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(32),u=e.has,c=e.key,f=function(t,n,r){if(u(t,n,r))return!0;var e=o(n);return null!==e&&f(t,e,r)};e.exp({hasMetadata:function(t,n){return f(t,i(n),arguments.length<3?void 0:c(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.has,u=e.key;e.exp({hasOwnMetadata:function(t,n){return o(t,i(n),arguments.length<3?void 0:u(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(26),u=e.key,c=e.set;e.exp({metadata:function(t,n){return function(r,e){c(t,n,(void 0!==e?i:o)(r),u(e))}}})},function(t,n,r){var e=r(1);e(e.P+e.R,"Set",{toJSON:r(165)("Set")})},function(t,n,r){"use strict";var e=r(1),i=r(147)(!0);e(e.P,"String",{at:function(t){return i(this,t)}})},function(t,n,r){"use strict";var e=r(1),i=r(46),o=r(16),u=r(122),c=r(120),f=RegExp.prototype,a=function(t,n){this._r=t,this._s=n};r(139)(a,"RegExp String",function(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),e(e.P,"String",{matchAll:function(t){if(i(this),!u(t))throw TypeError(t+" is not a regexp!");var n=String(this),r="flags"in f?String(t.flags):c.call(t),e=new RegExp(t.source,~r.indexOf("g")?r:"g"+r);return e.lastIndex=o(t.lastIndex),new a(e,n)}})},function(t,n,r){"use strict";var e=r(1),i=r(181);e(e.P,"String",{padEnd:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,n,r){"use strict";var e=r(1),i=r(181);e(e.P,"String",{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,n,r){"use strict";r(82)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},function(t,n,r){"use strict";r(82)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},function(t,n,r){r(153)("asyncIterator")},function(t,n,r){r(153)("observable")},function(t,n,r){var e=r(1);e(e.S,"System",{global:r(3)})},function(t,n,r){for(var e=r(155),i=r(28),o=r(3),u=r(27),c=r(80),f=r(7),a=f("iterator"),s=f("toStringTag"),l=c.Array,h=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],v=0;v<5;v++){var p,d=h[v],y=o[d],g=y&&y.prototype;if(g){g[a]||u(g,a,l),g[s]||u(g,s,d),c[d]=l;for(p in e)g[p]||i(g,p,e[p],!0)}}},function(t,n,r){var e=r(1),i=r(151);e(e.G+e.B,{setImmediate:i.set,clearImmediate:i.clear})},function(t,n,r){var e=r(3),i=r(1),o=r(121),u=r(207),c=e.navigator,f=!!c&&/MSIE .\./.test(c.userAgent),a=function(t){return f?function(n,r){return t(o(u,[].slice.call(arguments,2),"function"==typeof n?n:Function(n)),r)}:t};i(i.G+i.B+i.F*f,{setTimeout:a(e.setTimeout),setInterval:a(e.setInterval)})},function(t,n,r){r(330),r(269),r(271),r(270),r(273),r(275),r(280),r(274),r(272),r(282),r(281),r(277),r(278),r(276),r(268),r(279),r(283),r(284),r(236),r(238),r(237),r(286),r(285),r(256),r(266),r(267),r(257),r(258),r(259),r(260),r(261),r(262),r(263),r(264),r(265),r(239),r(240),r(241),r(242),r(243),r(244),r(245),r(246),r(247),r(248),r(249),r(250),r(251),r(252),r(253),r(254),r(255),r(317),r(322),r(329),r(320),r(312),r(313),r(318),r(323),r(325),r(308),r(309),r(310),r(311),r(314),r(315),r(316),r(319),r(321),r(324),r(326),r(327),r(328),r(231),r(233),r(232),r(235),r(234),r(220),r(218),r(224),r(221),r(227),r(229),r(217),r(223),r(214),r(228),r(212),r(226),r(225),r(219),r(222),r(211),r(213),r(216),r(215),r(230),r(155),r(302),r(307),r(184),r(303),r(304),r(305),r(306),r(287),r(183),r(185),r(186),r(342),r(331),r(332),r(337),r(340),r(341),r(335),r(338),r(336),r(339),r(333),r(334),r(288),r(289),r(290),r(291),r(292),r(295),r(293),r(294),r(296),r(297),r(298),r(299),r(301),r(300),r(343),r(369),r(372),r(371),r(373),r(374),r(370),r(375),r(376),r(354),r(357),r(353),r(351),r(352),r(355),r(356),r(346),r(368),r(377),r(345),r(347),r(349),r(348),r(350),r(359),r(360),r(362),r(361),r(364),r(363),r(365),r(366),r(367),r(344),r(358),r(380),r(379),r(378),t.exports=r(52)},function(t,n){function r(t,n){if("string"==typeof n)return t.insertAdjacentHTML("afterend",n);var r=t.nextSibling;return r?t.parentNode.insertBefore(n,r):t.parentNode.appendChild(n)}t.exports=r},,,,,,,,,function(t,n,r){(function(n,r){!function(n){"use strict";function e(t,n,r,e){var i=n&&n.prototype instanceof o?n:o,u=Object.create(i.prototype),c=new p(e||[]);return u._invoke=s(t,r,c),u}function i(t,n,r){try{return{type:"normal",arg:t.call(n,r)}}catch(t){return{type:"throw",arg:t}}}function o(){}function u(){}function c(){}function f(t){["next","throw","return"].forEach(function(n){t[n]=function(t){return this._invoke(n,t)}})}function a(t){function n(r,e,o,u){var c=i(t[r],t,e);if("throw"!==c.type){var f=c.arg,a=f.value;return a&&"object"==typeof a&&m.call(a,"__await")?Promise.resolve(a.__await).then(function(t){n("next",t,o,u)},function(t){n("throw",t,o,u)}):Promise.resolve(a).then(function(t){f.value=t,o(f)},u)}u(c.arg)}function e(t,r){function e(){return new Promise(function(e,i){n(t,r,e,i)})}return o=o?o.then(e,e):e()}"object"==typeof r&&r.domain&&(n=r.domain.bind(n));var o;this._invoke=e}function s(t,n,r){var e=P;return function(o,u){if(e===F)throw new Error("Generator is already running");if(e===M){if("throw"===o)throw u;return y()}for(r.method=o,r.arg=u;;){var c=r.delegate;if(c){var f=l(c,r);if(f){if(f===A)continue;return f}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(e===P)throw e=M,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);e=F;var a=i(t,n,r);if("normal"===a.type){if(e=r.done?M:j,a.arg===A)continue;return{value:a.arg,done:r.done}}"throw"===a.type&&(e=M,r.method="throw",r.arg=a.arg)}}}function l(t,n){var r=t.iterator[n.method];if(r===g){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=g,l(t,n),"throw"===n.method))return A;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var e=i(r,t.iterator,n.arg);if("throw"===e.type)return n.method="throw",n.arg=e.arg,n.delegate=null,A;var o=e.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=g),n.delegate=null,A):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,A)}function h(t){var n={tryLoc:t[0]};1 in t&&(n.catchLoc=t[1]),2 in t&&(n.finallyLoc=t[2],n.afterLoc=t[3]),this.tryEntries.push(n)}function v(t){var n=t.completion||{};n.type="normal",delete n.arg,t.completion=n}function p(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(h,this),this.reset(!0)}function d(t){if(t){var n=t[w];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,e=function n(){for(;++r<t.length;)if(m.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=g,n.done=!0,n};return e.next=e}}return{next:y}}function y(){return{value:g,done:!0}}var g,b=Object.prototype,m=b.hasOwnProperty,x="function"==typeof Symbol?Symbol:{},w=x.iterator||"@@iterator",S=x.asyncIterator||"@@asyncIterator",_=x.toStringTag||"@@toStringTag",O="object"==typeof t,E=n.regeneratorRuntime;if(E)return void(O&&(t.exports=E));E=n.regeneratorRuntime=O?t.exports:{},E.wrap=e;var P="suspendedStart",j="suspendedYield",F="executing",M="completed",A={},N={};N[w]=function(){return this};var T=Object.getPrototypeOf,I=T&&T(T(d([])));I&&I!==b&&m.call(I,w)&&(N=I);var k=c.prototype=o.prototype=Object.create(N);u.prototype=k.constructor=c,c.constructor=u,c[_]=u.displayName="GeneratorFunction",E.isGeneratorFunction=function(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===u||"GeneratorFunction"===(n.displayName||n.name))},E.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,_ in t||(t[_]="GeneratorFunction")),t.prototype=Object.create(k),t},E.awrap=function(t){return{__await:t}},f(a.prototype),a.prototype[S]=function(){return this},E.AsyncIterator=a,E.async=function(t,n,r,i){var o=new a(e(t,n,r,i));return E.isGeneratorFunction(n)?o:o.next().then(function(t){return t.done?t.value:o.next()})},f(k),k[_]="Generator",k.toString=function(){return"[object Generator]"},E.keys=function(t){var n=[];for(var r in t)n.push(r);return n.reverse(),function r(){for(;n.length;){var e=n.pop();if(e in t)return r.value=e,r.done=!1,r}return r.done=!0,r}},E.values=d,p.prototype={constructor:p,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(v),!t)for(var n in this)"t"===n.charAt(0)&&m.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=g)},stop:function(){this.done=!0;var t=this.tryEntries[0],n=t.completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(t){function n(n,e){return o.type="throw",o.arg=t,r.next=n,e&&(r.method="next",r.arg=g),!!e}if(this.done)throw t;for(var r=this,e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=m.call(i,"catchLoc"),c=m.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,n){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc<=this.prev&&m.call(e,"finallyLoc")&&this.prev<e.finallyLoc){var i=e;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=n&&n<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=n,i?(this.method="next",this.next=i.finallyLoc,A):this.complete(o)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),A},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),v(r),A}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc===t){var e=r.completion;if("throw"===e.type){var i=e.arg;v(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:d(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=g),A}}}("object"==typeof n?n:"object"==typeof window?window:"object"==typeof self?self:this)}).call(n,function(){return this}(),r(158))}])</script><script src="/./main.0cf68a.js"></script><script>!function(){!function(e){var t=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(t),t.setAttribute("src",e)}("/slider.e37972.js")}()</script>


    
<div class="tools-col" q-class="show:isShow,hide:isShow|isFalse" q-on="click:stop(e)">
  <div class="tools-nav header-menu">
    
    
      
      
      
    
      
      
      
    
      
      
      
    
    

    <ul style="width: 70%">
    
    
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'innerArchive')"><a href="javascript:void(0)" q-class="active:innerArchive">文章搜搜</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'friends')"><a href="javascript:void(0)" q-class="active:friends">友情链接</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'aboutme')"><a href="javascript:void(0)" q-class="active:aboutme">About me</a></li>
      
        
    </ul>
  </div>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all" q-show="innerArchive">
        <div class="search-wrap">
          <input class="search-ipt" q-model="search" type="text" placeholder="find something…">
          <i class="icon-search icon" q-show="search|isEmptyStr"></i>
          <i class="icon-close icon" q-show="search|isNotEmptyStr" q-on="click:clearChose(e)"></i>
        </div>
        <div class="widget tagcloud search-tag">
          <p class="search-tag-wording">tag:</p>
          <label class="search-switch">
            <input type="checkbox" q-on="click:toggleTag(e)" q-attr="checked:showTags">
          </label>
          <ul class="article-tag-list" q-show="showTags">
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">安全</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">信息收集</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">暗网</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">社会工程</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">速查</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">随记</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">json</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">经验</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">dnslog</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">elk</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">fastjson</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">反序列化</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">爆破</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">msf</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">fortify</a>
              </li>
            
            <div class="clearfix"></div>
          </ul>
        </div>
        <ul class="search-ul">
          <p q-show="jsonFail" style="padding: 20px; font-size: 12px;">
            缺失模块。<br/>1、请确保node版本大于6.2<br/>2、在博客根目录（注意不是yilia根目录）执行以下命令：<br/> npm i hexo-generator-json-content --save<br/><br/>
            3、在根目录_config.yml里添加配置：
<pre style="font-size: 12px;" q-show="jsonFail">
  jsonContent:
    meta: false
    pages: false
    posts:
      title: true
      date: true
      path: true
      text: false
      raw: false
      content: false
      slug: false
      updated: false
      comments: false
      link: false
      permalink: false
      excerpt: false
      categories: false
      tags: true
</pre>
          </p>
          <li class="search-li" q-repeat="items" q-show="isShow">
            <a q-attr="href:path|urlformat" class="search-title"><i class="icon-quo-left icon"></i><span q-text="title"></span></a>
            <p class="search-time">
              <i class="icon-calendar icon"></i>
              <span q-text="date|dateformat"></span>
            </p>
            <p class="search-tag">
              <i class="icon-price-tags icon"></i>
              <span q-repeat="tags" q-on="click:choseTag(e, name)" q-text="name|tagformat"></span>
            </p>
          </li>
        </ul>
    	</section>
    

    
    	<section class="tools-section tools-section-friends" q-show="friends">
  		
        <ul class="search-ul">
          
            <li class="search-li">
              <a href="http://blog.sina.com.cn/s/articlelist_1874551935_0_1.html" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>本人新浪博客</a>
            </li>
          
            <li class="search-li">
              <a href="https://yangrz.github.io/blog/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>y1r0nz技术博客</a>
            </li>
          
        </ul>
  		
    	</section>
    

    
    	<section class="tools-section tools-section-me" q-show="aboutme">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">一小小幽灵&lt;br&gt;潜伏在黑暗中&lt;br&gt;而自误自乐，&lt;br&gt;偶尔享受音乐，&lt;br&gt;偶尔研究技术，&lt;br&gt;偶尔静静发呆。</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>